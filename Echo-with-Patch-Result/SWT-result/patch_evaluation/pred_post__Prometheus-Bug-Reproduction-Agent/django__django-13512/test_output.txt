+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git diff HEAD b79088306513d5ed76d31ac40ab3c15f858946ea
+ sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen
+ locale-gen
Generating locales (this might take a while)...
  en_US.UTF-8... done
Generation complete.
+ export LANG=en_US.UTF-8
+ LANG=en_US.UTF-8
+ export LANGUAGE=en_US:en
+ LANGUAGE=en_US:en
+ export LC_ALL=en_US.UTF-8
+ LC_ALL=en_US.UTF-8
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch main
nothing to commit, working tree clean
+ git show
commit b79088306513d5ed76d31ac40ab3c15f858946ea
Author: Julien Rebetez <julien@fhtagn.net>
Date:   Sat Jan 18 19:03:03 2020 +0100

    Fixed #31181 -- Added links to related models for admin's readonly fields.

diff --git a/django/contrib/admin/helpers.py b/django/contrib/admin/helpers.py
index 56d7970d2a..6f0be6b148 100644
--- a/django/contrib/admin/helpers.py
+++ b/django/contrib/admin/helpers.py
@@ -3,12 +3,15 @@ import json
 from django import forms
 from django.contrib.admin.utils import (
     display_for_field, flatten_fieldsets, help_text_for_field, label_for_field,
-    lookup_field,
+    lookup_field, quote,
 )
 from django.core.exceptions import ObjectDoesNotExist
-from django.db.models import ManyToManyRel
+from django.db.models.fields.related import (
+    ForeignObjectRel, ManyToManyRel, OneToOneField,
+)
 from django.forms.utils import flatatt
 from django.template.defaultfilters import capfirst, linebreaksbr
+from django.urls import NoReverseMatch, reverse
 from django.utils.html import conditional_escape, format_html
 from django.utils.safestring import mark_safe
 from django.utils.translation import gettext, gettext_lazy as _
@@ -187,6 +190,17 @@ class AdminReadonlyField:
         label = self.field['label']
         return format_html('<label{}>{}{}</label>', flatatt(attrs), capfirst(label), self.form.label_suffix)
 
+    def get_admin_url(self, remote_field, remote_obj):
+        url_name = 'admin:%s_%s_change' % (
+            remote_field.model._meta.app_label,
+            remote_field.model._meta.model_name,
+        )
+        try:
+            url = reverse(url_name, args=[quote(remote_obj.pk)])
+            return format_html('<a href="{}">{}</a>', url, remote_obj)
+        except NoReverseMatch:
+            return str(remote_obj)
+
     def contents(self):
         from django.contrib.admin.templatetags.admin_list import _boolean_icon
         field, obj, model_admin = self.field['field'], self.form.instance, self.model_admin
@@ -212,6 +226,11 @@ class AdminReadonlyField:
             else:
                 if isinstance(f.remote_field, ManyToManyRel) and value is not None:
                     result_repr = ", ".join(map(str, value.all()))
+                elif (
+                    isinstance(f.remote_field, (ForeignObjectRel, OneToOneField)) and
+                    value is not None
+                ):
+                    result_repr = self.get_admin_url(f.remote_field, value)
                 else:
                     result_repr = display_for_field(value, f, self.empty_value_display)
                 result_repr = linebreaksbr(result_repr)
diff --git a/docs/releases/3.2.txt b/docs/releases/3.2.txt
index d82c9c719a..ab1d4dfb9a 100644
--- a/docs/releases/3.2.txt
+++ b/docs/releases/3.2.txt
@@ -72,6 +72,9 @@ Minor features
 * :attr:`.ModelAdmin.search_fields` now allows searching against quoted phrases
   with spaces.
 
+* Read-only related fields are now rendered as navigable links if target models
+  are registered in the admin.
+
 :mod:`django.contrib.admindocs`
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
diff --git a/tests/admin_views/admin.py b/tests/admin_views/admin.py
index 44623e483f..4a72e3070f 100644
--- a/tests/admin_views/admin.py
+++ b/tests/admin_views/admin.py
@@ -37,8 +37,8 @@ from .models import (
     Person, Persona, Picture, Pizza, Plot, PlotDetails, PlotProxy,
     PluggableSearchPerson, Podcast, Post, PrePopulatedPost,
     PrePopulatedPostLargeSlug, PrePopulatedSubPost, Promo, Question,
-    ReadablePizza, ReadOnlyPizza, Recipe, Recommendation, Recommender,
-    ReferencedByGenRel, ReferencedByInline, ReferencedByParent,
+    ReadablePizza, ReadOnlyPizza, ReadOnlyRelatedField, Recipe, Recommendation,
+    Recommender, ReferencedByGenRel, ReferencedByInline, ReferencedByParent,
     RelatedPrepopulated, RelatedWithUUIDPKModel, Report, Reservation,
     Restaurant, RowLevelChangePermissionModel, Section, ShortMessage, Simple,
     Sketch, Song, State, Story, StumpJoke, Subscriber, SuperVillain, Telegram,
@@ -539,6 +539,10 @@ class PizzaAdmin(admin.ModelAdmin):
     readonly_fields = ('toppings',)
 
 
+class ReadOnlyRelatedFieldAdmin(admin.ModelAdmin):
+    readonly_fields = ('chapter', 'language', 'user')
+
+
 class StudentAdmin(admin.ModelAdmin):
     search_fields = ('name',)
 
@@ -1061,6 +1065,7 @@ site.register(GenRelReference)
 site.register(ParentWithUUIDPK)
 site.register(RelatedPrepopulated, search_fields=['name'])
 site.register(RelatedWithUUIDPKModel)
+site.register(ReadOnlyRelatedField, ReadOnlyRelatedFieldAdmin)
 
 # We intentionally register Promo and ChapterXtra1 but not Chapter nor ChapterXtra2.
 # That way we cover all four cases:
diff --git a/tests/admin_views/models.py b/tests/admin_views/models.py
index ba818ea10e..eed3cae306 100644
--- a/tests/admin_views/models.py
+++ b/tests/admin_views/models.py
@@ -365,6 +365,9 @@ class Language(models.Model):
     english_name = models.CharField(max_length=50)
     shortlist = models.BooleanField(default=False)
 
+    def __str__(self):
+        return self.iso
+
     class Meta:
         ordering = ('iso',)
 
@@ -999,3 +1002,9 @@ class UserProxy(User):
     """Proxy a model with a different app_label."""
     class Meta:
         proxy = True
+
+
+class ReadOnlyRelatedField(models.Model):
+    chapter = models.ForeignKey(Chapter, models.CASCADE)
+    language = models.ForeignKey(Language, models.CASCADE)
+    user = models.ForeignKey(User, models.CASCADE)
diff --git a/tests/admin_views/tests.py b/tests/admin_views/tests.py
index 6842b02d3e..94646f2034 100644
--- a/tests/admin_views/tests.py
+++ b/tests/admin_views/tests.py
@@ -48,12 +48,12 @@ from .models import (
     Parent, ParentWithDependentChildren, ParentWithUUIDPK, Person, Persona,
     Picture, Pizza, Plot, PlotDetails, PluggableSearchPerson, Podcast, Post,
     PrePopulatedPost, Promo, Question, ReadablePizza, ReadOnlyPizza,
-    Recommendation, Recommender, RelatedPrepopulated, RelatedWithUUIDPKModel,
-    Report, Restaurant, RowLevelChangePermissionModel, SecretHideout, Section,
-    ShortMessage, Simple, Song, State, Story, SuperSecretHideout, SuperVillain,
-    Telegram, TitleTranslation, Topping, UnchangeableObject, UndeletableObject,
-    UnorderedObject, UserProxy, Villain, Vodcast, Whatsit, Widget, Worker,
-    WorkHour,
+    ReadOnlyRelatedField, Recommendation, Recommender, RelatedPrepopulated,
+    RelatedWithUUIDPKModel, Report, Restaurant, RowLevelChangePermissionModel,
+    SecretHideout, Section, ShortMessage, Simple, Song, State, Story,
+    SuperSecretHideout, SuperVillain, Telegram, TitleTranslation, Topping,
+    UnchangeableObject, UndeletableObject, UnorderedObject, UserProxy, Villain,
+    Vodcast, Whatsit, Widget, Worker, WorkHour,
 )
 
 ERROR_MESSAGE = "Please enter the correct username and password \
@@ -5042,6 +5042,45 @@ class ReadonlyTest(AdminFieldExtractionMixin, TestCase):
         response = self.client.get(reverse('admin:admin_views_choice_change', args=(choice.pk,)))
         self.assertContains(response, '<div class="readonly">No opinion</div>', html=True)
 
+    def test_readonly_foreignkey_links(self):
+        """
+        ForeignKey readonly fields render as links if the target model is
+        registered in admin.
+        """
+        chapter = Chapter.objects.create(
+            title='Chapter 1',
+            content='content',
+            book=Book.objects.create(name='Book 1'),
+        )
+        language = Language.objects.create(iso='_40', name='Test')
+        obj = ReadOnlyRelatedField.objects.create(
+            chapter=chapter,
+            language=language,
+            user=self.superuser,
+        )
+        response = self.client.get(
+            reverse('admin:admin_views_readonlyrelatedfield_change', args=(obj.pk,)),
+        )
+        # Related ForeignKey object registered in admin.
+        user_url = reverse('admin:auth_user_change', args=(self.superuser.pk,))
+        self.assertContains(
+            response,
+            '<div class="readonly"><a href="%s">super</a></div>' % user_url,
+            html=True,
+        )
+        # Related ForeignKey with the string primary key registered in admin.
+        language_url = reverse(
+            'admin:admin_views_language_change',
+            args=(quote(language.pk),),
+        )
+        self.assertContains(
+            response,
+            '<div class="readonly"><a href="%s">_40</a></div>' % language_url,
+            html=True,
+        )
+        # Related ForeignKey object not registered in admin.
+        self.assertContains(response, '<div class="readonly">Chapter 1</div>', html=True)
+
     def test_readonly_manytomany_backwards_ref(self):
         """
         Regression test for #16433 - backwards references for related objects
@@ -5071,7 +5110,8 @@ class ReadonlyTest(AdminFieldExtractionMixin, TestCase):
 
         response = self.client.get(reverse('admin:admin_views_plotproxy_change', args=(pl.pk,)))
         field = self.get_admin_readonly_field(response, 'plotdetails')
-        self.assertEqual(field.contents(), 'Brand New Plot')
+        pd_url = reverse('admin:admin_views_plotdetails_change', args=(pd.pk,))
+        self.assertEqual(field.contents(), '<a href="%s">Brand New Plot</a>' % pd_url)
 
         # The reverse relation also works if the OneToOneField is null.
         pd.plot = None
+ git diff b79088306513d5ed76d31ac40ab3c15f858946ea
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ python -m pip install -e .
Obtaining file:///testbed
Requirement already satisfied: asgiref>=3.2.10 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.2) (3.4.1)
Requirement already satisfied: pytz in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.2) (2025.2)
Requirement already satisfied: sqlparse>=0.2.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.2) (0.4.4)
Requirement already satisfied: typing-extensions in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from asgiref>=3.2.10->Django==3.2) (4.1.1)
Installing collected packages: Django
  Attempting uninstall: Django
    Found existing installation: Django 3.2
    Uninstalling Django-3.2:
      Successfully uninstalled Django-3.2
  Running setup.py develop for Django
Successfully installed Django-3.2
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
+ git apply -v -
Checking patch django/contrib/admin/utils.py...
Checking patch django/forms/fields.py...
Applied patch django/contrib/admin/utils.py cleanly.
Applied patch django/forms/fields.py cleanly.
+ git apply -v -
Checking patch tests/forms/test_jsonfield.py...
Applied patch tests/forms/test_jsonfield.py cleanly.
+ python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(django/contrib/admin/utils\.py|django/forms/fields\.py)' ./tests/runtests.py --verbosity 2 --settings=test_sqlite --parallel 1 forms.test_jsonfield
test_converted_value (forms.test_jsonfield.JSONFieldTest) ... ok
test_custom_encoder_decoder (forms.test_jsonfield.JSONFieldTest) ... ok
test_custom_widget_attribute (forms.test_jsonfield.JSONFieldTest)
The widget can be overridden with an attribute. ... ok
test_custom_widget_kwarg (forms.test_jsonfield.JSONFieldTest) ... ok
test_formfield_disabled (forms.test_jsonfield.JSONFieldTest) ... ok
test_has_changed (forms.test_jsonfield.JSONFieldTest) ... ok
test_invalid (forms.test_jsonfield.JSONFieldTest) ... ok
test_prepare_value (forms.test_jsonfield.JSONFieldTest) ... ok
test_prepare_value_non_ascii (forms.test_jsonfield.JSONFieldTest) ... ok
test_redisplay_wrong_input (forms.test_jsonfield.JSONFieldTest) ... ok
test_valid (forms.test_jsonfield.JSONFieldTest) ... ok
test_valid_empty (forms.test_jsonfield.JSONFieldTest) ... ok
test_widget (forms.test_jsonfield.JSONFieldTest) ... ok

----------------------------------------------------------------------
Ran 13 tests in 0.067s

OK
['--count', '-C', 'coverage.cover', '--include-pattern', '/testbed/(django/contrib/admin/utils\\.py|django/forms/fields\\.py)']
Testing against Django installed in '/testbed/django'
Skipping setup of unused database(s): default, other.
System check identified no issues (0 silenced).
+ cat coverage.cover
{"/testbed/django/forms/fields.py": {"5": 1, "6": 1, "7": 1, "8": 1, "9": 1, "10": 1, "11": 1, "12": 1, "13": 1, "14": 1, "15": 1, "17": 1, "18": 1, "19": 1, "20": 1, "21": 1, "28": 1, "29": 1, "30": 1, "31": 1, "32": 1, "33": 1, "43": 1, "47": 2, "210": 2, "244": 2, "290": 2, "325": 2, "366": 2, "387": 2, "411": 2, "433": 2, "439": 2, "475": 2, "503": 2, "527": 2, "535": 2, "602": 2, "661": 2, "703": 2, "730": 2, "757": 2, "765": 2, "827": 2, "854": 2, "896": 2, "932": 2, "956": 2, "1084": 2, "1128": 2, "1164": 2, "1179": 2, "1189": 2, "1211": 2, "1215": 2, "1219": 2, "48": 1, "49": 1, "50": 1, "54": 1, "56": 1, "58": 1, "59": 1, "60": 1, "120": 1, "123": 1, "126": 1, "130": 1, "144": 1, "154": 1, "167": 1, "175": 1, "194": 1, "201": 1, "84": 16, "85": 16, "86": 16, "87": 16, "88": 16, "89": 16, "90": 16, "91": 15, "93": 1, "96": 16, "97": 16, "98": 0, "101": 16, "104": 16, "105": 16, "106": 1, "108": 16, "110": 16, "111": 78, "112": 62, "113": 16, "114": 16, "116": 16, "118": 16, "121": 2, "124": 0, "127": 24, "128": 0, "131": 24, "132": 4, "133": 20, "134": 42, "135": 22, "136": 22, "137": 1, "138": 1, "139": 0, "140": 1, "141": 20, "142": 1, "149": 26, "150": 24, "151": 24, "152": 23, "163": 2, "164": 0, "165": 2, "173": 16, "179": 2, "180": 0, "181": 2, "182": 2, "183": 2, "184": 0, "185": 0, "186": 0, "190": 2, "191": 2, "192": 2, "199": 5, "202": 5, "203": 5, "204": 5, "205": 5, "206": 5, "207": 5, "211": 1, "223": 1, "233": 1, "212": 14, "213": 14, "214": 14, "215": 14, "216": 14, "217": 14, "218": 0, "219": 14, "220": 1, "221": 14, "225": 2, "226": 2, "227": 2, "228": 2, "229": 2, "230": 0, "231": 2, "234": 14, "235": 14, "237": 1, "238": 14, "240": 0, "241": 14, "245": 1, "247": 1, "249": 1, "251": 1, "263": 1, "280": 1, "252": 0, "253": 0, "255": 0, "256": 0, "258": 0, "259": 0, "260": 0, "261": 0, "268": 0, "269": 0, "270": 0, "271": 0, "272": 0, "274": 0, "275": 0, "276": 0, "277": 0, "278": 0, "281": 0, "282": 0, "283": 0, "284": 0, "285": 0, "286": 0, "287": 0, "292": 1, "295": 1, "311": 1, "318": 1, "300": 0, "301": 0, "302": 0, "303": 0, "304": 0, "305": 0, "306": 0, "307": 0, "308": 0, "309": 0, "312": 0, "313": 0, "314": 0, "315": 0, "316": 0, "319": 0, "320": 0, "321": 0, "322": 0, "327": 1, "330": 1, "335": 1, "353": 1, "331": 0, "332": 0, "333": 0, "342": 0, "343": 0, "344": 0, "345": 0, "346": 0, "347": 0, "348": 0, "349": 0, "350": 0, "351": 0, "354": 0, "355": 0, "356": 0, "359": 0, "361": 0, "362": 0, "363": 0, "368": 1, "373": 1, "383": 1, "369": 0, "370": 0, "371": 0, "374": 0, "376": 0, "377": 0, "378": 0, "379": 0, "380": 0, "381": 0, "384": 0, "388": 1, "389": 1, "391": 1, "394": 1, "407": 1, "399": 0, "400": 0, "401": 0, "402": 0, "403": 0, "404": 0, "405": 0, "408": 0, "412": 1, "413": 1, "415": 1, "418": 1, "429": 1, "423": 0, "424": 0, "425": 0, "426": 0, "427": 0, "430": 0, "434": 1, "435": 0, "436": 0, "440": 1, "441": 1, "443": 1, "446": 1, "451": 1, "471": 1, "447": 0, "448": 0, "449": 0, "456": 0, "457": 0, "458": 0, "459": 0, "460": 0, "461": 0, "462": 0, "463": 0, "464": 0, "465": 0, "466": 0, "467": 0, "468": 0, "469": 0, "472": 0, "477": 1, "478": 1, "481": 1, "486": 1, "482": 0, "483": 0, "484": 0, "487": 0, "488": 0, "489": 0, "490": 0, "491": 0, "492": 0, "493": 0, "494": 0, "495": 0, "496": 0, "497": 0, "498": 0, "499": 0, "500": 0, "504": 1, "512": 1, "515": 1, "524": 1, "508": 0, "509": 0, "510": 0, "513": 0, "516": 0, "517": 0, "518": 0, "519": 0, "520": 0, "521": 0, "522": 0, "528": 1, "529": 1, "531": 1, "532": 0, "536": 1, "538": 1, "539": 1, "540": 1, "541": 1, "542": 1, "543": 1, "544": 1, "545": 1, "548": 1, "553": 1, "574": 1, "593": 1, "598": 1, "549": 0, "550": 0, "551": 0, "554": 0, "555": 0, "558": 0, "559": 0, "560": 0, "561": 0, "562": 0, "564": 0, "565": 0, "566": 0, "567": 0, "568": 0, "569": 0, "570": 0, "572": 0, "576": 0, "577": 0, "580": 0, "581": 0, "582": 0, "588": 0, "589": 0, "590": 0, "591": 0, "594": 0, "595": 0, "596": 0, "599": 0, "603": 1, "605": 1, "606": 1, "611": 1, "654": 1, "616": 0, "617": 0, "618": 0, "620": 0, "624": 0, "625": 0, "627": 0, "628": 0, "630": 0, "632": 0, "635": 0, "637": 0, "640": 0, "643": 0, "644": 0, "646": 0, "647": 0, "648": 0, "649": 0, "650": 0, "651": 0, "652": 0, "655": 0, "656": 0, "657": 0, "658": 0, "662": 1, "664": 1, "666": 1, "668": 1, "671": 1, "669": 0, "673": 0, "685": 0, "686": 0, "687": 0, "688": 0, "690": 0, "691": 0, "694": 0, "695": 0, "698": 0, "699": 0, "700": 0, "678": 0, "679": 0, "680": 0, "683": 0, "704": 1, "706": 1, "718": 1, "722": 1, "712": 0, "713": 0, "715": 0, "716": 0, "719": 0, "720": 0, "723": 0, "724": 0, "727": 0, "735": 1, "737": 1, "753": 1, "746": 0, "747": 0, "748": 0, "749": 0, "751": 0, "754": 0, "758": 1, "761": 1, "759": 0, "762": 0, "766": 1, "768": 1, "771": 1, "775": 1, "780": 1, "783": 1, "794": 1, "796": 1, "802": 1, "812": 1, "772": 1, "773": 1, "776": 0, "777": 0, "778": 0, "781": 0, "787": 1, "788": 0, "790": 1, "792": 1, "798": 0, "799": 0, "800": 0, "804": 0, "805": 0, "806": 0, "807": 0, "808": 0, "809": 0, "814": 0, "815": 0, "816": 0, "818": 0, "819": 0, "820": 0, "822": 0, "823": 0, "824": 0, "828": 1, "833": 1, "849": 1, "829": 0, "830": 0, "831": 0, "837": 0, "838": 0, "839": 0, "840": 0, "841": 0, "842": 0, "843": 0, "844": 0, "845": 0, "847": 0, "850": 0, "851": 0, "855": 1, "856": 1, "858": 1, "859": 1, "862": 1, "869": 1, "882": 1, "863": 0, "864": 0, "865": 0, "866": 0, "867": 0, "871": 0, "872": 0, "874": 0, "875": 0, "876": 0, "877": 0, "878": 0, "879": 0, "883": 0, "884": 0, "885": 0, "886": 0, "887": 0, "888": 0, "889": 0, "890": 0, "891": 0, "892": 0, "893": 0, "897": 1, "902": 1, "921": 1, "925": 1, "898": 0, "899": 0, "900": 0, "907": 0, "908": 0, "909": 0, "910": 0, "911": 0, "912": 0, "913": 0, "914": 0, "915": 0, "916": 0, "917": 0, "919": 0, "922": 0, "923": 0, "926": 0, "927": 0, "928": 0, "929": 0, "936": 1, "945": 1, "937": 0, "941": 0, "942": 0, "943": 0, "950": 0, "951": 0, "952": 0, "953": 0, "974": 1, "975": 1, "978": 1, "993": 1, "998": 1, "1001": 1, "1055": 1, "1066": 1, "979": 0, "980": 0, "981": 0, "982": 0, "983": 0, "984": 0, "985": 0, "986": 0, "990": 0, "991": 0, "994": 0, "995": 0, "996": 0, "999": 0, "1010": 0, "1011": 0, "1012": 0, "1013": 0, "1014": 0, "1015": 0, "1016": 0, "1017": 0, "1019": 0, "1021": 0, "1022": 0, "1023": 0, "1024": 0, "1025": 0, "1026": 0, "1027": 0, "1028": 0, "1031": 0, "1032": 0, "1033": 0, "1037": 0, "1038": 0, "1039": 0, "1040": 0, "1041": 0, "1042": 0, "1046": 0, "1047": 0, "1048": 0, "1050": 0, "1051": 0, "1052": 0, "1053": 0, "1064": 0, "1067": 0, "1068": 0, "1069": 0, "1070": 0, "1072": 0, "1073": 0, "1074": 0, "1075": 0, "1076": 0, "1077": 0, "1078": 0, "1079": 0, "1080": 0, "1081": 0, "1085": 1, "1086": 1, "1087": 0, "1088": 0, "1089": 0, "1091": 0, "1092": 0, "1094": 0, "1096": 0, "1097": 0, "1099": 0, "1100": 0, "1101": 0, "1102": 0, "1103": 0, "1104": 0, "1105": 0, "1106": 0, "1107": 0, "1108": 0, "1109": 0, "1110": 0, "1111": 0, "1112": 0, "1114": 0, "1115": 0, "1116": 0, "1117": 0, "1118": 0, "1119": 0, "1120": 0, "1121": 0, "1122": 0, "1123": 0, "1125": 0, "1129": 1, "1130": 1, "1132": 1, "1133": 1, "1136": 1, "1151": 1, "1137": 0, "1138": 0, "1139": 0, "1140": 0, "1142": 0, "1143": 0, "1144": 0, "1145": 0, "1146": 0, "1147": 0, "1149": 0, "1152": 0, "1155": 0, "1156": 0, "1157": 0, "1158": 0, "1159": 0, "1160": 0, "1161": 0, "1165": 1, "1170": 1, "1166": 0, "1167": 0, "1168": 0, "1171": 0, "1172": 0, "1173": 0, "1174": 0, "1175": 0, "1176": 0, "1180": 1, "1182": 1, "1183": 0, "1184": 0, "1185": 0, "1186": 0, "1191": 1, "1194": 1, "1199": 1, "1195": 0, "1196": 0, "1197": 0, "1200": 0, "1201": 0, "1202": 0, "1203": 0, "1204": 0, "1205": 0, "1206": 0, "1207": 0, "1208": 0, "1212": 1, "1216": 1, "1221": 1, "1223": 1, "1225": 1, "1230": 1, "1250": 1, "1258": 1, "1263": 1, "1226": 13, "1227": 13, "1228": 13, "1231": 28, "1232": 1, "1233": 27, "1234": 3, "1235": 24, "1236": 7, "1237": 17, "1238": 17, "1239": 2, "1240": 2, "1241": 2, "1242": 2, "1243": 2, "1245": 15, "1246": 1, "1248": 14, "1251": 3, "1252": 1, "1253": 2, "1254": 2, "1255": 1, "1256": 1, "1259": 8, "1260": 1, "1261": 7, "1264": 2, "1265": 0, "1269": 2, "1270": 2}}
{"/testbed/django/contrib/admin/utils.py": {"1": 1, "2": 1, "3": 1, "4": 1, "6": 1, "7": 1, "8": 1, "9": 1, "10": 1, "11": 1, "12": 1, "13": 1, "14": 1, "15": 1, "16": 1, "18": 23, "19": 22, "20": 22, "23": 2, "28": 1, "53": 1, "66": 1, "76": 1, "81": 1, "94": 1, "104": 1, "160": 2, "225": 1, "244": 1, "262": 1, "288": 1, "309": 1, "369": 1, "381": 1, "411": 1, "432": 2, "436": 1, "443": 1, "474": 1, "494": 1, "543": 1, "25": 1, "32": 0, "34": 0, "35": 0, "36": 0, "37": 0, "38": 0, "39": 0, "41": 0, "43": 0, "45": 0, "46": 0, "47": 0, "49": 0, "50": 0, "58": 0, "59": 0, "61": 0, "62": 0, "63": 0, "73": 0, "78": 0, "85": 0, "86": 0, "87": 0, "88": 0, "90": 0, "91": 0, "96": 0, "97": 0, "98": 0, "99": 0, "101": 0, "112": 0, "113": 0, "114": 0, "115": 0, "117": 0, "118": 0, "119": 0, "120": 0, "122": 0, "152": 0, "154": 0, "155": 0, "157": 0, "123": 0, "124": 0, "125": 0, "127": 0, "129": 0, "130": 0, "131": 0, "132": 0, "133": 0, "134": 0, "135": 0, "136": 0, "137": 0, "138": 0, "140": 0, "143": 0, "144": 0, "145": 0, "146": 0, "150": 0, "161": 1, "167": 1, "170": 1, "188": 1, "192": 1, "207": 1, "217": 1, "162": 0, "163": 0, "164": 0, "165": 0, "168": 0, "171": 0, "172": 0, "173": 0, "174": 0, "175": 0, "177": 0, "179": 0, "180": 0, "181": 0, "182": 0, "183": 0, "184": 0, "185": 0, "186": 0, "189": 0, "190": 0, "193": 0, "194": 0, "195": 0, "196": 0, "197": 0, "198": 0, "199": 0, "200": 0, "202": 0, "203": 0, "204": 0, "205": 0, "211": 0, "212": 0, "213": 0, "214": 0, "215": 0, "222": 0, "232": 0, "233": 0, "234": 0, "235": 0, "237": 0, "239": 0, "240": 0, "253": 0, "254": 0, "255": 0, "256": 0, "257": 0, "258": 0, "259": 0, "263": 0, "264": 0, "265": 0, "266": 0, "269": 0, "270": 0, "271": 0, "272": 0, "273": 0, "274": 0, "276": 0, "277": 0, "278": 0, "280": 0, "281": 0, "283": 0, "284": 0, "285": 0, "296": 0, "297": 0, "299": 0, "300": 0, "303": 0, "304": 0, "306": 0, "317": 0, "318": 0, "319": 0, "320": 0, "321": 0, "322": 0, "324": 0, "325": 0, "326": 0, "327": 0, "328": 0, "330": 0, "331": 0, "332": 0, "333": 0, "334": 0, "335": 0, "336": 0, "337": 0, "339": 0, "340": 0, "341": 0, "342": 0, "343": 0, "344": 0, "346": 0, "347": 0, "348": 0, "349": 0, "350": 0, "351": 0, "352": 0, "353": 0, "354": 0, "356": 0, "358": 0, "359": 0, "360": 0, "361": 0, "363": 0, "364": 0, "366": 0, "370": 0, "371": 0, "372": 0, "373": 0, "374": 0, "376": 0, "377": 0, "378": 0, "382": 0, "384": 0, "385": 0, "388": 0, "389": 0, "390": 0, "391": 0, "392": 0, "393": 0, "394": 0, "395": 0, "396": 0, "397": 0, "398": 0, "399": 0, "400": 0, "401": 0, "402": 0, "403": 0, "404": 0, "405": 0, "406": 0, "408": 0, "412": 0, "414": 0, "415": 0, "416": 0, "417": 0, "418": 0, "419": 0, "420": 0, "421": 0, "422": 0, "423": 0, "424": 0, "425": 0, "426": 0, "427": 0, "429": 0, "433": 1, "437": 0, "438": 0, "440": 0, "451": 0, "452": 0, "453": 0, "454": 0, "455": 0, "457": 0, "458": 0, "459": 0, "460": 0, "461": 0, "464": 0, "465": 0, "466": 0, "468": 0, "469": 0, "470": 0, "471": 0, "483": 0, "484": 0, "485": 0, "486": 0, "487": 0, "489": 0, "490": 0, "491": 0, "503": 0, "504": 0, "508": 0, "510": 0, "511": 0, "512": 0, "513": 0, "514": 0, "515": 0, "516": 0, "517": 0, "518": 0, "519": 0, "520": 0, "521": 0, "522": 0, "525": 0, "526": 0, "527": 0, "528": 0, "529": 0, "530": 0, "533": 0, "534": 0, "535": 0, "536": 0, "537": 0, "540": 0, "544": 0, "545": 0, "546": 0, "547": 0, "548": 0, "549": 0, "550": 0, "551": 0}}
+ git checkout b79088306513d5ed76d31ac40ab3c15f858946ea
Note: switching to 'b79088306513d5ed76d31ac40ab3c15f858946ea'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at b790883065 Fixed #31181 -- Added links to related models for admin's readonly fields.
M	django/contrib/admin/utils.py
M	django/forms/fields.py
+ git apply /root/pre_state.patch
error: unrecognized input
