2025-12-26 12:29:15,385 - WARNING - Starting evaluation at 1766752155.3859563
2025-12-26 12:29:15,419 - INFO - Creating container for django__django-11734...
2025-12-26 12:29:17,469 - INFO - Container for django__django-11734 created: dce5a9a27cfd35532723765fdd4510ec497011b52aa1663aa25c4dd468ece5fd
2025-12-26 12:29:18,329 - INFO - Container for django__django-11734 started: dce5a9a27cfd35532723765fdd4510ec497011b52aa1663aa25c4dd468ece5fd
2025-12-26 12:29:19,177 - INFO - Git diff before:

2025-12-26 12:29:19,177 - INFO - Eval script for django__django-11734 written to eval.sh, now applying to container...
2025-12-26 12:33:35,524 - INFO - Test output for django__django-11734 written to run_instance_swt_logs/patch_evaluation/pred_post__Prometheus-Bug-Reproduction-Agent/django__django-11734/test_output.txt
2025-12-26 12:33:35,607 - INFO - Git diff after:
diff --git a/django/db/models/fields/__init__.py b/django/db/models/fields/__init__.py
index 6e924a4adf..9ce46e3f73 100644
--- a/django/db/models/fields/__init__.py
+++ b/django/db/models/fields/__init__.py
@@ -2332,10 +2332,6 @@ class AutoFieldMixin:
             value = connection.ops.validate_autopk_value(value)
         return value
 
-    def get_prep_value(self, value):
-        from django.db.models.expressions import OuterRef
-        return value if isinstance(value, OuterRef) else super().get_prep_value(value)
-
     def contribute_to_class(self, cls, name, **kwargs):
         assert not cls._meta.auto_field, (
             "Model %s can't have more than one auto-generated field."
diff --git a/django/db/models/fields/related_lookups.py b/django/db/models/fields/related_lookups.py
index 12f7fb0b9b..c20e220141 100644
--- a/django/db/models/fields/related_lookups.py
+++ b/django/db/models/fields/related_lookups.py
@@ -101,7 +101,7 @@ class RelatedIn(In):
 
 class RelatedLookupMixin:
     def get_prep_lookup(self):
-        if not isinstance(self.lhs, MultiColSource) and self.rhs_is_direct_value():
+        if not isinstance(self.lhs, MultiColSource) and not hasattr(self.rhs, 'resolve_expression'):
             # If we get here, we are dealing with single-column relations.
             self.rhs = get_normalized_value(self.rhs, self.lhs)[0]
             # We need to run the related field's get_prep_value(). Consider case
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index 35f3c5e1ea..8e55bd092d 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1702,7 +1702,9 @@ class Query(BaseExpression):
         handle.
         """
         filter_lhs, filter_rhs = filter_expr
-        if isinstance(filter_rhs, F):
+        if isinstance(filter_rhs, OuterRef):
+            filter_expr = (filter_lhs, OuterRef(filter_rhs))
+        elif isinstance(filter_rhs, F):
             filter_expr = (filter_lhs, OuterRef(filter_rhs.name))
         # Generate the inner query.
         query = Query(self.model)
2025-12-26 12:33:35,607 - INFO - Git diff changed after running eval script
2025-12-26 12:33:35,607 - INFO - Attempting to stop container exec.eval.x86_64.ee2ad6945f237e9160354f.60aa4f3b25cd767582fd8f.134233028274672...
2025-12-26 12:33:53,219 - INFO - Attempting to remove container exec.eval.x86_64.ee2ad6945f237e9160354f.60aa4f3b25cd767582fd8f.134233028274672...
2025-12-26 12:33:53,450 - INFO - Container exec.eval.x86_64.ee2ad6945f237e9160354f.60aa4f3b25cd767582fd8f.134233028274672 removed.
2025-12-26 12:33:53,451 - WARNING - End of eval at 1766752433.451001
2025-12-26 14:58:34,795 - WARNING - Starting evaluation at 1766761114.7950816
2025-12-26 14:58:34,804 - WARNING - Starting evaluation at 1766761114.8044777
2025-12-26 14:58:34,813 - WARNING - Starting evaluation at 1766761114.8136709
2025-12-26 14:58:34,821 - WARNING - Starting evaluation at 1766761114.8219469
2025-12-26 14:58:34,830 - WARNING - Starting evaluation at 1766761114.8307712
