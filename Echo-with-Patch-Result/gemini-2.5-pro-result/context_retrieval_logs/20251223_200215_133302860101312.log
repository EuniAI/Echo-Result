2025-12-23 20:02:15,204 - thread-133302860101312.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: FieldError when migrating field to new model subclass.

Description: Description
	
Analogous to #21890. If creating a model subclass and moving a field onto it in the same step, makemigrations works but migrate dies with django.core.exceptions.FieldError: Local field 'title' in class 'Book' clashes with field of the same name from base class 'Readable'.
For example, take this model:
from django.db import models
class Readable(models.Model):
	title = models.CharField(max_length=200)
And change to this:
from django.db import models
class Readable(models.Model):
	pass
class Book(Readable):
	title = models.CharField(max_length=200)
The migration generates with CreateModel for Book, then RemoveField for Readable.title. But running it produces the error.
Reversing the order of the migration operations makes it pass. The auto-detector should be able to use this order.

Patch information:
diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py
index 30616c0172..fb8f074e70 100644
--- a/django/db/migrations/autodetector.py
+++ b/django/db/migrations/autodetector.py
@@ -563,6 +563,22 @@ class MigrationAutodetector:
                 if isinstance(base, str) and "." in base:
                     base_app_label, base_name = base.split(".", 1)
                     dependencies.append((base_app_label, base_name, None, True))
+            # If a new model defines a local field with the same name as a field
+            # that is being removed from any of its (non-abstract) base models
+            # in the same migration, depend on the removal of that field to avoid
+            # model rendering conflicts (#21890-like cases).
+            non_rel_field_names = {
+                name for name, field in model_state.fields.items()
+                if name not in related_fields
+            }
+            for base in model_state.bases:
+                if isinstance(base, str) and "." in base:
+                    base_app_label, base_name = base.split(".", 1)
+                    base_name_lower = base_name.lower()
+                    for field_name in non_rel_field_names:
+                        dep_key = (base_app_label, base_name_lower, field_name)
+                        if dep_key in self.old_field_keys and dep_key not in self.new_field_keys:
+                            dependencies.append((base_app_label, base_name, field_name, False))
             # Depend on the other end of the primary key if it's a relation
             if primary_key_rel:
                 dependencies.append((
@@ -871,6 +887,16 @@ class MigrationAutodetector:
                 field.default = self.questioner.ask_auto_now_add_addition(field_name, model_name)
             else:
                 field.default = self.questioner.ask_not_null_addition(field_name, model_name)
+        # If adding a field to a subclass that has the same name as a field
+        # being removed from one of its base models in the same migration,
+        # depend on that removal to avoid model rendering conflicts.
+        model_state = self.to_state.models[app_label, model_name]
+        for base in model_state.bases:
+            if isinstance(base, str) and "." in base:
+                base_app_label, base_name = base.split(".", 1)
+                dep_key = (base_app_label, base_name.lower(), field_name)
+                if dep_key in self.old_field_keys and dep_key not in self.new_field_keys:
+                    dependencies.append((base_app_label, base_name, field_name, False))
         self.add_operation(
             app_label,
             operations.AddField(


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 20:02:15,296 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_system_checks.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── specific_system_checks.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: FieldError when migrating field to new model subclass.

Description: Description
	
Analogous to #21890. If creating a model subclass and moving a field onto it in the same step, makemigrations works but migrate dies with django.core.exceptions.FieldError: Local field 'title' in class 'Book' clashes with field of the same name from base class 'Readable'.
For example, take this model:
from django.db import models
class Readable(models.Model):
	title = models.CharField(max_length=200)
And change to this:
from django.db import models
class Readable(models.Model):
	pass
class Book(Readable):
	title = models.CharField(max_length=200)
The migration generates with CreateModel for Book, then RemoveField for Readable.title. But running it produces the error.
Reversing the order of the migration operations makes it pass. The auto-detector should be able to use this order.

Patch information:
diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py
index 30616c0172..fb8f074e70 100644
--- a/django/db/migrations/autodetector.py
+++ b/django/db/migrations/autodetector.py
@@ -563,6 +563,22 @@ class MigrationAutodetector:
                 if isinstance(base, str) and "." in base:
                     base_app_label, base_name = base.split(".", 1)
                     dependencies.append((base_app_label, base_name, None, True))
+            # If a new model defines a local field with the same name as a field
+            # that is being removed from any of its (non-abstract) base models
+            # in the same migration, depend on the removal of that field to avoid
+            # model rendering conflicts (#21890-like cases).
+            non_rel_field_names = {
+                name for name, field in model_state.fields.items()
+                if name not in related_fields
+            }
+            for base in model_state.bases:
+                if isinstance(base, str) and "." in base:
+                    base_app_label, base_name = base.split(".", 1)
+                    base_name_lower = base_name.lower()
+                    for field_name in non_rel_field_names:
+                        dep_key = (base_app_label, base_name_lower, field_name)
+                        if dep_key in self.old_field_keys and dep_key not in self.new_field_keys:
+                            dependencies.append((base_app_label, base_name, field_name, False))
             # Depend on the other end of the primary key if it's a relation
             if primary_key_rel:
                 dependencies.append((
@@ -871,6 +887,16 @@ class MigrationAutodetector:
                 field.default = self.questioner.ask_auto_now_add_addition(field_name, model_name)
             else:
                 field.default = self.questioner.ask_not_null_addition(field_name, model_name)
+        # If adding a field to a subclass that has the same name as a field
+        # being removed from one of its base models in the same migration,
+        # depend on that removal to avoid model rendering conflicts.
+        model_state = self.to_state.models[app_label, model_name]
+        for base in model_state.bases:
+            if isinstance(base, str) and "." in base:
+                base_app_label, base_name = base.split(".", 1)
+                dep_key = (base_app_label, base_name.lower(), field_name)
+                if dep_key in self.old_field_keys and dep_key not in self.new_field_keys:
+                    dependencies.append((base_app_label, base_name, field_name, False))
         self.add_operation(
             app_label,
             operations.AddField(


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 20:02:42,441 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases for a bug in the migration autodetector related to model inheritance and field clashes. The provided patch modifies `django/db/migrations/autodetector.py`. The most relevant tests for this change will be in the corresponding test file, `tests/migrations/test_autodetector.py`. This file should contain regression tests for similar bugs and tests for the logic that generates migration dependencies, which is at the core of the issue.' query='Please provide the full content of tests/migrations/test_autodetector.py.' extra_requirements='' purpose="I need this file to find test cases that cover the migration autodetector's handling of moving fields between base and subclass models, which is the scenario described in the bug report."
2025-12-23 20:02:42,442 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of tests/migrations/test_autodetector.py.
2025-12-23 20:02:42,442 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 20:02:42,443 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 20:02:42,443 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 20:02:42,443 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of tests/migrations/test_autodetector.py.
Purpose: I need this file to find test cases that cover the migration autodetector's handling of moving fields between base and subclass models, which is the scenario described in the bug report.
2025-12-23 20:02:45,917 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of `tests/migrations/test_autodetector.py`. This file should contain the test cases you need to analyze the migration autodetector's behavior when moving fields between base and subclass models." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/test_autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2115, 'candidates_token_count': 73, 'total_token_count': 2449, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2115}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 73}], 'thoughts_token_count': 261, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.23329060698208742, 'model_name': 'gemini-2.5-pro'} id='run--eaac57bb-837c-412a-8891-b2ae1f1b5427-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_autodetector.py'}, 'id': 'ae48c121-f9ce-4ae6-8480-bee336f91a3d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2115, 'output_tokens': 73, 'total_tokens': 2449, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 261}}
2025-12-23 20:02:49,285 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the first 500 lines of the file `tests/migrations/test_autodetector.py`. I will now read the next 1000 lines to get the full content of the file as you requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 501.0, "relative_path": "tests/migrations/test_autodetector.py", "end_line": 1501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11601, 'candidates_token_count': 81, 'total_token_count': 11877, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11601}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 81}], 'thoughts_token_count': 195, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.24277048935124904, 'model_name': 'gemini-2.5-pro'} id='run--58e6e682-e768-45ff-bf99-41942a8a1eea-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 501.0, 'relative_path': 'tests/migrations/test_autodetector.py', 'end_line': 1501.0}, 'id': '7d56f3cf-04a0-43af-9240-d68d5217746d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11601, 'output_tokens': 81, 'total_tokens': 11877, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 195}}
2025-12-23 20:02:53,852 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now retrieved the full content of `tests/migrations/test_autodetector.py` by reading it in two parts. You can now use this file to find the test cases you need. I will continue to assist you if you have any further requests.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1501.0, "relative_path": "tests/migrations/test_autodetector.py", "end_line": 2501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 32016, 'candidates_token_count': 86, 'total_token_count': 32284, 'cached_content_token_count': 11480, 'prompt_tokens_details': [{'modality': 1, 'token_count': 32016}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11480}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 86}], 'thoughts_token_count': 182}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5010856805845748, 'model_name': 'gemini-2.5-pro'} id='run--5a383d29-ac61-46e4-bdf9-0515e677f2a3-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1501.0, 'relative_path': 'tests/migrations/test_autodetector.py', 'end_line': 2501.0}, 'id': '2d7cac7c-b7d3-4e0c-9240-b5baa30aa71a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 32016, 'output_tokens': 86, 'total_tokens': 32284, 'input_token_details': {'cache_read': 11480}, 'output_token_details': {'reasoning': 182}}
2025-12-23 20:02:57,108 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have provided the full content of `tests/migrations/test_autodetector.py`. You can now examine this file for test cases related to the migration autodetector's handling of moving fields between base and subclass models, as described in the bug report. I am now marking this task as complete." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 52238, 'candidates_token_count': 64, 'total_token_count': 52420, 'cached_content_token_count': 30956, 'prompt_tokens_details': [{'modality': 1, 'token_count': 52238}], 'cache_tokens_details': [{'modality': 1, 'token_count': 30956}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 118}, 'finish_reason': 'STOP', 'avg_logprobs': -0.34108588099479675, 'model_name': 'gemini-2.5-pro'} id='run--b5c2ecb9-7edc-474c-8755-d834d6b44eee-0' usage_metadata={'input_tokens': 52238, 'output_tokens': 64, 'total_tokens': 52420, 'input_token_details': {'cache_read': 30956}, 'output_token_details': {'reasoning': 118}}
2025-12-23 20:02:57,111 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of tests/migrations/test_autodetector.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need this file to find test cases that cover the migration autodetector's handling of moving fields between base and subclass models, which is the scenario described in the bug report.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/migrations/test_autodetector.py
Line number range: 1 - 500
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author_fk = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("author", models.IntegerField()),
358.         ("title", models.CharField(max_length=200)),
359.     ])
360.     book_with_no_author = ModelState("otherapp", "Book", [
361.         ("id", models.AutoField(primary_key=True)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
382.         ("title", models.CharField(max_length=200)),
383.     ])
384.     book_indexes = ModelState("otherapp", "Book", [
385.         ("id", models.AutoField(primary_key=True)),
386.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
387.         ("title", models.CharField(max_length=200)),
388.     ], {
389.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
390.     })
391.     book_unordered_indexes = ModelState("otherapp", "Book", [
392.         ("id", models.AutoField(primary_key=True)),
393.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
394.         ("title", models.CharField(max_length=200)),
395.     ], {
396.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
397.     })
398.     book_foo_together = ModelState("otherapp", "Book", [
399.         ("id", models.AutoField(primary_key=True)),
400.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
401.         ("title", models.CharField(max_length=200)),
402.     ], {
403.         "index_together": {("author", "title")},
404.         "unique_together": {("author", "title")},
405.     })
406.     book_foo_together_2 = ModelState("otherapp", "Book", [
407.         ("id", models.AutoField(primary_key=True)),
408.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
409.         ("title", models.CharField(max_length=200)),
410.     ], {
411.         "index_together": {("title", "author")},
412.         "unique_together": {("title", "author")},
413.     })
414.     book_foo_together_3 = ModelState("otherapp", "Book", [
415.         ("id", models.AutoField(primary_key=True)),
416.         ("newfield", models.IntegerField()),
417.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
418.         ("title", models.CharField(max_length=200)),
419.     ], {
420.         "index_together": {("title", "newfield")},
421.         "unique_together": {("title", "newfield")},
422.     })
423.     book_foo_together_4 = ModelState("otherapp", "Book", [
424.         ("id", models.AutoField(primary_key=True)),
425.         ("newfield2", models.IntegerField()),
426.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
427.         ("title", models.CharField(max_length=200)),
428.     ], {
429.         "index_together": {("title", "newfield2")},
430.         "unique_together": {("title", "newfield2")},
431.     })
432.     attribution = ModelState("otherapp", "Attribution", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
435.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
436.     ])
437.     edition = ModelState("thirdapp", "Edition", [
438.         ("id", models.AutoField(primary_key=True)),
439.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
440.     ])
441.     custom_user = ModelState("thirdapp", "CustomUser", [
442.         ("id", models.AutoField(primary_key=True)),
443.         ("username", models.CharField(max_length=255)),
444.     ], bases=(AbstractBaseUser,))
445.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
446.         ("id", models.AutoField(primary_key=True)),
447.         ("username", models.CharField(max_length=255)),
448.     ])
449.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
450.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
451.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
452.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
453.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
454.     ])
455.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
456.     rabbit = ModelState("eggs", "Rabbit", [
457.         ("id", models.AutoField(primary_key=True)),
458.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
459.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
460.     ], {
461.         "unique_together": {("parent", "knight")},
462.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
463.     })
464. 
465.     def repr_changes(self, changes, include_dependencies=False):
466.         output = ""
467.         for app_label, migrations in sorted(changes.items()):
468.             output += "  %s:\n" % app_label
469.             for migration in migrations:
470.                 output += "    %s\n" % migration.name
471.                 for operation in migration.operations:
472.                     output += "      %s\n" % operation
473.                 if include_dependencies:
474.                     output += "      Dependencies:\n"
475.                     if migration.dependencies:
476.                         for dep in migration.dependencies:
477.                             output += "        %s\n" % (dep,)
478.                     else:
479.                         output += "        None\n"
480.         return output
481. 
482.     def assertNumberMigrations(self, changes, app_label, number):
483.         if len(changes.get(app_label, [])) != number:
484.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
485.                 len(changes.get(app_label, [])),
486.                 app_label,
487.                 number,
488.                 self.repr_changes(changes),
489.             ))
490. 
491.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
492.         if not changes.get(app_label):
493.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
494.         if len(changes[app_label]) < position + 1:
495.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
496.         migration = changes[app_label][position]
497.         if set(migration.dependencies) != set(dependencies):
498.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
499.                 app_label,
500.                 migration.name,


File: tests/migrations/test_autodetector.py
Line number range: 501 - 1501
Content:
501.                 dependencies,
502.                 self.repr_changes(changes, include_dependencies=True),
503.             ))
504. 
505.     def assertOperationTypes(self, changes, app_label, position, types):
506.         if not changes.get(app_label):
507.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
508.         if len(changes[app_label]) < position + 1:
509.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
510.         migration = changes[app_label][position]
511.         real_types = [operation.__class__.__name__ for operation in migration.operations]
512.         if types != real_types:
513.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
514.                 app_label,
515.                 migration.name,
516.                 types,
517.                 self.repr_changes(changes),
518.             ))
519. 
520.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
521.         if not changes.get(app_label):
522.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
523.         if len(changes[app_label]) < position + 1:
524.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
525.         migration = changes[app_label][position]
526.         if len(changes[app_label]) < position + 1:
527.             self.fail("No operation at index %s for %s.%s\n%s" % (
528.                 operation_position,
529.                 app_label,
530.                 migration.name,
531.                 self.repr_changes(changes),
532.             ))
533.         operation = migration.operations[operation_position]
534.         for attr, value in attrs.items():
535.             if getattr(operation, attr, None) != value:
536.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
537.                     app_label,
538.                     migration.name,
539.                     operation_position,
540.                     attr,
541.                     value,
542.                     getattr(operation, attr, None),
543.                     self.repr_changes(changes),
544.                 ))
545. 
546.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
547.         if not changes.get(app_label):
548.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
549.         if len(changes[app_label]) < position + 1:
550.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
551.         migration = changes[app_label][position]
552.         if len(changes[app_label]) < position + 1:
553.             self.fail("No operation at index %s for %s.%s\n%s" % (
554.                 operation_position,
555.                 app_label,
556.                 migration.name,
557.                 self.repr_changes(changes),
558.             ))
559.         operation = migration.operations[operation_position]
560.         if not hasattr(operation, 'field'):
561.             self.fail("No field attribute for %s.%s op #%s." % (
562.                 app_label,
563.                 migration.name,
564.                 operation_position,
565.             ))
566.         field = operation.field
567.         for attr, value in attrs.items():
568.             if getattr(field, attr, None) != value:
569.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
570.                     app_label,
571.                     migration.name,
572.                     operation_position,
573.                     attr,
574.                     value,
575.                     getattr(field, attr, None),
576.                     self.repr_changes(changes),
577.                 ))
578. 
579.     def make_project_state(self, model_states):
580.         "Shortcut to make ProjectStates from lists of predefined models"
581.         project_state = ProjectState()
582.         for model_state in model_states:
583.             project_state.add_model(model_state.clone())
584.         return project_state
585. 
586.     def get_changes(self, before_states, after_states, questioner=None):
587.         return MigrationAutodetector(
588.             self.make_project_state(before_states),
589.             self.make_project_state(after_states),
590.             questioner,
591.         )._detect_changes()
592. 
593.     def test_arrange_for_graph(self):
594.         """Tests auto-naming of migrations for graph matching."""
595.         # Make a fake graph
596.         graph = MigrationGraph()
597.         graph.add_node(("testapp", "0001_initial"), None)
598.         graph.add_node(("testapp", "0002_foobar"), None)
599.         graph.add_node(("otherapp", "0001_initial"), None)
600.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
601.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
602.         # Use project state to make a new migration change set
603.         before = self.make_project_state([])
604.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
605.         autodetector = MigrationAutodetector(before, after)
606.         changes = autodetector._detect_changes()
607.         # Run through arrange_for_graph
608.         changes = autodetector.arrange_for_graph(changes, graph)
609.         # Make sure there's a new name, deps match, etc.
610.         self.assertEqual(changes["testapp"][0].name, "0003_author")
611.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
612.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
613.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
614. 
615.     def test_trim_apps(self):
616.         """
617.         Trim does not remove dependencies but does remove unwanted apps.
618.         """
619.         # Use project state to make a new migration change set
620.         before = self.make_project_state([])
621.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
622.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
623.         changes = autodetector._detect_changes()
624.         # Run through arrange_for_graph
625.         graph = MigrationGraph()
626.         changes = autodetector.arrange_for_graph(changes, graph)
627.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
628.         changes = autodetector._trim_to_apps(changes, {"testapp"})
629.         # Make sure there's the right set of migrations
630.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
631.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
632.         self.assertNotIn("thirdapp", changes)
633. 
634.     def test_custom_migration_name(self):
635.         """Tests custom naming of migrations for graph matching."""
636.         # Make a fake graph
637.         graph = MigrationGraph()
638.         graph.add_node(("testapp", "0001_initial"), None)
639.         graph.add_node(("testapp", "0002_foobar"), None)
640.         graph.add_node(("otherapp", "0001_initial"), None)
641.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
642. 
643.         # Use project state to make a new migration change set
644.         before = self.make_project_state([])
645.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
646.         autodetector = MigrationAutodetector(before, after)
647.         changes = autodetector._detect_changes()
648. 
649.         # Run through arrange_for_graph
650.         migration_name = 'custom_name'
651.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
652. 
653.         # Make sure there's a new name, deps match, etc.
654.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
655.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
656.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
657.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
658. 
659.     def test_new_model(self):
660.         """Tests autodetection of new models."""
661.         changes = self.get_changes([], [self.other_pony_food])
662.         # Right number/type of migrations?
663.         self.assertNumberMigrations(changes, 'otherapp', 1)
664.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
665.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
666.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
667.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
668. 
669.     def test_old_model(self):
670.         """Tests deletion of old models."""
671.         changes = self.get_changes([self.author_empty], [])
672.         # Right number/type of migrations?
673.         self.assertNumberMigrations(changes, 'testapp', 1)
674.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
675.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
676. 
677.     def test_add_field(self):
678.         """Tests autodetection of new fields."""
679.         changes = self.get_changes([self.author_empty], [self.author_name])
680.         # Right number/type of migrations?
681.         self.assertNumberMigrations(changes, 'testapp', 1)
682.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
683.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
684. 
685.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
686.                 side_effect=AssertionError("Should not have prompted for not null addition"))
687.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
688.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
689.         # Right number/type of migrations?
690.         self.assertNumberMigrations(changes, 'testapp', 1)
691.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
692.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
693.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
694.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
695. 
696.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
697.                 side_effect=AssertionError("Should not have prompted for not null addition"))
698.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
699.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
700.         # Right number/type of migrations?
701.         self.assertNumberMigrations(changes, 'testapp', 1)
702.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
703.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
704.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
705.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
706. 
707.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
708.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
709.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
710.         # Right number/type of migrations?
711.         self.assertNumberMigrations(changes, 'testapp', 1)
712.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
713.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
714.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
715.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
716.         self.assertEqual(mocked_ask_method.call_count, 3)
717. 
718.     def test_remove_field(self):
719.         """Tests autodetection of removed fields."""
720.         changes = self.get_changes([self.author_name], [self.author_empty])
721.         # Right number/type of migrations?
722.         self.assertNumberMigrations(changes, 'testapp', 1)
723.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
724.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
725. 
726.     def test_alter_field(self):
727.         """Tests autodetection of new fields."""
728.         changes = self.get_changes([self.author_name], [self.author_name_longer])
729.         # Right number/type of migrations?
730.         self.assertNumberMigrations(changes, 'testapp', 1)
731.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
732.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
733. 
734.     def test_supports_functools_partial(self):
735.         def _content_file_name(instance, filename, key, **kwargs):
736.             return '{}/{}'.format(instance, filename)
737. 
738.         def content_file_name(key, **kwargs):
739.             return functools.partial(_content_file_name, key, **kwargs)
740. 
741.         # An unchanged partial reference.
742.         before = [ModelState("testapp", "Author", [
743.             ("id", models.AutoField(primary_key=True)),
744.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
745.         ])]
746.         after = [ModelState("testapp", "Author", [
747.             ("id", models.AutoField(primary_key=True)),
748.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
749.         ])]
750.         changes = self.get_changes(before, after)
751.         self.assertNumberMigrations(changes, 'testapp', 0)
752. 
753.         # A changed partial reference.
754.         args_changed = [ModelState("testapp", "Author", [
755.             ("id", models.AutoField(primary_key=True)),
756.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
757.         ])]
758.         changes = self.get_changes(before, args_changed)
759.         self.assertNumberMigrations(changes, 'testapp', 1)
760.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
761.         # Can't use assertOperationFieldAttributes because we need the
762.         # deconstructed version, i.e., the exploded func/args/keywords rather
763.         # than the partial: we don't care if it's not the same instance of the
764.         # partial, only if it's the same source function, args, and keywords.
765.         value = changes['testapp'][0].operations[0].field.upload_to
766.         self.assertEqual(
767.             (_content_file_name, ('other-file',), {}),
768.             (value.func, value.args, value.keywords)
769.         )
770. 
771.         kwargs_changed = [ModelState("testapp", "Author", [
772.             ("id", models.AutoField(primary_key=True)),
773.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
774.         ])]
775.         changes = self.get_changes(before, kwargs_changed)
776.         self.assertNumberMigrations(changes, 'testapp', 1)
777.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
778.         value = changes['testapp'][0].operations[0].field.upload_to
779.         self.assertEqual(
780.             (_content_file_name, ('file',), {'spam': 'eggs'}),
781.             (value.func, value.args, value.keywords)
782.         )
783. 
784.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
785.                 side_effect=AssertionError("Should not have prompted for not null addition"))
786.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
787.         """
788.         #23609 - Tests autodetection of nullable to non-nullable alterations.
789.         """
790.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
791.         # Right number/type of migrations?
792.         self.assertNumberMigrations(changes, 'testapp', 1)
793.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
794.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
795.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
796. 
797.     @mock.patch(
798.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
799.         return_value=models.NOT_PROVIDED,
800.     )
801.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
802.         """
803.         #23609 - Tests autodetection of nullable to non-nullable alterations.
804.         """
805.         changes = self.get_changes([self.author_name_null], [self.author_name])
806.         self.assertEqual(mocked_ask_method.call_count, 1)
807.         # Right number/type of migrations?
808.         self.assertNumberMigrations(changes, 'testapp', 1)
809.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
810.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
811.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
812. 
813.     @mock.patch(
814.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
815.         return_value='Some Name',
816.     )
817.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
818.         """
819.         #23609 - Tests autodetection of nullable to non-nullable alterations.
820.         """
821.         changes = self.get_changes([self.author_name_null], [self.author_name])
822.         self.assertEqual(mocked_ask_method.call_count, 1)
823.         # Right number/type of migrations?
824.         self.assertNumberMigrations(changes, 'testapp', 1)
825.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
826.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
827.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
828. 
829.     def test_rename_field(self):
830.         """Tests autodetection of renamed fields."""
831.         changes = self.get_changes(
832.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
833.         )
834.         # Right number/type of migrations?
835.         self.assertNumberMigrations(changes, 'testapp', 1)
836.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
837.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
838. 
839.     def test_rename_field_foreign_key_to_field(self):
840.         before = [
841.             ModelState('app', 'Foo', [
842.                 ('id', models.AutoField(primary_key=True)),
843.                 ('field', models.IntegerField(unique=True)),
844.             ]),
845.             ModelState('app', 'Bar', [
846.                 ('id', models.AutoField(primary_key=True)),
847.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
848.             ]),
849.         ]
850.         after = [
851.             ModelState('app', 'Foo', [
852.                 ('id', models.AutoField(primary_key=True)),
853.                 ('renamed_field', models.IntegerField(unique=True)),
854.             ]),
855.             ModelState('app', 'Bar', [
856.                 ('id', models.AutoField(primary_key=True)),
857.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
858.             ]),
859.         ]
860.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
861.         # Right number/type of migrations?
862.         self.assertNumberMigrations(changes, 'app', 1)
863.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
864.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
865. 
866.     def test_rename_foreign_object_fields(self):
867.         fields = ('first', 'second')
868.         renamed_fields = ('first_renamed', 'second_renamed')
869.         before = [
870.             ModelState('app', 'Foo', [
871.                 ('id', models.AutoField(primary_key=True)),
872.                 ('first', models.IntegerField()),
873.                 ('second', models.IntegerField()),
874.             ], options={'unique_together': {fields}}),
875.             ModelState('app', 'Bar', [
876.                 ('id', models.AutoField(primary_key=True)),
877.                 ('first', models.IntegerField()),
878.                 ('second', models.IntegerField()),
879.                 ('foo', models.ForeignObject(
880.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
881.                 )),
882.             ]),
883.         ]
884.         # Case 1: to_fields renames.
885.         after = [
886.             ModelState('app', 'Foo', [
887.                 ('id', models.AutoField(primary_key=True)),
888.                 ('first_renamed', models.IntegerField()),
889.                 ('second_renamed', models.IntegerField()),
890.             ], options={'unique_together': {renamed_fields}}),
891.             ModelState('app', 'Bar', [
892.                 ('id', models.AutoField(primary_key=True)),
893.                 ('first', models.IntegerField()),
894.                 ('second', models.IntegerField()),
895.                 ('foo', models.ForeignObject(
896.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
897.                 )),
898.             ]),
899.         ]
900.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
901.         self.assertNumberMigrations(changes, 'app', 1)
902.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
903.         self.assertOperationAttributes(
904.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
905.         )
906.         self.assertOperationAttributes(
907.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
908.         )
909.         # Case 2: from_fields renames.
910.         after = [
911.             ModelState('app', 'Foo', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first', models.IntegerField()),
914.                 ('second', models.IntegerField()),
915.             ], options={'unique_together': {fields}}),
916.             ModelState('app', 'Bar', [
917.                 ('id', models.AutoField(primary_key=True)),
918.                 ('first_renamed', models.IntegerField()),
919.                 ('second_renamed', models.IntegerField()),
920.                 ('foo', models.ForeignObject(
921.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
922.                 )),
923.             ]),
924.         ]
925.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
926.         self.assertNumberMigrations(changes, 'app', 1)
927.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
928.         self.assertOperationAttributes(
929.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
930.         )
931.         self.assertOperationAttributes(
932.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
933.         )
934. 
935.     def test_rename_referenced_primary_key(self):
936.         before = [
937.             ModelState('app', 'Foo', [
938.                 ('id', models.CharField(primary_key=True, serialize=False)),
939.             ]),
940.             ModelState('app', 'Bar', [
941.                 ('id', models.AutoField(primary_key=True)),
942.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
943.             ]),
944.         ]
945.         after = [
946.             ModelState('app', 'Foo', [
947.                 ('renamed_id', models.CharField(primary_key=True, serialize=False))
948.             ]),
949.             ModelState('app', 'Bar', [
950.                 ('id', models.AutoField(primary_key=True)),
951.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
952.             ]),
953.         ]
954.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
955.         self.assertNumberMigrations(changes, 'app', 1)
956.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
957.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='id', new_name='renamed_id')
958. 
959.     def test_rename_field_preserved_db_column(self):
960.         """
961.         RenameField is used if a field is renamed and db_column equal to the
962.         old field's column is added.
963.         """
964.         before = [
965.             ModelState('app', 'Foo', [
966.                 ('id', models.AutoField(primary_key=True)),
967.                 ('field', models.IntegerField()),
968.             ]),
969.         ]
970.         after = [
971.             ModelState('app', 'Foo', [
972.                 ('id', models.AutoField(primary_key=True)),
973.                 ('renamed_field', models.IntegerField(db_column='field')),
974.             ]),
975.         ]
976.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
977.         self.assertNumberMigrations(changes, 'app', 1)
978.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
979.         self.assertOperationAttributes(
980.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
981.         )
982.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
983.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
984.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
985.         ))
986. 
987.     def test_rename_related_field_preserved_db_column(self):
988.         before = [
989.             ModelState('app', 'Foo', [
990.                 ('id', models.AutoField(primary_key=True)),
991.             ]),
992.             ModelState('app', 'Bar', [
993.                 ('id', models.AutoField(primary_key=True)),
994.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
995.             ]),
996.         ]
997.         after = [
998.             ModelState('app', 'Foo', [
999.                 ('id', models.AutoField(primary_key=True)),
1000.             ]),
1001.             ModelState('app', 'Bar', [
1002.                 ('id', models.AutoField(primary_key=True)),
1003.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
1004.             ]),
1005.         ]
1006.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
1007.         self.assertNumberMigrations(changes, 'app', 1)
1008.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
1009.         self.assertOperationAttributes(
1010.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
1011.         )
1012.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
1013.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1014.             'renamed_foo',
1015.             'django.db.models.ForeignKey',
1016.             [],
1017.             {'to': 'app.foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
1018.         ))
1019. 
1020.     def test_rename_model(self):
1021.         """Tests autodetection of renamed models."""
1022.         changes = self.get_changes(
1023.             [self.author_with_book, self.book],
1024.             [self.author_renamed_with_book, self.book_with_author_renamed],
1025.             MigrationQuestioner({"ask_rename_model": True}),
1026.         )
1027.         # Right number/type of migrations?
1028.         self.assertNumberMigrations(changes, 'testapp', 1)
1029.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1030.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1031.         # Now that RenameModel handles related fields too, there should be
1032.         # no AlterField for the related field.
1033.         self.assertNumberMigrations(changes, 'otherapp', 0)
1034. 
1035.     def test_rename_model_case(self):
1036.         """
1037.         Model name is case-insensitive. Changing case doesn't lead to any
1038.         autodetected operations.
1039.         """
1040.         author_renamed = ModelState('testapp', 'author', [
1041.             ('id', models.AutoField(primary_key=True)),
1042.         ])
1043.         changes = self.get_changes(
1044.             [self.author_empty, self.book],
1045.             [author_renamed, self.book],
1046.             questioner=MigrationQuestioner({'ask_rename_model': True}),
1047.         )
1048.         self.assertNumberMigrations(changes, 'testapp', 0)
1049.         self.assertNumberMigrations(changes, 'otherapp', 0)
1050. 
1051.     def test_rename_m2m_through_model(self):
1052.         """
1053.         Tests autodetection of renamed models that are used in M2M relations as
1054.         through models.
1055.         """
1056.         changes = self.get_changes(
1057.             [self.author_with_m2m_through, self.publisher, self.contract],
1058.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1059.             MigrationQuestioner({'ask_rename_model': True})
1060.         )
1061.         # Right number/type of migrations?
1062.         self.assertNumberMigrations(changes, 'testapp', 1)
1063.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1064.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1065. 
1066.     def test_rename_model_with_renamed_rel_field(self):
1067.         """
1068.         Tests autodetection of renamed models while simultaneously renaming one
1069.         of the fields that relate to the renamed model.
1070.         """
1071.         changes = self.get_changes(
1072.             [self.author_with_book, self.book],
1073.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1074.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1075.         )
1076.         # Right number/type of migrations?
1077.         self.assertNumberMigrations(changes, 'testapp', 1)
1078.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1079.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1080.         # Right number/type of migrations for related field rename?
1081.         # Alter is already taken care of.
1082.         self.assertNumberMigrations(changes, 'otherapp', 1)
1083.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1084.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1085. 
1086.     def test_rename_model_with_fks_in_different_position(self):
1087.         """
1088.         #24537 - The order of fields in a model does not influence
1089.         the RenameModel detection.
1090.         """
1091.         before = [
1092.             ModelState("testapp", "EntityA", [
1093.                 ("id", models.AutoField(primary_key=True)),
1094.             ]),
1095.             ModelState("testapp", "EntityB", [
1096.                 ("id", models.AutoField(primary_key=True)),
1097.                 ("some_label", models.CharField(max_length=255)),
1098.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1099.             ]),
1100.         ]
1101.         after = [
1102.             ModelState("testapp", "EntityA", [
1103.                 ("id", models.AutoField(primary_key=True)),
1104.             ]),
1105.             ModelState("testapp", "RenamedEntityB", [
1106.                 ("id", models.AutoField(primary_key=True)),
1107.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1108.                 ("some_label", models.CharField(max_length=255)),
1109.             ]),
1110.         ]
1111.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1112.         self.assertNumberMigrations(changes, "testapp", 1)
1113.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1114.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1115. 
1116.     def test_rename_model_reverse_relation_dependencies(self):
1117.         """
1118.         The migration to rename a model pointed to by a foreign key in another
1119.         app must run after the other app's migration that adds the foreign key
1120.         with model's original name. Therefore, the renaming migration has a
1121.         dependency on that other migration.
1122.         """
1123.         before = [
1124.             ModelState('testapp', 'EntityA', [
1125.                 ('id', models.AutoField(primary_key=True)),
1126.             ]),
1127.             ModelState('otherapp', 'EntityB', [
1128.                 ('id', models.AutoField(primary_key=True)),
1129.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1130.             ]),
1131.         ]
1132.         after = [
1133.             ModelState('testapp', 'RenamedEntityA', [
1134.                 ('id', models.AutoField(primary_key=True)),
1135.             ]),
1136.             ModelState('otherapp', 'EntityB', [
1137.                 ('id', models.AutoField(primary_key=True)),
1138.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1139.             ]),
1140.         ]
1141.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1142.         self.assertNumberMigrations(changes, 'testapp', 1)
1143.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1144.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1145.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1146. 
1147.     def test_fk_dependency(self):
1148.         """Having a ForeignKey automatically adds a dependency."""
1149.         # Note that testapp (author) has no dependencies,
1150.         # otherapp (book) depends on testapp (author),
1151.         # thirdapp (edition) depends on otherapp (book)
1152.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1153.         # Right number/type of migrations?
1154.         self.assertNumberMigrations(changes, 'testapp', 1)
1155.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1156.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1157.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1158.         # Right number/type of migrations?
1159.         self.assertNumberMigrations(changes, 'otherapp', 1)
1160.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1161.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1162.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1163.         # Right number/type of migrations?
1164.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1165.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1166.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1167.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1168. 
1169.     def test_proxy_fk_dependency(self):
1170.         """FK dependencies still work on proxy models."""
1171.         # Note that testapp (author) has no dependencies,
1172.         # otherapp (book) depends on testapp (authorproxy)
1173.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1174.         # Right number/type of migrations?
1175.         self.assertNumberMigrations(changes, 'testapp', 1)
1176.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1177.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1178.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1179.         # Right number/type of migrations?
1180.         self.assertNumberMigrations(changes, 'otherapp', 1)
1181.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1182.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1183.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1184.         # Right number/type of migrations?
1185.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1186.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1187.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1188.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1189. 
1190.     def test_same_app_no_fk_dependency(self):
1191.         """
1192.         A migration with a FK between two models of the same app
1193.         does not have a dependency to itself.
1194.         """
1195.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1196.         # Right number/type of migrations?
1197.         self.assertNumberMigrations(changes, 'testapp', 1)
1198.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1199.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1200.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1201.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1202. 
1203.     def test_circular_fk_dependency(self):
1204.         """
1205.         Having a circular ForeignKey dependency automatically
1206.         resolves the situation into 2 migrations on one side and 1 on the other.
1207.         """
1208.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1209.         # Right number/type of migrations?
1210.         self.assertNumberMigrations(changes, 'testapp', 1)
1211.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1212.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1213.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1214.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1215.         # Right number/type of migrations?
1216.         self.assertNumberMigrations(changes, 'otherapp', 2)
1217.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1218.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1219.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1220.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1221.         # both split migrations should be `initial`
1222.         self.assertTrue(changes['otherapp'][0].initial)
1223.         self.assertTrue(changes['otherapp'][1].initial)
1224. 
1225.     def test_same_app_circular_fk_dependency(self):
1226.         """
1227.         A migration with a FK between two models of the same app does
1228.         not have a dependency to itself.
1229.         """
1230.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1231.         # Right number/type of migrations?
1232.         self.assertNumberMigrations(changes, 'testapp', 1)
1233.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1234.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1235.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1236.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1237.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1238. 
1239.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1240.         """
1241.         #22275 - A migration with circular FK dependency does not try
1242.         to create unique together constraint and indexes before creating all
1243.         required fields first.
1244.         """
1245.         changes = self.get_changes([], [self.knight, self.rabbit])
1246.         # Right number/type of migrations?
1247.         self.assertNumberMigrations(changes, 'eggs', 1)
1248.         self.assertOperationTypes(
1249.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1250.         )
1251.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1252.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1253.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1254. 
1255.     def test_alter_db_table_add(self):
1256.         """Tests detection for adding db_table in model's options."""
1257.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1258.         # Right number/type of migrations?
1259.         self.assertNumberMigrations(changes, 'testapp', 1)
1260.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1261.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1262. 
1263.     def test_alter_db_table_change(self):
1264.         """Tests detection for changing db_table in model's options'."""
1265.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1266.         # Right number/type of migrations?
1267.         self.assertNumberMigrations(changes, 'testapp', 1)
1268.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1269.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1270. 
1271.     def test_alter_db_table_remove(self):
1272.         """Tests detection for removing db_table in model's options."""
1273.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1274.         # Right number/type of migrations?
1275.         self.assertNumberMigrations(changes, 'testapp', 1)
1276.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1277.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1278. 
1279.     def test_alter_db_table_no_changes(self):
1280.         """
1281.         Alter_db_table doesn't generate a migration if no changes have been made.
1282.         """
1283.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1284.         # Right number of migrations?
1285.         self.assertEqual(len(changes), 0)
1286. 
1287.     def test_keep_db_table_with_model_change(self):
1288.         """
1289.         Tests when model changes but db_table stays as-is, autodetector must not
1290.         create more than one operation.
1291.         """
1292.         changes = self.get_changes(
1293.             [self.author_with_db_table_options],
1294.             [self.author_renamed_with_db_table_options],
1295.             MigrationQuestioner({"ask_rename_model": True}),
1296.         )
1297.         # Right number/type of migrations?
1298.         self.assertNumberMigrations(changes, 'testapp', 1)
1299.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1300.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1301. 
1302.     def test_alter_db_table_with_model_change(self):
1303.         """
1304.         Tests when model and db_table changes, autodetector must create two
1305.         operations.
1306.         """
1307.         changes = self.get_changes(
1308.             [self.author_with_db_table_options],
1309.             [self.author_renamed_with_new_db_table_options],
1310.             MigrationQuestioner({"ask_rename_model": True}),
1311.         )
1312.         # Right number/type of migrations?
1313.         self.assertNumberMigrations(changes, 'testapp', 1)
1314.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1315.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1316.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1317. 
1318.     def test_identical_regex_doesnt_alter(self):
1319.         from_state = ModelState(
1320.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1321.                 RegexValidator(
1322.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1323.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1324.                     'invalid'
1325.                 )
1326.             ]))]
1327.         )
1328.         to_state = ModelState(
1329.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1330.         )
1331.         changes = self.get_changes([from_state], [to_state])
1332.         # Right number/type of migrations?
1333.         self.assertNumberMigrations(changes, "testapp", 0)
1334. 
1335.     def test_different_regex_does_alter(self):
1336.         from_state = ModelState(
1337.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1338.                 RegexValidator(
1339.                     re.compile('^[a-z]+\\Z', 32),
1340.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1341.                     'invalid'
1342.                 )
1343.             ]))]
1344.         )
1345.         to_state = ModelState(
1346.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1347.         )
1348.         changes = self.get_changes([from_state], [to_state])
1349.         self.assertNumberMigrations(changes, "testapp", 1)
1350.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1351. 
1352.     def test_empty_foo_together(self):
1353.         """
1354.         #23452 - Empty unique/index_together shouldn't generate a migration.
1355.         """
1356.         # Explicitly testing for not specified, since this is the case after
1357.         # a CreateModel operation w/o any definition on the original model
1358.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1359.         # Explicitly testing for None, since this was the issue in #23452 after
1360.         # an AlterFooTogether operation with e.g. () as value
1361.         model_state_none = ModelState("a", "model", [
1362.             ("id", models.AutoField(primary_key=True))
1363.         ], {
1364.             "index_together": None,
1365.             "unique_together": None,
1366.         })
1367.         # Explicitly testing for the empty set, since we now always have sets.
1368.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1369.         model_state_empty = ModelState("a", "model", [
1370.             ("id", models.AutoField(primary_key=True))
1371.         ], {
1372.             "index_together": set(),
1373.             "unique_together": set(),
1374.         })
1375. 
1376.         def test(from_state, to_state, msg):
1377.             changes = self.get_changes([from_state], [to_state])
1378.             if changes:
1379.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1380.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1381. 
1382.         tests = (
1383.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1384.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1385.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1386.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1387.             (model_state_none, model_state_none, '"None" to "None"'),
1388.             (model_state_none, model_state_empty, '"None" to "empty"'),
1389.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1390.             (model_state_empty, model_state_none, '"empty" to "None"'),
1391.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1392.         )
1393. 
1394.         for t in tests:
1395.             test(*t)
1396. 
1397.     def test_create_model_with_indexes(self):
1398.         """Test creation of new model with indexes already defined."""
1399.         author = ModelState('otherapp', 'Author', [
1400.             ('id', models.AutoField(primary_key=True)),
1401.             ('name', models.CharField(max_length=200)),
1402.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1403.         changes = self.get_changes([], [author])
1404.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1405.         # Right number of migrations?
1406.         self.assertEqual(len(changes['otherapp']), 1)
1407.         # Right number of actions?
1408.         migration = changes['otherapp'][0]
1409.         self.assertEqual(len(migration.operations), 2)
1410.         # Right actions order?
1411.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1412.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1413.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1414. 
1415.     def test_add_indexes(self):
1416.         """Test change detection of new indexes."""
1417.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1418.         self.assertNumberMigrations(changes, 'otherapp', 1)
1419.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1420.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1421.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1422. 
1423.     def test_remove_indexes(self):
1424.         """Test change detection of removed indexes."""
1425.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1426.         # Right number/type of migrations?
1427.         self.assertNumberMigrations(changes, 'otherapp', 1)
1428.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1429.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1430. 
1431.     def test_order_fields_indexes(self):
1432.         """Test change detection of reordering of fields in indexes."""
1433.         changes = self.get_changes(
1434.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1435.         )
1436.         self.assertNumberMigrations(changes, 'otherapp', 1)
1437.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1438.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1439.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1440.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1441. 
1442.     def test_create_model_with_check_constraint(self):
1443.         """Test creation of new model with constraints already defined."""
1444.         author = ModelState('otherapp', 'Author', [
1445.             ('id', models.AutoField(primary_key=True)),
1446.             ('name', models.CharField(max_length=200)),
1447.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1448.         changes = self.get_changes([], [author])
1449.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1450.         # Right number of migrations?
1451.         self.assertEqual(len(changes['otherapp']), 1)
1452.         # Right number of actions?
1453.         migration = changes['otherapp'][0]
1454.         self.assertEqual(len(migration.operations), 2)
1455.         # Right actions order?
1456.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1457.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1458.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1459. 
1460.     def test_add_constraints(self):
1461.         """Test change detection of new constraints."""
1462.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1463.         self.assertNumberMigrations(changes, 'testapp', 1)
1464.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1465.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1466.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1467. 
1468.     def test_remove_constraints(self):
1469.         """Test change detection of removed constraints."""
1470.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1471.         # Right number/type of migrations?
1472.         self.assertNumberMigrations(changes, 'testapp', 1)
1473.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1474.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1475. 
1476.     def test_add_foo_together(self):
1477.         """Tests index/unique_together detection."""
1478.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1479.         # Right number/type of migrations?
1480.         self.assertNumberMigrations(changes, "otherapp", 1)
1481.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1482.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1483.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1484. 
1485.     def test_remove_foo_together(self):
1486.         """Tests index/unique_together detection."""
1487.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1488.         # Right number/type of migrations?
1489.         self.assertNumberMigrations(changes, "otherapp", 1)
1490.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1491.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1492.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1493. 
1494.     def test_foo_together_remove_fk(self):
1495.         """Tests unique_together and field removal detection & ordering"""
1496.         changes = self.get_changes(
1497.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1498.         )
1499.         # Right number/type of migrations?
1500.         self.assertNumberMigrations(changes, "otherapp", 1)
1501.         self.assertOperationTypes(changes, "otherapp", 0, [


File: tests/migrations/test_autodetector.py
Line number range: 1501 - 2501
Content:
1501.         self.assertOperationTypes(changes, "otherapp", 0, [
1502.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1503.         ])
1504.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1505.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1506.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1507. 
1508.     def test_foo_together_no_changes(self):
1509.         """
1510.         index/unique_together doesn't generate a migration if no
1511.         changes have been made.
1512.         """
1513.         changes = self.get_changes(
1514.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1515.         )
1516.         # Right number of migrations?
1517.         self.assertEqual(len(changes), 0)
1518. 
1519.     def test_foo_together_ordering(self):
1520.         """
1521.         index/unique_together also triggers on ordering changes.
1522.         """
1523.         changes = self.get_changes(
1524.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1525.         )
1526.         # Right number/type of migrations?
1527.         self.assertNumberMigrations(changes, "otherapp", 1)
1528.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1529.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1530.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1531. 
1532.     def test_add_field_and_foo_together(self):
1533.         """
1534.         Added fields will be created before using them in index/unique_together.
1535.         """
1536.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1537.         # Right number/type of migrations?
1538.         self.assertNumberMigrations(changes, "otherapp", 1)
1539.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1540.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1541.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1542. 
1543.     def test_create_model_and_unique_together(self):
1544.         author = ModelState("otherapp", "Author", [
1545.             ("id", models.AutoField(primary_key=True)),
1546.             ("name", models.CharField(max_length=200)),
1547.         ])
1548.         book_with_author = ModelState("otherapp", "Book", [
1549.             ("id", models.AutoField(primary_key=True)),
1550.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1551.             ("title", models.CharField(max_length=200)),
1552.         ], {
1553.             "index_together": {("title", "author")},
1554.             "unique_together": {("title", "author")},
1555.         })
1556.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1557.         # Right number of migrations?
1558.         self.assertEqual(len(changes['otherapp']), 1)
1559.         # Right number of actions?
1560.         migration = changes['otherapp'][0]
1561.         self.assertEqual(len(migration.operations), 4)
1562.         # Right actions order?
1563.         self.assertOperationTypes(
1564.             changes, 'otherapp', 0,
1565.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1566.         )
1567. 
1568.     def test_remove_field_and_foo_together(self):
1569.         """
1570.         Removed fields will be removed after updating index/unique_together.
1571.         """
1572.         changes = self.get_changes(
1573.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1574.         )
1575.         # Right number/type of migrations?
1576.         self.assertNumberMigrations(changes, "otherapp", 1)
1577.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1578.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1579.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1580.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1581. 
1582.     def test_rename_field_and_foo_together(self):
1583.         """
1584.         Removed fields will be removed after updating index/unique_together.
1585.         """
1586.         changes = self.get_changes(
1587.             [self.author_empty, self.book_foo_together_3],
1588.             [self.author_empty, self.book_foo_together_4],
1589.             MigrationQuestioner({"ask_rename": True}),
1590.         )
1591.         # Right number/type of migrations?
1592.         self.assertNumberMigrations(changes, "otherapp", 1)
1593.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1594.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1595.             ("title", "newfield2")
1596.         })
1597.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1598. 
1599.     def test_proxy(self):
1600.         """The autodetector correctly deals with proxy models."""
1601.         # First, we test adding a proxy model
1602.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1603.         # Right number/type of migrations?
1604.         self.assertNumberMigrations(changes, "testapp", 1)
1605.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1606.         self.assertOperationAttributes(
1607.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1608.         )
1609.         # Now, we test turning a proxy model into a non-proxy model
1610.         # It should delete the proxy then make the real one
1611.         changes = self.get_changes(
1612.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1613.         )
1614.         # Right number/type of migrations?
1615.         self.assertNumberMigrations(changes, "testapp", 1)
1616.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1617.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1618.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1619. 
1620.     def test_proxy_custom_pk(self):
1621.         """
1622.         #23415 - The autodetector must correctly deal with custom FK on proxy
1623.         models.
1624.         """
1625.         # First, we test the default pk field name
1626.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1627.         # The field name the FK on the book model points to
1628.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1629.         # Now, we test the custom pk field name
1630.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1631.         # The field name the FK on the book model points to
1632.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1633. 
1634.     def test_proxy_to_mti_with_fk_to_proxy(self):
1635.         # First, test the pk table and field name.
1636.         changes = self.get_changes(
1637.             [],
1638.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1639.         )
1640.         self.assertEqual(
1641.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1642.             'testapp_author',
1643.         )
1644.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1645. 
1646.         # Change AuthorProxy to use MTI.
1647.         changes = self.get_changes(
1648.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1649.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1650.         )
1651.         # Right number/type of migrations for the AuthorProxy model?
1652.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1653.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1654.         # Right number/type of migrations for the Book model with a FK to
1655.         # AuthorProxy?
1656.         self.assertNumberMigrations(changes, 'otherapp', 1)
1657.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1658.         # otherapp should depend on thirdapp.
1659.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1660.         # Now, test the pk table and field name.
1661.         self.assertEqual(
1662.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1663.             'thirdapp_authorproxy',
1664.         )
1665.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1666. 
1667.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1668.         # First, test the pk table and field name.
1669.         changes = self.get_changes(
1670.             [],
1671.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1672.         )
1673.         self.assertEqual(
1674.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1675.             'testapp_author',
1676.         )
1677.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1678. 
1679.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1680.         # a proxy of AuthorProxy.
1681.         changes = self.get_changes(
1682.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1683.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1684.         )
1685.         # Right number/type of migrations for the AuthorProxy model?
1686.         self.assertNumberMigrations(changes, 'testapp', 1)
1687.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1688.         # Right number/type of migrations for the Book model with a FK to
1689.         # AAuthorProxyProxy?
1690.         self.assertNumberMigrations(changes, 'otherapp', 1)
1691.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1692.         # otherapp should depend on testapp.
1693.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1694.         # Now, test the pk table and field name.
1695.         self.assertEqual(
1696.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1697.             'testapp_authorproxy',
1698.         )
1699.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1700. 
1701.     def test_unmanaged_create(self):
1702.         """The autodetector correctly deals with managed models."""
1703.         # First, we test adding an unmanaged model
1704.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1705.         # Right number/type of migrations?
1706.         self.assertNumberMigrations(changes, 'testapp', 1)
1707.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1708.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1709. 
1710.     def test_unmanaged_delete(self):
1711.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1712.         self.assertNumberMigrations(changes, 'testapp', 1)
1713.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1714. 
1715.     def test_unmanaged_to_managed(self):
1716.         # Now, we test turning an unmanaged model into a managed model
1717.         changes = self.get_changes(
1718.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1719.         )
1720.         # Right number/type of migrations?
1721.         self.assertNumberMigrations(changes, 'testapp', 1)
1722.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1723.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1724. 
1725.     def test_managed_to_unmanaged(self):
1726.         # Now, we turn managed to unmanaged.
1727.         changes = self.get_changes(
1728.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1729.         )
1730.         # Right number/type of migrations?
1731.         self.assertNumberMigrations(changes, 'testapp', 1)
1732.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1733.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1734. 
1735.     def test_unmanaged_custom_pk(self):
1736.         """
1737.         #23415 - The autodetector must correctly deal with custom FK on
1738.         unmanaged models.
1739.         """
1740.         # First, we test the default pk field name
1741.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1742.         # The field name the FK on the book model points to
1743.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1744.         # Now, we test the custom pk field name
1745.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1746.         # The field name the FK on the book model points to
1747.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1748. 
1749.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1750.     def test_swappable(self):
1751.         with isolate_lru_cache(apps.get_swappable_settings_name):
1752.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1753.         # Right number/type of migrations?
1754.         self.assertNumberMigrations(changes, 'testapp', 1)
1755.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1756.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1757.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1758. 
1759.     def test_swappable_changed(self):
1760.         with isolate_lru_cache(apps.get_swappable_settings_name):
1761.             before = self.make_project_state([self.custom_user, self.author_with_user])
1762.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1763.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1764.             autodetector = MigrationAutodetector(before, after)
1765.             changes = autodetector._detect_changes()
1766.         # Right number/type of migrations?
1767.         self.assertNumberMigrations(changes, 'testapp', 1)
1768.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1769.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1770.         fk_field = changes['testapp'][0].operations[0].field
1771.         to_model = '%s.%s' % (
1772.             fk_field.remote_field.model._meta.app_label,
1773.             fk_field.remote_field.model._meta.object_name,
1774.         )
1775.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1776. 
1777.     def test_add_field_with_default(self):
1778.         """#22030 - Adding a field with a default should work."""
1779.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1780.         # Right number/type of migrations?
1781.         self.assertNumberMigrations(changes, 'testapp', 1)
1782.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1783.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1784. 
1785.     def test_custom_deconstructible(self):
1786.         """
1787.         Two instances which deconstruct to the same value aren't considered a
1788.         change.
1789.         """
1790.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1791.         # Right number of migrations?
1792.         self.assertEqual(len(changes), 0)
1793. 
1794.     def test_deconstruct_field_kwarg(self):
1795.         """Field instances are handled correctly by nested deconstruction."""
1796.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1797.         self.assertEqual(changes, {})
1798. 
1799.     def test_deconstructible_list(self):
1800.         """Nested deconstruction descends into lists."""
1801.         # When lists contain items that deconstruct to identical values, those lists
1802.         # should be considered equal for the purpose of detecting state changes
1803.         # (even if the original items are unequal).
1804.         changes = self.get_changes(
1805.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1806.         )
1807.         self.assertEqual(changes, {})
1808.         # Legitimate differences within the deconstructed lists should be reported
1809.         # as a change
1810.         changes = self.get_changes(
1811.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1812.         )
1813.         self.assertEqual(len(changes), 1)
1814. 
1815.     def test_deconstructible_tuple(self):
1816.         """Nested deconstruction descends into tuples."""
1817.         # When tuples contain items that deconstruct to identical values, those tuples
1818.         # should be considered equal for the purpose of detecting state changes
1819.         # (even if the original items are unequal).
1820.         changes = self.get_changes(
1821.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1822.         )
1823.         self.assertEqual(changes, {})
1824.         # Legitimate differences within the deconstructed tuples should be reported
1825.         # as a change
1826.         changes = self.get_changes(
1827.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1828.         )
1829.         self.assertEqual(len(changes), 1)
1830. 
1831.     def test_deconstructible_dict(self):
1832.         """Nested deconstruction descends into dict values."""
1833.         # When dicts contain items whose values deconstruct to identical values,
1834.         # those dicts should be considered equal for the purpose of detecting
1835.         # state changes (even if the original values are unequal).
1836.         changes = self.get_changes(
1837.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1838.         )
1839.         self.assertEqual(changes, {})
1840.         # Legitimate differences within the deconstructed dicts should be reported
1841.         # as a change
1842.         changes = self.get_changes(
1843.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1844.         )
1845.         self.assertEqual(len(changes), 1)
1846. 
1847.     def test_nested_deconstructible_objects(self):
1848.         """
1849.         Nested deconstruction is applied recursively to the args/kwargs of
1850.         deconstructed objects.
1851.         """
1852.         # If the items within a deconstructed object's args/kwargs have the same
1853.         # deconstructed values - whether or not the items themselves are different
1854.         # instances - then the object as a whole is regarded as unchanged.
1855.         changes = self.get_changes(
1856.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1857.         )
1858.         self.assertEqual(changes, {})
1859.         # Differences that exist solely within the args list of a deconstructed object
1860.         # should be reported as changes
1861.         changes = self.get_changes(
1862.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1863.         )
1864.         self.assertEqual(len(changes), 1)
1865.         # Additional args should also be reported as a change
1866.         changes = self.get_changes(
1867.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1868.         )
1869.         self.assertEqual(len(changes), 1)
1870.         # Differences that exist solely within the kwargs dict of a deconstructed object
1871.         # should be reported as changes
1872.         changes = self.get_changes(
1873.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1874.         )
1875.         self.assertEqual(len(changes), 1)
1876.         # Additional kwargs should also be reported as a change
1877.         changes = self.get_changes(
1878.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1879.         )
1880.         self.assertEqual(len(changes), 1)
1881. 
1882.     def test_deconstruct_type(self):
1883.         """
1884.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1885.         by deep_deconstruct during serialization.
1886.         """
1887.         author = ModelState(
1888.             "testapp",
1889.             "Author",
1890.             [
1891.                 ("id", models.AutoField(primary_key=True)),
1892.                 ("name", models.CharField(
1893.                     max_length=200,
1894.                     # IntegerField intentionally not instantiated.
1895.                     default=models.IntegerField,
1896.                 ))
1897.             ],
1898.         )
1899.         changes = self.get_changes([], [author])
1900.         # Right number/type of migrations?
1901.         self.assertNumberMigrations(changes, 'testapp', 1)
1902.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1903. 
1904.     def test_replace_string_with_foreignkey(self):
1905.         """
1906.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1907.         work.
1908.         """
1909.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1910.         # Right number/type of migrations?
1911.         self.assertNumberMigrations(changes, 'testapp', 1)
1912.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1913.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1914.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1915.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1916. 
1917.     def test_foreign_key_removed_before_target_model(self):
1918.         """
1919.         Removing an FK and the model it targets in the same change must remove
1920.         the FK field before the model to maintain consistency.
1921.         """
1922.         changes = self.get_changes(
1923.             [self.author_with_publisher, self.publisher], [self.author_name]
1924.         )  # removes both the model and FK
1925.         # Right number/type of migrations?
1926.         self.assertNumberMigrations(changes, 'testapp', 1)
1927.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1928.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1929.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1930. 
1931.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1932.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1933.     def test_add_many_to_many(self, mocked_ask_method):
1934.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1935.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1936.         # Right number/type of migrations?
1937.         self.assertNumberMigrations(changes, 'testapp', 1)
1938.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1939.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1940. 
1941.     def test_alter_many_to_many(self):
1942.         changes = self.get_changes(
1943.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1944.         )
1945.         # Right number/type of migrations?
1946.         self.assertNumberMigrations(changes, 'testapp', 1)
1947.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1948.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1949. 
1950.     def test_create_with_through_model(self):
1951.         """
1952.         Adding a m2m with a through model and the models that use it should be
1953.         ordered correctly.
1954.         """
1955.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1956.         # Right number/type of migrations?
1957.         self.assertNumberMigrations(changes, "testapp", 1)
1958.         self.assertOperationTypes(changes, "testapp", 0, [
1959.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1960.         ])
1961.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1962.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1963.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1964.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1965. 
1966.     def test_many_to_many_removed_before_through_model(self):
1967.         """
1968.         Removing a ManyToManyField and the "through" model in the same change
1969.         must remove the field before the model to maintain consistency.
1970.         """
1971.         changes = self.get_changes(
1972.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1973.             [self.book_with_no_author, self.author_name],
1974.         )
1975.         # Remove both the through model and ManyToMany
1976.         # Right number/type of migrations?
1977.         self.assertNumberMigrations(changes, "otherapp", 1)
1978.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1979.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1980.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1981. 
1982.     def test_many_to_many_removed_before_through_model_2(self):
1983.         """
1984.         Removing a model that contains a ManyToManyField and the "through" model
1985.         in the same change must remove the field before the model to maintain
1986.         consistency.
1987.         """
1988.         changes = self.get_changes(
1989.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1990.             [self.author_name],
1991.         )
1992.         # Remove both the through model and ManyToMany
1993.         # Right number/type of migrations?
1994.         self.assertNumberMigrations(changes, "otherapp", 1)
1995.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
1996.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1997.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1998.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
1999. 
2000.     def test_m2m_w_through_multistep_remove(self):
2001.         """
2002.         A model with a m2m field that specifies a "through" model cannot be
2003.         removed in the same migration as that through model as the schema will
2004.         pass through an inconsistent state. The autodetector should produce two
2005.         migrations to avoid this issue.
2006.         """
2007.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
2008.         # Right number/type of migrations?
2009.         self.assertNumberMigrations(changes, "testapp", 1)
2010.         self.assertOperationTypes(changes, "testapp", 0, [
2011.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
2012.         ])
2013.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
2014.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
2015.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
2016.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
2017. 
2018.     def test_concrete_field_changed_to_many_to_many(self):
2019.         """
2020.         #23938 - Changing a concrete field into a ManyToManyField
2021.         first removes the concrete field and then adds the m2m field.
2022.         """
2023.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
2024.         # Right number/type of migrations?
2025.         self.assertNumberMigrations(changes, "testapp", 1)
2026.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
2027.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
2028.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2029.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
2030. 
2031.     def test_many_to_many_changed_to_concrete_field(self):
2032.         """
2033.         #23938 - Changing a ManyToManyField into a concrete field
2034.         first removes the m2m field and then adds the concrete field.
2035.         """
2036.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
2037.         # Right number/type of migrations?
2038.         self.assertNumberMigrations(changes, "testapp", 1)
2039.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
2040.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
2041.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2042.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
2043.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
2044. 
2045.     def test_non_circular_foreignkey_dependency_removal(self):
2046.         """
2047.         If two models with a ForeignKey from one to the other are removed at the
2048.         same time, the autodetector should remove them in the correct order.
2049.         """
2050.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2051.         # Right number/type of migrations?
2052.         self.assertNumberMigrations(changes, "testapp", 1)
2053.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2054.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2055.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2056.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2057. 
2058.     def test_alter_model_options(self):
2059.         """Changing a model's options should make a change."""
2060.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2061.         # Right number/type of migrations?
2062.         self.assertNumberMigrations(changes, "testapp", 1)
2063.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2064.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2065.             "permissions": [('can_hire', 'Can hire')],
2066.             "verbose_name": "Authi",
2067.         })
2068. 
2069.         # Changing them back to empty should also make a change
2070.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2071.         # Right number/type of migrations?
2072.         self.assertNumberMigrations(changes, "testapp", 1)
2073.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2074.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2075. 
2076.     def test_alter_model_options_proxy(self):
2077.         """Changing a proxy model's options should also make a change."""
2078.         changes = self.get_changes(
2079.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2080.         )
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, "testapp", 1)
2083.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2084.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2085.             "verbose_name": "Super Author"
2086.         })
2087. 
2088.     def test_set_alter_order_with_respect_to(self):
2089.         """Setting order_with_respect_to adds a field."""
2090.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2091.         # Right number/type of migrations?
2092.         self.assertNumberMigrations(changes, 'testapp', 1)
2093.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2094.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2095. 
2096.     def test_add_alter_order_with_respect_to(self):
2097.         """
2098.         Setting order_with_respect_to when adding the FK too does
2099.         things in the right order.
2100.         """
2101.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2102.         # Right number/type of migrations?
2103.         self.assertNumberMigrations(changes, 'testapp', 1)
2104.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2105.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2106.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2107. 
2108.     def test_remove_alter_order_with_respect_to(self):
2109.         """
2110.         Removing order_with_respect_to when removing the FK too does
2111.         things in the right order.
2112.         """
2113.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2114.         # Right number/type of migrations?
2115.         self.assertNumberMigrations(changes, 'testapp', 1)
2116.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2117.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2118.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2119. 
2120.     def test_add_model_order_with_respect_to(self):
2121.         """
2122.         Setting order_with_respect_to when adding the whole model
2123.         does things in the right order.
2124.         """
2125.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2126.         # Right number/type of migrations?
2127.         self.assertNumberMigrations(changes, 'testapp', 1)
2128.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2129.         self.assertOperationAttributes(
2130.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2131.         )
2132.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2133. 
2134.     def test_alter_model_managers(self):
2135.         """
2136.         Changing the model managers adds a new operation.
2137.         """
2138.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2139.         # Right number/type of migrations?
2140.         self.assertNumberMigrations(changes, 'otherapp', 1)
2141.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2142.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2143.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2144.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2145.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2146.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2147. 
2148.     def test_swappable_first_inheritance(self):
2149.         """Swappable models get their CreateModel first."""
2150.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2151.         # Right number/type of migrations?
2152.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2153.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2154.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2155.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2156. 
2157.     def test_default_related_name_option(self):
2158.         model_state = ModelState('app', 'model', [
2159.             ('id', models.AutoField(primary_key=True)),
2160.         ], options={'default_related_name': 'related_name'})
2161.         changes = self.get_changes([], [model_state])
2162.         self.assertNumberMigrations(changes, 'app', 1)
2163.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2164.         self.assertOperationAttributes(
2165.             changes, 'app', 0, 0, name='model',
2166.             options={'default_related_name': 'related_name'},
2167.         )
2168.         altered_model_state = ModelState('app', 'Model', [
2169.             ('id', models.AutoField(primary_key=True)),
2170.         ])
2171.         changes = self.get_changes([model_state], [altered_model_state])
2172.         self.assertNumberMigrations(changes, 'app', 1)
2173.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2174.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2175. 
2176.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2177.     def test_swappable_first_setting(self):
2178.         """Swappable models get their CreateModel first."""
2179.         with isolate_lru_cache(apps.get_swappable_settings_name):
2180.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2181.         # Right number/type of migrations?
2182.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2183.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2184.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2185.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2186. 
2187.     def test_bases_first(self):
2188.         """Bases of other models come first."""
2189.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2190.         # Right number/type of migrations?
2191.         self.assertNumberMigrations(changes, 'testapp', 1)
2192.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2193.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2194.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2195. 
2196.     def test_multiple_bases(self):
2197.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2198.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2199.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2200.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2201.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2202.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2203.         changes = self.get_changes([], [A, B, C, D, E])
2204.         # Right number/type of migrations?
2205.         self.assertNumberMigrations(changes, "app", 1)
2206.         self.assertOperationTypes(changes, "app", 0, [
2207.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2208.         ])
2209.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2210.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2211.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2212.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2213.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2214. 
2215.     def test_proxy_bases_first(self):
2216.         """Bases of proxies come first."""
2217.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2218.         # Right number/type of migrations?
2219.         self.assertNumberMigrations(changes, 'testapp', 1)
2220.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2221.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2222.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2223.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2224. 
2225.     def test_pk_fk_included(self):
2226.         """
2227.         A relation used as the primary key is kept as part of CreateModel.
2228.         """
2229.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2230.         # Right number/type of migrations?
2231.         self.assertNumberMigrations(changes, 'testapp', 1)
2232.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2233.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2234.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2235. 
2236.     def test_first_dependency(self):
2237.         """
2238.         A dependency to an app with no migrations uses __first__.
2239.         """
2240.         # Load graph
2241.         loader = MigrationLoader(connection)
2242.         before = self.make_project_state([])
2243.         after = self.make_project_state([self.book_migrations_fk])
2244.         after.real_apps = ["migrations"]
2245.         autodetector = MigrationAutodetector(before, after)
2246.         changes = autodetector._detect_changes(graph=loader.graph)
2247.         # Right number/type of migrations?
2248.         self.assertNumberMigrations(changes, 'otherapp', 1)
2249.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2250.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2251.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2252. 
2253.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2254.     def test_last_dependency(self):
2255.         """
2256.         A dependency to an app with existing migrations uses the
2257.         last migration of that app.
2258.         """
2259.         # Load graph
2260.         loader = MigrationLoader(connection)
2261.         before = self.make_project_state([])
2262.         after = self.make_project_state([self.book_migrations_fk])
2263.         after.real_apps = ["migrations"]
2264.         autodetector = MigrationAutodetector(before, after)
2265.         changes = autodetector._detect_changes(graph=loader.graph)
2266.         # Right number/type of migrations?
2267.         self.assertNumberMigrations(changes, 'otherapp', 1)
2268.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2269.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2270.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2271. 
2272.     def test_alter_fk_before_model_deletion(self):
2273.         """
2274.         ForeignKeys are altered _before_ the model they used to
2275.         refer to are deleted.
2276.         """
2277.         changes = self.get_changes(
2278.             [self.author_name, self.publisher_with_author],
2279.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2280.         )
2281.         # Right number/type of migrations?
2282.         self.assertNumberMigrations(changes, 'testapp', 1)
2283.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2284.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2285.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2286.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2287. 
2288.     def test_fk_dependency_other_app(self):
2289.         """
2290.         #23100 - ForeignKeys correctly depend on other apps' models.
2291.         """
2292.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2293.         # Right number/type of migrations?
2294.         self.assertNumberMigrations(changes, 'testapp', 1)
2295.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2296.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2297.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2298. 
2299.     def test_alter_field_to_fk_dependency_other_app(self):
2300.         changes = self.get_changes(
2301.             [self.author_empty, self.book_with_no_author_fk],
2302.             [self.author_empty, self.book],
2303.         )
2304.         self.assertNumberMigrations(changes, 'otherapp', 1)
2305.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
2306.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', '__first__')])
2307. 
2308.     def test_circular_dependency_mixed_addcreate(self):
2309.         """
2310.         #23315 - The dependency resolver knows to put all CreateModel
2311.         before AddField and not become unsolvable.
2312.         """
2313.         address = ModelState("a", "Address", [
2314.             ("id", models.AutoField(primary_key=True)),
2315.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2316.         ])
2317.         person = ModelState("a", "Person", [
2318.             ("id", models.AutoField(primary_key=True)),
2319.         ])
2320.         apackage = ModelState("b", "APackage", [
2321.             ("id", models.AutoField(primary_key=True)),
2322.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2323.         ])
2324.         country = ModelState("b", "DeliveryCountry", [
2325.             ("id", models.AutoField(primary_key=True)),
2326.         ])
2327.         changes = self.get_changes([], [address, person, apackage, country])
2328.         # Right number/type of migrations?
2329.         self.assertNumberMigrations(changes, 'a', 2)
2330.         self.assertNumberMigrations(changes, 'b', 1)
2331.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2332.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2333.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2334. 
2335.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2336.     def test_circular_dependency_swappable(self):
2337.         """
2338.         #23322 - The dependency resolver knows to explicitly resolve
2339.         swappable models.
2340.         """
2341.         with isolate_lru_cache(apps.get_swappable_settings_name):
2342.             tenant = ModelState("a", "Tenant", [
2343.                 ("id", models.AutoField(primary_key=True)),
2344.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2345.                 bases=(AbstractBaseUser,)
2346.             )
2347.             address = ModelState("b", "Address", [
2348.                 ("id", models.AutoField(primary_key=True)),
2349.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2350.             ])
2351.             changes = self.get_changes([], [address, tenant])
2352. 
2353.         # Right number/type of migrations?
2354.         self.assertNumberMigrations(changes, 'a', 2)
2355.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2356.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2357.         self.assertMigrationDependencies(changes, 'a', 0, [])
2358.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2359.         # Right number/type of migrations?
2360.         self.assertNumberMigrations(changes, 'b', 1)
2361.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2362.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2363. 
2364.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2365.     def test_circular_dependency_swappable2(self):
2366.         """
2367.         #23322 - The dependency resolver knows to explicitly resolve
2368.         swappable models but with the swappable not being the first migrated
2369.         model.
2370.         """
2371.         with isolate_lru_cache(apps.get_swappable_settings_name):
2372.             address = ModelState("a", "Address", [
2373.                 ("id", models.AutoField(primary_key=True)),
2374.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2375.             ])
2376.             tenant = ModelState("b", "Tenant", [
2377.                 ("id", models.AutoField(primary_key=True)),
2378.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2379.                 bases=(AbstractBaseUser,)
2380.             )
2381.             changes = self.get_changes([], [address, tenant])
2382.         # Right number/type of migrations?
2383.         self.assertNumberMigrations(changes, 'a', 2)
2384.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2385.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2386.         self.assertMigrationDependencies(changes, 'a', 0, [])
2387.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2388.         # Right number/type of migrations?
2389.         self.assertNumberMigrations(changes, 'b', 1)
2390.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2391.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2392. 
2393.     @override_settings(AUTH_USER_MODEL="a.Person")
2394.     def test_circular_dependency_swappable_self(self):
2395.         """
2396.         #23322 - The dependency resolver knows to explicitly resolve
2397.         swappable models.
2398.         """
2399.         with isolate_lru_cache(apps.get_swappable_settings_name):
2400.             person = ModelState("a", "Person", [
2401.                 ("id", models.AutoField(primary_key=True)),
2402.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2403.             ])
2404.             changes = self.get_changes([], [person])
2405.         # Right number/type of migrations?
2406.         self.assertNumberMigrations(changes, 'a', 1)
2407.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2408.         self.assertMigrationDependencies(changes, 'a', 0, [])
2409. 
2410.     @override_settings(AUTH_USER_MODEL='a.User')
2411.     def test_swappable_circular_multi_mti(self):
2412.         with isolate_lru_cache(apps.get_swappable_settings_name):
2413.             parent = ModelState('a', 'Parent', [
2414.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2415.             ])
2416.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2417.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2418.             changes = self.get_changes([], [parent, child, user])
2419.         self.assertNumberMigrations(changes, 'a', 1)
2420.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2421. 
2422.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2423.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2424.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2425.         """
2426.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2427.         without default should not prompt for a default.
2428.         """
2429.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2430.         # Right number/type of migrations?
2431.         self.assertNumberMigrations(changes, 'testapp', 1)
2432.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2433.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2434. 
2435.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2436.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2437.         """
2438.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2439.         without default should prompt for a default.
2440.         """
2441.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2442.         self.assertEqual(mocked_ask_method.call_count, 2)
2443.         # Right number/type of migrations?
2444.         self.assertNumberMigrations(changes, 'testapp', 1)
2445.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2446.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2447. 
2448.     def test_mti_inheritance_model_removal(self):
2449.         Animal = ModelState('app', 'Animal', [
2450.             ("id", models.AutoField(primary_key=True)),
2451.         ])
2452.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2453.         changes = self.get_changes([Animal, Dog], [Animal])
2454.         self.assertNumberMigrations(changes, 'app', 1)
2455.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2456.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 20:03:08,877 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user explicitly requested the full content of the file `tests/migrations/test_autodetector.py`. The provided context contains the entire content of this file, which directly fulfills the user's request.", relative_path='tests/migrations/test_autodetector.py', start_line=1, end_line=2456)]
2025-12-23 20:03:08,881 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of tests/migrations/test_autodetector.py.
2025-12-23 20:03:08,881 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 20:03:08,882 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 20:03:08,882 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 20:03:08,882 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 20:03:08,883 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_system_checks.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── specific_system_checks.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: FieldError when migrating field to new model subclass.

Description: Description
	
Analogous to #21890. If creating a model subclass and moving a field onto it in the same step, makemigrations works but migrate dies with django.core.exceptions.FieldError: Local field 'title' in class 'Book' clashes with field of the same name from base class 'Readable'.
For example, take this model:
from django.db import models
class Readable(models.Model):
	title = models.CharField(max_length=200)
And change to this:
from django.db import models
class Readable(models.Model):
	pass
class Book(Readable):
	title = models.CharField(max_length=200)
The migration generates with CreateModel for Book, then RemoveField for Readable.title. But running it produces the error.
Reversing the order of the migration operations makes it pass. The auto-detector should be able to use this order.

Patch information:
diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py
index 30616c0172..fb8f074e70 100644
--- a/django/db/migrations/autodetector.py
+++ b/django/db/migrations/autodetector.py
@@ -563,6 +563,22 @@ class MigrationAutodetector:
                 if isinstance(base, str) and "." in base:
                     base_app_label, base_name = base.split(".", 1)
                     dependencies.append((base_app_label, base_name, None, True))
+            # If a new model defines a local field with the same name as a field
+            # that is being removed from any of its (non-abstract) base models
+            # in the same migration, depend on the removal of that field to avoid
+            # model rendering conflicts (#21890-like cases).
+            non_rel_field_names = {
+                name for name, field in model_state.fields.items()
+                if name not in related_fields
+            }
+            for base in model_state.bases:
+                if isinstance(base, str) and "." in base:
+                    base_app_label, base_name = base.split(".", 1)
+                    base_name_lower = base_name.lower()
+                    for field_name in non_rel_field_names:
+                        dep_key = (base_app_label, base_name_lower, field_name)
+                        if dep_key in self.old_field_keys and dep_key not in self.new_field_keys:
+                            dependencies.append((base_app_label, base_name, field_name, False))
             # Depend on the other end of the primary key if it's a relation
             if primary_key_rel:
                 dependencies.append((
@@ -871,6 +887,16 @@ class MigrationAutodetector:
                 field.default = self.questioner.ask_auto_now_add_addition(field_name, model_name)
             else:
                 field.default = self.questioner.ask_not_null_addition(field_name, model_name)
+        # If adding a field to a subclass that has the same name as a field
+        # being removed from one of its base models in the same migration,
+        # depend on that removal to avoid model rendering conflicts.
+        model_state = self.to_state.models[app_label, model_name]
+        for base in model_state.bases:
+            if isinstance(base, str) and "." in base:
+                base_app_label, base_name = base.split(".", 1)
+                dep_key = (base_app_label, base_name.lower(), field_name)
+                if dep_key in self.old_field_keys and dep_key not in self.new_field_keys:
+                    dependencies.append((base_app_label, base_name, field_name, False))
         self.add_operation(
             app_label,
             operations.AddField(


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of tests/migrations/test_autodetector.py.
Extra Requirements: 
Purpose: I need this file to find test cases that cover the migration autodetector's handling of moving fields between base and subclass models, which is the scenario described in the bug report.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/migrations/test_autodetector.py
Line number range: 1 - 2456
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author_fk = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("author", models.IntegerField()),
358.         ("title", models.CharField(max_length=200)),
359.     ])
360.     book_with_no_author = ModelState("otherapp", "Book", [
361.         ("id", models.AutoField(primary_key=True)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
382.         ("title", models.CharField(max_length=200)),
383.     ])
384.     book_indexes = ModelState("otherapp", "Book", [
385.         ("id", models.AutoField(primary_key=True)),
386.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
387.         ("title", models.CharField(max_length=200)),
388.     ], {
389.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
390.     })
391.     book_unordered_indexes = ModelState("otherapp", "Book", [
392.         ("id", models.AutoField(primary_key=True)),
393.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
394.         ("title", models.CharField(max_length=200)),
395.     ], {
396.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
397.     })
398.     book_foo_together = ModelState("otherapp", "Book", [
399.         ("id", models.AutoField(primary_key=True)),
400.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
401.         ("title", models.CharField(max_length=200)),
402.     ], {
403.         "index_together": {("author", "title")},
404.         "unique_together": {("author", "title")},
405.     })
406.     book_foo_together_2 = ModelState("otherapp", "Book", [
407.         ("id", models.AutoField(primary_key=True)),
408.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
409.         ("title", models.CharField(max_length=200)),
410.     ], {
411.         "index_together": {("title", "author")},
412.         "unique_together": {("title", "author")},
413.     })
414.     book_foo_together_3 = ModelState("otherapp", "Book", [
415.         ("id", models.AutoField(primary_key=True)),
416.         ("newfield", models.IntegerField()),
417.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
418.         ("title", models.CharField(max_length=200)),
419.     ], {
420.         "index_together": {("title", "newfield")},
421.         "unique_together": {("title", "newfield")},
422.     })
423.     book_foo_together_4 = ModelState("otherapp", "Book", [
424.         ("id", models.AutoField(primary_key=True)),
425.         ("newfield2", models.IntegerField()),
426.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
427.         ("title", models.CharField(max_length=200)),
428.     ], {
429.         "index_together": {("title", "newfield2")},
430.         "unique_together": {("title", "newfield2")},
431.     })
432.     attribution = ModelState("otherapp", "Attribution", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
435.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
436.     ])
437.     edition = ModelState("thirdapp", "Edition", [
438.         ("id", models.AutoField(primary_key=True)),
439.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
440.     ])
441.     custom_user = ModelState("thirdapp", "CustomUser", [
442.         ("id", models.AutoField(primary_key=True)),
443.         ("username", models.CharField(max_length=255)),
444.     ], bases=(AbstractBaseUser,))
445.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
446.         ("id", models.AutoField(primary_key=True)),
447.         ("username", models.CharField(max_length=255)),
448.     ])
449.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
450.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
451.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
452.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
453.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
454.     ])
455.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
456.     rabbit = ModelState("eggs", "Rabbit", [
457.         ("id", models.AutoField(primary_key=True)),
458.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
459.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
460.     ], {
461.         "unique_together": {("parent", "knight")},
462.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
463.     })
464. 
465.     def repr_changes(self, changes, include_dependencies=False):
466.         output = ""
467.         for app_label, migrations in sorted(changes.items()):
468.             output += "  %s:\n" % app_label
469.             for migration in migrations:
470.                 output += "    %s\n" % migration.name
471.                 for operation in migration.operations:
472.                     output += "      %s\n" % operation
473.                 if include_dependencies:
474.                     output += "      Dependencies:\n"
475.                     if migration.dependencies:
476.                         for dep in migration.dependencies:
477.                             output += "        %s\n" % (dep,)
478.                     else:
479.                         output += "        None\n"
480.         return output
481. 
482.     def assertNumberMigrations(self, changes, app_label, number):
483.         if len(changes.get(app_label, [])) != number:
484.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
485.                 len(changes.get(app_label, [])),
486.                 app_label,
487.                 number,
488.                 self.repr_changes(changes),
489.             ))
490. 
491.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
492.         if not changes.get(app_label):
493.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
494.         if len(changes[app_label]) < position + 1:
495.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
496.         migration = changes[app_label][position]
497.         if set(migration.dependencies) != set(dependencies):
498.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
499.                 app_label,
500.                 migration.name,
501.                 dependencies,
502.                 self.repr_changes(changes, include_dependencies=True),
503.             ))
504. 
505.     def assertOperationTypes(self, changes, app_label, position, types):
506.         if not changes.get(app_label):
507.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
508.         if len(changes[app_label]) < position + 1:
509.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
510.         migration = changes[app_label][position]
511.         real_types = [operation.__class__.__name__ for operation in migration.operations]
512.         if types != real_types:
513.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
514.                 app_label,
515.                 migration.name,
516.                 types,
517.                 self.repr_changes(changes),
518.             ))
519. 
520.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
521.         if not changes.get(app_label):
522.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
523.         if len(changes[app_label]) < position + 1:
524.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
525.         migration = changes[app_label][position]
526.         if len(changes[app_label]) < position + 1:
527.             self.fail("No operation at index %s for %s.%s\n%s" % (
528.                 operation_position,
529.                 app_label,
530.                 migration.name,
531.                 self.repr_changes(changes),
532.             ))
533.         operation = migration.operations[operation_position]
534.         for attr, value in attrs.items():
535.             if getattr(operation, attr, None) != value:
536.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
537.                     app_label,
538.                     migration.name,
539.                     operation_position,
540.                     attr,
541.                     value,
542.                     getattr(operation, attr, None),
543.                     self.repr_changes(changes),
544.                 ))
545. 
546.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
547.         if not changes.get(app_label):
548.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
549.         if len(changes[app_label]) < position + 1:
550.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
551.         migration = changes[app_label][position]
552.         if len(changes[app_label]) < position + 1:
553.             self.fail("No operation at index %s for %s.%s\n%s" % (
554.                 operation_position,
555.                 app_label,
556.                 migration.name,
557.                 self.repr_changes(changes),
558.             ))
559.         operation = migration.operations[operation_position]
560.         if not hasattr(operation, 'field'):
561.             self.fail("No field attribute for %s.%s op #%s." % (
562.                 app_label,
563.                 migration.name,
564.                 operation_position,
565.             ))
566.         field = operation.field
567.         for attr, value in attrs.items():
568.             if getattr(field, attr, None) != value:
569.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
570.                     app_label,
571.                     migration.name,
572.                     operation_position,
573.                     attr,
574.                     value,
575.                     getattr(field, attr, None),
576.                     self.repr_changes(changes),
577.                 ))
578. 
579.     def make_project_state(self, model_states):
580.         "Shortcut to make ProjectStates from lists of predefined models"
581.         project_state = ProjectState()
582.         for model_state in model_states:
583.             project_state.add_model(model_state.clone())
584.         return project_state
585. 
586.     def get_changes(self, before_states, after_states, questioner=None):
587.         return MigrationAutodetector(
588.             self.make_project_state(before_states),
589.             self.make_project_state(after_states),
590.             questioner,
591.         )._detect_changes()
592. 
593.     def test_arrange_for_graph(self):
594.         """Tests auto-naming of migrations for graph matching."""
595.         # Make a fake graph
596.         graph = MigrationGraph()
597.         graph.add_node(("testapp", "0001_initial"), None)
598.         graph.add_node(("testapp", "0002_foobar"), None)
599.         graph.add_node(("otherapp", "0001_initial"), None)
600.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
601.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
602.         # Use project state to make a new migration change set
603.         before = self.make_project_state([])
604.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
605.         autodetector = MigrationAutodetector(before, after)
606.         changes = autodetector._detect_changes()
607.         # Run through arrange_for_graph
608.         changes = autodetector.arrange_for_graph(changes, graph)
609.         # Make sure there's a new name, deps match, etc.
610.         self.assertEqual(changes["testapp"][0].name, "0003_author")
611.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
612.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
613.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
614. 
615.     def test_trim_apps(self):
616.         """
617.         Trim does not remove dependencies but does remove unwanted apps.
618.         """
619.         # Use project state to make a new migration change set
620.         before = self.make_project_state([])
621.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
622.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
623.         changes = autodetector._detect_changes()
624.         # Run through arrange_for_graph
625.         graph = MigrationGraph()
626.         changes = autodetector.arrange_for_graph(changes, graph)
627.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
628.         changes = autodetector._trim_to_apps(changes, {"testapp"})
629.         # Make sure there's the right set of migrations
630.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
631.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
632.         self.assertNotIn("thirdapp", changes)
633. 
634.     def test_custom_migration_name(self):
635.         """Tests custom naming of migrations for graph matching."""
636.         # Make a fake graph
637.         graph = MigrationGraph()
638.         graph.add_node(("testapp", "0001_initial"), None)
639.         graph.add_node(("testapp", "0002_foobar"), None)
640.         graph.add_node(("otherapp", "0001_initial"), None)
641.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
642. 
643.         # Use project state to make a new migration change set
644.         before = self.make_project_state([])
645.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
646.         autodetector = MigrationAutodetector(before, after)
647.         changes = autodetector._detect_changes()
648. 
649.         # Run through arrange_for_graph
650.         migration_name = 'custom_name'
651.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
652. 
653.         # Make sure there's a new name, deps match, etc.
654.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
655.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
656.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
657.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
658. 
659.     def test_new_model(self):
660.         """Tests autodetection of new models."""
661.         changes = self.get_changes([], [self.other_pony_food])
662.         # Right number/type of migrations?
663.         self.assertNumberMigrations(changes, 'otherapp', 1)
664.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
665.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
666.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
667.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
668. 
669.     def test_old_model(self):
670.         """Tests deletion of old models."""
671.         changes = self.get_changes([self.author_empty], [])
672.         # Right number/type of migrations?
673.         self.assertNumberMigrations(changes, 'testapp', 1)
674.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
675.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
676. 
677.     def test_add_field(self):
678.         """Tests autodetection of new fields."""
679.         changes = self.get_changes([self.author_empty], [self.author_name])
680.         # Right number/type of migrations?
681.         self.assertNumberMigrations(changes, 'testapp', 1)
682.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
683.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
684. 
685.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
686.                 side_effect=AssertionError("Should not have prompted for not null addition"))
687.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
688.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
689.         # Right number/type of migrations?
690.         self.assertNumberMigrations(changes, 'testapp', 1)
691.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
692.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
693.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
694.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
695. 
696.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
697.                 side_effect=AssertionError("Should not have prompted for not null addition"))
698.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
699.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
700.         # Right number/type of migrations?
701.         self.assertNumberMigrations(changes, 'testapp', 1)
702.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
703.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
704.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
705.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
706. 
707.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
708.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
709.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
710.         # Right number/type of migrations?
711.         self.assertNumberMigrations(changes, 'testapp', 1)
712.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
713.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
714.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
715.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
716.         self.assertEqual(mocked_ask_method.call_count, 3)
717. 
718.     def test_remove_field(self):
719.         """Tests autodetection of removed fields."""
720.         changes = self.get_changes([self.author_name], [self.author_empty])
721.         # Right number/type of migrations?
722.         self.assertNumberMigrations(changes, 'testapp', 1)
723.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
724.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
725. 
726.     def test_alter_field(self):
727.         """Tests autodetection of new fields."""
728.         changes = self.get_changes([self.author_name], [self.author_name_longer])
729.         # Right number/type of migrations?
730.         self.assertNumberMigrations(changes, 'testapp', 1)
731.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
732.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
733. 
734.     def test_supports_functools_partial(self):
735.         def _content_file_name(instance, filename, key, **kwargs):
736.             return '{}/{}'.format(instance, filename)
737. 
738.         def content_file_name(key, **kwargs):
739.             return functools.partial(_content_file_name, key, **kwargs)
740. 
741.         # An unchanged partial reference.
742.         before = [ModelState("testapp", "Author", [
743.             ("id", models.AutoField(primary_key=True)),
744.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
745.         ])]
746.         after = [ModelState("testapp", "Author", [
747.             ("id", models.AutoField(primary_key=True)),
748.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
749.         ])]
750.         changes = self.get_changes(before, after)
751.         self.assertNumberMigrations(changes, 'testapp', 0)
752. 
753.         # A changed partial reference.
754.         args_changed = [ModelState("testapp", "Author", [
755.             ("id", models.AutoField(primary_key=True)),
756.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
757.         ])]
758.         changes = self.get_changes(before, args_changed)
759.         self.assertNumberMigrations(changes, 'testapp', 1)
760.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
761.         # Can't use assertOperationFieldAttributes because we need the
762.         # deconstructed version, i.e., the exploded func/args/keywords rather
763.         # than the partial: we don't care if it's not the same instance of the
764.         # partial, only if it's the same source function, args, and keywords.
765.         value = changes['testapp'][0].operations[0].field.upload_to
766.         self.assertEqual(
767.             (_content_file_name, ('other-file',), {}),
768.             (value.func, value.args, value.keywords)
769.         )
770. 
771.         kwargs_changed = [ModelState("testapp", "Author", [
772.             ("id", models.AutoField(primary_key=True)),
773.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
774.         ])]
775.         changes = self.get_changes(before, kwargs_changed)
776.         self.assertNumberMigrations(changes, 'testapp', 1)
777.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
778.         value = changes['testapp'][0].operations[0].field.upload_to
779.         self.assertEqual(
780.             (_content_file_name, ('file',), {'spam': 'eggs'}),
781.             (value.func, value.args, value.keywords)
782.         )
783. 
784.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
785.                 side_effect=AssertionError("Should not have prompted for not null addition"))
786.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
787.         """
788.         #23609 - Tests autodetection of nullable to non-nullable alterations.
789.         """
790.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
791.         # Right number/type of migrations?
792.         self.assertNumberMigrations(changes, 'testapp', 1)
793.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
794.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
795.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
796. 
797.     @mock.patch(
798.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
799.         return_value=models.NOT_PROVIDED,
800.     )
801.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
802.         """
803.         #23609 - Tests autodetection of nullable to non-nullable alterations.
804.         """
805.         changes = self.get_changes([self.author_name_null], [self.author_name])
806.         self.assertEqual(mocked_ask_method.call_count, 1)
807.         # Right number/type of migrations?
808.         self.assertNumberMigrations(changes, 'testapp', 1)
809.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
810.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
811.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
812. 
813.     @mock.patch(
814.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
815.         return_value='Some Name',
816.     )
817.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
818.         """
819.         #23609 - Tests autodetection of nullable to non-nullable alterations.
820.         """
821.         changes = self.get_changes([self.author_name_null], [self.author_name])
822.         self.assertEqual(mocked_ask_method.call_count, 1)
823.         # Right number/type of migrations?
824.         self.assertNumberMigrations(changes, 'testapp', 1)
825.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
826.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
827.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
828. 
829.     def test_rename_field(self):
830.         """Tests autodetection of renamed fields."""
831.         changes = self.get_changes(
832.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
833.         )
834.         # Right number/type of migrations?
835.         self.assertNumberMigrations(changes, 'testapp', 1)
836.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
837.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
838. 
839.     def test_rename_field_foreign_key_to_field(self):
840.         before = [
841.             ModelState('app', 'Foo', [
842.                 ('id', models.AutoField(primary_key=True)),
843.                 ('field', models.IntegerField(unique=True)),
844.             ]),
845.             ModelState('app', 'Bar', [
846.                 ('id', models.AutoField(primary_key=True)),
847.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
848.             ]),
849.         ]
850.         after = [
851.             ModelState('app', 'Foo', [
852.                 ('id', models.AutoField(primary_key=True)),
853.                 ('renamed_field', models.IntegerField(unique=True)),
854.             ]),
855.             ModelState('app', 'Bar', [
856.                 ('id', models.AutoField(primary_key=True)),
857.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
858.             ]),
859.         ]
860.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
861.         # Right number/type of migrations?
862.         self.assertNumberMigrations(changes, 'app', 1)
863.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
864.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
865. 
866.     def test_rename_foreign_object_fields(self):
867.         fields = ('first', 'second')
868.         renamed_fields = ('first_renamed', 'second_renamed')
869.         before = [
870.             ModelState('app', 'Foo', [
871.                 ('id', models.AutoField(primary_key=True)),
872.                 ('first', models.IntegerField()),
873.                 ('second', models.IntegerField()),
874.             ], options={'unique_together': {fields}}),
875.             ModelState('app', 'Bar', [
876.                 ('id', models.AutoField(primary_key=True)),
877.                 ('first', models.IntegerField()),
878.                 ('second', models.IntegerField()),
879.                 ('foo', models.ForeignObject(
880.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
881.                 )),
882.             ]),
883.         ]
884.         # Case 1: to_fields renames.
885.         after = [
886.             ModelState('app', 'Foo', [
887.                 ('id', models.AutoField(primary_key=True)),
888.                 ('first_renamed', models.IntegerField()),
889.                 ('second_renamed', models.IntegerField()),
890.             ], options={'unique_together': {renamed_fields}}),
891.             ModelState('app', 'Bar', [
892.                 ('id', models.AutoField(primary_key=True)),
893.                 ('first', models.IntegerField()),
894.                 ('second', models.IntegerField()),
895.                 ('foo', models.ForeignObject(
896.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
897.                 )),
898.             ]),
899.         ]
900.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
901.         self.assertNumberMigrations(changes, 'app', 1)
902.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
903.         self.assertOperationAttributes(
904.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
905.         )
906.         self.assertOperationAttributes(
907.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
908.         )
909.         # Case 2: from_fields renames.
910.         after = [
911.             ModelState('app', 'Foo', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first', models.IntegerField()),
914.                 ('second', models.IntegerField()),
915.             ], options={'unique_together': {fields}}),
916.             ModelState('app', 'Bar', [
917.                 ('id', models.AutoField(primary_key=True)),
918.                 ('first_renamed', models.IntegerField()),
919.                 ('second_renamed', models.IntegerField()),
920.                 ('foo', models.ForeignObject(
921.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
922.                 )),
923.             ]),
924.         ]
925.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
926.         self.assertNumberMigrations(changes, 'app', 1)
927.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
928.         self.assertOperationAttributes(
929.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
930.         )
931.         self.assertOperationAttributes(
932.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
933.         )
934. 
935.     def test_rename_referenced_primary_key(self):
936.         before = [
937.             ModelState('app', 'Foo', [
938.                 ('id', models.CharField(primary_key=True, serialize=False)),
939.             ]),
940.             ModelState('app', 'Bar', [
941.                 ('id', models.AutoField(primary_key=True)),
942.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
943.             ]),
944.         ]
945.         after = [
946.             ModelState('app', 'Foo', [
947.                 ('renamed_id', models.CharField(primary_key=True, serialize=False))
948.             ]),
949.             ModelState('app', 'Bar', [
950.                 ('id', models.AutoField(primary_key=True)),
951.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
952.             ]),
953.         ]
954.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
955.         self.assertNumberMigrations(changes, 'app', 1)
956.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
957.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='id', new_name='renamed_id')
958. 
959.     def test_rename_field_preserved_db_column(self):
960.         """
961.         RenameField is used if a field is renamed and db_column equal to the
962.         old field's column is added.
963.         """
964.         before = [
965.             ModelState('app', 'Foo', [
966.                 ('id', models.AutoField(primary_key=True)),
967.                 ('field', models.IntegerField()),
968.             ]),
969.         ]
970.         after = [
971.             ModelState('app', 'Foo', [
972.                 ('id', models.AutoField(primary_key=True)),
973.                 ('renamed_field', models.IntegerField(db_column='field')),
974.             ]),
975.         ]
976.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
977.         self.assertNumberMigrations(changes, 'app', 1)
978.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
979.         self.assertOperationAttributes(
980.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
981.         )
982.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
983.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
984.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
985.         ))
986. 
987.     def test_rename_related_field_preserved_db_column(self):
988.         before = [
989.             ModelState('app', 'Foo', [
990.                 ('id', models.AutoField(primary_key=True)),
991.             ]),
992.             ModelState('app', 'Bar', [
993.                 ('id', models.AutoField(primary_key=True)),
994.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
995.             ]),
996.         ]
997.         after = [
998.             ModelState('app', 'Foo', [
999.                 ('id', models.AutoField(primary_key=True)),
1000.             ]),
1001.             ModelState('app', 'Bar', [
1002.                 ('id', models.AutoField(primary_key=True)),
1003.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
1004.             ]),
1005.         ]
1006.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
1007.         self.assertNumberMigrations(changes, 'app', 1)
1008.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
1009.         self.assertOperationAttributes(
1010.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
1011.         )
1012.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
1013.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1014.             'renamed_foo',
1015.             'django.db.models.ForeignKey',
1016.             [],
1017.             {'to': 'app.foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
1018.         ))
1019. 
1020.     def test_rename_model(self):
1021.         """Tests autodetection of renamed models."""
1022.         changes = self.get_changes(
1023.             [self.author_with_book, self.book],
1024.             [self.author_renamed_with_book, self.book_with_author_renamed],
1025.             MigrationQuestioner({"ask_rename_model": True}),
1026.         )
1027.         # Right number/type of migrations?
1028.         self.assertNumberMigrations(changes, 'testapp', 1)
1029.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1030.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1031.         # Now that RenameModel handles related fields too, there should be
1032.         # no AlterField for the related field.
1033.         self.assertNumberMigrations(changes, 'otherapp', 0)
1034. 
1035.     def test_rename_model_case(self):
1036.         """
1037.         Model name is case-insensitive. Changing case doesn't lead to any
1038.         autodetected operations.
1039.         """
1040.         author_renamed = ModelState('testapp', 'author', [
1041.             ('id', models.AutoField(primary_key=True)),
1042.         ])
1043.         changes = self.get_changes(
1044.             [self.author_empty, self.book],
1045.             [author_renamed, self.book],
1046.             questioner=MigrationQuestioner({'ask_rename_model': True}),
1047.         )
1048.         self.assertNumberMigrations(changes, 'testapp', 0)
1049.         self.assertNumberMigrations(changes, 'otherapp', 0)
1050. 
1051.     def test_rename_m2m_through_model(self):
1052.         """
1053.         Tests autodetection of renamed models that are used in M2M relations as
1054.         through models.
1055.         """
1056.         changes = self.get_changes(
1057.             [self.author_with_m2m_through, self.publisher, self.contract],
1058.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1059.             MigrationQuestioner({'ask_rename_model': True})
1060.         )
1061.         # Right number/type of migrations?
1062.         self.assertNumberMigrations(changes, 'testapp', 1)
1063.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1064.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1065. 
1066.     def test_rename_model_with_renamed_rel_field(self):
1067.         """
1068.         Tests autodetection of renamed models while simultaneously renaming one
1069.         of the fields that relate to the renamed model.
1070.         """
1071.         changes = self.get_changes(
1072.             [self.author_with_book, self.book],
1073.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1074.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1075.         )
1076.         # Right number/type of migrations?
1077.         self.assertNumberMigrations(changes, 'testapp', 1)
1078.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1079.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1080.         # Right number/type of migrations for related field rename?
1081.         # Alter is already taken care of.
1082.         self.assertNumberMigrations(changes, 'otherapp', 1)
1083.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1084.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1085. 
1086.     def test_rename_model_with_fks_in_different_position(self):
1087.         """
1088.         #24537 - The order of fields in a model does not influence
1089.         the RenameModel detection.
1090.         """
1091.         before = [
1092.             ModelState("testapp", "EntityA", [
1093.                 ("id", models.AutoField(primary_key=True)),
1094.             ]),
1095.             ModelState("testapp", "EntityB", [
1096.                 ("id", models.AutoField(primary_key=True)),
1097.                 ("some_label", models.CharField(max_length=255)),
1098.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1099.             ]),
1100.         ]
1101.         after = [
1102.             ModelState("testapp", "EntityA", [
1103.                 ("id", models.AutoField(primary_key=True)),
1104.             ]),
1105.             ModelState("testapp", "RenamedEntityB", [
1106.                 ("id", models.AutoField(primary_key=True)),
1107.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1108.                 ("some_label", models.CharField(max_length=255)),
1109.             ]),
1110.         ]
1111.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1112.         self.assertNumberMigrations(changes, "testapp", 1)
1113.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1114.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1115. 
1116.     def test_rename_model_reverse_relation_dependencies(self):
1117.         """
1118.         The migration to rename a model pointed to by a foreign key in another
1119.         app must run after the other app's migration that adds the foreign key
1120.         with model's original name. Therefore, the renaming migration has a
1121.         dependency on that other migration.
1122.         """
1123.         before = [
1124.             ModelState('testapp', 'EntityA', [
1125.                 ('id', models.AutoField(primary_key=True)),
1126.             ]),
1127.             ModelState('otherapp', 'EntityB', [
1128.                 ('id', models.AutoField(primary_key=True)),
1129.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1130.             ]),
1131.         ]
1132.         after = [
1133.             ModelState('testapp', 'RenamedEntityA', [
1134.                 ('id', models.AutoField(primary_key=True)),
1135.             ]),
1136.             ModelState('otherapp', 'EntityB', [
1137.                 ('id', models.AutoField(primary_key=True)),
1138.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1139.             ]),
1140.         ]
1141.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1142.         self.assertNumberMigrations(changes, 'testapp', 1)
1143.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1144.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1145.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1146. 
1147.     def test_fk_dependency(self):
1148.         """Having a ForeignKey automatically adds a dependency."""
1149.         # Note that testapp (author) has no dependencies,
1150.         # otherapp (book) depends on testapp (author),
1151.         # thirdapp (edition) depends on otherapp (book)
1152.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1153.         # Right number/type of migrations?
1154.         self.assertNumberMigrations(changes, 'testapp', 1)
1155.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1156.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1157.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1158.         # Right number/type of migrations?
1159.         self.assertNumberMigrations(changes, 'otherapp', 1)
1160.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1161.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1162.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1163.         # Right number/type of migrations?
1164.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1165.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1166.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1167.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1168. 
1169.     def test_proxy_fk_dependency(self):
1170.         """FK dependencies still work on proxy models."""
1171.         # Note that testapp (author) has no dependencies,
1172.         # otherapp (book) depends on testapp (authorproxy)
1173.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1174.         # Right number/type of migrations?
1175.         self.assertNumberMigrations(changes, 'testapp', 1)
1176.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1177.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1178.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1179.         # Right number/type of migrations?
1180.         self.assertNumberMigrations(changes, 'otherapp', 1)
1181.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1182.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1183.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1184.         # Right number/type of migrations?
1185.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1186.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1187.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1188.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1189. 
1190.     def test_same_app_no_fk_dependency(self):
1191.         """
1192.         A migration with a FK between two models of the same app
1193.         does not have a dependency to itself.
1194.         """
1195.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1196.         # Right number/type of migrations?
1197.         self.assertNumberMigrations(changes, 'testapp', 1)
1198.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1199.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1200.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1201.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1202. 
1203.     def test_circular_fk_dependency(self):
1204.         """
1205.         Having a circular ForeignKey dependency automatically
1206.         resolves the situation into 2 migrations on one side and 1 on the other.
1207.         """
1208.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1209.         # Right number/type of migrations?
1210.         self.assertNumberMigrations(changes, 'testapp', 1)
1211.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1212.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1213.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1214.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1215.         # Right number/type of migrations?
1216.         self.assertNumberMigrations(changes, 'otherapp', 2)
1217.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1218.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1219.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1220.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1221.         # both split migrations should be `initial`
1222.         self.assertTrue(changes['otherapp'][0].initial)
1223.         self.assertTrue(changes['otherapp'][1].initial)
1224. 
1225.     def test_same_app_circular_fk_dependency(self):
1226.         """
1227.         A migration with a FK between two models of the same app does
1228.         not have a dependency to itself.
1229.         """
1230.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1231.         # Right number/type of migrations?
1232.         self.assertNumberMigrations(changes, 'testapp', 1)
1233.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1234.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1235.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1236.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1237.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1238. 
1239.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1240.         """
1241.         #22275 - A migration with circular FK dependency does not try
1242.         to create unique together constraint and indexes before creating all
1243.         required fields first.
1244.         """
1245.         changes = self.get_changes([], [self.knight, self.rabbit])
1246.         # Right number/type of migrations?
1247.         self.assertNumberMigrations(changes, 'eggs', 1)
1248.         self.assertOperationTypes(
1249.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1250.         )
1251.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1252.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1253.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1254. 
1255.     def test_alter_db_table_add(self):
1256.         """Tests detection for adding db_table in model's options."""
1257.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1258.         # Right number/type of migrations?
1259.         self.assertNumberMigrations(changes, 'testapp', 1)
1260.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1261.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1262. 
1263.     def test_alter_db_table_change(self):
1264.         """Tests detection for changing db_table in model's options'."""
1265.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1266.         # Right number/type of migrations?
1267.         self.assertNumberMigrations(changes, 'testapp', 1)
1268.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1269.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1270. 
1271.     def test_alter_db_table_remove(self):
1272.         """Tests detection for removing db_table in model's options."""
1273.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1274.         # Right number/type of migrations?
1275.         self.assertNumberMigrations(changes, 'testapp', 1)
1276.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1277.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1278. 
1279.     def test_alter_db_table_no_changes(self):
1280.         """
1281.         Alter_db_table doesn't generate a migration if no changes have been made.
1282.         """
1283.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1284.         # Right number of migrations?
1285.         self.assertEqual(len(changes), 0)
1286. 
1287.     def test_keep_db_table_with_model_change(self):
1288.         """
1289.         Tests when model changes but db_table stays as-is, autodetector must not
1290.         create more than one operation.
1291.         """
1292.         changes = self.get_changes(
1293.             [self.author_with_db_table_options],
1294.             [self.author_renamed_with_db_table_options],
1295.             MigrationQuestioner({"ask_rename_model": True}),
1296.         )
1297.         # Right number/type of migrations?
1298.         self.assertNumberMigrations(changes, 'testapp', 1)
1299.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1300.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1301. 
1302.     def test_alter_db_table_with_model_change(self):
1303.         """
1304.         Tests when model and db_table changes, autodetector must create two
1305.         operations.
1306.         """
1307.         changes = self.get_changes(
1308.             [self.author_with_db_table_options],
1309.             [self.author_renamed_with_new_db_table_options],
1310.             MigrationQuestioner({"ask_rename_model": True}),
1311.         )
1312.         # Right number/type of migrations?
1313.         self.assertNumberMigrations(changes, 'testapp', 1)
1314.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1315.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1316.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1317. 
1318.     def test_identical_regex_doesnt_alter(self):
1319.         from_state = ModelState(
1320.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1321.                 RegexValidator(
1322.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1323.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1324.                     'invalid'
1325.                 )
1326.             ]))]
1327.         )
1328.         to_state = ModelState(
1329.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1330.         )
1331.         changes = self.get_changes([from_state], [to_state])
1332.         # Right number/type of migrations?
1333.         self.assertNumberMigrations(changes, "testapp", 0)
1334. 
1335.     def test_different_regex_does_alter(self):
1336.         from_state = ModelState(
1337.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1338.                 RegexValidator(
1339.                     re.compile('^[a-z]+\\Z', 32),
1340.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1341.                     'invalid'
1342.                 )
1343.             ]))]
1344.         )
1345.         to_state = ModelState(
1346.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1347.         )
1348.         changes = self.get_changes([from_state], [to_state])
1349.         self.assertNumberMigrations(changes, "testapp", 1)
1350.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1351. 
1352.     def test_empty_foo_together(self):
1353.         """
1354.         #23452 - Empty unique/index_together shouldn't generate a migration.
1355.         """
1356.         # Explicitly testing for not specified, since this is the case after
1357.         # a CreateModel operation w/o any definition on the original model
1358.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1359.         # Explicitly testing for None, since this was the issue in #23452 after
1360.         # an AlterFooTogether operation with e.g. () as value
1361.         model_state_none = ModelState("a", "model", [
1362.             ("id", models.AutoField(primary_key=True))
1363.         ], {
1364.             "index_together": None,
1365.             "unique_together": None,
1366.         })
1367.         # Explicitly testing for the empty set, since we now always have sets.
1368.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1369.         model_state_empty = ModelState("a", "model", [
1370.             ("id", models.AutoField(primary_key=True))
1371.         ], {
1372.             "index_together": set(),
1373.             "unique_together": set(),
1374.         })
1375. 
1376.         def test(from_state, to_state, msg):
1377.             changes = self.get_changes([from_state], [to_state])
1378.             if changes:
1379.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1380.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1381. 
1382.         tests = (
1383.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1384.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1385.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1386.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1387.             (model_state_none, model_state_none, '"None" to "None"'),
1388.             (model_state_none, model_state_empty, '"None" to "empty"'),
1389.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1390.             (model_state_empty, model_state_none, '"empty" to "None"'),
1391.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1392.         )
1393. 
1394.         for t in tests:
1395.             test(*t)
1396. 
1397.     def test_create_model_with_indexes(self):
1398.         """Test creation of new model with indexes already defined."""
1399.         author = ModelState('otherapp', 'Author', [
1400.             ('id', models.AutoField(primary_key=True)),
1401.             ('name', models.CharField(max_length=200)),
1402.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1403.         changes = self.get_changes([], [author])
1404.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1405.         # Right number of migrations?
1406.         self.assertEqual(len(changes['otherapp']), 1)
1407.         # Right number of actions?
1408.         migration = changes['otherapp'][0]
1409.         self.assertEqual(len(migration.operations), 2)
1410.         # Right actions order?
1411.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1412.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1413.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1414. 
1415.     def test_add_indexes(self):
1416.         """Test change detection of new indexes."""
1417.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1418.         self.assertNumberMigrations(changes, 'otherapp', 1)
1419.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1420.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1421.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1422. 
1423.     def test_remove_indexes(self):
1424.         """Test change detection of removed indexes."""
1425.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1426.         # Right number/type of migrations?
1427.         self.assertNumberMigrations(changes, 'otherapp', 1)
1428.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1429.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1430. 
1431.     def test_order_fields_indexes(self):
1432.         """Test change detection of reordering of fields in indexes."""
1433.         changes = self.get_changes(
1434.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1435.         )
1436.         self.assertNumberMigrations(changes, 'otherapp', 1)
1437.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1438.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1439.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1440.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1441. 
1442.     def test_create_model_with_check_constraint(self):
1443.         """Test creation of new model with constraints already defined."""
1444.         author = ModelState('otherapp', 'Author', [
1445.             ('id', models.AutoField(primary_key=True)),
1446.             ('name', models.CharField(max_length=200)),
1447.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1448.         changes = self.get_changes([], [author])
1449.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1450.         # Right number of migrations?
1451.         self.assertEqual(len(changes['otherapp']), 1)
1452.         # Right number of actions?
1453.         migration = changes['otherapp'][0]
1454.         self.assertEqual(len(migration.operations), 2)
1455.         # Right actions order?
1456.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1457.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1458.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1459. 
1460.     def test_add_constraints(self):
1461.         """Test change detection of new constraints."""
1462.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1463.         self.assertNumberMigrations(changes, 'testapp', 1)
1464.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1465.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1466.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1467. 
1468.     def test_remove_constraints(self):
1469.         """Test change detection of removed constraints."""
1470.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1471.         # Right number/type of migrations?
1472.         self.assertNumberMigrations(changes, 'testapp', 1)
1473.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1474.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1475. 
1476.     def test_add_foo_together(self):
1477.         """Tests index/unique_together detection."""
1478.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1479.         # Right number/type of migrations?
1480.         self.assertNumberMigrations(changes, "otherapp", 1)
1481.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1482.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1483.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1484. 
1485.     def test_remove_foo_together(self):
1486.         """Tests index/unique_together detection."""
1487.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1488.         # Right number/type of migrations?
1489.         self.assertNumberMigrations(changes, "otherapp", 1)
1490.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1491.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1492.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1493. 
1494.     def test_foo_together_remove_fk(self):
1495.         """Tests unique_together and field removal detection & ordering"""
1496.         changes = self.get_changes(
1497.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1498.         )
1499.         # Right number/type of migrations?
1500.         self.assertNumberMigrations(changes, "otherapp", 1)
1501.         self.assertOperationTypes(changes, "otherapp", 0, [
1502.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1503.         ])
1504.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1505.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1506.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1507. 
1508.     def test_foo_together_no_changes(self):
1509.         """
1510.         index/unique_together doesn't generate a migration if no
1511.         changes have been made.
1512.         """
1513.         changes = self.get_changes(
1514.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1515.         )
1516.         # Right number of migrations?
1517.         self.assertEqual(len(changes), 0)
1518. 
1519.     def test_foo_together_ordering(self):
1520.         """
1521.         index/unique_together also triggers on ordering changes.
1522.         """
1523.         changes = self.get_changes(
1524.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1525.         )
1526.         # Right number/type of migrations?
1527.         self.assertNumberMigrations(changes, "otherapp", 1)
1528.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1529.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1530.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1531. 
1532.     def test_add_field_and_foo_together(self):
1533.         """
1534.         Added fields will be created before using them in index/unique_together.
1535.         """
1536.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1537.         # Right number/type of migrations?
1538.         self.assertNumberMigrations(changes, "otherapp", 1)
1539.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1540.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1541.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1542. 
1543.     def test_create_model_and_unique_together(self):
1544.         author = ModelState("otherapp", "Author", [
1545.             ("id", models.AutoField(primary_key=True)),
1546.             ("name", models.CharField(max_length=200)),
1547.         ])
1548.         book_with_author = ModelState("otherapp", "Book", [
1549.             ("id", models.AutoField(primary_key=True)),
1550.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1551.             ("title", models.CharField(max_length=200)),
1552.         ], {
1553.             "index_together": {("title", "author")},
1554.             "unique_together": {("title", "author")},
1555.         })
1556.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1557.         # Right number of migrations?
1558.         self.assertEqual(len(changes['otherapp']), 1)
1559.         # Right number of actions?
1560.         migration = changes['otherapp'][0]
1561.         self.assertEqual(len(migration.operations), 4)
1562.         # Right actions order?
1563.         self.assertOperationTypes(
1564.             changes, 'otherapp', 0,
1565.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1566.         )
1567. 
1568.     def test_remove_field_and_foo_together(self):
1569.         """
1570.         Removed fields will be removed after updating index/unique_together.
1571.         """
1572.         changes = self.get_changes(
1573.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1574.         )
1575.         # Right number/type of migrations?
1576.         self.assertNumberMigrations(changes, "otherapp", 1)
1577.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1578.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1579.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1580.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1581. 
1582.     def test_rename_field_and_foo_together(self):
1583.         """
1584.         Removed fields will be removed after updating index/unique_together.
1585.         """
1586.         changes = self.get_changes(
1587.             [self.author_empty, self.book_foo_together_3],
1588.             [self.author_empty, self.book_foo_together_4],
1589.             MigrationQuestioner({"ask_rename": True}),
1590.         )
1591.         # Right number/type of migrations?
1592.         self.assertNumberMigrations(changes, "otherapp", 1)
1593.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1594.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1595.             ("title", "newfield2")
1596.         })
1597.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1598. 
1599.     def test_proxy(self):
1600.         """The autodetector correctly deals with proxy models."""
1601.         # First, we test adding a proxy model
1602.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1603.         # Right number/type of migrations?
1604.         self.assertNumberMigrations(changes, "testapp", 1)
1605.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1606.         self.assertOperationAttributes(
1607.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1608.         )
1609.         # Now, we test turning a proxy model into a non-proxy model
1610.         # It should delete the proxy then make the real one
1611.         changes = self.get_changes(
1612.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1613.         )
1614.         # Right number/type of migrations?
1615.         self.assertNumberMigrations(changes, "testapp", 1)
1616.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1617.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1618.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1619. 
1620.     def test_proxy_custom_pk(self):
1621.         """
1622.         #23415 - The autodetector must correctly deal with custom FK on proxy
1623.         models.
1624.         """
1625.         # First, we test the default pk field name
1626.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1627.         # The field name the FK on the book model points to
1628.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1629.         # Now, we test the custom pk field name
1630.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1631.         # The field name the FK on the book model points to
1632.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1633. 
1634.     def test_proxy_to_mti_with_fk_to_proxy(self):
1635.         # First, test the pk table and field name.
1636.         changes = self.get_changes(
1637.             [],
1638.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1639.         )
1640.         self.assertEqual(
1641.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1642.             'testapp_author',
1643.         )
1644.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1645. 
1646.         # Change AuthorProxy to use MTI.
1647.         changes = self.get_changes(
1648.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1649.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1650.         )
1651.         # Right number/type of migrations for the AuthorProxy model?
1652.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1653.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1654.         # Right number/type of migrations for the Book model with a FK to
1655.         # AuthorProxy?
1656.         self.assertNumberMigrations(changes, 'otherapp', 1)
1657.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1658.         # otherapp should depend on thirdapp.
1659.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1660.         # Now, test the pk table and field name.
1661.         self.assertEqual(
1662.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1663.             'thirdapp_authorproxy',
1664.         )
1665.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1666. 
1667.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1668.         # First, test the pk table and field name.
1669.         changes = self.get_changes(
1670.             [],
1671.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1672.         )
1673.         self.assertEqual(
1674.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1675.             'testapp_author',
1676.         )
1677.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1678. 
1679.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1680.         # a proxy of AuthorProxy.
1681.         changes = self.get_changes(
1682.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1683.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1684.         )
1685.         # Right number/type of migrations for the AuthorProxy model?
1686.         self.assertNumberMigrations(changes, 'testapp', 1)
1687.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1688.         # Right number/type of migrations for the Book model with a FK to
1689.         # AAuthorProxyProxy?
1690.         self.assertNumberMigrations(changes, 'otherapp', 1)
1691.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1692.         # otherapp should depend on testapp.
1693.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1694.         # Now, test the pk table and field name.
1695.         self.assertEqual(
1696.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1697.             'testapp_authorproxy',
1698.         )
1699.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1700. 
1701.     def test_unmanaged_create(self):
1702.         """The autodetector correctly deals with managed models."""
1703.         # First, we test adding an unmanaged model
1704.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1705.         # Right number/type of migrations?
1706.         self.assertNumberMigrations(changes, 'testapp', 1)
1707.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1708.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1709. 
1710.     def test_unmanaged_delete(self):
1711.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1712.         self.assertNumberMigrations(changes, 'testapp', 1)
1713.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1714. 
1715.     def test_unmanaged_to_managed(self):
1716.         # Now, we test turning an unmanaged model into a managed model
1717.         changes = self.get_changes(
1718.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1719.         )
1720.         # Right number/type of migrations?
1721.         self.assertNumberMigrations(changes, 'testapp', 1)
1722.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1723.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1724. 
1725.     def test_managed_to_unmanaged(self):
1726.         # Now, we turn managed to unmanaged.
1727.         changes = self.get_changes(
1728.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1729.         )
1730.         # Right number/type of migrations?
1731.         self.assertNumberMigrations(changes, 'testapp', 1)
1732.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1733.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1734. 
1735.     def test_unmanaged_custom_pk(self):
1736.         """
1737.         #23415 - The autodetector must correctly deal with custom FK on
1738.         unmanaged models.
1739.         """
1740.         # First, we test the default pk field name
1741.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1742.         # The field name the FK on the book model points to
1743.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1744.         # Now, we test the custom pk field name
1745.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1746.         # The field name the FK on the book model points to
1747.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1748. 
1749.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1750.     def test_swappable(self):
1751.         with isolate_lru_cache(apps.get_swappable_settings_name):
1752.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1753.         # Right number/type of migrations?
1754.         self.assertNumberMigrations(changes, 'testapp', 1)
1755.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1756.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1757.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1758. 
1759.     def test_swappable_changed(self):
1760.         with isolate_lru_cache(apps.get_swappable_settings_name):
1761.             before = self.make_project_state([self.custom_user, self.author_with_user])
1762.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1763.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1764.             autodetector = MigrationAutodetector(before, after)
1765.             changes = autodetector._detect_changes()
1766.         # Right number/type of migrations?
1767.         self.assertNumberMigrations(changes, 'testapp', 1)
1768.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1769.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1770.         fk_field = changes['testapp'][0].operations[0].field
1771.         to_model = '%s.%s' % (
1772.             fk_field.remote_field.model._meta.app_label,
1773.             fk_field.remote_field.model._meta.object_name,
1774.         )
1775.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1776. 
1777.     def test_add_field_with_default(self):
1778.         """#22030 - Adding a field with a default should work."""
1779.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1780.         # Right number/type of migrations?
1781.         self.assertNumberMigrations(changes, 'testapp', 1)
1782.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1783.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1784. 
1785.     def test_custom_deconstructible(self):
1786.         """
1787.         Two instances which deconstruct to the same value aren't considered a
1788.         change.
1789.         """
1790.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1791.         # Right number of migrations?
1792.         self.assertEqual(len(changes), 0)
1793. 
1794.     def test_deconstruct_field_kwarg(self):
1795.         """Field instances are handled correctly by nested deconstruction."""
1796.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1797.         self.assertEqual(changes, {})
1798. 
1799.     def test_deconstructible_list(self):
1800.         """Nested deconstruction descends into lists."""
1801.         # When lists contain items that deconstruct to identical values, those lists
1802.         # should be considered equal for the purpose of detecting state changes
1803.         # (even if the original items are unequal).
1804.         changes = self.get_changes(
1805.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1806.         )
1807.         self.assertEqual(changes, {})
1808.         # Legitimate differences within the deconstructed lists should be reported
1809.         # as a change
1810.         changes = self.get_changes(
1811.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1812.         )
1813.         self.assertEqual(len(changes), 1)
1814. 
1815.     def test_deconstructible_tuple(self):
1816.         """Nested deconstruction descends into tuples."""
1817.         # When tuples contain items that deconstruct to identical values, those tuples
1818.         # should be considered equal for the purpose of detecting state changes
1819.         # (even if the original items are unequal).
1820.         changes = self.get_changes(
1821.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1822.         )
1823.         self.assertEqual(changes, {})
1824.         # Legitimate differences within the deconstructed tuples should be reported
1825.         # as a change
1826.         changes = self.get_changes(
1827.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1828.         )
1829.         self.assertEqual(len(changes), 1)
1830. 
1831.     def test_deconstructible_dict(self):
1832.         """Nested deconstruction descends into dict values."""
1833.         # When dicts contain items whose values deconstruct to identical values,
1834.         # those dicts should be considered equal for the purpose of detecting
1835.         # state changes (even if the original values are unequal).
1836.         changes = self.get_changes(
1837.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1838.         )
1839.         self.assertEqual(changes, {})
1840.         # Legitimate differences within the deconstructed dicts should be reported
1841.         # as a change
1842.         changes = self.get_changes(
1843.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1844.         )
1845.         self.assertEqual(len(changes), 1)
1846. 
1847.     def test_nested_deconstructible_objects(self):
1848.         """
1849.         Nested deconstruction is applied recursively to the args/kwargs of
1850.         deconstructed objects.
1851.         """
1852.         # If the items within a deconstructed object's args/kwargs have the same
1853.         # deconstructed values - whether or not the items themselves are different
1854.         # instances - then the object as a whole is regarded as unchanged.
1855.         changes = self.get_changes(
1856.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1857.         )
1858.         self.assertEqual(changes, {})
1859.         # Differences that exist solely within the args list of a deconstructed object
1860.         # should be reported as changes
1861.         changes = self.get_changes(
1862.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1863.         )
1864.         self.assertEqual(len(changes), 1)
1865.         # Additional args should also be reported as a change
1866.         changes = self.get_changes(
1867.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1868.         )
1869.         self.assertEqual(len(changes), 1)
1870.         # Differences that exist solely within the kwargs dict of a deconstructed object
1871.         # should be reported as changes
1872.         changes = self.get_changes(
1873.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1874.         )
1875.         self.assertEqual(len(changes), 1)
1876.         # Additional kwargs should also be reported as a change
1877.         changes = self.get_changes(
1878.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1879.         )
1880.         self.assertEqual(len(changes), 1)
1881. 
1882.     def test_deconstruct_type(self):
1883.         """
1884.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1885.         by deep_deconstruct during serialization.
1886.         """
1887.         author = ModelState(
1888.             "testapp",
1889.             "Author",
1890.             [
1891.                 ("id", models.AutoField(primary_key=True)),
1892.                 ("name", models.CharField(
1893.                     max_length=200,
1894.                     # IntegerField intentionally not instantiated.
1895.                     default=models.IntegerField,
1896.                 ))
1897.             ],
1898.         )
1899.         changes = self.get_changes([], [author])
1900.         # Right number/type of migrations?
1901.         self.assertNumberMigrations(changes, 'testapp', 1)
1902.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1903. 
1904.     def test_replace_string_with_foreignkey(self):
1905.         """
1906.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1907.         work.
1908.         """
1909.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1910.         # Right number/type of migrations?
1911.         self.assertNumberMigrations(changes, 'testapp', 1)
1912.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1913.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1914.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1915.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1916. 
1917.     def test_foreign_key_removed_before_target_model(self):
1918.         """
1919.         Removing an FK and the model it targets in the same change must remove
1920.         the FK field before the model to maintain consistency.
1921.         """
1922.         changes = self.get_changes(
1923.             [self.author_with_publisher, self.publisher], [self.author_name]
1924.         )  # removes both the model and FK
1925.         # Right number/type of migrations?
1926.         self.assertNumberMigrations(changes, 'testapp', 1)
1927.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1928.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1929.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1930. 
1931.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1932.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1933.     def test_add_many_to_many(self, mocked_ask_method):
1934.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1935.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1936.         # Right number/type of migrations?
1937.         self.assertNumberMigrations(changes, 'testapp', 1)
1938.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1939.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1940. 
1941.     def test_alter_many_to_many(self):
1942.         changes = self.get_changes(
1943.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1944.         )
1945.         # Right number/type of migrations?
1946.         self.assertNumberMigrations(changes, 'testapp', 1)
1947.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1948.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1949. 
1950.     def test_create_with_through_model(self):
1951.         """
1952.         Adding a m2m with a through model and the models that use it should be
1953.         ordered correctly.
1954.         """
1955.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1956.         # Right number/type of migrations?
1957.         self.assertNumberMigrations(changes, "testapp", 1)
1958.         self.assertOperationTypes(changes, "testapp", 0, [
1959.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1960.         ])
1961.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1962.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1963.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1964.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1965. 
1966.     def test_many_to_many_removed_before_through_model(self):
1967.         """
1968.         Removing a ManyToManyField and the "through" model in the same change
1969.         must remove the field before the model to maintain consistency.
1970.         """
1971.         changes = self.get_changes(
1972.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1973.             [self.book_with_no_author, self.author_name],
1974.         )
1975.         # Remove both the through model and ManyToMany
1976.         # Right number/type of migrations?
1977.         self.assertNumberMigrations(changes, "otherapp", 1)
1978.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1979.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1980.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1981. 
1982.     def test_many_to_many_removed_before_through_model_2(self):
1983.         """
1984.         Removing a model that contains a ManyToManyField and the "through" model
1985.         in the same change must remove the field before the model to maintain
1986.         consistency.
1987.         """
1988.         changes = self.get_changes(
1989.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1990.             [self.author_name],
1991.         )
1992.         # Remove both the through model and ManyToMany
1993.         # Right number/type of migrations?
1994.         self.assertNumberMigrations(changes, "otherapp", 1)
1995.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
1996.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1997.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1998.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
1999. 
2000.     def test_m2m_w_through_multistep_remove(self):
2001.         """
2002.         A model with a m2m field that specifies a "through" model cannot be
2003.         removed in the same migration as that through model as the schema will
2004.         pass through an inconsistent state. The autodetector should produce two
2005.         migrations to avoid this issue.
2006.         """
2007.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
2008.         # Right number/type of migrations?
2009.         self.assertNumberMigrations(changes, "testapp", 1)
2010.         self.assertOperationTypes(changes, "testapp", 0, [
2011.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
2012.         ])
2013.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
2014.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
2015.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
2016.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
2017. 
2018.     def test_concrete_field_changed_to_many_to_many(self):
2019.         """
2020.         #23938 - Changing a concrete field into a ManyToManyField
2021.         first removes the concrete field and then adds the m2m field.
2022.         """
2023.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
2024.         # Right number/type of migrations?
2025.         self.assertNumberMigrations(changes, "testapp", 1)
2026.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
2027.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
2028.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2029.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
2030. 
2031.     def test_many_to_many_changed_to_concrete_field(self):
2032.         """
2033.         #23938 - Changing a ManyToManyField into a concrete field
2034.         first removes the m2m field and then adds the concrete field.
2035.         """
2036.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
2037.         # Right number/type of migrations?
2038.         self.assertNumberMigrations(changes, "testapp", 1)
2039.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
2040.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
2041.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2042.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
2043.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
2044. 
2045.     def test_non_circular_foreignkey_dependency_removal(self):
2046.         """
2047.         If two models with a ForeignKey from one to the other are removed at the
2048.         same time, the autodetector should remove them in the correct order.
2049.         """
2050.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2051.         # Right number/type of migrations?
2052.         self.assertNumberMigrations(changes, "testapp", 1)
2053.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2054.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2055.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2056.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2057. 
2058.     def test_alter_model_options(self):
2059.         """Changing a model's options should make a change."""
2060.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2061.         # Right number/type of migrations?
2062.         self.assertNumberMigrations(changes, "testapp", 1)
2063.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2064.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2065.             "permissions": [('can_hire', 'Can hire')],
2066.             "verbose_name": "Authi",
2067.         })
2068. 
2069.         # Changing them back to empty should also make a change
2070.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2071.         # Right number/type of migrations?
2072.         self.assertNumberMigrations(changes, "testapp", 1)
2073.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2074.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2075. 
2076.     def test_alter_model_options_proxy(self):
2077.         """Changing a proxy model's options should also make a change."""
2078.         changes = self.get_changes(
2079.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2080.         )
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, "testapp", 1)
2083.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2084.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2085.             "verbose_name": "Super Author"
2086.         })
2087. 
2088.     def test_set_alter_order_with_respect_to(self):
2089.         """Setting order_with_respect_to adds a field."""
2090.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2091.         # Right number/type of migrations?
2092.         self.assertNumberMigrations(changes, 'testapp', 1)
2093.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2094.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2095. 
2096.     def test_add_alter_order_with_respect_to(self):
2097.         """
2098.         Setting order_with_respect_to when adding the FK too does
2099.         things in the right order.
2100.         """
2101.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2102.         # Right number/type of migrations?
2103.         self.assertNumberMigrations(changes, 'testapp', 1)
2104.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2105.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2106.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2107. 
2108.     def test_remove_alter_order_with_respect_to(self):
2109.         """
2110.         Removing order_with_respect_to when removing the FK too does
2111.         things in the right order.
2112.         """
2113.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2114.         # Right number/type of migrations?
2115.         self.assertNumberMigrations(changes, 'testapp', 1)
2116.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2117.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2118.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2119. 
2120.     def test_add_model_order_with_respect_to(self):
2121.         """
2122.         Setting order_with_respect_to when adding the whole model
2123.         does things in the right order.
2124.         """
2125.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2126.         # Right number/type of migrations?
2127.         self.assertNumberMigrations(changes, 'testapp', 1)
2128.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2129.         self.assertOperationAttributes(
2130.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2131.         )
2132.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2133. 
2134.     def test_alter_model_managers(self):
2135.         """
2136.         Changing the model managers adds a new operation.
2137.         """
2138.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2139.         # Right number/type of migrations?
2140.         self.assertNumberMigrations(changes, 'otherapp', 1)
2141.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2142.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2143.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2144.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2145.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2146.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2147. 
2148.     def test_swappable_first_inheritance(self):
2149.         """Swappable models get their CreateModel first."""
2150.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2151.         # Right number/type of migrations?
2152.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2153.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2154.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2155.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2156. 
2157.     def test_default_related_name_option(self):
2158.         model_state = ModelState('app', 'model', [
2159.             ('id', models.AutoField(primary_key=True)),
2160.         ], options={'default_related_name': 'related_name'})
2161.         changes = self.get_changes([], [model_state])
2162.         self.assertNumberMigrations(changes, 'app', 1)
2163.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2164.         self.assertOperationAttributes(
2165.             changes, 'app', 0, 0, name='model',
2166.             options={'default_related_name': 'related_name'},
2167.         )
2168.         altered_model_state = ModelState('app', 'Model', [
2169.             ('id', models.AutoField(primary_key=True)),
2170.         ])
2171.         changes = self.get_changes([model_state], [altered_model_state])
2172.         self.assertNumberMigrations(changes, 'app', 1)
2173.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2174.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2175. 
2176.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2177.     def test_swappable_first_setting(self):
2178.         """Swappable models get their CreateModel first."""
2179.         with isolate_lru_cache(apps.get_swappable_settings_name):
2180.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2181.         # Right number/type of migrations?
2182.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2183.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2184.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2185.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2186. 
2187.     def test_bases_first(self):
2188.         """Bases of other models come first."""
2189.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2190.         # Right number/type of migrations?
2191.         self.assertNumberMigrations(changes, 'testapp', 1)
2192.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2193.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2194.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2195. 
2196.     def test_multiple_bases(self):
2197.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2198.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2199.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2200.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2201.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2202.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2203.         changes = self.get_changes([], [A, B, C, D, E])
2204.         # Right number/type of migrations?
2205.         self.assertNumberMigrations(changes, "app", 1)
2206.         self.assertOperationTypes(changes, "app", 0, [
2207.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2208.         ])
2209.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2210.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2211.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2212.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2213.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2214. 
2215.     def test_proxy_bases_first(self):
2216.         """Bases of proxies come first."""
2217.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2218.         # Right number/type of migrations?
2219.         self.assertNumberMigrations(changes, 'testapp', 1)
2220.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2221.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2222.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2223.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2224. 
2225.     def test_pk_fk_included(self):
2226.         """
2227.         A relation used as the primary key is kept as part of CreateModel.
2228.         """
2229.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2230.         # Right number/type of migrations?
2231.         self.assertNumberMigrations(changes, 'testapp', 1)
2232.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2233.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2234.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2235. 
2236.     def test_first_dependency(self):
2237.         """
2238.         A dependency to an app with no migrations uses __first__.
2239.         """
2240.         # Load graph
2241.         loader = MigrationLoader(connection)
2242.         before = self.make_project_state([])
2243.         after = self.make_project_state([self.book_migrations_fk])
2244.         after.real_apps = ["migrations"]
2245.         autodetector = MigrationAutodetector(before, after)
2246.         changes = autodetector._detect_changes(graph=loader.graph)
2247.         # Right number/type of migrations?
2248.         self.assertNumberMigrations(changes, 'otherapp', 1)
2249.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2250.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2251.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2252. 
2253.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2254.     def test_last_dependency(self):
2255.         """
2256.         A dependency to an app with existing migrations uses the
2257.         last migration of that app.
2258.         """
2259.         # Load graph
2260.         loader = MigrationLoader(connection)
2261.         before = self.make_project_state([])
2262.         after = self.make_project_state([self.book_migrations_fk])
2263.         after.real_apps = ["migrations"]
2264.         autodetector = MigrationAutodetector(before, after)
2265.         changes = autodetector._detect_changes(graph=loader.graph)
2266.         # Right number/type of migrations?
2267.         self.assertNumberMigrations(changes, 'otherapp', 1)
2268.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2269.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2270.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2271. 
2272.     def test_alter_fk_before_model_deletion(self):
2273.         """
2274.         ForeignKeys are altered _before_ the model they used to
2275.         refer to are deleted.
2276.         """
2277.         changes = self.get_changes(
2278.             [self.author_name, self.publisher_with_author],
2279.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2280.         )
2281.         # Right number/type of migrations?
2282.         self.assertNumberMigrations(changes, 'testapp', 1)
2283.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2284.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2285.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2286.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2287. 
2288.     def test_fk_dependency_other_app(self):
2289.         """
2290.         #23100 - ForeignKeys correctly depend on other apps' models.
2291.         """
2292.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2293.         # Right number/type of migrations?
2294.         self.assertNumberMigrations(changes, 'testapp', 1)
2295.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2296.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2297.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2298. 
2299.     def test_alter_field_to_fk_dependency_other_app(self):
2300.         changes = self.get_changes(
2301.             [self.author_empty, self.book_with_no_author_fk],
2302.             [self.author_empty, self.book],
2303.         )
2304.         self.assertNumberMigrations(changes, 'otherapp', 1)
2305.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
2306.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', '__first__')])
2307. 
2308.     def test_circular_dependency_mixed_addcreate(self):
2309.         """
2310.         #23315 - The dependency resolver knows to put all CreateModel
2311.         before AddField and not become unsolvable.
2312.         """
2313.         address = ModelState("a", "Address", [
2314.             ("id", models.AutoField(primary_key=True)),
2315.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2316.         ])
2317.         person = ModelState("a", "Person", [
2318.             ("id", models.AutoField(primary_key=True)),
2319.         ])
2320.         apackage = ModelState("b", "APackage", [
2321.             ("id", models.AutoField(primary_key=True)),
2322.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2323.         ])
2324.         country = ModelState("b", "DeliveryCountry", [
2325.             ("id", models.AutoField(primary_key=True)),
2326.         ])
2327.         changes = self.get_changes([], [address, person, apackage, country])
2328.         # Right number/type of migrations?
2329.         self.assertNumberMigrations(changes, 'a', 2)
2330.         self.assertNumberMigrations(changes, 'b', 1)
2331.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2332.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2333.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2334. 
2335.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2336.     def test_circular_dependency_swappable(self):
2337.         """
2338.         #23322 - The dependency resolver knows to explicitly resolve
2339.         swappable models.
2340.         """
2341.         with isolate_lru_cache(apps.get_swappable_settings_name):
2342.             tenant = ModelState("a", "Tenant", [
2343.                 ("id", models.AutoField(primary_key=True)),
2344.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2345.                 bases=(AbstractBaseUser,)
2346.             )
2347.             address = ModelState("b", "Address", [
2348.                 ("id", models.AutoField(primary_key=True)),
2349.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2350.             ])
2351.             changes = self.get_changes([], [address, tenant])
2352. 
2353.         # Right number/type of migrations?
2354.         self.assertNumberMigrations(changes, 'a', 2)
2355.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2356.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2357.         self.assertMigrationDependencies(changes, 'a', 0, [])
2358.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2359.         # Right number/type of migrations?
2360.         self.assertNumberMigrations(changes, 'b', 1)
2361.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2362.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2363. 
2364.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2365.     def test_circular_dependency_swappable2(self):
2366.         """
2367.         #23322 - The dependency resolver knows to explicitly resolve
2368.         swappable models but with the swappable not being the first migrated
2369.         model.
2370.         """
2371.         with isolate_lru_cache(apps.get_swappable_settings_name):
2372.             address = ModelState("a", "Address", [
2373.                 ("id", models.AutoField(primary_key=True)),
2374.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2375.             ])
2376.             tenant = ModelState("b", "Tenant", [
2377.                 ("id", models.AutoField(primary_key=True)),
2378.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2379.                 bases=(AbstractBaseUser,)
2380.             )
2381.             changes = self.get_changes([], [address, tenant])
2382.         # Right number/type of migrations?
2383.         self.assertNumberMigrations(changes, 'a', 2)
2384.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2385.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2386.         self.assertMigrationDependencies(changes, 'a', 0, [])
2387.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2388.         # Right number/type of migrations?
2389.         self.assertNumberMigrations(changes, 'b', 1)
2390.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2391.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2392. 
2393.     @override_settings(AUTH_USER_MODEL="a.Person")
2394.     def test_circular_dependency_swappable_self(self):
2395.         """
2396.         #23322 - The dependency resolver knows to explicitly resolve
2397.         swappable models.
2398.         """
2399.         with isolate_lru_cache(apps.get_swappable_settings_name):
2400.             person = ModelState("a", "Person", [
2401.                 ("id", models.AutoField(primary_key=True)),
2402.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2403.             ])
2404.             changes = self.get_changes([], [person])
2405.         # Right number/type of migrations?
2406.         self.assertNumberMigrations(changes, 'a', 1)
2407.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2408.         self.assertMigrationDependencies(changes, 'a', 0, [])
2409. 
2410.     @override_settings(AUTH_USER_MODEL='a.User')
2411.     def test_swappable_circular_multi_mti(self):
2412.         with isolate_lru_cache(apps.get_swappable_settings_name):
2413.             parent = ModelState('a', 'Parent', [
2414.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2415.             ])
2416.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2417.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2418.             changes = self.get_changes([], [parent, child, user])
2419.         self.assertNumberMigrations(changes, 'a', 1)
2420.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2421. 
2422.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2423.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2424.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2425.         """
2426.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2427.         without default should not prompt for a default.
2428.         """
2429.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2430.         # Right number/type of migrations?
2431.         self.assertNumberMigrations(changes, 'testapp', 1)
2432.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2433.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2434. 
2435.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2436.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2437.         """
2438.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2439.         without default should prompt for a default.
2440.         """
2441.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2442.         self.assertEqual(mocked_ask_method.call_count, 2)
2443.         # Right number/type of migrations?
2444.         self.assertNumberMigrations(changes, 'testapp', 1)
2445.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2446.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2447. 
2448.     def test_mti_inheritance_model_removal(self):
2449.         Animal = ModelState('app', 'Animal', [
2450.             ("id", models.AutoField(primary_key=True)),
2451.         ])
2452.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2453.         changes = self.get_changes([Animal, Dog], [Animal])
2454.         self.assertNumberMigrations(changes, 'app', 1)
2455.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2456.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 20:04:34,500 - thread-133302860101312.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='I have analyzed the provided test file `tests/migrations/test_autodetector.py` and found three relevant test cases that demonstrate how the migration autodetector handles operation ordering to prevent database inconsistencies, which is conceptually similar to the bug report. The file contains all necessary components, including imports, helper methods, and model state definitions, to construct the complete test cases. Therefore, I have sufficient context and do not require additional files.' query='' extra_requirements='' purpose=''
2025-12-23 20:04:34,501 - thread-133302860101312.prometheus_context_collector - INFO - Successfully retrieved 1 context snippets
