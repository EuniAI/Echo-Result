2025-12-21 08:47:06,413 - thread-124314420512448.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: TimeSeries: misleading exception when required column check fails.

Description: <!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Patch information:
diff --git a/astropy/timeseries/core.py b/astropy/timeseries/core.py
index c279f35f87..ae81167cb5 100644
--- a/astropy/timeseries/core.py
+++ b/astropy/timeseries/core.py
@@ -61,24 +61,38 @@ class BaseTimeSeries(QTable):
 
         if self._required_columns is not None:
 
+            # Determine which required columns to enforce in this state
             if self._required_columns_relax:
                 required_columns = self._required_columns[:len(self.colnames)]
             else:
                 required_columns = self._required_columns
 
-            plural = 's' if len(required_columns) > 1 else ''
-
+            # If not relaxed and there are no columns at all, report all required first columns
             if not self._required_columns_relax and len(self.colnames) == 0:
 
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but time series has no columns"
-                                 .format(self.__class__.__name__, required_columns[0], plural))
-
-            elif self.colnames[:len(required_columns)] != required_columns:
-
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but found '{}'"
-                                 .format(self.__class__.__name__, required_columns[0], plural, self.colnames[0]))
+                raise ValueError("{} object is invalid - expected first column{} {} but time series has no columns"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns))
+
+            # Check for mismatches between the required first columns and the actual ones
+            actual_prefix = self.colnames[:len(required_columns)]
+            if actual_prefix != required_columns:
+                if not self._required_columns_relax:
+                    # If the actual columns form a correct prefix of the required columns,
+                    # then required columns are missing
+                    if self.colnames == self._required_columns[:len(self.colnames)] and len(self.colnames) < len(self._required_columns):
+                        missing = self._required_columns[len(self.colnames):]
+                        raise ValueError("{} object is invalid - missing required column{}: {}"
+                                         .format(self.__class__.__name__,
+                                                 's' if len(missing) > 1 else '',
+                                                 missing))
+                # Otherwise, report the expected vs. actual first columns for clarity
+                raise ValueError("{} object is invalid - expected first column{} {} but found {}"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns,
+                                         actual_prefix))
 
             if (self._required_columns_relax
                     and self._required_columns == self.colnames[:len(self._required_columns)]):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 08:47:06,488 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── labeler.yml
|   └── workflows
|       ├── cancel_workflows.yml
|       ├── check_changelog.yml
|       ├── ci_cron_daily.yml
|       ├── ci_cron_weekly.yml
|       ├── ci_workflows.yml
|       ├── codeql-analysis.yml
|       ├── open_actions.yml
|       ├── stalebot.yml
|       └── update_iers.yml
├── .pep8speaks.yml
├── .pre-commit-config.yaml
├── .pyinstaller
|   ├── hooks
|   |   └── hook-skyfield.py
|   └── run_astropy_tests.py
├── .readthedocs.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── GOVERNANCE.md
├── LICENSE.rst
├── README.rst
├── astropy
|   ├── __init__.py
|   ├── _dev
|   |   ├── __init__.py
|   |   └── scm_version.py
|   ├── _erfa
|   |   └── __init__.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── astropyconst40.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── codata2018.py
|   |   ├── config.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_prior_version.py
|   |   |   └── test_sciencestate.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   |   └── convolve.c
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_formats.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── equatorial.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hadec.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── icrs_observed_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── erfa_astrom.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── jparser.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── sky_coordinate_parsers.py
|   |   ├── solar_system.py
|   |   ├── spectral_coordinate.py
|   |   ├── spectral_quantity.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── generate_spectralcoord_ref.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── helper.py
|   |   |   ├── test_angle_generators.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_erfa_astrom.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_geodetic_representations.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_icrs_observed_transformations.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_spectral_coordinate.py
|   |   |   ├── test_spectral_quantity.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_utils.py
|   |   |   └── test_velocity_corrs.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── connect.py
|   |   ├── core.py
|   |   ├── data
|   |   ├── flrw
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── lambdacdm.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── conftest.py
|   |   |   |   ├── test_base.py
|   |   |   |   ├── test_lambdacdm.py
|   |   |   |   ├── test_w0cdm.py
|   |   |   |   ├── test_w0wacdm.py
|   |   |   |   ├── test_w0wzcdm.py
|   |   |   |   └── test_wpwazpcdm.py
|   |   |   ├── w0cdm.py
|   |   |   ├── w0wacdm.py
|   |   |   ├── w0wzcdm.py
|   |   |   └── wpwazpcdm.py
|   |   ├── funcs.py
|   |   ├── io
|   |   |   ├── __init__.py
|   |   |   ├── cosmology.py
|   |   |   ├── ecsv.py
|   |   |   ├── mapping.py
|   |   |   ├── model.py
|   |   |   ├── row.py
|   |   |   ├── table.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── test_cosmology.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_json.py
|   |   |   |   ├── test_mapping.py
|   |   |   |   ├── test_model.py
|   |   |   |   ├── test_row.py
|   |   |   |   ├── test_table.py
|   |   |   |   └── test_yaml.py
|   |   |   ├── utils.py
|   |   |   └── yaml.py
|   |   ├── parameter.py
|   |   ├── parameters.py
|   |   ├── realizations.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── conftest.py
|   |   |   ├── helper.py
|   |   |   ├── test_connect.py
|   |   |   ├── test_core.py
|   |   |   ├── test_cosmology.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_parameter.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_realizations.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   ├── units.py
|   |   └── utils.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── _strptime.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── jquery
|   |   |   ├── __init__.py
|   |   |   └── data
|   |   |       ├── css
|   |   |       ├── images
|   |   |       └── js
|   |   └── ply
|   |       ├── __init__.py
|   |       ├── cpp.py
|   |       ├── ctokens.py
|   |       ├── lex.py
|   |       ├── yacc.py
|   |       └── ygen.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── docs.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── mrt.py
|   |   |   ├── qdp.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── data
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_qdp.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_image_dask.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── conftest.py
|   |   |   |   ├── connect.py
|   |   |   |   ├── data
|   |   |   |   ├── deprecation.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── tags
|   |   |   |   ├── tests
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pandas
|   |   |   |   ├── __init__.py
|   |   |   |   └── connect.py
|   |   |   ├── parquet.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pandas.py
|   |   |   |   ├── test_parquet.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── compat.py
|   |   |   ├── core.py
|   |   |   ├── interface.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_registries.py
|   |   |       └── test_registry_help.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── mixin_columns.py
|   |   |   └── safeio.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   └── result.py
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── bounding_box.py
|   |   ├── convolution.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── math_functions.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── physical_models.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── spline.py
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── __init__.py
|   |   |   |   └── spec.txt
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_bounding_box.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_convolution.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_math_func.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_physical_models.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_spline.py
|   |   |   ├── test_statistics.py
|   |   |   ├── test_units_mapping.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── _testing.py
|   |   ├── bitmask.py
|   |   ├── blocks.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_bitmask.py
|   |   |   ├── test_blocks.py
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── bls
|   |   |   └── __init__.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   └── __init__.py
|   |   ├── setup_package.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   ├── src
|   |   |   ├── compute_bounds.c
|   |   |   ├── fast_sigma_clip.c
|   |   |   └── wirth_select.c
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── connect.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── dask.py
|   |   |   ├── registry.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_dask.py
|   |   |       └── test_registry.py
|   |   ├── ndarray_mixin.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── soco.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── runner.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   |   └── parse_times.c
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_custom_formats.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_fast_parser.py
|   |   |   ├── test_functions.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   ├── test_update_leap_seconds.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── timeseries
|   |   ├── __init__.py
|   |   ├── binned.py
|   |   ├── core.py
|   |   ├── downsample.py
|   |   ├── io
|   |   |   ├── __init__.py
|   |   |   ├── kepler.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_kepler.py
|   |   ├── periodograms
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── bls
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core.py
|   |   |   |   ├── methods.py
|   |   |   |   ├── setup_package.py
|   |   |   |   └── tests
|   |   |   └── lombscargle
|   |   |       ├── __init__.py
|   |   |       ├── _statistics.py
|   |   |       ├── core.py
|   |   |       ├── implementations
|   |   |       ├── tests
|   |   |       └── utils.py
|   |   ├── sampled.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       ├── test_binned.py
|   |       ├── test_common.py
|   |       ├── test_downsample.py
|   |       └── test_sampled.py
|   ├── uncertainty
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── distributions.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_distribution.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── _typing.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── misc.py
|   |   ├── photometric.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper
|   |   |   ├── __init__.py
|   |   |   ├── converters.py
|   |   |   ├── erfa.py
|   |   |   ├── function_helpers.py
|   |   |   ├── helpers.py
|   |   |   └── scipy_special.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── structured.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_aliases.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_photometric.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_annotations.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_helpers.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_typing.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   ├── test_structured.py
|   |   |   ├── test_structured_erfa_ufuncs.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpycompat.py
|   |   |   └── optional_deps.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── diff.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── update_builtin_iers.sh
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── data
|   |   |       ├── test_iers.py
|   |   |       └── test_leap_second.py
|   |   ├── introspection.py
|   |   ├── masked
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── function_helpers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_containers.py
|   |   |       ├── test_function_helpers.py
|   |   |       ├── test_functions.py
|   |   |       ├── test_masked.py
|   |   |       └── test_table.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── parsing.py
|   |   ├── setup_package.py
|   |   ├── shapes.py
|   |   ├── src
|   |   |   └── compiler.c
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── dataurl
|   |   |   |   ├── dataurl_mirror
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_diff.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_parsing.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_shapes.py
|   |   |   ├── test_state.py
|   |   |   └── test_xml.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── version.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   ├── test_time.py
|   |   |   └── test_units.py
|   |   ├── time.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_grid_paths.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   ├── test_utils.py
|   |       |   └── test_wcsapi.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       ├── utils.py
|   |       └── wcsapi.py
|   └── wcs
|       ├── __init__.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_auxprm_wrap.c
|       |   ├── wcslib_celprm_wrap.c
|       |   ├── wcslib_prjprm_wrap.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   ├── wcslib_wrap.c
|       |   └── wcslib_wtbarr_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── conftest.py
|       |   ├── data
|       |   |   ├── maps
|       |   |   ├── spectra
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   ├── validate.6.txt
|       |   |   ├── validate.7.4.txt
|       |   |   ├── validate.7.6.txt
|       |   |   └── validate.txt
|       |   ├── helper.py
|       |   ├── test_auxprm.py
|       |   ├── test_celprm.py
|       |   ├── test_pickle.py
|       |   ├── test_prjprm.py
|       |   ├── test_profiling.py
|       |   ├── test_tab.py
|       |   ├── test_tabprm.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   ├── test_wcsprm.py
|       |   └── test_wtbarr.py
|       ├── utils.py
|       ├── wcs.py
|       ├── wcsapi
|       |   ├── __init__.py
|       |   ├── conftest.py
|       |   ├── data
|       |   |   └── ucds.txt
|       |   ├── fitswcs.py
|       |   ├── high_level_api.py
|       |   ├── high_level_wcs_wrapper.py
|       |   ├── low_level_api.py
|       |   ├── sliced_low_level_wcs.py
|       |   ├── tests
|       |   |   ├── __init__.py
|       |   |   ├── test_fitswcs.py
|       |   |   ├── test_high_level_api.py
|       |   |   ├── test_high_level_wcs_wrapper.py
|       |   |   ├── test_low_level_api.py
|       |   |   └── test_utils.py
|       |   ├── utils.py
|       |   └── wrappers
|       |       ├── __init__.py
|       |       ├── base.py
|       |       ├── sliced_wcs.py
|       |       └── tests
|       └── wcslint.py
├── azure-pipelines.yml
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   ├── wcsutil.c
|   |   |   ├── zcompress.c
|   |   |   └── zuncompress.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       └── zutil.c
|   ├── expat
|   |   ├── README.md
|   |   ├── README.txt
|   |   └── lib
|   |       ├── xmlparse.c
|   |       ├── xmlrole.c
|   |       ├── xmltok.c
|   |       ├── xmltok_impl.c
|   |       └── xmltok_ns.c
|   ├── trim_cfitsio.sh
|   ├── trim_expat.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── codecov.yml
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── _templates
|   |   └── layout.html
|   ├── changelog.rst
|   ├── changes
|   |   ├── README.rst
|   |   ├── config
|   |   ├── constants
|   |   ├── convolution
|   |   ├── coordinates
|   |   ├── cosmology
|   |   |   ├── 12279.feature.rst
|   |   |   ├── 12313.feature.rst
|   |   |   ├── 12354.api.rst
|   |   |   ├── 12375.api.rst
|   |   |   ├── 12479.feature.rst
|   |   |   ├── 12590.feature.rst
|   |   |   ├── 12606.feature.rst
|   |   |   ├── 12612.api.rst
|   |   |   ├── 12624.api.rst
|   |   |   ├── 12710.feature.rst
|   |   |   ├── 12736.feature.rst
|   |   |   ├── 12740.feature.rst
|   |   |   ├── 12746.api.rst
|   |   |   └── 12966.feature.rst
|   |   ├── extern
|   |   ├── io.ascii
|   |   |   ├── 12631.bugfix.rst
|   |   |   └── 12841.api.rst
|   |   ├── io.fits
|   |   |   ├── 11843.feature.rst
|   |   |   └── 12258.api.rst
|   |   ├── io.misc
|   |   |   ├── 10198.feature.rst
|   |   |   ├── 12279.feature.rst
|   |   |   ├── 12895.feature.rst
|   |   |   ├── 12897.feature.rst
|   |   |   ├── 12903.api.rst
|   |   |   └── 12930.api.rst
|   |   ├── io.registry
|   |   ├── io.votable
|   |   ├── modeling
|   |   |   ├── 12384.feature.rst
|   |   |   ├── 12558.feature.rst
|   |   |   ├── 12585.api.rst
|   |   |   └── 12811.feature.rst
|   |   ├── nddata
|   |   ├── samp
|   |   ├── stats
|   |   ├── table
|   |   |   ├── 12631.api.rst
|   |   |   ├── 12637.api.rst
|   |   |   ├── 12637.feature.rst
|   |   |   ├── 12680.feature.rst
|   |   |   └── 12716.bugfix.rst
|   |   ├── template.rst
|   |   ├── tests
|   |   |   ├── 12633.api.1.rst
|   |   |   ├── 12633.api.2.rst
|   |   |   ├── 12633.api.3.rst
|   |   |   └── 12633.api.4.rst
|   |   ├── time
|   |   |   └── 12888.api.rst
|   |   ├── timeseries
|   |   ├── uncertainty
|   |   ├── units
|   |   |   ├── 12486.feature.rst
|   |   |   ├── 12566.feature.rst
|   |   |   ├── 12709.feature.rst
|   |   |   └── 12975.feature.rst
|   |   ├── utils
|   |   ├── visualization
|   |   └── wcs
|   |       └── 12514.feature.rst
|   ├── common_links.txt
|   ├── conf.py
|   ├── config
|   |   ├── astropy_config.rst
|   |   └── index.rst
|   ├── conftest.py
|   ├── constants
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   ├── performance.inc.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── common_errors.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── performance.inc.rst
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── satellites.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── spectralcoord.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   ├── dev.rst
|   |   ├── index.rst
|   |   ├── io.rst
|   |   └── units.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── style-guide.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   ├── when_to_rebase.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       └── virtual_pythons.rst
|   ├── getting_started.rst
|   ├── glossary.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── ecsv.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── asdf-schemas.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       ├── performance.inc.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── lts_policy.rst
|   ├── modeling
|   |   ├── add-units.rst
|   |   ├── compound-models.rst
|   |   ├── example-fitting-constraints.rst
|   |   ├── example-fitting-line.rst
|   |   ├── example-fitting-model-sets.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── jointfitter.rst
|   |   ├── models.rst
|   |   ├── new-fitter.rst
|   |   ├── new-model.rst
|   |   ├── parameters.rst
|   |   ├── performance.rst
|   |   ├── physical_models.rst
|   |   ├── polynomial_models.rst
|   |   ├── predef_models1D.rst
|   |   ├── predef_models2D.rst
|   |   ├── reference_api.rst
|   |   ├── spline_models.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── bitmask.rst
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── examples
|   |   |   └── cutout2d_tofits.py
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── performance.inc.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── robots.txt
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── performance.inc.rst
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── timeseries
|   |   ├── analysis.rst
|   |   ├── bls.rst
|   |   ├── data_access.rst
|   |   ├── index.rst
|   |   ├── initializing.rst
|   |   ├── io.rst
|   |   ├── lombscargle.rst
|   |   ├── masking.rst
|   |   ├── pandas.rst
|   |   └── times.rst
|   ├── uncertainty
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── constants_versions.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── performance.inc.rst
|   |   ├── physical_types.rst
|   |   ├── quantity.rst
|   |   ├── standard_units.rst
|   |   ├── structured_units.rst
|   |   └── type_hints.rst
|   ├── utils
|   |   ├── data.rst
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── masked
|   |       └── index.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── matplotlib_integration.rst
|   |   ├── normalization.rst
|   |   ├── performance.inc.rst
|   |   ├── rgb.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── generic_transforms.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── example_create_imaging.rst
|   |   ├── example_cube_wcs.rst
|   |   ├── examples
|   |   |   ├── cube_wcs.py
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── legacy_interface.rst
|   |   ├── loading_from_fits.rst
|   |   ├── note_sip.rst
|   |   ├── performance.inc.rst
|   |   ├── reference_api.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   ├── relax.rst
|   |   ├── supported_projections.rst
|   |   ├── validation.rst
|   |   ├── wcsapi.rst
|   |   └── wcstools.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       ├── 3.2.rst
|       ├── 4.0.rst
|       ├── 4.1.rst
|       ├── 4.2.rst
|       ├── 4.3.rst
|       ├── 5.0.rst
|       ├── 5.1.rst
|       └── index.rst
├── examples
|   ├── README.rst
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── PYTHON.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
└── setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: TimeSeries: misleading exception when required column check fails.

Description: <!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Patch information:
diff --git a/astropy/timeseries/core.py b/astropy/timeseries/core.py
index c279f35f87..ae81167cb5 100644
--- a/astropy/timeseries/core.py
+++ b/astropy/timeseries/core.py
@@ -61,24 +61,38 @@ class BaseTimeSeries(QTable):
 
         if self._required_columns is not None:
 
+            # Determine which required columns to enforce in this state
             if self._required_columns_relax:
                 required_columns = self._required_columns[:len(self.colnames)]
             else:
                 required_columns = self._required_columns
 
-            plural = 's' if len(required_columns) > 1 else ''
-
+            # If not relaxed and there are no columns at all, report all required first columns
             if not self._required_columns_relax and len(self.colnames) == 0:
 
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but time series has no columns"
-                                 .format(self.__class__.__name__, required_columns[0], plural))
-
-            elif self.colnames[:len(required_columns)] != required_columns:
-
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but found '{}'"
-                                 .format(self.__class__.__name__, required_columns[0], plural, self.colnames[0]))
+                raise ValueError("{} object is invalid - expected first column{} {} but time series has no columns"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns))
+
+            # Check for mismatches between the required first columns and the actual ones
+            actual_prefix = self.colnames[:len(required_columns)]
+            if actual_prefix != required_columns:
+                if not self._required_columns_relax:
+                    # If the actual columns form a correct prefix of the required columns,
+                    # then required columns are missing
+                    if self.colnames == self._required_columns[:len(self.colnames)] and len(self.colnames) < len(self._required_columns):
+                        missing = self._required_columns[len(self.colnames):]
+                        raise ValueError("{} object is invalid - missing required column{}: {}"
+                                         .format(self.__class__.__name__,
+                                                 's' if len(missing) > 1 else '',
+                                                 missing))
+                # Otherwise, report the expected vs. actual first columns for clarity
+                raise ValueError("{} object is invalid - expected first column{} {} but found {}"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns,
+                                         actual_prefix))
 
             if (self._required_columns_relax
                     and self._required_columns == self.colnames[:len(self._required_columns)]):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:47:17,323 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a bug in the `TimeSeries` class. The tests for `TimeSeries` are located in `astropy/timeseries/tests/test_sampled.py`. To find the most relevant test cases, I need to examine the contents of this file. The current context is empty, so I need to request the file content.' query='Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.' extra_requirements='' purpose='I need the content of this test file to identify three relevant test cases that demonstrate functionality similar to the bug report, as requested by the user.'
2025-12-21 08:47:17,324 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.
2025-12-21 08:47:17,324 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:47:17,325 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:47:17,325 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:47:17,325 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.
Purpose: I need the content of this test file to identify three relevant test cases that demonstrate functionality similar to the bug report, as requested by the user.
2025-12-21 08:47:19,823 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of the file `astropy/timeseries/tests/test_sampled.py`. This will allow me to examine the test cases within and identify those that are most relevant to the bug report you've provided. I will now proceed with analyzing the file to find the appropriate examples." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/timeseries/tests/test_sampled.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2127, 'candidates_token_count': 91, 'total_token_count': 2283, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2127}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 91}], 'thoughts_token_count': 65, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08265025275094169, 'model_name': 'gemini-2.5-pro'} id='run--9e5aa86a-7110-4f41-bd2a-e5e0894dbb06-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/tests/test_sampled.py'}, 'id': '42ad0dd2-9414-4a70-a6b8-0afeb8660184', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2127, 'output_tokens': 91, 'total_tokens': 2283, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 65}}
2025-12-21 08:47:24,237 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have successfully retrieved the entire content of the test file `astropy/timeseries/tests/test_sampled.py`. I noticed the initial tool execution returned only a preview of the file, so I ran a second command to fetch the remaining lines, ensuring I have the complete file for a thorough analysis. Now I will proceed to analyze the test cases within to identify the most relevant examples for the user's purpose." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/timeseries/tests/test_sampled.py", "start_line": 421.0, "end_line": 1000.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10162, 'candidates_token_count': 119, 'total_token_count': 10516, 'cached_content_token_count': 1849, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10162}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1849}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 119}], 'thoughts_token_count': 235}, 'finish_reason': 'STOP', 'avg_logprobs': -0.40768567253561583, 'model_name': 'gemini-2.5-pro'} id='run--d3347ca8-85dc-4532-9df8-5de890caeb67-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/timeseries/tests/test_sampled.py', 'start_line': 421.0, 'end_line': 1000.0}, 'id': 'a6b32693-da3b-4af6-aad5-48738bdb20b2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10162, 'output_tokens': 119, 'total_tokens': 10516, 'input_token_details': {'cache_read': 1849}, 'output_token_details': {'reasoning': 235}}
2025-12-21 08:47:32,607 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the test file `astropy/timeseries/tests/test_sampled.py`. I noticed the initial tool execution returned only a preview of the file, so I ran a second command to fetch the remaining lines, ensuring I have the complete file for a thorough analysis. You can now proceed to analyze the test cases within to identify the most relevant examples for your purpose.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10372, 'candidates_token_count': 83, 'total_token_count': 11282, 'cached_content_token_count': 9219, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10372}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9219}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 83}], 'thoughts_token_count': 827}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9898762530591114, 'model_name': 'gemini-2.5-pro'} id='run--2bfbcf3b-f0f6-4f76-9193-c10b72851228-0' usage_metadata={'input_tokens': 10372, 'output_tokens': 83, 'total_tokens': 11282, 'input_token_details': {'cache_read': 9219}, 'output_token_details': {'reasoning': 827}}
2025-12-21 08:47:32,609 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need the content of this test file to identify three relevant test cases that demonstrate functionality similar to the bug report, as requested by the user.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/timeseries/tests/test_sampled.py
Line number range: 1 - 420
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. from datetime import datetime
4. 
5. import pytest
6. 
7. from numpy.testing import assert_equal, assert_allclose
8. 
9. from astropy.table import Table, Column
10. from astropy.time import Time, TimeDelta
11. from astropy import units as u
12. from astropy.units import Quantity
13. from astropy.utils.data import get_pkg_data_filename
14. from astropy.tests.helper import assert_quantity_allclose
15. 
16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
17. from astropy.timeseries.sampled import TimeSeries
18. 
19. INPUT_TIME = Time(['2016-03-22T12:30:31',
20.                    '2015-01-21T12:30:32',
21.                    '2016-03-22T12:30:40'])
22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=['a', 'b', 'c'])
23. 
24. CSV_FILE = get_pkg_data_filename('data/sampled.csv')
25. 
26. 
27. def test_empty_initialization():
28.     ts = TimeSeries()
29.     ts['time'] = Time([50001, 50002, 50003], format='mjd')
30. 
31. 
32. def test_empty_initialization_invalid():
33.     # Make sure things crash when the first column added is not a time column
34.     ts = TimeSeries()
35.     with pytest.raises(ValueError) as exc:
36.         ts['flux'] = [1, 2, 3]
37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
38.                                  "'time' as the first column but found 'flux'")
39. 
40. 
41. def test_initialize_only_time():
42.     ts = TimeSeries(time=INPUT_TIME)
43.     assert ts['time'] is ts.time
44.     # NOTE: the object in the table is a copy
45.     assert_equal(ts.time.isot, INPUT_TIME.isot)
46. 
47. 
48. def test_initialization_with_data():
49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
50.     assert_equal(ts.time.isot, INPUT_TIME.isot)
51.     assert_equal(ts['a'], [10, 2, 3])
52.     assert_equal(ts['b'], [4, 5, 6])
53. 
54. 
55. def test_initialize_only_data():
56.     with pytest.raises(TypeError) as exc:
57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
58.     assert exc.value.args[0] == "Either 'time' or 'time_start' should be specified"
59. 
60. 
61. def test_initialization_with_table():
62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)
63.     assert ts.colnames == ['time', 'a', 'b', 'c']
64. 
65. 
66. def test_initialization_with_time_delta():
67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
68.                     time_delta=TimeDelta(3, format='sec'),
69.                     data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
70.     assert_equal(ts.time.isot, ['2018-07-01T10:10:10.000',
71.                                 '2018-07-01T10:10:13.000',
72.                                 '2018-07-01T10:10:16.000'])
73. 
74. 
75. def test_initialization_missing_time_delta():
76.     with pytest.raises(TypeError) as exc:
77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
78.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
79.     assert exc.value.args[0] == "'time' is scalar, so 'time_delta' is required"
80. 
81. 
82. def test_initialization_invalid_time_and_time_start():
83.     with pytest.raises(TypeError) as exc:
84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),
85.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
86.     assert exc.value.args[0] == "Cannot specify both 'time' and 'time_start'"
87. 
88. 
89. def test_initialization_invalid_time_delta():
90.     with pytest.raises(TypeError) as exc:
91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
92.                    time_delta=[1, 4, 3],
93.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
94.     assert exc.value.args[0] == "'time_delta' should be a Quantity or a TimeDelta"
95. 
96. 
97. def test_initialization_with_time_in_data():
98. 
99.     data = PLAIN_TABLE.copy()
100.     data['time'] = INPUT_TIME
101. 
102.     ts1 = TimeSeries(data=data)
103. 
104.     assert set(ts1.colnames) == set(['time', 'a', 'b', 'c'])
105.     assert all(ts1.time == INPUT_TIME)
106. 
107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
108.     assert set(ts2.colnames) == set(['time', 'a'])
109.     assert all(ts2.time == INPUT_TIME)
110. 
111.     with pytest.raises(TypeError) as exc:
112.         # Don't allow ambiguous cases of passing multiple 'time' columns
113.         TimeSeries(data=data, time=INPUT_TIME)
114.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
115. 
116.     with pytest.raises(TypeError) as exc:
117.         # 'time' is a protected name, don't allow ambiguous cases
118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
119.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
120. 
121. 
122. def test_initialization_n_samples():
123. 
124.     # Make sure things crash with incorrect n_samples
125. 
126.     with pytest.raises(TypeError) as exc:
127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)
128.     assert exc.value.args[0] == ("'n_samples' has been given both and it is not the "
129.                                  "same length as the input data.")
130. 
131. 
132. def test_initialization_length_mismatch():
133.     with pytest.raises(ValueError) as exc:
134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=['a', 'b'])
135.     assert exc.value.args[0] == "Length of 'time' (3) should match data length (2)"
136. 
137. 
138. def test_initialization_invalid_both_time_and_time_delta():
139.     with pytest.raises(TypeError) as exc:
140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format='sec'))
141.     assert exc.value.args[0] == ("'time_delta' should not be specified since "
142.                                  "'time' is an array")
143. 
144. 
145. def test_fold():
146. 
147.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
148. 
149.     ts = TimeSeries(time=times)
150.     ts['flux'] = [1, 4, 4, 3, 2, 3]
151. 
152.     # Try without epoch time, as it should default to the first time and
153.     # wrapping at half the period.
154.     tsf = ts.fold(period=3.2 * u.s)
155.     assert isinstance(tsf.time, TimeDelta)
156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)
157. 
158.     # Try with epoch time
159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'))
160.     assert isinstance(tsf.time, TimeDelta)
161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)
162. 
163.     # Now with wrap_phase set to the full period
164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)
165.     assert isinstance(tsf.time, TimeDelta)
166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)
167. 
168.     # Now set epoch_phase to be 1/4 of the way through the phase
169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)
170.     assert isinstance(tsf.time, TimeDelta)
171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)
172. 
173.     # And combining epoch_phase and wrap_phase
174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)
175.     assert isinstance(tsf.time, TimeDelta)
176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)
177. 
178.     # Now repeat the above tests but with normalization applied
179. 
180.     # Try without epoch time, as it should default to the first time and
181.     # wrapping at half the period.
182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)
183.     assert isinstance(tsf.time, Quantity)
184.     assert_allclose(tsf.time.to_value(u.one),
185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],
186.                     rtol=1e-6)
187. 
188.     # Try with epoch time
189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'),
190.                   normalize_phase=True)
191.     assert isinstance(tsf.time, Quantity)
192.     assert_allclose(tsf.time.to_value(u.one),
193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],
194.                     rtol=1e-6, atol=1e-6)
195. 
196.     # Now with wrap_phase set to the full period
197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)
198.     assert isinstance(tsf.time, Quantity)
199.     assert_allclose(tsf.time.to_value(u.one),
200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],
201.                     rtol=1e-6)
202. 
203.     # Now set epoch_phase to be 1/4 of the way through the phase
204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)
205.     assert isinstance(tsf.time, Quantity)
206.     assert_allclose(tsf.time.to_value(u.one),
207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],
208.                     rtol=1e-6)
209. 
210.     # And combining epoch_phase and wrap_phase
211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,
212.                   normalize_phase=True)
213.     assert isinstance(tsf.time, Quantity)
214.     assert_allclose(tsf.time.to_value(u.one),
215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],
216.                     rtol=1e-6)
217. 
218. 
219. def test_fold_invalid_options():
220. 
221.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
222. 
223.     ts = TimeSeries(time=times)
224.     ts['flux'] = [1, 4, 4, 3, 2, 3]
225. 
226.     with pytest.raises(u.UnitsError,
227.                        match='period should be a Quantity in units of time'):
228.         ts.fold(period=3.2)
229. 
230.     with pytest.raises(u.UnitsError,
231.                        match='period should be a Quantity in units of time'):
232.         ts.fold(period=3.2 * u.m)
233. 
234.     with pytest.raises(u.UnitsError,
235.                        match='epoch_phase should be a Quantity in units of '
236.                              'time when normalize_phase=False'):
237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)
238. 
239.     with pytest.raises(u.UnitsError,
240.                        match='epoch_phase should be a dimensionless Quantity '
241.                              'or a float when normalize_phase=True'):
242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)
243. 
244.     with pytest.raises(u.UnitsError,
245.                        match='wrap_phase should be a Quantity in units of '
246.                              'time when normalize_phase=False'):
247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)
248. 
249.     with pytest.raises(u.UnitsError,
250.                        match='wrap_phase should be dimensionless when '
251.                              'normalize_phase=True'):
252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)
253. 
254.     with pytest.raises(ValueError,
255.                        match='wrap_phase should be between 0 and the period'):
256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)
257. 
258.     with pytest.raises(ValueError,
259.                        match='wrap_phase should be between 0 and the period'):
260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)
261. 
262.     with pytest.raises(ValueError,
263.                        match='wrap_phase should be between 0 and 1'):
264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)
265. 
266.     with pytest.raises(ValueError,
267.                        match='wrap_phase should be between 0 and 1'):
268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)
269. 
270. 
271. def test_pandas():
272.     pandas = pytest.importorskip("pandas")
273. 
274.     df1 = pandas.DataFrame()
275.     df1['a'] = [1, 2, 3]
276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)
277. 
278.     ts = TimeSeries.from_pandas(df1)
279.     assert_equal(ts.time.isot, INPUT_TIME.isot)
280.     assert ts.colnames == ['time', 'a']
281.     assert len(ts.indices) == 1
282.     assert (ts.indices['time'].columns[0] == INPUT_TIME).all()
283. 
284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale='tcb')
285.     assert ts_tcb.time.scale == 'tcb'
286. 
287.     df2 = ts.to_pandas()
288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()
289.     assert df2.columns == pandas.Index(['a'])
290.     assert (df1['a'] == df2['a']).all()
291. 
292.     with pytest.raises(TypeError) as exc:
293.         TimeSeries.from_pandas(None)
294.     assert exc.value.args[0] == 'Input should be a pandas DataFrame'
295. 
296.     df4 = pandas.DataFrame()
297.     df4['a'] = [1, 2, 3]
298. 
299.     with pytest.raises(TypeError) as exc:
300.         TimeSeries.from_pandas(df4)
301.     assert exc.value.args[0] == 'DataFrame does not have a DatetimeIndex'
302. 
303. 
304. def test_read_time_missing():
305.     with pytest.raises(ValueError) as exc:
306.         TimeSeries.read(CSV_FILE, format='csv')
307.     assert exc.value.args[0] == '``time_column`` should be provided since the default Table readers are being used.'
308. 
309. 
310. def test_read_time_wrong():
311.     with pytest.raises(ValueError) as exc:
312.         TimeSeries.read(CSV_FILE, time_column='abc', format='csv')
313.     assert exc.value.args[0] == "Time column 'abc' not found in the input data."
314. 
315. 
316. def test_read():
317.     timeseries = TimeSeries.read(CSV_FILE, time_column='Date', format='csv')
318.     assert timeseries.colnames == ['time', 'A', 'B', 'C', 'D', 'E', 'F', 'G']
319.     assert len(timeseries) == 11
320.     assert timeseries['time'].format == 'iso'
321.     assert timeseries['A'].sum() == 266.5
322. 
323. 
324. @pytest.mark.remote_data(source='astropy')
325. def test_kepler_astropy():
326.     from astropy.units import UnitsWarning
327. 
328.     filename = get_pkg_data_filename('timeseries/kplr010666592-2009131110544_slc.fits')
329. 
330.     with pytest.warns(UnitsWarning):
331.         timeseries = TimeSeries.read(filename, format='kepler.fits')
332. 
333.     assert timeseries["time"].format == 'isot'
334.     assert timeseries["time"].scale == 'tdb'
335.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
336.     assert len(timeseries) == 14280
337.     assert len(timeseries.columns) == 20
338. 
339. 
340. @pytest.mark.remote_data(source='astropy')
341. def test_tess_astropy():
342.     filename = get_pkg_data_filename('timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits')
343.     with pytest.warns(UserWarning, match='Ignoring 815 rows with NaN times'):
344.         timeseries = TimeSeries.read(filename, format='tess.fits')
345.     assert timeseries["time"].format == 'isot'
346.     assert timeseries["time"].scale == 'tdb'
347.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
348.     assert len(timeseries) == 19261
349.     assert len(timeseries.columns) == 20
350. 
351. 
352. def test_required_columns():
353. 
354.     # Test the machinery that makes sure that the required columns are present
355. 
356.     ts = TimeSeries(time=INPUT_TIME,
357.                     data=[[10, 2, 3], [4, 5, 6]],
358.                     names=['a', 'b'])
359. 
360.     # In the examples below, the operation (e.g. remove_column) is actually
361.     # carried out before the checks are made, so we need to use copy() so that
362.     # we don't change the main version of the time series.
363. 
364.     # Make sure copy works fine
365.     ts.copy()
366. 
367.     with pytest.raises(ValueError) as exc:
368.         ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
370.                                  "'time' as the first column but found 'c'")
371. 
372.     with pytest.raises(ValueError) as exc:
373.         ts.copy().add_columns([Column([3, 4, 5], name='d'),
374.                                Column([3, 4, 5], name='e')], indexes=[0, 1])
375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
376.                                  "'time' as the first column but found 'd'")
377. 
378.     with pytest.raises(ValueError) as exc:
379.         ts.copy().keep_columns(['a', 'b'])
380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
381.                                  "'time' as the first column but found 'a'")
382. 
383.     with pytest.raises(ValueError) as exc:
384.         ts.copy().remove_column('time')
385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
386.                                  "'time' as the first column but found 'a'")
387. 
388.     with pytest.raises(ValueError) as exc:
389.         ts.copy().remove_columns(['time', 'a'])
390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
391.                                  "'time' as the first column but found 'b'")
392. 
393.     with pytest.raises(ValueError) as exc:
394.         ts.copy().rename_column('time', 'banana')
395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
396.                                  "'time' as the first column but found 'banana'")
397. 
398. 
399. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
400. def test_periodogram(cls):
401. 
402.     # Note that we don't need to check the actual results from the periodogram
403.     # classes here since these are tested extensively in
404.     # astropy.timeseries.periodograms.
405. 
406.     ts = TimeSeries(time=INPUT_TIME,
407.                     data=[[10, 2, 3], [4, 5, 6]],
408.                     names=['a', 'b'])
409. 
410.     p1 = cls.from_timeseries(ts, 'a')
411.     assert isinstance(p1, cls)
412.     assert_allclose(p1.t.jd, ts.time.jd)
413.     assert_equal(p1.y, ts['a'])
414.     assert p1.dy is None
415. 
416.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
417.     assert_quantity_allclose(p2.dy, ts['b'])
418. 
419.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
420.     assert_allclose(p3.dy, 0.1)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:47:36,730 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file `astropy/timeseries/tests/test_sampled.py`. The provided context contains the entire content of this file, from line 1 to 420. Therefore, the entire file is relevant to fulfill the user's request.", relative_path='astropy/timeseries/tests/test_sampled.py', start_line=1, end_line=420)]
2025-12-21 08:47:36,731 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.
2025-12-21 08:47:36,731 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:47:36,731 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:47:36,732 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 08:47:36,732 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 08:47:36,732 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── labeler.yml
|   └── workflows
|       ├── cancel_workflows.yml
|       ├── check_changelog.yml
|       ├── ci_cron_daily.yml
|       ├── ci_cron_weekly.yml
|       ├── ci_workflows.yml
|       ├── codeql-analysis.yml
|       ├── open_actions.yml
|       ├── stalebot.yml
|       └── update_iers.yml
├── .pep8speaks.yml
├── .pre-commit-config.yaml
├── .pyinstaller
|   ├── hooks
|   |   └── hook-skyfield.py
|   └── run_astropy_tests.py
├── .readthedocs.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── GOVERNANCE.md
├── LICENSE.rst
├── README.rst
├── astropy
|   ├── __init__.py
|   ├── _dev
|   |   ├── __init__.py
|   |   └── scm_version.py
|   ├── _erfa
|   |   └── __init__.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── astropyconst40.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── codata2018.py
|   |   ├── config.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_prior_version.py
|   |   |   └── test_sciencestate.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   |   └── convolve.c
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_formats.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── equatorial.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hadec.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── icrs_observed_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── erfa_astrom.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── jparser.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── sky_coordinate_parsers.py
|   |   ├── solar_system.py
|   |   ├── spectral_coordinate.py
|   |   ├── spectral_quantity.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── generate_spectralcoord_ref.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── helper.py
|   |   |   ├── test_angle_generators.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_erfa_astrom.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_geodetic_representations.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_icrs_observed_transformations.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_spectral_coordinate.py
|   |   |   ├── test_spectral_quantity.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_utils.py
|   |   |   └── test_velocity_corrs.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── connect.py
|   |   ├── core.py
|   |   ├── data
|   |   ├── flrw
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── lambdacdm.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── conftest.py
|   |   |   |   ├── test_base.py
|   |   |   |   ├── test_lambdacdm.py
|   |   |   |   ├── test_w0cdm.py
|   |   |   |   ├── test_w0wacdm.py
|   |   |   |   ├── test_w0wzcdm.py
|   |   |   |   └── test_wpwazpcdm.py
|   |   |   ├── w0cdm.py
|   |   |   ├── w0wacdm.py
|   |   |   ├── w0wzcdm.py
|   |   |   └── wpwazpcdm.py
|   |   ├── funcs.py
|   |   ├── io
|   |   |   ├── __init__.py
|   |   |   ├── cosmology.py
|   |   |   ├── ecsv.py
|   |   |   ├── mapping.py
|   |   |   ├── model.py
|   |   |   ├── row.py
|   |   |   ├── table.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── test_cosmology.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_json.py
|   |   |   |   ├── test_mapping.py
|   |   |   |   ├── test_model.py
|   |   |   |   ├── test_row.py
|   |   |   |   ├── test_table.py
|   |   |   |   └── test_yaml.py
|   |   |   ├── utils.py
|   |   |   └── yaml.py
|   |   ├── parameter.py
|   |   ├── parameters.py
|   |   ├── realizations.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── conftest.py
|   |   |   ├── helper.py
|   |   |   ├── test_connect.py
|   |   |   ├── test_core.py
|   |   |   ├── test_cosmology.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_parameter.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_realizations.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   ├── units.py
|   |   └── utils.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── _strptime.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── jquery
|   |   |   ├── __init__.py
|   |   |   └── data
|   |   |       ├── css
|   |   |       ├── images
|   |   |       └── js
|   |   └── ply
|   |       ├── __init__.py
|   |       ├── cpp.py
|   |       ├── ctokens.py
|   |       ├── lex.py
|   |       ├── yacc.py
|   |       └── ygen.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── docs.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── mrt.py
|   |   |   ├── qdp.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── data
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_qdp.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_image_dask.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── conftest.py
|   |   |   |   ├── connect.py
|   |   |   |   ├── data
|   |   |   |   ├── deprecation.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── tags
|   |   |   |   ├── tests
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pandas
|   |   |   |   ├── __init__.py
|   |   |   |   └── connect.py
|   |   |   ├── parquet.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pandas.py
|   |   |   |   ├── test_parquet.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── compat.py
|   |   |   ├── core.py
|   |   |   ├── interface.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_registries.py
|   |   |       └── test_registry_help.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── mixin_columns.py
|   |   |   └── safeio.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   └── result.py
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── bounding_box.py
|   |   ├── convolution.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── math_functions.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── physical_models.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── spline.py
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── __init__.py
|   |   |   |   └── spec.txt
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_bounding_box.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_convolution.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_math_func.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_physical_models.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_spline.py
|   |   |   ├── test_statistics.py
|   |   |   ├── test_units_mapping.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── _testing.py
|   |   ├── bitmask.py
|   |   ├── blocks.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_bitmask.py
|   |   |   ├── test_blocks.py
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── bls
|   |   |   └── __init__.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   └── __init__.py
|   |   ├── setup_package.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   ├── src
|   |   |   ├── compute_bounds.c
|   |   |   ├── fast_sigma_clip.c
|   |   |   └── wirth_select.c
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── connect.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── dask.py
|   |   |   ├── registry.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_dask.py
|   |   |       └── test_registry.py
|   |   ├── ndarray_mixin.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── soco.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── runner.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   |   └── parse_times.c
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_custom_formats.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_fast_parser.py
|   |   |   ├── test_functions.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   ├── test_update_leap_seconds.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── timeseries
|   |   ├── __init__.py
|   |   ├── binned.py
|   |   ├── core.py
|   |   ├── downsample.py
|   |   ├── io
|   |   |   ├── __init__.py
|   |   |   ├── kepler.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_kepler.py
|   |   ├── periodograms
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── bls
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core.py
|   |   |   |   ├── methods.py
|   |   |   |   ├── setup_package.py
|   |   |   |   └── tests
|   |   |   └── lombscargle
|   |   |       ├── __init__.py
|   |   |       ├── _statistics.py
|   |   |       ├── core.py
|   |   |       ├── implementations
|   |   |       ├── tests
|   |   |       └── utils.py
|   |   ├── sampled.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       ├── test_binned.py
|   |       ├── test_common.py
|   |       ├── test_downsample.py
|   |       └── test_sampled.py
|   ├── uncertainty
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── distributions.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_distribution.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── _typing.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── misc.py
|   |   ├── photometric.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper
|   |   |   ├── __init__.py
|   |   |   ├── converters.py
|   |   |   ├── erfa.py
|   |   |   ├── function_helpers.py
|   |   |   ├── helpers.py
|   |   |   └── scipy_special.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── structured.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_aliases.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_photometric.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_annotations.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_helpers.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_typing.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   ├── test_structured.py
|   |   |   ├── test_structured_erfa_ufuncs.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpycompat.py
|   |   |   └── optional_deps.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── diff.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── update_builtin_iers.sh
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── data
|   |   |       ├── test_iers.py
|   |   |       └── test_leap_second.py
|   |   ├── introspection.py
|   |   ├── masked
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── function_helpers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_containers.py
|   |   |       ├── test_function_helpers.py
|   |   |       ├── test_functions.py
|   |   |       ├── test_masked.py
|   |   |       └── test_table.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── parsing.py
|   |   ├── setup_package.py
|   |   ├── shapes.py
|   |   ├── src
|   |   |   └── compiler.c
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── dataurl
|   |   |   |   ├── dataurl_mirror
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_diff.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_parsing.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_shapes.py
|   |   |   ├── test_state.py
|   |   |   └── test_xml.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── version.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   ├── test_time.py
|   |   |   └── test_units.py
|   |   ├── time.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_grid_paths.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   ├── test_utils.py
|   |       |   └── test_wcsapi.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       ├── utils.py
|   |       └── wcsapi.py
|   └── wcs
|       ├── __init__.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_auxprm_wrap.c
|       |   ├── wcslib_celprm_wrap.c
|       |   ├── wcslib_prjprm_wrap.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   ├── wcslib_wrap.c
|       |   └── wcslib_wtbarr_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── conftest.py
|       |   ├── data
|       |   |   ├── maps
|       |   |   ├── spectra
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   ├── validate.6.txt
|       |   |   ├── validate.7.4.txt
|       |   |   ├── validate.7.6.txt
|       |   |   └── validate.txt
|       |   ├── helper.py
|       |   ├── test_auxprm.py
|       |   ├── test_celprm.py
|       |   ├── test_pickle.py
|       |   ├── test_prjprm.py
|       |   ├── test_profiling.py
|       |   ├── test_tab.py
|       |   ├── test_tabprm.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   ├── test_wcsprm.py
|       |   └── test_wtbarr.py
|       ├── utils.py
|       ├── wcs.py
|       ├── wcsapi
|       |   ├── __init__.py
|       |   ├── conftest.py
|       |   ├── data
|       |   |   └── ucds.txt
|       |   ├── fitswcs.py
|       |   ├── high_level_api.py
|       |   ├── high_level_wcs_wrapper.py
|       |   ├── low_level_api.py
|       |   ├── sliced_low_level_wcs.py
|       |   ├── tests
|       |   |   ├── __init__.py
|       |   |   ├── test_fitswcs.py
|       |   |   ├── test_high_level_api.py
|       |   |   ├── test_high_level_wcs_wrapper.py
|       |   |   ├── test_low_level_api.py
|       |   |   └── test_utils.py
|       |   ├── utils.py
|       |   └── wrappers
|       |       ├── __init__.py
|       |       ├── base.py
|       |       ├── sliced_wcs.py
|       |       └── tests
|       └── wcslint.py
├── azure-pipelines.yml
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   ├── wcsutil.c
|   |   |   ├── zcompress.c
|   |   |   └── zuncompress.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       └── zutil.c
|   ├── expat
|   |   ├── README.md
|   |   ├── README.txt
|   |   └── lib
|   |       ├── xmlparse.c
|   |       ├── xmlrole.c
|   |       ├── xmltok.c
|   |       ├── xmltok_impl.c
|   |       └── xmltok_ns.c
|   ├── trim_cfitsio.sh
|   ├── trim_expat.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── codecov.yml
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── _templates
|   |   └── layout.html
|   ├── changelog.rst
|   ├── changes
|   |   ├── README.rst
|   |   ├── config
|   |   ├── constants
|   |   ├── convolution
|   |   ├── coordinates
|   |   ├── cosmology
|   |   |   ├── 12279.feature.rst
|   |   |   ├── 12313.feature.rst
|   |   |   ├── 12354.api.rst
|   |   |   ├── 12375.api.rst
|   |   |   ├── 12479.feature.rst
|   |   |   ├── 12590.feature.rst
|   |   |   ├── 12606.feature.rst
|   |   |   ├── 12612.api.rst
|   |   |   ├── 12624.api.rst
|   |   |   ├── 12710.feature.rst
|   |   |   ├── 12736.feature.rst
|   |   |   ├── 12740.feature.rst
|   |   |   ├── 12746.api.rst
|   |   |   └── 12966.feature.rst
|   |   ├── extern
|   |   ├── io.ascii
|   |   |   ├── 12631.bugfix.rst
|   |   |   └── 12841.api.rst
|   |   ├── io.fits
|   |   |   ├── 11843.feature.rst
|   |   |   └── 12258.api.rst
|   |   ├── io.misc
|   |   |   ├── 10198.feature.rst
|   |   |   ├── 12279.feature.rst
|   |   |   ├── 12895.feature.rst
|   |   |   ├── 12897.feature.rst
|   |   |   ├── 12903.api.rst
|   |   |   └── 12930.api.rst
|   |   ├── io.registry
|   |   ├── io.votable
|   |   ├── modeling
|   |   |   ├── 12384.feature.rst
|   |   |   ├── 12558.feature.rst
|   |   |   ├── 12585.api.rst
|   |   |   └── 12811.feature.rst
|   |   ├── nddata
|   |   ├── samp
|   |   ├── stats
|   |   ├── table
|   |   |   ├── 12631.api.rst
|   |   |   ├── 12637.api.rst
|   |   |   ├── 12637.feature.rst
|   |   |   ├── 12680.feature.rst
|   |   |   └── 12716.bugfix.rst
|   |   ├── template.rst
|   |   ├── tests
|   |   |   ├── 12633.api.1.rst
|   |   |   ├── 12633.api.2.rst
|   |   |   ├── 12633.api.3.rst
|   |   |   └── 12633.api.4.rst
|   |   ├── time
|   |   |   └── 12888.api.rst
|   |   ├── timeseries
|   |   ├── uncertainty
|   |   ├── units
|   |   |   ├── 12486.feature.rst
|   |   |   ├── 12566.feature.rst
|   |   |   ├── 12709.feature.rst
|   |   |   └── 12975.feature.rst
|   |   ├── utils
|   |   ├── visualization
|   |   └── wcs
|   |       └── 12514.feature.rst
|   ├── common_links.txt
|   ├── conf.py
|   ├── config
|   |   ├── astropy_config.rst
|   |   └── index.rst
|   ├── conftest.py
|   ├── constants
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   ├── performance.inc.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── common_errors.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── performance.inc.rst
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── satellites.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── spectralcoord.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   ├── dev.rst
|   |   ├── index.rst
|   |   ├── io.rst
|   |   └── units.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── style-guide.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   ├── when_to_rebase.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       └── virtual_pythons.rst
|   ├── getting_started.rst
|   ├── glossary.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── ecsv.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── asdf-schemas.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       ├── performance.inc.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── lts_policy.rst
|   ├── modeling
|   |   ├── add-units.rst
|   |   ├── compound-models.rst
|   |   ├── example-fitting-constraints.rst
|   |   ├── example-fitting-line.rst
|   |   ├── example-fitting-model-sets.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── jointfitter.rst
|   |   ├── models.rst
|   |   ├── new-fitter.rst
|   |   ├── new-model.rst
|   |   ├── parameters.rst
|   |   ├── performance.rst
|   |   ├── physical_models.rst
|   |   ├── polynomial_models.rst
|   |   ├── predef_models1D.rst
|   |   ├── predef_models2D.rst
|   |   ├── reference_api.rst
|   |   ├── spline_models.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── bitmask.rst
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── examples
|   |   |   └── cutout2d_tofits.py
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── performance.inc.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── robots.txt
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── performance.inc.rst
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── timeseries
|   |   ├── analysis.rst
|   |   ├── bls.rst
|   |   ├── data_access.rst
|   |   ├── index.rst
|   |   ├── initializing.rst
|   |   ├── io.rst
|   |   ├── lombscargle.rst
|   |   ├── masking.rst
|   |   ├── pandas.rst
|   |   └── times.rst
|   ├── uncertainty
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── constants_versions.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── performance.inc.rst
|   |   ├── physical_types.rst
|   |   ├── quantity.rst
|   |   ├── standard_units.rst
|   |   ├── structured_units.rst
|   |   └── type_hints.rst
|   ├── utils
|   |   ├── data.rst
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── masked
|   |       └── index.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── matplotlib_integration.rst
|   |   ├── normalization.rst
|   |   ├── performance.inc.rst
|   |   ├── rgb.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── generic_transforms.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── example_create_imaging.rst
|   |   ├── example_cube_wcs.rst
|   |   ├── examples
|   |   |   ├── cube_wcs.py
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── legacy_interface.rst
|   |   ├── loading_from_fits.rst
|   |   ├── note_sip.rst
|   |   ├── performance.inc.rst
|   |   ├── reference_api.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   ├── relax.rst
|   |   ├── supported_projections.rst
|   |   ├── validation.rst
|   |   ├── wcsapi.rst
|   |   └── wcstools.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       ├── 3.2.rst
|       ├── 4.0.rst
|       ├── 4.1.rst
|       ├── 4.2.rst
|       ├── 4.3.rst
|       ├── 5.0.rst
|       ├── 5.1.rst
|       └── index.rst
├── examples
|   ├── README.rst
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── PYTHON.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
└── setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: TimeSeries: misleading exception when required column check fails.

Description: <!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Patch information:
diff --git a/astropy/timeseries/core.py b/astropy/timeseries/core.py
index c279f35f87..ae81167cb5 100644
--- a/astropy/timeseries/core.py
+++ b/astropy/timeseries/core.py
@@ -61,24 +61,38 @@ class BaseTimeSeries(QTable):
 
         if self._required_columns is not None:
 
+            # Determine which required columns to enforce in this state
             if self._required_columns_relax:
                 required_columns = self._required_columns[:len(self.colnames)]
             else:
                 required_columns = self._required_columns
 
-            plural = 's' if len(required_columns) > 1 else ''
-
+            # If not relaxed and there are no columns at all, report all required first columns
             if not self._required_columns_relax and len(self.colnames) == 0:
 
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but time series has no columns"
-                                 .format(self.__class__.__name__, required_columns[0], plural))
-
-            elif self.colnames[:len(required_columns)] != required_columns:
-
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but found '{}'"
-                                 .format(self.__class__.__name__, required_columns[0], plural, self.colnames[0]))
+                raise ValueError("{} object is invalid - expected first column{} {} but time series has no columns"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns))
+
+            # Check for mismatches between the required first columns and the actual ones
+            actual_prefix = self.colnames[:len(required_columns)]
+            if actual_prefix != required_columns:
+                if not self._required_columns_relax:
+                    # If the actual columns form a correct prefix of the required columns,
+                    # then required columns are missing
+                    if self.colnames == self._required_columns[:len(self.colnames)] and len(self.colnames) < len(self._required_columns):
+                        missing = self._required_columns[len(self.colnames):]
+                        raise ValueError("{} object is invalid - missing required column{}: {}"
+                                         .format(self.__class__.__name__,
+                                                 's' if len(missing) > 1 else '',
+                                                 missing))
+                # Otherwise, report the expected vs. actual first columns for clarity
+                raise ValueError("{} object is invalid - expected first column{} {} but found {}"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns,
+                                         actual_prefix))
 
             if (self._required_columns_relax
                     and self._required_columns == self.colnames[:len(self._required_columns)]):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.
Extra Requirements: 
Purpose: I need the content of this test file to identify three relevant test cases that demonstrate functionality similar to the bug report, as requested by the user.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/timeseries/tests/test_sampled.py
Line number range: 1 - 420
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. from datetime import datetime
4. 
5. import pytest
6. 
7. from numpy.testing import assert_equal, assert_allclose
8. 
9. from astropy.table import Table, Column
10. from astropy.time import Time, TimeDelta
11. from astropy import units as u
12. from astropy.units import Quantity
13. from astropy.utils.data import get_pkg_data_filename
14. from astropy.tests.helper import assert_quantity_allclose
15. 
16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
17. from astropy.timeseries.sampled import TimeSeries
18. 
19. INPUT_TIME = Time(['2016-03-22T12:30:31',
20.                    '2015-01-21T12:30:32',
21.                    '2016-03-22T12:30:40'])
22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=['a', 'b', 'c'])
23. 
24. CSV_FILE = get_pkg_data_filename('data/sampled.csv')
25. 
26. 
27. def test_empty_initialization():
28.     ts = TimeSeries()
29.     ts['time'] = Time([50001, 50002, 50003], format='mjd')
30. 
31. 
32. def test_empty_initialization_invalid():
33.     # Make sure things crash when the first column added is not a time column
34.     ts = TimeSeries()
35.     with pytest.raises(ValueError) as exc:
36.         ts['flux'] = [1, 2, 3]
37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
38.                                  "'time' as the first column but found 'flux'")
39. 
40. 
41. def test_initialize_only_time():
42.     ts = TimeSeries(time=INPUT_TIME)
43.     assert ts['time'] is ts.time
44.     # NOTE: the object in the table is a copy
45.     assert_equal(ts.time.isot, INPUT_TIME.isot)
46. 
47. 
48. def test_initialization_with_data():
49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
50.     assert_equal(ts.time.isot, INPUT_TIME.isot)
51.     assert_equal(ts['a'], [10, 2, 3])
52.     assert_equal(ts['b'], [4, 5, 6])
53. 
54. 
55. def test_initialize_only_data():
56.     with pytest.raises(TypeError) as exc:
57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
58.     assert exc.value.args[0] == "Either 'time' or 'time_start' should be specified"
59. 
60. 
61. def test_initialization_with_table():
62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)
63.     assert ts.colnames == ['time', 'a', 'b', 'c']
64. 
65. 
66. def test_initialization_with_time_delta():
67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
68.                     time_delta=TimeDelta(3, format='sec'),
69.                     data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
70.     assert_equal(ts.time.isot, ['2018-07-01T10:10:10.000',
71.                                 '2018-07-01T10:10:13.000',
72.                                 '2018-07-01T10:10:16.000'])
73. 
74. 
75. def test_initialization_missing_time_delta():
76.     with pytest.raises(TypeError) as exc:
77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
78.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
79.     assert exc.value.args[0] == "'time' is scalar, so 'time_delta' is required"
80. 
81. 
82. def test_initialization_invalid_time_and_time_start():
83.     with pytest.raises(TypeError) as exc:
84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),
85.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
86.     assert exc.value.args[0] == "Cannot specify both 'time' and 'time_start'"
87. 
88. 
89. def test_initialization_invalid_time_delta():
90.     with pytest.raises(TypeError) as exc:
91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
92.                    time_delta=[1, 4, 3],
93.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
94.     assert exc.value.args[0] == "'time_delta' should be a Quantity or a TimeDelta"
95. 
96. 
97. def test_initialization_with_time_in_data():
98. 
99.     data = PLAIN_TABLE.copy()
100.     data['time'] = INPUT_TIME
101. 
102.     ts1 = TimeSeries(data=data)
103. 
104.     assert set(ts1.colnames) == set(['time', 'a', 'b', 'c'])
105.     assert all(ts1.time == INPUT_TIME)
106. 
107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
108.     assert set(ts2.colnames) == set(['time', 'a'])
109.     assert all(ts2.time == INPUT_TIME)
110. 
111.     with pytest.raises(TypeError) as exc:
112.         # Don't allow ambiguous cases of passing multiple 'time' columns
113.         TimeSeries(data=data, time=INPUT_TIME)
114.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
115. 
116.     with pytest.raises(TypeError) as exc:
117.         # 'time' is a protected name, don't allow ambiguous cases
118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
119.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
120. 
121. 
122. def test_initialization_n_samples():
123. 
124.     # Make sure things crash with incorrect n_samples
125. 
126.     with pytest.raises(TypeError) as exc:
127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)
128.     assert exc.value.args[0] == ("'n_samples' has been given both and it is not the "
129.                                  "same length as the input data.")
130. 
131. 
132. def test_initialization_length_mismatch():
133.     with pytest.raises(ValueError) as exc:
134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=['a', 'b'])
135.     assert exc.value.args[0] == "Length of 'time' (3) should match data length (2)"
136. 
137. 
138. def test_initialization_invalid_both_time_and_time_delta():
139.     with pytest.raises(TypeError) as exc:
140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format='sec'))
141.     assert exc.value.args[0] == ("'time_delta' should not be specified since "
142.                                  "'time' is an array")
143. 
144. 
145. def test_fold():
146. 
147.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
148. 
149.     ts = TimeSeries(time=times)
150.     ts['flux'] = [1, 4, 4, 3, 2, 3]
151. 
152.     # Try without epoch time, as it should default to the first time and
153.     # wrapping at half the period.
154.     tsf = ts.fold(period=3.2 * u.s)
155.     assert isinstance(tsf.time, TimeDelta)
156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)
157. 
158.     # Try with epoch time
159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'))
160.     assert isinstance(tsf.time, TimeDelta)
161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)
162. 
163.     # Now with wrap_phase set to the full period
164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)
165.     assert isinstance(tsf.time, TimeDelta)
166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)
167. 
168.     # Now set epoch_phase to be 1/4 of the way through the phase
169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)
170.     assert isinstance(tsf.time, TimeDelta)
171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)
172. 
173.     # And combining epoch_phase and wrap_phase
174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)
175.     assert isinstance(tsf.time, TimeDelta)
176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)
177. 
178.     # Now repeat the above tests but with normalization applied
179. 
180.     # Try without epoch time, as it should default to the first time and
181.     # wrapping at half the period.
182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)
183.     assert isinstance(tsf.time, Quantity)
184.     assert_allclose(tsf.time.to_value(u.one),
185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],
186.                     rtol=1e-6)
187. 
188.     # Try with epoch time
189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'),
190.                   normalize_phase=True)
191.     assert isinstance(tsf.time, Quantity)
192.     assert_allclose(tsf.time.to_value(u.one),
193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],
194.                     rtol=1e-6, atol=1e-6)
195. 
196.     # Now with wrap_phase set to the full period
197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)
198.     assert isinstance(tsf.time, Quantity)
199.     assert_allclose(tsf.time.to_value(u.one),
200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],
201.                     rtol=1e-6)
202. 
203.     # Now set epoch_phase to be 1/4 of the way through the phase
204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)
205.     assert isinstance(tsf.time, Quantity)
206.     assert_allclose(tsf.time.to_value(u.one),
207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],
208.                     rtol=1e-6)
209. 
210.     # And combining epoch_phase and wrap_phase
211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,
212.                   normalize_phase=True)
213.     assert isinstance(tsf.time, Quantity)
214.     assert_allclose(tsf.time.to_value(u.one),
215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],
216.                     rtol=1e-6)
217. 
218. 
219. def test_fold_invalid_options():
220. 
221.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
222. 
223.     ts = TimeSeries(time=times)
224.     ts['flux'] = [1, 4, 4, 3, 2, 3]
225. 
226.     with pytest.raises(u.UnitsError,
227.                        match='period should be a Quantity in units of time'):
228.         ts.fold(period=3.2)
229. 
230.     with pytest.raises(u.UnitsError,
231.                        match='period should be a Quantity in units of time'):
232.         ts.fold(period=3.2 * u.m)
233. 
234.     with pytest.raises(u.UnitsError,
235.                        match='epoch_phase should be a Quantity in units of '
236.                              'time when normalize_phase=False'):
237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)
238. 
239.     with pytest.raises(u.UnitsError,
240.                        match='epoch_phase should be a dimensionless Quantity '
241.                              'or a float when normalize_phase=True'):
242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)
243. 
244.     with pytest.raises(u.UnitsError,
245.                        match='wrap_phase should be a Quantity in units of '
246.                              'time when normalize_phase=False'):
247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)
248. 
249.     with pytest.raises(u.UnitsError,
250.                        match='wrap_phase should be dimensionless when '
251.                              'normalize_phase=True'):
252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)
253. 
254.     with pytest.raises(ValueError,
255.                        match='wrap_phase should be between 0 and the period'):
256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)
257. 
258.     with pytest.raises(ValueError,
259.                        match='wrap_phase should be between 0 and the period'):
260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)
261. 
262.     with pytest.raises(ValueError,
263.                        match='wrap_phase should be between 0 and 1'):
264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)
265. 
266.     with pytest.raises(ValueError,
267.                        match='wrap_phase should be between 0 and 1'):
268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)
269. 
270. 
271. def test_pandas():
272.     pandas = pytest.importorskip("pandas")
273. 
274.     df1 = pandas.DataFrame()
275.     df1['a'] = [1, 2, 3]
276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)
277. 
278.     ts = TimeSeries.from_pandas(df1)
279.     assert_equal(ts.time.isot, INPUT_TIME.isot)
280.     assert ts.colnames == ['time', 'a']
281.     assert len(ts.indices) == 1
282.     assert (ts.indices['time'].columns[0] == INPUT_TIME).all()
283. 
284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale='tcb')
285.     assert ts_tcb.time.scale == 'tcb'
286. 
287.     df2 = ts.to_pandas()
288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()
289.     assert df2.columns == pandas.Index(['a'])
290.     assert (df1['a'] == df2['a']).all()
291. 
292.     with pytest.raises(TypeError) as exc:
293.         TimeSeries.from_pandas(None)
294.     assert exc.value.args[0] == 'Input should be a pandas DataFrame'
295. 
296.     df4 = pandas.DataFrame()
297.     df4['a'] = [1, 2, 3]
298. 
299.     with pytest.raises(TypeError) as exc:
300.         TimeSeries.from_pandas(df4)
301.     assert exc.value.args[0] == 'DataFrame does not have a DatetimeIndex'
302. 
303. 
304. def test_read_time_missing():
305.     with pytest.raises(ValueError) as exc:
306.         TimeSeries.read(CSV_FILE, format='csv')
307.     assert exc.value.args[0] == '``time_column`` should be provided since the default Table readers are being used.'
308. 
309. 
310. def test_read_time_wrong():
311.     with pytest.raises(ValueError) as exc:
312.         TimeSeries.read(CSV_FILE, time_column='abc', format='csv')
313.     assert exc.value.args[0] == "Time column 'abc' not found in the input data."
314. 
315. 
316. def test_read():
317.     timeseries = TimeSeries.read(CSV_FILE, time_column='Date', format='csv')
318.     assert timeseries.colnames == ['time', 'A', 'B', 'C', 'D', 'E', 'F', 'G']
319.     assert len(timeseries) == 11
320.     assert timeseries['time'].format == 'iso'
321.     assert timeseries['A'].sum() == 266.5
322. 
323. 
324. @pytest.mark.remote_data(source='astropy')
325. def test_kepler_astropy():
326.     from astropy.units import UnitsWarning
327. 
328.     filename = get_pkg_data_filename('timeseries/kplr010666592-2009131110544_slc.fits')
329. 
330.     with pytest.warns(UnitsWarning):
331.         timeseries = TimeSeries.read(filename, format='kepler.fits')
332. 
333.     assert timeseries["time"].format == 'isot'
334.     assert timeseries["time"].scale == 'tdb'
335.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
336.     assert len(timeseries) == 14280
337.     assert len(timeseries.columns) == 20
338. 
339. 
340. @pytest.mark.remote_data(source='astropy')
341. def test_tess_astropy():
342.     filename = get_pkg_data_filename('timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits')
343.     with pytest.warns(UserWarning, match='Ignoring 815 rows with NaN times'):
344.         timeseries = TimeSeries.read(filename, format='tess.fits')
345.     assert timeseries["time"].format == 'isot'
346.     assert timeseries["time"].scale == 'tdb'
347.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
348.     assert len(timeseries) == 19261
349.     assert len(timeseries.columns) == 20
350. 
351. 
352. def test_required_columns():
353. 
354.     # Test the machinery that makes sure that the required columns are present
355. 
356.     ts = TimeSeries(time=INPUT_TIME,
357.                     data=[[10, 2, 3], [4, 5, 6]],
358.                     names=['a', 'b'])
359. 
360.     # In the examples below, the operation (e.g. remove_column) is actually
361.     # carried out before the checks are made, so we need to use copy() so that
362.     # we don't change the main version of the time series.
363. 
364.     # Make sure copy works fine
365.     ts.copy()
366. 
367.     with pytest.raises(ValueError) as exc:
368.         ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
370.                                  "'time' as the first column but found 'c'")
371. 
372.     with pytest.raises(ValueError) as exc:
373.         ts.copy().add_columns([Column([3, 4, 5], name='d'),
374.                                Column([3, 4, 5], name='e')], indexes=[0, 1])
375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
376.                                  "'time' as the first column but found 'd'")
377. 
378.     with pytest.raises(ValueError) as exc:
379.         ts.copy().keep_columns(['a', 'b'])
380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
381.                                  "'time' as the first column but found 'a'")
382. 
383.     with pytest.raises(ValueError) as exc:
384.         ts.copy().remove_column('time')
385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
386.                                  "'time' as the first column but found 'a'")
387. 
388.     with pytest.raises(ValueError) as exc:
389.         ts.copy().remove_columns(['time', 'a'])
390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
391.                                  "'time' as the first column but found 'b'")
392. 
393.     with pytest.raises(ValueError) as exc:
394.         ts.copy().rename_column('time', 'banana')
395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
396.                                  "'time' as the first column but found 'banana'")
397. 
398. 
399. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
400. def test_periodogram(cls):
401. 
402.     # Note that we don't need to check the actual results from the periodogram
403.     # classes here since these are tested extensively in
404.     # astropy.timeseries.periodograms.
405. 
406.     ts = TimeSeries(time=INPUT_TIME,
407.                     data=[[10, 2, 3], [4, 5, 6]],
408.                     names=['a', 'b'])
409. 
410.     p1 = cls.from_timeseries(ts, 'a')
411.     assert isinstance(p1, cls)
412.     assert_allclose(p1.t.jd, ts.time.jd)
413.     assert_equal(p1.y, ts['a'])
414.     assert p1.dy is None
415. 
416.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
417.     assert_quantity_allclose(p2.dy, ts['b'])
418. 
419.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
420.     assert_allclose(p3.dy, 0.1)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:48:09,773 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find three relevant test cases for a bug involving misleading exceptions when required columns are removed from a `TimeSeries` object. I have analyzed the provided test file `astropy/timeseries/tests/test_sampled.py`. While it contains tests for required columns, they only cover the simple case of a single required column ('time'). The bug report, and the provided patch, specifically deal with a scenario involving multiple required columns. To find more relevant test cases that cover this complexity, I need to investigate tests for related classes that might use multiple required columns. The `BinnedTimeSeries` class is a good candidate for this. Therefore, I need to examine its test file." query='Please provide the full content of the file `astropy/timeseries/tests/test_binned.py`.' extra_requirements='' purpose='I need to find test cases that deal with multiple required columns to provide the user with the most relevant examples related to the bug they reported.'
2025-12-21 08:48:09,775 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/timeseries/tests/test_binned.py`.
2025-12-21 08:48:09,775 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:48:09,775 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:48:09,776 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:48:09,776 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/timeseries/tests/test_binned.py`.
Purpose: I need to find test cases that deal with multiple required columns to provide the user with the most relevant examples related to the bug they reported.
2025-12-21 08:48:12,224 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of `astropy/timeseries/tests/test_binned.py`. This will allow me to examine the test cases within the file and identify those that are relevant to the user's bug report, specifically focusing on scenarios that involve multiple required columns." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/timeseries/tests/test_binned.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2127, 'candidates_token_count': 87, 'total_token_count': 2320, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2127}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 106, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.06604180938896091, 'model_name': 'gemini-2.5-pro'} id='run--4052c73b-2019-42f9-b373-4964aabb6d22-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/tests/test_binned.py'}, 'id': '8582c6a0-ac1c-44e2-9f0a-0a3a34e1f522', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2127, 'output_tokens': 87, 'total_tokens': 2320, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 106}}
2025-12-21 08:48:25,451 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `astropy/timeseries/tests/test_binned.py`. After analyzing its contents, I have identified several test cases that deal with the initialization and reading of `BinnedTimeSeries` objects, which involve multiple required columns. These examples should be helpful in understanding how to handle scenarios with multiple column requirements.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8812, 'candidates_token_count': 73, 'total_token_count': 10349, 'cached_content_token_count': 1825, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8812}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1825}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 73}], 'thoughts_token_count': 1464}, 'finish_reason': 'STOP', 'avg_logprobs': -1.116089494261023, 'model_name': 'gemini-2.5-pro'} id='run--1db72dc9-54c8-4a91-a144-3ad120b0e072-0' usage_metadata={'input_tokens': 8812, 'output_tokens': 73, 'total_tokens': 10349, 'input_token_details': {'cache_read': 1825}, 'output_token_details': {'reasoning': 1464}}
2025-12-21 08:48:25,452 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/timeseries/tests/test_binned.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find test cases that deal with multiple required columns to provide the user with the most relevant examples related to the bug they reported.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/timeseries/tests/test_binned.py
Line number range: 1 - 317
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import pytest
4. from numpy.testing import assert_equal, assert_allclose
5. 
6. from astropy import units as u
7. from astropy.time import Time, TimeDelta
8. from astropy.utils.data import get_pkg_data_filename
9. 
10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
11. from astropy.timeseries.binned import BinnedTimeSeries
12. from astropy.tests.helper import assert_quantity_allclose
13. 
14. 
15. CSV_FILE = get_pkg_data_filename('data/binned.csv')
16. 
17. 
18. def test_empty_initialization():
19.     ts = BinnedTimeSeries()
20.     ts['time_bin_start'] = Time([1, 2, 3], format='mjd')
21. 
22. 
23. def test_empty_initialization_invalid():
24. 
25.     # Make sure things crash when the first column added is not a time column
26. 
27.     ts = BinnedTimeSeries()
28.     with pytest.raises(ValueError) as exc:
29.         ts['flux'] = [1, 2, 3]
30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "
31.                                  "'time_bin_start' as the first column but found 'flux'")
32. 
33. 
34. def test_initialization_time_bin_invalid():
35. 
36.     # Make sure things crash when time_bin_* is passed incorrectly.
37. 
38.     with pytest.raises(TypeError) as exc:
39.         BinnedTimeSeries(data=[[1, 4, 3]])
40.     assert exc.value.args[0] == ("'time_bin_start' has not been specified")
41. 
42.     with pytest.raises(TypeError) as exc:
43.         BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31', data=[[1, 4, 3]])
44.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
45. 
46. 
47. def test_initialization_time_bin_both():
48. 
49.     # Make sure things crash when time_bin_* is passed twice.
50. 
51.     with pytest.raises(TypeError) as exc:
52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},
53.                          time_bin_start="2016-03-22T12:30:31")
54.     assert exc.value.args[0] == ("'time_bin_start' has been given both in the table "
55.                                  "and as a keyword argument")
56. 
57.     with pytest.raises(TypeError) as exc:
58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},
59.                          time_bin_size=[1]*u.s)
60.     assert exc.value.args[0] == ("'time_bin_size' has been given both in the table "
61.                                  "and as a keyword argument")
62. 
63. 
64. def test_initialization_time_bin_size():
65. 
66.     # Make sure things crash when time_bin_size has no units
67. 
68.     with pytest.raises(TypeError) as exc:
69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
70.                          time_bin_start="2016-03-22T12:30:31",
71.                          time_bin_size=1)
72.     assert exc.value.args[0] == ("'time_bin_size' should be a Quantity or a TimeDelta")
73. 
74.     # TimeDelta for time_bin_size
75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
76.                           time_bin_start="2016-03-22T12:30:31",
77.                           time_bin_size=TimeDelta(1, format="jd"))
78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)
79. 
80. 
81. def test_initialization_time_bin_start_scalar():
82. 
83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size
84. 
85.     with pytest.raises(TypeError) as exc:
86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
87.                          time_bin_start=Time(1, format='mjd'),
88.                          time_bin_end=Time(1, format='mjd'))
89.     assert exc.value.args[0] == ("'time_bin_start' is scalar, so 'time_bin_size' is required")
90. 
91. 
92. def test_initialization_n_bins_invalid_arguments():
93. 
94.     # Make sure an exception is raised when n_bins is passed as an argument while
95.     # any of the parameters 'time_bin_start' or 'time_bin_end' is not scalar.
96. 
97.     with pytest.raises(TypeError) as exc:
98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format='cxcsec'),
99.                          time_bin_size=1*u.s,
100.                          n_bins=10)
101.     assert exc.value.args[0] == ("'n_bins' cannot be specified if 'time_bin_start' or "
102.                                  "'time_bin_size' are not scalar'")
103. 
104. 
105. def test_initialization_n_bins():
106. 
107.     # Make sure things crash with incorrect n_bins
108. 
109.     with pytest.raises(TypeError) as exc:
110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
111.                          time_bin_start=Time(1, format='mjd'),
112.                          time_bin_size=1*u.s,
113.                          time_bin_end=Time(1, format='mjd'),
114.                          n_bins=10)
115.     assert exc.value.args[0] == ("'n_bins' has been given and it is not the "
116.                                  "same length as the input data.")
117. 
118. 
119. def test_initialization_non_scalar_time():
120. 
121.     # Make sure things crash with incorrect size of time_bin_start
122. 
123.     with pytest.raises(ValueError) as exc:
124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],
126.                          time_bin_size=1*u.s,
127.                          time_bin_end=Time(1, format='mjd'))
128.     assert exc.value.args[0] == ("Length of 'time_bin_start' (2) should match table length (1)")
129. 
130.     with pytest.raises(TypeError) as exc:
131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
132.                          time_bin_start=["2016-03-22T12:30:31"],
133.                          time_bin_size=None,
134.                          time_bin_end=None)
135.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
136. 
137. 
138. def test_even_contiguous():
139. 
140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying
141.     # the bin width:
142. 
143.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])
145. 
146.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
147.                                           '2016-03-22T12:30:34.000',
148.                                           '2016-03-22T12:30:37.000'])
149. 
150.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:32.500',
151.                                            '2016-03-22T12:30:35.500',
152.                                            '2016-03-22T12:30:38.500'])
153. 
154.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:34.000',
155.                                         '2016-03-22T12:30:37.000',
156.                                         '2016-03-22T12:30:40.000'])
157. 
158. 
159. def test_uneven_contiguous():
160. 
161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an
162.     # end time:
163. 
164.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
165.                                           '2016-03-22T12:30:32',
166.                                           '2016-03-22T12:30:40'],
167.                           time_bin_end='2016-03-22T12:30:55',
168.                           data=[[1, 4, 3]])
169. 
170.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
171.                                           '2016-03-22T12:30:32.000',
172.                                           '2016-03-22T12:30:40.000'])
173. 
174.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
175.                                            '2016-03-22T12:30:36.000',
176.                                            '2016-03-22T12:30:47.500'])
177. 
178.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
179.                                         '2016-03-22T12:30:40.000',
180.                                         '2016-03-22T12:30:55.000'])
181. 
182. 
183. def test_uneven_non_contiguous():
184. 
185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with
186.     # lists of start times, bin sizes and data:
187. 
188.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
189.                                           '2016-03-22T12:30:38',
190.                                           '2016-03-22T12:34:40'],
191.                           time_bin_size=[5, 100, 2]*u.s,
192.                           data=[[1, 4, 3]])
193. 
194.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
195.                                           '2016-03-22T12:30:38.000',
196.                                           '2016-03-22T12:34:40.000'])
197. 
198.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:33.500',
199.                                            '2016-03-22T12:31:28.000',
200.                                            '2016-03-22T12:34:41.000'])
201. 
202.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:36.000',
203.                                         '2016-03-22T12:32:18.000',
204.                                         '2016-03-22T12:34:42.000'])
205. 
206. 
207. def test_uneven_non_contiguous_full():
208. 
209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by
210.     # specifying the start and end times for the bins:
211. 
212.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
213.                                           '2016-03-22T12:30:33',
214.                                           '2016-03-22T12:30:40'],
215.                           time_bin_end=['2016-03-22T12:30:32',
216.                                         '2016-03-22T12:30:35',
217.                                         '2016-03-22T12:30:41'],
218.                           data=[[1, 4, 3]])
219. 
220.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
221.                                           '2016-03-22T12:30:33.000',
222.                                           '2016-03-22T12:30:40.000'])
223. 
224.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
225.                                            '2016-03-22T12:30:34.000',
226.                                            '2016-03-22T12:30:40.500'])
227. 
228.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
229.                                         '2016-03-22T12:30:35.000',
230.                                         '2016-03-22T12:30:41.000'])
231. 
232. 
233. def test_read_empty():
234.     with pytest.raises(ValueError) as exc:
235.         BinnedTimeSeries.read(CSV_FILE, format='csv')
236.     assert exc.value.args[0] == '``time_bin_start_column`` should be provided since the default Table readers are being used.'
237. 
238. 
239. def test_read_no_size_end():
240.     with pytest.raises(ValueError) as exc:
241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', format='csv')
242.     assert exc.value.args[0] == 'Either `time_bin_end_column` or `time_bin_size_column` should be provided.'
243. 
244. 
245. def test_read_both_extra_bins():
246.     with pytest.raises(ValueError) as exc:
247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column='END', time_bin_size_column='bin_size', format='csv')
248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."
249. 
250. 
251. def test_read_size_no_unit():
252.     with pytest.raises(ValueError) as exc:
253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column='bin_size', format='csv')
254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
255. 
256. 
257. def test_read_start_time_missing():
258.     with pytest.raises(ValueError) as exc:
259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='abc', time_bin_size_column='bin_size', time_bin_size_unit=u.second, format='csv')
260.     assert exc.value.args[0] == "Bin start time column 'abc' not found in the input data."
261. 
262. 
263. def test_read_end_time_missing():
264.     with pytest.raises(ValueError) as exc:
265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column="missing", format='csv')
266.     assert exc.value.args[0] == "Bin end time column 'missing' not found in the input data."
267. 
268. 
269. def test_read_size_missing():
270.     with pytest.raises(ValueError) as exc:
271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="missing", time_bin_size_unit=u.second, format='csv')
272.     assert exc.value.args[0] == "Bin size column 'missing' not found in the input data."
273. 
274. 
275. def test_read_time_unit_missing():
276.     with pytest.raises(ValueError) as exc:
277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="bin_size", format='csv')
278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
279. 
280. 
281. def test_read():
282. 
283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
284.                                        time_bin_end_column='time_end', format='csv')
285.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'bin_size', 'A', 'B', 'C', 'D', 'E', 'F']
286.     assert len(timeseries) == 10
287.     assert timeseries['B'].sum() == 1151.54
288. 
289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
290.                                        time_bin_size_column='bin_size',
291.                                        time_bin_size_unit=u.second, format='csv')
292.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'time_end', 'A', 'B', 'C', 'D', 'E', 'F']
293.     assert len(timeseries) == 10
294.     assert timeseries['B'].sum() == 1151.54
295. 
296. 
297. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
298. def test_periodogram(cls):
299. 
300.     # Note that we don't need to check the actual results from the periodogram
301.     # classes here since these are tested extensively in
302.     # astropy.timeseries.periodograms.
303. 
304.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=['a', 'b'])
306. 
307.     p1 = cls.from_timeseries(ts, 'a')
308.     assert isinstance(p1, cls)
309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)
310.     assert_equal(p1.y, ts['a'])
311.     assert p1.dy is None
312. 
313.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
314.     assert_quantity_allclose(p2.dy, ts['b'])
315. 
316.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
317.     assert_allclose(p3.dy, 0.1)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:48:29,397 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file `astropy/timeseries/tests/test_binned.py`. The provided context contains the entire content of this file, so I am selecting the whole file to fulfill the user's request.", relative_path='astropy/timeseries/tests/test_binned.py', start_line=1, end_line=317)]
2025-12-21 08:48:29,398 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/timeseries/tests/test_binned.py`.
2025-12-21 08:48:29,398 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:48:29,398 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:48:29,399 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-21 08:48:29,399 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 08:48:29,399 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── labeler.yml
|   └── workflows
|       ├── cancel_workflows.yml
|       ├── check_changelog.yml
|       ├── ci_cron_daily.yml
|       ├── ci_cron_weekly.yml
|       ├── ci_workflows.yml
|       ├── codeql-analysis.yml
|       ├── open_actions.yml
|       ├── stalebot.yml
|       └── update_iers.yml
├── .pep8speaks.yml
├── .pre-commit-config.yaml
├── .pyinstaller
|   ├── hooks
|   |   └── hook-skyfield.py
|   └── run_astropy_tests.py
├── .readthedocs.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── GOVERNANCE.md
├── LICENSE.rst
├── README.rst
├── astropy
|   ├── __init__.py
|   ├── _dev
|   |   ├── __init__.py
|   |   └── scm_version.py
|   ├── _erfa
|   |   └── __init__.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── astropyconst40.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── codata2018.py
|   |   ├── config.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_prior_version.py
|   |   |   └── test_sciencestate.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   |   └── convolve.c
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_formats.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── equatorial.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hadec.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── icrs_observed_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── erfa_astrom.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── jparser.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── sky_coordinate_parsers.py
|   |   ├── solar_system.py
|   |   ├── spectral_coordinate.py
|   |   ├── spectral_quantity.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── generate_spectralcoord_ref.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── helper.py
|   |   |   ├── test_angle_generators.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_erfa_astrom.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_geodetic_representations.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_icrs_observed_transformations.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_spectral_coordinate.py
|   |   |   ├── test_spectral_quantity.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_utils.py
|   |   |   └── test_velocity_corrs.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── connect.py
|   |   ├── core.py
|   |   ├── data
|   |   ├── flrw
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── lambdacdm.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── conftest.py
|   |   |   |   ├── test_base.py
|   |   |   |   ├── test_lambdacdm.py
|   |   |   |   ├── test_w0cdm.py
|   |   |   |   ├── test_w0wacdm.py
|   |   |   |   ├── test_w0wzcdm.py
|   |   |   |   └── test_wpwazpcdm.py
|   |   |   ├── w0cdm.py
|   |   |   ├── w0wacdm.py
|   |   |   ├── w0wzcdm.py
|   |   |   └── wpwazpcdm.py
|   |   ├── funcs.py
|   |   ├── io
|   |   |   ├── __init__.py
|   |   |   ├── cosmology.py
|   |   |   ├── ecsv.py
|   |   |   ├── mapping.py
|   |   |   ├── model.py
|   |   |   ├── row.py
|   |   |   ├── table.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── test_cosmology.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_json.py
|   |   |   |   ├── test_mapping.py
|   |   |   |   ├── test_model.py
|   |   |   |   ├── test_row.py
|   |   |   |   ├── test_table.py
|   |   |   |   └── test_yaml.py
|   |   |   ├── utils.py
|   |   |   └── yaml.py
|   |   ├── parameter.py
|   |   ├── parameters.py
|   |   ├── realizations.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── conftest.py
|   |   |   ├── helper.py
|   |   |   ├── test_connect.py
|   |   |   ├── test_core.py
|   |   |   ├── test_cosmology.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_parameter.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_realizations.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   ├── units.py
|   |   └── utils.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── _strptime.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── jquery
|   |   |   ├── __init__.py
|   |   |   └── data
|   |   |       ├── css
|   |   |       ├── images
|   |   |       └── js
|   |   └── ply
|   |       ├── __init__.py
|   |       ├── cpp.py
|   |       ├── ctokens.py
|   |       ├── lex.py
|   |       ├── yacc.py
|   |       └── ygen.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── docs.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── mrt.py
|   |   |   ├── qdp.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── data
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_qdp.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_image_dask.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── conftest.py
|   |   |   |   ├── connect.py
|   |   |   |   ├── data
|   |   |   |   ├── deprecation.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── tags
|   |   |   |   ├── tests
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pandas
|   |   |   |   ├── __init__.py
|   |   |   |   └── connect.py
|   |   |   ├── parquet.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pandas.py
|   |   |   |   ├── test_parquet.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── compat.py
|   |   |   ├── core.py
|   |   |   ├── interface.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_registries.py
|   |   |       └── test_registry_help.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── mixin_columns.py
|   |   |   └── safeio.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   └── result.py
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── bounding_box.py
|   |   ├── convolution.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── math_functions.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── physical_models.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── spline.py
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── __init__.py
|   |   |   |   └── spec.txt
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_bounding_box.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_convolution.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_math_func.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_physical_models.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_spline.py
|   |   |   ├── test_statistics.py
|   |   |   ├── test_units_mapping.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── _testing.py
|   |   ├── bitmask.py
|   |   ├── blocks.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_bitmask.py
|   |   |   ├── test_blocks.py
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── bls
|   |   |   └── __init__.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   └── __init__.py
|   |   ├── setup_package.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   ├── src
|   |   |   ├── compute_bounds.c
|   |   |   ├── fast_sigma_clip.c
|   |   |   └── wirth_select.c
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── connect.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── dask.py
|   |   |   ├── registry.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_dask.py
|   |   |       └── test_registry.py
|   |   ├── ndarray_mixin.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── soco.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── runner.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   |   └── parse_times.c
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_custom_formats.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_fast_parser.py
|   |   |   ├── test_functions.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   ├── test_update_leap_seconds.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── timeseries
|   |   ├── __init__.py
|   |   ├── binned.py
|   |   ├── core.py
|   |   ├── downsample.py
|   |   ├── io
|   |   |   ├── __init__.py
|   |   |   ├── kepler.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_kepler.py
|   |   ├── periodograms
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── bls
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core.py
|   |   |   |   ├── methods.py
|   |   |   |   ├── setup_package.py
|   |   |   |   └── tests
|   |   |   └── lombscargle
|   |   |       ├── __init__.py
|   |   |       ├── _statistics.py
|   |   |       ├── core.py
|   |   |       ├── implementations
|   |   |       ├── tests
|   |   |       └── utils.py
|   |   ├── sampled.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       ├── test_binned.py
|   |       ├── test_common.py
|   |       ├── test_downsample.py
|   |       └── test_sampled.py
|   ├── uncertainty
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── distributions.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_distribution.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── _typing.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── misc.py
|   |   ├── photometric.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper
|   |   |   ├── __init__.py
|   |   |   ├── converters.py
|   |   |   ├── erfa.py
|   |   |   ├── function_helpers.py
|   |   |   ├── helpers.py
|   |   |   └── scipy_special.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── structured.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_aliases.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_photometric.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_annotations.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_helpers.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_typing.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   ├── test_structured.py
|   |   |   ├── test_structured_erfa_ufuncs.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpycompat.py
|   |   |   └── optional_deps.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── diff.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── update_builtin_iers.sh
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── data
|   |   |       ├── test_iers.py
|   |   |       └── test_leap_second.py
|   |   ├── introspection.py
|   |   ├── masked
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── function_helpers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_containers.py
|   |   |       ├── test_function_helpers.py
|   |   |       ├── test_functions.py
|   |   |       ├── test_masked.py
|   |   |       └── test_table.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── parsing.py
|   |   ├── setup_package.py
|   |   ├── shapes.py
|   |   ├── src
|   |   |   └── compiler.c
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── dataurl
|   |   |   |   ├── dataurl_mirror
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_diff.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_parsing.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_shapes.py
|   |   |   ├── test_state.py
|   |   |   └── test_xml.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── version.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   ├── test_time.py
|   |   |   └── test_units.py
|   |   ├── time.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_grid_paths.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   ├── test_utils.py
|   |       |   └── test_wcsapi.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       ├── utils.py
|   |       └── wcsapi.py
|   └── wcs
|       ├── __init__.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_auxprm_wrap.c
|       |   ├── wcslib_celprm_wrap.c
|       |   ├── wcslib_prjprm_wrap.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   ├── wcslib_wrap.c
|       |   └── wcslib_wtbarr_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── conftest.py
|       |   ├── data
|       |   |   ├── maps
|       |   |   ├── spectra
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   ├── validate.6.txt
|       |   |   ├── validate.7.4.txt
|       |   |   ├── validate.7.6.txt
|       |   |   └── validate.txt
|       |   ├── helper.py
|       |   ├── test_auxprm.py
|       |   ├── test_celprm.py
|       |   ├── test_pickle.py
|       |   ├── test_prjprm.py
|       |   ├── test_profiling.py
|       |   ├── test_tab.py
|       |   ├── test_tabprm.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   ├── test_wcsprm.py
|       |   └── test_wtbarr.py
|       ├── utils.py
|       ├── wcs.py
|       ├── wcsapi
|       |   ├── __init__.py
|       |   ├── conftest.py
|       |   ├── data
|       |   |   └── ucds.txt
|       |   ├── fitswcs.py
|       |   ├── high_level_api.py
|       |   ├── high_level_wcs_wrapper.py
|       |   ├── low_level_api.py
|       |   ├── sliced_low_level_wcs.py
|       |   ├── tests
|       |   |   ├── __init__.py
|       |   |   ├── test_fitswcs.py
|       |   |   ├── test_high_level_api.py
|       |   |   ├── test_high_level_wcs_wrapper.py
|       |   |   ├── test_low_level_api.py
|       |   |   └── test_utils.py
|       |   ├── utils.py
|       |   └── wrappers
|       |       ├── __init__.py
|       |       ├── base.py
|       |       ├── sliced_wcs.py
|       |       └── tests
|       └── wcslint.py
├── azure-pipelines.yml
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   ├── wcsutil.c
|   |   |   ├── zcompress.c
|   |   |   └── zuncompress.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       └── zutil.c
|   ├── expat
|   |   ├── README.md
|   |   ├── README.txt
|   |   └── lib
|   |       ├── xmlparse.c
|   |       ├── xmlrole.c
|   |       ├── xmltok.c
|   |       ├── xmltok_impl.c
|   |       └── xmltok_ns.c
|   ├── trim_cfitsio.sh
|   ├── trim_expat.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── codecov.yml
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── _templates
|   |   └── layout.html
|   ├── changelog.rst
|   ├── changes
|   |   ├── README.rst
|   |   ├── config
|   |   ├── constants
|   |   ├── convolution
|   |   ├── coordinates
|   |   ├── cosmology
|   |   |   ├── 12279.feature.rst
|   |   |   ├── 12313.feature.rst
|   |   |   ├── 12354.api.rst
|   |   |   ├── 12375.api.rst
|   |   |   ├── 12479.feature.rst
|   |   |   ├── 12590.feature.rst
|   |   |   ├── 12606.feature.rst
|   |   |   ├── 12612.api.rst
|   |   |   ├── 12624.api.rst
|   |   |   ├── 12710.feature.rst
|   |   |   ├── 12736.feature.rst
|   |   |   ├── 12740.feature.rst
|   |   |   ├── 12746.api.rst
|   |   |   └── 12966.feature.rst
|   |   ├── extern
|   |   ├── io.ascii
|   |   |   ├── 12631.bugfix.rst
|   |   |   └── 12841.api.rst
|   |   ├── io.fits
|   |   |   ├── 11843.feature.rst
|   |   |   └── 12258.api.rst
|   |   ├── io.misc
|   |   |   ├── 10198.feature.rst
|   |   |   ├── 12279.feature.rst
|   |   |   ├── 12895.feature.rst
|   |   |   ├── 12897.feature.rst
|   |   |   ├── 12903.api.rst
|   |   |   └── 12930.api.rst
|   |   ├── io.registry
|   |   ├── io.votable
|   |   ├── modeling
|   |   |   ├── 12384.feature.rst
|   |   |   ├── 12558.feature.rst
|   |   |   ├── 12585.api.rst
|   |   |   └── 12811.feature.rst
|   |   ├── nddata
|   |   ├── samp
|   |   ├── stats
|   |   ├── table
|   |   |   ├── 12631.api.rst
|   |   |   ├── 12637.api.rst
|   |   |   ├── 12637.feature.rst
|   |   |   ├── 12680.feature.rst
|   |   |   └── 12716.bugfix.rst
|   |   ├── template.rst
|   |   ├── tests
|   |   |   ├── 12633.api.1.rst
|   |   |   ├── 12633.api.2.rst
|   |   |   ├── 12633.api.3.rst
|   |   |   └── 12633.api.4.rst
|   |   ├── time
|   |   |   └── 12888.api.rst
|   |   ├── timeseries
|   |   ├── uncertainty
|   |   ├── units
|   |   |   ├── 12486.feature.rst
|   |   |   ├── 12566.feature.rst
|   |   |   ├── 12709.feature.rst
|   |   |   └── 12975.feature.rst
|   |   ├── utils
|   |   ├── visualization
|   |   └── wcs
|   |       └── 12514.feature.rst
|   ├── common_links.txt
|   ├── conf.py
|   ├── config
|   |   ├── astropy_config.rst
|   |   └── index.rst
|   ├── conftest.py
|   ├── constants
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   ├── performance.inc.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── common_errors.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── performance.inc.rst
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── satellites.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── spectralcoord.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   ├── dev.rst
|   |   ├── index.rst
|   |   ├── io.rst
|   |   └── units.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── style-guide.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   ├── when_to_rebase.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       └── virtual_pythons.rst
|   ├── getting_started.rst
|   ├── glossary.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── ecsv.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── asdf-schemas.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       ├── performance.inc.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── lts_policy.rst
|   ├── modeling
|   |   ├── add-units.rst
|   |   ├── compound-models.rst
|   |   ├── example-fitting-constraints.rst
|   |   ├── example-fitting-line.rst
|   |   ├── example-fitting-model-sets.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── jointfitter.rst
|   |   ├── models.rst
|   |   ├── new-fitter.rst
|   |   ├── new-model.rst
|   |   ├── parameters.rst
|   |   ├── performance.rst
|   |   ├── physical_models.rst
|   |   ├── polynomial_models.rst
|   |   ├── predef_models1D.rst
|   |   ├── predef_models2D.rst
|   |   ├── reference_api.rst
|   |   ├── spline_models.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── bitmask.rst
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── examples
|   |   |   └── cutout2d_tofits.py
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── performance.inc.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── robots.txt
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── performance.inc.rst
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── timeseries
|   |   ├── analysis.rst
|   |   ├── bls.rst
|   |   ├── data_access.rst
|   |   ├── index.rst
|   |   ├── initializing.rst
|   |   ├── io.rst
|   |   ├── lombscargle.rst
|   |   ├── masking.rst
|   |   ├── pandas.rst
|   |   └── times.rst
|   ├── uncertainty
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── constants_versions.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── performance.inc.rst
|   |   ├── physical_types.rst
|   |   ├── quantity.rst
|   |   ├── standard_units.rst
|   |   ├── structured_units.rst
|   |   └── type_hints.rst
|   ├── utils
|   |   ├── data.rst
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── masked
|   |       └── index.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── matplotlib_integration.rst
|   |   ├── normalization.rst
|   |   ├── performance.inc.rst
|   |   ├── rgb.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── generic_transforms.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── example_create_imaging.rst
|   |   ├── example_cube_wcs.rst
|   |   ├── examples
|   |   |   ├── cube_wcs.py
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── legacy_interface.rst
|   |   ├── loading_from_fits.rst
|   |   ├── note_sip.rst
|   |   ├── performance.inc.rst
|   |   ├── reference_api.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   ├── relax.rst
|   |   ├── supported_projections.rst
|   |   ├── validation.rst
|   |   ├── wcsapi.rst
|   |   └── wcstools.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       ├── 3.2.rst
|       ├── 4.0.rst
|       ├── 4.1.rst
|       ├── 4.2.rst
|       ├── 4.3.rst
|       ├── 5.0.rst
|       ├── 5.1.rst
|       └── index.rst
├── examples
|   ├── README.rst
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── PYTHON.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
└── setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: TimeSeries: misleading exception when required column check fails.

Description: <!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Patch information:
diff --git a/astropy/timeseries/core.py b/astropy/timeseries/core.py
index c279f35f87..ae81167cb5 100644
--- a/astropy/timeseries/core.py
+++ b/astropy/timeseries/core.py
@@ -61,24 +61,38 @@ class BaseTimeSeries(QTable):
 
         if self._required_columns is not None:
 
+            # Determine which required columns to enforce in this state
             if self._required_columns_relax:
                 required_columns = self._required_columns[:len(self.colnames)]
             else:
                 required_columns = self._required_columns
 
-            plural = 's' if len(required_columns) > 1 else ''
-
+            # If not relaxed and there are no columns at all, report all required first columns
             if not self._required_columns_relax and len(self.colnames) == 0:
 
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but time series has no columns"
-                                 .format(self.__class__.__name__, required_columns[0], plural))
-
-            elif self.colnames[:len(required_columns)] != required_columns:
-
-                raise ValueError("{} object is invalid - expected '{}' "
-                                 "as the first column{} but found '{}'"
-                                 .format(self.__class__.__name__, required_columns[0], plural, self.colnames[0]))
+                raise ValueError("{} object is invalid - expected first column{} {} but time series has no columns"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns))
+
+            # Check for mismatches between the required first columns and the actual ones
+            actual_prefix = self.colnames[:len(required_columns)]
+            if actual_prefix != required_columns:
+                if not self._required_columns_relax:
+                    # If the actual columns form a correct prefix of the required columns,
+                    # then required columns are missing
+                    if self.colnames == self._required_columns[:len(self.colnames)] and len(self.colnames) < len(self._required_columns):
+                        missing = self._required_columns[len(self.colnames):]
+                        raise ValueError("{} object is invalid - missing required column{}: {}"
+                                         .format(self.__class__.__name__,
+                                                 's' if len(missing) > 1 else '',
+                                                 missing))
+                # Otherwise, report the expected vs. actual first columns for clarity
+                raise ValueError("{} object is invalid - expected first column{} {} but found {}"
+                                 .format(self.__class__.__name__,
+                                         's' if len(required_columns) > 1 else '',
+                                         required_columns,
+                                         actual_prefix))
 
             if (self._required_columns_relax
                     and self._required_columns == self.colnames[:len(self._required_columns)]):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/timeseries/tests/test_sampled.py`.
Extra Requirements: 
Purpose: I need the content of this test file to identify three relevant test cases that demonstrate functionality similar to the bug report, as requested by the user.

Previous refined query 2:
Essential Query: Please provide the full content of the file `astropy/timeseries/tests/test_binned.py`.
Extra Requirements: 
Purpose: I need to find test cases that deal with multiple required columns to provide the user with the most relevant examples related to the bug they reported.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/timeseries/tests/test_binned.py
Line number range: 1 - 317
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import pytest
4. from numpy.testing import assert_equal, assert_allclose
5. 
6. from astropy import units as u
7. from astropy.time import Time, TimeDelta
8. from astropy.utils.data import get_pkg_data_filename
9. 
10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
11. from astropy.timeseries.binned import BinnedTimeSeries
12. from astropy.tests.helper import assert_quantity_allclose
13. 
14. 
15. CSV_FILE = get_pkg_data_filename('data/binned.csv')
16. 
17. 
18. def test_empty_initialization():
19.     ts = BinnedTimeSeries()
20.     ts['time_bin_start'] = Time([1, 2, 3], format='mjd')
21. 
22. 
23. def test_empty_initialization_invalid():
24. 
25.     # Make sure things crash when the first column added is not a time column
26. 
27.     ts = BinnedTimeSeries()
28.     with pytest.raises(ValueError) as exc:
29.         ts['flux'] = [1, 2, 3]
30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "
31.                                  "'time_bin_start' as the first column but found 'flux'")
32. 
33. 
34. def test_initialization_time_bin_invalid():
35. 
36.     # Make sure things crash when time_bin_* is passed incorrectly.
37. 
38.     with pytest.raises(TypeError) as exc:
39.         BinnedTimeSeries(data=[[1, 4, 3]])
40.     assert exc.value.args[0] == ("'time_bin_start' has not been specified")
41. 
42.     with pytest.raises(TypeError) as exc:
43.         BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31', data=[[1, 4, 3]])
44.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
45. 
46. 
47. def test_initialization_time_bin_both():
48. 
49.     # Make sure things crash when time_bin_* is passed twice.
50. 
51.     with pytest.raises(TypeError) as exc:
52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},
53.                          time_bin_start="2016-03-22T12:30:31")
54.     assert exc.value.args[0] == ("'time_bin_start' has been given both in the table "
55.                                  "and as a keyword argument")
56. 
57.     with pytest.raises(TypeError) as exc:
58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},
59.                          time_bin_size=[1]*u.s)
60.     assert exc.value.args[0] == ("'time_bin_size' has been given both in the table "
61.                                  "and as a keyword argument")
62. 
63. 
64. def test_initialization_time_bin_size():
65. 
66.     # Make sure things crash when time_bin_size has no units
67. 
68.     with pytest.raises(TypeError) as exc:
69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
70.                          time_bin_start="2016-03-22T12:30:31",
71.                          time_bin_size=1)
72.     assert exc.value.args[0] == ("'time_bin_size' should be a Quantity or a TimeDelta")
73. 
74.     # TimeDelta for time_bin_size
75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
76.                           time_bin_start="2016-03-22T12:30:31",
77.                           time_bin_size=TimeDelta(1, format="jd"))
78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)
79. 
80. 
81. def test_initialization_time_bin_start_scalar():
82. 
83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size
84. 
85.     with pytest.raises(TypeError) as exc:
86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
87.                          time_bin_start=Time(1, format='mjd'),
88.                          time_bin_end=Time(1, format='mjd'))
89.     assert exc.value.args[0] == ("'time_bin_start' is scalar, so 'time_bin_size' is required")
90. 
91. 
92. def test_initialization_n_bins_invalid_arguments():
93. 
94.     # Make sure an exception is raised when n_bins is passed as an argument while
95.     # any of the parameters 'time_bin_start' or 'time_bin_end' is not scalar.
96. 
97.     with pytest.raises(TypeError) as exc:
98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format='cxcsec'),
99.                          time_bin_size=1*u.s,
100.                          n_bins=10)
101.     assert exc.value.args[0] == ("'n_bins' cannot be specified if 'time_bin_start' or "
102.                                  "'time_bin_size' are not scalar'")
103. 
104. 
105. def test_initialization_n_bins():
106. 
107.     # Make sure things crash with incorrect n_bins
108. 
109.     with pytest.raises(TypeError) as exc:
110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
111.                          time_bin_start=Time(1, format='mjd'),
112.                          time_bin_size=1*u.s,
113.                          time_bin_end=Time(1, format='mjd'),
114.                          n_bins=10)
115.     assert exc.value.args[0] == ("'n_bins' has been given and it is not the "
116.                                  "same length as the input data.")
117. 
118. 
119. def test_initialization_non_scalar_time():
120. 
121.     # Make sure things crash with incorrect size of time_bin_start
122. 
123.     with pytest.raises(ValueError) as exc:
124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],
126.                          time_bin_size=1*u.s,
127.                          time_bin_end=Time(1, format='mjd'))
128.     assert exc.value.args[0] == ("Length of 'time_bin_start' (2) should match table length (1)")
129. 
130.     with pytest.raises(TypeError) as exc:
131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
132.                          time_bin_start=["2016-03-22T12:30:31"],
133.                          time_bin_size=None,
134.                          time_bin_end=None)
135.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
136. 
137. 
138. def test_even_contiguous():
139. 
140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying
141.     # the bin width:
142. 
143.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])
145. 
146.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
147.                                           '2016-03-22T12:30:34.000',
148.                                           '2016-03-22T12:30:37.000'])
149. 
150.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:32.500',
151.                                            '2016-03-22T12:30:35.500',
152.                                            '2016-03-22T12:30:38.500'])
153. 
154.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:34.000',
155.                                         '2016-03-22T12:30:37.000',
156.                                         '2016-03-22T12:30:40.000'])
157. 
158. 
159. def test_uneven_contiguous():
160. 
161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an
162.     # end time:
163. 
164.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
165.                                           '2016-03-22T12:30:32',
166.                                           '2016-03-22T12:30:40'],
167.                           time_bin_end='2016-03-22T12:30:55',
168.                           data=[[1, 4, 3]])
169. 
170.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
171.                                           '2016-03-22T12:30:32.000',
172.                                           '2016-03-22T12:30:40.000'])
173. 
174.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
175.                                            '2016-03-22T12:30:36.000',
176.                                            '2016-03-22T12:30:47.500'])
177. 
178.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
179.                                         '2016-03-22T12:30:40.000',
180.                                         '2016-03-22T12:30:55.000'])
181. 
182. 
183. def test_uneven_non_contiguous():
184. 
185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with
186.     # lists of start times, bin sizes and data:
187. 
188.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
189.                                           '2016-03-22T12:30:38',
190.                                           '2016-03-22T12:34:40'],
191.                           time_bin_size=[5, 100, 2]*u.s,
192.                           data=[[1, 4, 3]])
193. 
194.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
195.                                           '2016-03-22T12:30:38.000',
196.                                           '2016-03-22T12:34:40.000'])
197. 
198.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:33.500',
199.                                            '2016-03-22T12:31:28.000',
200.                                            '2016-03-22T12:34:41.000'])
201. 
202.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:36.000',
203.                                         '2016-03-22T12:32:18.000',
204.                                         '2016-03-22T12:34:42.000'])
205. 
206. 
207. def test_uneven_non_contiguous_full():
208. 
209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by
210.     # specifying the start and end times for the bins:
211. 
212.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
213.                                           '2016-03-22T12:30:33',
214.                                           '2016-03-22T12:30:40'],
215.                           time_bin_end=['2016-03-22T12:30:32',
216.                                         '2016-03-22T12:30:35',
217.                                         '2016-03-22T12:30:41'],
218.                           data=[[1, 4, 3]])
219. 
220.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
221.                                           '2016-03-22T12:30:33.000',
222.                                           '2016-03-22T12:30:40.000'])
223. 
224.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
225.                                            '2016-03-22T12:30:34.000',
226.                                            '2016-03-22T12:30:40.500'])
227. 
228.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
229.                                         '2016-03-22T12:30:35.000',
230.                                         '2016-03-22T12:30:41.000'])
231. 
232. 
233. def test_read_empty():
234.     with pytest.raises(ValueError) as exc:
235.         BinnedTimeSeries.read(CSV_FILE, format='csv')
236.     assert exc.value.args[0] == '``time_bin_start_column`` should be provided since the default Table readers are being used.'
237. 
238. 
239. def test_read_no_size_end():
240.     with pytest.raises(ValueError) as exc:
241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', format='csv')
242.     assert exc.value.args[0] == 'Either `time_bin_end_column` or `time_bin_size_column` should be provided.'
243. 
244. 
245. def test_read_both_extra_bins():
246.     with pytest.raises(ValueError) as exc:
247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column='END', time_bin_size_column='bin_size', format='csv')
248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."
249. 
250. 
251. def test_read_size_no_unit():
252.     with pytest.raises(ValueError) as exc:
253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column='bin_size', format='csv')
254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
255. 
256. 
257. def test_read_start_time_missing():
258.     with pytest.raises(ValueError) as exc:
259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='abc', time_bin_size_column='bin_size', time_bin_size_unit=u.second, format='csv')
260.     assert exc.value.args[0] == "Bin start time column 'abc' not found in the input data."
261. 
262. 
263. def test_read_end_time_missing():
264.     with pytest.raises(ValueError) as exc:
265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column="missing", format='csv')
266.     assert exc.value.args[0] == "Bin end time column 'missing' not found in the input data."
267. 
268. 
269. def test_read_size_missing():
270.     with pytest.raises(ValueError) as exc:
271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="missing", time_bin_size_unit=u.second, format='csv')
272.     assert exc.value.args[0] == "Bin size column 'missing' not found in the input data."
273. 
274. 
275. def test_read_time_unit_missing():
276.     with pytest.raises(ValueError) as exc:
277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="bin_size", format='csv')
278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
279. 
280. 
281. def test_read():
282. 
283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
284.                                        time_bin_end_column='time_end', format='csv')
285.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'bin_size', 'A', 'B', 'C', 'D', 'E', 'F']
286.     assert len(timeseries) == 10
287.     assert timeseries['B'].sum() == 1151.54
288. 
289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
290.                                        time_bin_size_column='bin_size',
291.                                        time_bin_size_unit=u.second, format='csv')
292.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'time_end', 'A', 'B', 'C', 'D', 'E', 'F']
293.     assert len(timeseries) == 10
294.     assert timeseries['B'].sum() == 1151.54
295. 
296. 
297. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
298. def test_periodogram(cls):
299. 
300.     # Note that we don't need to check the actual results from the periodogram
301.     # classes here since these are tested extensively in
302.     # astropy.timeseries.periodograms.
303. 
304.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=['a', 'b'])
306. 
307.     p1 = cls.from_timeseries(ts, 'a')
308.     assert isinstance(p1, cls)
309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)
310.     assert_equal(p1.y, ts['a'])
311.     assert p1.dy is None
312. 
313.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
314.     assert_quantity_allclose(p2.dy, ts['b'])
315. 
316.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
317.     assert_allclose(p3.dy, 0.1)


File: astropy/timeseries/tests/test_sampled.py
Line number range: 1 - 420
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. from datetime import datetime
4. 
5. import pytest
6. 
7. from numpy.testing import assert_equal, assert_allclose
8. 
9. from astropy.table import Table, Column
10. from astropy.time import Time, TimeDelta
11. from astropy import units as u
12. from astropy.units import Quantity
13. from astropy.utils.data import get_pkg_data_filename
14. from astropy.tests.helper import assert_quantity_allclose
15. 
16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
17. from astropy.timeseries.sampled import TimeSeries
18. 
19. INPUT_TIME = Time(['2016-03-22T12:30:31',
20.                    '2015-01-21T12:30:32',
21.                    '2016-03-22T12:30:40'])
22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=['a', 'b', 'c'])
23. 
24. CSV_FILE = get_pkg_data_filename('data/sampled.csv')
25. 
26. 
27. def test_empty_initialization():
28.     ts = TimeSeries()
29.     ts['time'] = Time([50001, 50002, 50003], format='mjd')
30. 
31. 
32. def test_empty_initialization_invalid():
33.     # Make sure things crash when the first column added is not a time column
34.     ts = TimeSeries()
35.     with pytest.raises(ValueError) as exc:
36.         ts['flux'] = [1, 2, 3]
37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
38.                                  "'time' as the first column but found 'flux'")
39. 
40. 
41. def test_initialize_only_time():
42.     ts = TimeSeries(time=INPUT_TIME)
43.     assert ts['time'] is ts.time
44.     # NOTE: the object in the table is a copy
45.     assert_equal(ts.time.isot, INPUT_TIME.isot)
46. 
47. 
48. def test_initialization_with_data():
49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
50.     assert_equal(ts.time.isot, INPUT_TIME.isot)
51.     assert_equal(ts['a'], [10, 2, 3])
52.     assert_equal(ts['b'], [4, 5, 6])
53. 
54. 
55. def test_initialize_only_data():
56.     with pytest.raises(TypeError) as exc:
57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
58.     assert exc.value.args[0] == "Either 'time' or 'time_start' should be specified"
59. 
60. 
61. def test_initialization_with_table():
62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)
63.     assert ts.colnames == ['time', 'a', 'b', 'c']
64. 
65. 
66. def test_initialization_with_time_delta():
67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
68.                     time_delta=TimeDelta(3, format='sec'),
69.                     data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
70.     assert_equal(ts.time.isot, ['2018-07-01T10:10:10.000',
71.                                 '2018-07-01T10:10:13.000',
72.                                 '2018-07-01T10:10:16.000'])
73. 
74. 
75. def test_initialization_missing_time_delta():
76.     with pytest.raises(TypeError) as exc:
77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
78.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
79.     assert exc.value.args[0] == "'time' is scalar, so 'time_delta' is required"
80. 
81. 
82. def test_initialization_invalid_time_and_time_start():
83.     with pytest.raises(TypeError) as exc:
84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),
85.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
86.     assert exc.value.args[0] == "Cannot specify both 'time' and 'time_start'"
87. 
88. 
89. def test_initialization_invalid_time_delta():
90.     with pytest.raises(TypeError) as exc:
91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
92.                    time_delta=[1, 4, 3],
93.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
94.     assert exc.value.args[0] == "'time_delta' should be a Quantity or a TimeDelta"
95. 
96. 
97. def test_initialization_with_time_in_data():
98. 
99.     data = PLAIN_TABLE.copy()
100.     data['time'] = INPUT_TIME
101. 
102.     ts1 = TimeSeries(data=data)
103. 
104.     assert set(ts1.colnames) == set(['time', 'a', 'b', 'c'])
105.     assert all(ts1.time == INPUT_TIME)
106. 
107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
108.     assert set(ts2.colnames) == set(['time', 'a'])
109.     assert all(ts2.time == INPUT_TIME)
110. 
111.     with pytest.raises(TypeError) as exc:
112.         # Don't allow ambiguous cases of passing multiple 'time' columns
113.         TimeSeries(data=data, time=INPUT_TIME)
114.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
115. 
116.     with pytest.raises(TypeError) as exc:
117.         # 'time' is a protected name, don't allow ambiguous cases
118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
119.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
120. 
121. 
122. def test_initialization_n_samples():
123. 
124.     # Make sure things crash with incorrect n_samples
125. 
126.     with pytest.raises(TypeError) as exc:
127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)
128.     assert exc.value.args[0] == ("'n_samples' has been given both and it is not the "
129.                                  "same length as the input data.")
130. 
131. 
132. def test_initialization_length_mismatch():
133.     with pytest.raises(ValueError) as exc:
134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=['a', 'b'])
135.     assert exc.value.args[0] == "Length of 'time' (3) should match data length (2)"
136. 
137. 
138. def test_initialization_invalid_both_time_and_time_delta():
139.     with pytest.raises(TypeError) as exc:
140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format='sec'))
141.     assert exc.value.args[0] == ("'time_delta' should not be specified since "
142.                                  "'time' is an array")
143. 
144. 
145. def test_fold():
146. 
147.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
148. 
149.     ts = TimeSeries(time=times)
150.     ts['flux'] = [1, 4, 4, 3, 2, 3]
151. 
152.     # Try without epoch time, as it should default to the first time and
153.     # wrapping at half the period.
154.     tsf = ts.fold(period=3.2 * u.s)
155.     assert isinstance(tsf.time, TimeDelta)
156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)
157. 
158.     # Try with epoch time
159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'))
160.     assert isinstance(tsf.time, TimeDelta)
161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)
162. 
163.     # Now with wrap_phase set to the full period
164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)
165.     assert isinstance(tsf.time, TimeDelta)
166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)
167. 
168.     # Now set epoch_phase to be 1/4 of the way through the phase
169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)
170.     assert isinstance(tsf.time, TimeDelta)
171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)
172. 
173.     # And combining epoch_phase and wrap_phase
174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)
175.     assert isinstance(tsf.time, TimeDelta)
176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)
177. 
178.     # Now repeat the above tests but with normalization applied
179. 
180.     # Try without epoch time, as it should default to the first time and
181.     # wrapping at half the period.
182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)
183.     assert isinstance(tsf.time, Quantity)
184.     assert_allclose(tsf.time.to_value(u.one),
185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],
186.                     rtol=1e-6)
187. 
188.     # Try with epoch time
189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'),
190.                   normalize_phase=True)
191.     assert isinstance(tsf.time, Quantity)
192.     assert_allclose(tsf.time.to_value(u.one),
193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],
194.                     rtol=1e-6, atol=1e-6)
195. 
196.     # Now with wrap_phase set to the full period
197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)
198.     assert isinstance(tsf.time, Quantity)
199.     assert_allclose(tsf.time.to_value(u.one),
200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],
201.                     rtol=1e-6)
202. 
203.     # Now set epoch_phase to be 1/4 of the way through the phase
204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)
205.     assert isinstance(tsf.time, Quantity)
206.     assert_allclose(tsf.time.to_value(u.one),
207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],
208.                     rtol=1e-6)
209. 
210.     # And combining epoch_phase and wrap_phase
211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,
212.                   normalize_phase=True)
213.     assert isinstance(tsf.time, Quantity)
214.     assert_allclose(tsf.time.to_value(u.one),
215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],
216.                     rtol=1e-6)
217. 
218. 
219. def test_fold_invalid_options():
220. 
221.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
222. 
223.     ts = TimeSeries(time=times)
224.     ts['flux'] = [1, 4, 4, 3, 2, 3]
225. 
226.     with pytest.raises(u.UnitsError,
227.                        match='period should be a Quantity in units of time'):
228.         ts.fold(period=3.2)
229. 
230.     with pytest.raises(u.UnitsError,
231.                        match='period should be a Quantity in units of time'):
232.         ts.fold(period=3.2 * u.m)
233. 
234.     with pytest.raises(u.UnitsError,
235.                        match='epoch_phase should be a Quantity in units of '
236.                              'time when normalize_phase=False'):
237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)
238. 
239.     with pytest.raises(u.UnitsError,
240.                        match='epoch_phase should be a dimensionless Quantity '
241.                              'or a float when normalize_phase=True'):
242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)
243. 
244.     with pytest.raises(u.UnitsError,
245.                        match='wrap_phase should be a Quantity in units of '
246.                              'time when normalize_phase=False'):
247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)
248. 
249.     with pytest.raises(u.UnitsError,
250.                        match='wrap_phase should be dimensionless when '
251.                              'normalize_phase=True'):
252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)
253. 
254.     with pytest.raises(ValueError,
255.                        match='wrap_phase should be between 0 and the period'):
256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)
257. 
258.     with pytest.raises(ValueError,
259.                        match='wrap_phase should be between 0 and the period'):
260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)
261. 
262.     with pytest.raises(ValueError,
263.                        match='wrap_phase should be between 0 and 1'):
264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)
265. 
266.     with pytest.raises(ValueError,
267.                        match='wrap_phase should be between 0 and 1'):
268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)
269. 
270. 
271. def test_pandas():
272.     pandas = pytest.importorskip("pandas")
273. 
274.     df1 = pandas.DataFrame()
275.     df1['a'] = [1, 2, 3]
276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)
277. 
278.     ts = TimeSeries.from_pandas(df1)
279.     assert_equal(ts.time.isot, INPUT_TIME.isot)
280.     assert ts.colnames == ['time', 'a']
281.     assert len(ts.indices) == 1
282.     assert (ts.indices['time'].columns[0] == INPUT_TIME).all()
283. 
284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale='tcb')
285.     assert ts_tcb.time.scale == 'tcb'
286. 
287.     df2 = ts.to_pandas()
288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()
289.     assert df2.columns == pandas.Index(['a'])
290.     assert (df1['a'] == df2['a']).all()
291. 
292.     with pytest.raises(TypeError) as exc:
293.         TimeSeries.from_pandas(None)
294.     assert exc.value.args[0] == 'Input should be a pandas DataFrame'
295. 
296.     df4 = pandas.DataFrame()
297.     df4['a'] = [1, 2, 3]
298. 
299.     with pytest.raises(TypeError) as exc:
300.         TimeSeries.from_pandas(df4)
301.     assert exc.value.args[0] == 'DataFrame does not have a DatetimeIndex'
302. 
303. 
304. def test_read_time_missing():
305.     with pytest.raises(ValueError) as exc:
306.         TimeSeries.read(CSV_FILE, format='csv')
307.     assert exc.value.args[0] == '``time_column`` should be provided since the default Table readers are being used.'
308. 
309. 
310. def test_read_time_wrong():
311.     with pytest.raises(ValueError) as exc:
312.         TimeSeries.read(CSV_FILE, time_column='abc', format='csv')
313.     assert exc.value.args[0] == "Time column 'abc' not found in the input data."
314. 
315. 
316. def test_read():
317.     timeseries = TimeSeries.read(CSV_FILE, time_column='Date', format='csv')
318.     assert timeseries.colnames == ['time', 'A', 'B', 'C', 'D', 'E', 'F', 'G']
319.     assert len(timeseries) == 11
320.     assert timeseries['time'].format == 'iso'
321.     assert timeseries['A'].sum() == 266.5
322. 
323. 
324. @pytest.mark.remote_data(source='astropy')
325. def test_kepler_astropy():
326.     from astropy.units import UnitsWarning
327. 
328.     filename = get_pkg_data_filename('timeseries/kplr010666592-2009131110544_slc.fits')
329. 
330.     with pytest.warns(UnitsWarning):
331.         timeseries = TimeSeries.read(filename, format='kepler.fits')
332. 
333.     assert timeseries["time"].format == 'isot'
334.     assert timeseries["time"].scale == 'tdb'
335.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
336.     assert len(timeseries) == 14280
337.     assert len(timeseries.columns) == 20
338. 
339. 
340. @pytest.mark.remote_data(source='astropy')
341. def test_tess_astropy():
342.     filename = get_pkg_data_filename('timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits')
343.     with pytest.warns(UserWarning, match='Ignoring 815 rows with NaN times'):
344.         timeseries = TimeSeries.read(filename, format='tess.fits')
345.     assert timeseries["time"].format == 'isot'
346.     assert timeseries["time"].scale == 'tdb'
347.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
348.     assert len(timeseries) == 19261
349.     assert len(timeseries.columns) == 20
350. 
351. 
352. def test_required_columns():
353. 
354.     # Test the machinery that makes sure that the required columns are present
355. 
356.     ts = TimeSeries(time=INPUT_TIME,
357.                     data=[[10, 2, 3], [4, 5, 6]],
358.                     names=['a', 'b'])
359. 
360.     # In the examples below, the operation (e.g. remove_column) is actually
361.     # carried out before the checks are made, so we need to use copy() so that
362.     # we don't change the main version of the time series.
363. 
364.     # Make sure copy works fine
365.     ts.copy()
366. 
367.     with pytest.raises(ValueError) as exc:
368.         ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
370.                                  "'time' as the first column but found 'c'")
371. 
372.     with pytest.raises(ValueError) as exc:
373.         ts.copy().add_columns([Column([3, 4, 5], name='d'),
374.                                Column([3, 4, 5], name='e')], indexes=[0, 1])
375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
376.                                  "'time' as the first column but found 'd'")
377. 
378.     with pytest.raises(ValueError) as exc:
379.         ts.copy().keep_columns(['a', 'b'])
380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
381.                                  "'time' as the first column but found 'a'")
382. 
383.     with pytest.raises(ValueError) as exc:
384.         ts.copy().remove_column('time')
385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
386.                                  "'time' as the first column but found 'a'")
387. 
388.     with pytest.raises(ValueError) as exc:
389.         ts.copy().remove_columns(['time', 'a'])
390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
391.                                  "'time' as the first column but found 'b'")
392. 
393.     with pytest.raises(ValueError) as exc:
394.         ts.copy().rename_column('time', 'banana')
395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
396.                                  "'time' as the first column but found 'banana'")
397. 
398. 
399. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
400. def test_periodogram(cls):
401. 
402.     # Note that we don't need to check the actual results from the periodogram
403.     # classes here since these are tested extensively in
404.     # astropy.timeseries.periodograms.
405. 
406.     ts = TimeSeries(time=INPUT_TIME,
407.                     data=[[10, 2, 3], [4, 5, 6]],
408.                     names=['a', 'b'])
409. 
410.     p1 = cls.from_timeseries(ts, 'a')
411.     assert isinstance(p1, cls)
412.     assert_allclose(p1.t.jd, ts.time.jd)
413.     assert_equal(p1.y, ts['a'])
414.     assert p1.dy is None
415. 
416.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
417.     assert_quantity_allclose(p2.dy, ts['b'])
418. 
419.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
420.     assert_allclose(p3.dy, 0.1)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:49:06,025 - thread-124314420512448.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have analyzed the provided test files, `astropy/timeseries/tests/test_sampled.py` and `astropy/timeseries/tests/test_binned.py`. The bug is about a misleading `ValueError` when a required column is removed, which is checked in `BaseTimeSeries.__setstate__`. I have identified three relevant tests that exercise this exact validation logic. `test_required_columns` and `test_empty_initialization_invalid` from `test_sampled.py` test this for `TimeSeries`. `test_empty_initialization_invalid` from `test_binned.py` is relevant because `BinnedTimeSeries` has multiple required columns by default, which is similar to the user's bug report. The provided context is sufficient to construct the complete test cases." query='' extra_requirements='' purpose=''
2025-12-21 08:49:06,026 - thread-124314420512448.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
