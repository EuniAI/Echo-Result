2025-12-23 00:52:00,021 - thread-124975134525120.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: PythonCodePrinter doesn't support Indexed 

Description: I use `lambdify()` to generate some functions and save the code for further use. But the generated code for `Indexed` operation has some warnings which can be confirmed by following code;

```
from sympy import *
p = IndexedBase("p")

pycode(p[0])
```
the output is 

```
  # Not supported in Python:
  # Indexed
p[0]
```

We should add following method to `PythonCodePrinter`:

```
def _print_Indexed(self, expr):
    base, *index = expr.args
    return "{}[{}]".format(str(base), ", ".join([self._print(ind) for ind in index]))
```

Patch information:
diff --git a/sympy/printing/pycode.py b/sympy/printing/pycode.py
index a3f0310735..8f7125e8eb 100644
--- a/sympy/printing/pycode.py
+++ b/sympy/printing/pycode.py
@@ -357,6 +357,17 @@ def _print_Not(self, expr):
         PREC = precedence(expr)
         return self._operators['not'] + self.parenthesize(expr.args[0], PREC)
 
+    def _print_Indexed(self, expr):
+        base = expr.base
+        indices = expr.indices
+        return "%s[%s]" % (self._print(base), ", ".join(self._print(ind) for ind in indices))
+
+    def _print_Idx(self, expr):
+        return self._print(expr.label)
+
+    def _print_IndexedBase(self, expr):
+        return self._print(expr.label)
+
 
 for k in PythonCodePrinter._kf:
     setattr(PythonCodePrinter, '_print_%s' % k, _print_known_func)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 00:52:00,093 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: PythonCodePrinter doesn't support Indexed 

Description: I use `lambdify()` to generate some functions and save the code for further use. But the generated code for `Indexed` operation has some warnings which can be confirmed by following code;

```
from sympy import *
p = IndexedBase("p")

pycode(p[0])
```
the output is 

```
  # Not supported in Python:
  # Indexed
p[0]
```

We should add following method to `PythonCodePrinter`:

```
def _print_Indexed(self, expr):
    base, *index = expr.args
    return "{}[{}]".format(str(base), ", ".join([self._print(ind) for ind in index]))
```

Patch information:
diff --git a/sympy/printing/pycode.py b/sympy/printing/pycode.py
index a3f0310735..8f7125e8eb 100644
--- a/sympy/printing/pycode.py
+++ b/sympy/printing/pycode.py
@@ -357,6 +357,17 @@ def _print_Not(self, expr):
         PREC = precedence(expr)
         return self._operators['not'] + self.parenthesize(expr.args[0], PREC)
 
+    def _print_Indexed(self, expr):
+        base = expr.base
+        indices = expr.indices
+        return "%s[%s]" % (self._print(base), ", ".join(self._print(ind) for ind in indices))
+
+    def _print_Idx(self, expr):
+        return self._print(expr.label)
+
+    def _print_IndexedBase(self, expr):
+        return self._print(expr.label)
+
 
 for k in PythonCodePrinter._kf:
     setattr(PythonCodePrinter, '_print_%s' % k, _print_known_func)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 00:52:12,864 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a bug in `PythonCodePrinter` related to `Indexed` objects. The provided context is empty. To find relevant tests, I need to examine the test file associated with `sympy/printing/pycode.py`, which is the file being patched. The most logical starting point is to request the content of `sympy/printing/tests/test_pycode.py` to identify tests for the `PythonCodePrinter` and `pycode` function.' query='Please provide the full content of the file sympy/printing/tests/test_pycode.py.' extra_requirements='' purpose="I need to inspect the test file for `pycode` to find existing tests that handle similar structures or code printing scenarios, which will help in identifying the most relevant examples for the user's bug report."
2025-12-23 00:52:12,865 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file sympy/printing/tests/test_pycode.py.
2025-12-23 00:52:12,865 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 00:52:12,865 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 00:52:12,866 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 00:52:12,866 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file sympy/printing/tests/test_pycode.py.
Purpose: I need to inspect the test file for `pycode` to find existing tests that handle similar structures or code printing scenarios, which will help in identifying the most relevant examples for the user's bug report.
2025-12-23 00:52:14,769 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of the file `sympy/printing/tests/test_pycode.py`. This will allow me to examine the existing tests for `pycode` and identify relevant examples for the user's bug report." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/printing/tests/test_pycode.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2121, 'candidates_token_count': 75, 'total_token_count': 2328, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2121}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 75}], 'thoughts_token_count': 132, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08146226882934571, 'model_name': 'gemini-2.5-pro'} id='run--9f75580e-9cdd-4b97-90eb-2ff57bc710c4-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/printing/tests/test_pycode.py'}, 'id': 'fc1d8863-8234-4ae2-aadc-a5af138126c3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2121, 'output_tokens': 75, 'total_tokens': 2328, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 132}}
2025-12-23 00:52:17,740 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of the file `sympy/printing/tests/test_pycode.py`. This allows me to examine the existing tests for `pycode` to better understand its functionality. By analyzing the test cases, I can identify relevant examples that will help address the user's bug report." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3865, 'candidates_token_count': 64, 'total_token_count': 4157, 'cached_content_token_count': 1640, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3865}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1640}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 228}, 'finish_reason': 'STOP', 'avg_logprobs': -0.36067327857017517, 'model_name': 'gemini-2.5-pro'} id='run--53917b5f-695d-4f95-a269-2e517d245b8b-0' usage_metadata={'input_tokens': 3865, 'output_tokens': 64, 'total_tokens': 4157, 'input_token_details': {'cache_read': 1640}, 'output_token_details': {'reasoning': 228}}
2025-12-23 00:52:17,742 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file sympy/printing/tests/test_pycode.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to inspect the test file for `pycode` to find existing tests that handle similar structures or code printing scenarios, which will help in identifying the most relevant examples for the user's bug report.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/printing/tests/test_pycode.py
Line number range: 1 - 98
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import absolute_import
3. 
4. from sympy.codegen import Assignment
5. from sympy.codegen.ast import none
6. from sympy.core import Expr, Mod, symbols, Eq, Le, Gt, zoo, oo, Rational
7. from sympy.core.numbers import pi
8. from sympy.functions import acos, Piecewise, sign
9. from sympy.logic import And, Or
10. from sympy.matrices import SparseMatrix, MatrixSymbol
11. from sympy.printing.pycode import (
12.     MpmathPrinter, NumPyPrinter, PythonCodePrinter, pycode, SciPyPrinter
13. )
14. from sympy.utilities.pytest import raises
15. 
16. x, y, z = symbols('x y z')
17. 
18. 
19. def test_PythonCodePrinter():
20.     prntr = PythonCodePrinter()
21.     assert not prntr.module_imports
22.     assert prntr.doprint(x**y) == 'x**y'
23.     assert prntr.doprint(Mod(x, 2)) == 'x % 2'
24.     assert prntr.doprint(And(x, y)) == 'x and y'
25.     assert prntr.doprint(Or(x, y)) == 'x or y'
26.     assert not prntr.module_imports
27.     assert prntr.doprint(pi) == 'math.pi'
28.     assert prntr.module_imports == {'math': {'pi'}}
29.     assert prntr.doprint(acos(x)) == 'math.acos(x)'
30.     assert prntr.doprint(Assignment(x, 2)) == 'x = 2'
31.     assert prntr.doprint(Piecewise((1, Eq(x, 0)),
32.                         (2, x>6))) == '((1) if (x == 0) else (2) if (x > 6) else None)'
33.     assert prntr.doprint(Piecewise((2, Le(x, 0)),
34.                         (3, Gt(x, 0)), evaluate=False)) == '((2) if (x <= 0) else'\
35.                                                         ' (3) if (x > 0) else None)'
36.     assert prntr.doprint(sign(x)) == '(0.0 if x == 0 else math.copysign(1, x))'
37. 
38. 
39. def test_MpmathPrinter():
40.     p = MpmathPrinter()
41.     assert p.doprint(sign(x)) == 'mpmath.sign(x)'
42.     assert p.doprint(Rational(1, 2)) == 'mpmath.mpf(1)/mpmath.mpf(2)'
43. 
44. def test_NumPyPrinter():
45.     p = NumPyPrinter()
46.     assert p.doprint(sign(x)) == 'numpy.sign(x)'
47.     A = MatrixSymbol("A", 2, 2)
48.     assert p.doprint(A**(-1)) == "numpy.linalg.inv(A)"
49.     assert p.doprint(A**5) == "numpy.linalg.matrix_power(A, 5)"
50. 
51. 
52. def test_SciPyPrinter():
53.     p = SciPyPrinter()
54.     expr = acos(x)
55.     assert 'numpy' not in p.module_imports
56.     assert p.doprint(expr) == 'numpy.arccos(x)'
57.     assert 'numpy' in p.module_imports
58.     assert not any(m.startswith('scipy') for m in p.module_imports)
59.     smat = SparseMatrix(2, 5, {(0, 1): 3})
60.     assert p.doprint(smat) == 'scipy.sparse.coo_matrix([3], ([0], [1]), shape=(2, 5))'
61.     assert 'scipy.sparse' in p.module_imports
62. 
63. 
64. def test_pycode_reserved_words():
65.     s1, s2 = symbols('if else')
66.     raises(ValueError, lambda: pycode(s1 + s2, error_on_reserved=True))
67.     py_str = pycode(s1 + s2)
68.     assert py_str in ('else_ + if_', 'if_ + else_')
69. 
70. 
71. class CustomPrintedObject(Expr):
72.     def _numpycode(self, printer):
73.         return 'numpy'
74. 
75.     def _mpmathcode(self, printer):
76.         return 'mpmath'
77. 
78. 
79. def test_printmethod():
80.     obj = CustomPrintedObject()
81.     assert NumPyPrinter().doprint(obj) == 'numpy'
82.     assert MpmathPrinter().doprint(obj) == 'mpmath'
83. 
84. 
85. def test_codegen_ast_nodes():
86.     assert pycode(none) == 'None'
87. 
88. 
89. def test_issue_14283():
90.     prntr = PythonCodePrinter()
91. 
92.     assert prntr.doprint(zoo) == "float('nan')"
93.     assert prntr.doprint(-oo) == "float('-inf')"
94. 
95. def test_NumPyPrinter_print_seq():
96.     n = NumPyPrinter()
97. 
98.     assert n._print_seq(range(2)) == '(0, 1,)'

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 00:52:21,830 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file 'sympy/printing/tests/test_pycode.py'. The provided context contains the first 98 lines of this file, which directly addresses the user's query.", relative_path='sympy/printing/tests/test_pycode.py', start_line=1, end_line=98)]
2025-12-23 00:52:21,831 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file sympy/printing/tests/test_pycode.py.
2025-12-23 00:52:21,831 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 00:52:21,831 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 00:52:21,831 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 00:52:21,831 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 00:52:21,832 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: PythonCodePrinter doesn't support Indexed 

Description: I use `lambdify()` to generate some functions and save the code for further use. But the generated code for `Indexed` operation has some warnings which can be confirmed by following code;

```
from sympy import *
p = IndexedBase("p")

pycode(p[0])
```
the output is 

```
  # Not supported in Python:
  # Indexed
p[0]
```

We should add following method to `PythonCodePrinter`:

```
def _print_Indexed(self, expr):
    base, *index = expr.args
    return "{}[{}]".format(str(base), ", ".join([self._print(ind) for ind in index]))
```

Patch information:
diff --git a/sympy/printing/pycode.py b/sympy/printing/pycode.py
index a3f0310735..8f7125e8eb 100644
--- a/sympy/printing/pycode.py
+++ b/sympy/printing/pycode.py
@@ -357,6 +357,17 @@ def _print_Not(self, expr):
         PREC = precedence(expr)
         return self._operators['not'] + self.parenthesize(expr.args[0], PREC)
 
+    def _print_Indexed(self, expr):
+        base = expr.base
+        indices = expr.indices
+        return "%s[%s]" % (self._print(base), ", ".join(self._print(ind) for ind in indices))
+
+    def _print_Idx(self, expr):
+        return self._print(expr.label)
+
+    def _print_IndexedBase(self, expr):
+        return self._print(expr.label)
+
 
 for k in PythonCodePrinter._kf:
     setattr(PythonCodePrinter, '_print_%s' % k, _print_known_func)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file sympy/printing/tests/test_pycode.py.
Extra Requirements: 
Purpose: I need to inspect the test file for `pycode` to find existing tests that handle similar structures or code printing scenarios, which will help in identifying the most relevant examples for the user's bug report.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/printing/tests/test_pycode.py
Line number range: 1 - 98
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import absolute_import
3. 
4. from sympy.codegen import Assignment
5. from sympy.codegen.ast import none
6. from sympy.core import Expr, Mod, symbols, Eq, Le, Gt, zoo, oo, Rational
7. from sympy.core.numbers import pi
8. from sympy.functions import acos, Piecewise, sign
9. from sympy.logic import And, Or
10. from sympy.matrices import SparseMatrix, MatrixSymbol
11. from sympy.printing.pycode import (
12.     MpmathPrinter, NumPyPrinter, PythonCodePrinter, pycode, SciPyPrinter
13. )
14. from sympy.utilities.pytest import raises
15. 
16. x, y, z = symbols('x y z')
17. 
18. 
19. def test_PythonCodePrinter():
20.     prntr = PythonCodePrinter()
21.     assert not prntr.module_imports
22.     assert prntr.doprint(x**y) == 'x**y'
23.     assert prntr.doprint(Mod(x, 2)) == 'x % 2'
24.     assert prntr.doprint(And(x, y)) == 'x and y'
25.     assert prntr.doprint(Or(x, y)) == 'x or y'
26.     assert not prntr.module_imports
27.     assert prntr.doprint(pi) == 'math.pi'
28.     assert prntr.module_imports == {'math': {'pi'}}
29.     assert prntr.doprint(acos(x)) == 'math.acos(x)'
30.     assert prntr.doprint(Assignment(x, 2)) == 'x = 2'
31.     assert prntr.doprint(Piecewise((1, Eq(x, 0)),
32.                         (2, x>6))) == '((1) if (x == 0) else (2) if (x > 6) else None)'
33.     assert prntr.doprint(Piecewise((2, Le(x, 0)),
34.                         (3, Gt(x, 0)), evaluate=False)) == '((2) if (x <= 0) else'\
35.                                                         ' (3) if (x > 0) else None)'
36.     assert prntr.doprint(sign(x)) == '(0.0 if x == 0 else math.copysign(1, x))'
37. 
38. 
39. def test_MpmathPrinter():
40.     p = MpmathPrinter()
41.     assert p.doprint(sign(x)) == 'mpmath.sign(x)'
42.     assert p.doprint(Rational(1, 2)) == 'mpmath.mpf(1)/mpmath.mpf(2)'
43. 
44. def test_NumPyPrinter():
45.     p = NumPyPrinter()
46.     assert p.doprint(sign(x)) == 'numpy.sign(x)'
47.     A = MatrixSymbol("A", 2, 2)
48.     assert p.doprint(A**(-1)) == "numpy.linalg.inv(A)"
49.     assert p.doprint(A**5) == "numpy.linalg.matrix_power(A, 5)"
50. 
51. 
52. def test_SciPyPrinter():
53.     p = SciPyPrinter()
54.     expr = acos(x)
55.     assert 'numpy' not in p.module_imports
56.     assert p.doprint(expr) == 'numpy.arccos(x)'
57.     assert 'numpy' in p.module_imports
58.     assert not any(m.startswith('scipy') for m in p.module_imports)
59.     smat = SparseMatrix(2, 5, {(0, 1): 3})
60.     assert p.doprint(smat) == 'scipy.sparse.coo_matrix([3], ([0], [1]), shape=(2, 5))'
61.     assert 'scipy.sparse' in p.module_imports
62. 
63. 
64. def test_pycode_reserved_words():
65.     s1, s2 = symbols('if else')
66.     raises(ValueError, lambda: pycode(s1 + s2, error_on_reserved=True))
67.     py_str = pycode(s1 + s2)
68.     assert py_str in ('else_ + if_', 'if_ + else_')
69. 
70. 
71. class CustomPrintedObject(Expr):
72.     def _numpycode(self, printer):
73.         return 'numpy'
74. 
75.     def _mpmathcode(self, printer):
76.         return 'mpmath'
77. 
78. 
79. def test_printmethod():
80.     obj = CustomPrintedObject()
81.     assert NumPyPrinter().doprint(obj) == 'numpy'
82.     assert MpmathPrinter().doprint(obj) == 'mpmath'
83. 
84. 
85. def test_codegen_ast_nodes():
86.     assert pycode(none) == 'None'
87. 
88. 
89. def test_issue_14283():
90.     prntr = PythonCodePrinter()
91. 
92.     assert prntr.doprint(zoo) == "float('nan')"
93.     assert prntr.doprint(-oo) == "float('-inf')"
94. 
95. def test_NumPyPrinter_print_seq():
96.     n = NumPyPrinter()
97. 
98.     assert n._print_seq(range(2)) == '(0, 1,)'

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 00:52:38,298 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The current context from `sympy/printing/tests/test_pycode.py` lacks test cases for `Indexed` objects, which are central to the reported bug. To find relevant examples, it is necessary to examine tests for `lambdify`, a function that uses `pycode` and is likely to have tests covering `Indexed` expressions.' query='Please provide the full content of the file sympy/utilities/tests/test_lambdify.py.' extra_requirements='' purpose='This file is expected to contain test cases for `lambdify` with `Indexed` objects, which will serve as relevant examples for fixing the `PythonCodePrinter` bug.'
2025-12-23 00:52:38,299 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file sympy/utilities/tests/test_lambdify.py.
2025-12-23 00:52:38,299 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 00:52:38,300 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 00:52:38,300 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 00:52:38,300 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file sympy/utilities/tests/test_lambdify.py.
Purpose: This file is expected to contain test cases for `lambdify` with `Indexed` objects, which will serve as relevant examples for fixing the `PythonCodePrinter` bug.
2025-12-23 00:52:41,367 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of the file `sympy/utilities/tests/test_lambdify.py` as requested. This file contains numerous test cases for the `lambdify` function, including those involving `Indexed` objects, which will be helpful for understanding the context of the bug.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/utilities/tests/test_lambdify.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2116, 'candidates_token_count': 89, 'total_token_count': 2332, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2116}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 89}], 'thoughts_token_count': 127, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12666723701391328, 'model_name': 'gemini-2.5-pro'} id='run--cda298ea-e123-4602-bb02-df3d0c5f52aa-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/utilities/tests/test_lambdify.py'}, 'id': '833ded5b-94dd-41fe-a81d-ac73f53283c7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2116, 'output_tokens': 89, 'total_tokens': 2332, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 127}}
2025-12-23 00:52:44,307 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "sympy/utilities/tests/test_lambdify.py"}'}, '__gemini_function_call_thought_signatures__': {'5604cfcd-f06a-4dad-8fef-28d099484777': 'CvwEAY89a18Qpz6ZC0yXgNRm5IRIw1zz3kglCTYCqhf1YlweLiciuzthp6+TRhGgqKHtAKCVWyvWbmQpyaiulZfNYCyt0xXG5Ktdupe9aXKaFK+cP0UMyjW8s+naN6ddNosppFJHHbtBodHk+sXLpEdpawvDWY0P2i4sTSwU8fgJQ1Iasq4EBZu7m6VEx5Eah2lXn771+93sAYdc11+nZUXbAzrnNWTZC9RbTAhtQhkulXdzWe+y5aDo68rwzOvhf0qW2HyFOoIVgDfGkOlYPSTQdR2n0kyrcd1liYXdI8I1qBA82rYpYoraYJe3Yo2OjjLhUOJSnOsutcQ6RRz7ScNAj5L+oignRZ5yNDf+eta3VJY2r0YYvmjBrO7ikjD1uXlPuep47GZWqv9fDiHdGFR6utC3r9G4JG0/Xa+sUTyIvybos+ACppDOATDU5c1i7rOhnXeZnB+okoU4tQyF00kCd1AlYtayjOOzNKUqJAv9cgNfebQ+h30HFZv9PZs90ZzrnNe5hwvQ5QL9eByKvKoyulHu/OOnYP4VdfLXjp7ynGx/cTmNoCdZPwieh1tzMtiK6A9ZQZ6EMkrijHoHE5Cbh+3rMpd1RzCM1gvMItGYOjk/p0GOkEphTKurR83w5xyEa3I6V/IOsaCVAJYoiOtc70XNj6X+q+5oaIjorKxj+lRLC+WWlkHUJTmHRoR/ggdwvQdqRw4xM8zv1/fgK8IsH6XuXOpSEgVYAPpczEwj55AlzGSnDZMtD9Eng6GBUD3wIJAYOsrE7wJDNUuqn5uc+3gOv4+RMecmF7gLlPdz8ydcVXEkvb9Qn14bdi7Cv8oPiG9F1JXHPzz/rCgN'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10529, 'candidates_token_count': 27, 'total_token_count': 10720, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10529}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 164, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.43311716009069373, 'model_name': 'gemini-2.5-pro'} id='run--4e113e12-e64b-43d4-9315-b1b982d3fa24-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'sympy/utilities/tests/test_lambdify.py'}, 'id': '5604cfcd-f06a-4dad-8fef-28d099484777', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10529, 'output_tokens': 27, 'total_tokens': 10720, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 164}}
2025-12-23 00:52:46,920 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "sympy/utilities/tests/test_lambdify.py", "start_line": 501.0, "end_line": 2000.0}'}, '__gemini_function_call_thought_signatures__': {'453c6cb7-d947-49ba-a6df-42051d7de394': 'CogEAY89a19r9KcgnO55u6PUXBpNvxs7xFPay8BVw8r7SPUOQ4+gHnviaJ9u8iZ+X0F66sDwHLh1iFArguG67hEdLwA1kMta1A3zrig7d7GsR0jzWXwZ2SMlcESNQHtbl8GqjZ2pxr7TGOa13mX3wCTaLh0HgZvN2rboVHYytyzHmWapnu51qE3sk86v13awTq2o3oBv2xltFDa40SB4jCq7h946khZ5O5bh8XhRurzD4tYXRPvGEI2lT1q9RRd6UA1mJJRp4kNPem1yPIQunn5OZxTGecVJ2ZMHNhNSPRyWuR/LSseK4CMIbIjmk3fbWeOj5X3ym/05DiuRDP1YNJ3qXzC30WW5gVUtYsJ4kmCEth+Qvoq559VHV9hVaLOaol1hqZ9ffmumm92NteRv9IZN+tzdSltMzQK8j4eCat8DAtw5xFr17E6ujceh7B6OKAVfJmkPndiAro+6rXCluf6aFc5u2araJPifAnCXL3d6qH6X3Z+LLkxkCMVT5OjFe09HmClbPWErME+jZdL3+gKAM0+T9UBkCbSPbs1s8CSpzdRDwPAo3eFAuHoHvsZGxzPSYlNQTUC6dmk1ZNbUzy6LLwTEL8p3NmcMh2EUrAmLBaieifU2mxacY6RLzFNBGMW9twT7tFjGxSmtQHVnS+KvOeAdSavdijsQ4lD3GVplyUf5CEtdMp1VeA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10621, 'candidates_token_count': 33, 'total_token_count': 10798, 'cached_content_token_count': 9348, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10785}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9348}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 33}], 'thoughts_token_count': 144}, 'finish_reason': 'STOP', 'avg_logprobs': -0.30354973764130566, 'model_name': 'gemini-2.5-pro'} id='run--a58ee628-892e-4f51-ad87-ddfec984d358-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'sympy/utilities/tests/test_lambdify.py', 'start_line': 501.0, 'end_line': 2000.0}, 'id': '453c6cb7-d947-49ba-a6df-42051d7de394', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10621, 'output_tokens': 33, 'total_tokens': 10798, 'input_token_details': {'cache_read': 9348}, 'output_token_details': {'reasoning': 144}}
2025-12-23 00:52:49,366 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the file `sympy/utilities/tests/test_lambdify.py`. The file was read in two parts and has been combined to provide the complete source code, which will be useful for understanding the test cases related to the `lambdify` function and its interaction with `Indexed` objects.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22653, 'candidates_token_count': 70, 'total_token_count': 22817, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22961}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 70}], 'thoughts_token_count': 94, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1813453129359654, 'model_name': 'gemini-2.5-pro'} id='run--45298dcd-7659-4bae-be39-23711c63b759-0' usage_metadata={'input_tokens': 22653, 'output_tokens': 70, 'total_tokens': 22817, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 94}}
2025-12-23 00:52:49,368 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file sympy/utilities/tests/test_lambdify.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file is expected to contain test cases for `lambdify` with `Indexed` objects, which will serve as relevant examples for fixing the `PythonCodePrinter` bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/utilities/tests/test_lambdify.py
Line number range: 1 - 500
Content:
1. from distutils.version import LooseVersion as V
2. from itertools import product
3. import math
4. import inspect
5. 
6. import mpmath
7. from sympy.utilities.pytest import XFAIL, raises
8. from sympy import (
9.     symbols, lambdify, sqrt, sin, cos, tan, pi, acos, acosh, Rational,
10.     Float, Matrix, Lambda, Piecewise, exp, Integral, oo, I, Abs, Function,
11.     true, false, And, Or, Not, ITE, Min, Max, floor, diff, IndexedBase, Sum,
12.     DotProduct, Eq, Dummy, sinc, erf, erfc, factorial, gamma, loggamma,
13.     digamma, RisingFactorial, besselj, bessely, besseli, besselk, S,
14.     MatrixSymbol, chebyshevt, chebyshevu, legendre, hermite, laguerre,
15.     gegenbauer, assoc_legendre, assoc_laguerre, jacobi)
16. from sympy.printing.lambdarepr import LambdaPrinter
17. from sympy.printing.pycode import NumPyPrinter
18. from sympy.utilities.lambdify import implemented_function, lambdastr
19. from sympy.utilities.pytest import skip
20. from sympy.utilities.decorator import conserve_mpmath_dps
21. from sympy.external import import_module
22. from sympy.functions.special.gamma_functions import uppergamma,lowergamma
23. 
24. import sympy
25. 
26. 
27. MutableDenseMatrix = Matrix
28. 
29. numpy = import_module('numpy')
30. scipy = import_module('scipy')
31. scipy_special = import_module('scipy.special')
32. numexpr = import_module('numexpr')
33. tensorflow = import_module('tensorflow')
34. 
35. if tensorflow:
36.     # Hide Tensorflow warnings
37.     import os
38.     os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
39. 
40. w, x, y, z = symbols('w,x,y,z')
41. 
42. #================== Test different arguments =======================
43. 
44. 
45. def test_no_args():
46.     f = lambdify([], 1)
47.     raises(TypeError, lambda: f(-1))
48.     assert f() == 1
49. 
50. 
51. def test_single_arg():
52.     f = lambdify(x, 2*x)
53.     assert f(1) == 2
54. 
55. 
56. def test_list_args():
57.     f = lambdify([x, y], x + y)
58.     assert f(1, 2) == 3
59. 
60. 
61. def test_nested_args():
62.     f1 = lambdify([[w, x]], [w, x])
63.     assert f1([91, 2]) == [91, 2]
64.     raises(TypeError, lambda: f1(1, 2))
65. 
66.     f2 = lambdify([(w, x), (y, z)], [w, x, y, z])
67.     assert f2((18, 12), (73, 4)) == [18, 12, 73, 4]
68.     raises(TypeError, lambda: f2(3, 4))
69. 
70.     f3 = lambdify([w, [[[x]], y], z], [w, x, y, z])
71.     assert f3(10, [[[52]], 31], 44) == [10, 52, 31, 44]
72. 
73. 
74. def test_str_args():
75.     f = lambdify('x,y,z', 'z,y,x')
76.     assert f(3, 2, 1) == (1, 2, 3)
77.     assert f(1.0, 2.0, 3.0) == (3.0, 2.0, 1.0)
78.     # make sure correct number of args required
79.     raises(TypeError, lambda: f(0))
80. 
81. 
82. def test_own_namespace_1():
83.     myfunc = lambda x: 1
84.     f = lambdify(x, sin(x), {"sin": myfunc})
85.     assert f(0.1) == 1
86.     assert f(100) == 1
87. 
88. 
89. def test_own_namespace_2():
90.     def myfunc(x):
91.         return 1
92.     f = lambdify(x, sin(x), {'sin': myfunc})
93.     assert f(0.1) == 1
94.     assert f(100) == 1
95. 
96. 
97. def test_own_module():
98.     f = lambdify(x, sin(x), math)
99.     assert f(0) == 0.0
100. 
101. 
102. def test_bad_args():
103.     # no vargs given
104.     raises(TypeError, lambda: lambdify(1))
105.     # same with vector exprs
106.     raises(TypeError, lambda: lambdify([1, 2]))
107. 
108. 
109. def test_atoms():
110.     # Non-Symbol atoms should not be pulled out from the expression namespace
111.     f = lambdify(x, pi + x, {"pi": 3.14})
112.     assert f(0) == 3.14
113.     f = lambdify(x, I + x, {"I": 1j})
114.     assert f(1) == 1 + 1j
115. 
116. #================== Test different modules =========================
117. 
118. # high precision output of sin(0.2*pi) is used to detect if precision is lost unwanted
119. 
120. 
121. @conserve_mpmath_dps
122. def test_sympy_lambda():
123.     mpmath.mp.dps = 50
124.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
125.     f = lambdify(x, sin(x), "sympy")
126.     assert f(x) == sin(x)
127.     prec = 1e-15
128.     assert -prec < f(Rational(1, 5)).evalf() - Float(str(sin02)) < prec
129.     # arctan is in numpy module and should not be available
130.     raises(NameError, lambda: lambdify(x, arctan(x), "sympy"))
131. 
132. 
133. @conserve_mpmath_dps
134. def test_math_lambda():
135.     mpmath.mp.dps = 50
136.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
137.     f = lambdify(x, sin(x), "math")
138.     prec = 1e-15
139.     assert -prec < f(0.2) - sin02 < prec
140.     raises(TypeError, lambda: f(x))
141.            # if this succeeds, it can't be a python math function
142. 
143. 
144. @conserve_mpmath_dps
145. def test_mpmath_lambda():
146.     mpmath.mp.dps = 50
147.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
148.     f = lambdify(x, sin(x), "mpmath")
149.     prec = 1e-49  # mpmath precision is around 50 decimal places
150.     assert -prec < f(mpmath.mpf("0.2")) - sin02 < prec
151.     raises(TypeError, lambda: f(x))
152.            # if this succeeds, it can't be a mpmath function
153. 
154. 
155. @conserve_mpmath_dps
156. def test_number_precision():
157.     mpmath.mp.dps = 50
158.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
159.     f = lambdify(x, sin02, "mpmath")
160.     prec = 1e-49  # mpmath precision is around 50 decimal places
161.     assert -prec < f(0) - sin02 < prec
162. 
163. @conserve_mpmath_dps
164. def test_mpmath_precision():
165.     mpmath.mp.dps = 100
166.     assert str(lambdify((), pi.evalf(100), 'mpmath')()) == str(pi.evalf(100))
167. 
168. #================== Test Translations ==============================
169. # We can only check if all translated functions are valid. It has to be checked
170. # by hand if they are complete.
171. 
172. 
173. def test_math_transl():
174.     from sympy.utilities.lambdify import MATH_TRANSLATIONS
175.     for sym, mat in MATH_TRANSLATIONS.items():
176.         assert sym in sympy.__dict__
177.         assert mat in math.__dict__
178. 
179. 
180. def test_mpmath_transl():
181.     from sympy.utilities.lambdify import MPMATH_TRANSLATIONS
182.     for sym, mat in MPMATH_TRANSLATIONS.items():
183.         assert sym in sympy.__dict__ or sym == 'Matrix'
184.         assert mat in mpmath.__dict__
185. 
186. 
187. def test_numpy_transl():
188.     if not numpy:
189.         skip("numpy not installed.")
190. 
191.     from sympy.utilities.lambdify import NUMPY_TRANSLATIONS
192.     for sym, nump in NUMPY_TRANSLATIONS.items():
193.         assert sym in sympy.__dict__
194.         assert nump in numpy.__dict__
195. 
196. 
197. def test_scipy_transl():
198.     if not scipy:
199.         skip("scipy not installed.")
200. 
201.     from sympy.utilities.lambdify import SCIPY_TRANSLATIONS
202.     for sym, scip in SCIPY_TRANSLATIONS.items():
203.         assert sym in sympy.__dict__
204.         assert scip in scipy.__dict__ or scip in scipy.special.__dict__
205. 
206. 
207. def test_tensorflow_transl():
208.     if not tensorflow:
209.         skip("tensorflow not installed")
210. 
211.     from sympy.utilities.lambdify import TENSORFLOW_TRANSLATIONS
212.     for sym, tens in TENSORFLOW_TRANSLATIONS.items():
213.         assert sym in sympy.__dict__
214.         assert tens in tensorflow.__dict__
215. 
216. 
217. def test_numpy_translation_abs():
218.     if not numpy:
219.         skip("numpy not installed.")
220. 
221.     f = lambdify(x, Abs(x), "numpy")
222.     assert f(-1) == 1
223.     assert f(1) == 1
224. 
225. 
226. def test_numexpr_printer():
227.     if not numexpr:
228.         skip("numexpr not installed.")
229. 
230.     # if translation/printing is done incorrectly then evaluating
231.     # a lambdified numexpr expression will throw an exception
232.     from sympy.printing.lambdarepr import NumExprPrinter
233. 
234.     blacklist = ('where', 'complex', 'contains')
235.     arg_tuple = (x, y, z) # some functions take more than one argument
236.     for sym in NumExprPrinter._numexpr_functions.keys():
237.         if sym in blacklist:
238.             continue
239.         ssym = S(sym)
240.         if hasattr(ssym, '_nargs'):
241.             nargs = ssym._nargs[0]
242.         else:
243.             nargs = 1
244.         args = arg_tuple[:nargs]
245.         f = lambdify(args, ssym(*args), modules='numexpr')
246.         assert f(*(1, )*nargs) is not None
247. 
248. 
249. def test_issue_9334():
250.     if not numexpr:
251.         skip("numexpr not installed.")
252.     if not numpy:
253.         skip("numpy not installed.")
254.     expr = S('b*a - sqrt(a**2)')
255.     a, b = sorted(expr.free_symbols, key=lambda s: s.name)
256.     func_numexpr = lambdify((a,b), expr, modules=[numexpr], dummify=False)
257.     foo, bar = numpy.random.random((2, 4))
258.     func_numexpr(foo, bar)
259. 
260. #================== Test some functions ============================
261. 
262. 
263. def test_exponentiation():
264.     f = lambdify(x, x**2)
265.     assert f(-1) == 1
266.     assert f(0) == 0
267.     assert f(1) == 1
268.     assert f(-2) == 4
269.     assert f(2) == 4
270.     assert f(2.5) == 6.25
271. 
272. 
273. def test_sqrt():
274.     f = lambdify(x, sqrt(x))
275.     assert f(0) == 0.0
276.     assert f(1) == 1.0
277.     assert f(4) == 2.0
278.     assert abs(f(2) - 1.414) < 0.001
279.     assert f(6.25) == 2.5
280. 
281. 
282. def test_trig():
283.     f = lambdify([x], [cos(x), sin(x)], 'math')
284.     d = f(pi)
285.     prec = 1e-11
286.     assert -prec < d[0] + 1 < prec
287.     assert -prec < d[1] < prec
288.     d = f(3.14159)
289.     prec = 1e-5
290.     assert -prec < d[0] + 1 < prec
291.     assert -prec < d[1] < prec
292. 
293. #================== Test vectors ===================================
294. 
295. 
296. def test_vector_simple():
297.     f = lambdify((x, y, z), (z, y, x))
298.     assert f(3, 2, 1) == (1, 2, 3)
299.     assert f(1.0, 2.0, 3.0) == (3.0, 2.0, 1.0)
300.     # make sure correct number of args required
301.     raises(TypeError, lambda: f(0))
302. 
303. 
304. def test_vector_discontinuous():
305.     f = lambdify(x, (-1/x, 1/x))
306.     raises(ZeroDivisionError, lambda: f(0))
307.     assert f(1) == (-1.0, 1.0)
308.     assert f(2) == (-0.5, 0.5)
309.     assert f(-2) == (0.5, -0.5)
310. 
311. 
312. def test_trig_symbolic():
313.     f = lambdify([x], [cos(x), sin(x)], 'math')
314.     d = f(pi)
315.     assert abs(d[0] + 1) < 0.0001
316.     assert abs(d[1] - 0) < 0.0001
317. 
318. 
319. def test_trig_float():
320.     f = lambdify([x], [cos(x), sin(x)])
321.     d = f(3.14159)
322.     assert abs(d[0] + 1) < 0.0001
323.     assert abs(d[1] - 0) < 0.0001
324. 
325. 
326. def test_docs():
327.     f = lambdify(x, x**2)
328.     assert f(2) == 4
329.     f = lambdify([x, y, z], [z, y, x])
330.     assert f(1, 2, 3) == [3, 2, 1]
331.     f = lambdify(x, sqrt(x))
332.     assert f(4) == 2.0
333.     f = lambdify((x, y), sin(x*y)**2)
334.     assert f(0, 5) == 0
335. 
336. 
337. def test_math():
338.     f = lambdify((x, y), sin(x), modules="math")
339.     assert f(0, 5) == 0
340. 
341. 
342. def test_sin():
343.     f = lambdify(x, sin(x)**2)
344.     assert isinstance(f(2), float)
345.     f = lambdify(x, sin(x)**2, modules="math")
346.     assert isinstance(f(2), float)
347. 
348. 
349. def test_matrix():
350.     A = Matrix([[x, x*y], [sin(z) + 4, x**z]])
351.     sol = Matrix([[1, 2], [sin(3) + 4, 1]])
352.     f = lambdify((x, y, z), A, modules="sympy")
353.     assert f(1, 2, 3) == sol
354.     f = lambdify((x, y, z), (A, [A]), modules="sympy")
355.     assert f(1, 2, 3) == (sol, [sol])
356.     J = Matrix((x, x + y)).jacobian((x, y))
357.     v = Matrix((x, y))
358.     sol = Matrix([[1, 0], [1, 1]])
359.     assert lambdify(v, J, modules='sympy')(1, 2) == sol
360.     assert lambdify(v.T, J, modules='sympy')(1, 2) == sol
361. 
362. 
363. def test_numpy_matrix():
364.     if not numpy:
365.         skip("numpy not installed.")
366.     A = Matrix([[x, x*y], [sin(z) + 4, x**z]])
367.     sol_arr = numpy.array([[1, 2], [numpy.sin(3) + 4, 1]])
368.     #Lambdify array first, to ensure return to array as default
369.     f = lambdify((x, y, z), A, ['numpy'])
370.     numpy.testing.assert_allclose(f(1, 2, 3), sol_arr)
371.     #Check that the types are arrays and matrices
372.     assert isinstance(f(1, 2, 3), numpy.ndarray)
373. 
374.     # gh-15071
375.     class dot(Function):
376.         pass
377.     x_dot_mtx = dot(x, Matrix([[2], [1], [0]]))
378.     f_dot1 = lambdify(x, x_dot_mtx)
379.     inp = numpy.zeros((17, 3))
380.     assert numpy.all(f_dot1(inp) == 0)
381. 
382.     strict_kw = dict(allow_unknown_functions=False, inline=True, fully_qualified_modules=False)
383.     p2 = NumPyPrinter(dict(user_functions={'dot': 'dot'}, **strict_kw))
384.     f_dot2 = lambdify(x, x_dot_mtx, printer=p2)
385.     assert numpy.all(f_dot2(inp) == 0)
386. 
387.     p3 = NumPyPrinter(strict_kw)
388.     # The line below should probably fail upon construction (before calling with "(inp)"):
389.     raises(Exception, lambda: lambdify(x, x_dot_mtx, printer=p3)(inp))
390. 
391. 
392. def test_numpy_transpose():
393.     if not numpy:
394.         skip("numpy not installed.")
395.     A = Matrix([[1, x], [0, 1]])
396.     f = lambdify((x), A.T, modules="numpy")
397.     numpy.testing.assert_array_equal(f(2), numpy.array([[1, 0], [2, 1]]))
398. 
399. 
400. def test_numpy_dotproduct():
401.     if not numpy:
402.         skip("numpy not installed")
403.     A = Matrix([x, y, z])
404.     f1 = lambdify([x, y, z], DotProduct(A, A), modules='numpy')
405.     f2 = lambdify([x, y, z], DotProduct(A, A.T), modules='numpy')
406.     f3 = lambdify([x, y, z], DotProduct(A.T, A), modules='numpy')
407.     f4 = lambdify([x, y, z], DotProduct(A, A.T), modules='numpy')
408. 
409.     assert f1(1, 2, 3) == \
410.            f2(1, 2, 3) == \
411.            f3(1, 2, 3) == \
412.            f4(1, 2, 3) == \
413.            numpy.array([14])
414. 
415. 
416. def test_numpy_inverse():
417.     if not numpy:
418.         skip("numpy not installed.")
419.     A = Matrix([[1, x], [0, 1]])
420.     f = lambdify((x), A**-1, modules="numpy")
421.     numpy.testing.assert_array_equal(f(2), numpy.array([[1, -2], [0,  1]]))
422. 
423. 
424. def test_numpy_old_matrix():
425.     if not numpy:
426.         skip("numpy not installed.")
427.     A = Matrix([[x, x*y], [sin(z) + 4, x**z]])
428.     sol_arr = numpy.array([[1, 2], [numpy.sin(3) + 4, 1]])
429.     f = lambdify((x, y, z), A, [{'ImmutableDenseMatrix': numpy.matrix}, 'numpy'])
430.     numpy.testing.assert_allclose(f(1, 2, 3), sol_arr)
431.     assert isinstance(f(1, 2, 3), numpy.matrix)
432. 
433. 
434. def test_python_div_zero_issue_11306():
435.     if not numpy:
436.         skip("numpy not installed.")
437.     p = Piecewise((1 / x, y < -1), (x, y < 1), (1 / x, True))
438.     f = lambdify([x, y], p, modules='numpy')
439.     numpy.seterr(divide='ignore')
440.     assert float(f(numpy.array([0]),numpy.array([0.5]))) == 0
441.     assert str(float(f(numpy.array([0]),numpy.array([1])))) == 'inf'
442.     numpy.seterr(divide='warn')
443. 
444. 
445. def test_issue9474():
446.     mods = [None, 'math']
447.     if numpy:
448.         mods.append('numpy')
449.     if mpmath:
450.         mods.append('mpmath')
451.     for mod in mods:
452.         f = lambdify(x, S(1)/x, modules=mod)
453.         assert f(2) == 0.5
454.         f = lambdify(x, floor(S(1)/x), modules=mod)
455.         assert f(2) == 0
456. 
457.     for absfunc, modules in product([Abs, abs], mods):
458.         f = lambdify(x, absfunc(x), modules=modules)
459.         assert f(-1) == 1
460.         assert f(1) == 1
461.         assert f(3+4j) == 5
462. 
463. 
464. def test_issue_9871():
465.     if not numexpr:
466.         skip("numexpr not installed.")
467.     if not numpy:
468.         skip("numpy not installed.")
469. 
470.     r = sqrt(x**2 + y**2)
471.     expr = diff(1/r, x)
472. 
473.     xn = yn = numpy.linspace(1, 10, 16)
474.     # expr(xn, xn) = -xn/(sqrt(2)*xn)^3
475.     fv_exact = -numpy.sqrt(2.)**-3 * xn**-2
476. 
477.     fv_numpy = lambdify((x, y), expr, modules='numpy')(xn, yn)
478.     fv_numexpr = lambdify((x, y), expr, modules='numexpr')(xn, yn)
479.     numpy.testing.assert_allclose(fv_numpy, fv_exact, rtol=1e-10)
480.     numpy.testing.assert_allclose(fv_numexpr, fv_exact, rtol=1e-10)
481. 
482. 
483. def test_numpy_piecewise():
484.     if not numpy:
485.         skip("numpy not installed.")
486.     pieces = Piecewise((x, x < 3), (x**2, x > 5), (0, True))
487.     f = lambdify(x, pieces, modules="numpy")
488.     numpy.testing.assert_array_equal(f(numpy.arange(10)),
489.                                      numpy.array([0, 1, 2, 0, 0, 0, 36, 49, 64, 81]))
490.     # If we evaluate somewhere all conditions are False, we should get back NaN
491.     nodef_func = lambdify(x, Piecewise((x, x > 0), (-x, x < 0)))
492.     numpy.testing.assert_array_equal(nodef_func(numpy.array([-1, 0, 1])),
493.                                      numpy.array([1, numpy.nan, 1]))
494. 
495. 
496. def test_numpy_logical_ops():
497.     if not numpy:
498.         skip("numpy not installed.")
499.     and_func = lambdify((x, y), And(x, y), modules="numpy")
500.     and_func_3 = lambdify((x, y, z), And(x, y, z), modules="numpy")


File: sympy/utilities/tests/test_lambdify.py
Line number range: 501 - 2000
Content:
501.     or_func = lambdify((x, y), Or(x, y), modules="numpy")
502.     or_func_3 = lambdify((x, y, z), Or(x, y, z), modules="numpy")
503.     not_func = lambdify((x), Not(x), modules="numpy")
504.     arr1 = numpy.array([True, True])
505.     arr2 = numpy.array([False, True])
506.     arr3 = numpy.array([True, False])
507.     numpy.testing.assert_array_equal(and_func(arr1, arr2), numpy.array([False, True]))
508.     numpy.testing.assert_array_equal(and_func_3(arr1, arr2, arr3), numpy.array([False, False]))
509.     numpy.testing.assert_array_equal(or_func(arr1, arr2), numpy.array([True, True]))
510.     numpy.testing.assert_array_equal(or_func_3(arr1, arr2, arr3), numpy.array([True, True]))
511.     numpy.testing.assert_array_equal(not_func(arr2), numpy.array([True, False]))
512. 
513. 
514. def test_numpy_matmul():
515.     if not numpy:
516.         skip("numpy not installed.")
517.     xmat = Matrix([[x, y], [z, 1+z]])
518.     ymat = Matrix([[x**2], [Abs(x)]])
519.     mat_func = lambdify((x, y, z), xmat*ymat, modules="numpy")
520.     numpy.testing.assert_array_equal(mat_func(0.5, 3, 4), numpy.array([[1.625], [3.5]]))
521.     numpy.testing.assert_array_equal(mat_func(-0.5, 3, 4), numpy.array([[1.375], [3.5]]))
522.     # Multiple matrices chained together in multiplication
523.     f = lambdify((x, y, z), xmat*xmat*xmat, modules="numpy")
524.     numpy.testing.assert_array_equal(f(0.5, 3, 4), numpy.array([[72.125, 119.25],
525.                                                                 [159, 251]]))
526. 
527. 
528. def test_numpy_numexpr():
529.     if not numpy:
530.         skip("numpy not installed.")
531.     if not numexpr:
532.         skip("numexpr not installed.")
533.     a, b, c = numpy.random.randn(3, 128, 128)
534.     # ensure that numpy and numexpr return same value for complicated expression
535.     expr = sin(x) + cos(y) + tan(z)**2 + Abs(z-y)*acos(sin(y*z)) + \
536.            Abs(y-z)*acosh(2+exp(y-x))- sqrt(x**2+I*y**2)
537.     npfunc = lambdify((x, y, z), expr, modules='numpy')
538.     nefunc = lambdify((x, y, z), expr, modules='numexpr')
539.     assert numpy.allclose(npfunc(a, b, c), nefunc(a, b, c))
540. 
541. 
542. def test_numexpr_userfunctions():
543.     if not numpy:
544.         skip("numpy not installed.")
545.     if not numexpr:
546.         skip("numexpr not installed.")
547.     a, b = numpy.random.randn(2, 10)
548.     uf = type('uf', (Function, ),
549.               {'eval' : classmethod(lambda x, y : y**2+1)})
550.     func = lambdify(x, 1-uf(x), modules='numexpr')
551.     assert numpy.allclose(func(a), -(a**2))
552. 
553.     uf = implemented_function(Function('uf'), lambda x, y : 2*x*y+1)
554.     func = lambdify((x, y), uf(x, y), modules='numexpr')
555.     assert numpy.allclose(func(a, b), 2*a*b+1)
556. 
557. 
558. def test_tensorflow_basic_math():
559.     if not tensorflow:
560.         skip("tensorflow not installed.")
561.     expr = Max(sin(x), Abs(1/(x+2)))
562.     func = lambdify(x, expr, modules="tensorflow")
563.     a = tensorflow.constant(0, dtype=tensorflow.float32)
564.     s = tensorflow.Session()
565.     assert func(a).eval(session=s) == 0.5
566. 
567. 
568. def test_tensorflow_placeholders():
569.     if not tensorflow:
570.         skip("tensorflow not installed.")
571.     expr = Max(sin(x), Abs(1/(x+2)))
572.     func = lambdify(x, expr, modules="tensorflow")
573.     a = tensorflow.placeholder(dtype=tensorflow.float32)
574.     s = tensorflow.Session()
575.     assert func(a).eval(session=s, feed_dict={a: 0}) == 0.5
576. 
577. 
578. def test_tensorflow_variables():
579.     if not tensorflow:
580.         skip("tensorflow not installed.")
581.     expr = Max(sin(x), Abs(1/(x+2)))
582.     func = lambdify(x, expr, modules="tensorflow")
583.     a = tensorflow.Variable(0, dtype=tensorflow.float32)
584.     s = tensorflow.Session()
585.     if V(tensorflow.__version__) < '1.0':
586.         s.run(tensorflow.initialize_all_variables())
587.     else:
588.         s.run(tensorflow.global_variables_initializer())
589.     assert func(a).eval(session=s) == 0.5
590. 
591. 
592. def test_tensorflow_logical_operations():
593.     if not tensorflow:
594.         skip("tensorflow not installed.")
595.     expr = Not(And(Or(x, y), y))
596.     func = lambdify([x, y], expr, modules="tensorflow")
597.     a = tensorflow.constant(False)
598.     b = tensorflow.constant(True)
599.     s = tensorflow.Session()
600.     assert func(a, b).eval(session=s) == 0
601. 
602. 
603. def test_tensorflow_piecewise():
604.     if not tensorflow:
605.         skip("tensorflow not installed.")
606.     expr = Piecewise((0, Eq(x,0)), (-1, x < 0), (1, x > 0))
607.     func = lambdify(x, expr, modules="tensorflow")
608.     a = tensorflow.placeholder(dtype=tensorflow.float32)
609.     s = tensorflow.Session()
610.     assert func(a).eval(session=s, feed_dict={a: -1}) == -1
611.     assert func(a).eval(session=s, feed_dict={a: 0}) == 0
612.     assert func(a).eval(session=s, feed_dict={a: 1}) == 1
613. 
614. 
615. def test_tensorflow_multi_max():
616.     if not tensorflow:
617.         skip("tensorflow not installed.")
618.     expr = Max(x, -x, x**2)
619.     func = lambdify(x, expr, modules="tensorflow")
620.     a = tensorflow.placeholder(dtype=tensorflow.float32)
621.     s = tensorflow.Session()
622.     assert func(a).eval(session=s, feed_dict={a: -2}) == 4
623. 
624. 
625. def test_tensorflow_multi_min():
626.     if not tensorflow:
627.         skip("tensorflow not installed.")
628.     expr = Min(x, -x, x**2)
629.     func = lambdify(x, expr, modules="tensorflow")
630.     a = tensorflow.placeholder(dtype=tensorflow.float32)
631.     s = tensorflow.Session()
632.     assert func(a).eval(session=s, feed_dict={a: -2}) == -2
633. 
634. 
635. def test_tensorflow_relational():
636.     if not tensorflow:
637.         skip("tensorflow not installed.")
638.     expr = x >= 0
639.     func = lambdify(x, expr, modules="tensorflow")
640.     a = tensorflow.placeholder(dtype=tensorflow.float32)
641.     s = tensorflow.Session()
642.     assert func(a).eval(session=s, feed_dict={a: 1})
643. 
644. 
645. def test_integral():
646.     f = Lambda(x, exp(-x**2))
647.     l = lambdify(x, Integral(f(x), (x, -oo, oo)), modules="sympy")
648.     assert l(x) == Integral(exp(-x**2), (x, -oo, oo))
649. 
650. #================== Test symbolic ==================================
651. 
652. 
653. def test_sym_single_arg():
654.     f = lambdify(x, x * y)
655.     assert f(z) == z * y
656. 
657. 
658. def test_sym_list_args():
659.     f = lambdify([x, y], x + y + z)
660.     assert f(1, 2) == 3 + z
661. 
662. 
663. def test_sym_integral():
664.     f = Lambda(x, exp(-x**2))
665.     l = lambdify(x, Integral(f(x), (x, -oo, oo)), modules="sympy")
666.     assert l(y).doit() == sqrt(pi)
667. 
668. 
669. def test_namespace_order():
670.     # lambdify had a bug, such that module dictionaries or cached module
671.     # dictionaries would pull earlier namespaces into themselves.
672.     # Because the module dictionaries form the namespace of the
673.     # generated lambda, this meant that the behavior of a previously
674.     # generated lambda function could change as a result of later calls
675.     # to lambdify.
676.     n1 = {'f': lambda x: 'first f'}
677.     n2 = {'f': lambda x: 'second f',
678.           'g': lambda x: 'function g'}
679.     f = sympy.Function('f')
680.     g = sympy.Function('g')
681.     if1 = lambdify(x, f(x), modules=(n1, "sympy"))
682.     assert if1(1) == 'first f'
683.     if2 = lambdify(x, g(x), modules=(n2, "sympy"))
684.     # previously gave 'second f'
685.     assert if1(1) == 'first f'
686. 
687. 
688. def test_namespace_type():
689.     # lambdify had a bug where it would reject modules of type unicode
690.     # on Python 2.
691.     x = sympy.Symbol('x')
692.     lambdify(x, x, modules=u'math')
693. 
694. 
695. def test_imps():
696.     # Here we check if the default returned functions are anonymous - in
697.     # the sense that we can have more than one function with the same name
698.     f = implemented_function('f', lambda x: 2*x)
699.     g = implemented_function('f', lambda x: math.sqrt(x))
700.     l1 = lambdify(x, f(x))
701.     l2 = lambdify(x, g(x))
702.     assert str(f(x)) == str(g(x))
703.     assert l1(3) == 6
704.     assert l2(3) == math.sqrt(3)
705.     # check that we can pass in a Function as input
706.     func = sympy.Function('myfunc')
707.     assert not hasattr(func, '_imp_')
708.     my_f = implemented_function(func, lambda x: 2*x)
709.     assert hasattr(my_f, '_imp_')
710.     # Error for functions with same name and different implementation
711.     f2 = implemented_function("f", lambda x: x + 101)
712.     raises(ValueError, lambda: lambdify(x, f(f2(x))))
713. 
714. 
715. def test_imps_errors():
716.     # Test errors that implemented functions can return, and still be able to
717.     # form expressions.
718.     # See: https://github.com/sympy/sympy/issues/10810
719.     #
720.     # XXX: Removed AttributeError here. This test was added due to issue 10810
721.     # but that issue was about ValueError. It doesn't seem reasonable to
722.     # "support" catching AttributeError in the same context...
723.     for val, error_class in product((0, 0., 2, 2.0), (TypeError, ValueError)):
724. 
725.         def myfunc(a):
726.             if a == 0:
727.                 raise error_class
728.             return 1
729. 
730.         f = implemented_function('f', myfunc)
731.         expr = f(val)
732.         assert expr == f(val)
733. 
734. 
735. def test_imps_wrong_args():
736.     raises(ValueError, lambda: implemented_function(sin, lambda x: x))
737. 
738. 
739. def test_lambdify_imps():
740.     # Test lambdify with implemented functions
741.     # first test basic (sympy) lambdify
742.     f = sympy.cos
743.     assert lambdify(x, f(x))(0) == 1
744.     assert lambdify(x, 1 + f(x))(0) == 2
745.     assert lambdify((x, y), y + f(x))(0, 1) == 2
746.     # make an implemented function and test
747.     f = implemented_function("f", lambda x: x + 100)
748.     assert lambdify(x, f(x))(0) == 100
749.     assert lambdify(x, 1 + f(x))(0) == 101
750.     assert lambdify((x, y), y + f(x))(0, 1) == 101
751.     # Can also handle tuples, lists, dicts as expressions
752.     lam = lambdify(x, (f(x), x))
753.     assert lam(3) == (103, 3)
754.     lam = lambdify(x, [f(x), x])
755.     assert lam(3) == [103, 3]
756.     lam = lambdify(x, [f(x), (f(x), x)])
757.     assert lam(3) == [103, (103, 3)]
758.     lam = lambdify(x, {f(x): x})
759.     assert lam(3) == {103: 3}
760.     lam = lambdify(x, {f(x): x})
761.     assert lam(3) == {103: 3}
762.     lam = lambdify(x, {x: f(x)})
763.     assert lam(3) == {3: 103}
764.     # Check that imp preferred to other namespaces by default
765.     d = {'f': lambda x: x + 99}
766.     lam = lambdify(x, f(x), d)
767.     assert lam(3) == 103
768.     # Unless flag passed
769.     lam = lambdify(x, f(x), d, use_imps=False)
770.     assert lam(3) == 102
771. 
772. 
773. def test_dummification():
774.     t = symbols('t')
775.     F = Function('F')
776.     G = Function('G')
777.     #"\alpha" is not a valid python variable name
778.     #lambdify should sub in a dummy for it, and return
779.     #without a syntax error
780.     alpha = symbols(r'\alpha')
781.     some_expr = 2 * F(t)**2 / G(t)
782.     lam = lambdify((F(t), G(t)), some_expr)
783.     assert lam(3, 9) == 2
784.     lam = lambdify(sin(t), 2 * sin(t)**2)
785.     assert lam(F(t)) == 2 * F(t)**2
786.     #Test that \alpha was properly dummified
787.     lam = lambdify((alpha, t), 2*alpha + t)
788.     assert lam(2, 1) == 5
789.     raises(SyntaxError, lambda: lambdify(F(t) * G(t), F(t) * G(t) + 5))
790.     raises(SyntaxError, lambda: lambdify(2 * F(t), 2 * F(t) + 5))
791.     raises(SyntaxError, lambda: lambdify(2 * F(t), 4 * F(t) + 5))
792. 
793. 
794. def test_curly_matrix_symbol():
795.     # Issue #15009
796.     curlyv = sympy.MatrixSymbol("{v}", 2, 1)
797.     lam = lambdify(curlyv, curlyv)
798.     assert lam(1)==1
799.     lam = lambdify(curlyv, curlyv, dummify=True)
800.     assert lam(1)==1
801. 
802. 
803. def test_python_keywords():
804.     # Test for issue 7452. The automatic dummification should ensure use of
805.     # Python reserved keywords as symbol names will create valid lambda
806.     # functions. This is an additional regression test.
807.     python_if = symbols('if')
808.     expr = python_if / 2
809.     f = lambdify(python_if, expr)
810.     assert f(4.0) == 2.0
811. 
812. 
813. def test_lambdify_docstring():
814.     func = lambdify((w, x, y, z), w + x + y + z)
815.     ref = (
816.         "Created with lambdify. Signature:\n\n"
817.         "func(w, x, y, z)\n\n"
818.         "Expression:\n\n"
819.         "w + x + y + z"
820.     ).splitlines()
821.     assert func.__doc__.splitlines()[:len(ref)] == ref
822.     syms = symbols('a1:26')
823.     func = lambdify(syms, sum(syms))
824.     ref = (
825.         "Created with lambdify. Signature:\n\n"
826.         "func(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14, a15,\n"
827.         "        a16, a17, a18, a19, a20, a21, a22, a23, a24, a25)\n\n"
828.         "Expression:\n\n"
829.         "a1 + a10 + a11 + a12 + a13 + a14 + a15 + a16 + a17 + a18 + a19 + a2 + a20 +..."
830.     ).splitlines()
831.     assert func.__doc__.splitlines()[:len(ref)] == ref
832. 
833. 
834. #================== Test special printers ==========================
835. 
836. 
837. def test_special_printers():
838.     class IntervalPrinter(LambdaPrinter):
839.         """Use ``lambda`` printer but print numbers as ``mpi`` intervals. """
840. 
841.         def _print_Integer(self, expr):
842.             return "mpi('%s')" % super(IntervalPrinter, self)._print_Integer(expr)
843. 
844.         def _print_Rational(self, expr):
845.             return "mpi('%s')" % super(IntervalPrinter, self)._print_Rational(expr)
846. 
847.     def intervalrepr(expr):
848.         return IntervalPrinter().doprint(expr)
849. 
850.     expr = sqrt(sqrt(2) + sqrt(3)) + S(1)/2
851. 
852.     func0 = lambdify((), expr, modules="mpmath", printer=intervalrepr)
853.     func1 = lambdify((), expr, modules="mpmath", printer=IntervalPrinter)
854.     func2 = lambdify((), expr, modules="mpmath", printer=IntervalPrinter())
855. 
856.     mpi = type(mpmath.mpi(1, 2))
857. 
858.     assert isinstance(func0(), mpi)
859.     assert isinstance(func1(), mpi)
860.     assert isinstance(func2(), mpi)
861. 
862. 
863. def test_true_false():
864.     # We want exact is comparison here, not just ==
865.     assert lambdify([], true)() is True
866.     assert lambdify([], false)() is False
867. 
868. 
869. def test_issue_2790():
870.     assert lambdify((x, (y, z)), x + y)(1, (2, 4)) == 3
871.     assert lambdify((x, (y, (w, z))), w + x + y + z)(1, (2, (3, 4))) == 10
872.     assert lambdify(x, x + 1, dummify=False)(1) == 2
873. 
874. 
875. def test_issue_12092():
876.     f = implemented_function('f', lambda x: x**2)
877.     assert f(f(2)).evalf() == Float(16)
878. 
879. 
880. def test_issue_14911():
881.     class Variable(sympy.Symbol):
882.         def _sympystr(self, printer):
883.             return printer.doprint(self.name)
884. 
885.         _lambdacode = _sympystr
886.         _numpycode = _sympystr
887. 
888.     x = Variable('x')
889.     y = 2 * x
890.     code = LambdaPrinter().doprint(y)
891.     assert code.replace(' ', '') == '2*x'
892. 
893. 
894. def test_ITE():
895.     assert lambdify((x, y, z), ITE(x, y, z))(True, 5, 3) == 5
896.     assert lambdify((x, y, z), ITE(x, y, z))(False, 5, 3) == 3
897. 
898. 
899. def test_Min_Max():
900.     # see gh-10375
901.     assert lambdify((x, y, z), Min(x, y, z))(1, 2, 3) == 1
902.     assert lambdify((x, y, z), Max(x, y, z))(1, 2, 3) == 3
903. 
904. 
905. def test_Indexed():
906.     # Issue #10934
907.     if not numpy:
908.         skip("numpy not installed")
909. 
910.     a = IndexedBase('a')
911.     i, j = symbols('i j')
912.     b = numpy.array([[1, 2], [3, 4]])
913.     assert lambdify(a, Sum(a[x, y], (x, 0, 1), (y, 0, 1)))(b) == 10
914. 
915. 
916. def test_issue_12173():
917.     #test for issue 12173
918.     exp1 = lambdify((x, y), uppergamma(x, y),"mpmath")(1, 2)
919.     exp2 = lambdify((x, y), lowergamma(x, y),"mpmath")(1, 2)
920.     assert exp1 == uppergamma(1, 2).evalf()
921.     assert exp2 == lowergamma(1, 2).evalf()
922. 
923. 
924. def test_issue_13642():
925.     if not numpy:
926.         skip("numpy not installed")
927.     f = lambdify(x, sinc(x))
928.     assert Abs(f(1) - sinc(1)).n() < 1e-15
929. 
930. 
931. def test_sinc_mpmath():
932.     f = lambdify(x, sinc(x), "mpmath")
933.     assert Abs(f(1) - sinc(1)).n() < 1e-15
934. 
935. 
936. def test_lambdify_dummy_arg():
937.     d1 = Dummy()
938.     f1 = lambdify(d1, d1 + 1, dummify=False)
939.     assert f1(2) == 3
940.     f1b = lambdify(d1, d1 + 1)
941.     assert f1b(2) == 3
942.     d2 = Dummy('x')
943.     f2 = lambdify(d2, d2 + 1)
944.     assert f2(2) == 3
945.     f3 = lambdify([[d2]], d2 + 1)
946.     assert f3([2]) == 3
947. 
948. 
949. def test_lambdify_mixed_symbol_dummy_args():
950.     d = Dummy()
951.     # Contrived example of name clash
952.     dsym = symbols(str(d))
953.     f = lambdify([d, dsym], d - dsym)
954.     assert f(4, 1) == 3
955. 
956. 
957. def test_numpy_array_arg():
958.     # Test for issue 14655 (numpy part)
959.     if not numpy:
960.         skip("numpy not installed")
961. 
962.     f = lambdify([[x, y]], x*x + y, 'numpy')
963. 
964.     assert f(numpy.array([2.0, 1.0])) == 5
965. 
966. 
967. def test_tensorflow_array_arg():
968.     # Test for issue 14655 (tensorflow part)
969.     if not tensorflow:
970.         skip("tensorflow not installed.")
971. 
972.     f = lambdify([[x, y]], x*x + y, 'tensorflow')
973. 
974.     fcall = f(tensorflow.constant([2.0, 1.0]))
975. 
976.     s = tensorflow.Session()
977.     assert s.run(fcall) == 5
978. 
979. 
980. def test_scipy_fns():
981.     if not scipy:
982.         skip("scipy not installed")
983. 
984.     single_arg_sympy_fns = [erf, erfc, factorial, gamma, loggamma, digamma]
985.     single_arg_scipy_fns = [scipy.special.erf, scipy.special.erfc,
986.         scipy.special.factorial, scipy.special.gamma, scipy.special.gammaln,
987.         scipy.special.psi]
988.     numpy.random.seed(0)
989.     for (sympy_fn, scipy_fn) in zip(single_arg_sympy_fns, single_arg_scipy_fns):
990.         f = lambdify(x, sympy_fn(x), modules="scipy")
991.         for i in range(20):
992.             tv = numpy.random.uniform(-10, 10) + 1j*numpy.random.uniform(-5, 5)
993.             # SciPy thinks that factorial(z) is 0 when re(z) < 0.
994.             # SymPy does not think so.
995.             if sympy_fn == factorial and numpy.real(tv) < 0:
996.                 tv = tv + 2*numpy.abs(numpy.real(tv))
997.             # SciPy supports gammaln for real arguments only,
998.             # and there is also a branch cut along the negative real axis
999.             if sympy_fn == loggamma:
1000.                 tv = numpy.abs(tv)
1001.             # SymPy's digamma evaluates as polygamma(0, z)
1002.             # which SciPy supports for real arguments only
1003.             if sympy_fn == digamma:
1004.                 tv = numpy.real(tv)
1005.             sympy_result = sympy_fn(tv).evalf()
1006.             assert abs(f(tv) - sympy_result) < 1e-13*(1 + abs(sympy_result))
1007.             assert abs(f(tv) - scipy_fn(tv)) < 1e-13*(1 + abs(sympy_result))
1008. 
1009.     double_arg_sympy_fns = [RisingFactorial, besselj, bessely, besseli,
1010.         besselk]
1011.     double_arg_scipy_fns = [scipy.special.poch, scipy.special.jv,
1012.         scipy.special.yv, scipy.special.iv, scipy.special.kv]
1013.     for (sympy_fn, scipy_fn) in zip(double_arg_sympy_fns, double_arg_scipy_fns):
1014.         f = lambdify((x, y), sympy_fn(x, y), modules="scipy")
1015.         for i in range(20):
1016.             # SciPy supports only real orders of Bessel functions
1017.             tv1 = numpy.random.uniform(-10, 10)
1018.             tv2 = numpy.random.uniform(-10, 10) + 1j*numpy.random.uniform(-5, 5)
1019.             # SciPy supports poch for real arguments only
1020.             if sympy_fn == RisingFactorial:
1021.                 tv2 = numpy.real(tv2)
1022.             sympy_result = sympy_fn(tv1, tv2).evalf()
1023.             assert abs(f(tv1, tv2) - sympy_result) < 1e-13*(1 + abs(sympy_result))
1024.             assert abs(f(tv1, tv2) - scipy_fn(tv1, tv2)) < 1e-13*(1 + abs(sympy_result))
1025. 
1026. 
1027. def test_scipy_polys():
1028.     if not scipy:
1029.         skip("scipy not installed")
1030.     numpy.random.seed(0)
1031. 
1032.     params = symbols('n k a b')
1033.     # list polynomials with the number of parameters
1034.     polys = [
1035.         (chebyshevt, 1),
1036.         (chebyshevu, 1),
1037.         (legendre, 1),
1038.         (hermite, 1),
1039.         (laguerre, 1),
1040.         (gegenbauer, 2),
1041.         (assoc_legendre, 2),
1042.         (assoc_laguerre, 2),
1043.         (jacobi, 3)
1044.     ]
1045. 
1046.     for sympy_fn, num_params in polys:
1047.         args = params[:num_params] + (x,)
1048.         f = lambdify(args, sympy_fn(*args))
1049.         for i in range(10):
1050.             tn = numpy.random.randint(3, 10)
1051.             tparams = tuple(numpy.random.uniform(0, 5, size=num_params-1))
1052.             tv = numpy.random.uniform(-10, 10) + 1j*numpy.random.uniform(-5, 5)
1053.             # SciPy supports hermite for real arguments only
1054.             if sympy_fn == hermite:
1055.                 tv = numpy.real(tv)
1056.             # assoc_legendre needs x in (-1, 1) and integer param at most n
1057.             if sympy_fn == assoc_legendre:
1058.                 tv = numpy.random.uniform(-1, 1)
1059.                 tparams = tuple(numpy.random.randint(1, tn, size=1))
1060.             vals = (tn,) + tparams + (tv,)
1061.             sympy_result = sympy_fn(*vals).evalf()
1062.             assert abs(f(*vals) - sympy_result) < 1e-13*(1 + abs(sympy_result))
1063. 
1064. 
1065. def test_lambdify_inspect():
1066.     f = lambdify(x, x**2)
1067.     # Test that inspect.getsource works but don't hard-code implementation
1068.     # details
1069.     assert 'x**2' in inspect.getsource(f)
1070. 
1071. 
1072. def test_issue_14941():
1073.     x, y = Dummy(), Dummy()
1074. 
1075.     # test dict
1076.     f1 = lambdify([x, y], {x: 3, y: 3}, 'sympy')
1077.     assert f1(2, 3) == {2: 3, 3: 3}
1078. 
1079.     # test tuple
1080.     f2 = lambdify([x, y], (y, x), 'sympy')
1081.     assert f2(2, 3) == (3, 2)
1082. 
1083.     # test list
1084.     f3 = lambdify([x, y], [y, x], 'sympy')
1085.     assert f3(2, 3) == [3, 2]
1086. 
1087. 
1088. def test_lambdify_Derivative_arg_issue_16468():
1089.     f = Function('f')(x)
1090.     fx = f.diff()
1091.     assert lambdify((f, fx), f + fx)(10, 5) == 15
1092.     assert eval(lambdastr((f, fx), f/fx))(10, 5) == 2
1093.     raises(SyntaxError, lambda:
1094.         eval(lambdastr((f, fx), f/fx, dummify=False)))
1095.     assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2
1096.     assert eval(lambdastr((fx, f), f/fx, dummify=True))(S(10), 5) == S.Half
1097.     assert lambdify(fx, 1 + fx)(41) == 42
1098.     assert eval(lambdastr(fx, 1 + fx, dummify=True))(41) == 42
1099. 
1100. 
1101. def test_imag_real():
1102.     f_re = lambdify([z], sympy.re(z))
1103.     val = 3+2j
1104.     assert f_re(val) == val.real
1105. 
1106.     f_im = lambdify([z], sympy.im(z))  # see #15400
1107.     assert f_im(val) == val.imag
1108. 
1109. 
1110. def test_MatrixSymbol_issue_15578():
1111.     if not numpy:
1112.         skip("numpy not installed")
1113.     A = MatrixSymbol('A', 2, 2)
1114.     A0 = numpy.array([[1, 2], [3, 4]])
1115.     f = lambdify(A, A**(-1))
1116.     assert numpy.allclose(f(A0), numpy.array([[-2., 1.], [1.5, -0.5]]))
1117.     g = lambdify(A, A**3)
1118.     assert numpy.allclose(g(A0), numpy.array([[37, 54], [81, 118]]))
1119. 
1120. 
1121. def test_issue_15654():
1122.     if not scipy:
1123.         skip("scipy not installed")
1124.     from sympy.abc import n, l, r, Z
1125.     from sympy.physics import hydrogen
1126.     nv, lv, rv, Zv = 1, 0, 3, 1
1127.     sympy_value = hydrogen.R_nl(nv, lv, rv, Zv).evalf()
1128.     f = lambdify((n, l, r, Z), hydrogen.R_nl(n, l, r, Z))
1129.     scipy_value = f(nv, lv, rv, Zv)
1130.     assert abs(sympy_value - scipy_value) < 1e-15
1131. 
1132. def test_issue_15827():
1133.     if not numpy:
1134.         skip("numpy not installed")
1135.     A = MatrixSymbol("A", 3, 3)
1136.     B = MatrixSymbol("B", 2, 3)
1137.     C = MatrixSymbol("C", 3, 4)
1138.     D = MatrixSymbol("D", 4, 5)
1139.     k=symbols("k")
1140.     f = lambdify(A, (2*k)*A)
1141.     g = lambdify(A, (2+k)*A)
1142.     h = lambdify(A, 2*A)
1143.     i = lambdify((B, C, D), 2*B*C*D)
1144.     assert numpy.array_equal(f(numpy.array([[1, 2, 3], [1, 2, 3], [1, 2, 3]])), \
1145.     numpy.array([[2*k, 4*k, 6*k], [2*k, 4*k, 6*k], [2*k, 4*k, 6*k]], dtype=object))
1146. 
1147.     assert numpy.array_equal(g(numpy.array([[1, 2, 3], [1, 2, 3], [1, 2, 3]])), \
1148.     numpy.array([[k + 2, 2*k + 4, 3*k + 6], [k + 2, 2*k + 4, 3*k + 6], \
1149.     [k + 2, 2*k + 4, 3*k + 6]], dtype=object))
1150. 
1151.     assert numpy.array_equal(h(numpy.array([[1, 2, 3], [1, 2, 3], [1, 2, 3]])), \
1152.     numpy.array([[2, 4, 6], [2, 4, 6], [2, 4, 6]]))
1153. 
1154.     assert numpy.array_equal(i(numpy.array([[1, 2, 3], [1, 2, 3]]), numpy.array([[1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 4]]), \
1155.     numpy.array([[1, 2, 3, 4, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4, 5]])), numpy.array([[ 120, 240, 360, 480, 600], \
1156.     [ 120, 240, 360, 480, 600]]))

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 00:52:54,117 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user requested the full content of the file 'sympy/utilities/tests/test_lambdify.py'. This context block contains the first 500 lines of that file, which is directly relevant to the user's request.", relative_path='sympy/utilities/tests/test_lambdify.py', start_line=1, end_line=500), ContextOutput(reasoning="The user requested the full content of the file 'sympy/utilities/tests/test_lambdify.py'. This context block contains the remaining lines of the file, from 501 to the end, which is necessary to provide the complete file content as requested.", relative_path='sympy/utilities/tests/test_lambdify.py', start_line=501, end_line=1156)]
2025-12-23 00:52:54,119 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of the file sympy/utilities/tests/test_lambdify.py.
2025-12-23 00:52:54,119 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 00:52:54,119 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 00:52:54,120 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 1 existing contexts
2025-12-23 00:52:54,120 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-23 00:52:54,121 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: PythonCodePrinter doesn't support Indexed 

Description: I use `lambdify()` to generate some functions and save the code for further use. But the generated code for `Indexed` operation has some warnings which can be confirmed by following code;

```
from sympy import *
p = IndexedBase("p")

pycode(p[0])
```
the output is 

```
  # Not supported in Python:
  # Indexed
p[0]
```

We should add following method to `PythonCodePrinter`:

```
def _print_Indexed(self, expr):
    base, *index = expr.args
    return "{}[{}]".format(str(base), ", ".join([self._print(ind) for ind in index]))
```

Patch information:
diff --git a/sympy/printing/pycode.py b/sympy/printing/pycode.py
index a3f0310735..8f7125e8eb 100644
--- a/sympy/printing/pycode.py
+++ b/sympy/printing/pycode.py
@@ -357,6 +357,17 @@ def _print_Not(self, expr):
         PREC = precedence(expr)
         return self._operators['not'] + self.parenthesize(expr.args[0], PREC)
 
+    def _print_Indexed(self, expr):
+        base = expr.base
+        indices = expr.indices
+        return "%s[%s]" % (self._print(base), ", ".join(self._print(ind) for ind in indices))
+
+    def _print_Idx(self, expr):
+        return self._print(expr.label)
+
+    def _print_IndexedBase(self, expr):
+        return self._print(expr.label)
+
 
 for k in PythonCodePrinter._kf:
     setattr(PythonCodePrinter, '_print_%s' % k, _print_known_func)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file sympy/printing/tests/test_pycode.py.
Extra Requirements: 
Purpose: I need to inspect the test file for `pycode` to find existing tests that handle similar structures or code printing scenarios, which will help in identifying the most relevant examples for the user's bug report.

Previous refined query 2:
Essential Query: Please provide the full content of the file sympy/utilities/tests/test_lambdify.py.
Extra Requirements: 
Purpose: This file is expected to contain test cases for `lambdify` with `Indexed` objects, which will serve as relevant examples for fixing the `PythonCodePrinter` bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/printing/tests/test_pycode.py
Line number range: 1 - 98
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import absolute_import
3. 
4. from sympy.codegen import Assignment
5. from sympy.codegen.ast import none
6. from sympy.core import Expr, Mod, symbols, Eq, Le, Gt, zoo, oo, Rational
7. from sympy.core.numbers import pi
8. from sympy.functions import acos, Piecewise, sign
9. from sympy.logic import And, Or
10. from sympy.matrices import SparseMatrix, MatrixSymbol
11. from sympy.printing.pycode import (
12.     MpmathPrinter, NumPyPrinter, PythonCodePrinter, pycode, SciPyPrinter
13. )
14. from sympy.utilities.pytest import raises
15. 
16. x, y, z = symbols('x y z')
17. 
18. 
19. def test_PythonCodePrinter():
20.     prntr = PythonCodePrinter()
21.     assert not prntr.module_imports
22.     assert prntr.doprint(x**y) == 'x**y'
23.     assert prntr.doprint(Mod(x, 2)) == 'x % 2'
24.     assert prntr.doprint(And(x, y)) == 'x and y'
25.     assert prntr.doprint(Or(x, y)) == 'x or y'
26.     assert not prntr.module_imports
27.     assert prntr.doprint(pi) == 'math.pi'
28.     assert prntr.module_imports == {'math': {'pi'}}
29.     assert prntr.doprint(acos(x)) == 'math.acos(x)'
30.     assert prntr.doprint(Assignment(x, 2)) == 'x = 2'
31.     assert prntr.doprint(Piecewise((1, Eq(x, 0)),
32.                         (2, x>6))) == '((1) if (x == 0) else (2) if (x > 6) else None)'
33.     assert prntr.doprint(Piecewise((2, Le(x, 0)),
34.                         (3, Gt(x, 0)), evaluate=False)) == '((2) if (x <= 0) else'\
35.                                                         ' (3) if (x > 0) else None)'
36.     assert prntr.doprint(sign(x)) == '(0.0 if x == 0 else math.copysign(1, x))'
37. 
38. 
39. def test_MpmathPrinter():
40.     p = MpmathPrinter()
41.     assert p.doprint(sign(x)) == 'mpmath.sign(x)'
42.     assert p.doprint(Rational(1, 2)) == 'mpmath.mpf(1)/mpmath.mpf(2)'
43. 
44. def test_NumPyPrinter():
45.     p = NumPyPrinter()
46.     assert p.doprint(sign(x)) == 'numpy.sign(x)'
47.     A = MatrixSymbol("A", 2, 2)
48.     assert p.doprint(A**(-1)) == "numpy.linalg.inv(A)"
49.     assert p.doprint(A**5) == "numpy.linalg.matrix_power(A, 5)"
50. 
51. 
52. def test_SciPyPrinter():
53.     p = SciPyPrinter()
54.     expr = acos(x)
55.     assert 'numpy' not in p.module_imports
56.     assert p.doprint(expr) == 'numpy.arccos(x)'
57.     assert 'numpy' in p.module_imports
58.     assert not any(m.startswith('scipy') for m in p.module_imports)
59.     smat = SparseMatrix(2, 5, {(0, 1): 3})
60.     assert p.doprint(smat) == 'scipy.sparse.coo_matrix([3], ([0], [1]), shape=(2, 5))'
61.     assert 'scipy.sparse' in p.module_imports
62. 
63. 
64. def test_pycode_reserved_words():
65.     s1, s2 = symbols('if else')
66.     raises(ValueError, lambda: pycode(s1 + s2, error_on_reserved=True))
67.     py_str = pycode(s1 + s2)
68.     assert py_str in ('else_ + if_', 'if_ + else_')
69. 
70. 
71. class CustomPrintedObject(Expr):
72.     def _numpycode(self, printer):
73.         return 'numpy'
74. 
75.     def _mpmathcode(self, printer):
76.         return 'mpmath'
77. 
78. 
79. def test_printmethod():
80.     obj = CustomPrintedObject()
81.     assert NumPyPrinter().doprint(obj) == 'numpy'
82.     assert MpmathPrinter().doprint(obj) == 'mpmath'
83. 
84. 
85. def test_codegen_ast_nodes():
86.     assert pycode(none) == 'None'
87. 
88. 
89. def test_issue_14283():
90.     prntr = PythonCodePrinter()
91. 
92.     assert prntr.doprint(zoo) == "float('nan')"
93.     assert prntr.doprint(-oo) == "float('-inf')"
94. 
95. def test_NumPyPrinter_print_seq():
96.     n = NumPyPrinter()
97. 
98.     assert n._print_seq(range(2)) == '(0, 1,)'


File: sympy/utilities/tests/test_lambdify.py
Line number range: 1 - 500
Content:
1. from distutils.version import LooseVersion as V
2. from itertools import product
3. import math
4. import inspect
5. 
6. import mpmath
7. from sympy.utilities.pytest import XFAIL, raises
8. from sympy import (
9.     symbols, lambdify, sqrt, sin, cos, tan, pi, acos, acosh, Rational,
10.     Float, Matrix, Lambda, Piecewise, exp, Integral, oo, I, Abs, Function,
11.     true, false, And, Or, Not, ITE, Min, Max, floor, diff, IndexedBase, Sum,
12.     DotProduct, Eq, Dummy, sinc, erf, erfc, factorial, gamma, loggamma,
13.     digamma, RisingFactorial, besselj, bessely, besseli, besselk, S,
14.     MatrixSymbol, chebyshevt, chebyshevu, legendre, hermite, laguerre,
15.     gegenbauer, assoc_legendre, assoc_laguerre, jacobi)
16. from sympy.printing.lambdarepr import LambdaPrinter
17. from sympy.printing.pycode import NumPyPrinter
18. from sympy.utilities.lambdify import implemented_function, lambdastr
19. from sympy.utilities.pytest import skip
20. from sympy.utilities.decorator import conserve_mpmath_dps
21. from sympy.external import import_module
22. from sympy.functions.special.gamma_functions import uppergamma,lowergamma
23. 
24. import sympy
25. 
26. 
27. MutableDenseMatrix = Matrix
28. 
29. numpy = import_module('numpy')
30. scipy = import_module('scipy')
31. scipy_special = import_module('scipy.special')
32. numexpr = import_module('numexpr')
33. tensorflow = import_module('tensorflow')
34. 
35. if tensorflow:
36.     # Hide Tensorflow warnings
37.     import os
38.     os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
39. 
40. w, x, y, z = symbols('w,x,y,z')
41. 
42. #================== Test different arguments =======================
43. 
44. 
45. def test_no_args():
46.     f = lambdify([], 1)
47.     raises(TypeError, lambda: f(-1))
48.     assert f() == 1
49. 
50. 
51. def test_single_arg():
52.     f = lambdify(x, 2*x)
53.     assert f(1) == 2
54. 
55. 
56. def test_list_args():
57.     f = lambdify([x, y], x + y)
58.     assert f(1, 2) == 3
59. 
60. 
61. def test_nested_args():
62.     f1 = lambdify([[w, x]], [w, x])
63.     assert f1([91, 2]) == [91, 2]
64.     raises(TypeError, lambda: f1(1, 2))
65. 
66.     f2 = lambdify([(w, x), (y, z)], [w, x, y, z])
67.     assert f2((18, 12), (73, 4)) == [18, 12, 73, 4]
68.     raises(TypeError, lambda: f2(3, 4))
69. 
70.     f3 = lambdify([w, [[[x]], y], z], [w, x, y, z])
71.     assert f3(10, [[[52]], 31], 44) == [10, 52, 31, 44]
72. 
73. 
74. def test_str_args():
75.     f = lambdify('x,y,z', 'z,y,x')
76.     assert f(3, 2, 1) == (1, 2, 3)
77.     assert f(1.0, 2.0, 3.0) == (3.0, 2.0, 1.0)
78.     # make sure correct number of args required
79.     raises(TypeError, lambda: f(0))
80. 
81. 
82. def test_own_namespace_1():
83.     myfunc = lambda x: 1
84.     f = lambdify(x, sin(x), {"sin": myfunc})
85.     assert f(0.1) == 1
86.     assert f(100) == 1
87. 
88. 
89. def test_own_namespace_2():
90.     def myfunc(x):
91.         return 1
92.     f = lambdify(x, sin(x), {'sin': myfunc})
93.     assert f(0.1) == 1
94.     assert f(100) == 1
95. 
96. 
97. def test_own_module():
98.     f = lambdify(x, sin(x), math)
99.     assert f(0) == 0.0
100. 
101. 
102. def test_bad_args():
103.     # no vargs given
104.     raises(TypeError, lambda: lambdify(1))
105.     # same with vector exprs
106.     raises(TypeError, lambda: lambdify([1, 2]))
107. 
108. 
109. def test_atoms():
110.     # Non-Symbol atoms should not be pulled out from the expression namespace
111.     f = lambdify(x, pi + x, {"pi": 3.14})
112.     assert f(0) == 3.14
113.     f = lambdify(x, I + x, {"I": 1j})
114.     assert f(1) == 1 + 1j
115. 
116. #================== Test different modules =========================
117. 
118. # high precision output of sin(0.2*pi) is used to detect if precision is lost unwanted
119. 
120. 
121. @conserve_mpmath_dps
122. def test_sympy_lambda():
123.     mpmath.mp.dps = 50
124.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
125.     f = lambdify(x, sin(x), "sympy")
126.     assert f(x) == sin(x)
127.     prec = 1e-15
128.     assert -prec < f(Rational(1, 5)).evalf() - Float(str(sin02)) < prec
129.     # arctan is in numpy module and should not be available
130.     raises(NameError, lambda: lambdify(x, arctan(x), "sympy"))
131. 
132. 
133. @conserve_mpmath_dps
134. def test_math_lambda():
135.     mpmath.mp.dps = 50
136.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
137.     f = lambdify(x, sin(x), "math")
138.     prec = 1e-15
139.     assert -prec < f(0.2) - sin02 < prec
140.     raises(TypeError, lambda: f(x))
141.            # if this succeeds, it can't be a python math function
142. 
143. 
144. @conserve_mpmath_dps
145. def test_mpmath_lambda():
146.     mpmath.mp.dps = 50
147.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
148.     f = lambdify(x, sin(x), "mpmath")
149.     prec = 1e-49  # mpmath precision is around 50 decimal places
150.     assert -prec < f(mpmath.mpf("0.2")) - sin02 < prec
151.     raises(TypeError, lambda: f(x))
152.            # if this succeeds, it can't be a mpmath function
153. 
154. 
155. @conserve_mpmath_dps
156. def test_number_precision():
157.     mpmath.mp.dps = 50
158.     sin02 = mpmath.mpf("0.19866933079506121545941262711838975037020672954020")
159.     f = lambdify(x, sin02, "mpmath")
160.     prec = 1e-49  # mpmath precision is around 50 decimal places
161.     assert -prec < f(0) - sin02 < prec
162. 
163. @conserve_mpmath_dps
164. def test_mpmath_precision():
165.     mpmath.mp.dps = 100
166.     assert str(lambdify((), pi.evalf(100), 'mpmath')()) == str(pi.evalf(100))
167. 
168. #================== Test Translations ==============================
169. # We can only check if all translated functions are valid. It has to be checked
170. # by hand if they are complete.
171. 
172. 
173. def test_math_transl():
174.     from sympy.utilities.lambdify import MATH_TRANSLATIONS
175.     for sym, mat in MATH_TRANSLATIONS.items():
176.         assert sym in sympy.__dict__
177.         assert mat in math.__dict__
178. 
179. 
180. def test_mpmath_transl():
181.     from sympy.utilities.lambdify import MPMATH_TRANSLATIONS
182.     for sym, mat in MPMATH_TRANSLATIONS.items():
183.         assert sym in sympy.__dict__ or sym == 'Matrix'
184.         assert mat in mpmath.__dict__
185. 
186. 
187. def test_numpy_transl():
188.     if not numpy:
189.         skip("numpy not installed.")
190. 
191.     from sympy.utilities.lambdify import NUMPY_TRANSLATIONS
192.     for sym, nump in NUMPY_TRANSLATIONS.items():
193.         assert sym in sympy.__dict__
194.         assert nump in numpy.__dict__
195. 
196. 
197. def test_scipy_transl():
198.     if not scipy:
199.         skip("scipy not installed.")
200. 
201.     from sympy.utilities.lambdify import SCIPY_TRANSLATIONS
202.     for sym, scip in SCIPY_TRANSLATIONS.items():
203.         assert sym in sympy.__dict__
204.         assert scip in scipy.__dict__ or scip in scipy.special.__dict__
205. 
206. 
207. def test_tensorflow_transl():
208.     if not tensorflow:
209.         skip("tensorflow not installed")
210. 
211.     from sympy.utilities.lambdify import TENSORFLOW_TRANSLATIONS
212.     for sym, tens in TENSORFLOW_TRANSLATIONS.items():
213.         assert sym in sympy.__dict__
214.         assert tens in tensorflow.__dict__
215. 
216. 
217. def test_numpy_translation_abs():
218.     if not numpy:
219.         skip("numpy not installed.")
220. 
221.     f = lambdify(x, Abs(x), "numpy")
222.     assert f(-1) == 1
223.     assert f(1) == 1
224. 
225. 
226. def test_numexpr_printer():
227.     if not numexpr:
228.         skip("numexpr not installed.")
229. 
230.     # if translation/printing is done incorrectly then evaluating
231.     # a lambdified numexpr expression will throw an exception
232.     from sympy.printing.lambdarepr import NumExprPrinter
233. 
234.     blacklist = ('where', 'complex', 'contains')
235.     arg_tuple = (x, y, z) # some functions take more than one argument
236.     for sym in NumExprPrinter._numexpr_functions.keys():
237.         if sym in blacklist:
238.             continue
239.         ssym = S(sym)
240.         if hasattr(ssym, '_nargs'):
241.             nargs = ssym._nargs[0]
242.         else:
243.             nargs = 1
244.         args = arg_tuple[:nargs]
245.         f = lambdify(args, ssym(*args), modules='numexpr')
246.         assert f(*(1, )*nargs) is not None
247. 
248. 
249. def test_issue_9334():
250.     if not numexpr:
251.         skip("numexpr not installed.")
252.     if not numpy:
253.         skip("numpy not installed.")
254.     expr = S('b*a - sqrt(a**2)')
255.     a, b = sorted(expr.free_symbols, key=lambda s: s.name)
256.     func_numexpr = lambdify((a,b), expr, modules=[numexpr], dummify=False)
257.     foo, bar = numpy.random.random((2, 4))
258.     func_numexpr(foo, bar)
259. 
260. #================== Test some functions ============================
261. 
262. 
263. def test_exponentiation():
264.     f = lambdify(x, x**2)
265.     assert f(-1) == 1
266.     assert f(0) == 0
267.     assert f(1) == 1
268.     assert f(-2) == 4
269.     assert f(2) == 4
270.     assert f(2.5) == 6.25
271. 
272. 
273. def test_sqrt():
274.     f = lambdify(x, sqrt(x))
275.     assert f(0) == 0.0
276.     assert f(1) == 1.0
277.     assert f(4) == 2.0
278.     assert abs(f(2) - 1.414) < 0.001
279.     assert f(6.25) == 2.5
280. 
281. 
282. def test_trig():
283.     f = lambdify([x], [cos(x), sin(x)], 'math')
284.     d = f(pi)
285.     prec = 1e-11
286.     assert -prec < d[0] + 1 < prec
287.     assert -prec < d[1] < prec
288.     d = f(3.14159)
289.     prec = 1e-5
290.     assert -prec < d[0] + 1 < prec
291.     assert -prec < d[1] < prec
292. 
293. #================== Test vectors ===================================
294. 
295. 
296. def test_vector_simple():
297.     f = lambdify((x, y, z), (z, y, x))
298.     assert f(3, 2, 1) == (1, 2, 3)
299.     assert f(1.0, 2.0, 3.0) == (3.0, 2.0, 1.0)
300.     # make sure correct number of args required
301.     raises(TypeError, lambda: f(0))
302. 
303. 
304. def test_vector_discontinuous():
305.     f = lambdify(x, (-1/x, 1/x))
306.     raises(ZeroDivisionError, lambda: f(0))
307.     assert f(1) == (-1.0, 1.0)
308.     assert f(2) == (-0.5, 0.5)
309.     assert f(-2) == (0.5, -0.5)
310. 
311. 
312. def test_trig_symbolic():
313.     f = lambdify([x], [cos(x), sin(x)], 'math')
314.     d = f(pi)
315.     assert abs(d[0] + 1) < 0.0001
316.     assert abs(d[1] - 0) < 0.0001
317. 
318. 
319. def test_trig_float():
320.     f = lambdify([x], [cos(x), sin(x)])
321.     d = f(3.14159)
322.     assert abs(d[0] + 1) < 0.0001
323.     assert abs(d[1] - 0) < 0.0001
324. 
325. 
326. def test_docs():
327.     f = lambdify(x, x**2)
328.     assert f(2) == 4
329.     f = lambdify([x, y, z], [z, y, x])
330.     assert f(1, 2, 3) == [3, 2, 1]
331.     f = lambdify(x, sqrt(x))
332.     assert f(4) == 2.0
333.     f = lambdify((x, y), sin(x*y)**2)
334.     assert f(0, 5) == 0
335. 
336. 
337. def test_math():
338.     f = lambdify((x, y), sin(x), modules="math")
339.     assert f(0, 5) == 0
340. 
341. 
342. def test_sin():
343.     f = lambdify(x, sin(x)**2)
344.     assert isinstance(f(2), float)
345.     f = lambdify(x, sin(x)**2, modules="math")
346.     assert isinstance(f(2), float)
347. 
348. 
349. def test_matrix():
350.     A = Matrix([[x, x*y], [sin(z) + 4, x**z]])
351.     sol = Matrix([[1, 2], [sin(3) + 4, 1]])
352.     f = lambdify((x, y, z), A, modules="sympy")
353.     assert f(1, 2, 3) == sol
354.     f = lambdify((x, y, z), (A, [A]), modules="sympy")
355.     assert f(1, 2, 3) == (sol, [sol])
356.     J = Matrix((x, x + y)).jacobian((x, y))
357.     v = Matrix((x, y))
358.     sol = Matrix([[1, 0], [1, 1]])
359.     assert lambdify(v, J, modules='sympy')(1, 2) == sol
360.     assert lambdify(v.T, J, modules='sympy')(1, 2) == sol
361. 
362. 
363. def test_numpy_matrix():
364.     if not numpy:
365.         skip("numpy not installed.")
366.     A = Matrix([[x, x*y], [sin(z) + 4, x**z]])
367.     sol_arr = numpy.array([[1, 2], [numpy.sin(3) + 4, 1]])
368.     #Lambdify array first, to ensure return to array as default
369.     f = lambdify((x, y, z), A, ['numpy'])
370.     numpy.testing.assert_allclose(f(1, 2, 3), sol_arr)
371.     #Check that the types are arrays and matrices
372.     assert isinstance(f(1, 2, 3), numpy.ndarray)
373. 
374.     # gh-15071
375.     class dot(Function):
376.         pass
377.     x_dot_mtx = dot(x, Matrix([[2], [1], [0]]))
378.     f_dot1 = lambdify(x, x_dot_mtx)
379.     inp = numpy.zeros((17, 3))
380.     assert numpy.all(f_dot1(inp) == 0)
381. 
382.     strict_kw = dict(allow_unknown_functions=False, inline=True, fully_qualified_modules=False)
383.     p2 = NumPyPrinter(dict(user_functions={'dot': 'dot'}, **strict_kw))
384.     f_dot2 = lambdify(x, x_dot_mtx, printer=p2)
385.     assert numpy.all(f_dot2(inp) == 0)
386. 
387.     p3 = NumPyPrinter(strict_kw)
388.     # The line below should probably fail upon construction (before calling with "(inp)"):
389.     raises(Exception, lambda: lambdify(x, x_dot_mtx, printer=p3)(inp))
390. 
391. 
392. def test_numpy_transpose():
393.     if not numpy:
394.         skip("numpy not installed.")
395.     A = Matrix([[1, x], [0, 1]])
396.     f = lambdify((x), A.T, modules="numpy")
397.     numpy.testing.assert_array_equal(f(2), numpy.array([[1, 0], [2, 1]]))
398. 
399. 
400. def test_numpy_dotproduct():
401.     if not numpy:
402.         skip("numpy not installed")
403.     A = Matrix([x, y, z])
404.     f1 = lambdify([x, y, z], DotProduct(A, A), modules='numpy')
405.     f2 = lambdify([x, y, z], DotProduct(A, A.T), modules='numpy')
406.     f3 = lambdify([x, y, z], DotProduct(A.T, A), modules='numpy')
407.     f4 = lambdify([x, y, z], DotProduct(A, A.T), modules='numpy')
408. 
409.     assert f1(1, 2, 3) == \
410.            f2(1, 2, 3) == \
411.            f3(1, 2, 3) == \
412.            f4(1, 2, 3) == \
413.            numpy.array([14])
414. 
415. 
416. def test_numpy_inverse():
417.     if not numpy:
418.         skip("numpy not installed.")
419.     A = Matrix([[1, x], [0, 1]])
420.     f = lambdify((x), A**-1, modules="numpy")
421.     numpy.testing.assert_array_equal(f(2), numpy.array([[1, -2], [0,  1]]))
422. 
423. 
424. def test_numpy_old_matrix():
425.     if not numpy:
426.         skip("numpy not installed.")
427.     A = Matrix([[x, x*y], [sin(z) + 4, x**z]])
428.     sol_arr = numpy.array([[1, 2], [numpy.sin(3) + 4, 1]])
429.     f = lambdify((x, y, z), A, [{'ImmutableDenseMatrix': numpy.matrix}, 'numpy'])
430.     numpy.testing.assert_allclose(f(1, 2, 3), sol_arr)
431.     assert isinstance(f(1, 2, 3), numpy.matrix)
432. 
433. 
434. def test_python_div_zero_issue_11306():
435.     if not numpy:
436.         skip("numpy not installed.")
437.     p = Piecewise((1 / x, y < -1), (x, y < 1), (1 / x, True))
438.     f = lambdify([x, y], p, modules='numpy')
439.     numpy.seterr(divide='ignore')
440.     assert float(f(numpy.array([0]),numpy.array([0.5]))) == 0
441.     assert str(float(f(numpy.array([0]),numpy.array([1])))) == 'inf'
442.     numpy.seterr(divide='warn')
443. 
444. 
445. def test_issue9474():
446.     mods = [None, 'math']
447.     if numpy:
448.         mods.append('numpy')
449.     if mpmath:
450.         mods.append('mpmath')
451.     for mod in mods:
452.         f = lambdify(x, S(1)/x, modules=mod)
453.         assert f(2) == 0.5
454.         f = lambdify(x, floor(S(1)/x), modules=mod)
455.         assert f(2) == 0
456. 
457.     for absfunc, modules in product([Abs, abs], mods):
458.         f = lambdify(x, absfunc(x), modules=modules)
459.         assert f(-1) == 1
460.         assert f(1) == 1
461.         assert f(3+4j) == 5
462. 
463. 
464. def test_issue_9871():
465.     if not numexpr:
466.         skip("numexpr not installed.")
467.     if not numpy:
468.         skip("numpy not installed.")
469. 
470.     r = sqrt(x**2 + y**2)
471.     expr = diff(1/r, x)
472. 
473.     xn = yn = numpy.linspace(1, 10, 16)
474.     # expr(xn, xn) = -xn/(sqrt(2)*xn)^3
475.     fv_exact = -numpy.sqrt(2.)**-3 * xn**-2
476. 
477.     fv_numpy = lambdify((x, y), expr, modules='numpy')(xn, yn)
478.     fv_numexpr = lambdify((x, y), expr, modules='numexpr')(xn, yn)
479.     numpy.testing.assert_allclose(fv_numpy, fv_exact, rtol=1e-10)
480.     numpy.testing.assert_allclose(fv_numexpr, fv_exact, rtol=1e-10)
481. 
482. 
483. def test_numpy_piecewise():
484.     if not numpy:
485.         skip("numpy not installed.")
486.     pieces = Piecewise((x, x < 3), (x**2, x > 5), (0, True))
487.     f = lambdify(x, pieces, modules="numpy")
488.     numpy.testing.assert_array_equal(f(numpy.arange(10)),
489.                                      numpy.array([0, 1, 2, 0, 0, 0, 36, 49, 64, 81]))
490.     # If we evaluate somewhere all conditions are False, we should get back NaN
491.     nodef_func = lambdify(x, Piecewise((x, x > 0), (-x, x < 0)))
492.     numpy.testing.assert_array_equal(nodef_func(numpy.array([-1, 0, 1])),
493.                                      numpy.array([1, numpy.nan, 1]))
494. 
495. 
496. def test_numpy_logical_ops():
497.     if not numpy:
498.         skip("numpy not installed.")
499.     and_func = lambdify((x, y), And(x, y), modules="numpy")
500.     and_func_3 = lambdify((x, y, z), And(x, y, z), modules="numpy")


File: sympy/utilities/tests/test_lambdify.py
Line number range: 501 - 1156
Content:
501.     or_func = lambdify((x, y), Or(x, y), modules="numpy")
502.     or_func_3 = lambdify((x, y, z), Or(x, y, z), modules="numpy")
503.     not_func = lambdify((x), Not(x), modules="numpy")
504.     arr1 = numpy.array([True, True])
505.     arr2 = numpy.array([False, True])
506.     arr3 = numpy.array([True, False])
507.     numpy.testing.assert_array_equal(and_func(arr1, arr2), numpy.array([False, True]))
508.     numpy.testing.assert_array_equal(and_func_3(arr1, arr2, arr3), numpy.array([False, False]))
509.     numpy.testing.assert_array_equal(or_func(arr1, arr2), numpy.array([True, True]))
510.     numpy.testing.assert_array_equal(or_func_3(arr1, arr2, arr3), numpy.array([True, True]))
511.     numpy.testing.assert_array_equal(not_func(arr2), numpy.array([True, False]))
512. 
513. 
514. def test_numpy_matmul():
515.     if not numpy:
516.         skip("numpy not installed.")
517.     xmat = Matrix([[x, y], [z, 1+z]])
518.     ymat = Matrix([[x**2], [Abs(x)]])
519.     mat_func = lambdify((x, y, z), xmat*ymat, modules="numpy")
520.     numpy.testing.assert_array_equal(mat_func(0.5, 3, 4), numpy.array([[1.625], [3.5]]))
521.     numpy.testing.assert_array_equal(mat_func(-0.5, 3, 4), numpy.array([[1.375], [3.5]]))
522.     # Multiple matrices chained together in multiplication
523.     f = lambdify((x, y, z), xmat*xmat*xmat, modules="numpy")
524.     numpy.testing.assert_array_equal(f(0.5, 3, 4), numpy.array([[72.125, 119.25],
525.                                                                 [159, 251]]))
526. 
527. 
528. def test_numpy_numexpr():
529.     if not numpy:
530.         skip("numpy not installed.")
531.     if not numexpr:
532.         skip("numexpr not installed.")
533.     a, b, c = numpy.random.randn(3, 128, 128)
534.     # ensure that numpy and numexpr return same value for complicated expression
535.     expr = sin(x) + cos(y) + tan(z)**2 + Abs(z-y)*acos(sin(y*z)) + \
536.            Abs(y-z)*acosh(2+exp(y-x))- sqrt(x**2+I*y**2)
537.     npfunc = lambdify((x, y, z), expr, modules='numpy')
538.     nefunc = lambdify((x, y, z), expr, modules='numexpr')
539.     assert numpy.allclose(npfunc(a, b, c), nefunc(a, b, c))
540. 
541. 
542. def test_numexpr_userfunctions():
543.     if not numpy:
544.         skip("numpy not installed.")
545.     if not numexpr:
546.         skip("numexpr not installed.")
547.     a, b = numpy.random.randn(2, 10)
548.     uf = type('uf', (Function, ),
549.               {'eval' : classmethod(lambda x, y : y**2+1)})
550.     func = lambdify(x, 1-uf(x), modules='numexpr')
551.     assert numpy.allclose(func(a), -(a**2))
552. 
553.     uf = implemented_function(Function('uf'), lambda x, y : 2*x*y+1)
554.     func = lambdify((x, y), uf(x, y), modules='numexpr')
555.     assert numpy.allclose(func(a, b), 2*a*b+1)
556. 
557. 
558. def test_tensorflow_basic_math():
559.     if not tensorflow:
560.         skip("tensorflow not installed.")
561.     expr = Max(sin(x), Abs(1/(x+2)))
562.     func = lambdify(x, expr, modules="tensorflow")
563.     a = tensorflow.constant(0, dtype=tensorflow.float32)
564.     s = tensorflow.Session()
565.     assert func(a).eval(session=s) == 0.5
566. 
567. 
568. def test_tensorflow_placeholders():
569.     if not tensorflow:
570.         skip("tensorflow not installed.")
571.     expr = Max(sin(x), Abs(1/(x+2)))
572.     func = lambdify(x, expr, modules="tensorflow")
573.     a = tensorflow.placeholder(dtype=tensorflow.float32)
574.     s = tensorflow.Session()
575.     assert func(a).eval(session=s, feed_dict={a: 0}) == 0.5
576. 
577. 
578. def test_tensorflow_variables():
579.     if not tensorflow:
580.         skip("tensorflow not installed.")
581.     expr = Max(sin(x), Abs(1/(x+2)))
582.     func = lambdify(x, expr, modules="tensorflow")
583.     a = tensorflow.Variable(0, dtype=tensorflow.float32)
584.     s = tensorflow.Session()
585.     if V(tensorflow.__version__) < '1.0':
586.         s.run(tensorflow.initialize_all_variables())
587.     else:
588.         s.run(tensorflow.global_variables_initializer())
589.     assert func(a).eval(session=s) == 0.5
590. 
591. 
592. def test_tensorflow_logical_operations():
593.     if not tensorflow:
594.         skip("tensorflow not installed.")
595.     expr = Not(And(Or(x, y), y))
596.     func = lambdify([x, y], expr, modules="tensorflow")
597.     a = tensorflow.constant(False)
598.     b = tensorflow.constant(True)
599.     s = tensorflow.Session()
600.     assert func(a, b).eval(session=s) == 0
601. 
602. 
603. def test_tensorflow_piecewise():
604.     if not tensorflow:
605.         skip("tensorflow not installed.")
606.     expr = Piecewise((0, Eq(x,0)), (-1, x < 0), (1, x > 0))
607.     func = lambdify(x, expr, modules="tensorflow")
608.     a = tensorflow.placeholder(dtype=tensorflow.float32)
609.     s = tensorflow.Session()
610.     assert func(a).eval(session=s, feed_dict={a: -1}) == -1
611.     assert func(a).eval(session=s, feed_dict={a: 0}) == 0
612.     assert func(a).eval(session=s, feed_dict={a: 1}) == 1
613. 
614. 
615. def test_tensorflow_multi_max():
616.     if not tensorflow:
617.         skip("tensorflow not installed.")
618.     expr = Max(x, -x, x**2)
619.     func = lambdify(x, expr, modules="tensorflow")
620.     a = tensorflow.placeholder(dtype=tensorflow.float32)
621.     s = tensorflow.Session()
622.     assert func(a).eval(session=s, feed_dict={a: -2}) == 4
623. 
624. 
625. def test_tensorflow_multi_min():
626.     if not tensorflow:
627.         skip("tensorflow not installed.")
628.     expr = Min(x, -x, x**2)
629.     func = lambdify(x, expr, modules="tensorflow")
630.     a = tensorflow.placeholder(dtype=tensorflow.float32)
631.     s = tensorflow.Session()
632.     assert func(a).eval(session=s, feed_dict={a: -2}) == -2
633. 
634. 
635. def test_tensorflow_relational():
636.     if not tensorflow:
637.         skip("tensorflow not installed.")
638.     expr = x >= 0
639.     func = lambdify(x, expr, modules="tensorflow")
640.     a = tensorflow.placeholder(dtype=tensorflow.float32)
641.     s = tensorflow.Session()
642.     assert func(a).eval(session=s, feed_dict={a: 1})
643. 
644. 
645. def test_integral():
646.     f = Lambda(x, exp(-x**2))
647.     l = lambdify(x, Integral(f(x), (x, -oo, oo)), modules="sympy")
648.     assert l(x) == Integral(exp(-x**2), (x, -oo, oo))
649. 
650. #================== Test symbolic ==================================
651. 
652. 
653. def test_sym_single_arg():
654.     f = lambdify(x, x * y)
655.     assert f(z) == z * y
656. 
657. 
658. def test_sym_list_args():
659.     f = lambdify([x, y], x + y + z)
660.     assert f(1, 2) == 3 + z
661. 
662. 
663. def test_sym_integral():
664.     f = Lambda(x, exp(-x**2))
665.     l = lambdify(x, Integral(f(x), (x, -oo, oo)), modules="sympy")
666.     assert l(y).doit() == sqrt(pi)
667. 
668. 
669. def test_namespace_order():
670.     # lambdify had a bug, such that module dictionaries or cached module
671.     # dictionaries would pull earlier namespaces into themselves.
672.     # Because the module dictionaries form the namespace of the
673.     # generated lambda, this meant that the behavior of a previously
674.     # generated lambda function could change as a result of later calls
675.     # to lambdify.
676.     n1 = {'f': lambda x: 'first f'}
677.     n2 = {'f': lambda x: 'second f',
678.           'g': lambda x: 'function g'}
679.     f = sympy.Function('f')
680.     g = sympy.Function('g')
681.     if1 = lambdify(x, f(x), modules=(n1, "sympy"))
682.     assert if1(1) == 'first f'
683.     if2 = lambdify(x, g(x), modules=(n2, "sympy"))
684.     # previously gave 'second f'
685.     assert if1(1) == 'first f'
686. 
687. 
688. def test_namespace_type():
689.     # lambdify had a bug where it would reject modules of type unicode
690.     # on Python 2.
691.     x = sympy.Symbol('x')
692.     lambdify(x, x, modules=u'math')
693. 
694. 
695. def test_imps():
696.     # Here we check if the default returned functions are anonymous - in
697.     # the sense that we can have more than one function with the same name
698.     f = implemented_function('f', lambda x: 2*x)
699.     g = implemented_function('f', lambda x: math.sqrt(x))
700.     l1 = lambdify(x, f(x))
701.     l2 = lambdify(x, g(x))
702.     assert str(f(x)) == str(g(x))
703.     assert l1(3) == 6
704.     assert l2(3) == math.sqrt(3)
705.     # check that we can pass in a Function as input
706.     func = sympy.Function('myfunc')
707.     assert not hasattr(func, '_imp_')
708.     my_f = implemented_function(func, lambda x: 2*x)
709.     assert hasattr(my_f, '_imp_')
710.     # Error for functions with same name and different implementation
711.     f2 = implemented_function("f", lambda x: x + 101)
712.     raises(ValueError, lambda: lambdify(x, f(f2(x))))
713. 
714. 
715. def test_imps_errors():
716.     # Test errors that implemented functions can return, and still be able to
717.     # form expressions.
718.     # See: https://github.com/sympy/sympy/issues/10810
719.     #
720.     # XXX: Removed AttributeError here. This test was added due to issue 10810
721.     # but that issue was about ValueError. It doesn't seem reasonable to
722.     # "support" catching AttributeError in the same context...
723.     for val, error_class in product((0, 0., 2, 2.0), (TypeError, ValueError)):
724. 
725.         def myfunc(a):
726.             if a == 0:
727.                 raise error_class
728.             return 1
729. 
730.         f = implemented_function('f', myfunc)
731.         expr = f(val)
732.         assert expr == f(val)
733. 
734. 
735. def test_imps_wrong_args():
736.     raises(ValueError, lambda: implemented_function(sin, lambda x: x))
737. 
738. 
739. def test_lambdify_imps():
740.     # Test lambdify with implemented functions
741.     # first test basic (sympy) lambdify
742.     f = sympy.cos
743.     assert lambdify(x, f(x))(0) == 1
744.     assert lambdify(x, 1 + f(x))(0) == 2
745.     assert lambdify((x, y), y + f(x))(0, 1) == 2
746.     # make an implemented function and test
747.     f = implemented_function("f", lambda x: x + 100)
748.     assert lambdify(x, f(x))(0) == 100
749.     assert lambdify(x, 1 + f(x))(0) == 101
750.     assert lambdify((x, y), y + f(x))(0, 1) == 101
751.     # Can also handle tuples, lists, dicts as expressions
752.     lam = lambdify(x, (f(x), x))
753.     assert lam(3) == (103, 3)
754.     lam = lambdify(x, [f(x), x])
755.     assert lam(3) == [103, 3]
756.     lam = lambdify(x, [f(x), (f(x), x)])
757.     assert lam(3) == [103, (103, 3)]
758.     lam = lambdify(x, {f(x): x})
759.     assert lam(3) == {103: 3}
760.     lam = lambdify(x, {f(x): x})
761.     assert lam(3) == {103: 3}
762.     lam = lambdify(x, {x: f(x)})
763.     assert lam(3) == {3: 103}
764.     # Check that imp preferred to other namespaces by default
765.     d = {'f': lambda x: x + 99}
766.     lam = lambdify(x, f(x), d)
767.     assert lam(3) == 103
768.     # Unless flag passed
769.     lam = lambdify(x, f(x), d, use_imps=False)
770.     assert lam(3) == 102
771. 
772. 
773. def test_dummification():
774.     t = symbols('t')
775.     F = Function('F')
776.     G = Function('G')
777.     #"\alpha" is not a valid python variable name
778.     #lambdify should sub in a dummy for it, and return
779.     #without a syntax error
780.     alpha = symbols(r'\alpha')
781.     some_expr = 2 * F(t)**2 / G(t)
782.     lam = lambdify((F(t), G(t)), some_expr)
783.     assert lam(3, 9) == 2
784.     lam = lambdify(sin(t), 2 * sin(t)**2)
785.     assert lam(F(t)) == 2 * F(t)**2
786.     #Test that \alpha was properly dummified
787.     lam = lambdify((alpha, t), 2*alpha + t)
788.     assert lam(2, 1) == 5
789.     raises(SyntaxError, lambda: lambdify(F(t) * G(t), F(t) * G(t) + 5))
790.     raises(SyntaxError, lambda: lambdify(2 * F(t), 2 * F(t) + 5))
791.     raises(SyntaxError, lambda: lambdify(2 * F(t), 4 * F(t) + 5))
792. 
793. 
794. def test_curly_matrix_symbol():
795.     # Issue #15009
796.     curlyv = sympy.MatrixSymbol("{v}", 2, 1)
797.     lam = lambdify(curlyv, curlyv)
798.     assert lam(1)==1
799.     lam = lambdify(curlyv, curlyv, dummify=True)
800.     assert lam(1)==1
801. 
802. 
803. def test_python_keywords():
804.     # Test for issue 7452. The automatic dummification should ensure use of
805.     # Python reserved keywords as symbol names will create valid lambda
806.     # functions. This is an additional regression test.
807.     python_if = symbols('if')
808.     expr = python_if / 2
809.     f = lambdify(python_if, expr)
810.     assert f(4.0) == 2.0
811. 
812. 
813. def test_lambdify_docstring():
814.     func = lambdify((w, x, y, z), w + x + y + z)
815.     ref = (
816.         "Created with lambdify. Signature:\n\n"
817.         "func(w, x, y, z)\n\n"
818.         "Expression:\n\n"
819.         "w + x + y + z"
820.     ).splitlines()
821.     assert func.__doc__.splitlines()[:len(ref)] == ref
822.     syms = symbols('a1:26')
823.     func = lambdify(syms, sum(syms))
824.     ref = (
825.         "Created with lambdify. Signature:\n\n"
826.         "func(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14, a15,\n"
827.         "        a16, a17, a18, a19, a20, a21, a22, a23, a24, a25)\n\n"
828.         "Expression:\n\n"
829.         "a1 + a10 + a11 + a12 + a13 + a14 + a15 + a16 + a17 + a18 + a19 + a2 + a20 +..."
830.     ).splitlines()
831.     assert func.__doc__.splitlines()[:len(ref)] == ref
832. 
833. 
834. #================== Test special printers ==========================
835. 
836. 
837. def test_special_printers():
838.     class IntervalPrinter(LambdaPrinter):
839.         """Use ``lambda`` printer but print numbers as ``mpi`` intervals. """
840. 
841.         def _print_Integer(self, expr):
842.             return "mpi('%s')" % super(IntervalPrinter, self)._print_Integer(expr)
843. 
844.         def _print_Rational(self, expr):
845.             return "mpi('%s')" % super(IntervalPrinter, self)._print_Rational(expr)
846. 
847.     def intervalrepr(expr):
848.         return IntervalPrinter().doprint(expr)
849. 
850.     expr = sqrt(sqrt(2) + sqrt(3)) + S(1)/2
851. 
852.     func0 = lambdify((), expr, modules="mpmath", printer=intervalrepr)
853.     func1 = lambdify((), expr, modules="mpmath", printer=IntervalPrinter)
854.     func2 = lambdify((), expr, modules="mpmath", printer=IntervalPrinter())
855. 
856.     mpi = type(mpmath.mpi(1, 2))
857. 
858.     assert isinstance(func0(), mpi)
859.     assert isinstance(func1(), mpi)
860.     assert isinstance(func2(), mpi)
861. 
862. 
863. def test_true_false():
864.     # We want exact is comparison here, not just ==
865.     assert lambdify([], true)() is True
866.     assert lambdify([], false)() is False
867. 
868. 
869. def test_issue_2790():
870.     assert lambdify((x, (y, z)), x + y)(1, (2, 4)) == 3
871.     assert lambdify((x, (y, (w, z))), w + x + y + z)(1, (2, (3, 4))) == 10
872.     assert lambdify(x, x + 1, dummify=False)(1) == 2
873. 
874. 
875. def test_issue_12092():
876.     f = implemented_function('f', lambda x: x**2)
877.     assert f(f(2)).evalf() == Float(16)
878. 
879. 
880. def test_issue_14911():
881.     class Variable(sympy.Symbol):
882.         def _sympystr(self, printer):
883.             return printer.doprint(self.name)
884. 
885.         _lambdacode = _sympystr
886.         _numpycode = _sympystr
887. 
888.     x = Variable('x')
889.     y = 2 * x
890.     code = LambdaPrinter().doprint(y)
891.     assert code.replace(' ', '') == '2*x'
892. 
893. 
894. def test_ITE():
895.     assert lambdify((x, y, z), ITE(x, y, z))(True, 5, 3) == 5
896.     assert lambdify((x, y, z), ITE(x, y, z))(False, 5, 3) == 3
897. 
898. 
899. def test_Min_Max():
900.     # see gh-10375
901.     assert lambdify((x, y, z), Min(x, y, z))(1, 2, 3) == 1
902.     assert lambdify((x, y, z), Max(x, y, z))(1, 2, 3) == 3
903. 
904. 
905. def test_Indexed():
906.     # Issue #10934
907.     if not numpy:
908.         skip("numpy not installed")
909. 
910.     a = IndexedBase('a')
911.     i, j = symbols('i j')
912.     b = numpy.array([[1, 2], [3, 4]])
913.     assert lambdify(a, Sum(a[x, y], (x, 0, 1), (y, 0, 1)))(b) == 10
914. 
915. 
916. def test_issue_12173():
917.     #test for issue 12173
918.     exp1 = lambdify((x, y), uppergamma(x, y),"mpmath")(1, 2)
919.     exp2 = lambdify((x, y), lowergamma(x, y),"mpmath")(1, 2)
920.     assert exp1 == uppergamma(1, 2).evalf()
921.     assert exp2 == lowergamma(1, 2).evalf()
922. 
923. 
924. def test_issue_13642():
925.     if not numpy:
926.         skip("numpy not installed")
927.     f = lambdify(x, sinc(x))
928.     assert Abs(f(1) - sinc(1)).n() < 1e-15
929. 
930. 
931. def test_sinc_mpmath():
932.     f = lambdify(x, sinc(x), "mpmath")
933.     assert Abs(f(1) - sinc(1)).n() < 1e-15
934. 
935. 
936. def test_lambdify_dummy_arg():
937.     d1 = Dummy()
938.     f1 = lambdify(d1, d1 + 1, dummify=False)
939.     assert f1(2) == 3
940.     f1b = lambdify(d1, d1 + 1)
941.     assert f1b(2) == 3
942.     d2 = Dummy('x')
943.     f2 = lambdify(d2, d2 + 1)
944.     assert f2(2) == 3
945.     f3 = lambdify([[d2]], d2 + 1)
946.     assert f3([2]) == 3
947. 
948. 
949. def test_lambdify_mixed_symbol_dummy_args():
950.     d = Dummy()
951.     # Contrived example of name clash
952.     dsym = symbols(str(d))
953.     f = lambdify([d, dsym], d - dsym)
954.     assert f(4, 1) == 3
955. 
956. 
957. def test_numpy_array_arg():
958.     # Test for issue 14655 (numpy part)
959.     if not numpy:
960.         skip("numpy not installed")
961. 
962.     f = lambdify([[x, y]], x*x + y, 'numpy')
963. 
964.     assert f(numpy.array([2.0, 1.0])) == 5
965. 
966. 
967. def test_tensorflow_array_arg():
968.     # Test for issue 14655 (tensorflow part)
969.     if not tensorflow:
970.         skip("tensorflow not installed.")
971. 
972.     f = lambdify([[x, y]], x*x + y, 'tensorflow')
973. 
974.     fcall = f(tensorflow.constant([2.0, 1.0]))
975. 
976.     s = tensorflow.Session()
977.     assert s.run(fcall) == 5
978. 
979. 
980. def test_scipy_fns():
981.     if not scipy:
982.         skip("scipy not installed")
983. 
984.     single_arg_sympy_fns = [erf, erfc, factorial, gamma, loggamma, digamma]
985.     single_arg_scipy_fns = [scipy.special.erf, scipy.special.erfc,
986.         scipy.special.factorial, scipy.special.gamma, scipy.special.gammaln,
987.         scipy.special.psi]
988.     numpy.random.seed(0)
989.     for (sympy_fn, scipy_fn) in zip(single_arg_sympy_fns, single_arg_scipy_fns):
990.         f = lambdify(x, sympy_fn(x), modules="scipy")
991.         for i in range(20):
992.             tv = numpy.random.uniform(-10, 10) + 1j*numpy.random.uniform(-5, 5)
993.             # SciPy thinks that factorial(z) is 0 when re(z) < 0.
994.             # SymPy does not think so.
995.             if sympy_fn == factorial and numpy.real(tv) < 0:
996.                 tv = tv + 2*numpy.abs(numpy.real(tv))
997.             # SciPy supports gammaln for real arguments only,
998.             # and there is also a branch cut along the negative real axis
999.             if sympy_fn == loggamma:
1000.                 tv = numpy.abs(tv)
1001.             # SymPy's digamma evaluates as polygamma(0, z)
1002.             # which SciPy supports for real arguments only
1003.             if sympy_fn == digamma:
1004.                 tv = numpy.real(tv)
1005.             sympy_result = sympy_fn(tv).evalf()
1006.             assert abs(f(tv) - sympy_result) < 1e-13*(1 + abs(sympy_result))
1007.             assert abs(f(tv) - scipy_fn(tv)) < 1e-13*(1 + abs(sympy_result))
1008. 
1009.     double_arg_sympy_fns = [RisingFactorial, besselj, bessely, besseli,
1010.         besselk]
1011.     double_arg_scipy_fns = [scipy.special.poch, scipy.special.jv,
1012.         scipy.special.yv, scipy.special.iv, scipy.special.kv]
1013.     for (sympy_fn, scipy_fn) in zip(double_arg_sympy_fns, double_arg_scipy_fns):
1014.         f = lambdify((x, y), sympy_fn(x, y), modules="scipy")
1015.         for i in range(20):
1016.             # SciPy supports only real orders of Bessel functions
1017.             tv1 = numpy.random.uniform(-10, 10)
1018.             tv2 = numpy.random.uniform(-10, 10) + 1j*numpy.random.uniform(-5, 5)
1019.             # SciPy supports poch for real arguments only
1020.             if sympy_fn == RisingFactorial:
1021.                 tv2 = numpy.real(tv2)
1022.             sympy_result = sympy_fn(tv1, tv2).evalf()
1023.             assert abs(f(tv1, tv2) - sympy_result) < 1e-13*(1 + abs(sympy_result))
1024.             assert abs(f(tv1, tv2) - scipy_fn(tv1, tv2)) < 1e-13*(1 + abs(sympy_result))
1025. 
1026. 
1027. def test_scipy_polys():
1028.     if not scipy:
1029.         skip("scipy not installed")
1030.     numpy.random.seed(0)
1031. 
1032.     params = symbols('n k a b')
1033.     # list polynomials with the number of parameters
1034.     polys = [
1035.         (chebyshevt, 1),
1036.         (chebyshevu, 1),
1037.         (legendre, 1),
1038.         (hermite, 1),
1039.         (laguerre, 1),
1040.         (gegenbauer, 2),
1041.         (assoc_legendre, 2),
1042.         (assoc_laguerre, 2),
1043.         (jacobi, 3)
1044.     ]
1045. 
1046.     for sympy_fn, num_params in polys:
1047.         args = params[:num_params] + (x,)
1048.         f = lambdify(args, sympy_fn(*args))
1049.         for i in range(10):
1050.             tn = numpy.random.randint(3, 10)
1051.             tparams = tuple(numpy.random.uniform(0, 5, size=num_params-1))
1052.             tv = numpy.random.uniform(-10, 10) + 1j*numpy.random.uniform(-5, 5)
1053.             # SciPy supports hermite for real arguments only
1054.             if sympy_fn == hermite:
1055.                 tv = numpy.real(tv)
1056.             # assoc_legendre needs x in (-1, 1) and integer param at most n
1057.             if sympy_fn == assoc_legendre:
1058.                 tv = numpy.random.uniform(-1, 1)
1059.                 tparams = tuple(numpy.random.randint(1, tn, size=1))
1060.             vals = (tn,) + tparams + (tv,)
1061.             sympy_result = sympy_fn(*vals).evalf()
1062.             assert abs(f(*vals) - sympy_result) < 1e-13*(1 + abs(sympy_result))
1063. 
1064. 
1065. def test_lambdify_inspect():
1066.     f = lambdify(x, x**2)
1067.     # Test that inspect.getsource works but don't hard-code implementation
1068.     # details
1069.     assert 'x**2' in inspect.getsource(f)
1070. 
1071. 
1072. def test_issue_14941():
1073.     x, y = Dummy(), Dummy()
1074. 
1075.     # test dict
1076.     f1 = lambdify([x, y], {x: 3, y: 3}, 'sympy')
1077.     assert f1(2, 3) == {2: 3, 3: 3}
1078. 
1079.     # test tuple
1080.     f2 = lambdify([x, y], (y, x), 'sympy')
1081.     assert f2(2, 3) == (3, 2)
1082. 
1083.     # test list
1084.     f3 = lambdify([x, y], [y, x], 'sympy')
1085.     assert f3(2, 3) == [3, 2]
1086. 
1087. 
1088. def test_lambdify_Derivative_arg_issue_16468():
1089.     f = Function('f')(x)
1090.     fx = f.diff()
1091.     assert lambdify((f, fx), f + fx)(10, 5) == 15
1092.     assert eval(lambdastr((f, fx), f/fx))(10, 5) == 2
1093.     raises(SyntaxError, lambda:
1094.         eval(lambdastr((f, fx), f/fx, dummify=False)))
1095.     assert eval(lambdastr((f, fx), f/fx, dummify=True))(10, 5) == 2
1096.     assert eval(lambdastr((fx, f), f/fx, dummify=True))(S(10), 5) == S.Half
1097.     assert lambdify(fx, 1 + fx)(41) == 42
1098.     assert eval(lambdastr(fx, 1 + fx, dummify=True))(41) == 42
1099. 
1100. 
1101. def test_imag_real():
1102.     f_re = lambdify([z], sympy.re(z))
1103.     val = 3+2j
1104.     assert f_re(val) == val.real
1105. 
1106.     f_im = lambdify([z], sympy.im(z))  # see #15400
1107.     assert f_im(val) == val.imag
1108. 
1109. 
1110. def test_MatrixSymbol_issue_15578():
1111.     if not numpy:
1112.         skip("numpy not installed")
1113.     A = MatrixSymbol('A', 2, 2)
1114.     A0 = numpy.array([[1, 2], [3, 4]])
1115.     f = lambdify(A, A**(-1))
1116.     assert numpy.allclose(f(A0), numpy.array([[-2., 1.], [1.5, -0.5]]))
1117.     g = lambdify(A, A**3)
1118.     assert numpy.allclose(g(A0), numpy.array([[37, 54], [81, 118]]))
1119. 
1120. 
1121. def test_issue_15654():
1122.     if not scipy:
1123.         skip("scipy not installed")
1124.     from sympy.abc import n, l, r, Z
1125.     from sympy.physics import hydrogen
1126.     nv, lv, rv, Zv = 1, 0, 3, 1
1127.     sympy_value = hydrogen.R_nl(nv, lv, rv, Zv).evalf()
1128.     f = lambdify((n, l, r, Z), hydrogen.R_nl(n, l, r, Z))
1129.     scipy_value = f(nv, lv, rv, Zv)
1130.     assert abs(sympy_value - scipy_value) < 1e-15
1131. 
1132. def test_issue_15827():
1133.     if not numpy:
1134.         skip("numpy not installed")
1135.     A = MatrixSymbol("A", 3, 3)
1136.     B = MatrixSymbol("B", 2, 3)
1137.     C = MatrixSymbol("C", 3, 4)
1138.     D = MatrixSymbol("D", 4, 5)
1139.     k=symbols("k")
1140.     f = lambdify(A, (2*k)*A)
1141.     g = lambdify(A, (2+k)*A)
1142.     h = lambdify(A, 2*A)
1143.     i = lambdify((B, C, D), 2*B*C*D)
1144.     assert numpy.array_equal(f(numpy.array([[1, 2, 3], [1, 2, 3], [1, 2, 3]])), \
1145.     numpy.array([[2*k, 4*k, 6*k], [2*k, 4*k, 6*k], [2*k, 4*k, 6*k]], dtype=object))
1146. 
1147.     assert numpy.array_equal(g(numpy.array([[1, 2, 3], [1, 2, 3], [1, 2, 3]])), \
1148.     numpy.array([[k + 2, 2*k + 4, 3*k + 6], [k + 2, 2*k + 4, 3*k + 6], \
1149.     [k + 2, 2*k + 4, 3*k + 6]], dtype=object))
1150. 
1151.     assert numpy.array_equal(h(numpy.array([[1, 2, 3], [1, 2, 3], [1, 2, 3]])), \
1152.     numpy.array([[2, 4, 6], [2, 4, 6], [2, 4, 6]]))
1153. 
1154.     assert numpy.array_equal(i(numpy.array([[1, 2, 3], [1, 2, 3]]), numpy.array([[1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 4]]), \
1155.     numpy.array([[1, 2, 3, 4, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4, 5]])), numpy.array([[ 120, 240, 360, 480, 600], \
1156.     [ 120, 240, 360, 480, 600]]))

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 00:53:39,714 - thread-124975134525120.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The provided context is sufficient. I have identified three relevant test cases. The first, `test_Indexed` from `sympy/utilities/tests/test_lambdify.py`, directly addresses the user's issue with `Indexed` objects. The second, `test_PythonCodePrinter` from `sympy/printing/tests/test_pycode.py`, demonstrates how other complex objects like `Piecewise` are handled by the printer, providing a template for how `Indexed` should be tested. The third, `test_numpy_piecewise` from `sympy/utilities/tests/test_lambdify.py`, shows `lambdify`'s handling of complex structures for a backend that uses a subclass of `PythonCodePrinter`, which is relevant to the user's `lambdify` use case. All necessary code and imports for these tests are available in the provided context." query='' extra_requirements='' purpose=''
2025-12-23 00:53:39,715 - thread-124975134525120.prometheus_context_collector - INFO - Successfully retrieved 3 context snippets
