2025-12-21 19:08:12,871 - thread-131697502848704.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 19:08:13,000 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   └── yacc.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:08:23,041 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find test cases related to the `InheritDocstrings` metaclass. The provided patch modifies `astropy/utils/misc.py`. The corresponding test file, which is likely to contain relevant tests, is `astropy/utils/tests/test_misc.py`. I need to inspect this file to find test cases that demonstrate the functionality of `InheritDocstrings`, particularly with respect to properties, to satisfy the user's request." query='Please provide the full content of the file `astropy/utils/tests/test_misc.py`.' extra_requirements='' purpose="I need to find relevant test cases for the `InheritDocstrings` metaclass, which is modified in the user's patch."
2025-12-21 19:08:23,042 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/utils/tests/test_misc.py`.
2025-12-21 19:08:23,043 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:08:23,043 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:08:23,044 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:08:23,044 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/utils/tests/test_misc.py`.
Purpose: I need to find relevant test cases for the `InheritDocstrings` metaclass, which is modified in the user's patch.
2025-12-21 19:08:26,211 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `astropy/utils/tests/test_misc.py` so you can examine the test cases for the `InheritDocstrings` metaclass.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/utils/tests/test_misc.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2143, 'candidates_token_count': 67, 'total_token_count': 2412, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2143}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 67}], 'thoughts_token_count': 202, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.23507448452622143, 'model_name': 'gemini-2.5-pro'} id='run--6f8aa746-8b0b-41e8-97f7-f7fa560c30b1-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/utils/tests/test_misc.py'}, 'id': '03a306af-98a0-478e-acdd-ec4cb6e5c600', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2143, 'output_tokens': 67, 'total_tokens': 2412, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 202}}
2025-12-21 19:08:35,077 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `astropy/utils/tests/test_misc.py` as you requested. This file contains test cases for the `InheritDocstrings` metaclass, which will allow you to examine the existing tests and determine how to adapt them for your patch. You can now inspect the file to find the test cases that are most relevant to your changes.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4453, 'candidates_token_count': 79, 'total_token_count': 5312, 'cached_content_token_count': 1690, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4453}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1690}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 79}], 'thoughts_token_count': 780}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4292392972149426, 'model_name': 'gemini-2.5-pro'} id='run--a132cb50-17f7-447e-9f13-80ecb8d3e4d6-0' usage_metadata={'input_tokens': 4453, 'output_tokens': 79, 'total_tokens': 5312, 'input_token_details': {'cache_read': 1690}, 'output_token_details': {'reasoning': 780}}
2025-12-21 19:08:35,079 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/utils/tests/test_misc.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find relevant test cases for the `InheritDocstrings` metaclass, which is modified in the user's patch.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/utils/tests/test_misc.py
Line number range: 1 - 134
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import json
4. import os
5. from datetime import datetime
6. import locale
7. 
8. import pytest
9. import numpy as np
10. 
11. from .. import data, misc
12. 
13. 
14. def test_isiterable():
15.     assert misc.isiterable(2) is False
16.     assert misc.isiterable([2]) is True
17.     assert misc.isiterable([1, 2, 3]) is True
18.     assert misc.isiterable(np.array(2)) is False
19.     assert misc.isiterable(np.array([1, 2, 3])) is True
20. 
21. 
22. def test_signal_number_to_name_no_failure():
23.     # Regression test for #5340: ensure signal_number_to_name throws no
24.     # AttributeError (it used ".iteritems()" which was removed in Python3).
25.     misc.signal_number_to_name(0)
26. 
27. 
28. @pytest.mark.remote_data
29. def test_api_lookup():
30.     strurl = misc.find_api_page('astropy.utils.misc', 'dev', False, timeout=3)
31.     objurl = misc.find_api_page(misc, 'dev', False, timeout=3)
32. 
33.     assert strurl == objurl
34.     assert strurl == 'http://devdocs.astropy.org/utils/index.html#module-astropy.utils.misc'
35. 
36. 
37. def test_skip_hidden():
38.     path = data._find_pkg_data_path('data')
39.     for root, dirs, files in os.walk(path):
40.         assert '.hidden_file.txt' in files
41.         assert 'local.dat' in files
42.         # break after the first level since the data dir contains some other
43.         # subdirectories that don't have these files
44.         break
45. 
46.     for root, dirs, files in misc.walk_skip_hidden(path):
47.         assert '.hidden_file.txt' not in files
48.         assert 'local.dat' in files
49.         break
50. 
51. 
52. def test_JsonCustomEncoder():
53.     from ... import units as u
54.     assert json.dumps(np.arange(3), cls=misc.JsonCustomEncoder) == '[0, 1, 2]'
55.     assert json.dumps(1+2j, cls=misc.JsonCustomEncoder) == '[1.0, 2.0]'
56.     assert json.dumps(set([1, 2, 1]), cls=misc.JsonCustomEncoder) == '[1, 2]'
57.     assert json.dumps(b'hello world \xc3\x85',
58.                       cls=misc.JsonCustomEncoder) == '"hello world \\u00c5"'
59.     assert json.dumps({1: 2},
60.                       cls=misc.JsonCustomEncoder) == '{"1": 2}'  # default
61.     assert json.dumps({1: u.m}, cls=misc.JsonCustomEncoder) == '{"1": "m"}'
62.     # Quantities
63.     tmp = json.dumps({'a': 5*u.cm}, cls=misc.JsonCustomEncoder)
64.     newd = json.loads(tmp)
65.     tmpd = {"a": {"unit": "cm", "value": 5.0}}
66.     assert newd == tmpd
67.     tmp2 = json.dumps({'a': np.arange(2)*u.cm}, cls=misc.JsonCustomEncoder)
68.     newd = json.loads(tmp2)
69.     tmpd = {"a": {"unit": "cm", "value": [0., 1.]}}
70.     assert newd == tmpd
71.     tmp3 = json.dumps({'a': np.arange(2)*u.erg/u.s}, cls=misc.JsonCustomEncoder)
72.     newd = json.loads(tmp3)
73.     tmpd = {"a": {"unit": "erg / s", "value": [0., 1.]}}
74.     assert newd == tmpd
75. 
76. 
77. def test_inherit_docstrings():
78.     class Base(metaclass=misc.InheritDocstrings):
79.         def __call__(self, *args):
80.             "FOO"
81.             pass
82. 
83.     class Subclass(Base):
84.         def __call__(self, *args):
85.             pass
86. 
87.     if Base.__call__.__doc__ is not None:
88.         # TODO: Maybe if __doc__ is None this test should be skipped instead?
89.         assert Subclass.__call__.__doc__ == "FOO"
90. 
91. 
92. def test_set_locale():
93.     # First, test if the required locales are available
94.     current = locale.setlocale(locale.LC_ALL)
95.     try:
96.         locale.setlocale(locale.LC_ALL, str('en_US'))
97.         locale.setlocale(locale.LC_ALL, str('de_DE'))
98.     except locale.Error as e:
99.         pytest.skip('Locale error: {}'.format(e))
100.     finally:
101.         locale.setlocale(locale.LC_ALL, current)
102. 
103.     date = datetime(2000, 10, 1, 0, 0, 0)
104.     day_mon = date.strftime('%a, %b')
105. 
106.     with misc.set_locale('en_US'):
107.         assert date.strftime('%a, %b') == 'Sun, Oct'
108. 
109.     with misc.set_locale('de_DE'):
110.         assert date.strftime('%a, %b') == 'So, Okt'
111. 
112.     # Back to original
113.     assert date.strftime('%a, %b') == day_mon
114. 
115.     with misc.set_locale(current):
116.         assert date.strftime('%a, %b') == day_mon
117. 
118. 
119. def test_check_broadcast():
120.     assert misc.check_broadcast((10, 1), (3,)) == (10, 3)
121.     assert misc.check_broadcast((10, 1), (3,), (4, 1, 1, 3)) == (4, 1, 10, 3)
122.     with pytest.raises(ValueError):
123.         misc.check_broadcast((10, 2), (3,))
124. 
125.     with pytest.raises(ValueError):
126.         misc.check_broadcast((10, 1), (3,), (4, 1, 2, 3))
127. 
128. 
129. def test_dtype_bytes_or_chars():
130.     assert misc.dtype_bytes_or_chars(np.dtype(np.float64)) == 8
131.     assert misc.dtype_bytes_or_chars(np.dtype(object)) is None
132.     assert misc.dtype_bytes_or_chars(np.dtype(np.int32)) == 4
133.     assert misc.dtype_bytes_or_chars(np.array(b'12345').dtype) == 5
134.     assert misc.dtype_bytes_or_chars(np.array(u'12345').dtype) == 5

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:08:40,209 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file `astropy/utils/tests/test_misc.py`.\n\n2. Extended relevance:\n   - This context represents the entire file content provided, which directly and completely answers the user's query.\n   - The purpose mentions finding test cases for `InheritDocstrings`, and the test function `test_inherit_docstrings` (lines 77-90) is contained within this file, making the entire file relevant for complete context.", relative_path='astropy/utils/tests/test_misc.py', start_line=1, end_line=134)]
2025-12-21 19:08:40,210 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/utils/tests/test_misc.py`.
2025-12-21 19:08:40,210 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:08:40,210 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:08:40,211 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 19:08:40,211 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 19:08:40,212 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   └── yacc.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/utils/tests/test_misc.py`.
Extra Requirements: 
Purpose: I need to find relevant test cases for the `InheritDocstrings` metaclass, which is modified in the user's patch.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/utils/tests/test_misc.py
Line number range: 1 - 134
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import json
4. import os
5. from datetime import datetime
6. import locale
7. 
8. import pytest
9. import numpy as np
10. 
11. from .. import data, misc
12. 
13. 
14. def test_isiterable():
15.     assert misc.isiterable(2) is False
16.     assert misc.isiterable([2]) is True
17.     assert misc.isiterable([1, 2, 3]) is True
18.     assert misc.isiterable(np.array(2)) is False
19.     assert misc.isiterable(np.array([1, 2, 3])) is True
20. 
21. 
22. def test_signal_number_to_name_no_failure():
23.     # Regression test for #5340: ensure signal_number_to_name throws no
24.     # AttributeError (it used ".iteritems()" which was removed in Python3).
25.     misc.signal_number_to_name(0)
26. 
27. 
28. @pytest.mark.remote_data
29. def test_api_lookup():
30.     strurl = misc.find_api_page('astropy.utils.misc', 'dev', False, timeout=3)
31.     objurl = misc.find_api_page(misc, 'dev', False, timeout=3)
32. 
33.     assert strurl == objurl
34.     assert strurl == 'http://devdocs.astropy.org/utils/index.html#module-astropy.utils.misc'
35. 
36. 
37. def test_skip_hidden():
38.     path = data._find_pkg_data_path('data')
39.     for root, dirs, files in os.walk(path):
40.         assert '.hidden_file.txt' in files
41.         assert 'local.dat' in files
42.         # break after the first level since the data dir contains some other
43.         # subdirectories that don't have these files
44.         break
45. 
46.     for root, dirs, files in misc.walk_skip_hidden(path):
47.         assert '.hidden_file.txt' not in files
48.         assert 'local.dat' in files
49.         break
50. 
51. 
52. def test_JsonCustomEncoder():
53.     from ... import units as u
54.     assert json.dumps(np.arange(3), cls=misc.JsonCustomEncoder) == '[0, 1, 2]'
55.     assert json.dumps(1+2j, cls=misc.JsonCustomEncoder) == '[1.0, 2.0]'
56.     assert json.dumps(set([1, 2, 1]), cls=misc.JsonCustomEncoder) == '[1, 2]'
57.     assert json.dumps(b'hello world \xc3\x85',
58.                       cls=misc.JsonCustomEncoder) == '"hello world \\u00c5"'
59.     assert json.dumps({1: 2},
60.                       cls=misc.JsonCustomEncoder) == '{"1": 2}'  # default
61.     assert json.dumps({1: u.m}, cls=misc.JsonCustomEncoder) == '{"1": "m"}'
62.     # Quantities
63.     tmp = json.dumps({'a': 5*u.cm}, cls=misc.JsonCustomEncoder)
64.     newd = json.loads(tmp)
65.     tmpd = {"a": {"unit": "cm", "value": 5.0}}
66.     assert newd == tmpd
67.     tmp2 = json.dumps({'a': np.arange(2)*u.cm}, cls=misc.JsonCustomEncoder)
68.     newd = json.loads(tmp2)
69.     tmpd = {"a": {"unit": "cm", "value": [0., 1.]}}
70.     assert newd == tmpd
71.     tmp3 = json.dumps({'a': np.arange(2)*u.erg/u.s}, cls=misc.JsonCustomEncoder)
72.     newd = json.loads(tmp3)
73.     tmpd = {"a": {"unit": "erg / s", "value": [0., 1.]}}
74.     assert newd == tmpd
75. 
76. 
77. def test_inherit_docstrings():
78.     class Base(metaclass=misc.InheritDocstrings):
79.         def __call__(self, *args):
80.             "FOO"
81.             pass
82. 
83.     class Subclass(Base):
84.         def __call__(self, *args):
85.             pass
86. 
87.     if Base.__call__.__doc__ is not None:
88.         # TODO: Maybe if __doc__ is None this test should be skipped instead?
89.         assert Subclass.__call__.__doc__ == "FOO"
90. 
91. 
92. def test_set_locale():
93.     # First, test if the required locales are available
94.     current = locale.setlocale(locale.LC_ALL)
95.     try:
96.         locale.setlocale(locale.LC_ALL, str('en_US'))
97.         locale.setlocale(locale.LC_ALL, str('de_DE'))
98.     except locale.Error as e:
99.         pytest.skip('Locale error: {}'.format(e))
100.     finally:
101.         locale.setlocale(locale.LC_ALL, current)
102. 
103.     date = datetime(2000, 10, 1, 0, 0, 0)
104.     day_mon = date.strftime('%a, %b')
105. 
106.     with misc.set_locale('en_US'):
107.         assert date.strftime('%a, %b') == 'Sun, Oct'
108. 
109.     with misc.set_locale('de_DE'):
110.         assert date.strftime('%a, %b') == 'So, Okt'
111. 
112.     # Back to original
113.     assert date.strftime('%a, %b') == day_mon
114. 
115.     with misc.set_locale(current):
116.         assert date.strftime('%a, %b') == day_mon
117. 
118. 
119. def test_check_broadcast():
120.     assert misc.check_broadcast((10, 1), (3,)) == (10, 3)
121.     assert misc.check_broadcast((10, 1), (3,), (4, 1, 1, 3)) == (4, 1, 10, 3)
122.     with pytest.raises(ValueError):
123.         misc.check_broadcast((10, 2), (3,))
124. 
125.     with pytest.raises(ValueError):
126.         misc.check_broadcast((10, 1), (3,), (4, 1, 2, 3))
127. 
128. 
129. def test_dtype_bytes_or_chars():
130.     assert misc.dtype_bytes_or_chars(np.dtype(np.float64)) == 8
131.     assert misc.dtype_bytes_or_chars(np.dtype(object)) is None
132.     assert misc.dtype_bytes_or_chars(np.dtype(np.int32)) == 4
133.     assert misc.dtype_bytes_or_chars(np.array(b'12345').dtype) == 5
134.     assert misc.dtype_bytes_or_chars(np.array(u'12345').dtype) == 5

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:09:11,184 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The current context from `astropy/utils/tests/test_misc.py` provides one relevant test case for `InheritDocstrings`, but it only covers methods, not properties. The bug is specifically about properties. To find more relevant test cases, especially ones that test properties and their docstrings, I need to look into other files. `astropy/utils/tests/test_decorators.py` is a good candidate because decorators are conceptually similar to the metaclass in question, and its tests might reveal patterns for testing properties and their docstrings within the `astropy` codebase.' query='Please provide the full content of the file `astropy/utils/tests/test_decorators.py`.' extra_requirements='' purpose="This file may contain test cases for properties and their docstrings, which are relevant to the user's patch for the `InheritDocstrings` metaclass."
2025-12-21 19:09:11,185 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/utils/tests/test_decorators.py`.
2025-12-21 19:09:11,185 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:09:11,186 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:09:11,187 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:09:11,187 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/utils/tests/test_decorators.py`.
Purpose: This file may contain test cases for properties and their docstrings, which are relevant to the user's patch for the `InheritDocstrings` metaclass.
2025-12-21 19:09:13,516 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of `astropy/utils/tests/test_decorators.py` to understand the existing test cases for properties and docstrings. This will help in analyzing how the `InheritDocstrings` metaclass is being tested and what modifications might be needed.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/utils/tests/test_decorators.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2148, 'candidates_token_count': 84, 'total_token_count': 2327, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2148}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 84}], 'thoughts_token_count': 95, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12314076650710333, 'model_name': 'gemini-2.5-pro'} id='run--b3b82e2f-4944-43fd-8d67-415fc6dc621e-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/utils/tests/test_decorators.py'}, 'id': '48ab3340-05ba-42a5-8828-c28bc53e4e47', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2148, 'output_tokens': 84, 'total_tokens': 2327, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 95}}
2025-12-21 19:09:22,003 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the first 500 lines of the file `astropy/utils/tests/test_decorators.py`. I will now check the total number of lines in the file to ensure I can retrieve the entire content for you.' additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "astropy/utils/tests/test_decorators.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9033, 'candidates_token_count': 76, 'total_token_count': 9699, 'cached_content_token_count': 1828, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9033}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1828}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 590}, 'finish_reason': 'STOP', 'avg_logprobs': -0.861126046431692, 'model_name': 'gemini-2.5-pro'} id='run--3fadced7-b265-4804-a054-6f8ddb5bbdf9-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'astropy/utils/tests/test_decorators.py'}, 'id': '971c45f2-2b94-4192-9215-13d2c761a7b4', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9033, 'output_tokens': 76, 'total_tokens': 9699, 'input_token_details': {'cache_read': 1828}, 'output_token_details': {'reasoning': 590}}
2025-12-21 19:09:26,597 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the beginning of the file `astropy/utils/tests/test_decorators.py` and will now read the remaining portion to provide you with the complete content. This will give a full picture of the test cases related to decorators, properties, and docstrings.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/utils/tests/test_decorators.py", "end_line": 1000.0, "start_line": 501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9172, 'candidates_token_count': 89, 'total_token_count': 9571, 'cached_content_token_count': 7299, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9172}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7299}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 89}], 'thoughts_token_count': 310}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7385532507735691, 'model_name': 'gemini-2.5-pro'} id='run--9ea8bc5d-d47e-4c00-9196-29658007c482-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/utils/tests/test_decorators.py', 'end_line': 1000.0, 'start_line': 501.0}, 'id': '62e91be7-5378-455f-89a9-56cf98b251e2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9172, 'output_tokens': 89, 'total_tokens': 9571, 'input_token_details': {'cache_read': 7299}, 'output_token_details': {'reasoning': 310}}
2025-12-21 19:09:31,072 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of `astropy/utils/tests/test_decorators.py`. This allows me to examine the existing test cases for decorators, properties, and their docstrings. This information will be useful for understanding how the `InheritDocstrings` metaclass is currently being tested and how to best implement the user's patch." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12242, 'candidates_token_count': 72, 'total_token_count': 12631, 'cached_content_token_count': 9246, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12242}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9246}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 72}], 'thoughts_token_count': 317}, 'finish_reason': 'STOP', 'avg_logprobs': -0.624082088470459, 'model_name': 'gemini-2.5-pro'} id='run--2bf15127-96d3-4b0b-be0c-108f38317945-0' usage_metadata={'input_tokens': 12242, 'output_tokens': 72, 'total_tokens': 12631, 'input_token_details': {'cache_read': 9246}, 'output_token_details': {'reasoning': 317}}
2025-12-21 19:09:31,074 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/utils/tests/test_decorators.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file may contain test cases for properties and their docstrings, which are relevant to the user's patch for the `InheritDocstrings` metaclass.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/utils/tests/test_decorators.py
Line number range: 1 - 500
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import functools
4. import inspect
5. import pickle
6. 
7. import pytest
8. 
9. from ..decorators import (deprecated_attribute, deprecated, wraps,
10.                           sharedmethod, classproperty,
11.                           format_doc, deprecated_renamed_argument)
12. from ..exceptions import AstropyDeprecationWarning, AstropyUserWarning
13. from ...tests.helper import catch_warnings
14. 
15. 
16. def test_wraps():
17.     """
18.     Tests the compatibility replacement for functools.wraps which supports
19.     argument preservation across all supported Python versions.
20.     """
21. 
22.     def foo(a, b, c=1, d=2, e=3, **kwargs):
23.         """A test function."""
24. 
25.         return a, b, c, d, e, kwargs
26. 
27.     @wraps(foo)
28.     def bar(*args, **kwargs):
29.         return ('test',) + foo(*args, **kwargs)
30. 
31.     expected = ('test', 1, 2, 3, 4, 5, {'f': 6, 'g': 7})
32.     assert bar(1, 2, 3, 4, 5, f=6, g=7) == expected
33.     assert bar.__name__ == 'foo'
34. 
35.     if foo.__doc__ is not None:
36.         # May happen if using optimized opcode
37.         assert bar.__doc__ == "A test function."
38. 
39.     if hasattr(foo, '__qualname__'):
40.         assert bar.__qualname__ == foo.__qualname__
41. 
42.     argspec = inspect.getfullargspec(bar)
43.     assert argspec.varkw == 'kwargs'
44. 
45.     assert argspec.args == ['a', 'b', 'c', 'd', 'e']
46.     assert argspec.defaults == (1, 2, 3)
47. 
48. 
49. def test_wraps_exclude_names():
50.     """
51.     Test the optional ``exclude_names`` argument to the wraps decorator.
52.     """
53. 
54.     # This particular test demonstrates wrapping an instance method
55.     # as a function and excluding the "self" argument:
56. 
57.     class TestClass:
58.         def method(self, a, b, c=1, d=2, **kwargs):
59.             return (a, b, c, d, kwargs)
60. 
61.     test = TestClass()
62. 
63.     @wraps(test.method, exclude_args=('self',))
64.     def func(*args, **kwargs):
65.         return test.method(*args, **kwargs)
66. 
67.     argspec = inspect.getfullargspec(func)
68.     assert argspec.args == ['a', 'b', 'c', 'd']
69. 
70.     assert func('a', 'b', e=3) == ('a', 'b', 1, 2, {'e': 3})
71. 
72. 
73. def test_wraps_keep_orig_name():
74.     """
75.     Test that when __name__ is excluded from the ``assigned`` argument
76.     to ``wrap`` that the function being wrapped keeps its original name.
77. 
78.     Regression test for https://github.com/astropy/astropy/pull/4016
79.     """
80. 
81.     def foo():
82.         pass
83. 
84.     assigned = list(functools.WRAPPER_ASSIGNMENTS)
85.     assigned.remove('__name__')
86. 
87.     def bar():
88.         pass
89. 
90.     orig_bar = bar
91. 
92.     bar = wraps(foo, assigned=assigned)(bar)
93. 
94.     assert bar is not orig_bar
95.     assert bar.__name__ == 'bar'
96. 
97. 
98. def test_deprecated_attribute():
99.     class DummyClass:
100.         def __init__(self):
101.             self._foo = 42
102. 
103.         def set_private(self):
104.             self._foo = 100
105. 
106.         foo = deprecated_attribute('foo', '0.2')
107. 
108.     dummy = DummyClass()
109. 
110.     with catch_warnings(AstropyDeprecationWarning) as w:
111.         x = dummy.foo
112. 
113.     assert len(w) == 1
114.     assert str(w[0].message) == ("The foo attribute is deprecated and may be "
115.                                  "removed in a future version.")
116. 
117.     with catch_warnings() as w:
118.         dummy.set_private()
119. 
120.     assert len(w) == 0
121. 
122. 
123. # This needs to be defined outside of the test function, because we
124. # want to try to pickle it.
125. @deprecated('100.0')
126. class TA:
127.     """
128.     This is the class docstring.
129.     """
130. 
131.     def __init__(self):
132.         """
133.         This is the __init__ docstring
134.         """
135.         pass
136. 
137. 
138. class TMeta(type):
139.     metaclass_attr = 1
140. 
141. 
142. @deprecated('100.0')
143. class TB(metaclass=TMeta):
144.     pass
145. 
146. 
147. def test_deprecated_class():
148.     orig_A = TA.__bases__[0]
149. 
150.     # The only thing that should be different about the new class
151.     # is __doc__, __init__, __bases__ and __subclasshook__.
152.     # and __init_subclass__ for Python 3.6+.
153.     for x in dir(orig_A):
154.         if x not in ('__doc__', '__init__', '__bases__', '__dict__',
155.                      '__subclasshook__', '__init_subclass__'):
156.             assert getattr(TA, x) == getattr(orig_A, x)
157. 
158.     with catch_warnings(AstropyDeprecationWarning) as w:
159.         TA()
160. 
161.     assert len(w) == 1
162.     if TA.__doc__ is not None:
163.         assert 'function' not in TA.__doc__
164.         assert 'deprecated' in TA.__doc__
165.         assert 'function' not in TA.__init__.__doc__
166.         assert 'deprecated' in TA.__init__.__doc__
167. 
168.     # Make sure the object is picklable
169.     pickle.dumps(TA)
170. 
171. 
172. def test_deprecated_class_with_new_method():
173.     """
174.     Test that a class with __new__ method still works even if it accepts
175.     additional arguments.
176.     This previously failed because the deprecated decorator would wrap objects
177.     __init__ which takes no arguments.
178.     """
179.     @deprecated('1.0')
180.     class A:
181.         def __new__(cls, a):
182.             return super().__new__(cls)
183. 
184.     # Creating an instance should work but raise a DeprecationWarning
185.     with catch_warnings(AstropyDeprecationWarning) as w:
186.         A(1)
187.     assert len(w) == 1
188. 
189.     @deprecated('1.0')
190.     class B:
191.         def __new__(cls, a):
192.             return super().__new__(cls)
193. 
194.         def __init__(self, a):
195.             pass
196. 
197.     # Creating an instance should work but raise a DeprecationWarning
198.     with catch_warnings(AstropyDeprecationWarning) as w:
199.         B(1)
200.     assert len(w) == 1
201. 
202. 
203. def test_deprecated_class_with_super():
204.     """
205.     Regression test for an issue where classes that used `super()` in their
206.     ``__init__`` did not actually call the correct class's ``__init__`` in the
207.     MRO.
208.     """
209. 
210.     @deprecated('100.0')
211.     class TB:
212.         def __init__(self, a, b):
213.             super().__init__()
214. 
215.     with catch_warnings(AstropyDeprecationWarning) as w:
216.         TB(1, 2)
217. 
218.     assert len(w) == 1
219.     if TB.__doc__ is not None:
220.         assert 'function' not in TB.__doc__
221.         assert 'deprecated' in TB.__doc__
222.         assert 'function' not in TB.__init__.__doc__
223.         assert 'deprecated' in TB.__init__.__doc__
224. 
225. 
226. def test_deprecated_class_with_custom_metaclass():
227.     """
228.     Regression test for an issue where deprecating a class with a metaclass
229.     other than type did not restore the metaclass properly.
230.     """
231. 
232.     with catch_warnings(AstropyDeprecationWarning) as w:
233.         TB()
234. 
235.     assert len(w) == 1
236.     assert type(TB) is TMeta
237.     assert TB.metaclass_attr == 1
238. 
239. 
240. def test_deprecated_static_and_classmethod():
241.     """
242.     Regression test for issue introduced by
243.     https://github.com/astropy/astropy/pull/2811 and mentioned also here:
244.     https://github.com/astropy/astropy/pull/2580#issuecomment-51049969
245.     where it appears that deprecated staticmethods didn't work on Python 2.6.
246.     """
247. 
248.     class A:
249.         """Docstring"""
250. 
251.         @deprecated('1.0')
252.         @staticmethod
253.         def B():
254.             pass
255. 
256.         @deprecated('1.0')
257.         @classmethod
258.         def C(cls):
259.             pass
260. 
261.     with catch_warnings(AstropyDeprecationWarning) as w:
262.         A.B()
263. 
264.     assert len(w) == 1
265.     if A.__doc__ is not None:
266.         assert 'deprecated' in A.B.__doc__
267. 
268.     with catch_warnings(AstropyDeprecationWarning) as w:
269.         A.C()
270. 
271.     assert len(w) == 1
272.     if A.__doc__ is not None:
273.         assert 'deprecated' in A.C.__doc__
274. 
275. 
276. def test_deprecated_argument():
277.     # Tests the decorator with function, method, staticmethod and classmethod.
278. 
279.     class Test:
280. 
281.         @classmethod
282.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
283.         def test1(cls, overwrite):
284.             return overwrite
285. 
286.         @staticmethod
287.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
288.         def test2(overwrite):
289.             return overwrite
290. 
291.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
292.         def test3(self, overwrite):
293.             return overwrite
294. 
295.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3', relax=False)
296.     def test1(overwrite):
297.         return overwrite
298. 
299.     for method in [Test().test1, Test().test2, Test().test3, test1]:
300.         # As positional argument only
301.         assert method(1) == 1
302. 
303.         # As new keyword argument
304.         assert method(overwrite=1) == 1
305. 
306.         # Using the deprecated name
307.         with catch_warnings(AstropyDeprecationWarning) as w:
308.             assert method(clobber=1) == 1
309.             assert len(w) == 1
310.             assert '1.3' in str(w[0].message)
311.             assert 'test_decorators.py' in str(w[0].filename)
312. 
313.         # Using both. Both keyword
314.         with pytest.raises(TypeError):
315.             method(clobber=2, overwrite=1)
316.         # One positional, one keyword
317.         with pytest.raises(TypeError):
318.             method(1, clobber=2)
319. 
320. 
321. def test_deprecated_argument_in_kwargs():
322.     # To rename an argument that is consumed by "kwargs" the "arg_in_kwargs"
323.     # parameter is used.
324.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3',
325.                                  arg_in_kwargs=True)
326.     def test(**kwargs):
327.         return kwargs['overwrite']
328. 
329.     # As positional argument only
330.     with pytest.raises(TypeError):
331.         test(1)
332. 
333.     # As new keyword argument
334.     assert test(overwrite=1) == 1
335. 
336.     # Using the deprecated name
337.     with catch_warnings(AstropyDeprecationWarning) as w:
338.         assert test(clobber=1) == 1
339.         assert len(w) == 1
340.         assert '1.3' in str(w[0].message)
341.         assert 'test_decorators.py' in str(w[0].filename)
342. 
343.     # Using both. Both keyword
344.     with pytest.raises(TypeError):
345.         test(clobber=2, overwrite=1)
346.     # One positional, one keyword
347.     with pytest.raises(TypeError):
348.         test(1, clobber=2)
349. 
350. 
351. def test_deprecated_argument_relaxed():
352.     # Relax turns the TypeError if both old and new keyword are used into
353.     # a warning.
354.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3', relax=True)
355.     def test(overwrite):
356.         return overwrite
357. 
358.     # As positional argument only
359.     assert test(1) == 1
360. 
361.     # As new keyword argument
362.     assert test(overwrite=1) == 1
363. 
364.     # Using the deprecated name
365.     with catch_warnings(AstropyDeprecationWarning) as w:
366.         assert test(clobber=1) == 1
367.         assert len(w) == 1
368.         assert '1.3' in str(w[0].message)
369. 
370.     # Using both. Both keyword
371.     with catch_warnings(AstropyUserWarning) as w:
372.         assert test(clobber=2, overwrite=1) == 1
373.         assert len(w) == 1
374. 
375.     # One positional, one keyword
376.     with catch_warnings(AstropyUserWarning) as w:
377.         assert test(1, clobber=2) == 1
378.         assert len(w) == 1
379. 
380. 
381. def test_deprecated_argument_pending():
382.     # Relax turns the TypeError if both old and new keyword are used into
383.     # a warning.
384.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3', pending=True)
385.     def test(overwrite):
386.         return overwrite
387. 
388.     # As positional argument only
389.     assert test(1) == 1
390. 
391.     # As new keyword argument
392.     assert test(overwrite=1) == 1
393. 
394.     # Using the deprecated name
395.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:
396.         assert test(clobber=1) == 1
397.         assert len(w) == 0
398. 
399.     # Using both. Both keyword
400.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:
401.         assert test(clobber=2, overwrite=1) == 1
402.         assert len(w) == 0
403. 
404.     # One positional, one keyword
405.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:
406.         assert test(1, clobber=2) == 1
407.         assert len(w) == 0
408. 
409. 
410. def test_deprecated_argument_multi_deprecation():
411.     @deprecated_renamed_argument(['x', 'y', 'z'], ['a', 'b', 'c'],
412.                                  [1.3, 1.2, 1.3], relax=True)
413.     def test(a, b, c):
414.         return a, b, c
415. 
416.     with catch_warnings(AstropyDeprecationWarning) as w:
417.         assert test(x=1, y=2, z=3) == (1, 2, 3)
418.         assert len(w) == 3
419. 
420.     # Make sure relax is valid for all arguments
421.     with catch_warnings(AstropyUserWarning) as w:
422.         assert test(x=1, y=2, z=3, b=3) == (1, 3, 3)
423.         assert len(w) == 1
424. 
425.     with catch_warnings(AstropyUserWarning) as w:
426.         assert test(x=1, y=2, z=3, a=3) == (3, 2, 3)
427.         assert len(w) == 1
428. 
429.     with catch_warnings(AstropyUserWarning) as w:
430.         assert test(x=1, y=2, z=3, c=5) == (1, 2, 5)
431.         assert len(w) == 1
432. 
433. 
434. def test_deprecated_argument_multi_deprecation_2():
435.     @deprecated_renamed_argument(['x', 'y', 'z'], ['a', 'b', 'c'],
436.                                  [1.3, 1.2, 1.3], relax=[True, True, False])
437.     def test(a, b, c):
438.         return a, b, c
439. 
440.     with catch_warnings(AstropyUserWarning) as w:
441.         assert test(x=1, y=2, z=3, b=3) == (1, 3, 3)
442.         assert len(w) == 1
443. 
444.     with catch_warnings(AstropyUserWarning) as w:
445.         assert test(x=1, y=2, z=3, a=3) == (3, 2, 3)
446.         assert len(w) == 1
447. 
448.     with pytest.raises(TypeError):
449.         assert test(x=1, y=2, z=3, c=5) == (1, 2, 5)
450. 
451. 
452. def test_deprecated_argument_not_allowed_use():
453.     # If the argument is supposed to be inside the kwargs one needs to set the
454.     # arg_in_kwargs parameter. Without it it raises a TypeError.
455.     with pytest.raises(TypeError):
456.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
457.         def test1(**kwargs):
458.             return kwargs['overwrite']
459. 
460.     # Cannot replace "*args".
461.     with pytest.raises(TypeError):
462.         @deprecated_renamed_argument('overwrite', 'args', '1.3')
463.         def test2(*args):
464.             return args
465. 
466.     # Cannot replace "**kwargs".
467.     with pytest.raises(TypeError):
468.         @deprecated_renamed_argument('overwrite', 'kwargs', '1.3')
469.         def test3(**kwargs):
470.             return kwargs
471. 
472. 
473. def test_sharedmethod_reuse_on_subclasses():
474.     """
475.     Regression test for an issue where sharedmethod would bind to one class
476.     for all time, causing the same method not to work properly on other
477.     subclasses of that class.
478. 
479.     It has the same problem when the same sharedmethod is called on different
480.     instances of some class as well.
481.     """
482. 
483.     class AMeta(type):
484.         def foo(cls):
485.             return cls.x
486. 
487.     class A:
488.         x = 3
489. 
490.         def __init__(self, x):
491.             self.x = x
492. 
493.         @sharedmethod
494.         def foo(self):
495.             return self.x
496. 
497.     a1 = A(1)
498.     a2 = A(2)
499. 
500.     assert a1.foo() == 1


File: astropy/utils/tests/test_decorators.py
Line number range: 501 - 1000
Content:
501.     assert a2.foo() == 2
502. 
503.     # Similar test now, but for multiple subclasses using the same sharedmethod
504.     # as a classmethod
505.     assert A.foo() == 3
506. 
507.     class B(A):
508.         x = 5
509. 
510.     assert B.foo() == 5
511. 
512. 
513. def test_classproperty_docstring():
514.     """
515.     Tests that the docstring is set correctly on classproperties.
516. 
517.     This failed previously due to a bug in Python that didn't always
518.     set __doc__ properly on instances of property subclasses.
519.     """
520. 
521.     class A:
522.         # Inherits docstring from getter
523.         @classproperty
524.         def foo(cls):
525.             """The foo."""
526. 
527.             return 1
528. 
529.     assert A.__dict__['foo'].__doc__ == "The foo."
530. 
531.     class B:
532.         # Use doc passed to classproperty constructor
533.         def _get_foo(cls): return 1
534. 
535.         foo = classproperty(_get_foo, doc="The foo.")
536. 
537.     assert B.__dict__['foo'].__doc__ == "The foo."
538. 
539. 
540. def test_format_doc_stringInput_simple():
541.     # Simple tests with string input
542. 
543.     docstring_fail = ''
544. 
545.     # Raises an valueerror if input is empty
546.     with pytest.raises(ValueError):
547.         @format_doc(docstring_fail)
548.         def testfunc_fail():
549.             pass
550. 
551.     docstring = 'test'
552. 
553.     # A first test that replaces an empty docstring
554.     @format_doc(docstring)
555.     def testfunc_1():
556.         pass
557.     assert inspect.getdoc(testfunc_1) == docstring
558. 
559.     # Test that it replaces an existing docstring
560.     @format_doc(docstring)
561.     def testfunc_2():
562.         '''not test'''
563.         pass
564.     assert inspect.getdoc(testfunc_2) == docstring
565. 
566. 
567. def test_format_doc_stringInput_format():
568.     # Tests with string input and formatting
569. 
570.     docstring = 'yes {0} no {opt}'
571. 
572.     # Raises an indexerror if not given the formatted args and kwargs
573.     with pytest.raises(IndexError):
574.         @format_doc(docstring)
575.         def testfunc1():
576.             pass
577. 
578.     # Test that the formatting is done right
579.     @format_doc(docstring, '/', opt='= life')
580.     def testfunc2():
581.         pass
582.     assert inspect.getdoc(testfunc2) == 'yes / no = life'
583. 
584.     # Test that we can include the original docstring
585. 
586.     docstring2 = 'yes {0} no {__doc__}'
587. 
588.     @format_doc(docstring2, '/')
589.     def testfunc3():
590.         '''= 2 / 2 * life'''
591.         pass
592.     assert inspect.getdoc(testfunc3) == 'yes / no = 2 / 2 * life'
593. 
594. 
595. def test_format_doc_objectInput_simple():
596.     # Simple tests with object input
597. 
598.     def docstring_fail():
599.         pass
600. 
601.     # Self input while the function has no docstring raises an error
602.     with pytest.raises(ValueError):
603.         @format_doc(docstring_fail)
604.         def testfunc_fail():
605.             pass
606. 
607.     def docstring0():
608.         '''test'''
609.         pass
610. 
611.     # A first test that replaces an empty docstring
612.     @format_doc(docstring0)
613.     def testfunc_1():
614.         pass
615.     assert inspect.getdoc(testfunc_1) == inspect.getdoc(docstring0)
616. 
617.     # Test that it replaces an existing docstring
618.     @format_doc(docstring0)
619.     def testfunc_2():
620.         '''not test'''
621.         pass
622.     assert inspect.getdoc(testfunc_2) == inspect.getdoc(docstring0)
623. 
624. 
625. def test_format_doc_objectInput_format():
626.     # Tests with object input and formatting
627. 
628.     def docstring():
629.         '''test {0} test {opt}'''
630.         pass
631. 
632.     # Raises an indexerror if not given the formatted args and kwargs
633.     with pytest.raises(IndexError):
634.         @format_doc(docstring)
635.         def testfunc_fail():
636.             pass
637. 
638.     # Test that the formatting is done right
639.     @format_doc(docstring, '+', opt='= 2 * test')
640.     def testfunc2():
641.         pass
642.     assert inspect.getdoc(testfunc2) == 'test + test = 2 * test'
643. 
644.     # Test that we can include the original docstring
645. 
646.     def docstring2():
647.         '''test {0} test {__doc__}'''
648.         pass
649. 
650.     @format_doc(docstring2, '+')
651.     def testfunc3():
652.         '''= 4 / 2 * test'''
653.         pass
654.     assert inspect.getdoc(testfunc3) == 'test + test = 4 / 2 * test'
655. 
656. 
657. def test_format_doc_selfInput_simple():
658.     # Simple tests with self input
659. 
660.     # Self input while the function has no docstring raises an error
661.     with pytest.raises(ValueError):
662.         @format_doc(None)
663.         def testfunc_fail():
664.             pass
665. 
666.     # Test that it keeps an existing docstring
667.     @format_doc(None)
668.     def testfunc_1():
669.         '''not test'''
670.         pass
671.     assert inspect.getdoc(testfunc_1) == 'not test'
672. 
673. 
674. def test_format_doc_selfInput_format():
675.     # Tests with string input which is '__doc__' (special case) and formatting
676. 
677.     # Raises an indexerror if not given the formatted args and kwargs
678.     with pytest.raises(IndexError):
679.         @format_doc(None)
680.         def testfunc_fail():
681.             '''dum {0} dum {opt}'''
682.             pass
683. 
684.     # Test that the formatting is done right
685.     @format_doc(None, 'di', opt='da dum')
686.     def testfunc1():
687.         '''dum {0} dum {opt}'''
688.         pass
689.     assert inspect.getdoc(testfunc1) == 'dum di dum da dum'
690. 
691.     # Test that we cannot recursively insert the original documentation
692. 
693.     @format_doc(None, 'di')
694.     def testfunc2():
695.         '''dum {0} dum {__doc__}'''
696.         pass
697.     assert inspect.getdoc(testfunc2) == 'dum di dum '
698. 
699. 
700. def test_format_doc_onMethod():
701.     # Check if the decorator works on methods too, to spice it up we try double
702.     # decorator
703.     docstring = 'what we do {__doc__}'
704. 
705.     class TestClass:
706.         @format_doc(docstring)
707.         @format_doc(None, 'strange.')
708.         def test_method(self):
709.             '''is {0}'''
710.             pass
711. 
712.     assert inspect.getdoc(TestClass.test_method) == 'what we do is strange.'
713. 
714. 
715. def test_format_doc_onClass():
716.     # Check if the decorator works on classes too
717.     docstring = 'what we do {__doc__} {0}{opt}'
718. 
719.     @format_doc(docstring, 'strange', opt='.')
720.     class TestClass:
721.         '''is'''
722.         pass
723. 
724.     assert inspect.getdoc(TestClass) == 'what we do is strange.'

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:09:35,400 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of the file `astropy/utils/tests/test_decorators.py`. The provided context contains the entire content of this file.', relative_path='astropy/utils/tests/test_decorators.py', start_line=1, end_line=724)]
2025-12-21 19:09:35,402 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/utils/tests/test_decorators.py`.
2025-12-21 19:09:35,402 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:09:35,402 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:09:35,403 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-21 19:09:35,403 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 19:09:35,404 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   └── yacc.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/utils/tests/test_misc.py`.
Extra Requirements: 
Purpose: I need to find relevant test cases for the `InheritDocstrings` metaclass, which is modified in the user's patch.

Previous refined query 2:
Essential Query: Please provide the full content of the file `astropy/utils/tests/test_decorators.py`.
Extra Requirements: 
Purpose: This file may contain test cases for properties and their docstrings, which are relevant to the user's patch for the `InheritDocstrings` metaclass.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/utils/tests/test_decorators.py
Line number range: 1 - 724
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import functools
4. import inspect
5. import pickle
6. 
7. import pytest
8. 
9. from ..decorators import (deprecated_attribute, deprecated, wraps,
10.                           sharedmethod, classproperty,
11.                           format_doc, deprecated_renamed_argument)
12. from ..exceptions import AstropyDeprecationWarning, AstropyUserWarning
13. from ...tests.helper import catch_warnings
14. 
15. 
16. def test_wraps():
17.     """
18.     Tests the compatibility replacement for functools.wraps which supports
19.     argument preservation across all supported Python versions.
20.     """
21. 
22.     def foo(a, b, c=1, d=2, e=3, **kwargs):
23.         """A test function."""
24. 
25.         return a, b, c, d, e, kwargs
26. 
27.     @wraps(foo)
28.     def bar(*args, **kwargs):
29.         return ('test',) + foo(*args, **kwargs)
30. 
31.     expected = ('test', 1, 2, 3, 4, 5, {'f': 6, 'g': 7})
32.     assert bar(1, 2, 3, 4, 5, f=6, g=7) == expected
33.     assert bar.__name__ == 'foo'
34. 
35.     if foo.__doc__ is not None:
36.         # May happen if using optimized opcode
37.         assert bar.__doc__ == "A test function."
38. 
39.     if hasattr(foo, '__qualname__'):
40.         assert bar.__qualname__ == foo.__qualname__
41. 
42.     argspec = inspect.getfullargspec(bar)
43.     assert argspec.varkw == 'kwargs'
44. 
45.     assert argspec.args == ['a', 'b', 'c', 'd', 'e']
46.     assert argspec.defaults == (1, 2, 3)
47. 
48. 
49. def test_wraps_exclude_names():
50.     """
51.     Test the optional ``exclude_names`` argument to the wraps decorator.
52.     """
53. 
54.     # This particular test demonstrates wrapping an instance method
55.     # as a function and excluding the "self" argument:
56. 
57.     class TestClass:
58.         def method(self, a, b, c=1, d=2, **kwargs):
59.             return (a, b, c, d, kwargs)
60. 
61.     test = TestClass()
62. 
63.     @wraps(test.method, exclude_args=('self',))
64.     def func(*args, **kwargs):
65.         return test.method(*args, **kwargs)
66. 
67.     argspec = inspect.getfullargspec(func)
68.     assert argspec.args == ['a', 'b', 'c', 'd']
69. 
70.     assert func('a', 'b', e=3) == ('a', 'b', 1, 2, {'e': 3})
71. 
72. 
73. def test_wraps_keep_orig_name():
74.     """
75.     Test that when __name__ is excluded from the ``assigned`` argument
76.     to ``wrap`` that the function being wrapped keeps its original name.
77. 
78.     Regression test for https://github.com/astropy/astropy/pull/4016
79.     """
80. 
81.     def foo():
82.         pass
83. 
84.     assigned = list(functools.WRAPPER_ASSIGNMENTS)
85.     assigned.remove('__name__')
86. 
87.     def bar():
88.         pass
89. 
90.     orig_bar = bar
91. 
92.     bar = wraps(foo, assigned=assigned)(bar)
93. 
94.     assert bar is not orig_bar
95.     assert bar.__name__ == 'bar'
96. 
97. 
98. def test_deprecated_attribute():
99.     class DummyClass:
100.         def __init__(self):
101.             self._foo = 42
102. 
103.         def set_private(self):
104.             self._foo = 100
105. 
106.         foo = deprecated_attribute('foo', '0.2')
107. 
108.     dummy = DummyClass()
109. 
110.     with catch_warnings(AstropyDeprecationWarning) as w:
111.         x = dummy.foo
112. 
113.     assert len(w) == 1
114.     assert str(w[0].message) == ("The foo attribute is deprecated and may be "
115.                                  "removed in a future version.")
116. 
117.     with catch_warnings() as w:
118.         dummy.set_private()
119. 
120.     assert len(w) == 0
121. 
122. 
123. # This needs to be defined outside of the test function, because we
124. # want to try to pickle it.
125. @deprecated('100.0')
126. class TA:
127.     """
128.     This is the class docstring.
129.     """
130. 
131.     def __init__(self):
132.         """
133.         This is the __init__ docstring
134.         """
135.         pass
136. 
137. 
138. class TMeta(type):
139.     metaclass_attr = 1
140. 
141. 
142. @deprecated('100.0')
143. class TB(metaclass=TMeta):
144.     pass
145. 
146. 
147. def test_deprecated_class():
148.     orig_A = TA.__bases__[0]
149. 
150.     # The only thing that should be different about the new class
151.     # is __doc__, __init__, __bases__ and __subclasshook__.
152.     # and __init_subclass__ for Python 3.6+.
153.     for x in dir(orig_A):
154.         if x not in ('__doc__', '__init__', '__bases__', '__dict__',
155.                      '__subclasshook__', '__init_subclass__'):
156.             assert getattr(TA, x) == getattr(orig_A, x)
157. 
158.     with catch_warnings(AstropyDeprecationWarning) as w:
159.         TA()
160. 
161.     assert len(w) == 1
162.     if TA.__doc__ is not None:
163.         assert 'function' not in TA.__doc__
164.         assert 'deprecated' in TA.__doc__
165.         assert 'function' not in TA.__init__.__doc__
166.         assert 'deprecated' in TA.__init__.__doc__
167. 
168.     # Make sure the object is picklable
169.     pickle.dumps(TA)
170. 
171. 
172. def test_deprecated_class_with_new_method():
173.     """
174.     Test that a class with __new__ method still works even if it accepts
175.     additional arguments.
176.     This previously failed because the deprecated decorator would wrap objects
177.     __init__ which takes no arguments.
178.     """
179.     @deprecated('1.0')
180.     class A:
181.         def __new__(cls, a):
182.             return super().__new__(cls)
183. 
184.     # Creating an instance should work but raise a DeprecationWarning
185.     with catch_warnings(AstropyDeprecationWarning) as w:
186.         A(1)
187.     assert len(w) == 1
188. 
189.     @deprecated('1.0')
190.     class B:
191.         def __new__(cls, a):
192.             return super().__new__(cls)
193. 
194.         def __init__(self, a):
195.             pass
196. 
197.     # Creating an instance should work but raise a DeprecationWarning
198.     with catch_warnings(AstropyDeprecationWarning) as w:
199.         B(1)
200.     assert len(w) == 1
201. 
202. 
203. def test_deprecated_class_with_super():
204.     """
205.     Regression test for an issue where classes that used `super()` in their
206.     ``__init__`` did not actually call the correct class's ``__init__`` in the
207.     MRO.
208.     """
209. 
210.     @deprecated('100.0')
211.     class TB:
212.         def __init__(self, a, b):
213.             super().__init__()
214. 
215.     with catch_warnings(AstropyDeprecationWarning) as w:
216.         TB(1, 2)
217. 
218.     assert len(w) == 1
219.     if TB.__doc__ is not None:
220.         assert 'function' not in TB.__doc__
221.         assert 'deprecated' in TB.__doc__
222.         assert 'function' not in TB.__init__.__doc__
223.         assert 'deprecated' in TB.__init__.__doc__
224. 
225. 
226. def test_deprecated_class_with_custom_metaclass():
227.     """
228.     Regression test for an issue where deprecating a class with a metaclass
229.     other than type did not restore the metaclass properly.
230.     """
231. 
232.     with catch_warnings(AstropyDeprecationWarning) as w:
233.         TB()
234. 
235.     assert len(w) == 1
236.     assert type(TB) is TMeta
237.     assert TB.metaclass_attr == 1
238. 
239. 
240. def test_deprecated_static_and_classmethod():
241.     """
242.     Regression test for issue introduced by
243.     https://github.com/astropy/astropy/pull/2811 and mentioned also here:
244.     https://github.com/astropy/astropy/pull/2580#issuecomment-51049969
245.     where it appears that deprecated staticmethods didn't work on Python 2.6.
246.     """
247. 
248.     class A:
249.         """Docstring"""
250. 
251.         @deprecated('1.0')
252.         @staticmethod
253.         def B():
254.             pass
255. 
256.         @deprecated('1.0')
257.         @classmethod
258.         def C(cls):
259.             pass
260. 
261.     with catch_warnings(AstropyDeprecationWarning) as w:
262.         A.B()
263. 
264.     assert len(w) == 1
265.     if A.__doc__ is not None:
266.         assert 'deprecated' in A.B.__doc__
267. 
268.     with catch_warnings(AstropyDeprecationWarning) as w:
269.         A.C()
270. 
271.     assert len(w) == 1
272.     if A.__doc__ is not None:
273.         assert 'deprecated' in A.C.__doc__
274. 
275. 
276. def test_deprecated_argument():
277.     # Tests the decorator with function, method, staticmethod and classmethod.
278. 
279.     class Test:
280. 
281.         @classmethod
282.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
283.         def test1(cls, overwrite):
284.             return overwrite
285. 
286.         @staticmethod
287.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
288.         def test2(overwrite):
289.             return overwrite
290. 
291.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
292.         def test3(self, overwrite):
293.             return overwrite
294. 
295.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3', relax=False)
296.     def test1(overwrite):
297.         return overwrite
298. 
299.     for method in [Test().test1, Test().test2, Test().test3, test1]:
300.         # As positional argument only
301.         assert method(1) == 1
302. 
303.         # As new keyword argument
304.         assert method(overwrite=1) == 1
305. 
306.         # Using the deprecated name
307.         with catch_warnings(AstropyDeprecationWarning) as w:
308.             assert method(clobber=1) == 1
309.             assert len(w) == 1
310.             assert '1.3' in str(w[0].message)
311.             assert 'test_decorators.py' in str(w[0].filename)
312. 
313.         # Using both. Both keyword
314.         with pytest.raises(TypeError):
315.             method(clobber=2, overwrite=1)
316.         # One positional, one keyword
317.         with pytest.raises(TypeError):
318.             method(1, clobber=2)
319. 
320. 
321. def test_deprecated_argument_in_kwargs():
322.     # To rename an argument that is consumed by "kwargs" the "arg_in_kwargs"
323.     # parameter is used.
324.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3',
325.                                  arg_in_kwargs=True)
326.     def test(**kwargs):
327.         return kwargs['overwrite']
328. 
329.     # As positional argument only
330.     with pytest.raises(TypeError):
331.         test(1)
332. 
333.     # As new keyword argument
334.     assert test(overwrite=1) == 1
335. 
336.     # Using the deprecated name
337.     with catch_warnings(AstropyDeprecationWarning) as w:
338.         assert test(clobber=1) == 1
339.         assert len(w) == 1
340.         assert '1.3' in str(w[0].message)
341.         assert 'test_decorators.py' in str(w[0].filename)
342. 
343.     # Using both. Both keyword
344.     with pytest.raises(TypeError):
345.         test(clobber=2, overwrite=1)
346.     # One positional, one keyword
347.     with pytest.raises(TypeError):
348.         test(1, clobber=2)
349. 
350. 
351. def test_deprecated_argument_relaxed():
352.     # Relax turns the TypeError if both old and new keyword are used into
353.     # a warning.
354.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3', relax=True)
355.     def test(overwrite):
356.         return overwrite
357. 
358.     # As positional argument only
359.     assert test(1) == 1
360. 
361.     # As new keyword argument
362.     assert test(overwrite=1) == 1
363. 
364.     # Using the deprecated name
365.     with catch_warnings(AstropyDeprecationWarning) as w:
366.         assert test(clobber=1) == 1
367.         assert len(w) == 1
368.         assert '1.3' in str(w[0].message)
369. 
370.     # Using both. Both keyword
371.     with catch_warnings(AstropyUserWarning) as w:
372.         assert test(clobber=2, overwrite=1) == 1
373.         assert len(w) == 1
374. 
375.     # One positional, one keyword
376.     with catch_warnings(AstropyUserWarning) as w:
377.         assert test(1, clobber=2) == 1
378.         assert len(w) == 1
379. 
380. 
381. def test_deprecated_argument_pending():
382.     # Relax turns the TypeError if both old and new keyword are used into
383.     # a warning.
384.     @deprecated_renamed_argument('clobber', 'overwrite', '1.3', pending=True)
385.     def test(overwrite):
386.         return overwrite
387. 
388.     # As positional argument only
389.     assert test(1) == 1
390. 
391.     # As new keyword argument
392.     assert test(overwrite=1) == 1
393. 
394.     # Using the deprecated name
395.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:
396.         assert test(clobber=1) == 1
397.         assert len(w) == 0
398. 
399.     # Using both. Both keyword
400.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:
401.         assert test(clobber=2, overwrite=1) == 1
402.         assert len(w) == 0
403. 
404.     # One positional, one keyword
405.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:
406.         assert test(1, clobber=2) == 1
407.         assert len(w) == 0
408. 
409. 
410. def test_deprecated_argument_multi_deprecation():
411.     @deprecated_renamed_argument(['x', 'y', 'z'], ['a', 'b', 'c'],
412.                                  [1.3, 1.2, 1.3], relax=True)
413.     def test(a, b, c):
414.         return a, b, c
415. 
416.     with catch_warnings(AstropyDeprecationWarning) as w:
417.         assert test(x=1, y=2, z=3) == (1, 2, 3)
418.         assert len(w) == 3
419. 
420.     # Make sure relax is valid for all arguments
421.     with catch_warnings(AstropyUserWarning) as w:
422.         assert test(x=1, y=2, z=3, b=3) == (1, 3, 3)
423.         assert len(w) == 1
424. 
425.     with catch_warnings(AstropyUserWarning) as w:
426.         assert test(x=1, y=2, z=3, a=3) == (3, 2, 3)
427.         assert len(w) == 1
428. 
429.     with catch_warnings(AstropyUserWarning) as w:
430.         assert test(x=1, y=2, z=3, c=5) == (1, 2, 5)
431.         assert len(w) == 1
432. 
433. 
434. def test_deprecated_argument_multi_deprecation_2():
435.     @deprecated_renamed_argument(['x', 'y', 'z'], ['a', 'b', 'c'],
436.                                  [1.3, 1.2, 1.3], relax=[True, True, False])
437.     def test(a, b, c):
438.         return a, b, c
439. 
440.     with catch_warnings(AstropyUserWarning) as w:
441.         assert test(x=1, y=2, z=3, b=3) == (1, 3, 3)
442.         assert len(w) == 1
443. 
444.     with catch_warnings(AstropyUserWarning) as w:
445.         assert test(x=1, y=2, z=3, a=3) == (3, 2, 3)
446.         assert len(w) == 1
447. 
448.     with pytest.raises(TypeError):
449.         assert test(x=1, y=2, z=3, c=5) == (1, 2, 5)
450. 
451. 
452. def test_deprecated_argument_not_allowed_use():
453.     # If the argument is supposed to be inside the kwargs one needs to set the
454.     # arg_in_kwargs parameter. Without it it raises a TypeError.
455.     with pytest.raises(TypeError):
456.         @deprecated_renamed_argument('clobber', 'overwrite', '1.3')
457.         def test1(**kwargs):
458.             return kwargs['overwrite']
459. 
460.     # Cannot replace "*args".
461.     with pytest.raises(TypeError):
462.         @deprecated_renamed_argument('overwrite', 'args', '1.3')
463.         def test2(*args):
464.             return args
465. 
466.     # Cannot replace "**kwargs".
467.     with pytest.raises(TypeError):
468.         @deprecated_renamed_argument('overwrite', 'kwargs', '1.3')
469.         def test3(**kwargs):
470.             return kwargs
471. 
472. 
473. def test_sharedmethod_reuse_on_subclasses():
474.     """
475.     Regression test for an issue where sharedmethod would bind to one class
476.     for all time, causing the same method not to work properly on other
477.     subclasses of that class.
478. 
479.     It has the same problem when the same sharedmethod is called on different
480.     instances of some class as well.
481.     """
482. 
483.     class AMeta(type):
484.         def foo(cls):
485.             return cls.x
486. 
487.     class A:
488.         x = 3
489. 
490.         def __init__(self, x):
491.             self.x = x
492. 
493.         @sharedmethod
494.         def foo(self):
495.             return self.x
496. 
497.     a1 = A(1)
498.     a2 = A(2)
499. 
500.     assert a1.foo() == 1
501.     assert a2.foo() == 2
502. 
503.     # Similar test now, but for multiple subclasses using the same sharedmethod
504.     # as a classmethod
505.     assert A.foo() == 3
506. 
507.     class B(A):
508.         x = 5
509. 
510.     assert B.foo() == 5
511. 
512. 
513. def test_classproperty_docstring():
514.     """
515.     Tests that the docstring is set correctly on classproperties.
516. 
517.     This failed previously due to a bug in Python that didn't always
518.     set __doc__ properly on instances of property subclasses.
519.     """
520. 
521.     class A:
522.         # Inherits docstring from getter
523.         @classproperty
524.         def foo(cls):
525.             """The foo."""
526. 
527.             return 1
528. 
529.     assert A.__dict__['foo'].__doc__ == "The foo."
530. 
531.     class B:
532.         # Use doc passed to classproperty constructor
533.         def _get_foo(cls): return 1
534. 
535.         foo = classproperty(_get_foo, doc="The foo.")
536. 
537.     assert B.__dict__['foo'].__doc__ == "The foo."
538. 
539. 
540. def test_format_doc_stringInput_simple():
541.     # Simple tests with string input
542. 
543.     docstring_fail = ''
544. 
545.     # Raises an valueerror if input is empty
546.     with pytest.raises(ValueError):
547.         @format_doc(docstring_fail)
548.         def testfunc_fail():
549.             pass
550. 
551.     docstring = 'test'
552. 
553.     # A first test that replaces an empty docstring
554.     @format_doc(docstring)
555.     def testfunc_1():
556.         pass
557.     assert inspect.getdoc(testfunc_1) == docstring
558. 
559.     # Test that it replaces an existing docstring
560.     @format_doc(docstring)
561.     def testfunc_2():
562.         '''not test'''
563.         pass
564.     assert inspect.getdoc(testfunc_2) == docstring
565. 
566. 
567. def test_format_doc_stringInput_format():
568.     # Tests with string input and formatting
569. 
570.     docstring = 'yes {0} no {opt}'
571. 
572.     # Raises an indexerror if not given the formatted args and kwargs
573.     with pytest.raises(IndexError):
574.         @format_doc(docstring)
575.         def testfunc1():
576.             pass
577. 
578.     # Test that the formatting is done right
579.     @format_doc(docstring, '/', opt='= life')
580.     def testfunc2():
581.         pass
582.     assert inspect.getdoc(testfunc2) == 'yes / no = life'
583. 
584.     # Test that we can include the original docstring
585. 
586.     docstring2 = 'yes {0} no {__doc__}'
587. 
588.     @format_doc(docstring2, '/')
589.     def testfunc3():
590.         '''= 2 / 2 * life'''
591.         pass
592.     assert inspect.getdoc(testfunc3) == 'yes / no = 2 / 2 * life'
593. 
594. 
595. def test_format_doc_objectInput_simple():
596.     # Simple tests with object input
597. 
598.     def docstring_fail():
599.         pass
600. 
601.     # Self input while the function has no docstring raises an error
602.     with pytest.raises(ValueError):
603.         @format_doc(docstring_fail)
604.         def testfunc_fail():
605.             pass
606. 
607.     def docstring0():
608.         '''test'''
609.         pass
610. 
611.     # A first test that replaces an empty docstring
612.     @format_doc(docstring0)
613.     def testfunc_1():
614.         pass
615.     assert inspect.getdoc(testfunc_1) == inspect.getdoc(docstring0)
616. 
617.     # Test that it replaces an existing docstring
618.     @format_doc(docstring0)
619.     def testfunc_2():
620.         '''not test'''
621.         pass
622.     assert inspect.getdoc(testfunc_2) == inspect.getdoc(docstring0)
623. 
624. 
625. def test_format_doc_objectInput_format():
626.     # Tests with object input and formatting
627. 
628.     def docstring():
629.         '''test {0} test {opt}'''
630.         pass
631. 
632.     # Raises an indexerror if not given the formatted args and kwargs
633.     with pytest.raises(IndexError):
634.         @format_doc(docstring)
635.         def testfunc_fail():
636.             pass
637. 
638.     # Test that the formatting is done right
639.     @format_doc(docstring, '+', opt='= 2 * test')
640.     def testfunc2():
641.         pass
642.     assert inspect.getdoc(testfunc2) == 'test + test = 2 * test'
643. 
644.     # Test that we can include the original docstring
645. 
646.     def docstring2():
647.         '''test {0} test {__doc__}'''
648.         pass
649. 
650.     @format_doc(docstring2, '+')
651.     def testfunc3():
652.         '''= 4 / 2 * test'''
653.         pass
654.     assert inspect.getdoc(testfunc3) == 'test + test = 4 / 2 * test'
655. 
656. 
657. def test_format_doc_selfInput_simple():
658.     # Simple tests with self input
659. 
660.     # Self input while the function has no docstring raises an error
661.     with pytest.raises(ValueError):
662.         @format_doc(None)
663.         def testfunc_fail():
664.             pass
665. 
666.     # Test that it keeps an existing docstring
667.     @format_doc(None)
668.     def testfunc_1():
669.         '''not test'''
670.         pass
671.     assert inspect.getdoc(testfunc_1) == 'not test'
672. 
673. 
674. def test_format_doc_selfInput_format():
675.     # Tests with string input which is '__doc__' (special case) and formatting
676. 
677.     # Raises an indexerror if not given the formatted args and kwargs
678.     with pytest.raises(IndexError):
679.         @format_doc(None)
680.         def testfunc_fail():
681.             '''dum {0} dum {opt}'''
682.             pass
683. 
684.     # Test that the formatting is done right
685.     @format_doc(None, 'di', opt='da dum')
686.     def testfunc1():
687.         '''dum {0} dum {opt}'''
688.         pass
689.     assert inspect.getdoc(testfunc1) == 'dum di dum da dum'
690. 
691.     # Test that we cannot recursively insert the original documentation
692. 
693.     @format_doc(None, 'di')
694.     def testfunc2():
695.         '''dum {0} dum {__doc__}'''
696.         pass
697.     assert inspect.getdoc(testfunc2) == 'dum di dum '
698. 
699. 
700. def test_format_doc_onMethod():
701.     # Check if the decorator works on methods too, to spice it up we try double
702.     # decorator
703.     docstring = 'what we do {__doc__}'
704. 
705.     class TestClass:
706.         @format_doc(docstring)
707.         @format_doc(None, 'strange.')
708.         def test_method(self):
709.             '''is {0}'''
710.             pass
711. 
712.     assert inspect.getdoc(TestClass.test_method) == 'what we do is strange.'
713. 
714. 
715. def test_format_doc_onClass():
716.     # Check if the decorator works on classes too
717.     docstring = 'what we do {__doc__} {0}{opt}'
718. 
719.     @format_doc(docstring, 'strange', opt='.')
720.     class TestClass:
721.         '''is'''
722.         pass
723. 
724.     assert inspect.getdoc(TestClass) == 'what we do is strange.'


File: astropy/utils/tests/test_misc.py
Line number range: 1 - 134
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import json
4. import os
5. from datetime import datetime
6. import locale
7. 
8. import pytest
9. import numpy as np
10. 
11. from .. import data, misc
12. 
13. 
14. def test_isiterable():
15.     assert misc.isiterable(2) is False
16.     assert misc.isiterable([2]) is True
17.     assert misc.isiterable([1, 2, 3]) is True
18.     assert misc.isiterable(np.array(2)) is False
19.     assert misc.isiterable(np.array([1, 2, 3])) is True
20. 
21. 
22. def test_signal_number_to_name_no_failure():
23.     # Regression test for #5340: ensure signal_number_to_name throws no
24.     # AttributeError (it used ".iteritems()" which was removed in Python3).
25.     misc.signal_number_to_name(0)
26. 
27. 
28. @pytest.mark.remote_data
29. def test_api_lookup():
30.     strurl = misc.find_api_page('astropy.utils.misc', 'dev', False, timeout=3)
31.     objurl = misc.find_api_page(misc, 'dev', False, timeout=3)
32. 
33.     assert strurl == objurl
34.     assert strurl == 'http://devdocs.astropy.org/utils/index.html#module-astropy.utils.misc'
35. 
36. 
37. def test_skip_hidden():
38.     path = data._find_pkg_data_path('data')
39.     for root, dirs, files in os.walk(path):
40.         assert '.hidden_file.txt' in files
41.         assert 'local.dat' in files
42.         # break after the first level since the data dir contains some other
43.         # subdirectories that don't have these files
44.         break
45. 
46.     for root, dirs, files in misc.walk_skip_hidden(path):
47.         assert '.hidden_file.txt' not in files
48.         assert 'local.dat' in files
49.         break
50. 
51. 
52. def test_JsonCustomEncoder():
53.     from ... import units as u
54.     assert json.dumps(np.arange(3), cls=misc.JsonCustomEncoder) == '[0, 1, 2]'
55.     assert json.dumps(1+2j, cls=misc.JsonCustomEncoder) == '[1.0, 2.0]'
56.     assert json.dumps(set([1, 2, 1]), cls=misc.JsonCustomEncoder) == '[1, 2]'
57.     assert json.dumps(b'hello world \xc3\x85',
58.                       cls=misc.JsonCustomEncoder) == '"hello world \\u00c5"'
59.     assert json.dumps({1: 2},
60.                       cls=misc.JsonCustomEncoder) == '{"1": 2}'  # default
61.     assert json.dumps({1: u.m}, cls=misc.JsonCustomEncoder) == '{"1": "m"}'
62.     # Quantities
63.     tmp = json.dumps({'a': 5*u.cm}, cls=misc.JsonCustomEncoder)
64.     newd = json.loads(tmp)
65.     tmpd = {"a": {"unit": "cm", "value": 5.0}}
66.     assert newd == tmpd
67.     tmp2 = json.dumps({'a': np.arange(2)*u.cm}, cls=misc.JsonCustomEncoder)
68.     newd = json.loads(tmp2)
69.     tmpd = {"a": {"unit": "cm", "value": [0., 1.]}}
70.     assert newd == tmpd
71.     tmp3 = json.dumps({'a': np.arange(2)*u.erg/u.s}, cls=misc.JsonCustomEncoder)
72.     newd = json.loads(tmp3)
73.     tmpd = {"a": {"unit": "erg / s", "value": [0., 1.]}}
74.     assert newd == tmpd
75. 
76. 
77. def test_inherit_docstrings():
78.     class Base(metaclass=misc.InheritDocstrings):
79.         def __call__(self, *args):
80.             "FOO"
81.             pass
82. 
83.     class Subclass(Base):
84.         def __call__(self, *args):
85.             pass
86. 
87.     if Base.__call__.__doc__ is not None:
88.         # TODO: Maybe if __doc__ is None this test should be skipped instead?
89.         assert Subclass.__call__.__doc__ == "FOO"
90. 
91. 
92. def test_set_locale():
93.     # First, test if the required locales are available
94.     current = locale.setlocale(locale.LC_ALL)
95.     try:
96.         locale.setlocale(locale.LC_ALL, str('en_US'))
97.         locale.setlocale(locale.LC_ALL, str('de_DE'))
98.     except locale.Error as e:
99.         pytest.skip('Locale error: {}'.format(e))
100.     finally:
101.         locale.setlocale(locale.LC_ALL, current)
102. 
103.     date = datetime(2000, 10, 1, 0, 0, 0)
104.     day_mon = date.strftime('%a, %b')
105. 
106.     with misc.set_locale('en_US'):
107.         assert date.strftime('%a, %b') == 'Sun, Oct'
108. 
109.     with misc.set_locale('de_DE'):
110.         assert date.strftime('%a, %b') == 'So, Okt'
111. 
112.     # Back to original
113.     assert date.strftime('%a, %b') == day_mon
114. 
115.     with misc.set_locale(current):
116.         assert date.strftime('%a, %b') == day_mon
117. 
118. 
119. def test_check_broadcast():
120.     assert misc.check_broadcast((10, 1), (3,)) == (10, 3)
121.     assert misc.check_broadcast((10, 1), (3,), (4, 1, 1, 3)) == (4, 1, 10, 3)
122.     with pytest.raises(ValueError):
123.         misc.check_broadcast((10, 2), (3,))
124. 
125.     with pytest.raises(ValueError):
126.         misc.check_broadcast((10, 1), (3,), (4, 1, 2, 3))
127. 
128. 
129. def test_dtype_bytes_or_chars():
130.     assert misc.dtype_bytes_or_chars(np.dtype(np.float64)) == 8
131.     assert misc.dtype_bytes_or_chars(np.dtype(object)) is None
132.     assert misc.dtype_bytes_or_chars(np.dtype(np.int32)) == 4
133.     assert misc.dtype_bytes_or_chars(np.array(b'12345').dtype) == 5
134.     assert misc.dtype_bytes_or_chars(np.array(u'12345').dtype) == 5

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:10:02,419 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's patch enables docstring inheritance for properties. I have found two relevant tests in the provided context: one for the `InheritDocstrings` metaclass (`test_inherit_docstrings`) and one for docstrings on a property-like object (`test_classproperty_docstring`). To find a third, more comprehensive example of testing properties, especially their docstrings, I need to look into parts of the codebase that make extensive use of them. The `astropy.modeling` subpackage uses a `Parameter` class that acts like a property on models, and it's likely that `astropy/modeling/tests/test_parameters.py` contains tests that check parameter (property) attributes like docstrings. This file has not been requested before." query='Please provide the full content of the file `astropy/modeling/tests/test_parameters.py`.' extra_requirements='' purpose="This file likely contains tests for model parameters, which are implemented as properties, and may include checks for their docstrings, providing a relevant example for the user's patch."
2025-12-21 19:10:02,420 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/modeling/tests/test_parameters.py`.
2025-12-21 19:10:02,420 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:10:02,421 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:10:02,422 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:10:02,422 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/modeling/tests/test_parameters.py`.
Purpose: This file likely contains tests for model parameters, which are implemented as properties, and may include checks for their docstrings, providing a relevant example for the user's patch.
2025-12-21 19:10:04,349 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/modeling/tests/test_parameters.py"}'}, '__gemini_function_call_thought_signatures__': {'b2cf1f1c-1843-43d1-b6c8-e12045a1b8aa': 'CugDAY89a19K0yBww37zXjtIaidEX5QhOzJ/TurLL4NkHrhvObCBPm8bHsS6QsOYTJekEk6fCK8jyv3qt4j6wx+VaRVV+fM1swJ0RP9FcJiCmtcJGOUAtUMvgjZx4QISJ6XNVO0JHeZB7CxskpEQO0TlzH6kZDwMBAYZgaQBbZe19BBY535H/CTyvV1NARSBf3bYgZju9ZkF/oLw+Fw/3b3hmUx8oZGw5GIxpAucUcUEU4gv8vstMgsLMEL11XsFmMLwT9bcwOa8GABaJxniUKkQl7BYoYTaGSq0oE58IBL7WO7haFjL0TG2ufgoEM/xU4AJGLMYoQREcL1qpQsUF2DhHEc2nB/UNp2Ch3e7a0u67P/f3J58/C0VEkGOATmdvTX2PTJAR3ghXnREwv0XVaqwHeVzpuHX1Ye2sbRfV/+jQv3GzrAgLHcSk3DP4skVN+Vh5fM5e/Q18H4j0HYucgUPfJ3Nd+PKzkxattEbR2/YQOZZaT6rURECKzVgxHdsAoEatHPs0mXlsWxkeaUzjSoQDV9jriwFq/I+xfhO+b+22wP5Gxuc341S0wxInA4zklaG1O7r+dsQhWCb9jW4G3pMp2yALy6jdWGO1j+xx2mMGxFxqIO6rdGd8N8BQELRjE1RHyHXw5L25Ho='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2150, 'candidates_token_count': 26, 'total_token_count': 2299, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2150}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 123, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1933134885934683, 'model_name': 'gemini-2.5-pro'} id='run--2e8ec956-272b-49d4-8e6a-c7377582fe50-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/modeling/tests/test_parameters.py'}, 'id': 'b2cf1f1c-1843-43d1-b6c8-e12045a1b8aa', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2150, 'output_tokens': 26, 'total_tokens': 2299, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 123}}
2025-12-21 19:10:07,911 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/modeling/tests/test_parameters.py", "end_line": 1000.0, "start_line": 501.0}'}, '__gemini_function_call_thought_signatures__': {'cedb6c04-7076-4d96-b8c2-be95d35da8f9': 'Cv4GAY89a1/K8YLO2BEaeTDBUaYsmvu2/cmROssxQCTXqASrgotDhaGQj/P/GgIAi/gCPzEPqLRjFgBG050sO45KeFNZ+aXiSoGfOkQS46BmMRKIbYSxHJ4JRSnvIAS78ag5di2Dm7U2zHUKS73qDDprSK3SVBhMWhL6MEmS4/4gZjeHjCWGVPBaqX73iS57jJ8aopqK0516Pd6WfYgDQxt9ur8hmKh6L0Y8vl6PLYAr7xJks9OitW8ys2Uk+LQPZI98pH3Yda3S4RITnh4R6zcJ+YPaTQdOsOXegvLjR5hs73oNX9LIunJInwwxPVt8A6Im3JFl00GAILITICP+W4zNi4JGvOyiAy/HFKQviLVEkctb4Vi3/HBtIgH6qXTZXGb4muhgnfB28aldez50oJl96vZunT642gEj2v+KrST8sBXYrVFKjKd5dowyCXSb+LOH/3z+ktSVsvmqx7iXMyK4SsiQnDGdFD+CQC49/brufJfZ7+qJ1Pq7FPwD/1rgVjip2jduLZUL9vlr3JoQmYBTXwn/tvlh9fsICGTsdPil5yN1OvKS4qNAni09eYZkFVP5Bau0bjZUbGLvOGtqdhSigK5oh7MIZ61aELE8vab4Kc9XMb9Lre4e2kPAVxb1ziAwdBOd7/BBTa4Y12y0iatzqHk+0WRaRD8BeitD75OqDucr+ItJ+LP221xR4r3tgk3ts4ZHNzXsN/cG7PBaMkbrT+vpZemTJPyqH93Sl7tFeZmlQWSFoqafIW7/NDi5AMbVYD3WfG3d5ATg4r8hzVUsZOCpbz3H1z3lWiXrvJJ5HQM+4lYLsAMS6miO0sk8gIyW28c13vAhwDO/r28J1I1jlVC3o2rWe+iN9VxJzCAjLwy5Ah+6ATQlyypBBPEVVieFCS2kwzSCK7EBAwciiIzoxBovHARPhuY83dyMXWdBPehA1NSa0FOCg4B+z3ah/ZvP4/rJuBZUxIfqM7Y4hG3hxvhvF+m5b2O36+yXn0rLLg8eSg/4wT/51REPRCyX34X83N834LMq7dbkKChrv3GR3NccICzSHhjLQpYKfgjV5/A3hXIzX6FSdhTDaei6PLhzS257N7mgx5YMWtdpeqGsfzW+Ge4R36KeVtqi5u+aIwnrdJ0va3ifbgqJ4yeXTvSutWAElAjm5B8d1I16EmBIfS3+ZRmNyQW0FUxcssDo'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10545, 'candidates_token_count': 32, 'total_token_count': 10831, 'cached_content_token_count': 1859, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10668}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1859}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 32}], 'thoughts_token_count': 254}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9672636389732361, 'model_name': 'gemini-2.5-pro'} id='run--83079b6f-0f37-4474-bcfc-85a8bd85c91f-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/modeling/tests/test_parameters.py', 'end_line': 1000.0, 'start_line': 501.0}, 'id': 'cedb6c04-7076-4d96-b8c2-be95d35da8f9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10545, 'output_tokens': 32, 'total_tokens': 10831, 'input_token_details': {'cache_read': 1859}, 'output_token_details': {'reasoning': 254}}
2025-12-21 19:10:12,847 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `astropy/modeling/tests/test_parameters.py`. The file contains tests for model parameters, including their properties, operators, and initialization with different shapes and sizes. It also includes tests for parameter constraints, setters, and behavior in multi-model scenarios.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13127, 'candidates_token_count': 63, 'total_token_count': 13591, 'cached_content_token_count': 9421, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13504}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9421}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 63}], 'thoughts_token_count': 401}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9355783008393788, 'model_name': 'gemini-2.5-pro'} id='run--195f642d-1208-4c89-afcc-71f19b49446c-0' usage_metadata={'input_tokens': 13127, 'output_tokens': 63, 'total_tokens': 13591, 'input_token_details': {'cache_read': 9421}, 'output_token_details': {'reasoning': 401}}
2025-12-21 19:10:12,849 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/modeling/tests/test_parameters.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file likely contains tests for model parameters, which are implemented as properties, and may include checks for their docstrings, providing a relevant example for the user's patch.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/modeling/tests/test_parameters.py
Line number range: 1 - 500
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. """
3. Tests models.parameters
4. """
5. 
6. 
7. import itertools
8. 
9. import pytest
10. import numpy as np
11. from numpy.testing import utils
12. 
13. from . import irafutil
14. from .. import models, fitting
15. from ..core import Model, FittableModel
16. from ..parameters import Parameter, InputParameterError
17. from ...utils.data import get_pkg_data_filename
18. 
19. 
20. def setter1(val):
21.     return val
22. 
23. 
24. def setter2(val, model):
25.     model.do_something(val)
26.     return val * model.p
27. 
28. 
29. class SetterModel(FittableModel):
30. 
31.     inputs = ('x', 'y')
32.     outputs = ('z',)
33. 
34.     xc = Parameter(default=1, setter=setter1)
35.     yc = Parameter(default=1, setter=setter2)
36. 
37.     def __init__(self, xc, yc, p):
38.         self.p = p  # p is a value intended to be used by the setter
39.         super().__init__()
40.         self.xc = xc
41.         self.yc = yc
42. 
43.     def evaluate(self, x, y, xc, yc):
44.         return ((x - xc)**2 + (y - yc)**2)
45. 
46.     def do_something(self, v):
47.         pass
48. 
49. 
50. class TParModel(Model):
51.     """
52.     A toy model to test parameters machinery
53.     """
54. 
55.     coeff = Parameter()
56.     e = Parameter()
57. 
58.     def __init__(self, coeff, e, **kwargs):
59.         super().__init__(coeff=coeff, e=e, **kwargs)
60. 
61.     @staticmethod
62.     def evaluate(coeff, e):
63.         pass
64. 
65. 
66. class MockModel(FittableModel):
67.     alpha = Parameter(name='alpha', default=42)
68. 
69.     @staticmethod
70.     def evaluate(*args):
71.         pass
72. 
73. 
74. def test_parameter_properties():
75.     """Test if getting / setting of Parameter properties works."""
76. 
77.     m = MockModel()
78.     p = m.alpha
79. 
80.     assert p.name == 'alpha'
81. 
82.     # Parameter names are immutable
83.     with pytest.raises(AttributeError):
84.         p.name = 'beta'
85. 
86.     assert p.fixed is False
87.     p.fixed = True
88.     assert p.fixed is True
89. 
90.     assert p.tied is False
91.     p.tied = lambda _: 0
92. 
93.     p.tied = False
94.     assert p.tied is False
95. 
96.     assert p.min is None
97.     p.min = 42
98.     assert p.min == 42
99.     p.min = None
100.     assert p.min is None
101. 
102.     assert p.max is None
103.     # TODO: shouldn't setting a max < min give an error?
104.     p.max = 41
105.     assert p.max == 41
106. 
107. 
108. def test_parameter_operators():
109.     """Test if the parameter arithmetic operators work."""
110. 
111.     m = MockModel()
112.     par = m.alpha
113.     num = 42.
114.     val = 3
115. 
116.     assert par - val == num - val
117.     assert val - par == val - num
118.     assert par / val == num / val
119.     assert val / par == val / num
120.     assert par ** val == num ** val
121.     assert val ** par == val ** num
122.     assert par < 45
123.     assert par > 41
124.     assert par <= par
125.     assert par >= par
126.     assert par == par
127.     assert -par == -num
128.     assert abs(par) == abs(num)
129. 
130. 
131. class TestParameters:
132. 
133.     def setup_class(self):
134.         """
135.         Unit tests for parameters
136. 
137.         Read an iraf database file created by onedspec.identify.  Use the
138.         information to create a 1D Chebyshev model and perform the same fit.
139. 
140.         Create also a gausian model.
141.         """
142.         test_file = get_pkg_data_filename('data/idcompspec.fits')
143.         f = open(test_file)
144.         lines = f.read()
145.         reclist = lines.split("begin")
146.         f.close()
147.         record = irafutil.IdentifyRecord(reclist[1])
148.         self.icoeff = record.coeff
149.         order = int(record.fields['order'])
150.         self.model = models.Chebyshev1D(order - 1)
151.         self.gmodel = models.Gaussian1D(2, mean=3, stddev=4)
152.         self.linear_fitter = fitting.LinearLSQFitter()
153.         self.x = record.x
154.         self.y = record.z
155.         self.yy = np.array([record.z, record.z])
156. 
157.     def test_set_slice(self):
158.         """
159.         Tests updating the parameters attribute with a slice.
160. 
161.         This is what fitters internally do.
162.         """
163. 
164.         self.model.parameters[:] = np.array([3, 4, 5, 6, 7])
165.         assert (self.model.parameters == [3., 4., 5., 6., 7.]).all()
166. 
167.     def test_set_parameters_as_list(self):
168.         """Tests updating parameters using a list."""
169. 
170.         self.model.parameters = [30, 40, 50, 60, 70]
171.         assert (self.model.parameters == [30., 40., 50., 60, 70]).all()
172. 
173.     def test_set_parameters_as_array(self):
174.         """Tests updating parameters using an array."""
175. 
176.         self.model.parameters = np.array([3, 4, 5, 6, 7])
177.         assert (self.model.parameters == [3., 4., 5., 6., 7.]).all()
178. 
179.     def test_set_as_tuple(self):
180.         """Tests updating parameters using a tuple."""
181. 
182.         self.model.parameters = (1, 2, 3, 4, 5)
183.         assert (self.model.parameters == [1, 2, 3, 4, 5]).all()
184. 
185.     def test_set_model_attr_seq(self):
186.         """
187.         Tests updating the parameters attribute when a model's
188.         parameter (in this case coeff) is updated.
189.         """
190. 
191.         self.model.parameters = [0, 0., 0., 0, 0]
192.         self.model.c0 = 7
193.         assert (self.model.parameters == [7, 0., 0., 0, 0]).all()
194. 
195.     def test_set_model_attr_num(self):
196.         """Update the parameter list when a model's parameter is updated."""
197. 
198.         self.gmodel.amplitude = 7
199.         assert (self.gmodel.parameters == [7, 3, 4]).all()
200. 
201.     def test_set_item(self):
202.         """Update the parameters using indexing."""
203. 
204.         self.model.parameters = [1, 2, 3, 4, 5]
205.         self.model.parameters[0] = 10.
206.         assert (self.model.parameters == [10, 2, 3, 4, 5]).all()
207.         assert self.model.c0 == 10
208. 
209.     def test_wrong_size1(self):
210.         """
211.         Tests raising an error when attempting to reset the parameters
212.         using a list of a different size.
213.         """
214. 
215.         with pytest.raises(InputParameterError):
216.             self.model.parameters = [1, 2, 3]
217. 
218.     def test_wrong_size2(self):
219.         """
220.         Tests raising an exception when attempting to update a model's
221.         parameter (in this case coeff) with a sequence of the wrong size.
222.         """
223. 
224.         with pytest.raises(InputParameterError):
225.             self.model.c0 = [1, 2, 3]
226. 
227.     def test_wrong_shape(self):
228.         """
229.         Tests raising an exception when attempting to update a model's
230.         parameter and the new value has the wrong shape.
231.         """
232. 
233.         with pytest.raises(InputParameterError):
234.             self.gmodel.amplitude = [1, 2]
235. 
236.     def test_par_against_iraf(self):
237.         """
238.         Test the fitter modifies model.parameters.
239. 
240.         Uses an iraf example.
241.         """
242. 
243.         new_model = self.linear_fitter(self.model, self.x, self.y)
244.         print(self.y, self.x)
245.         utils.assert_allclose(new_model.parameters,
246.                               np.array(
247.                                   [4826.1066602783685, 952.8943813407858,
248.                                    12.641236013982386,
249.                                    -1.7910672553339604,
250.                                    0.90252884366711317]),
251.                               rtol=10 ** (-2))
252. 
253.     def testPolynomial1D(self):
254.         d = {'c0': 11, 'c1': 12, 'c2': 13, 'c3': 14}
255.         p1 = models.Polynomial1D(3, **d)
256.         utils.assert_equal(p1.parameters, [11, 12, 13, 14])
257. 
258.     def test_poly1d_multiple_sets(self):
259.         p1 = models.Polynomial1D(3, n_models=3)
260.         utils.assert_equal(p1.parameters, [0.0, 0.0, 0.0, 0, 0, 0,
261.                                            0, 0, 0, 0, 0, 0])
262.         utils.assert_array_equal(p1.c0, [0, 0, 0])
263.         p1.c0 = [10, 10, 10]
264.         utils.assert_equal(p1.parameters, [10.0, 10.0, 10.0, 0, 0,
265.                                            0, 0, 0, 0, 0, 0, 0])
266. 
267.     def test_par_slicing(self):
268.         """
269.         Test assigning to a parameter slice
270.         """
271.         p1 = models.Polynomial1D(3, n_models=3)
272.         p1.c0[:2] = [10, 10]
273.         utils.assert_equal(p1.parameters, [10.0, 10.0, 0.0, 0, 0,
274.                                            0, 0, 0, 0, 0, 0, 0])
275. 
276.     def test_poly2d(self):
277.         p2 = models.Polynomial2D(degree=3)
278.         p2.c0_0 = 5
279.         utils.assert_equal(p2.parameters, [5, 0, 0, 0, 0, 0, 0, 0, 0, 0])
280. 
281.     def test_poly2d_multiple_sets(self):
282.         kw = {'c0_0': [2, 3], 'c1_0': [1, 2], 'c2_0': [4, 5],
283.               'c0_1': [1, 1], 'c0_2': [2, 2], 'c1_1': [5, 5]}
284.         p2 = models.Polynomial2D(2, **kw)
285.         utils.assert_equal(p2.parameters, [2, 3, 1, 2, 4, 5,
286.                                            1, 1, 2, 2, 5, 5])
287. 
288.     def test_shift_model_parameters1d(self):
289.         sh1 = models.Shift(2)
290.         sh1.offset = 3
291.         assert sh1.offset == 3
292.         assert sh1.offset.value == 3
293. 
294.     def test_scale_model_parametersnd(self):
295.         sc1 = models.Scale([2, 2])
296.         sc1.factor = [3, 3]
297.         assert np.all(sc1.factor == [3, 3])
298.         utils.assert_array_equal(sc1.factor.value, [3, 3])
299. 
300.     def test_parameters_wrong_shape(self):
301.         sh1 = models.Shift(2)
302.         with pytest.raises(InputParameterError):
303.             sh1.offset = [3, 3]
304. 
305. 
306. class TestMultipleParameterSets:
307. 
308.     def setup_class(self):
309.         self.x1 = np.arange(1, 10, .1)
310.         self.y, self.x = np.mgrid[:10, :7]
311.         self.x11 = np.array([self.x1, self.x1]).T
312.         self.gmodel = models.Gaussian1D([12, 10], [3.5, 5.2], stddev=[.4, .7],
313.                                         n_models=2)
314. 
315.     def test_change_par(self):
316.         """
317.         Test that a change to one parameter as a set propagates to param_sets.
318.         """
319.         self.gmodel.amplitude = [1, 10]
320.         utils.assert_almost_equal(
321.             self.gmodel.param_sets,
322.             np.array([[1.,
323.                        10],
324.                       [3.5,
325.                        5.2],
326.                       [0.4,
327.                        0.7]]))
328.         np.all(self.gmodel.parameters == [1.0, 10.0, 3.5, 5.2, 0.4, 0.7])
329. 
330.     def test_change_par2(self):
331.         """
332.         Test that a change to one single parameter in a set propagates to
333.         param_sets.
334.         """
335.         self.gmodel.amplitude[0] = 11
336.         utils.assert_almost_equal(
337.             self.gmodel.param_sets,
338.             np.array([[11.,
339.                        10],
340.                       [3.5,
341.                        5.2],
342.                       [0.4,
343.                        0.7]]))
344.         np.all(self.gmodel.parameters == [11.0, 10.0, 3.5, 5.2, 0.4, 0.7])
345. 
346.     def test_change_parameters(self):
347.         self.gmodel.parameters = [13, 10, 9, 5.2, 0.4, 0.7]
348.         utils.assert_almost_equal(self.gmodel.amplitude.value, [13., 10.])
349.         utils.assert_almost_equal(self.gmodel.mean.value, [9., 5.2])
350. 
351. 
352. class TestParameterInitialization:
353.     """
354.     This suite of tests checks most if not all cases if instantiating a model
355.     with parameters of different shapes/sizes and with different numbers of
356.     parameter sets.
357.     """
358. 
359.     def test_single_model_scalar_parameters(self):
360.         t = TParModel(10, 1)
361.         assert len(t) == 1
362.         assert t.model_set_axis is False
363.         assert np.all(t.param_sets == [[10], [1]])
364.         assert np.all(t.parameters == [10, 1])
365.         assert t.coeff.shape == ()
366.         assert t.e.shape == ()
367. 
368.     def test_single_model_scalar_and_array_parameters(self):
369.         t = TParModel(10, [1, 2])
370.         assert len(t) == 1
371.         assert t.model_set_axis is False
372.         assert np.issubdtype(t.param_sets.dtype, np.object_)
373.         assert len(t.param_sets) == 2
374.         assert np.all(t.param_sets[0] == [10])
375.         assert np.all(t.param_sets[1] == [[1, 2]])
376.         assert np.all(t.parameters == [10, 1, 2])
377.         assert t.coeff.shape == ()
378.         assert t.e.shape == (2,)
379. 
380.     def test_single_model_1d_array_parameters(self):
381.         t = TParModel([10, 20], [1, 2])
382.         assert len(t) == 1
383.         assert t.model_set_axis is False
384.         assert np.all(t.param_sets == [[[10, 20]], [[1, 2]]])
385.         assert np.all(t.parameters == [10, 20, 1, 2])
386.         assert t.coeff.shape == (2,)
387.         assert t.e.shape == (2,)
388. 
389.     def test_single_model_1d_array_different_length_parameters(self):
390.         with pytest.raises(InputParameterError):
391.             # Not broadcastable
392.             t = TParModel([1, 2], [3, 4, 5])
393. 
394.     def test_single_model_2d_array_parameters(self):
395.         t = TParModel([[10, 20], [30, 40]], [[1, 2], [3, 4]])
396.         assert len(t) == 1
397.         assert t.model_set_axis is False
398.         assert np.all(t.param_sets == [[[[10, 20], [30, 40]]],
399.                                        [[[1, 2], [3, 4]]]])
400.         assert np.all(t.parameters == [10, 20, 30, 40, 1, 2, 3, 4])
401.         assert t.coeff.shape == (2, 2)
402.         assert t.e.shape == (2, 2)
403. 
404.     def test_single_model_2d_non_square_parameters(self):
405.         coeff = np.array([[10, 20], [30, 40], [50, 60]])
406.         e = np.array([[1, 2], [3, 4], [5, 6]])
407. 
408.         t = TParModel(coeff, e)
409.         assert len(t) == 1
410.         assert t.model_set_axis is False
411.         assert np.all(t.param_sets == [[[[10, 20], [30, 40], [50, 60]]],
412.                                        [[[1, 2], [3, 4], [5, 6]]]])
413.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60,
414.                                        1, 2, 3, 4, 5, 6])
415.         assert t.coeff.shape == (3, 2)
416.         assert t.e.shape == (3, 2)
417. 
418.         t2 = TParModel(coeff.T, e.T)
419.         assert len(t2) == 1
420.         assert t2.model_set_axis is False
421.         assert np.all(t2.param_sets == [[[[10, 30, 50], [20, 40, 60]]],
422.                                         [[[1, 3, 5], [2, 4, 6]]]])
423.         assert np.all(t2.parameters == [10, 30, 50, 20, 40, 60,
424.                                         1, 3, 5, 2, 4, 6])
425.         assert t2.coeff.shape == (2, 3)
426.         assert t2.e.shape == (2, 3)
427. 
428.         # Not broadcastable
429.         with pytest.raises(InputParameterError):
430.             TParModel(coeff, e.T)
431. 
432.         with pytest.raises(InputParameterError):
433.             TParModel(coeff.T, e)
434. 
435.     def test_single_model_2d_broadcastable_parameters(self):
436.         t = TParModel([[10, 20, 30], [40, 50, 60]], [1, 2, 3])
437.         assert len(t) == 1
438.         assert t.model_set_axis is False
439.         assert len(t.param_sets) == 2
440.         assert np.issubdtype(t.param_sets.dtype, np.object_)
441.         assert np.all(t.param_sets[0] == [[[10, 20, 30], [40, 50, 60]]])
442.         assert np.all(t.param_sets[1] == [[1, 2, 3]])
443.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60, 1, 2, 3])
444. 
445.     @pytest.mark.parametrize(('p1', 'p2'), [
446.         (1, 2), (1, [2, 3]), ([1, 2], 3), ([1, 2, 3], [4, 5]),
447.         ([1, 2], [3, 4, 5])])
448.     def test_two_model_incorrect_scalar_parameters(self, p1, p2):
449.         with pytest.raises(InputParameterError):
450.             TParModel(p1, p2, n_models=2)
451. 
452.     @pytest.mark.parametrize('kwargs', [
453.         {'n_models': 2}, {'model_set_axis': 0},
454.         {'n_models': 2, 'model_set_axis': 0}])
455.     def test_two_model_scalar_parameters(self, kwargs):
456.         t = TParModel([10, 20], [1, 2], **kwargs)
457.         assert len(t) == 2
458.         assert t.model_set_axis == 0
459.         assert np.all(t.param_sets == [[10, 20], [1, 2]])
460.         assert np.all(t.parameters == [10, 20, 1, 2])
461.         assert t.coeff.shape == ()
462.         assert t.e.shape == ()
463. 
464.     @pytest.mark.parametrize('kwargs', [
465.         {'n_models': 2}, {'model_set_axis': 0},
466.         {'n_models': 2, 'model_set_axis': 0}])
467.     def test_two_model_scalar_and_array_parameters(self, kwargs):
468.         t = TParModel([10, 20], [[1, 2], [3, 4]], **kwargs)
469.         assert len(t) == 2
470.         assert t.model_set_axis == 0
471.         assert len(t.param_sets) == 2
472.         assert np.issubdtype(t.param_sets.dtype, np.object_)
473.         assert np.all(t.param_sets[0] == [[10], [20]])
474.         assert np.all(t.param_sets[1] == [[1, 2], [3, 4]])
475.         assert np.all(t.parameters == [10, 20, 1, 2, 3, 4])
476.         assert t.coeff.shape == ()
477.         assert t.e.shape == (2,)
478. 
479.     def test_two_model_1d_array_parameters(self):
480.         t = TParModel([[10, 20], [30, 40]], [[1, 2], [3, 4]], n_models=2)
481.         assert len(t) == 2
482.         assert t.model_set_axis == 0
483.         assert np.all(t.param_sets == [[[10, 20], [30, 40]],
484.                                        [[1, 2], [3, 4]]])
485.         assert np.all(t.parameters == [10, 20, 30, 40, 1, 2, 3, 4])
486.         assert t.coeff.shape == (2,)
487.         assert t.e.shape == (2,)
488. 
489.         t2 = TParModel([[10, 20, 30], [40, 50, 60]],
490.                           [[1, 2, 3], [4, 5, 6]], n_models=2)
491.         assert len(t2) == 2
492.         assert t2.model_set_axis == 0
493.         assert np.all(t2.param_sets == [[[10, 20, 30], [40, 50, 60]],
494.                                         [[1, 2, 3], [4, 5, 6]]])
495.         assert np.all(t2.parameters == [10, 20, 30, 40, 50, 60,
496.                                         1, 2, 3, 4, 5, 6])
497.         assert t2.coeff.shape == (3,)
498.         assert t2.e.shape == (3,)
499. 
500.     def test_two_model_mixed_dimension_array_parameters(self):


File: astropy/modeling/tests/test_parameters.py
Line number range: 501 - 1000
Content:
501.         with pytest.raises(InputParameterError):
502.             # Can't broadcast different array shapes
503.             TParModel([[[1, 2], [3, 4]], [[5, 6], [7, 8]]],
504.                          [[9, 10, 11], [12, 13, 14]], n_models=2)
505. 
506.         t = TParModel([[[10, 20], [30, 40]], [[50, 60], [70, 80]]],
507.                          [[1, 2], [3, 4]], n_models=2)
508.         assert len(t) == 2
509.         assert t.model_set_axis == 0
510.         assert len(t.param_sets) == 2
511.         assert np.issubdtype(t.param_sets.dtype, np.object_)
512.         assert np.all(t.param_sets[0] == [[[10, 20], [30, 40]],
513.                                           [[50, 60], [70, 80]]])
514.         assert np.all(t.param_sets[1] == [[[1, 2]], [[3, 4]]])
515.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60, 70, 80,
516.                                        1, 2, 3, 4])
517.         assert t.coeff.shape == (2, 2)
518.         assert t.e.shape == (2,)
519. 
520.     def test_two_model_2d_array_parameters(self):
521.         t = TParModel([[[10, 20], [30, 40]], [[50, 60], [70, 80]]],
522.                          [[[1, 2], [3, 4]], [[5, 6], [7, 8]]], n_models=2)
523.         assert len(t) == 2
524.         assert t.model_set_axis == 0
525.         assert np.all(t.param_sets == [[[[10, 20], [30, 40]],
526.                                         [[50, 60], [70, 80]]],
527.                                        [[[1, 2], [3, 4]],
528.                                         [[5, 6], [7, 8]]]])
529.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60, 70, 80,
530.                                        1, 2, 3, 4, 5, 6, 7, 8])
531.         assert t.coeff.shape == (2, 2)
532.         assert t.e.shape == (2, 2)
533. 
534.     def test_two_model_nonzero_model_set_axis(self):
535.         # An example where the model set axis is the *last* axis of the
536.         # parameter arrays
537.         coeff = np.array([[[10, 20], [30, 40]], [[50, 60], [70, 80]]])
538.         coeff = np.rollaxis(coeff, 0, 3)
539.         e = np.array([[1, 2], [3, 4]])
540.         e = np.rollaxis(e, 0, 2)
541.         t = TParModel(coeff, e, model_set_axis=-1)
542.         assert len(t) == 2
543.         assert t.model_set_axis == -1
544.         assert len(t.param_sets) == 2
545.         assert np.issubdtype(t.param_sets.dtype, np.object_)
546.         assert np.all(t.param_sets[0] == [[[10, 50], [20, 60]],
547.                                           [[30, 70], [40, 80]]])
548.         assert np.all(t.param_sets[1] == [[[1, 3], [2, 4]]])
549.         assert np.all(t.parameters == [10, 50, 20, 60, 30, 70, 40, 80,
550.                                        1, 3, 2, 4])
551.         assert t.coeff.shape == (2, 2)
552.         assert t.e.shape == (2,)
553. 
554.     def test_wrong_number_of_params(self):
555.         with pytest.raises(InputParameterError):
556.             TParModel(coeff=[[1, 2], [3, 4]], e=(2, 3, 4), n_models=2)
557.         with pytest.raises(InputParameterError):
558.             TParModel(coeff=[[1, 2], [3, 4]], e=(2, 3, 4), model_set_axis=0)
559. 
560.     def test_wrong_number_of_params2(self):
561.         with pytest.raises(InputParameterError):
562.             m = TParModel(coeff=[[1, 2], [3, 4]], e=4, n_models=2)
563.         with pytest.raises(InputParameterError):
564.             m = TParModel(coeff=[[1, 2], [3, 4]], e=4, model_set_axis=0)
565. 
566.     def test_array_parameter1(self):
567.         with pytest.raises(InputParameterError):
568.             t = TParModel(np.array([[1, 2], [3, 4]]), 1, model_set_axis=0)
569. 
570.     def test_array_parameter2(self):
571.         with pytest.raises(InputParameterError):
572.             m = TParModel(np.array([[1, 2], [3, 4]]), (1, 1, 11),
573.                              model_set_axis=0)
574. 
575.     def test_array_parameter4(self):
576.         """
577.         Test multiple parameter model with array-valued parameters of the same
578.         size as the number of parameter sets.
579.         """
580. 
581.         t4 = TParModel([[1, 2], [3, 4]], [5, 6], model_set_axis=False)
582.         assert len(t4) == 1
583.         assert t4.coeff.shape == (2, 2)
584.         assert t4.e.shape == (2,)
585.         assert np.issubdtype(t4.param_sets.dtype, np.object_)
586.         assert np.all(t4.param_sets[0] == [[1, 2], [3, 4]])
587.         assert np.all(t4.param_sets[1] == [5, 6])
588. 
589. 
590. def test_non_broadcasting_parameters():
591.     """
592.     Tests that in a model with 3 parameters that do not all mutually broadcast,
593.     this is determined correctly regardless of what order the parameters are
594.     in.
595.     """
596. 
597.     a = 3
598.     b = np.array([[1, 2, 3], [4, 5, 6]])
599.     c = np.array([[1, 2, 3, 4], [1, 2, 3, 4]])
600. 
601.     class TestModel(Model):
602.         p1 = Parameter()
603.         p2 = Parameter()
604.         p3 = Parameter()
605. 
606.         def evaluate(self, *args):
607.             return
608. 
609.     # a broadcasts with both b and c, but b does not broadcast with c
610.     for args in itertools.permutations((a, b, c)):
611.         with pytest.raises(InputParameterError):
612.             TestModel(*args)
613. 
614. 
615. def test_setter():
616.     pars = np.random.rand(20).reshape((10, 2))
617. 
618.     model = SetterModel(-1, 3, np.pi)
619. 
620.     for x, y in pars:
621.         model.x = x
622.         model.y = y
623.         utils.assert_almost_equal(model(x, y), (x + 1)**2 + (y - np.pi * 3)**2)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:10:17,034 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of the file `astropy/modeling/tests/test_parameters.py`. The provided context contains the entire file, so I am returning the whole content.', relative_path='astropy/modeling/tests/test_parameters.py', start_line=1, end_line=623)]
2025-12-21 19:10:17,035 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/modeling/tests/test_parameters.py`.
2025-12-21 19:10:17,036 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:10:17,036 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:10:17,036 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 2 existing contexts
2025-12-21 19:10:17,036 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-21 19:10:17,037 - thread-131697502848704.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-21 19:10:17,037 - thread-131697502848704.prometheus_context_collector - INFO - Successfully retrieved 3 context snippets
