2025-12-23 08:58:03,938 - thread-128424504956608.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: QuerySet.none() on combined queries returns all results.

Description: Description
	
I came across this issue on Stack Overflow. I'm not 100% sure it's a bug, but it does seem strange. With this code (excuse the bizarre example filtering):
class Publication(models.Model):
	pass
class Article(models.Model):
	publications = models.ManyToManyField(to=Publication, blank=True, null=True)
class ArticleForm(forms.ModelForm):
	publications = forms.ModelMultipleChoiceField(
		Publication.objects.filter(id__lt=2) | Publication.objects.filter(id__gt=5),
		required=False,
	)
	class Meta:
		model = Article
		fields = ["publications"]
class ArticleAdmin(admin.ModelAdmin):
	form = ArticleForm
This works well. However, changing the ModelMultipleChoiceField queryset to use union() breaks things.
publications = forms.ModelMultipleChoiceField(
	Publication.objects.filter(id__lt=2).union(
		Publication.objects.filter(id__gt=5)
	),
	required=False,
)
The form correctly shows only the matching objects. However, if you submit this form while empty (i.e. you didn't select any publications), ALL objects matching the queryset will be added. Using the OR query, NO objects are added, as I'd expect.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index c913267476..90c000dbf2 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1777,6 +1777,11 @@ class Query(BaseExpression):
 
     def set_empty(self):
         self.where.add(NothingNode(), AND)
+        # Clear combined query attributes to ensure .none() results in an
+        # empty queryset even if the query was a combined query (e.g. union).
+        self.combinator = None
+        self.combinator_all = False
+        self.combined_queries = ()
 
     def is_empty(self):
         return any(isinstance(c, NothingNode) for c in self.where.children)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 08:58:04,030 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.9.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: QuerySet.none() on combined queries returns all results.

Description: Description
	
I came across this issue on Stack Overflow. I'm not 100% sure it's a bug, but it does seem strange. With this code (excuse the bizarre example filtering):
class Publication(models.Model):
	pass
class Article(models.Model):
	publications = models.ManyToManyField(to=Publication, blank=True, null=True)
class ArticleForm(forms.ModelForm):
	publications = forms.ModelMultipleChoiceField(
		Publication.objects.filter(id__lt=2) | Publication.objects.filter(id__gt=5),
		required=False,
	)
	class Meta:
		model = Article
		fields = ["publications"]
class ArticleAdmin(admin.ModelAdmin):
	form = ArticleForm
This works well. However, changing the ModelMultipleChoiceField queryset to use union() breaks things.
publications = forms.ModelMultipleChoiceField(
	Publication.objects.filter(id__lt=2).union(
		Publication.objects.filter(id__gt=5)
	),
	required=False,
)
The form correctly shows only the matching objects. However, if you submit this form while empty (i.e. you didn't select any publications), ALL objects matching the queryset will be added. Using the OR query, NO objects are added, as I'd expect.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index c913267476..90c000dbf2 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1777,6 +1777,11 @@ class Query(BaseExpression):
 
     def set_empty(self):
         self.where.add(NothingNode(), AND)
+        # Clear combined query attributes to ensure .none() results in an
+        # empty queryset even if the query was a combined query (e.g. union).
+        self.combinator = None
+        self.combinator_all = False
+        self.combined_queries = ()
 
     def is_empty(self):
         return any(isinstance(c, NothingNode) for c in self.where.children)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 08:58:22,466 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user is reporting a bug related to `QuerySet.none()` on combined queries, specifically with `union()`. The patch is in `django/db/models/sql/query.py`. The most relevant tests for this functionality would be in the test files that cover query combinators and general queryset behavior. The current context is empty, so I need to request the most relevant test files. Based on the file tree, `tests/queries/test_qs_combinators.py` is the most likely place to find tests for `union()`, `intersection()`, etc. `tests/queries/tests.py` is also a good candidate for general queryset method tests like `none()`. I will start by requesting the first file to see if it contains relevant tests.' query='Please provide the full content of tests/queries/test_qs_combinators.py.' extra_requirements='If the file is too large, please provide the full content of tests/queries/tests.py instead.' purpose='I need to find existing test cases that demonstrate the bug with `QuerySet.none()` on combined queries, and this file is the most likely place to find them.'
2025-12-23 08:58:22,467 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of tests/queries/test_qs_combinators.py.
2025-12-23 08:58:22,467 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 08:58:22,468 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 08:58:22,468 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 08:58:22,468 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of tests/queries/test_qs_combinators.py.
Extra requirements: If the file is too large, please provide the full content of tests/queries/tests.py instead.
Purpose: I need to find existing test cases that demonstrate the bug with `QuerySet.none()` on combined queries, and this file is the most likely place to find them.
2025-12-23 08:58:27,592 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/queries/test_qs_combinators.py"}'}, '__gemini_function_call_thought_signatures__': {'a2b930cd-382b-4f0e-b4cc-113d6b395de1': 'CsYMAY89a1+CorabDRUoTuLWujrfrjk4nR++xn0+6rLh/YBCpQ8Ttql3EsS6aPpL6Tbu4tXQXFknDIcQf1Kyzut3EnAt9fi9UurUtpyyJlxD+doJWbvshXRz/T3l/V/W+so0lsNTpAsrt1ScmfHSbXtCFEfwpHjDD8N4a5RT4TDN7ewCeLOjgH2tpQBmvTTEj7qFe5IpCIyXEdoj/BvvFOfI/sxo51ZLSEK0EIW0voH1iubcV83ipKH5PoVuO/FYBDZLI3/gFw87BT/M6CCvYCcetPZDvVXo+Ck5v5Bn5Vo9mRJQDCh8QW5LWnOhPfIG6XuMEUC7olkEi3dOZWZgJs232btkh0xkvNvpgdoGGIVdNp0xe7txWMwWoAkFNrgc87HRPl889McwmLe+CXxndq0S8PnmSI1wwAWPErTP35JO06gTiLkV4elFiK+KZ69j0Mg9Wb/NwZFg7HoOrjp8VBr8A0LPVdRPKEAZc+cakoJ39Iuu51JGlX+nyEh2GGr2jKU4I9cSdt9rqvO8/vJawTCwlDgsxPE+HBA//Na0i6z940LSCqQjOc+X86TgoLbH/VEpzg8tA7kDkDgWxX6O9B+tvjitVYUi+aMC+NUjs6Q6H+PfLA+erCBcEabm8Q1X/KFaP1PrRX4ekND4tbUKtfS/8k9/HynpXDqoAyhK8FXW3xQbNIKdWvXz05zVD7khH6IvabjOA2IRGgVRP/f3qF5ny746xxaoMcRls//t9mEjj35HTmWzr3AtiE8Xa6PNanp7rE3VuSRfWLBV2KJCUQ6EoWnLcwCWq8nz+6Mi7u4KsOeJOrV/T9WMiUH5A8ZEJggBc+5jgoR1+ofuOwhIfllt7K/n65s/D7tpJ8XrqnDuvitU3GMzsB4jWg4TzbkTUnBZrlUfmjoXACb2RCvRYUE66nQeudbB5bJA8ld+j6ohEfKC1tzd2JHqwJsV349LVHnEoiqhkKaNAuT19NhQGZ3td9gDrziHfWbQxVC7T4PNGZCxaMR1YYipZGBdKrFXE52c066XOy39Wd82Av0WxM/2dptBiEEE5NfYchllLxiAc9QCw9rnf6KAQrxcvxWH8MuN2DU5ilrrOIclMNl3yXm7iXut4S9UPRthDafKEzJADcBvvyJWmX6INB2o5mQw6vdQAkma2ioFRkm3g6GZStodJwcHY+ejLXC2rfLhiFpHUBT8cext7f7CJLcVxWEKEI4Xv7gdcqmveRbVyj8fn3hE2Q8qbRz60auhYipJHAXdGFHL6XJY9yPBrTmE5lCGHBlq6Raj/2YZPTGipuSfdluwvKjlKsn0F8dwIoZy5GGTwDYm5PQLga1VFgfbBLy5kN0SzKyEVMTJ1U8H8P65AA3vZ3SGZFfFRHklobRHr7MRYX9Rd0H2u6tLgvZJbrr7pDIPTcMHptBUstQUqoLyOZTiiCodncM/qIlsd/sEDvbE9pgMPqnP288vvX3ZRixBnGhyNprWtNKkQYJVNHsB5JfPydaTR07XdRjpbC+eDYGTIk9nIxQjxwVJgPa9hycxTZFQdfgKYQmxHVwAW+Q6aSDxLQ+cB9lUSrvXf+hqAekHFTf1IPLfSyhCiz0d8PeRnOZ43Z8db2KL0nyvy7R0npHiWxodL7+PHTEqK+0sdLm4i25e13fucExzyH6jqfjN1ttkh0KmK5/3WMOQnpZm3NsM1m4IrgzJcm/Z2AQ+iTYRS64F46KtOIRi6NkYrknQcLOPYKcb3qt8bB34SanDutd4zvrukflEVpGTaNJlYU93P+ry2uLFuN2O7uXaR6dNBzkax7J7ckgRzx3qsvqBrUs8Shb0DfN7E+Mo8qoVaXVSPD8Kdcg1NqTRH3UQ2Istij+Z9Wfn9/TFKWCYi1jsbvmJ+Km/b38icsEUserSxbhDaKwKGokn8a5MSjGMn2O2camaVsgwDEgHZS23Nq+z4Ofa6AnCXFzFCUnliQzGGr3s9RPKgpregf+Aqf5Qdu6g8VuaCy3mNuPf7pR2ljHNYP27+zR/0A2XY0hFyZvkOVAkNjdMr8AsfqDu5HoPqd+4rDzKM/LD4O4c5dEYin/KCRQHaGwFH2vxX1BZi4ZsKxqkRrEk1+qbOGMgK24AiGo3zcDF3yjrVhlnZUT21kghqh7cPR/1cZ0AnA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2139, 'candidates_token_count': 26, 'total_token_count': 2587, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2139}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 422, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.286709712101863, 'model_name': 'gemini-2.5-pro'} id='run--bc7bcfcb-e94c-4826-944b-46e48cbde0cb-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/queries/test_qs_combinators.py'}, 'id': 'a2b930cd-382b-4f0e-b4cc-113d6b395de1', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2139, 'output_tokens': 26, 'total_tokens': 2587, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 422}}
2025-12-23 08:58:35,280 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the content of `tests/queries/test_qs_combinators.py`. The file was not too large, so there was no need to read the alternative file `tests/queries/tests.py`. I have examined the file and found several test cases relevant to your query about `QuerySet.none()` on combined queries, specifically the tests `test_intersection_with_empty_qs`, `test_difference_with_empty_qs`, and `test_union_with_empty_qs`.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8049, 'candidates_token_count': 109, 'total_token_count': 8901, 'cached_content_token_count': 1790, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8471}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1790}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 109}], 'thoughts_token_count': 743}, 'finish_reason': 'STOP', 'avg_logprobs': -0.478839979259246, 'model_name': 'gemini-2.5-pro'} id='run--986bd896-00bf-4434-9884-d8f80db005f0-0' usage_metadata={'input_tokens': 8049, 'output_tokens': 109, 'total_tokens': 8901, 'input_token_details': {'cache_read': 1790}, 'output_token_details': {'reasoning': 743}}
2025-12-23 08:58:35,282 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of tests/queries/test_qs_combinators.py.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please provide the full content of tests/queries/tests.py instead.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find existing test cases that demonstrate the bug with `QuerySet.none()` on combined queries, and this file is the most likely place to find them.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/queries/test_qs_combinators.py
Line number range: 1 - 316
Content:
1. import operator
2. 
3. from django.db import DatabaseError, NotSupportedError, connection
4. from django.db.models import Exists, F, IntegerField, OuterRef, Value
5. from django.test import TestCase, skipIfDBFeature, skipUnlessDBFeature
6. 
7. from .models import Number, ReservedName
8. 
9. 
10. @skipUnlessDBFeature('supports_select_union')
11. class QuerySetSetOperationTests(TestCase):
12.     @classmethod
13.     def setUpTestData(cls):
14.         Number.objects.bulk_create(Number(num=i, other_num=10 - i) for i in range(10))
15. 
16.     def assertNumbersEqual(self, queryset, expected_numbers, ordered=True):
17.         self.assertQuerysetEqual(queryset, expected_numbers, operator.attrgetter('num'), ordered)
18. 
19.     def test_simple_union(self):
20.         qs1 = Number.objects.filter(num__lte=1)
21.         qs2 = Number.objects.filter(num__gte=8)
22.         qs3 = Number.objects.filter(num=5)
23.         self.assertNumbersEqual(qs1.union(qs2, qs3), [0, 1, 5, 8, 9], ordered=False)
24. 
25.     @skipUnlessDBFeature('supports_select_intersection')
26.     def test_simple_intersection(self):
27.         qs1 = Number.objects.filter(num__lte=5)
28.         qs2 = Number.objects.filter(num__gte=5)
29.         qs3 = Number.objects.filter(num__gte=4, num__lte=6)
30.         self.assertNumbersEqual(qs1.intersection(qs2, qs3), [5], ordered=False)
31. 
32.     @skipUnlessDBFeature('supports_select_intersection')
33.     def test_intersection_with_values(self):
34.         ReservedName.objects.create(name='a', order=2)
35.         qs1 = ReservedName.objects.all()
36.         reserved_name = qs1.intersection(qs1).values('name', 'order', 'id').get()
37.         self.assertEqual(reserved_name['name'], 'a')
38.         self.assertEqual(reserved_name['order'], 2)
39.         reserved_name = qs1.intersection(qs1).values_list('name', 'order', 'id').get()
40.         self.assertEqual(reserved_name[:2], ('a', 2))
41. 
42.     @skipUnlessDBFeature('supports_select_difference')
43.     def test_simple_difference(self):
44.         qs1 = Number.objects.filter(num__lte=5)
45.         qs2 = Number.objects.filter(num__lte=4)
46.         self.assertNumbersEqual(qs1.difference(qs2), [5], ordered=False)
47. 
48.     def test_union_distinct(self):
49.         qs1 = Number.objects.all()
50.         qs2 = Number.objects.all()
51.         self.assertEqual(len(list(qs1.union(qs2, all=True))), 20)
52.         self.assertEqual(len(list(qs1.union(qs2))), 10)
53. 
54.     @skipUnlessDBFeature('supports_select_intersection')
55.     def test_intersection_with_empty_qs(self):
56.         qs1 = Number.objects.all()
57.         qs2 = Number.objects.none()
58.         qs3 = Number.objects.filter(pk__in=[])
59.         self.assertEqual(len(qs1.intersection(qs2)), 0)
60.         self.assertEqual(len(qs1.intersection(qs3)), 0)
61.         self.assertEqual(len(qs2.intersection(qs1)), 0)
62.         self.assertEqual(len(qs3.intersection(qs1)), 0)
63.         self.assertEqual(len(qs2.intersection(qs2)), 0)
64.         self.assertEqual(len(qs3.intersection(qs3)), 0)
65. 
66.     @skipUnlessDBFeature('supports_select_difference')
67.     def test_difference_with_empty_qs(self):
68.         qs1 = Number.objects.all()
69.         qs2 = Number.objects.none()
70.         qs3 = Number.objects.filter(pk__in=[])
71.         self.assertEqual(len(qs1.difference(qs2)), 10)
72.         self.assertEqual(len(qs1.difference(qs3)), 10)
73.         self.assertEqual(len(qs2.difference(qs1)), 0)
74.         self.assertEqual(len(qs3.difference(qs1)), 0)
75.         self.assertEqual(len(qs2.difference(qs2)), 0)
76.         self.assertEqual(len(qs3.difference(qs3)), 0)
77. 
78.     @skipUnlessDBFeature('supports_select_difference')
79.     def test_difference_with_values(self):
80.         ReservedName.objects.create(name='a', order=2)
81.         qs1 = ReservedName.objects.all()
82.         qs2 = ReservedName.objects.none()
83.         reserved_name = qs1.difference(qs2).values('name', 'order', 'id').get()
84.         self.assertEqual(reserved_name['name'], 'a')
85.         self.assertEqual(reserved_name['order'], 2)
86.         reserved_name = qs1.difference(qs2).values_list('name', 'order', 'id').get()
87.         self.assertEqual(reserved_name[:2], ('a', 2))
88. 
89.     def test_union_with_empty_qs(self):
90.         qs1 = Number.objects.all()
91.         qs2 = Number.objects.none()
92.         qs3 = Number.objects.filter(pk__in=[])
93.         self.assertEqual(len(qs1.union(qs2)), 10)
94.         self.assertEqual(len(qs2.union(qs1)), 10)
95.         self.assertEqual(len(qs1.union(qs3)), 10)
96.         self.assertEqual(len(qs3.union(qs1)), 10)
97.         self.assertEqual(len(qs2.union(qs1, qs1, qs1)), 10)
98.         self.assertEqual(len(qs2.union(qs1, qs1, all=True)), 20)
99.         self.assertEqual(len(qs2.union(qs2)), 0)
100.         self.assertEqual(len(qs3.union(qs3)), 0)
101. 
102.     def test_limits(self):
103.         qs1 = Number.objects.all()
104.         qs2 = Number.objects.all()
105.         self.assertEqual(len(list(qs1.union(qs2)[:2])), 2)
106. 
107.     def test_ordering(self):
108.         qs1 = Number.objects.filter(num__lte=1)
109.         qs2 = Number.objects.filter(num__gte=2, num__lte=3)
110.         self.assertNumbersEqual(qs1.union(qs2).order_by('-num'), [3, 2, 1, 0])
111. 
112.     def test_ordering_by_alias(self):
113.         qs1 = Number.objects.filter(num__lte=1).values(alias=F('num'))
114.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values(alias=F('num'))
115.         self.assertQuerysetEqual(
116.             qs1.union(qs2).order_by('-alias'),
117.             [3, 2, 1, 0],
118.             operator.itemgetter('alias'),
119.         )
120. 
121.     def test_ordering_by_f_expression(self):
122.         qs1 = Number.objects.filter(num__lte=1)
123.         qs2 = Number.objects.filter(num__gte=2, num__lte=3)
124.         self.assertNumbersEqual(qs1.union(qs2).order_by(F('num').desc()), [3, 2, 1, 0])
125. 
126.     def test_ordering_by_f_expression_and_alias(self):
127.         qs1 = Number.objects.filter(num__lte=1).values(alias=F('other_num'))
128.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values(alias=F('other_num'))
129.         self.assertQuerysetEqual(
130.             qs1.union(qs2).order_by(F('alias').desc()),
131.             [10, 9, 8, 7],
132.             operator.itemgetter('alias'),
133.         )
134.         Number.objects.create(num=-1)
135.         self.assertQuerysetEqual(
136.             qs1.union(qs2).order_by(F('alias').desc(nulls_last=True)),
137.             [10, 9, 8, 7, None],
138.             operator.itemgetter('alias'),
139.         )
140. 
141.     def test_union_with_values(self):
142.         ReservedName.objects.create(name='a', order=2)
143.         qs1 = ReservedName.objects.all()
144.         reserved_name = qs1.union(qs1).values('name', 'order', 'id').get()
145.         self.assertEqual(reserved_name['name'], 'a')
146.         self.assertEqual(reserved_name['order'], 2)
147.         reserved_name = qs1.union(qs1).values_list('name', 'order', 'id').get()
148.         self.assertEqual(reserved_name[:2], ('a', 2))
149.         # List of columns can be changed.
150.         reserved_name = qs1.union(qs1).values_list('order').get()
151.         self.assertEqual(reserved_name, (2,))
152. 
153.     def test_union_with_two_annotated_values_list(self):
154.         qs1 = Number.objects.filter(num=1).annotate(
155.             count=Value(0, IntegerField()),
156.         ).values_list('num', 'count')
157.         qs2 = Number.objects.filter(num=2).values('pk').annotate(
158.             count=F('num'),
159.         ).annotate(
160.             num=Value(1, IntegerField()),
161.         ).values_list('num', 'count')
162.         self.assertCountEqual(qs1.union(qs2), [(1, 0), (2, 1)])
163. 
164.     def test_union_with_extra_and_values_list(self):
165.         qs1 = Number.objects.filter(num=1).extra(
166.             select={'count': 0},
167.         ).values_list('num', 'count')
168.         qs2 = Number.objects.filter(num=2).extra(select={'count': 1})
169.         self.assertCountEqual(qs1.union(qs2), [(1, 0), (2, 1)])
170. 
171.     def test_union_with_values_list_on_annotated_and_unannotated(self):
172.         ReservedName.objects.create(name='rn1', order=1)
173.         qs1 = Number.objects.annotate(
174.             has_reserved_name=Exists(ReservedName.objects.filter(order=OuterRef('num')))
175.         ).filter(has_reserved_name=True)
176.         qs2 = Number.objects.filter(num=9)
177.         self.assertCountEqual(qs1.union(qs2).values_list('num', flat=True), [1, 9])
178. 
179.     def test_union_with_values_list_and_order(self):
180.         ReservedName.objects.bulk_create([
181.             ReservedName(name='rn1', order=7),
182.             ReservedName(name='rn2', order=5),
183.             ReservedName(name='rn0', order=6),
184.             ReservedName(name='rn9', order=-1),
185.         ])
186.         qs1 = ReservedName.objects.filter(order__gte=6)
187.         qs2 = ReservedName.objects.filter(order__lte=5)
188.         union_qs = qs1.union(qs2)
189.         for qs, expected_result in (
190.             # Order by a single column.
191.             (union_qs.order_by('-pk').values_list('order', flat=True), [-1, 6, 5, 7]),
192.             (union_qs.order_by('pk').values_list('order', flat=True), [7, 5, 6, -1]),
193.             (union_qs.values_list('order', flat=True).order_by('-pk'), [-1, 6, 5, 7]),
194.             (union_qs.values_list('order', flat=True).order_by('pk'), [7, 5, 6, -1]),
195.             # Order by multiple columns.
196.             (union_qs.order_by('-name', 'pk').values_list('order', flat=True), [-1, 5, 7, 6]),
197.             (union_qs.values_list('order', flat=True).order_by('-name', 'pk'), [-1, 5, 7, 6]),
198.         ):
199.             with self.subTest(qs=qs):
200.                 self.assertEqual(list(qs), expected_result)
201. 
202.     def test_count_union(self):
203.         qs1 = Number.objects.filter(num__lte=1).values('num')
204.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values('num')
205.         self.assertEqual(qs1.union(qs2).count(), 4)
206. 
207.     def test_count_union_empty_result(self):
208.         qs = Number.objects.filter(pk__in=[])
209.         self.assertEqual(qs.union(qs).count(), 0)
210. 
211.     @skipUnlessDBFeature('supports_select_difference')
212.     def test_count_difference(self):
213.         qs1 = Number.objects.filter(num__lt=10)
214.         qs2 = Number.objects.filter(num__lt=9)
215.         self.assertEqual(qs1.difference(qs2).count(), 1)
216. 
217.     @skipUnlessDBFeature('supports_select_intersection')
218.     def test_count_intersection(self):
219.         qs1 = Number.objects.filter(num__gte=5)
220.         qs2 = Number.objects.filter(num__lte=5)
221.         self.assertEqual(qs1.intersection(qs2).count(), 1)
222. 
223.     @skipUnlessDBFeature('supports_slicing_ordering_in_compound')
224.     def test_ordering_subqueries(self):
225.         qs1 = Number.objects.order_by('num')[:2]
226.         qs2 = Number.objects.order_by('-num')[:2]
227.         self.assertNumbersEqual(qs1.union(qs2).order_by('-num')[:4], [9, 8, 1, 0])
228. 
229.     @skipIfDBFeature('supports_slicing_ordering_in_compound')
230.     def test_unsupported_ordering_slicing_raises_db_error(self):
231.         qs1 = Number.objects.all()
232.         qs2 = Number.objects.all()
233.         msg = 'LIMIT/OFFSET not allowed in subqueries of compound statements'
234.         with self.assertRaisesMessage(DatabaseError, msg):
235.             list(qs1.union(qs2[:10]))
236.         msg = 'ORDER BY not allowed in subqueries of compound statements'
237.         with self.assertRaisesMessage(DatabaseError, msg):
238.             list(qs1.order_by('id').union(qs2))
239. 
240.     @skipIfDBFeature('supports_select_intersection')
241.     def test_unsupported_intersection_raises_db_error(self):
242.         qs1 = Number.objects.all()
243.         qs2 = Number.objects.all()
244.         msg = 'intersection is not supported on this database backend'
245.         with self.assertRaisesMessage(NotSupportedError, msg):
246.             list(qs1.intersection(qs2))
247. 
248.     def test_combining_multiple_models(self):
249.         ReservedName.objects.create(name='99 little bugs', order=99)
250.         qs1 = Number.objects.filter(num=1).values_list('num', flat=True)
251.         qs2 = ReservedName.objects.values_list('order')
252.         self.assertEqual(list(qs1.union(qs2).order_by('num')), [1, 99])
253. 
254.     def test_order_raises_on_non_selected_column(self):
255.         qs1 = Number.objects.filter().annotate(
256.             annotation=Value(1, IntegerField()),
257.         ).values('annotation', num2=F('num'))
258.         qs2 = Number.objects.filter().values('id', 'num')
259.         # Should not raise
260.         list(qs1.union(qs2).order_by('annotation'))
261.         list(qs1.union(qs2).order_by('num2'))
262.         msg = 'ORDER BY term does not match any column in the result set'
263.         # 'id' is not part of the select
264.         with self.assertRaisesMessage(DatabaseError, msg):
265.             list(qs1.union(qs2).order_by('id'))
266.         # 'num' got realiased to num2
267.         with self.assertRaisesMessage(DatabaseError, msg):
268.             list(qs1.union(qs2).order_by('num'))
269.         with self.assertRaisesMessage(DatabaseError, msg):
270.             list(qs1.union(qs2).order_by(F('num')))
271.         with self.assertRaisesMessage(DatabaseError, msg):
272.             list(qs1.union(qs2).order_by(F('num').desc()))
273.         # switched order, now 'exists' again:
274.         list(qs2.union(qs1).order_by('num'))
275. 
276.     @skipUnlessDBFeature('supports_select_difference', 'supports_select_intersection')
277.     def test_qs_with_subcompound_qs(self):
278.         qs1 = Number.objects.all()
279.         qs2 = Number.objects.intersection(Number.objects.filter(num__gt=1))
280.         self.assertEqual(qs1.difference(qs2).count(), 2)
281. 
282.     def test_order_by_same_type(self):
283.         qs = Number.objects.all()
284.         union = qs.union(qs)
285.         numbers = list(range(10))
286.         self.assertNumbersEqual(union.order_by('num'), numbers)
287.         self.assertNumbersEqual(union.order_by('other_num'), reversed(numbers))
288. 
289.     def test_unsupported_operations_on_combined_qs(self):
290.         qs = Number.objects.all()
291.         msg = 'Calling QuerySet.%s() after %s() is not supported.'
292.         combinators = ['union']
293.         if connection.features.supports_select_difference:
294.             combinators.append('difference')
295.         if connection.features.supports_select_intersection:
296.             combinators.append('intersection')
297.         for combinator in combinators:
298.             for operation in (
299.                 'annotate',
300.                 'defer',
301.                 'delete',
302.                 'distinct',
303.                 'exclude',
304.                 'extra',
305.                 'filter',
306.                 'only',
307.                 'prefetch_related',
308.                 'select_related',
309.                 'update',
310.             ):
311.                 with self.subTest(combinator=combinator, operation=operation):
312.                     with self.assertRaisesMessage(
313.                         NotSupportedError,
314.                         msg % (operation, combinator),
315.                     ):
316.                         getattr(getattr(qs, combinator)(qs), operation)()

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 08:58:42,351 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file 'tests/queries/test_qs_combinators.py'.\n2. Extended relevance:\n   - The provided context is the entire content of the requested file, from line 1 to 316. This directly and completely fulfills the user's request.\n   - The user's purpose is to find tests related to `QuerySet.none()` on combined queries. This file contains relevant test cases such as `test_intersection_with_empty_qs`, `test_difference_with_empty_qs`, and `test_union_with_empty_qs`, which use `QuerySet.none()`.", relative_path='tests/queries/test_qs_combinators.py', start_line=1, end_line=316)]
2025-12-23 08:58:42,353 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of tests/queries/test_qs_combinators.py.
2025-12-23 08:58:42,353 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 08:58:42,353 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 08:58:42,354 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 08:58:42,354 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 08:58:42,356 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.9.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: QuerySet.none() on combined queries returns all results.

Description: Description
	
I came across this issue on Stack Overflow. I'm not 100% sure it's a bug, but it does seem strange. With this code (excuse the bizarre example filtering):
class Publication(models.Model):
	pass
class Article(models.Model):
	publications = models.ManyToManyField(to=Publication, blank=True, null=True)
class ArticleForm(forms.ModelForm):
	publications = forms.ModelMultipleChoiceField(
		Publication.objects.filter(id__lt=2) | Publication.objects.filter(id__gt=5),
		required=False,
	)
	class Meta:
		model = Article
		fields = ["publications"]
class ArticleAdmin(admin.ModelAdmin):
	form = ArticleForm
This works well. However, changing the ModelMultipleChoiceField queryset to use union() breaks things.
publications = forms.ModelMultipleChoiceField(
	Publication.objects.filter(id__lt=2).union(
		Publication.objects.filter(id__gt=5)
	),
	required=False,
)
The form correctly shows only the matching objects. However, if you submit this form while empty (i.e. you didn't select any publications), ALL objects matching the queryset will be added. Using the OR query, NO objects are added, as I'd expect.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index c913267476..90c000dbf2 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1777,6 +1777,11 @@ class Query(BaseExpression):
 
     def set_empty(self):
         self.where.add(NothingNode(), AND)
+        # Clear combined query attributes to ensure .none() results in an
+        # empty queryset even if the query was a combined query (e.g. union).
+        self.combinator = None
+        self.combinator_all = False
+        self.combined_queries = ()
 
     def is_empty(self):
         return any(isinstance(c, NothingNode) for c in self.where.children)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of tests/queries/test_qs_combinators.py.
Extra Requirements: If the file is too large, please provide the full content of tests/queries/tests.py instead.
Purpose: I need to find existing test cases that demonstrate the bug with `QuerySet.none()` on combined queries, and this file is the most likely place to find them.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/queries/test_qs_combinators.py
Line number range: 1 - 316
Content:
1. import operator
2. 
3. from django.db import DatabaseError, NotSupportedError, connection
4. from django.db.models import Exists, F, IntegerField, OuterRef, Value
5. from django.test import TestCase, skipIfDBFeature, skipUnlessDBFeature
6. 
7. from .models import Number, ReservedName
8. 
9. 
10. @skipUnlessDBFeature('supports_select_union')
11. class QuerySetSetOperationTests(TestCase):
12.     @classmethod
13.     def setUpTestData(cls):
14.         Number.objects.bulk_create(Number(num=i, other_num=10 - i) for i in range(10))
15. 
16.     def assertNumbersEqual(self, queryset, expected_numbers, ordered=True):
17.         self.assertQuerysetEqual(queryset, expected_numbers, operator.attrgetter('num'), ordered)
18. 
19.     def test_simple_union(self):
20.         qs1 = Number.objects.filter(num__lte=1)
21.         qs2 = Number.objects.filter(num__gte=8)
22.         qs3 = Number.objects.filter(num=5)
23.         self.assertNumbersEqual(qs1.union(qs2, qs3), [0, 1, 5, 8, 9], ordered=False)
24. 
25.     @skipUnlessDBFeature('supports_select_intersection')
26.     def test_simple_intersection(self):
27.         qs1 = Number.objects.filter(num__lte=5)
28.         qs2 = Number.objects.filter(num__gte=5)
29.         qs3 = Number.objects.filter(num__gte=4, num__lte=6)
30.         self.assertNumbersEqual(qs1.intersection(qs2, qs3), [5], ordered=False)
31. 
32.     @skipUnlessDBFeature('supports_select_intersection')
33.     def test_intersection_with_values(self):
34.         ReservedName.objects.create(name='a', order=2)
35.         qs1 = ReservedName.objects.all()
36.         reserved_name = qs1.intersection(qs1).values('name', 'order', 'id').get()
37.         self.assertEqual(reserved_name['name'], 'a')
38.         self.assertEqual(reserved_name['order'], 2)
39.         reserved_name = qs1.intersection(qs1).values_list('name', 'order', 'id').get()
40.         self.assertEqual(reserved_name[:2], ('a', 2))
41. 
42.     @skipUnlessDBFeature('supports_select_difference')
43.     def test_simple_difference(self):
44.         qs1 = Number.objects.filter(num__lte=5)
45.         qs2 = Number.objects.filter(num__lte=4)
46.         self.assertNumbersEqual(qs1.difference(qs2), [5], ordered=False)
47. 
48.     def test_union_distinct(self):
49.         qs1 = Number.objects.all()
50.         qs2 = Number.objects.all()
51.         self.assertEqual(len(list(qs1.union(qs2, all=True))), 20)
52.         self.assertEqual(len(list(qs1.union(qs2))), 10)
53. 
54.     @skipUnlessDBFeature('supports_select_intersection')
55.     def test_intersection_with_empty_qs(self):
56.         qs1 = Number.objects.all()
57.         qs2 = Number.objects.none()
58.         qs3 = Number.objects.filter(pk__in=[])
59.         self.assertEqual(len(qs1.intersection(qs2)), 0)
60.         self.assertEqual(len(qs1.intersection(qs3)), 0)
61.         self.assertEqual(len(qs2.intersection(qs1)), 0)
62.         self.assertEqual(len(qs3.intersection(qs1)), 0)
63.         self.assertEqual(len(qs2.intersection(qs2)), 0)
64.         self.assertEqual(len(qs3.intersection(qs3)), 0)
65. 
66.     @skipUnlessDBFeature('supports_select_difference')
67.     def test_difference_with_empty_qs(self):
68.         qs1 = Number.objects.all()
69.         qs2 = Number.objects.none()
70.         qs3 = Number.objects.filter(pk__in=[])
71.         self.assertEqual(len(qs1.difference(qs2)), 10)
72.         self.assertEqual(len(qs1.difference(qs3)), 10)
73.         self.assertEqual(len(qs2.difference(qs1)), 0)
74.         self.assertEqual(len(qs3.difference(qs1)), 0)
75.         self.assertEqual(len(qs2.difference(qs2)), 0)
76.         self.assertEqual(len(qs3.difference(qs3)), 0)
77. 
78.     @skipUnlessDBFeature('supports_select_difference')
79.     def test_difference_with_values(self):
80.         ReservedName.objects.create(name='a', order=2)
81.         qs1 = ReservedName.objects.all()
82.         qs2 = ReservedName.objects.none()
83.         reserved_name = qs1.difference(qs2).values('name', 'order', 'id').get()
84.         self.assertEqual(reserved_name['name'], 'a')
85.         self.assertEqual(reserved_name['order'], 2)
86.         reserved_name = qs1.difference(qs2).values_list('name', 'order', 'id').get()
87.         self.assertEqual(reserved_name[:2], ('a', 2))
88. 
89.     def test_union_with_empty_qs(self):
90.         qs1 = Number.objects.all()
91.         qs2 = Number.objects.none()
92.         qs3 = Number.objects.filter(pk__in=[])
93.         self.assertEqual(len(qs1.union(qs2)), 10)
94.         self.assertEqual(len(qs2.union(qs1)), 10)
95.         self.assertEqual(len(qs1.union(qs3)), 10)
96.         self.assertEqual(len(qs3.union(qs1)), 10)
97.         self.assertEqual(len(qs2.union(qs1, qs1, qs1)), 10)
98.         self.assertEqual(len(qs2.union(qs1, qs1, all=True)), 20)
99.         self.assertEqual(len(qs2.union(qs2)), 0)
100.         self.assertEqual(len(qs3.union(qs3)), 0)
101. 
102.     def test_limits(self):
103.         qs1 = Number.objects.all()
104.         qs2 = Number.objects.all()
105.         self.assertEqual(len(list(qs1.union(qs2)[:2])), 2)
106. 
107.     def test_ordering(self):
108.         qs1 = Number.objects.filter(num__lte=1)
109.         qs2 = Number.objects.filter(num__gte=2, num__lte=3)
110.         self.assertNumbersEqual(qs1.union(qs2).order_by('-num'), [3, 2, 1, 0])
111. 
112.     def test_ordering_by_alias(self):
113.         qs1 = Number.objects.filter(num__lte=1).values(alias=F('num'))
114.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values(alias=F('num'))
115.         self.assertQuerysetEqual(
116.             qs1.union(qs2).order_by('-alias'),
117.             [3, 2, 1, 0],
118.             operator.itemgetter('alias'),
119.         )
120. 
121.     def test_ordering_by_f_expression(self):
122.         qs1 = Number.objects.filter(num__lte=1)
123.         qs2 = Number.objects.filter(num__gte=2, num__lte=3)
124.         self.assertNumbersEqual(qs1.union(qs2).order_by(F('num').desc()), [3, 2, 1, 0])
125. 
126.     def test_ordering_by_f_expression_and_alias(self):
127.         qs1 = Number.objects.filter(num__lte=1).values(alias=F('other_num'))
128.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values(alias=F('other_num'))
129.         self.assertQuerysetEqual(
130.             qs1.union(qs2).order_by(F('alias').desc()),
131.             [10, 9, 8, 7],
132.             operator.itemgetter('alias'),
133.         )
134.         Number.objects.create(num=-1)
135.         self.assertQuerysetEqual(
136.             qs1.union(qs2).order_by(F('alias').desc(nulls_last=True)),
137.             [10, 9, 8, 7, None],
138.             operator.itemgetter('alias'),
139.         )
140. 
141.     def test_union_with_values(self):
142.         ReservedName.objects.create(name='a', order=2)
143.         qs1 = ReservedName.objects.all()
144.         reserved_name = qs1.union(qs1).values('name', 'order', 'id').get()
145.         self.assertEqual(reserved_name['name'], 'a')
146.         self.assertEqual(reserved_name['order'], 2)
147.         reserved_name = qs1.union(qs1).values_list('name', 'order', 'id').get()
148.         self.assertEqual(reserved_name[:2], ('a', 2))
149.         # List of columns can be changed.
150.         reserved_name = qs1.union(qs1).values_list('order').get()
151.         self.assertEqual(reserved_name, (2,))
152. 
153.     def test_union_with_two_annotated_values_list(self):
154.         qs1 = Number.objects.filter(num=1).annotate(
155.             count=Value(0, IntegerField()),
156.         ).values_list('num', 'count')
157.         qs2 = Number.objects.filter(num=2).values('pk').annotate(
158.             count=F('num'),
159.         ).annotate(
160.             num=Value(1, IntegerField()),
161.         ).values_list('num', 'count')
162.         self.assertCountEqual(qs1.union(qs2), [(1, 0), (2, 1)])
163. 
164.     def test_union_with_extra_and_values_list(self):
165.         qs1 = Number.objects.filter(num=1).extra(
166.             select={'count': 0},
167.         ).values_list('num', 'count')
168.         qs2 = Number.objects.filter(num=2).extra(select={'count': 1})
169.         self.assertCountEqual(qs1.union(qs2), [(1, 0), (2, 1)])
170. 
171.     def test_union_with_values_list_on_annotated_and_unannotated(self):
172.         ReservedName.objects.create(name='rn1', order=1)
173.         qs1 = Number.objects.annotate(
174.             has_reserved_name=Exists(ReservedName.objects.filter(order=OuterRef('num')))
175.         ).filter(has_reserved_name=True)
176.         qs2 = Number.objects.filter(num=9)
177.         self.assertCountEqual(qs1.union(qs2).values_list('num', flat=True), [1, 9])
178. 
179.     def test_union_with_values_list_and_order(self):
180.         ReservedName.objects.bulk_create([
181.             ReservedName(name='rn1', order=7),
182.             ReservedName(name='rn2', order=5),
183.             ReservedName(name='rn0', order=6),
184.             ReservedName(name='rn9', order=-1),
185.         ])
186.         qs1 = ReservedName.objects.filter(order__gte=6)
187.         qs2 = ReservedName.objects.filter(order__lte=5)
188.         union_qs = qs1.union(qs2)
189.         for qs, expected_result in (
190.             # Order by a single column.
191.             (union_qs.order_by('-pk').values_list('order', flat=True), [-1, 6, 5, 7]),
192.             (union_qs.order_by('pk').values_list('order', flat=True), [7, 5, 6, -1]),
193.             (union_qs.values_list('order', flat=True).order_by('-pk'), [-1, 6, 5, 7]),
194.             (union_qs.values_list('order', flat=True).order_by('pk'), [7, 5, 6, -1]),
195.             # Order by multiple columns.
196.             (union_qs.order_by('-name', 'pk').values_list('order', flat=True), [-1, 5, 7, 6]),
197.             (union_qs.values_list('order', flat=True).order_by('-name', 'pk'), [-1, 5, 7, 6]),
198.         ):
199.             with self.subTest(qs=qs):
200.                 self.assertEqual(list(qs), expected_result)
201. 
202.     def test_count_union(self):
203.         qs1 = Number.objects.filter(num__lte=1).values('num')
204.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values('num')
205.         self.assertEqual(qs1.union(qs2).count(), 4)
206. 
207.     def test_count_union_empty_result(self):
208.         qs = Number.objects.filter(pk__in=[])
209.         self.assertEqual(qs.union(qs).count(), 0)
210. 
211.     @skipUnlessDBFeature('supports_select_difference')
212.     def test_count_difference(self):
213.         qs1 = Number.objects.filter(num__lt=10)
214.         qs2 = Number.objects.filter(num__lt=9)
215.         self.assertEqual(qs1.difference(qs2).count(), 1)
216. 
217.     @skipUnlessDBFeature('supports_select_intersection')
218.     def test_count_intersection(self):
219.         qs1 = Number.objects.filter(num__gte=5)
220.         qs2 = Number.objects.filter(num__lte=5)
221.         self.assertEqual(qs1.intersection(qs2).count(), 1)
222. 
223.     @skipUnlessDBFeature('supports_slicing_ordering_in_compound')
224.     def test_ordering_subqueries(self):
225.         qs1 = Number.objects.order_by('num')[:2]
226.         qs2 = Number.objects.order_by('-num')[:2]
227.         self.assertNumbersEqual(qs1.union(qs2).order_by('-num')[:4], [9, 8, 1, 0])
228. 
229.     @skipIfDBFeature('supports_slicing_ordering_in_compound')
230.     def test_unsupported_ordering_slicing_raises_db_error(self):
231.         qs1 = Number.objects.all()
232.         qs2 = Number.objects.all()
233.         msg = 'LIMIT/OFFSET not allowed in subqueries of compound statements'
234.         with self.assertRaisesMessage(DatabaseError, msg):
235.             list(qs1.union(qs2[:10]))
236.         msg = 'ORDER BY not allowed in subqueries of compound statements'
237.         with self.assertRaisesMessage(DatabaseError, msg):
238.             list(qs1.order_by('id').union(qs2))
239. 
240.     @skipIfDBFeature('supports_select_intersection')
241.     def test_unsupported_intersection_raises_db_error(self):
242.         qs1 = Number.objects.all()
243.         qs2 = Number.objects.all()
244.         msg = 'intersection is not supported on this database backend'
245.         with self.assertRaisesMessage(NotSupportedError, msg):
246.             list(qs1.intersection(qs2))
247. 
248.     def test_combining_multiple_models(self):
249.         ReservedName.objects.create(name='99 little bugs', order=99)
250.         qs1 = Number.objects.filter(num=1).values_list('num', flat=True)
251.         qs2 = ReservedName.objects.values_list('order')
252.         self.assertEqual(list(qs1.union(qs2).order_by('num')), [1, 99])
253. 
254.     def test_order_raises_on_non_selected_column(self):
255.         qs1 = Number.objects.filter().annotate(
256.             annotation=Value(1, IntegerField()),
257.         ).values('annotation', num2=F('num'))
258.         qs2 = Number.objects.filter().values('id', 'num')
259.         # Should not raise
260.         list(qs1.union(qs2).order_by('annotation'))
261.         list(qs1.union(qs2).order_by('num2'))
262.         msg = 'ORDER BY term does not match any column in the result set'
263.         # 'id' is not part of the select
264.         with self.assertRaisesMessage(DatabaseError, msg):
265.             list(qs1.union(qs2).order_by('id'))
266.         # 'num' got realiased to num2
267.         with self.assertRaisesMessage(DatabaseError, msg):
268.             list(qs1.union(qs2).order_by('num'))
269.         with self.assertRaisesMessage(DatabaseError, msg):
270.             list(qs1.union(qs2).order_by(F('num')))
271.         with self.assertRaisesMessage(DatabaseError, msg):
272.             list(qs1.union(qs2).order_by(F('num').desc()))
273.         # switched order, now 'exists' again:
274.         list(qs2.union(qs1).order_by('num'))
275. 
276.     @skipUnlessDBFeature('supports_select_difference', 'supports_select_intersection')
277.     def test_qs_with_subcompound_qs(self):
278.         qs1 = Number.objects.all()
279.         qs2 = Number.objects.intersection(Number.objects.filter(num__gt=1))
280.         self.assertEqual(qs1.difference(qs2).count(), 2)
281. 
282.     def test_order_by_same_type(self):
283.         qs = Number.objects.all()
284.         union = qs.union(qs)
285.         numbers = list(range(10))
286.         self.assertNumbersEqual(union.order_by('num'), numbers)
287.         self.assertNumbersEqual(union.order_by('other_num'), reversed(numbers))
288. 
289.     def test_unsupported_operations_on_combined_qs(self):
290.         qs = Number.objects.all()
291.         msg = 'Calling QuerySet.%s() after %s() is not supported.'
292.         combinators = ['union']
293.         if connection.features.supports_select_difference:
294.             combinators.append('difference')
295.         if connection.features.supports_select_intersection:
296.             combinators.append('intersection')
297.         for combinator in combinators:
298.             for operation in (
299.                 'annotate',
300.                 'defer',
301.                 'delete',
302.                 'distinct',
303.                 'exclude',
304.                 'extra',
305.                 'filter',
306.                 'only',
307.                 'prefetch_related',
308.                 'select_related',
309.                 'update',
310.             ):
311.                 with self.subTest(combinator=combinator, operation=operation):
312.                     with self.assertRaisesMessage(
313.                         NotSupportedError,
314.                         msg % (operation, combinator),
315.                     ):
316.                         getattr(getattr(qs, combinator)(qs), operation)()

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 08:59:24,757 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's bug is about `QuerySet.none()` applied to a combined queryset created with `union`. The current context (`tests/queries/test_qs_combinators.py`) tests combining querysets with empty ones, but not applying `.none()` to an already combined queryset. The file `tests/queries/tests.py` is the main test file for querysets and is likely to contain more varied tests for `.none()`, which is needed to find the most relevant examples for the user's issue." query='Please provide the full content of tests/queries/tests.py' extra_requirements='' purpose='I need to find test cases that cover the behavior of `QuerySet.none()` on complex or combined querysets to find the most relevant tests for the reported bug.'
2025-12-23 08:59:24,758 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of tests/queries/tests.py
2025-12-23 08:59:24,758 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 08:59:24,759 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 08:59:24,759 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 08:59:24,759 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of tests/queries/tests.py
Purpose: I need to find test cases that cover the behavior of `QuerySet.none()` on complex or combined querysets to find the most relevant tests for the reported bug.
2025-12-23 08:59:28,364 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I will first retrieve the file's metadata to check its size. Afterwards, I will proceed to read the entire file content, handling large files by reading them in sections if necessary." additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "tests/queries/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2107, 'candidates_token_count': 58, 'total_token_count': 2394, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2107}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 58}], 'thoughts_token_count': 229, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.28982501194394866, 'model_name': 'gemini-2.5-pro'} id='run--14831aa3-eb5e-44d9-91ef-6ddf4de9fe57-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'tests/queries/tests.py'}, 'id': 'e9991f8d-4cec-4a7b-8481-efb078098797', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2107, 'output_tokens': 58, 'total_tokens': 2394, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 229}}
2025-12-23 08:59:31,121 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the file `tests/queries/tests.py` and will now read its contents. I will start by reading the beginning of the file and will continue to read the remainder of the file in chunks if necessary.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/queries/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2221, 'candidates_token_count': 67, 'total_token_count': 2396, 'cached_content_token_count': 1468, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2221}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1468}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 67}], 'thoughts_token_count': 108}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2044787620430562, 'model_name': 'gemini-2.5-pro'} id='run--696bb6f7-c12a-44e0-86d4-d7c65a07aeb0-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/queries/tests.py'}, 'id': '5951ac90-355f-4546-8885-c76d34ab8dad', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2221, 'output_tokens': 67, 'total_tokens': 2396, 'input_token_details': {'cache_read': 1468}, 'output_token_details': {'reasoning': 108}}
2025-12-23 08:59:35,454 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the initial 500 lines of the file `tests/queries/tests.py` and have identified that there is more content to be read. I will now proceed to read the remaining portion of the file to ensure I have the complete context for my analysis.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "tests/queries/tests.py", "end_line": 5000.0, "start_line": 501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11303, 'candidates_token_count': 85, 'total_token_count': 11624, 'cached_content_token_count': 1837, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11303}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1837}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 85}], 'thoughts_token_count': 236}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5219946917365579, 'model_name': 'gemini-2.5-pro'} id='run--c232a206-cad7-45e1-a2a3-3ac89df518d1-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'tests/queries/tests.py', 'end_line': 5000.0, 'start_line': 501.0}, 'id': '24678ab3-cd86-4b83-8ecc-5135beab2a57', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11303, 'output_tokens': 85, 'total_tokens': 11624, 'input_token_details': {'cache_read': 1837}, 'output_token_details': {'reasoning': 236}}
2025-12-23 08:59:43,698 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `tests/queries/tests.py`. After analyzing the file, I found several test cases that are highly relevant to your query about `QuerySet.none()` on complex or combined querysets. The most pertinent tests are `test_ticket7235`, which verifies that an `EmptyQuerySet` does not raise exceptions when filtered, and `test_ticket7181`, which demonstrates the behavior of combining an empty queryset with a populated one using union and intersection operators. Additionally, the `EmptyQuerySetTests` class provides further examples of how `QuerySet.none()` interacts with other queryset methods like `values()` and `values_list()`.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 77834, 'candidates_token_count': 143, 'total_token_count': 78343, 'prompt_tokens_details': [{'modality': 1, 'token_count': 77834}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 143}], 'thoughts_token_count': 366, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3578879616477273, 'model_name': 'gemini-2.5-pro'} id='run--8fa4f5dd-373b-4f93-8802-c458392e9ff1-0' usage_metadata={'input_tokens': 77834, 'output_tokens': 143, 'total_tokens': 78343, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 366}}
2025-12-23 08:59:43,700 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of tests/queries/tests.py
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find test cases that cover the behavior of `QuerySet.none()` on complex or combined querysets to find the most relevant tests for the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/queries/tests.py
Line number range: 1 - 500
Content:
1. import datetime
2. import pickle
3. import sys
4. import unittest
5. from operator import attrgetter
6. from threading import Lock
7. 
8. from django.core.exceptions import EmptyResultSet, FieldError
9. from django.db import DEFAULT_DB_ALIAS, connection
10. from django.db.models import Count, Exists, F, OuterRef, Q
11. from django.db.models.expressions import RawSQL
12. from django.db.models.sql.constants import LOUTER
13. from django.db.models.sql.where import NothingNode, WhereNode
14. from django.test import SimpleTestCase, TestCase, skipUnlessDBFeature
15. from django.test.utils import CaptureQueriesContext, ignore_warnings
16. from django.utils.deprecation import RemovedInDjango40Warning
17. 
18. from .models import (
19.     FK1, Annotation, Article, Author, BaseA, Book, CategoryItem,
20.     CategoryRelationship, Celebrity, Channel, Chapter, Child, ChildObjectA,
21.     Classroom, CommonMixedCaseForeignKeys, Company, Cover, CustomPk,
22.     CustomPkTag, DateTimePK, Detail, DumbCategory, Eaten, Employment,
23.     ExtraInfo, Fan, Food, Identifier, Individual, Item, Job,
24.     JobResponsibilities, Join, LeafA, LeafB, LoopX, LoopZ, ManagedModel,
25.     Member, MixedCaseDbColumnCategoryItem, MixedCaseFieldCategoryItem, ModelA,
26.     ModelB, ModelC, ModelD, MyObject, NamedCategory, Node, Note, NullableName,
27.     Number, ObjectA, ObjectB, ObjectC, OneToOneCategory, Order, OrderItem,
28.     Page, Paragraph, Person, Plaything, PointerA, Program, ProxyCategory,
29.     ProxyObjectA, ProxyObjectB, Ranking, Related, RelatedIndividual,
30.     RelatedObject, Report, ReportComment, ReservedName, Responsibility, School,
31.     SharedConnection, SimpleCategory, SingleObject, SpecialCategory, Staff,
32.     StaffUser, Student, Tag, Task, Teacher, Ticket21203Child,
33.     Ticket21203Parent, Ticket23605A, Ticket23605B, Ticket23605C, TvChef, Valid,
34.     X,
35. )
36. 
37. 
38. class Queries1Tests(TestCase):
39.     @classmethod
40.     def setUpTestData(cls):
41.         generic = NamedCategory.objects.create(name="Generic")
42.         cls.t1 = Tag.objects.create(name='t1', category=generic)
43.         cls.t2 = Tag.objects.create(name='t2', parent=cls.t1, category=generic)
44.         cls.t3 = Tag.objects.create(name='t3', parent=cls.t1)
45.         t4 = Tag.objects.create(name='t4', parent=cls.t3)
46.         cls.t5 = Tag.objects.create(name='t5', parent=cls.t3)
47. 
48.         cls.n1 = Note.objects.create(note='n1', misc='foo', id=1)
49.         cls.n2 = Note.objects.create(note='n2', misc='bar', id=2)
50.         cls.n3 = Note.objects.create(note='n3', misc='foo', id=3)
51. 
52.         ann1 = Annotation.objects.create(name='a1', tag=cls.t1)
53.         ann1.notes.add(cls.n1)
54.         ann2 = Annotation.objects.create(name='a2', tag=t4)
55.         ann2.notes.add(cls.n2, cls.n3)
56. 
57.         # Create these out of order so that sorting by 'id' will be different to sorting
58.         # by 'info'. Helps detect some problems later.
59.         cls.e2 = ExtraInfo.objects.create(info='e2', note=cls.n2, value=41, filterable=False)
60.         e1 = ExtraInfo.objects.create(info='e1', note=cls.n1, value=42)
61. 
62.         cls.a1 = Author.objects.create(name='a1', num=1001, extra=e1)
63.         cls.a2 = Author.objects.create(name='a2', num=2002, extra=e1)
64.         cls.a3 = Author.objects.create(name='a3', num=3003, extra=cls.e2)
65.         cls.a4 = Author.objects.create(name='a4', num=4004, extra=cls.e2)
66. 
67.         cls.time1 = datetime.datetime(2007, 12, 19, 22, 25, 0)
68.         cls.time2 = datetime.datetime(2007, 12, 19, 21, 0, 0)
69.         time3 = datetime.datetime(2007, 12, 20, 22, 25, 0)
70.         time4 = datetime.datetime(2007, 12, 20, 21, 0, 0)
71.         cls.i1 = Item.objects.create(name='one', created=cls.time1, modified=cls.time1, creator=cls.a1, note=cls.n3)
72.         cls.i1.tags.set([cls.t1, cls.t2])
73.         cls.i2 = Item.objects.create(name='two', created=cls.time2, creator=cls.a2, note=cls.n2)
74.         cls.i2.tags.set([cls.t1, cls.t3])
75.         cls.i3 = Item.objects.create(name='three', created=time3, creator=cls.a2, note=cls.n3)
76.         i4 = Item.objects.create(name='four', created=time4, creator=cls.a4, note=cls.n3)
77.         i4.tags.set([t4])
78. 
79.         cls.r1 = Report.objects.create(name='r1', creator=cls.a1)
80.         Report.objects.create(name='r2', creator=cls.a3)
81.         Report.objects.create(name='r3')
82. 
83.         # Ordering by 'rank' gives us rank2, rank1, rank3. Ordering by the Meta.ordering
84.         # will be rank3, rank2, rank1.
85.         cls.rank1 = Ranking.objects.create(rank=2, author=cls.a2)
86. 
87.         Cover.objects.create(title="first", item=i4)
88.         Cover.objects.create(title="second", item=cls.i2)
89. 
90.     def test_subquery_condition(self):
91.         qs1 = Tag.objects.filter(pk__lte=0)
92.         qs2 = Tag.objects.filter(parent__in=qs1)
93.         qs3 = Tag.objects.filter(parent__in=qs2)
94.         self.assertEqual(qs3.query.subq_aliases, {'T', 'U', 'V'})
95.         self.assertIn('v0', str(qs3.query).lower())
96.         qs4 = qs3.filter(parent__in=qs1)
97.         self.assertEqual(qs4.query.subq_aliases, {'T', 'U', 'V'})
98.         # It is possible to reuse U for the second subquery, no need to use W.
99.         self.assertNotIn('w0', str(qs4.query).lower())
100.         # So, 'U0."id"' is referenced in SELECT and WHERE twice.
101.         self.assertEqual(str(qs4.query).lower().count('u0.'), 4)
102. 
103.     def test_ticket1050(self):
104.         self.assertQuerysetEqual(
105.             Item.objects.filter(tags__isnull=True),
106.             ['<Item: three>']
107.         )
108.         self.assertQuerysetEqual(
109.             Item.objects.filter(tags__id__isnull=True),
110.             ['<Item: three>']
111.         )
112. 
113.     def test_ticket1801(self):
114.         self.assertQuerysetEqual(
115.             Author.objects.filter(item=self.i2),
116.             ['<Author: a2>']
117.         )
118.         self.assertQuerysetEqual(
119.             Author.objects.filter(item=self.i3),
120.             ['<Author: a2>']
121.         )
122.         self.assertQuerysetEqual(
123.             Author.objects.filter(item=self.i2) & Author.objects.filter(item=self.i3),
124.             ['<Author: a2>']
125.         )
126. 
127.     def test_ticket2306(self):
128.         # Checking that no join types are "left outer" joins.
129.         query = Item.objects.filter(tags=self.t2).query
130.         self.assertNotIn(LOUTER, [x.join_type for x in query.alias_map.values()])
131. 
132.         self.assertQuerysetEqual(
133.             Item.objects.filter(Q(tags=self.t1)).order_by('name'),
134.             ['<Item: one>', '<Item: two>']
135.         )
136.         self.assertQuerysetEqual(
137.             Item.objects.filter(Q(tags=self.t1)).filter(Q(tags=self.t2)),
138.             ['<Item: one>']
139.         )
140.         self.assertQuerysetEqual(
141.             Item.objects.filter(Q(tags=self.t1)).filter(Q(creator__name='fred') | Q(tags=self.t2)),
142.             ['<Item: one>']
143.         )
144. 
145.         # Each filter call is processed "at once" against a single table, so this is
146.         # different from the previous example as it tries to find tags that are two
147.         # things at once (rather than two tags).
148.         self.assertQuerysetEqual(
149.             Item.objects.filter(Q(tags=self.t1) & Q(tags=self.t2)),
150.             []
151.         )
152.         self.assertQuerysetEqual(
153.             Item.objects.filter(Q(tags=self.t1), Q(creator__name='fred') | Q(tags=self.t2)),
154.             []
155.         )
156. 
157.         qs = Author.objects.filter(ranking__rank=2, ranking__id=self.rank1.id)
158.         self.assertQuerysetEqual(list(qs), ['<Author: a2>'])
159.         self.assertEqual(2, qs.query.count_active_tables(), 2)
160.         qs = Author.objects.filter(ranking__rank=2).filter(ranking__id=self.rank1.id)
161.         self.assertEqual(qs.query.count_active_tables(), 3)
162. 
163.     def test_ticket4464(self):
164.         self.assertQuerysetEqual(
165.             Item.objects.filter(tags=self.t1).filter(tags=self.t2),
166.             ['<Item: one>']
167.         )
168.         self.assertQuerysetEqual(
169.             Item.objects.filter(tags__in=[self.t1, self.t2]).distinct().order_by('name'),
170.             ['<Item: one>', '<Item: two>']
171.         )
172.         self.assertQuerysetEqual(
173.             Item.objects.filter(tags__in=[self.t1, self.t2]).filter(tags=self.t3),
174.             ['<Item: two>']
175.         )
176. 
177.         # Make sure .distinct() works with slicing (this was broken in Oracle).
178.         self.assertQuerysetEqual(
179.             Item.objects.filter(tags__in=[self.t1, self.t2]).order_by('name')[:3],
180.             ['<Item: one>', '<Item: one>', '<Item: two>']
181.         )
182.         self.assertQuerysetEqual(
183.             Item.objects.filter(tags__in=[self.t1, self.t2]).distinct().order_by('name')[:3],
184.             ['<Item: one>', '<Item: two>']
185.         )
186. 
187.     def test_tickets_2080_3592(self):
188.         self.assertQuerysetEqual(
189.             Author.objects.filter(item__name='one') | Author.objects.filter(name='a3'),
190.             ['<Author: a1>', '<Author: a3>']
191.         )
192.         self.assertQuerysetEqual(
193.             Author.objects.filter(Q(item__name='one') | Q(name='a3')),
194.             ['<Author: a1>', '<Author: a3>']
195.         )
196.         self.assertQuerysetEqual(
197.             Author.objects.filter(Q(name='a3') | Q(item__name='one')),
198.             ['<Author: a1>', '<Author: a3>']
199.         )
200.         self.assertQuerysetEqual(
201.             Author.objects.filter(Q(item__name='three') | Q(report__name='r3')),
202.             ['<Author: a2>']
203.         )
204. 
205.     def test_ticket6074(self):
206.         # Merging two empty result sets shouldn't leave a queryset with no constraints
207.         # (which would match everything).
208.         self.assertQuerysetEqual(Author.objects.filter(Q(id__in=[])), [])
209.         self.assertQuerysetEqual(
210.             Author.objects.filter(Q(id__in=[]) | Q(id__in=[])),
211.             []
212.         )
213. 
214.     def test_tickets_1878_2939(self):
215.         self.assertEqual(Item.objects.values('creator').distinct().count(), 3)
216. 
217.         # Create something with a duplicate 'name' so that we can test multi-column
218.         # cases (which require some tricky SQL transformations under the covers).
219.         xx = Item(name='four', created=self.time1, creator=self.a2, note=self.n1)
220.         xx.save()
221.         self.assertEqual(
222.             Item.objects.exclude(name='two').values('creator', 'name').distinct().count(),
223.             4
224.         )
225.         self.assertEqual(
226.             (
227.                 Item.objects
228.                 .exclude(name='two')
229.                 .extra(select={'foo': '%s'}, select_params=(1,))
230.                 .values('creator', 'name', 'foo')
231.                 .distinct()
232.                 .count()
233.             ),
234.             4
235.         )
236.         self.assertEqual(
237.             (
238.                 Item.objects
239.                 .exclude(name='two')
240.                 .extra(select={'foo': '%s'}, select_params=(1,))
241.                 .values('creator', 'name')
242.                 .distinct()
243.                 .count()
244.             ),
245.             4
246.         )
247.         xx.delete()
248. 
249.     def test_ticket7323(self):
250.         self.assertEqual(Item.objects.values('creator', 'name').count(), 4)
251. 
252.     def test_ticket2253(self):
253.         q1 = Item.objects.order_by('name')
254.         q2 = Item.objects.filter(id=self.i1.id)
255.         self.assertQuerysetEqual(
256.             q1,
257.             ['<Item: four>', '<Item: one>', '<Item: three>', '<Item: two>']
258.         )
259.         self.assertQuerysetEqual(q2, ['<Item: one>'])
260.         self.assertQuerysetEqual(
261.             (q1 | q2).order_by('name'),
262.             ['<Item: four>', '<Item: one>', '<Item: three>', '<Item: two>']
263.         )
264.         self.assertQuerysetEqual((q1 & q2).order_by('name'), ['<Item: one>'])
265. 
266.         q1 = Item.objects.filter(tags=self.t1)
267.         q2 = Item.objects.filter(note=self.n3, tags=self.t2)
268.         q3 = Item.objects.filter(creator=self.a4)
269.         self.assertQuerysetEqual(
270.             ((q1 & q2) | q3).order_by('name'),
271.             ['<Item: four>', '<Item: one>']
272.         )
273. 
274.     def test_order_by_tables(self):
275.         q1 = Item.objects.order_by('name')
276.         q2 = Item.objects.filter(id=self.i1.id)
277.         list(q2)
278.         combined_query = (q1 & q2).order_by('name').query
279.         self.assertEqual(len([
280.             t for t in combined_query.alias_map if combined_query.alias_refcount[t]
281.         ]), 1)
282. 
283.     def test_order_by_join_unref(self):
284.         """
285.         This test is related to the above one, testing that there aren't
286.         old JOINs in the query.
287.         """
288.         qs = Celebrity.objects.order_by('greatest_fan__fan_of')
289.         self.assertIn('OUTER JOIN', str(qs.query))
290.         qs = qs.order_by('id')
291.         self.assertNotIn('OUTER JOIN', str(qs.query))
292. 
293.     def test_get_clears_ordering(self):
294.         """
295.         get() should clear ordering for optimization purposes.
296.         """
297.         with CaptureQueriesContext(connection) as captured_queries:
298.             Author.objects.order_by('name').get(pk=self.a1.pk)
299.         self.assertNotIn('order by', captured_queries[0]['sql'].lower())
300. 
301.     def test_tickets_4088_4306(self):
302.         self.assertQuerysetEqual(
303.             Report.objects.filter(creator=1001),
304.             ['<Report: r1>']
305.         )
306.         self.assertQuerysetEqual(
307.             Report.objects.filter(creator__num=1001),
308.             ['<Report: r1>']
309.         )
310.         self.assertQuerysetEqual(Report.objects.filter(creator__id=1001), [])
311.         self.assertQuerysetEqual(
312.             Report.objects.filter(creator__id=self.a1.id),
313.             ['<Report: r1>']
314.         )
315.         self.assertQuerysetEqual(
316.             Report.objects.filter(creator__name='a1'),
317.             ['<Report: r1>']
318.         )
319. 
320.     def test_ticket4510(self):
321.         self.assertQuerysetEqual(
322.             Author.objects.filter(report__name='r1'),
323.             ['<Author: a1>']
324.         )
325. 
326.     def test_ticket7378(self):
327.         self.assertQuerysetEqual(self.a1.report_set.all(), ['<Report: r1>'])
328. 
329.     def test_tickets_5324_6704(self):
330.         self.assertQuerysetEqual(
331.             Item.objects.filter(tags__name='t4'),
332.             ['<Item: four>']
333.         )
334.         self.assertQuerysetEqual(
335.             Item.objects.exclude(tags__name='t4').order_by('name').distinct(),
336.             ['<Item: one>', '<Item: three>', '<Item: two>']
337.         )
338.         self.assertQuerysetEqual(
339.             Item.objects.exclude(tags__name='t4').order_by('name').distinct().reverse(),
340.             ['<Item: two>', '<Item: three>', '<Item: one>']
341.         )
342.         self.assertQuerysetEqual(
343.             Author.objects.exclude(item__name='one').distinct().order_by('name'),
344.             ['<Author: a2>', '<Author: a3>', '<Author: a4>']
345.         )
346. 
347.         # Excluding across a m2m relation when there is more than one related
348.         # object associated was problematic.
349.         self.assertQuerysetEqual(
350.             Item.objects.exclude(tags__name='t1').order_by('name'),
351.             ['<Item: four>', '<Item: three>']
352.         )
353.         self.assertQuerysetEqual(
354.             Item.objects.exclude(tags__name='t1').exclude(tags__name='t4'),
355.             ['<Item: three>']
356.         )
357. 
358.         # Excluding from a relation that cannot be NULL should not use outer joins.
359.         query = Item.objects.exclude(creator__in=[self.a1, self.a2]).query
360.         self.assertNotIn(LOUTER, [x.join_type for x in query.alias_map.values()])
361. 
362.         # Similarly, when one of the joins cannot possibly, ever, involve NULL
363.         # values (Author -> ExtraInfo, in the following), it should never be
364.         # promoted to a left outer join. So the following query should only
365.         # involve one "left outer" join (Author -> Item is 0-to-many).
366.         qs = Author.objects.filter(id=self.a1.id).filter(Q(extra__note=self.n1) | Q(item__note=self.n3))
367.         self.assertEqual(
368.             len([
369.                 x for x in qs.query.alias_map.values()
370.                 if x.join_type == LOUTER and qs.query.alias_refcount[x.table_alias]
371.             ]),
372.             1
373.         )
374. 
375.         # The previous changes shouldn't affect nullable foreign key joins.
376.         self.assertQuerysetEqual(
377.             Tag.objects.filter(parent__isnull=True).order_by('name'),
378.             ['<Tag: t1>']
379.         )
380.         self.assertQuerysetEqual(
381.             Tag.objects.exclude(parent__isnull=True).order_by('name'),
382.             ['<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
383.         )
384.         self.assertQuerysetEqual(
385.             Tag.objects.exclude(Q(parent__name='t1') | Q(parent__isnull=True)).order_by('name'),
386.             ['<Tag: t4>', '<Tag: t5>']
387.         )
388.         self.assertQuerysetEqual(
389.             Tag.objects.exclude(Q(parent__isnull=True) | Q(parent__name='t1')).order_by('name'),
390.             ['<Tag: t4>', '<Tag: t5>']
391.         )
392.         self.assertQuerysetEqual(
393.             Tag.objects.exclude(Q(parent__parent__isnull=True)).order_by('name'),
394.             ['<Tag: t4>', '<Tag: t5>']
395.         )
396.         self.assertQuerysetEqual(
397.             Tag.objects.filter(~Q(parent__parent__isnull=True)).order_by('name'),
398.             ['<Tag: t4>', '<Tag: t5>']
399.         )
400. 
401.     def test_ticket2091(self):
402.         t = Tag.objects.get(name='t4')
403.         self.assertQuerysetEqual(
404.             Item.objects.filter(tags__in=[t]),
405.             ['<Item: four>']
406.         )
407. 
408.     def test_avoid_infinite_loop_on_too_many_subqueries(self):
409.         x = Tag.objects.filter(pk=1)
410.         local_recursion_limit = sys.getrecursionlimit() // 16
411.         msg = 'Maximum recursion depth exceeded: too many subqueries.'
412.         with self.assertRaisesMessage(RecursionError, msg):
413.             for i in range(local_recursion_limit + 2):
414.                 x = Tag.objects.filter(pk__in=x)
415. 
416.     def test_reasonable_number_of_subq_aliases(self):
417.         x = Tag.objects.filter(pk=1)
418.         for _ in range(20):
419.             x = Tag.objects.filter(pk__in=x)
420.         self.assertEqual(
421.             x.query.subq_aliases, {
422.                 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'AA', 'AB', 'AC', 'AD',
423.                 'AE', 'AF', 'AG', 'AH', 'AI', 'AJ', 'AK', 'AL', 'AM', 'AN',
424.             }
425.         )
426. 
427.     def test_heterogeneous_qs_combination(self):
428.         # Combining querysets built on different models should behave in a well-defined
429.         # fashion. We raise an error.
430.         with self.assertRaisesMessage(AssertionError, 'Cannot combine queries on two different base models.'):
431.             Author.objects.all() & Tag.objects.all()
432.         with self.assertRaisesMessage(AssertionError, 'Cannot combine queries on two different base models.'):
433.             Author.objects.all() | Tag.objects.all()
434. 
435.     def test_ticket3141(self):
436.         self.assertEqual(Author.objects.extra(select={'foo': '1'}).count(), 4)
437.         self.assertEqual(
438.             Author.objects.extra(select={'foo': '%s'}, select_params=(1,)).count(),
439.             4
440.         )
441. 
442.     def test_ticket2400(self):
443.         self.assertQuerysetEqual(
444.             Author.objects.filter(item__isnull=True),
445.             ['<Author: a3>']
446.         )
447.         self.assertQuerysetEqual(
448.             Tag.objects.filter(item__isnull=True),
449.             ['<Tag: t5>']
450.         )
451. 
452.     def test_ticket2496(self):
453.         self.assertQuerysetEqual(
454.             Item.objects.extra(tables=['queries_author']).select_related().order_by('name')[:1],
455.             ['<Item: four>']
456.         )
457. 
458.     def test_error_raised_on_filter_with_dictionary(self):
459.         with self.assertRaisesMessage(FieldError, 'Cannot parse keyword query as dict'):
460.             Note.objects.filter({'note': 'n1', 'misc': 'foo'})
461. 
462.     def test_tickets_2076_7256(self):
463.         # Ordering on related tables should be possible, even if the table is
464.         # not otherwise involved.
465.         self.assertQuerysetEqual(
466.             Item.objects.order_by('note__note', 'name'),
467.             ['<Item: two>', '<Item: four>', '<Item: one>', '<Item: three>']
468.         )
469. 
470.         # Ordering on a related field should use the remote model's default
471.         # ordering as a final step.
472.         self.assertQuerysetEqual(
473.             Author.objects.order_by('extra', '-name'),
474.             ['<Author: a2>', '<Author: a1>', '<Author: a4>', '<Author: a3>']
475.         )
476. 
477.         # Using remote model default ordering can span multiple models (in this
478.         # case, Cover is ordered by Item's default, which uses Note's default).
479.         self.assertQuerysetEqual(
480.             Cover.objects.all(),
481.             ['<Cover: first>', '<Cover: second>']
482.         )
483. 
484.         # If the remote model does not have a default ordering, we order by its 'id'
485.         # field.
486.         self.assertQuerysetEqual(
487.             Item.objects.order_by('creator', 'name'),
488.             ['<Item: one>', '<Item: three>', '<Item: two>', '<Item: four>']
489.         )
490. 
491.         # Ordering by a many-valued attribute (e.g. a many-to-many or reverse
492.         # ForeignKey) is legal, but the results might not make sense. That
493.         # isn't Django's problem. Garbage in, garbage out.
494.         self.assertQuerysetEqual(
495.             Item.objects.filter(tags__isnull=False).order_by('tags', 'id'),
496.             ['<Item: one>', '<Item: two>', '<Item: one>', '<Item: two>', '<Item: four>']
497.         )
498. 
499.         # If we replace the default ordering, Django adjusts the required
500.         # tables automatically. Item normally requires a join with Note to do


File: tests/queries/tests.py
Line number range: 501 - 5000
Content:
501.         # the default ordering, but that isn't needed here.
502.         qs = Item.objects.order_by('name')
503.         self.assertQuerysetEqual(
504.             qs,
505.             ['<Item: four>', '<Item: one>', '<Item: three>', '<Item: two>']
506.         )
507.         self.assertEqual(len(qs.query.alias_map), 1)
508. 
509.     def test_tickets_2874_3002(self):
510.         qs = Item.objects.select_related().order_by('note__note', 'name')
511.         self.assertQuerysetEqual(
512.             qs,
513.             ['<Item: two>', '<Item: four>', '<Item: one>', '<Item: three>']
514.         )
515. 
516.         # This is also a good select_related() test because there are multiple
517.         # Note entries in the SQL. The two Note items should be different.
518.         self.assertEqual(repr(qs[0].note), '<Note: n2>')
519.         self.assertEqual(repr(qs[0].creator.extra.note), '<Note: n1>')
520. 
521.     def test_ticket3037(self):
522.         self.assertQuerysetEqual(
523.             Item.objects.filter(Q(creator__name='a3', name='two') | Q(creator__name='a4', name='four')),
524.             ['<Item: four>']
525.         )
526. 
527.     def test_tickets_5321_7070(self):
528.         # Ordering columns must be included in the output columns. Note that
529.         # this means results that might otherwise be distinct are not (if there
530.         # are multiple values in the ordering cols), as in this example. This
531.         # isn't a bug; it's a warning to be careful with the selection of
532.         # ordering columns.
533.         self.assertSequenceEqual(
534.             Note.objects.values('misc').distinct().order_by('note', '-misc'),
535.             [{'misc': 'foo'}, {'misc': 'bar'}, {'misc': 'foo'}]
536.         )
537. 
538.     def test_ticket4358(self):
539.         # If you don't pass any fields to values(), relation fields are
540.         # returned as "foo_id" keys, not "foo". For consistency, you should be
541.         # able to pass "foo_id" in the fields list and have it work, too. We
542.         # actually allow both "foo" and "foo_id".
543.         # The *_id version is returned by default.
544.         self.assertIn('note_id', ExtraInfo.objects.values()[0])
545.         # You can also pass it in explicitly.
546.         self.assertSequenceEqual(ExtraInfo.objects.values('note_id'), [{'note_id': 1}, {'note_id': 2}])
547.         # ...or use the field name.
548.         self.assertSequenceEqual(ExtraInfo.objects.values('note'), [{'note': 1}, {'note': 2}])
549. 
550.     def test_ticket6154(self):
551.         # Multiple filter statements are joined using "AND" all the time.
552. 
553.         self.assertQuerysetEqual(
554.             Author.objects.filter(id=self.a1.id).filter(Q(extra__note=self.n1) | Q(item__note=self.n3)),
555.             ['<Author: a1>']
556.         )
557.         self.assertQuerysetEqual(
558.             Author.objects.filter(Q(extra__note=self.n1) | Q(item__note=self.n3)).filter(id=self.a1.id),
559.             ['<Author: a1>']
560.         )
561. 
562.     def test_ticket6981(self):
563.         self.assertQuerysetEqual(
564.             Tag.objects.select_related('parent').order_by('name'),
565.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
566.         )
567. 
568.     def test_ticket9926(self):
569.         self.assertQuerysetEqual(
570.             Tag.objects.select_related("parent", "category").order_by('name'),
571.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
572.         )
573.         self.assertQuerysetEqual(
574.             Tag.objects.select_related('parent', "parent__category").order_by('name'),
575.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
576.         )
577. 
578.     def test_tickets_6180_6203(self):
579.         # Dates with limits and/or counts
580.         self.assertEqual(Item.objects.count(), 4)
581.         self.assertEqual(Item.objects.datetimes('created', 'month').count(), 1)
582.         self.assertEqual(Item.objects.datetimes('created', 'day').count(), 2)
583.         self.assertEqual(len(Item.objects.datetimes('created', 'day')), 2)
584.         self.assertEqual(Item.objects.datetimes('created', 'day')[0], datetime.datetime(2007, 12, 19, 0, 0))
585. 
586.     def test_tickets_7087_12242(self):
587.         # Dates with extra select columns
588.         self.assertQuerysetEqual(
589.             Item.objects.datetimes('created', 'day').extra(select={'a': 1}),
590.             ['datetime.datetime(2007, 12, 19, 0, 0)', 'datetime.datetime(2007, 12, 20, 0, 0)']
591.         )
592.         self.assertQuerysetEqual(
593.             Item.objects.extra(select={'a': 1}).datetimes('created', 'day'),
594.             ['datetime.datetime(2007, 12, 19, 0, 0)', 'datetime.datetime(2007, 12, 20, 0, 0)']
595.         )
596. 
597.         name = "one"
598.         self.assertQuerysetEqual(
599.             Item.objects.datetimes('created', 'day').extra(where=['name=%s'], params=[name]),
600.             ['datetime.datetime(2007, 12, 19, 0, 0)']
601.         )
602. 
603.         self.assertQuerysetEqual(
604.             Item.objects.extra(where=['name=%s'], params=[name]).datetimes('created', 'day'),
605.             ['datetime.datetime(2007, 12, 19, 0, 0)']
606.         )
607. 
608.     def test_ticket7155(self):
609.         # Nullable dates
610.         self.assertQuerysetEqual(
611.             Item.objects.datetimes('modified', 'day'),
612.             ['datetime.datetime(2007, 12, 19, 0, 0)']
613.         )
614. 
615.     @ignore_warnings(category=RemovedInDjango40Warning)
616.     def test_ticket7098(self):
617.         self.assertSequenceEqual(
618.             Item.objects.values('note__note').order_by('queries_note.note', 'id'),
619.             [{'note__note': 'n2'}, {'note__note': 'n3'}, {'note__note': 'n3'}, {'note__note': 'n3'}]
620.         )
621. 
622.     def test_order_by_rawsql(self):
623.         self.assertSequenceEqual(
624.             Item.objects.values('note__note').order_by(
625.                 RawSQL('queries_note.note', ()),
626.                 'id',
627.             ),
628.             [
629.                 {'note__note': 'n2'},
630.                 {'note__note': 'n3'},
631.                 {'note__note': 'n3'},
632.                 {'note__note': 'n3'},
633.             ],
634.         )
635. 
636.     def test_order_by_raw_column_alias_warning(self):
637.         msg = (
638.             "Passing column raw column aliases to order_by() is deprecated. "
639.             "Wrap 'queries_author.name' in a RawSQL expression before "
640.             "passing it to order_by()."
641.         )
642.         with self.assertRaisesMessage(RemovedInDjango40Warning, msg):
643.             Item.objects.values('creator__name').order_by('queries_author.name')
644. 
645.     def test_ticket7096(self):
646.         # Make sure exclude() with multiple conditions continues to work.
647.         self.assertQuerysetEqual(
648.             Tag.objects.filter(parent=self.t1, name='t3').order_by('name'),
649.             ['<Tag: t3>']
650.         )
651.         self.assertQuerysetEqual(
652.             Tag.objects.exclude(parent=self.t1, name='t3').order_by('name'),
653.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t4>', '<Tag: t5>']
654.         )
655.         self.assertQuerysetEqual(
656.             Item.objects.exclude(tags__name='t1', name='one').order_by('name').distinct(),
657.             ['<Item: four>', '<Item: three>', '<Item: two>']
658.         )
659.         self.assertQuerysetEqual(
660.             Item.objects.filter(name__in=['three', 'four']).exclude(tags__name='t1').order_by('name'),
661.             ['<Item: four>', '<Item: three>']
662.         )
663. 
664.         # More twisted cases, involving nested negations.
665.         self.assertQuerysetEqual(
666.             Item.objects.exclude(~Q(tags__name='t1', name='one')),
667.             ['<Item: one>']
668.         )
669.         self.assertQuerysetEqual(
670.             Item.objects.filter(~Q(tags__name='t1', name='one'), name='two'),
671.             ['<Item: two>']
672.         )
673.         self.assertQuerysetEqual(
674.             Item.objects.exclude(~Q(tags__name='t1', name='one'), name='two'),
675.             ['<Item: four>', '<Item: one>', '<Item: three>']
676.         )
677. 
678.     def test_tickets_7204_7506(self):
679.         # Make sure querysets with related fields can be pickled. If this
680.         # doesn't crash, it's a Good Thing.
681.         pickle.dumps(Item.objects.all())
682. 
683.     def test_ticket7813(self):
684.         # We should also be able to pickle things that use select_related().
685.         # The only tricky thing here is to ensure that we do the related
686.         # selections properly after unpickling.
687.         qs = Item.objects.select_related()
688.         query = qs.query.get_compiler(qs.db).as_sql()[0]
689.         query2 = pickle.loads(pickle.dumps(qs.query))
690.         self.assertEqual(
691.             query2.get_compiler(qs.db).as_sql()[0],
692.             query
693.         )
694. 
695.     def test_deferred_load_qs_pickling(self):
696.         # Check pickling of deferred-loading querysets
697.         qs = Item.objects.defer('name', 'creator')
698.         q2 = pickle.loads(pickle.dumps(qs))
699.         self.assertEqual(list(qs), list(q2))
700.         q3 = pickle.loads(pickle.dumps(qs, pickle.HIGHEST_PROTOCOL))
701.         self.assertEqual(list(qs), list(q3))
702. 
703.     def test_ticket7277(self):
704.         self.assertQuerysetEqual(
705.             self.n1.annotation_set.filter(
706.                 Q(tag=self.t5) | Q(tag__children=self.t5) | Q(tag__children__children=self.t5)
707.             ),
708.             ['<Annotation: a1>']
709.         )
710. 
711.     def test_tickets_7448_7707(self):
712.         # Complex objects should be converted to strings before being used in
713.         # lookups.
714.         self.assertQuerysetEqual(
715.             Item.objects.filter(created__in=[self.time1, self.time2]),
716.             ['<Item: one>', '<Item: two>']
717.         )
718. 
719.     def test_ticket7235(self):
720.         # An EmptyQuerySet should not raise exceptions if it is filtered.
721.         Eaten.objects.create(meal='m')
722.         q = Eaten.objects.none()
723.         with self.assertNumQueries(0):
724.             self.assertQuerysetEqual(q.all(), [])
725.             self.assertQuerysetEqual(q.filter(meal='m'), [])
726.             self.assertQuerysetEqual(q.exclude(meal='m'), [])
727.             self.assertQuerysetEqual(q.complex_filter({'pk': 1}), [])
728.             self.assertQuerysetEqual(q.select_related('food'), [])
729.             self.assertQuerysetEqual(q.annotate(Count('food')), [])
730.             self.assertQuerysetEqual(q.order_by('meal', 'food'), [])
731.             self.assertQuerysetEqual(q.distinct(), [])
732.             self.assertQuerysetEqual(
733.                 q.extra(select={'foo': "1"}),
734.                 []
735.             )
736.             self.assertQuerysetEqual(q.reverse(), [])
737.             q.query.low_mark = 1
738.             with self.assertRaisesMessage(AssertionError, 'Cannot change a query once a slice has been taken'):
739.                 q.extra(select={'foo': "1"})
740.             self.assertQuerysetEqual(q.defer('meal'), [])
741.             self.assertQuerysetEqual(q.only('meal'), [])
742. 
743.     def test_ticket7791(self):
744.         # There were "issues" when ordering and distinct-ing on fields related
745.         # via ForeignKeys.
746.         self.assertEqual(
747.             len(Note.objects.order_by('extrainfo__info').distinct()),
748.             3
749.         )
750. 
751.         # Pickling of QuerySets using datetimes() should work.
752.         qs = Item.objects.datetimes('created', 'month')
753.         pickle.loads(pickle.dumps(qs))
754. 
755.     def test_ticket9997(self):
756.         # If a ValuesList or Values queryset is passed as an inner query, we
757.         # make sure it's only requesting a single value and use that as the
758.         # thing to select.
759.         self.assertQuerysetEqual(
760.             Tag.objects.filter(name__in=Tag.objects.filter(parent=self.t1).values('name')),
761.             ['<Tag: t2>', '<Tag: t3>']
762.         )
763. 
764.         # Multi-valued values() and values_list() querysets should raise errors.
765.         with self.assertRaisesMessage(TypeError, 'Cannot use multi-field values as a filter value.'):
766.             Tag.objects.filter(name__in=Tag.objects.filter(parent=self.t1).values('name', 'id'))
767.         with self.assertRaisesMessage(TypeError, 'Cannot use multi-field values as a filter value.'):
768.             Tag.objects.filter(name__in=Tag.objects.filter(parent=self.t1).values_list('name', 'id'))
769. 
770.     def test_ticket9985(self):
771.         # qs.values_list(...).values(...) combinations should work.
772.         self.assertSequenceEqual(
773.             Note.objects.values_list("note", flat=True).values("id").order_by("id"),
774.             [{'id': 1}, {'id': 2}, {'id': 3}]
775.         )
776.         self.assertQuerysetEqual(
777.             Annotation.objects.filter(notes__in=Note.objects.filter(note="n1").values_list('note').values('id')),
778.             ['<Annotation: a1>']
779.         )
780. 
781.     def test_ticket10205(self):
782.         # When bailing out early because of an empty "__in" filter, we need
783.         # to set things up correctly internally so that subqueries can continue properly.
784.         self.assertEqual(Tag.objects.filter(name__in=()).update(name="foo"), 0)
785. 
786.     def test_ticket10432(self):
787.         # Testing an empty "__in" filter with a generator as the value.
788.         def f():
789.             return iter([])
790.         n_obj = Note.objects.all()[0]
791. 
792.         def g():
793.             yield n_obj.pk
794.         self.assertQuerysetEqual(Note.objects.filter(pk__in=f()), [])
795.         self.assertEqual(list(Note.objects.filter(pk__in=g())), [n_obj])
796. 
797.     def test_ticket10742(self):
798.         # Queries used in an __in clause don't execute subqueries
799. 
800.         subq = Author.objects.filter(num__lt=3000)
801.         qs = Author.objects.filter(pk__in=subq)
802.         self.assertQuerysetEqual(qs, ['<Author: a1>', '<Author: a2>'])
803. 
804.         # The subquery result cache should not be populated
805.         self.assertIsNone(subq._result_cache)
806. 
807.         subq = Author.objects.filter(num__lt=3000)
808.         qs = Author.objects.exclude(pk__in=subq)
809.         self.assertQuerysetEqual(qs, ['<Author: a3>', '<Author: a4>'])
810. 
811.         # The subquery result cache should not be populated
812.         self.assertIsNone(subq._result_cache)
813. 
814.         subq = Author.objects.filter(num__lt=3000)
815.         self.assertQuerysetEqual(
816.             Author.objects.filter(Q(pk__in=subq) & Q(name='a1')),
817.             ['<Author: a1>']
818.         )
819. 
820.         # The subquery result cache should not be populated
821.         self.assertIsNone(subq._result_cache)
822. 
823.     def test_ticket7076(self):
824.         # Excluding shouldn't eliminate NULL entries.
825.         self.assertQuerysetEqual(
826.             Item.objects.exclude(modified=self.time1).order_by('name'),
827.             ['<Item: four>', '<Item: three>', '<Item: two>']
828.         )
829.         self.assertQuerysetEqual(
830.             Tag.objects.exclude(parent__name=self.t1.name),
831.             ['<Tag: t1>', '<Tag: t4>', '<Tag: t5>']
832.         )
833. 
834.     def test_ticket7181(self):
835.         # Ordering by related tables should accommodate nullable fields (this
836.         # test is a little tricky, since NULL ordering is database dependent.
837.         # Instead, we just count the number of results).
838.         self.assertEqual(len(Tag.objects.order_by('parent__name')), 5)
839. 
840.         # Empty querysets can be merged with others.
841.         self.assertQuerysetEqual(
842.             Note.objects.none() | Note.objects.all(),
843.             ['<Note: n1>', '<Note: n2>', '<Note: n3>']
844.         )
845.         self.assertQuerysetEqual(
846.             Note.objects.all() | Note.objects.none(),
847.             ['<Note: n1>', '<Note: n2>', '<Note: n3>']
848.         )
849.         self.assertQuerysetEqual(Note.objects.none() & Note.objects.all(), [])
850.         self.assertQuerysetEqual(Note.objects.all() & Note.objects.none(), [])
851. 
852.     def test_ticket9411(self):
853.         # Make sure bump_prefix() (an internal Query method) doesn't (re-)break. It's
854.         # sufficient that this query runs without error.
855.         qs = Tag.objects.values_list('id', flat=True).order_by('id')
856.         qs.query.bump_prefix(qs.query)
857.         first = qs[0]
858.         self.assertEqual(list(qs), list(range(first, first + 5)))
859. 
860.     def test_ticket8439(self):
861.         # Complex combinations of conjunctions, disjunctions and nullable
862.         # relations.
863.         self.assertQuerysetEqual(
864.             Author.objects.filter(Q(item__note__extrainfo=self.e2) | Q(report=self.r1, name='xyz')),
865.             ['<Author: a2>']
866.         )
867.         self.assertQuerysetEqual(
868.             Author.objects.filter(Q(report=self.r1, name='xyz') | Q(item__note__extrainfo=self.e2)),
869.             ['<Author: a2>']
870.         )
871.         self.assertQuerysetEqual(
872.             Annotation.objects.filter(Q(tag__parent=self.t1) | Q(notes__note='n1', name='a1')),
873.             ['<Annotation: a1>']
874.         )
875.         xx = ExtraInfo.objects.create(info='xx', note=self.n3)
876.         self.assertQuerysetEqual(
877.             Note.objects.filter(Q(extrainfo__author=self.a1) | Q(extrainfo=xx)),
878.             ['<Note: n1>', '<Note: n3>']
879.         )
880.         q = Note.objects.filter(Q(extrainfo__author=self.a1) | Q(extrainfo=xx)).query
881.         self.assertEqual(
882.             len([x for x in q.alias_map.values() if x.join_type == LOUTER and q.alias_refcount[x.table_alias]]),
883.             1
884.         )
885. 
886.     def test_ticket17429(self):
887.         """
888.         Meta.ordering=None works the same as Meta.ordering=[]
889.         """
890.         original_ordering = Tag._meta.ordering
891.         Tag._meta.ordering = None
892.         try:
893.             self.assertQuerysetEqual(
894.                 Tag.objects.all(),
895.                 ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
896.                 ordered=False
897.             )
898.         finally:
899.             Tag._meta.ordering = original_ordering
900. 
901.     def test_exclude(self):
902.         self.assertQuerysetEqual(
903.             Item.objects.exclude(tags__name='t4'),
904.             [repr(i) for i in Item.objects.filter(~Q(tags__name='t4'))])
905.         self.assertQuerysetEqual(
906.             Item.objects.exclude(Q(tags__name='t4') | Q(tags__name='t3')),
907.             [repr(i) for i in Item.objects.filter(~(Q(tags__name='t4') | Q(tags__name='t3')))])
908.         self.assertQuerysetEqual(
909.             Item.objects.exclude(Q(tags__name='t4') | ~Q(tags__name='t3')),
910.             [repr(i) for i in Item.objects.filter(~(Q(tags__name='t4') | ~Q(tags__name='t3')))])
911. 
912.     def test_nested_exclude(self):
913.         self.assertQuerysetEqual(
914.             Item.objects.exclude(~Q(tags__name='t4')),
915.             [repr(i) for i in Item.objects.filter(~~Q(tags__name='t4'))])
916. 
917.     def test_double_exclude(self):
918.         self.assertQuerysetEqual(
919.             Item.objects.filter(Q(tags__name='t4')),
920.             [repr(i) for i in Item.objects.filter(~~Q(tags__name='t4'))])
921.         self.assertQuerysetEqual(
922.             Item.objects.filter(Q(tags__name='t4')),
923.             [repr(i) for i in Item.objects.filter(~Q(~Q(tags__name='t4')))])
924. 
925.     def test_exclude_in(self):
926.         self.assertQuerysetEqual(
927.             Item.objects.exclude(Q(tags__name__in=['t4', 't3'])),
928.             [repr(i) for i in Item.objects.filter(~Q(tags__name__in=['t4', 't3']))])
929.         self.assertQuerysetEqual(
930.             Item.objects.filter(Q(tags__name__in=['t4', 't3'])),
931.             [repr(i) for i in Item.objects.filter(~~Q(tags__name__in=['t4', 't3']))])
932. 
933.     def test_ticket_10790_1(self):
934.         # Querying direct fields with isnull should trim the left outer join.
935.         # It also should not create INNER JOIN.
936.         q = Tag.objects.filter(parent__isnull=True)
937. 
938.         self.assertQuerysetEqual(q, ['<Tag: t1>'])
939.         self.assertNotIn('JOIN', str(q.query))
940. 
941.         q = Tag.objects.filter(parent__isnull=False)
942. 
943.         self.assertQuerysetEqual(
944.             q,
945.             ['<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
946.         )
947.         self.assertNotIn('JOIN', str(q.query))
948. 
949.         q = Tag.objects.exclude(parent__isnull=True)
950.         self.assertQuerysetEqual(
951.             q,
952.             ['<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
953.         )
954.         self.assertNotIn('JOIN', str(q.query))
955. 
956.         q = Tag.objects.exclude(parent__isnull=False)
957.         self.assertQuerysetEqual(q, ['<Tag: t1>'])
958.         self.assertNotIn('JOIN', str(q.query))
959. 
960.         q = Tag.objects.exclude(parent__parent__isnull=False)
961. 
962.         self.assertQuerysetEqual(
963.             q,
964.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>'],
965.         )
966.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
967.         self.assertNotIn('INNER JOIN', str(q.query))
968. 
969.     def test_ticket_10790_2(self):
970.         # Querying across several tables should strip only the last outer join,
971.         # while preserving the preceding inner joins.
972.         q = Tag.objects.filter(parent__parent__isnull=False)
973. 
974.         self.assertQuerysetEqual(
975.             q,
976.             ['<Tag: t4>', '<Tag: t5>'],
977.         )
978.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
979.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
980. 
981.         # Querying without isnull should not convert anything to left outer join.
982.         q = Tag.objects.filter(parent__parent=self.t1)
983.         self.assertQuerysetEqual(
984.             q,
985.             ['<Tag: t4>', '<Tag: t5>'],
986.         )
987.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
988.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
989. 
990.     def test_ticket_10790_3(self):
991.         # Querying via indirect fields should populate the left outer join
992.         q = NamedCategory.objects.filter(tag__isnull=True)
993.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
994.         # join to dumbcategory ptr_id
995.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
996.         self.assertQuerysetEqual(q, [])
997. 
998.         # Querying across several tables should strip only the last join, while
999.         # preserving the preceding left outer joins.
1000.         q = NamedCategory.objects.filter(tag__parent__isnull=True)
1001.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
1002.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
1003.         self.assertQuerysetEqual(q, ['<NamedCategory: Generic>'])
1004. 
1005.     def test_ticket_10790_4(self):
1006.         # Querying across m2m field should not strip the m2m table from join.
1007.         q = Author.objects.filter(item__tags__isnull=True)
1008.         self.assertQuerysetEqual(
1009.             q,
1010.             ['<Author: a2>', '<Author: a3>'],
1011.         )
1012.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 2)
1013.         self.assertNotIn('INNER JOIN', str(q.query))
1014. 
1015.         q = Author.objects.filter(item__tags__parent__isnull=True)
1016.         self.assertQuerysetEqual(
1017.             q,
1018.             ['<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a3>'],
1019.         )
1020.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 3)
1021.         self.assertNotIn('INNER JOIN', str(q.query))
1022. 
1023.     def test_ticket_10790_5(self):
1024.         # Querying with isnull=False across m2m field should not create outer joins
1025.         q = Author.objects.filter(item__tags__isnull=False)
1026.         self.assertQuerysetEqual(
1027.             q,
1028.             ['<Author: a1>', '<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a4>']
1029.         )
1030.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1031.         self.assertEqual(str(q.query).count('INNER JOIN'), 2)
1032. 
1033.         q = Author.objects.filter(item__tags__parent__isnull=False)
1034.         self.assertQuerysetEqual(
1035.             q,
1036.             ['<Author: a1>', '<Author: a2>', '<Author: a4>']
1037.         )
1038.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1039.         self.assertEqual(str(q.query).count('INNER JOIN'), 3)
1040. 
1041.         q = Author.objects.filter(item__tags__parent__parent__isnull=False)
1042.         self.assertQuerysetEqual(
1043.             q,
1044.             ['<Author: a4>']
1045.         )
1046.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1047.         self.assertEqual(str(q.query).count('INNER JOIN'), 4)
1048. 
1049.     def test_ticket_10790_6(self):
1050.         # Querying with isnull=True across m2m field should not create inner joins
1051.         # and strip last outer join
1052.         q = Author.objects.filter(item__tags__parent__parent__isnull=True)
1053.         self.assertQuerysetEqual(
1054.             q,
1055.             ['<Author: a1>', '<Author: a1>', '<Author: a2>', '<Author: a2>',
1056.              '<Author: a2>', '<Author: a3>']
1057.         )
1058.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 4)
1059.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1060. 
1061.         q = Author.objects.filter(item__tags__parent__isnull=True)
1062.         self.assertQuerysetEqual(
1063.             q,
1064.             ['<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a3>']
1065.         )
1066.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 3)
1067.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1068. 
1069.     def test_ticket_10790_7(self):
1070.         # Reverse querying with isnull should not strip the join
1071.         q = Author.objects.filter(item__isnull=True)
1072.         self.assertQuerysetEqual(
1073.             q,
1074.             ['<Author: a3>']
1075.         )
1076.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
1077.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1078. 
1079.         q = Author.objects.filter(item__isnull=False)
1080.         self.assertQuerysetEqual(
1081.             q,
1082.             ['<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a4>']
1083.         )
1084.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1085.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
1086. 
1087.     def test_ticket_10790_8(self):
1088.         # Querying with combined q-objects should also strip the left outer join
1089.         q = Tag.objects.filter(Q(parent__isnull=True) | Q(parent=self.t1))
1090.         self.assertQuerysetEqual(
1091.             q,
1092.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1093.         )
1094.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1095.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1096. 
1097.     def test_ticket_10790_combine(self):
1098.         # Combining queries should not re-populate the left outer join
1099.         q1 = Tag.objects.filter(parent__isnull=True)
1100.         q2 = Tag.objects.filter(parent__isnull=False)
1101. 
1102.         q3 = q1 | q2
1103.         self.assertQuerysetEqual(
1104.             q3,
1105.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
1106.         )
1107.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1108.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1109. 
1110.         q3 = q1 & q2
1111.         self.assertQuerysetEqual(q3, [])
1112.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1113.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1114. 
1115.         q2 = Tag.objects.filter(parent=self.t1)
1116.         q3 = q1 | q2
1117.         self.assertQuerysetEqual(
1118.             q3,
1119.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1120.         )
1121.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1122.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1123. 
1124.         q3 = q2 | q1
1125.         self.assertQuerysetEqual(
1126.             q3,
1127.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1128.         )
1129.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1130.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1131. 
1132.         q1 = Tag.objects.filter(parent__isnull=True)
1133.         q2 = Tag.objects.filter(parent__parent__isnull=True)
1134. 
1135.         q3 = q1 | q2
1136.         self.assertQuerysetEqual(
1137.             q3,
1138.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1139.         )
1140.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 1)
1141.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1142. 
1143.         q3 = q2 | q1
1144.         self.assertQuerysetEqual(
1145.             q3,
1146.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1147.         )
1148.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 1)
1149.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1150. 
1151.     def test_ticket19672(self):
1152.         self.assertQuerysetEqual(
1153.             Report.objects.filter(Q(creator__isnull=False) & ~Q(creator__extra__value=41)),
1154.             ['<Report: r1>']
1155.         )
1156. 
1157.     def test_ticket_20250(self):
1158.         # A negated Q along with an annotated queryset failed in Django 1.4
1159.         qs = Author.objects.annotate(Count('item'))
1160.         qs = qs.filter(~Q(extra__value=0)).order_by('name')
1161. 
1162.         self.assertIn('SELECT', str(qs.query))
1163.         self.assertQuerysetEqual(
1164.             qs,
1165.             ['<Author: a1>', '<Author: a2>', '<Author: a3>', '<Author: a4>']
1166.         )
1167. 
1168.     def test_lookup_constraint_fielderror(self):
1169.         msg = (
1170.             "Cannot resolve keyword 'unknown_field' into field. Choices are: "
1171.             "annotation, category, category_id, children, id, item, "
1172.             "managedmodel, name, note, parent, parent_id"
1173.         )
1174.         with self.assertRaisesMessage(FieldError, msg):
1175.             Tag.objects.filter(unknown_field__name='generic')
1176. 
1177.     def test_common_mixed_case_foreign_keys(self):
1178.         """
1179.         Valid query should be generated when fields fetched from joined tables
1180.         include FKs whose names only differ by case.
1181.         """
1182.         c1 = SimpleCategory.objects.create(name='c1')
1183.         c2 = SimpleCategory.objects.create(name='c2')
1184.         c3 = SimpleCategory.objects.create(name='c3')
1185.         category = CategoryItem.objects.create(category=c1)
1186.         mixed_case_field_category = MixedCaseFieldCategoryItem.objects.create(CaTeGoRy=c2)
1187.         mixed_case_db_column_category = MixedCaseDbColumnCategoryItem.objects.create(category=c3)
1188.         CommonMixedCaseForeignKeys.objects.create(
1189.             category=category,
1190.             mixed_case_field_category=mixed_case_field_category,
1191.             mixed_case_db_column_category=mixed_case_db_column_category,
1192.         )
1193.         qs = CommonMixedCaseForeignKeys.objects.values(
1194.             'category',
1195.             'mixed_case_field_category',
1196.             'mixed_case_db_column_category',
1197.             'category__category',
1198.             'mixed_case_field_category__CaTeGoRy',
1199.             'mixed_case_db_column_category__category',
1200.         )
1201.         self.assertTrue(qs.first())
1202. 
1203.     def test_excluded_intermediary_m2m_table_joined(self):
1204.         self.assertSequenceEqual(
1205.             Note.objects.filter(~Q(tag__annotation__name=F('note'))),
1206.             [self.n1, self.n2, self.n3],
1207.         )
1208.         self.assertSequenceEqual(
1209.             Note.objects.filter(tag__annotation__name='a1').filter(~Q(tag__annotation__name=F('note'))),
1210.             [],
1211.         )
1212. 
1213.     def test_field_with_filterable(self):
1214.         self.assertSequenceEqual(
1215.             Author.objects.filter(extra=self.e2),
1216.             [self.a3, self.a4],
1217.         )
1218. 
1219. 
1220. class Queries2Tests(TestCase):
1221.     @classmethod
1222.     def setUpTestData(cls):
1223.         Number.objects.create(num=4)
1224.         Number.objects.create(num=8)
1225.         Number.objects.create(num=12)
1226. 
1227.     def test_ticket4289(self):
1228.         # A slight variation on the restricting the filtering choices by the
1229.         # lookup constraints.
1230.         self.assertQuerysetEqual(Number.objects.filter(num__lt=4), [])
1231.         self.assertQuerysetEqual(Number.objects.filter(num__gt=8, num__lt=12), [])
1232.         self.assertQuerysetEqual(
1233.             Number.objects.filter(num__gt=8, num__lt=13),
1234.             ['<Number: 12>']
1235.         )
1236.         self.assertQuerysetEqual(
1237.             Number.objects.filter(Q(num__lt=4) | Q(num__gt=8, num__lt=12)),
1238.             []
1239.         )
1240.         self.assertQuerysetEqual(
1241.             Number.objects.filter(Q(num__gt=8, num__lt=12) | Q(num__lt=4)),
1242.             []
1243.         )
1244.         self.assertQuerysetEqual(
1245.             Number.objects.filter(Q(num__gt=8) & Q(num__lt=12) | Q(num__lt=4)),
1246.             []
1247.         )
1248.         self.assertQuerysetEqual(
1249.             Number.objects.filter(Q(num__gt=7) & Q(num__lt=12) | Q(num__lt=4)),
1250.             ['<Number: 8>']
1251.         )
1252. 
1253.     def test_ticket12239(self):
1254.         # Custom lookups are registered to round float values correctly on gte
1255.         # and lt IntegerField queries.
1256.         self.assertQuerysetEqual(
1257.             Number.objects.filter(num__gt=11.9),
1258.             ['<Number: 12>']
1259.         )
1260.         self.assertQuerysetEqual(Number.objects.filter(num__gt=12), [])
1261.         self.assertQuerysetEqual(Number.objects.filter(num__gt=12.0), [])
1262.         self.assertQuerysetEqual(Number.objects.filter(num__gt=12.1), [])
1263.         self.assertQuerysetEqual(
1264.             Number.objects.filter(num__lt=12),
1265.             ['<Number: 4>', '<Number: 8>'],
1266.             ordered=False
1267.         )
1268.         self.assertQuerysetEqual(
1269.             Number.objects.filter(num__lt=12.0),
1270.             ['<Number: 4>', '<Number: 8>'],
1271.             ordered=False
1272.         )
1273.         self.assertQuerysetEqual(
1274.             Number.objects.filter(num__lt=12.1),
1275.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1276.             ordered=False
1277.         )
1278.         self.assertQuerysetEqual(
1279.             Number.objects.filter(num__gte=11.9),
1280.             ['<Number: 12>']
1281.         )
1282.         self.assertQuerysetEqual(
1283.             Number.objects.filter(num__gte=12),
1284.             ['<Number: 12>']
1285.         )
1286.         self.assertQuerysetEqual(
1287.             Number.objects.filter(num__gte=12.0),
1288.             ['<Number: 12>']
1289.         )
1290.         self.assertQuerysetEqual(Number.objects.filter(num__gte=12.1), [])
1291.         self.assertQuerysetEqual(Number.objects.filter(num__gte=12.9), [])
1292.         self.assertQuerysetEqual(
1293.             Number.objects.filter(num__lte=11.9),
1294.             ['<Number: 4>', '<Number: 8>'],
1295.             ordered=False
1296.         )
1297.         self.assertQuerysetEqual(
1298.             Number.objects.filter(num__lte=12),
1299.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1300.             ordered=False
1301.         )
1302.         self.assertQuerysetEqual(
1303.             Number.objects.filter(num__lte=12.0),
1304.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1305.             ordered=False
1306.         )
1307.         self.assertQuerysetEqual(
1308.             Number.objects.filter(num__lte=12.1),
1309.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1310.             ordered=False
1311.         )
1312.         self.assertQuerysetEqual(
1313.             Number.objects.filter(num__lte=12.9),
1314.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1315.             ordered=False
1316.         )
1317. 
1318.     def test_ticket7759(self):
1319.         # Count should work with a partially read result set.
1320.         count = Number.objects.count()
1321.         qs = Number.objects.all()
1322. 
1323.         def run():
1324.             for obj in qs:
1325.                 return qs.count() == count
1326.         self.assertTrue(run())
1327. 
1328. 
1329. class Queries3Tests(TestCase):
1330.     def test_ticket7107(self):
1331.         # This shouldn't create an infinite loop.
1332.         self.assertQuerysetEqual(Valid.objects.all(), [])
1333. 
1334.     def test_ticket8683(self):
1335.         # An error should be raised when QuerySet.datetimes() is passed the
1336.         # wrong type of field.
1337.         with self.assertRaisesMessage(AssertionError, "'name' isn't a DateField, TimeField, or DateTimeField."):
1338.             Item.objects.datetimes('name', 'month')
1339. 
1340.     def test_ticket22023(self):
1341.         with self.assertRaisesMessage(TypeError, "Cannot call only() after .values() or .values_list()"):
1342.             Valid.objects.values().only()
1343. 
1344.         with self.assertRaisesMessage(TypeError, "Cannot call defer() after .values() or .values_list()"):
1345.             Valid.objects.values().defer()
1346. 
1347. 
1348. class Queries4Tests(TestCase):
1349.     @classmethod
1350.     def setUpTestData(cls):
1351.         generic = NamedCategory.objects.create(name="Generic")
1352.         cls.t1 = Tag.objects.create(name='t1', category=generic)
1353. 
1354.         n1 = Note.objects.create(note='n1', misc='foo')
1355.         n2 = Note.objects.create(note='n2', misc='bar')
1356. 
1357.         e1 = ExtraInfo.objects.create(info='e1', note=n1)
1358.         e2 = ExtraInfo.objects.create(info='e2', note=n2)
1359. 
1360.         cls.a1 = Author.objects.create(name='a1', num=1001, extra=e1)
1361.         cls.a3 = Author.objects.create(name='a3', num=3003, extra=e2)
1362. 
1363.         cls.r1 = Report.objects.create(name='r1', creator=cls.a1)
1364.         cls.r2 = Report.objects.create(name='r2', creator=cls.a3)
1365.         cls.r3 = Report.objects.create(name='r3')
1366. 
1367.         Item.objects.create(name='i1', created=datetime.datetime.now(), note=n1, creator=cls.a1)
1368.         Item.objects.create(name='i2', created=datetime.datetime.now(), note=n1, creator=cls.a3)
1369. 
1370.     def test_ticket24525(self):
1371.         tag = Tag.objects.create()
1372.         anth100 = tag.note_set.create(note='ANTH', misc='100')
1373.         math101 = tag.note_set.create(note='MATH', misc='101')
1374.         s1 = tag.annotation_set.create(name='1')
1375.         s2 = tag.annotation_set.create(name='2')
1376.         s1.notes.set([math101, anth100])
1377.         s2.notes.set([math101])
1378.         result = math101.annotation_set.all() & tag.annotation_set.exclude(notes__in=[anth100])
1379.         self.assertEqual(list(result), [s2])
1380. 
1381.     def test_ticket11811(self):
1382.         unsaved_category = NamedCategory(name="Other")
1383.         msg = 'Unsaved model instance <NamedCategory: Other> cannot be used in an ORM query.'
1384.         with self.assertRaisesMessage(ValueError, msg):
1385.             Tag.objects.filter(pk=self.t1.pk).update(category=unsaved_category)
1386. 
1387.     def test_ticket14876(self):
1388.         # Note: when combining the query we need to have information available
1389.         # about the join type of the trimmed "creator__isnull" join. If we
1390.         # don't have that information, then the join is created as INNER JOIN
1391.         # and results will be incorrect.
1392.         q1 = Report.objects.filter(Q(creator__isnull=True) | Q(creator__extra__info='e1'))
1393.         q2 = Report.objects.filter(Q(creator__isnull=True)) | Report.objects.filter(Q(creator__extra__info='e1'))
1394.         self.assertQuerysetEqual(q1, ["<Report: r1>", "<Report: r3>"], ordered=False)
1395.         self.assertEqual(str(q1.query), str(q2.query))
1396. 
1397.         q1 = Report.objects.filter(Q(creator__extra__info='e1') | Q(creator__isnull=True))
1398.         q2 = Report.objects.filter(Q(creator__extra__info='e1')) | Report.objects.filter(Q(creator__isnull=True))
1399.         self.assertQuerysetEqual(q1, ["<Report: r1>", "<Report: r3>"], ordered=False)
1400.         self.assertEqual(str(q1.query), str(q2.query))
1401. 
1402.         q1 = Item.objects.filter(Q(creator=self.a1) | Q(creator__report__name='r1')).order_by()
1403.         q2 = (
1404.             Item.objects
1405.             .filter(Q(creator=self.a1)).order_by() | Item.objects.filter(Q(creator__report__name='r1'))
1406.             .order_by()
1407.         )
1408.         self.assertQuerysetEqual(q1, ["<Item: i1>"])
1409.         self.assertEqual(str(q1.query), str(q2.query))
1410. 
1411.         q1 = Item.objects.filter(Q(creator__report__name='e1') | Q(creator=self.a1)).order_by()
1412.         q2 = (
1413.             Item.objects.filter(Q(creator__report__name='e1')).order_by() |
1414.             Item.objects.filter(Q(creator=self.a1)).order_by()
1415.         )
1416.         self.assertQuerysetEqual(q1, ["<Item: i1>"])
1417.         self.assertEqual(str(q1.query), str(q2.query))
1418. 
1419.     def test_combine_join_reuse(self):
1420.         # Joins having identical connections are correctly recreated in the
1421.         # rhs query, in case the query is ORed together (#18748).
1422.         Report.objects.create(name='r4', creator=self.a1)
1423.         q1 = Author.objects.filter(report__name='r5')
1424.         q2 = Author.objects.filter(report__name='r4').filter(report__name='r1')
1425.         combined = q1 | q2
1426.         self.assertEqual(str(combined.query).count('JOIN'), 2)
1427.         self.assertEqual(len(combined), 1)
1428.         self.assertEqual(combined[0].name, 'a1')
1429. 
1430.     def test_join_reuse_order(self):
1431.         # Join aliases are reused in order. This shouldn't raise AssertionError
1432.         # because change_map contains a circular reference (#26522).
1433.         s1 = School.objects.create()
1434.         s2 = School.objects.create()
1435.         s3 = School.objects.create()
1436.         t1 = Teacher.objects.create()
1437.         otherteachers = Teacher.objects.exclude(pk=t1.pk).exclude(friends=t1)
1438.         qs1 = otherteachers.filter(schools=s1).filter(schools=s2)
1439.         qs2 = otherteachers.filter(schools=s1).filter(schools=s3)
1440.         self.assertQuerysetEqual(qs1 | qs2, [])
1441. 
1442.     def test_ticket7095(self):
1443.         # Updates that are filtered on the model being updated are somewhat
1444.         # tricky in MySQL.
1445.         ManagedModel.objects.create(data='mm1', tag=self.t1, public=True)
1446.         self.assertEqual(ManagedModel.objects.update(data='mm'), 1)
1447. 
1448.         # A values() or values_list() query across joined models must use outer
1449.         # joins appropriately.
1450.         # Note: In Oracle, we expect a null CharField to return '' instead of
1451.         # None.
1452.         if connection.features.interprets_empty_strings_as_nulls:
1453.             expected_null_charfield_repr = ''
1454.         else:
1455.             expected_null_charfield_repr = None
1456.         self.assertSequenceEqual(
1457.             Report.objects.values_list("creator__extra__info", flat=True).order_by("name"),
1458.             ['e1', 'e2', expected_null_charfield_repr],
1459.         )
1460. 
1461.         # Similarly for select_related(), joins beyond an initial nullable join
1462.         # must use outer joins so that all results are included.
1463.         self.assertQuerysetEqual(
1464.             Report.objects.select_related("creator", "creator__extra").order_by("name"),
1465.             ['<Report: r1>', '<Report: r2>', '<Report: r3>']
1466.         )
1467. 
1468.         # When there are multiple paths to a table from another table, we have
1469.         # to be careful not to accidentally reuse an inappropriate join when
1470.         # using select_related(). We used to return the parent's Detail record
1471.         # here by mistake.
1472. 
1473.         d1 = Detail.objects.create(data="d1")
1474.         d2 = Detail.objects.create(data="d2")
1475.         m1 = Member.objects.create(name="m1", details=d1)
1476.         m2 = Member.objects.create(name="m2", details=d2)
1477.         Child.objects.create(person=m2, parent=m1)
1478.         obj = m1.children.select_related("person__details")[0]
1479.         self.assertEqual(obj.person.details.data, 'd2')
1480. 
1481.     def test_order_by_resetting(self):
1482.         # Calling order_by() with no parameters removes any existing ordering on the
1483.         # model. But it should still be possible to add new ordering after that.
1484.         qs = Author.objects.order_by().order_by('name')
1485.         self.assertIn('ORDER BY', qs.query.get_compiler(qs.db).as_sql()[0])
1486. 
1487.     def test_order_by_reverse_fk(self):
1488.         # It is possible to order by reverse of foreign key, although that can lead
1489.         # to duplicate results.
1490.         c1 = SimpleCategory.objects.create(name="category1")
1491.         c2 = SimpleCategory.objects.create(name="category2")
1492.         CategoryItem.objects.create(category=c1)
1493.         CategoryItem.objects.create(category=c2)
1494.         CategoryItem.objects.create(category=c1)
1495.         self.assertSequenceEqual(SimpleCategory.objects.order_by('categoryitem', 'pk'), [c1, c2, c1])
1496. 
1497.     def test_filter_reverse_non_integer_pk(self):
1498.         date_obj = DateTimePK.objects.create()
1499.         extra_obj = ExtraInfo.objects.create(info='extra', date=date_obj)
1500.         self.assertEqual(
1501.             DateTimePK.objects.filter(extrainfo=extra_obj).get(),
1502.             date_obj,
1503.         )
1504. 
1505.     def test_ticket10181(self):
1506.         # Avoid raising an EmptyResultSet if an inner query is probably
1507.         # empty (and hence, not executed).
1508.         self.assertQuerysetEqual(
1509.             Tag.objects.filter(id__in=Tag.objects.filter(id__in=[])),
1510.             []
1511.         )
1512. 
1513.     def test_ticket15316_filter_false(self):
1514.         c1 = SimpleCategory.objects.create(name="category1")
1515.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1516.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1517. 
1518.         CategoryItem.objects.create(category=c1)
1519.         ci2 = CategoryItem.objects.create(category=c2)
1520.         ci3 = CategoryItem.objects.create(category=c3)
1521. 
1522.         qs = CategoryItem.objects.filter(category__specialcategory__isnull=False)
1523.         self.assertEqual(qs.count(), 2)
1524.         self.assertSequenceEqual(qs, [ci2, ci3])
1525. 
1526.     def test_ticket15316_exclude_false(self):
1527.         c1 = SimpleCategory.objects.create(name="category1")
1528.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1529.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1530. 
1531.         ci1 = CategoryItem.objects.create(category=c1)
1532.         CategoryItem.objects.create(category=c2)
1533.         CategoryItem.objects.create(category=c3)
1534. 
1535.         qs = CategoryItem.objects.exclude(category__specialcategory__isnull=False)
1536.         self.assertEqual(qs.count(), 1)
1537.         self.assertSequenceEqual(qs, [ci1])
1538. 
1539.     def test_ticket15316_filter_true(self):
1540.         c1 = SimpleCategory.objects.create(name="category1")
1541.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1542.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1543. 
1544.         ci1 = CategoryItem.objects.create(category=c1)
1545.         CategoryItem.objects.create(category=c2)
1546.         CategoryItem.objects.create(category=c3)
1547. 
1548.         qs = CategoryItem.objects.filter(category__specialcategory__isnull=True)
1549.         self.assertEqual(qs.count(), 1)
1550.         self.assertSequenceEqual(qs, [ci1])
1551. 
1552.     def test_ticket15316_exclude_true(self):
1553.         c1 = SimpleCategory.objects.create(name="category1")
1554.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1555.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1556. 
1557.         CategoryItem.objects.create(category=c1)
1558.         ci2 = CategoryItem.objects.create(category=c2)
1559.         ci3 = CategoryItem.objects.create(category=c3)
1560. 
1561.         qs = CategoryItem.objects.exclude(category__specialcategory__isnull=True)
1562.         self.assertEqual(qs.count(), 2)
1563.         self.assertSequenceEqual(qs, [ci2, ci3])
1564. 
1565.     def test_ticket15316_one2one_filter_false(self):
1566.         c = SimpleCategory.objects.create(name="cat")
1567.         c0 = SimpleCategory.objects.create(name="cat0")
1568.         c1 = SimpleCategory.objects.create(name="category1")
1569. 
1570.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1571.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1572. 
1573.         CategoryItem.objects.create(category=c)
1574.         ci2 = CategoryItem.objects.create(category=c0)
1575.         ci3 = CategoryItem.objects.create(category=c1)
1576. 
1577.         qs = CategoryItem.objects.filter(category__onetoonecategory__isnull=False).order_by('pk')
1578.         self.assertEqual(qs.count(), 2)
1579.         self.assertSequenceEqual(qs, [ci2, ci3])
1580. 
1581.     def test_ticket15316_one2one_exclude_false(self):
1582.         c = SimpleCategory.objects.create(name="cat")
1583.         c0 = SimpleCategory.objects.create(name="cat0")
1584.         c1 = SimpleCategory.objects.create(name="category1")
1585. 
1586.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1587.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1588. 
1589.         ci1 = CategoryItem.objects.create(category=c)
1590.         CategoryItem.objects.create(category=c0)
1591.         CategoryItem.objects.create(category=c1)
1592. 
1593.         qs = CategoryItem.objects.exclude(category__onetoonecategory__isnull=False)
1594.         self.assertEqual(qs.count(), 1)
1595.         self.assertSequenceEqual(qs, [ci1])
1596. 
1597.     def test_ticket15316_one2one_filter_true(self):
1598.         c = SimpleCategory.objects.create(name="cat")
1599.         c0 = SimpleCategory.objects.create(name="cat0")
1600.         c1 = SimpleCategory.objects.create(name="category1")
1601. 
1602.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1603.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1604. 
1605.         ci1 = CategoryItem.objects.create(category=c)
1606.         CategoryItem.objects.create(category=c0)
1607.         CategoryItem.objects.create(category=c1)
1608. 
1609.         qs = CategoryItem.objects.filter(category__onetoonecategory__isnull=True)
1610.         self.assertEqual(qs.count(), 1)
1611.         self.assertSequenceEqual(qs, [ci1])
1612. 
1613.     def test_ticket15316_one2one_exclude_true(self):
1614.         c = SimpleCategory.objects.create(name="cat")
1615.         c0 = SimpleCategory.objects.create(name="cat0")
1616.         c1 = SimpleCategory.objects.create(name="category1")
1617. 
1618.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1619.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1620. 
1621.         CategoryItem.objects.create(category=c)
1622.         ci2 = CategoryItem.objects.create(category=c0)
1623.         ci3 = CategoryItem.objects.create(category=c1)
1624. 
1625.         qs = CategoryItem.objects.exclude(category__onetoonecategory__isnull=True).order_by('pk')
1626.         self.assertEqual(qs.count(), 2)
1627.         self.assertSequenceEqual(qs, [ci2, ci3])
1628. 
1629. 
1630. class Queries5Tests(TestCase):
1631.     @classmethod
1632.     def setUpTestData(cls):
1633.         # Ordering by 'rank' gives us rank2, rank1, rank3. Ordering by the
1634.         # Meta.ordering will be rank3, rank2, rank1.
1635.         n1 = Note.objects.create(note='n1', misc='foo', id=1)
1636.         n2 = Note.objects.create(note='n2', misc='bar', id=2)
1637.         e1 = ExtraInfo.objects.create(info='e1', note=n1)
1638.         e2 = ExtraInfo.objects.create(info='e2', note=n2)
1639.         a1 = Author.objects.create(name='a1', num=1001, extra=e1)
1640.         a2 = Author.objects.create(name='a2', num=2002, extra=e1)
1641.         a3 = Author.objects.create(name='a3', num=3003, extra=e2)
1642.         cls.rank1 = Ranking.objects.create(rank=2, author=a2)
1643.         Ranking.objects.create(rank=1, author=a3)
1644.         Ranking.objects.create(rank=3, author=a1)
1645. 
1646.     def test_ordering(self):
1647.         # Cross model ordering is possible in Meta, too.
1648.         self.assertQuerysetEqual(
1649.             Ranking.objects.all(),
1650.             ['<Ranking: 3: a1>', '<Ranking: 2: a2>', '<Ranking: 1: a3>']
1651.         )
1652.         self.assertQuerysetEqual(
1653.             Ranking.objects.all().order_by('rank'),
1654.             ['<Ranking: 1: a3>', '<Ranking: 2: a2>', '<Ranking: 3: a1>']
1655.         )
1656. 
1657.         # Ordering of extra() pieces is possible, too and you can mix extra
1658.         # fields and model fields in the ordering.
1659.         self.assertQuerysetEqual(
1660.             Ranking.objects.extra(tables=['django_site'], order_by=['-django_site.id', 'rank']),
1661.             ['<Ranking: 1: a3>', '<Ranking: 2: a2>', '<Ranking: 3: a1>']
1662.         )
1663. 
1664.         sql = 'case when %s > 2 then 1 else 0 end' % connection.ops.quote_name('rank')
1665.         qs = Ranking.objects.extra(select={'good': sql})
1666.         self.assertEqual(
1667.             [o.good for o in qs.extra(order_by=('-good',))],
1668.             [True, False, False]
1669.         )
1670.         self.assertQuerysetEqual(
1671.             qs.extra(order_by=('-good', 'id')),
1672.             ['<Ranking: 3: a1>', '<Ranking: 2: a2>', '<Ranking: 1: a3>']
1673.         )
1674. 
1675.         # Despite having some extra aliases in the query, we can still omit
1676.         # them in a values() query.
1677.         dicts = qs.values('id', 'rank').order_by('id')
1678.         self.assertEqual(
1679.             [d['rank'] for d in dicts],
1680.             [2, 1, 3]
1681.         )
1682. 
1683.     def test_ticket7256(self):
1684.         # An empty values() call includes all aliases, including those from an
1685.         # extra()
1686.         sql = 'case when %s > 2 then 1 else 0 end' % connection.ops.quote_name('rank')
1687.         qs = Ranking.objects.extra(select={'good': sql})
1688.         dicts = qs.values().order_by('id')
1689.         for d in dicts:
1690.             del d['id']
1691.             del d['author_id']
1692.         self.assertEqual(
1693.             [sorted(d.items()) for d in dicts],
1694.             [[('good', 0), ('rank', 2)], [('good', 0), ('rank', 1)], [('good', 1), ('rank', 3)]]
1695.         )
1696. 
1697.     def test_ticket7045(self):
1698.         # Extra tables used to crash SQL construction on the second use.
1699.         qs = Ranking.objects.extra(tables=['django_site'])
1700.         qs.query.get_compiler(qs.db).as_sql()
1701.         # test passes if this doesn't raise an exception.
1702.         qs.query.get_compiler(qs.db).as_sql()
1703. 
1704.     def test_ticket9848(self):
1705.         # Make sure that updates which only filter on sub-tables don't
1706.         # inadvertently update the wrong records (bug #9848).
1707.         author_start = Author.objects.get(name='a1')
1708.         ranking_start = Ranking.objects.get(author__name='a1')
1709. 
1710.         # Make sure that the IDs from different tables don't happen to match.
1711.         self.assertQuerysetEqual(
1712.             Ranking.objects.filter(author__name='a1'),
1713.             ['<Ranking: 3: a1>']
1714.         )
1715.         self.assertEqual(
1716.             Ranking.objects.filter(author__name='a1').update(rank=4636),
1717.             1
1718.         )
1719. 
1720.         r = Ranking.objects.get(author__name='a1')
1721.         self.assertEqual(r.id, ranking_start.id)
1722.         self.assertEqual(r.author.id, author_start.id)
1723.         self.assertEqual(r.rank, 4636)
1724.         r.rank = 3
1725.         r.save()
1726.         self.assertQuerysetEqual(
1727.             Ranking.objects.all(),
1728.             ['<Ranking: 3: a1>', '<Ranking: 2: a2>', '<Ranking: 1: a3>']
1729.         )
1730. 
1731.     def test_ticket5261(self):
1732.         # Test different empty excludes.
1733.         self.assertQuerysetEqual(
1734.             Note.objects.exclude(Q()),
1735.             ['<Note: n1>', '<Note: n2>']
1736.         )
1737.         self.assertQuerysetEqual(
1738.             Note.objects.filter(~Q()),
1739.             ['<Note: n1>', '<Note: n2>']
1740.         )
1741.         self.assertQuerysetEqual(
1742.             Note.objects.filter(~Q() | ~Q()),
1743.             ['<Note: n1>', '<Note: n2>']
1744.         )
1745.         self.assertQuerysetEqual(
1746.             Note.objects.exclude(~Q() & ~Q()),
1747.             ['<Note: n1>', '<Note: n2>']
1748.         )
1749. 
1750.     def test_extra_select_literal_percent_s(self):
1751.         # Allow %%s to escape select clauses
1752.         self.assertEqual(
1753.             Note.objects.extra(select={'foo': "'%%s'"})[0].foo,
1754.             '%s'
1755.         )
1756.         self.assertEqual(
1757.             Note.objects.extra(select={'foo': "'%%s bar %%s'"})[0].foo,
1758.             '%s bar %s'
1759.         )
1760.         self.assertEqual(
1761.             Note.objects.extra(select={'foo': "'bar %%s'"})[0].foo,
1762.             'bar %s'
1763.         )
1764. 
1765. 
1766. class SelectRelatedTests(TestCase):
1767.     def test_tickets_3045_3288(self):
1768.         # Once upon a time, select_related() with circular relations would loop
1769.         # infinitely if you forgot to specify "depth". Now we set an arbitrary
1770.         # default upper bound.
1771.         self.assertQuerysetEqual(X.objects.all(), [])
1772.         self.assertQuerysetEqual(X.objects.select_related(), [])
1773. 
1774. 
1775. class SubclassFKTests(TestCase):
1776.     def test_ticket7778(self):
1777.         # Model subclasses could not be deleted if a nullable foreign key
1778.         # relates to a model that relates back.
1779. 
1780.         num_celebs = Celebrity.objects.count()
1781.         tvc = TvChef.objects.create(name="Huey")
1782.         self.assertEqual(Celebrity.objects.count(), num_celebs + 1)
1783.         Fan.objects.create(fan_of=tvc)
1784.         Fan.objects.create(fan_of=tvc)
1785.         tvc.delete()
1786. 
1787.         # The parent object should have been deleted as well.
1788.         self.assertEqual(Celebrity.objects.count(), num_celebs)
1789. 
1790. 
1791. class CustomPkTests(TestCase):
1792.     def test_ticket7371(self):
1793.         self.assertQuerysetEqual(Related.objects.order_by('custom'), [])
1794. 
1795. 
1796. class NullableRelOrderingTests(TestCase):
1797.     def test_ticket10028(self):
1798.         # Ordering by model related to nullable relations(!) should use outer
1799.         # joins, so that all results are included.
1800.         Plaything.objects.create(name="p1")
1801.         self.assertQuerysetEqual(
1802.             Plaything.objects.all(),
1803.             ['<Plaything: p1>']
1804.         )
1805. 
1806.     def test_join_already_in_query(self):
1807.         # Ordering by model related to nullable relations should not change
1808.         # the join type of already existing joins.
1809.         Plaything.objects.create(name="p1")
1810.         s = SingleObject.objects.create(name='s')
1811.         r = RelatedObject.objects.create(single=s, f=1)
1812.         Plaything.objects.create(name="p2", others=r)
1813.         qs = Plaything.objects.all().filter(others__isnull=False).order_by('pk')
1814.         self.assertNotIn('JOIN', str(qs.query))
1815.         qs = Plaything.objects.all().filter(others__f__isnull=False).order_by('pk')
1816.         self.assertIn('INNER', str(qs.query))
1817.         qs = qs.order_by('others__single__name')
1818.         # The ordering by others__single__pk will add one new join (to single)
1819.         # and that join must be LEFT join. The already existing join to related
1820.         # objects must be kept INNER. So, we have both an INNER and a LEFT join
1821.         # in the query.
1822.         self.assertEqual(str(qs.query).count('LEFT'), 1)
1823.         self.assertEqual(str(qs.query).count('INNER'), 1)
1824.         self.assertQuerysetEqual(
1825.             qs,
1826.             ['<Plaything: p2>']
1827.         )
1828. 
1829. 
1830. class DisjunctiveFilterTests(TestCase):
1831.     @classmethod
1832.     def setUpTestData(cls):
1833.         cls.n1 = Note.objects.create(note='n1', misc='foo', id=1)
1834.         ExtraInfo.objects.create(info='e1', note=cls.n1)
1835. 
1836.     def test_ticket7872(self):
1837.         # Another variation on the disjunctive filtering theme.
1838. 
1839.         # For the purposes of this regression test, it's important that there is no
1840.         # Join object related to the LeafA we create.
1841.         LeafA.objects.create(data='first')
1842.         self.assertQuerysetEqual(LeafA.objects.all(), ['<LeafA: first>'])
1843.         self.assertQuerysetEqual(
1844.             LeafA.objects.filter(Q(data='first') | Q(join__b__data='second')),
1845.             ['<LeafA: first>']
1846.         )
1847. 
1848.     def test_ticket8283(self):
1849.         # Checking that applying filters after a disjunction works correctly.
1850.         self.assertQuerysetEqual(
1851.             (ExtraInfo.objects.filter(note=self.n1) | ExtraInfo.objects.filter(info='e2')).filter(note=self.n1),
1852.             ['<ExtraInfo: e1>']
1853.         )
1854.         self.assertQuerysetEqual(
1855.             (ExtraInfo.objects.filter(info='e2') | ExtraInfo.objects.filter(note=self.n1)).filter(note=self.n1),
1856.             ['<ExtraInfo: e1>']
1857.         )
1858. 
1859. 
1860. class Queries6Tests(TestCase):
1861.     @classmethod
1862.     def setUpTestData(cls):
1863.         generic = NamedCategory.objects.create(name="Generic")
1864.         cls.t1 = Tag.objects.create(name='t1', category=generic)
1865.         cls.t2 = Tag.objects.create(name='t2', parent=cls.t1, category=generic)
1866.         cls.t3 = Tag.objects.create(name='t3', parent=cls.t1)
1867.         cls.t4 = Tag.objects.create(name='t4', parent=cls.t3)
1868.         cls.t5 = Tag.objects.create(name='t5', parent=cls.t3)
1869.         n1 = Note.objects.create(note='n1', misc='foo', id=1)
1870.         ann1 = Annotation.objects.create(name='a1', tag=cls.t1)
1871.         ann1.notes.add(n1)
1872.         Annotation.objects.create(name='a2', tag=cls.t4)
1873. 
1874.     def test_parallel_iterators(self):
1875.         # Parallel iterators work.
1876.         qs = Tag.objects.all()
1877.         i1, i2 = iter(qs), iter(qs)
1878.         self.assertEqual(repr(next(i1)), '<Tag: t1>')
1879.         self.assertEqual(repr(next(i1)), '<Tag: t2>')
1880.         self.assertEqual(repr(next(i2)), '<Tag: t1>')
1881.         self.assertEqual(repr(next(i2)), '<Tag: t2>')
1882.         self.assertEqual(repr(next(i2)), '<Tag: t3>')
1883.         self.assertEqual(repr(next(i1)), '<Tag: t3>')
1884. 
1885.         qs = X.objects.all()
1886.         self.assertFalse(qs)
1887.         self.assertFalse(qs)
1888. 
1889.     def test_nested_queries_sql(self):
1890.         # Nested queries should not evaluate the inner query as part of constructing the
1891.         # SQL (so we should see a nested query here, indicated by two "SELECT" calls).
1892.         qs = Annotation.objects.filter(notes__in=Note.objects.filter(note="xyzzy"))
1893.         self.assertEqual(
1894.             qs.query.get_compiler(qs.db).as_sql()[0].count('SELECT'),
1895.             2
1896.         )
1897. 
1898.     def test_tickets_8921_9188(self):
1899.         # Incorrect SQL was being generated for certain types of exclude()
1900.         # queries that crossed multi-valued relations (#8921, #9188 and some
1901.         # preemptively discovered cases).
1902. 
1903.         self.assertQuerysetEqual(
1904.             PointerA.objects.filter(connection__pointerb__id=1),
1905.             []
1906.         )
1907.         self.assertQuerysetEqual(
1908.             PointerA.objects.exclude(connection__pointerb__id=1),
1909.             []
1910.         )
1911. 
1912.         self.assertQuerysetEqual(
1913.             Tag.objects.exclude(children=None),
1914.             ['<Tag: t1>', '<Tag: t3>']
1915.         )
1916. 
1917.         # This example is tricky because the parent could be NULL, so only checking
1918.         # parents with annotations omits some results (tag t1, in this case).
1919.         self.assertQuerysetEqual(
1920.             Tag.objects.exclude(parent__annotation__name="a1"),
1921.             ['<Tag: t1>', '<Tag: t4>', '<Tag: t5>']
1922.         )
1923. 
1924.         # The annotation->tag link is single values and tag->children links is
1925.         # multi-valued. So we have to split the exclude filter in the middle
1926.         # and then optimize the inner query without losing results.
1927.         self.assertQuerysetEqual(
1928.             Annotation.objects.exclude(tag__children__name="t2"),
1929.             ['<Annotation: a2>']
1930.         )
1931. 
1932.         # Nested queries are possible (although should be used with care, since
1933.         # they have performance problems on backends like MySQL.
1934.         self.assertQuerysetEqual(
1935.             Annotation.objects.filter(notes__in=Note.objects.filter(note="n1")),
1936.             ['<Annotation: a1>']
1937.         )
1938. 
1939.     def test_ticket3739(self):
1940.         # The all() method on querysets returns a copy of the queryset.
1941.         q1 = Tag.objects.order_by('name')
1942.         self.assertIsNot(q1, q1.all())
1943. 
1944.     def test_ticket_11320(self):
1945.         qs = Tag.objects.exclude(category=None).exclude(category__name='foo')
1946.         self.assertEqual(str(qs.query).count(' INNER JOIN '), 1)
1947. 
1948.     def test_distinct_ordered_sliced_subquery_aggregation(self):
1949.         self.assertEqual(Tag.objects.distinct().order_by('category__name')[:3].count(), 3)
1950. 
1951.     def test_multiple_columns_with_the_same_name_slice(self):
1952.         self.assertEqual(
1953.             list(Tag.objects.order_by('name').values_list('name', 'category__name')[:2]),
1954.             [('t1', 'Generic'), ('t2', 'Generic')],
1955.         )
1956.         self.assertSequenceEqual(
1957.             Tag.objects.order_by('name').select_related('category')[:2],
1958.             [self.t1, self.t2],
1959.         )
1960.         self.assertEqual(
1961.             list(Tag.objects.order_by('-name').values_list('name', 'parent__name')[:2]),
1962.             [('t5', 't3'), ('t4', 't3')],
1963.         )
1964.         self.assertSequenceEqual(
1965.             Tag.objects.order_by('-name').select_related('parent')[:2],
1966.             [self.t5, self.t4],
1967.         )
1968. 
1969. 
1970. class RawQueriesTests(TestCase):
1971.     @classmethod
1972.     def setUpTestData(cls):
1973.         Note.objects.create(note='n1', misc='foo', id=1)
1974. 
1975.     def test_ticket14729(self):
1976.         # Test representation of raw query with one or few parameters passed as list
1977.         query = "SELECT * FROM queries_note WHERE note = %s"
1978.         params = ['n1']
1979.         qs = Note.objects.raw(query, params=params)
1980.         self.assertEqual(repr(qs), "<RawQuerySet: SELECT * FROM queries_note WHERE note = n1>")
1981. 
1982.         query = "SELECT * FROM queries_note WHERE note = %s and misc = %s"
1983.         params = ['n1', 'foo']
1984.         qs = Note.objects.raw(query, params=params)
1985.         self.assertEqual(repr(qs), "<RawQuerySet: SELECT * FROM queries_note WHERE note = n1 and misc = foo>")
1986. 
1987. 
1988. class GeneratorExpressionTests(SimpleTestCase):
1989.     def test_ticket10432(self):
1990.         # Using an empty iterator as the rvalue for an "__in"
1991.         # lookup is legal.
1992.         self.assertCountEqual(Note.objects.filter(pk__in=iter(())), [])
1993. 
1994. 
1995. class ComparisonTests(TestCase):
1996.     @classmethod
1997.     def setUpTestData(cls):
1998.         cls.n1 = Note.objects.create(note='n1', misc='foo', id=1)
1999.         e1 = ExtraInfo.objects.create(info='e1', note=cls.n1)
2000.         cls.a2 = Author.objects.create(name='a2', num=2002, extra=e1)
2001. 
2002.     def test_ticket8597(self):
2003.         # Regression tests for case-insensitive comparisons
2004.         Item.objects.create(name="a_b", created=datetime.datetime.now(), creator=self.a2, note=self.n1)
2005.         Item.objects.create(name="x%y", created=datetime.datetime.now(), creator=self.a2, note=self.n1)
2006.         self.assertQuerysetEqual(
2007.             Item.objects.filter(name__iexact="A_b"),
2008.             ['<Item: a_b>']
2009.         )
2010.         self.assertQuerysetEqual(
2011.             Item.objects.filter(name__iexact="x%Y"),
2012.             ['<Item: x%y>']
2013.         )
2014.         self.assertQuerysetEqual(
2015.             Item.objects.filter(name__istartswith="A_b"),
2016.             ['<Item: a_b>']
2017.         )
2018.         self.assertQuerysetEqual(
2019.             Item.objects.filter(name__iendswith="A_b"),
2020.             ['<Item: a_b>']
2021.         )
2022. 
2023. 
2024. class ExistsSql(TestCase):
2025.     def test_exists(self):
2026.         with CaptureQueriesContext(connection) as captured_queries:
2027.             self.assertFalse(Tag.objects.exists())
2028.         # Ok - so the exist query worked - but did it include too many columns?
2029.         self.assertEqual(len(captured_queries), 1)
2030.         qstr = captured_queries[0]['sql']
2031.         id, name = connection.ops.quote_name('id'), connection.ops.quote_name('name')
2032.         self.assertNotIn(id, qstr)
2033.         self.assertNotIn(name, qstr)
2034. 
2035.     def test_ticket_18414(self):
2036.         Article.objects.create(name='one', created=datetime.datetime.now())
2037.         Article.objects.create(name='one', created=datetime.datetime.now())
2038.         Article.objects.create(name='two', created=datetime.datetime.now())
2039.         self.assertTrue(Article.objects.exists())
2040.         self.assertTrue(Article.objects.distinct().exists())
2041.         self.assertTrue(Article.objects.distinct()[1:3].exists())
2042.         self.assertFalse(Article.objects.distinct()[1:1].exists())
2043. 
2044.     @skipUnlessDBFeature('can_distinct_on_fields')
2045.     def test_ticket_18414_distinct_on(self):
2046.         Article.objects.create(name='one', created=datetime.datetime.now())
2047.         Article.objects.create(name='one', created=datetime.datetime.now())
2048.         Article.objects.create(name='two', created=datetime.datetime.now())
2049.         self.assertTrue(Article.objects.distinct('name').exists())
2050.         self.assertTrue(Article.objects.distinct('name')[1:2].exists())
2051.         self.assertFalse(Article.objects.distinct('name')[2:3].exists())
2052. 
2053. 
2054. class QuerysetOrderedTests(unittest.TestCase):
2055.     """
2056.     Tests for the Queryset.ordered attribute.
2057.     """
2058. 
2059.     def test_no_default_or_explicit_ordering(self):
2060.         self.assertIs(Annotation.objects.all().ordered, False)
2061. 
2062.     def test_cleared_default_ordering(self):
2063.         self.assertIs(Tag.objects.all().ordered, True)
2064.         self.assertIs(Tag.objects.all().order_by().ordered, False)
2065. 
2066.     def test_explicit_ordering(self):
2067.         self.assertIs(Annotation.objects.all().order_by('id').ordered, True)
2068. 
2069.     def test_empty_queryset(self):
2070.         self.assertIs(Annotation.objects.none().ordered, True)
2071. 
2072.     def test_order_by_extra(self):
2073.         self.assertIs(Annotation.objects.all().extra(order_by=['id']).ordered, True)
2074. 
2075.     def test_annotated_ordering(self):
2076.         qs = Annotation.objects.annotate(num_notes=Count('notes'))
2077.         self.assertIs(qs.ordered, False)
2078.         self.assertIs(qs.order_by('num_notes').ordered, True)
2079. 
2080. 
2081. @skipUnlessDBFeature('allow_sliced_subqueries_with_in')
2082. class SubqueryTests(TestCase):
2083.     @classmethod
2084.     def setUpTestData(cls):
2085.         NamedCategory.objects.create(id=1, name='first')
2086.         NamedCategory.objects.create(id=2, name='second')
2087.         NamedCategory.objects.create(id=3, name='third')
2088.         NamedCategory.objects.create(id=4, name='fourth')
2089. 
2090.     def test_ordered_subselect(self):
2091.         "Subselects honor any manual ordering"
2092.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[0:2])
2093.         self.assertEqual(set(query.values_list('id', flat=True)), {3, 4})
2094. 
2095.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[:2])
2096.         self.assertEqual(set(query.values_list('id', flat=True)), {3, 4})
2097. 
2098.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:2])
2099.         self.assertEqual(set(query.values_list('id', flat=True)), {3})
2100. 
2101.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[2:])
2102.         self.assertEqual(set(query.values_list('id', flat=True)), {1, 2})
2103. 
2104.     def test_slice_subquery_and_query(self):
2105.         """
2106.         Slice a query that has a sliced subquery
2107.         """
2108.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[0:2])[0:2]
2109.         self.assertEqual({x.id for x in query}, {3, 4})
2110. 
2111.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:3])[1:3]
2112.         self.assertEqual({x.id for x in query}, {3})
2113. 
2114.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[2:])[1:]
2115.         self.assertEqual({x.id for x in query}, {2})
2116. 
2117.     def test_related_sliced_subquery(self):
2118.         """
2119.         Related objects constraints can safely contain sliced subqueries.
2120.         refs #22434
2121.         """
2122.         generic = NamedCategory.objects.create(id=5, name="Generic")
2123.         t1 = Tag.objects.create(name='t1', category=generic)
2124.         t2 = Tag.objects.create(name='t2', category=generic)
2125.         ManagedModel.objects.create(data='mm1', tag=t1, public=True)
2126.         mm2 = ManagedModel.objects.create(data='mm2', tag=t2, public=True)
2127. 
2128.         query = ManagedModel.normal_manager.filter(
2129.             tag__in=Tag.objects.order_by('-id')[:1]
2130.         )
2131.         self.assertEqual({x.id for x in query}, {mm2.id})
2132. 
2133.     def test_sliced_delete(self):
2134.         "Delete queries can safely contain sliced subqueries"
2135.         DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[0:1]).delete()
2136.         self.assertEqual(set(DumbCategory.objects.values_list('id', flat=True)), {1, 2, 3})
2137. 
2138.         DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:2]).delete()
2139.         self.assertEqual(set(DumbCategory.objects.values_list('id', flat=True)), {1, 3})
2140. 
2141.         DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:]).delete()
2142.         self.assertEqual(set(DumbCategory.objects.values_list('id', flat=True)), {3})
2143. 
2144.     def test_distinct_ordered_sliced_subquery(self):
2145.         # Implicit values('id').
2146.         self.assertSequenceEqual(
2147.             NamedCategory.objects.filter(
2148.                 id__in=NamedCategory.objects.distinct().order_by('name')[0:2],
2149.             ).order_by('name').values_list('name', flat=True), ['first', 'fourth']
2150.         )
2151.         # Explicit values('id').
2152.         self.assertSequenceEqual(
2153.             NamedCategory.objects.filter(
2154.                 id__in=NamedCategory.objects.distinct().order_by('-name').values('id')[0:2],
2155.             ).order_by('name').values_list('name', flat=True), ['second', 'third']
2156.         )
2157.         # Annotated value.
2158.         self.assertSequenceEqual(
2159.             DumbCategory.objects.filter(
2160.                 id__in=DumbCategory.objects.annotate(
2161.                     double_id=F('id') * 2
2162.                 ).order_by('id').distinct().values('double_id')[0:2],
2163.             ).order_by('id').values_list('id', flat=True), [2, 4]
2164.         )
2165. 
2166. 
2167. @skipUnlessDBFeature('allow_sliced_subqueries_with_in')
2168. class QuerySetBitwiseOperationTests(TestCase):
2169.     @classmethod
2170.     def setUpTestData(cls):
2171.         school = School.objects.create()
2172.         cls.room_1 = Classroom.objects.create(school=school, has_blackboard=False, name='Room 1')
2173.         cls.room_2 = Classroom.objects.create(school=school, has_blackboard=True, name='Room 2')
2174.         cls.room_3 = Classroom.objects.create(school=school, has_blackboard=True, name='Room 3')
2175.         cls.room_4 = Classroom.objects.create(school=school, has_blackboard=False, name='Room 4')
2176. 
2177.     def test_or_with_rhs_slice(self):
2178.         qs1 = Classroom.objects.filter(has_blackboard=True)
2179.         qs2 = Classroom.objects.filter(has_blackboard=False)[:1]
2180.         self.assertCountEqual(qs1 | qs2, [self.room_1, self.room_2, self.room_3])
2181. 
2182.     def test_or_with_lhs_slice(self):
2183.         qs1 = Classroom.objects.filter(has_blackboard=True)[:1]
2184.         qs2 = Classroom.objects.filter(has_blackboard=False)
2185.         self.assertCountEqual(qs1 | qs2, [self.room_1, self.room_2, self.room_4])
2186. 
2187.     def test_or_with_both_slice(self):
2188.         qs1 = Classroom.objects.filter(has_blackboard=False)[:1]
2189.         qs2 = Classroom.objects.filter(has_blackboard=True)[:1]
2190.         self.assertCountEqual(qs1 | qs2, [self.room_1, self.room_2])
2191. 
2192.     def test_or_with_both_slice_and_ordering(self):
2193.         qs1 = Classroom.objects.filter(has_blackboard=False).order_by('-pk')[:1]
2194.         qs2 = Classroom.objects.filter(has_blackboard=True).order_by('-name')[:1]
2195.         self.assertCountEqual(qs1 | qs2, [self.room_3, self.room_4])
2196. 
2197. 
2198. class CloneTests(TestCase):
2199. 
2200.     def test_evaluated_queryset_as_argument(self):
2201.         "#13227 -- If a queryset is already evaluated, it can still be used as a query arg"
2202.         n = Note(note='Test1', misc='misc')
2203.         n.save()
2204.         e = ExtraInfo(info='good', note=n)
2205.         e.save()
2206. 
2207.         n_list = Note.objects.all()
2208.         # Evaluate the Note queryset, populating the query cache
2209.         list(n_list)
2210.         # Make one of cached results unpickable.
2211.         n_list._result_cache[0].lock = Lock()
2212.         with self.assertRaises(TypeError):
2213.             pickle.dumps(n_list)
2214.         # Use the note queryset in a query, and evaluate
2215.         # that query in a way that involves cloning.
2216.         self.assertEqual(ExtraInfo.objects.filter(note__in=n_list)[0].info, 'good')
2217. 
2218.     def test_no_model_options_cloning(self):
2219.         """
2220.         Cloning a queryset does not get out of hand. While complete
2221.         testing is impossible, this is a sanity check against invalid use of
2222.         deepcopy. refs #16759.
2223.         """
2224.         opts_class = type(Note._meta)
2225.         note_deepcopy = getattr(opts_class, "__deepcopy__", None)
2226.         opts_class.__deepcopy__ = lambda obj, memo: self.fail("Model options shouldn't be cloned.")
2227.         try:
2228.             Note.objects.filter(pk__lte=F('pk') + 1).all()
2229.         finally:
2230.             if note_deepcopy is None:
2231.                 delattr(opts_class, "__deepcopy__")
2232.             else:
2233.                 opts_class.__deepcopy__ = note_deepcopy
2234. 
2235.     def test_no_fields_cloning(self):
2236.         """
2237.         Cloning a queryset does not get out of hand. While complete
2238.         testing is impossible, this is a sanity check against invalid use of
2239.         deepcopy. refs #16759.
2240.         """
2241.         opts_class = type(Note._meta.get_field("misc"))
2242.         note_deepcopy = getattr(opts_class, "__deepcopy__", None)
2243.         opts_class.__deepcopy__ = lambda obj, memo: self.fail("Model fields shouldn't be cloned")
2244.         try:
2245.             Note.objects.filter(note=F('misc')).all()
2246.         finally:
2247.             if note_deepcopy is None:
2248.                 delattr(opts_class, "__deepcopy__")
2249.             else:
2250.                 opts_class.__deepcopy__ = note_deepcopy
2251. 
2252. 
2253. class EmptyQuerySetTests(SimpleTestCase):
2254.     def test_emptyqueryset_values(self):
2255.         # #14366 -- Calling .values() on an empty QuerySet and then cloning
2256.         # that should not cause an error
2257.         self.assertCountEqual(Number.objects.none().values('num').order_by('num'), [])
2258. 
2259.     def test_values_subquery(self):
2260.         self.assertCountEqual(Number.objects.filter(pk__in=Number.objects.none().values('pk')), [])
2261.         self.assertCountEqual(Number.objects.filter(pk__in=Number.objects.none().values_list('pk')), [])
2262. 
2263.     def test_ticket_19151(self):
2264.         # #19151 -- Calling .values() or .values_list() on an empty QuerySet
2265.         # should return an empty QuerySet and not cause an error.
2266.         q = Author.objects.none()
2267.         self.assertCountEqual(q.values(), [])
2268.         self.assertCountEqual(q.values_list(), [])
2269. 
2270. 
2271. class ValuesQuerysetTests(TestCase):
2272.     @classmethod
2273.     def setUpTestData(cls):
2274.         Number.objects.create(num=72)
2275. 
2276.     def test_flat_values_list(self):
2277.         qs = Number.objects.values_list("num")
2278.         qs = qs.values_list("num", flat=True)
2279.         self.assertSequenceEqual(qs, [72])
2280. 
2281.     def test_extra_values(self):
2282.         # testing for ticket 14930 issues
2283.         qs = Number.objects.extra(select={'value_plus_x': 'num+%s', 'value_minus_x': 'num-%s'}, select_params=(1, 2))
2284.         qs = qs.order_by('value_minus_x')
2285.         qs = qs.values('num')
2286.         self.assertSequenceEqual(qs, [{'num': 72}])
2287. 
2288.     def test_extra_values_order_twice(self):
2289.         # testing for ticket 14930 issues
2290.         qs = Number.objects.extra(select={'value_plus_one': 'num+1', 'value_minus_one': 'num-1'})
2291.         qs = qs.order_by('value_minus_one').order_by('value_plus_one')
2292.         qs = qs.values('num')
2293.         self.assertSequenceEqual(qs, [{'num': 72}])
2294. 
2295.     def test_extra_values_order_multiple(self):
2296.         # Postgres doesn't allow constants in order by, so check for that.
2297.         qs = Number.objects.extra(select={
2298.             'value_plus_one': 'num+1',
2299.             'value_minus_one': 'num-1',
2300.             'constant_value': '1'
2301.         })
2302.         qs = qs.order_by('value_plus_one', 'value_minus_one', 'constant_value')
2303.         qs = qs.values('num')
2304.         self.assertSequenceEqual(qs, [{'num': 72}])
2305. 
2306.     def test_extra_values_order_in_extra(self):
2307.         # testing for ticket 14930 issues
2308.         qs = Number.objects.extra(
2309.             select={'value_plus_one': 'num+1', 'value_minus_one': 'num-1'},
2310.             order_by=['value_minus_one'],
2311.         )
2312.         qs = qs.values('num')
2313. 
2314.     def test_extra_select_params_values_order_in_extra(self):
2315.         # testing for 23259 issue
2316.         qs = Number.objects.extra(
2317.             select={'value_plus_x': 'num+%s'},
2318.             select_params=[1],
2319.             order_by=['value_plus_x'],
2320.         )
2321.         qs = qs.filter(num=72)
2322.         qs = qs.values('num')
2323.         self.assertSequenceEqual(qs, [{'num': 72}])
2324. 
2325.     def test_extra_multiple_select_params_values_order_by(self):
2326.         # testing for 23259 issue
2327.         qs = Number.objects.extra(select={'value_plus_x': 'num+%s', 'value_minus_x': 'num-%s'}, select_params=(72, 72))
2328.         qs = qs.order_by('value_minus_x')
2329.         qs = qs.filter(num=1)
2330.         qs = qs.values('num')
2331.         self.assertSequenceEqual(qs, [])
2332. 
2333.     def test_extra_values_list(self):
2334.         # testing for ticket 14930 issues
2335.         qs = Number.objects.extra(select={'value_plus_one': 'num+1'})
2336.         qs = qs.order_by('value_plus_one')
2337.         qs = qs.values_list('num')
2338.         self.assertSequenceEqual(qs, [(72,)])
2339. 
2340.     def test_flat_extra_values_list(self):
2341.         # testing for ticket 14930 issues
2342.         qs = Number.objects.extra(select={'value_plus_one': 'num+1'})
2343.         qs = qs.order_by('value_plus_one')
2344.         qs = qs.values_list('num', flat=True)
2345.         self.assertSequenceEqual(qs, [72])
2346. 
2347.     def test_field_error_values_list(self):
2348.         # see #23443
2349.         msg = "Cannot resolve keyword %r into field. Join on 'name' not permitted." % 'foo'
2350.         with self.assertRaisesMessage(FieldError, msg):
2351.             Tag.objects.values_list('name__foo')
2352. 
2353.     def test_named_values_list_flat(self):
2354.         msg = "'flat' and 'named' can't be used together."
2355.         with self.assertRaisesMessage(TypeError, msg):
2356.             Number.objects.values_list('num', flat=True, named=True)
2357. 
2358.     def test_named_values_list_bad_field_name(self):
2359.         msg = "Type names and field names must be valid identifiers: '1'"
2360.         with self.assertRaisesMessage(ValueError, msg):
2361.             Number.objects.extra(select={'1': 'num+1'}).values_list('1', named=True).first()
2362. 
2363.     def test_named_values_list_with_fields(self):
2364.         qs = Number.objects.extra(select={'num2': 'num+1'}).annotate(Count('id'))
2365.         values = qs.values_list('num', 'num2', named=True).first()
2366.         self.assertEqual(type(values).__name__, 'Row')
2367.         self.assertEqual(values._fields, ('num', 'num2'))
2368.         self.assertEqual(values.num, 72)
2369.         self.assertEqual(values.num2, 73)
2370. 
2371.     def test_named_values_list_without_fields(self):
2372.         qs = Number.objects.extra(select={'num2': 'num+1'}).annotate(Count('id'))
2373.         values = qs.values_list(named=True).first()
2374.         self.assertEqual(type(values).__name__, 'Row')
2375.         self.assertEqual(
2376.             values._fields,
2377.             ('num2', 'id', 'num', 'other_num', 'another_num', 'id__count'),
2378.         )
2379.         self.assertEqual(values.num, 72)
2380.         self.assertEqual(values.num2, 73)
2381.         self.assertEqual(values.id__count, 1)
2382. 
2383.     def test_named_values_list_expression_with_default_alias(self):
2384.         expr = Count('id')
2385.         values = Number.objects.annotate(id__count1=expr).values_list(expr, 'id__count1', named=True).first()
2386.         self.assertEqual(values._fields, ('id__count2', 'id__count1'))
2387. 
2388.     def test_named_values_list_expression(self):
2389.         expr = F('num') + 1
2390.         qs = Number.objects.annotate(combinedexpression1=expr).values_list(expr, 'combinedexpression1', named=True)
2391.         values = qs.first()
2392.         self.assertEqual(values._fields, ('combinedexpression2', 'combinedexpression1'))
2393. 
2394. 
2395. class QuerySetSupportsPythonIdioms(TestCase):
2396. 
2397.     @classmethod
2398.     def setUpTestData(cls):
2399.         some_date = datetime.datetime(2014, 5, 16, 12, 1)
2400.         for i in range(1, 8):
2401.             Article.objects.create(
2402.                 name="Article {}".format(i), created=some_date)
2403. 
2404.     def get_ordered_articles(self):
2405.         return Article.objects.all().order_by('name')
2406. 
2407.     def test_can_get_items_using_index_and_slice_notation(self):
2408.         self.assertEqual(self.get_ordered_articles()[0].name, 'Article 1')
2409.         self.assertQuerysetEqual(
2410.             self.get_ordered_articles()[1:3],
2411.             ["<Article: Article 2>", "<Article: Article 3>"]
2412.         )
2413. 
2414.     def test_slicing_with_steps_can_be_used(self):
2415.         self.assertQuerysetEqual(
2416.             self.get_ordered_articles()[::2], [
2417.                 "<Article: Article 1>",
2418.                 "<Article: Article 3>",
2419.                 "<Article: Article 5>",
2420.                 "<Article: Article 7>"
2421.             ]
2422.         )
2423. 
2424.     def test_slicing_without_step_is_lazy(self):
2425.         with self.assertNumQueries(0):
2426.             self.get_ordered_articles()[0:5]
2427. 
2428.     def test_slicing_with_tests_is_not_lazy(self):
2429.         with self.assertNumQueries(1):
2430.             self.get_ordered_articles()[0:5:3]
2431. 
2432.     def test_slicing_can_slice_again_after_slicing(self):
2433.         self.assertQuerysetEqual(
2434.             self.get_ordered_articles()[0:5][0:2],
2435.             ["<Article: Article 1>", "<Article: Article 2>"]
2436.         )
2437.         self.assertQuerysetEqual(self.get_ordered_articles()[0:5][4:], ["<Article: Article 5>"])
2438.         self.assertQuerysetEqual(self.get_ordered_articles()[0:5][5:], [])
2439. 
2440.         # Some more tests!
2441.         self.assertQuerysetEqual(
2442.             self.get_ordered_articles()[2:][0:2],
2443.             ["<Article: Article 3>", "<Article: Article 4>"]
2444.         )
2445.         self.assertQuerysetEqual(
2446.             self.get_ordered_articles()[2:][:2],
2447.             ["<Article: Article 3>", "<Article: Article 4>"]
2448.         )
2449.         self.assertQuerysetEqual(self.get_ordered_articles()[2:][2:3], ["<Article: Article 5>"])
2450. 
2451.         # Using an offset without a limit is also possible.
2452.         self.assertQuerysetEqual(
2453.             self.get_ordered_articles()[5:],
2454.             ["<Article: Article 6>", "<Article: Article 7>"]
2455.         )
2456. 
2457.     def test_slicing_cannot_filter_queryset_once_sliced(self):
2458.         with self.assertRaisesMessage(AssertionError, "Cannot filter a query once a slice has been taken."):
2459.             Article.objects.all()[0:5].filter(id=1)
2460. 
2461.     def test_slicing_cannot_reorder_queryset_once_sliced(self):
2462.         with self.assertRaisesMessage(AssertionError, "Cannot reorder a query once a slice has been taken."):
2463.             Article.objects.all()[0:5].order_by('id')
2464. 
2465.     def test_slicing_cannot_combine_queries_once_sliced(self):
2466.         with self.assertRaisesMessage(AssertionError, "Cannot combine queries once a slice has been taken."):
2467.             Article.objects.all()[0:1] & Article.objects.all()[4:5]
2468. 
2469.     def test_slicing_negative_indexing_not_supported_for_single_element(self):
2470.         """hint: inverting your ordering might do what you need"""
2471.         with self.assertRaisesMessage(AssertionError, "Negative indexing is not supported."):
2472.             Article.objects.all()[-1]
2473. 
2474.     def test_slicing_negative_indexing_not_supported_for_range(self):
2475.         """hint: inverting your ordering might do what you need"""
2476.         with self.assertRaisesMessage(AssertionError, "Negative indexing is not supported."):
2477.             Article.objects.all()[0:-5]
2478. 
2479.     def test_invalid_index(self):
2480.         msg = 'QuerySet indices must be integers or slices, not str.'
2481.         with self.assertRaisesMessage(TypeError, msg):
2482.             Article.objects.all()['foo']
2483. 
2484.     def test_can_get_number_of_items_in_queryset_using_standard_len(self):
2485.         self.assertEqual(len(Article.objects.filter(name__exact='Article 1')), 1)
2486. 
2487.     def test_can_combine_queries_using_and_and_or_operators(self):
2488.         s1 = Article.objects.filter(name__exact='Article 1')
2489.         s2 = Article.objects.filter(name__exact='Article 2')
2490.         self.assertQuerysetEqual(
2491.             (s1 | s2).order_by('name'),
2492.             ["<Article: Article 1>", "<Article: Article 2>"]
2493.         )
2494.         self.assertQuerysetEqual(s1 & s2, [])
2495. 
2496. 
2497. class WeirdQuerysetSlicingTests(TestCase):
2498.     @classmethod
2499.     def setUpTestData(cls):
2500.         Number.objects.create(num=1)
2501.         Number.objects.create(num=2)
2502. 
2503.         Article.objects.create(name='one', created=datetime.datetime.now())
2504.         Article.objects.create(name='two', created=datetime.datetime.now())
2505.         Article.objects.create(name='three', created=datetime.datetime.now())
2506.         Article.objects.create(name='four', created=datetime.datetime.now())
2507. 
2508.         food = Food.objects.create(name='spam')
2509.         Eaten.objects.create(meal='spam with eggs', food=food)
2510. 
2511.     def test_tickets_7698_10202(self):
2512.         # People like to slice with '0' as the high-water mark.
2513.         self.assertQuerysetEqual(Article.objects.all()[0:0], [])
2514.         self.assertQuerysetEqual(Article.objects.all()[0:0][:10], [])
2515.         self.assertEqual(Article.objects.all()[:0].count(), 0)
2516.         with self.assertRaisesMessage(TypeError, 'Cannot reverse a query once a slice has been taken.'):
2517.             Article.objects.all()[:0].latest('created')
2518. 
2519.     def test_empty_resultset_sql(self):
2520.         # ticket #12192
2521.         self.assertNumQueries(0, lambda: list(Number.objects.all()[1:1]))
2522. 
2523.     def test_empty_sliced_subquery(self):
2524.         self.assertEqual(Eaten.objects.filter(food__in=Food.objects.all()[0:0]).count(), 0)
2525. 
2526.     def test_empty_sliced_subquery_exclude(self):
2527.         self.assertEqual(Eaten.objects.exclude(food__in=Food.objects.all()[0:0]).count(), 1)
2528. 
2529.     def test_zero_length_values_slicing(self):
2530.         n = 42
2531.         with self.assertNumQueries(0):
2532.             self.assertQuerysetEqual(Article.objects.values()[n:n], [])
2533.             self.assertQuerysetEqual(Article.objects.values_list()[n:n], [])
2534. 
2535. 
2536. class EscapingTests(TestCase):
2537.     def test_ticket_7302(self):
2538.         # Reserved names are appropriately escaped
2539.         ReservedName.objects.create(name='a', order=42)
2540.         ReservedName.objects.create(name='b', order=37)
2541.         self.assertQuerysetEqual(
2542.             ReservedName.objects.all().order_by('order'),
2543.             ['<ReservedName: b>', '<ReservedName: a>']
2544.         )
2545.         self.assertQuerysetEqual(
2546.             ReservedName.objects.extra(select={'stuff': 'name'}, order_by=('order', 'stuff')),
2547.             ['<ReservedName: b>', '<ReservedName: a>']
2548.         )
2549. 
2550. 
2551. class ToFieldTests(TestCase):
2552.     def test_in_query(self):
2553.         apple = Food.objects.create(name="apple")
2554.         pear = Food.objects.create(name="pear")
2555.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2556.         dinner = Eaten.objects.create(food=pear, meal="dinner")
2557. 
2558.         self.assertEqual(
2559.             set(Eaten.objects.filter(food__in=[apple, pear])),
2560.             {lunch, dinner},
2561.         )
2562. 
2563.     def test_in_subquery(self):
2564.         apple = Food.objects.create(name="apple")
2565.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2566.         self.assertEqual(
2567.             set(Eaten.objects.filter(food__in=Food.objects.filter(name='apple'))),
2568.             {lunch}
2569.         )
2570.         self.assertEqual(
2571.             set(Eaten.objects.filter(food__in=Food.objects.filter(name='apple').values('eaten__meal'))),
2572.             set()
2573.         )
2574.         self.assertEqual(
2575.             set(Food.objects.filter(eaten__in=Eaten.objects.filter(meal='lunch'))),
2576.             {apple}
2577.         )
2578. 
2579.     def test_nested_in_subquery(self):
2580.         extra = ExtraInfo.objects.create()
2581.         author = Author.objects.create(num=42, extra=extra)
2582.         report = Report.objects.create(creator=author)
2583.         comment = ReportComment.objects.create(report=report)
2584.         comments = ReportComment.objects.filter(
2585.             report__in=Report.objects.filter(
2586.                 creator__in=extra.author_set.all(),
2587.             ),
2588.         )
2589.         self.assertSequenceEqual(comments, [comment])
2590. 
2591.     def test_reverse_in(self):
2592.         apple = Food.objects.create(name="apple")
2593.         pear = Food.objects.create(name="pear")
2594.         lunch_apple = Eaten.objects.create(food=apple, meal="lunch")
2595.         lunch_pear = Eaten.objects.create(food=pear, meal="dinner")
2596. 
2597.         self.assertEqual(
2598.             set(Food.objects.filter(eaten__in=[lunch_apple, lunch_pear])),
2599.             {apple, pear}
2600.         )
2601. 
2602.     def test_single_object(self):
2603.         apple = Food.objects.create(name="apple")
2604.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2605.         dinner = Eaten.objects.create(food=apple, meal="dinner")
2606. 
2607.         self.assertEqual(
2608.             set(Eaten.objects.filter(food=apple)),
2609.             {lunch, dinner}
2610.         )
2611. 
2612.     def test_single_object_reverse(self):
2613.         apple = Food.objects.create(name="apple")
2614.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2615. 
2616.         self.assertEqual(
2617.             set(Food.objects.filter(eaten=lunch)),
2618.             {apple}
2619.         )
2620. 
2621.     def test_recursive_fk(self):
2622.         node1 = Node.objects.create(num=42)
2623.         node2 = Node.objects.create(num=1, parent=node1)
2624. 
2625.         self.assertEqual(
2626.             list(Node.objects.filter(parent=node1)),
2627.             [node2]
2628.         )
2629. 
2630.     def test_recursive_fk_reverse(self):
2631.         node1 = Node.objects.create(num=42)
2632.         node2 = Node.objects.create(num=1, parent=node1)
2633. 
2634.         self.assertEqual(
2635.             list(Node.objects.filter(node=node2)),
2636.             [node1]
2637.         )
2638. 
2639. 
2640. class IsNullTests(TestCase):
2641.     def test_primary_key(self):
2642.         custom = CustomPk.objects.create(name='pk')
2643.         null = Related.objects.create()
2644.         notnull = Related.objects.create(custom=custom)
2645.         self.assertSequenceEqual(Related.objects.filter(custom__isnull=False), [notnull])
2646.         self.assertSequenceEqual(Related.objects.filter(custom__isnull=True), [null])
2647. 
2648.     def test_to_field(self):
2649.         apple = Food.objects.create(name="apple")
2650.         Eaten.objects.create(food=apple, meal="lunch")
2651.         Eaten.objects.create(meal="lunch")
2652.         self.assertQuerysetEqual(
2653.             Eaten.objects.filter(food__isnull=False),
2654.             ['<Eaten: apple at lunch>']
2655.         )
2656.         self.assertQuerysetEqual(
2657.             Eaten.objects.filter(food__isnull=True),
2658.             ['<Eaten: None at lunch>']
2659.         )
2660. 
2661. 
2662. class ConditionalTests(TestCase):
2663.     """Tests whose execution depend on different environment conditions like
2664.     Python version or DB backend features"""
2665. 
2666.     @classmethod
2667.     def setUpTestData(cls):
2668.         generic = NamedCategory.objects.create(name="Generic")
2669.         t1 = Tag.objects.create(name='t1', category=generic)
2670.         Tag.objects.create(name='t2', parent=t1, category=generic)
2671.         t3 = Tag.objects.create(name='t3', parent=t1)
2672.         Tag.objects.create(name='t4', parent=t3)
2673.         Tag.objects.create(name='t5', parent=t3)
2674. 
2675.     def test_infinite_loop(self):
2676.         # If you're not careful, it's possible to introduce infinite loops via
2677.         # default ordering on foreign keys in a cycle. We detect that.
2678.         with self.assertRaisesMessage(FieldError, 'Infinite loop caused by ordering.'):
2679.             list(LoopX.objects.all())  # Force queryset evaluation with list()
2680.         with self.assertRaisesMessage(FieldError, 'Infinite loop caused by ordering.'):
2681.             list(LoopZ.objects.all())  # Force queryset evaluation with list()
2682. 
2683.         # Note that this doesn't cause an infinite loop, since the default
2684.         # ordering on the Tag model is empty (and thus defaults to using "id"
2685.         # for the related field).
2686.         self.assertEqual(len(Tag.objects.order_by('parent')), 5)
2687. 
2688.         # ... but you can still order in a non-recursive fashion among linked
2689.         # fields (the previous test failed because the default ordering was
2690.         # recursive).
2691.         self.assertQuerysetEqual(
2692.             LoopX.objects.all().order_by('y__x__y__x__id'),
2693.             []
2694.         )
2695. 
2696.     # When grouping without specifying ordering, we add an explicit "ORDER BY NULL"
2697.     # portion in MySQL to prevent unnecessary sorting.
2698.     @skipUnlessDBFeature('requires_explicit_null_ordering_when_grouping')
2699.     def test_null_ordering_added(self):
2700.         query = Tag.objects.values_list('parent_id', flat=True).order_by().query
2701.         query.group_by = ['parent_id']
2702.         sql = query.get_compiler(DEFAULT_DB_ALIAS).as_sql()[0]
2703.         fragment = "ORDER BY "
2704.         pos = sql.find(fragment)
2705.         self.assertEqual(sql.find(fragment, pos + 1), -1)
2706.         self.assertEqual(sql.find("NULL", pos + len(fragment)), pos + len(fragment))
2707. 
2708.     def test_in_list_limit(self):
2709.         # The "in" lookup works with lists of 1000 items or more.
2710.         # The numbers amount is picked to force three different IN batches
2711.         # for Oracle, yet to be less than 2100 parameter limit for MSSQL.
2712.         numbers = list(range(2050))
2713.         max_query_params = connection.features.max_query_params
2714.         if max_query_params is None or max_query_params >= len(numbers):
2715.             Number.objects.bulk_create(Number(num=num) for num in numbers)
2716.             for number in [1000, 1001, 2000, len(numbers)]:
2717.                 with self.subTest(number=number):
2718.                     self.assertEqual(Number.objects.filter(num__in=numbers[:number]).count(), number)
2719. 
2720. 
2721. class UnionTests(unittest.TestCase):
2722.     """
2723.     Tests for the union of two querysets. Bug #12252.
2724.     """
2725.     @classmethod
2726.     def setUpTestData(cls):
2727.         objectas = []
2728.         objectbs = []
2729.         objectcs = []
2730.         a_info = ['one', 'two', 'three']
2731.         for name in a_info:
2732.             o = ObjectA(name=name)
2733.             o.save()
2734.             objectas.append(o)
2735.         b_info = [('un', 1, objectas[0]), ('deux', 2, objectas[0]), ('trois', 3, objectas[2])]
2736.         for name, number, objecta in b_info:
2737.             o = ObjectB(name=name, num=number, objecta=objecta)
2738.             o.save()
2739.             objectbs.append(o)
2740.         c_info = [('ein', objectas[2], objectbs[2]), ('zwei', objectas[1], objectbs[1])]
2741.         for name, objecta, objectb in c_info:
2742.             o = ObjectC(name=name, objecta=objecta, objectb=objectb)
2743.             o.save()
2744.             objectcs.append(o)
2745. 
2746.     def check_union(self, model, Q1, Q2):
2747.         filter = model.objects.filter
2748.         self.assertEqual(set(filter(Q1) | filter(Q2)), set(filter(Q1 | Q2)))
2749.         self.assertEqual(set(filter(Q2) | filter(Q1)), set(filter(Q1 | Q2)))
2750. 
2751.     def test_A_AB(self):
2752.         Q1 = Q(name='two')
2753.         Q2 = Q(objectb__name='deux')
2754.         self.check_union(ObjectA, Q1, Q2)
2755. 
2756.     def test_A_AB2(self):
2757.         Q1 = Q(name='two')
2758.         Q2 = Q(objectb__name='deux', objectb__num=2)
2759.         self.check_union(ObjectA, Q1, Q2)
2760. 
2761.     def test_AB_ACB(self):
2762.         Q1 = Q(objectb__name='deux')
2763.         Q2 = Q(objectc__objectb__name='deux')
2764.         self.check_union(ObjectA, Q1, Q2)
2765. 
2766.     def test_BAB_BAC(self):
2767.         Q1 = Q(objecta__objectb__name='deux')
2768.         Q2 = Q(objecta__objectc__name='ein')
2769.         self.check_union(ObjectB, Q1, Q2)
2770. 
2771.     def test_BAB_BACB(self):
2772.         Q1 = Q(objecta__objectb__name='deux')
2773.         Q2 = Q(objecta__objectc__objectb__name='trois')
2774.         self.check_union(ObjectB, Q1, Q2)
2775. 
2776.     def test_BA_BCA__BAB_BAC_BCA(self):
2777.         Q1 = Q(objecta__name='one', objectc__objecta__name='two')
2778.         Q2 = Q(objecta__objectc__name='ein', objectc__objecta__name='three', objecta__objectb__name='trois')
2779.         self.check_union(ObjectB, Q1, Q2)
2780. 
2781. 
2782. class DefaultValuesInsertTest(TestCase):
2783.     def test_no_extra_params(self):
2784.         """
2785.         Can create an instance of a model with only the PK field (#17056)."
2786.         """
2787.         DumbCategory.objects.create()
2788. 
2789. 
2790. class ExcludeTests(TestCase):
2791.     @classmethod
2792.     def setUpTestData(cls):
2793.         f1 = Food.objects.create(name='apples')
2794.         Food.objects.create(name='oranges')
2795.         Eaten.objects.create(food=f1, meal='dinner')
2796.         j1 = Job.objects.create(name='Manager')
2797.         cls.r1 = Responsibility.objects.create(description='Playing golf')
2798.         j2 = Job.objects.create(name='Programmer')
2799.         r2 = Responsibility.objects.create(description='Programming')
2800.         JobResponsibilities.objects.create(job=j1, responsibility=cls.r1)
2801.         JobResponsibilities.objects.create(job=j2, responsibility=r2)
2802. 
2803.     def test_to_field(self):
2804.         self.assertQuerysetEqual(
2805.             Food.objects.exclude(eaten__meal='dinner'),
2806.             ['<Food: oranges>'])
2807.         self.assertQuerysetEqual(
2808.             Job.objects.exclude(responsibilities__description='Playing golf'),
2809.             ['<Job: Programmer>'])
2810.         self.assertQuerysetEqual(
2811.             Responsibility.objects.exclude(jobs__name='Manager'),
2812.             ['<Responsibility: Programming>'])
2813. 
2814.     def test_ticket14511(self):
2815.         alex = Person.objects.get_or_create(name='Alex')[0]
2816.         jane = Person.objects.get_or_create(name='Jane')[0]
2817. 
2818.         oracle = Company.objects.get_or_create(name='Oracle')[0]
2819.         google = Company.objects.get_or_create(name='Google')[0]
2820.         microsoft = Company.objects.get_or_create(name='Microsoft')[0]
2821.         intel = Company.objects.get_or_create(name='Intel')[0]
2822. 
2823.         def employ(employer, employee, title):
2824.             Employment.objects.get_or_create(employee=employee, employer=employer, title=title)
2825. 
2826.         employ(oracle, alex, 'Engineer')
2827.         employ(oracle, alex, 'Developer')
2828.         employ(google, alex, 'Engineer')
2829.         employ(google, alex, 'Manager')
2830.         employ(microsoft, alex, 'Manager')
2831.         employ(intel, alex, 'Manager')
2832. 
2833.         employ(microsoft, jane, 'Developer')
2834.         employ(intel, jane, 'Manager')
2835. 
2836.         alex_tech_employers = alex.employers.filter(
2837.             employment__title__in=('Engineer', 'Developer')).distinct().order_by('name')
2838.         self.assertSequenceEqual(alex_tech_employers, [google, oracle])
2839. 
2840.         alex_nontech_employers = alex.employers.exclude(
2841.             employment__title__in=('Engineer', 'Developer')).distinct().order_by('name')
2842.         self.assertSequenceEqual(alex_nontech_employers, [google, intel, microsoft])
2843. 
2844.     def test_exclude_reverse_fk_field_ref(self):
2845.         tag = Tag.objects.create()
2846.         Note.objects.create(tag=tag, note='note')
2847.         annotation = Annotation.objects.create(name='annotation', tag=tag)
2848.         self.assertEqual(Annotation.objects.exclude(tag__note__note=F('name')).get(), annotation)
2849. 
2850.     def test_exclude_with_circular_fk_relation(self):
2851.         self.assertEqual(ObjectB.objects.exclude(objecta__objectb__name=F('name')).count(), 0)
2852. 
2853.     def test_subquery_exclude_outerref(self):
2854.         qs = JobResponsibilities.objects.filter(
2855.             Exists(Responsibility.objects.exclude(jobs=OuterRef('job'))),
2856.         )
2857.         self.assertTrue(qs.exists())
2858.         self.r1.delete()
2859.         self.assertFalse(qs.exists())
2860. 
2861.     def test_exclude_nullable_fields(self):
2862.         number = Number.objects.create(num=1, other_num=1)
2863.         Number.objects.create(num=2, other_num=2, another_num=2)
2864.         self.assertSequenceEqual(
2865.             Number.objects.exclude(other_num=F('another_num')),
2866.             [number],
2867.         )
2868.         self.assertSequenceEqual(
2869.             Number.objects.exclude(num=F('another_num')),
2870.             [number],
2871.         )
2872. 
2873. 
2874. class ExcludeTest17600(TestCase):
2875.     """
2876.     Some regressiontests for ticket #17600. Some of these likely duplicate
2877.     other existing tests.
2878.     """
2879.     @classmethod
2880.     def setUpTestData(cls):
2881.         # Create a few Orders.
2882.         cls.o1 = Order.objects.create(pk=1)
2883.         cls.o2 = Order.objects.create(pk=2)
2884.         cls.o3 = Order.objects.create(pk=3)
2885. 
2886.         # Create some OrderItems for the first order with homogeneous
2887.         # status_id values
2888.         cls.oi1 = OrderItem.objects.create(order=cls.o1, status=1)
2889.         cls.oi2 = OrderItem.objects.create(order=cls.o1, status=1)
2890.         cls.oi3 = OrderItem.objects.create(order=cls.o1, status=1)
2891. 
2892.         # Create some OrderItems for the second order with heterogeneous
2893.         # status_id values
2894.         cls.oi4 = OrderItem.objects.create(order=cls.o2, status=1)
2895.         cls.oi5 = OrderItem.objects.create(order=cls.o2, status=2)
2896.         cls.oi6 = OrderItem.objects.create(order=cls.o2, status=3)
2897. 
2898.         # Create some OrderItems for the second order with heterogeneous
2899.         # status_id values
2900.         cls.oi7 = OrderItem.objects.create(order=cls.o3, status=2)
2901.         cls.oi8 = OrderItem.objects.create(order=cls.o3, status=3)
2902.         cls.oi9 = OrderItem.objects.create(order=cls.o3, status=4)
2903. 
2904.     def test_exclude_plain(self):
2905.         """
2906.         This should exclude Orders which have some items with status 1
2907.         """
2908.         self.assertQuerysetEqual(
2909.             Order.objects.exclude(items__status=1),
2910.             ['<Order: 3>'])
2911. 
2912.     def test_exclude_plain_distinct(self):
2913.         """
2914.         This should exclude Orders which have some items with status 1
2915.         """
2916.         self.assertQuerysetEqual(
2917.             Order.objects.exclude(items__status=1).distinct(),
2918.             ['<Order: 3>'])
2919. 
2920.     def test_exclude_with_q_object_distinct(self):
2921.         """
2922.         This should exclude Orders which have some items with status 1
2923.         """
2924.         self.assertQuerysetEqual(
2925.             Order.objects.exclude(Q(items__status=1)).distinct(),
2926.             ['<Order: 3>'])
2927. 
2928.     def test_exclude_with_q_object_no_distinct(self):
2929.         """
2930.         This should exclude Orders which have some items with status 1
2931.         """
2932.         self.assertQuerysetEqual(
2933.             Order.objects.exclude(Q(items__status=1)),
2934.             ['<Order: 3>'])
2935. 
2936.     def test_exclude_with_q_is_equal_to_plain_exclude(self):
2937.         """
2938.         Using exclude(condition) and exclude(Q(condition)) should
2939.         yield the same QuerySet
2940.         """
2941.         self.assertEqual(
2942.             list(Order.objects.exclude(items__status=1).distinct()),
2943.             list(Order.objects.exclude(Q(items__status=1)).distinct()))
2944. 
2945.     def test_exclude_with_q_is_equal_to_plain_exclude_variation(self):
2946.         """
2947.         Using exclude(condition) and exclude(Q(condition)) should
2948.         yield the same QuerySet
2949.         """
2950.         self.assertEqual(
2951.             list(Order.objects.exclude(items__status=1)),
2952.             list(Order.objects.exclude(Q(items__status=1)).distinct()))
2953. 
2954.     @unittest.expectedFailure
2955.     def test_only_orders_with_all_items_having_status_1(self):
2956.         """
2957.         This should only return orders having ALL items set to status 1, or
2958.         those items not having any orders at all. The correct way to write
2959.         this query in SQL seems to be using two nested subqueries.
2960.         """
2961.         self.assertQuerysetEqual(
2962.             Order.objects.exclude(~Q(items__status=1)).distinct(),
2963.             ['<Order: 1>'])
2964. 
2965. 
2966. class Exclude15786(TestCase):
2967.     """Regression test for #15786"""
2968.     def test_ticket15786(self):
2969.         c1 = SimpleCategory.objects.create(name='c1')
2970.         c2 = SimpleCategory.objects.create(name='c2')
2971.         OneToOneCategory.objects.create(category=c1)
2972.         OneToOneCategory.objects.create(category=c2)
2973.         rel = CategoryRelationship.objects.create(first=c1, second=c2)
2974.         self.assertEqual(
2975.             CategoryRelationship.objects.exclude(
2976.                 first__onetoonecategory=F('second__onetoonecategory')
2977.             ).get(), rel
2978.         )
2979. 
2980. 
2981. class NullInExcludeTest(TestCase):
2982.     @classmethod
2983.     def setUpTestData(cls):
2984.         NullableName.objects.create(name='i1')
2985.         NullableName.objects.create()
2986. 
2987.     def test_null_in_exclude_qs(self):
2988.         none_val = '' if connection.features.interprets_empty_strings_as_nulls else None
2989.         self.assertQuerysetEqual(
2990.             NullableName.objects.exclude(name__in=[]),
2991.             ['i1', none_val], attrgetter('name'))
2992.         self.assertQuerysetEqual(
2993.             NullableName.objects.exclude(name__in=['i1']),
2994.             [none_val], attrgetter('name'))
2995.         self.assertQuerysetEqual(
2996.             NullableName.objects.exclude(name__in=['i3']),
2997.             ['i1', none_val], attrgetter('name'))
2998.         inner_qs = NullableName.objects.filter(name='i1').values_list('name')
2999.         self.assertQuerysetEqual(
3000.             NullableName.objects.exclude(name__in=inner_qs),
3001.             [none_val], attrgetter('name'))
3002.         # The inner queryset wasn't executed - it should be turned
3003.         # into subquery above
3004.         self.assertIs(inner_qs._result_cache, None)
3005. 
3006.     @unittest.expectedFailure
3007.     def test_col_not_in_list_containing_null(self):
3008.         """
3009.         The following case is not handled properly because
3010.         SQL's COL NOT IN (list containing null) handling is too weird to
3011.         abstract away.
3012.         """
3013.         self.assertQuerysetEqual(
3014.             NullableName.objects.exclude(name__in=[None]),
3015.             ['i1'], attrgetter('name'))
3016. 
3017.     def test_double_exclude(self):
3018.         self.assertEqual(
3019.             list(NullableName.objects.filter(~~Q(name='i1'))),
3020.             list(NullableName.objects.filter(Q(name='i1'))))
3021.         self.assertNotIn(
3022.             'IS NOT NULL',
3023.             str(NullableName.objects.filter(~~Q(name='i1')).query))
3024. 
3025. 
3026. class EmptyStringsAsNullTest(TestCase):
3027.     """
3028.     Filtering on non-null character fields works as expected.
3029.     The reason for these tests is that Oracle treats '' as NULL, and this
3030.     can cause problems in query construction. Refs #17957.
3031.     """
3032.     @classmethod
3033.     def setUpTestData(cls):
3034.         cls.nc = NamedCategory.objects.create(name='')
3035. 
3036.     def test_direct_exclude(self):
3037.         self.assertQuerysetEqual(
3038.             NamedCategory.objects.exclude(name__in=['nonexistent']),
3039.             [self.nc.pk], attrgetter('pk')
3040.         )
3041. 
3042.     def test_joined_exclude(self):
3043.         self.assertQuerysetEqual(
3044.             DumbCategory.objects.exclude(namedcategory__name__in=['nonexistent']),
3045.             [self.nc.pk], attrgetter('pk')
3046.         )
3047. 
3048.     def test_21001(self):
3049.         foo = NamedCategory.objects.create(name='foo')
3050.         self.assertQuerysetEqual(
3051.             NamedCategory.objects.exclude(name=''),
3052.             [foo.pk], attrgetter('pk')
3053.         )
3054. 
3055. 
3056. class ProxyQueryCleanupTest(TestCase):
3057.     def test_evaluated_proxy_count(self):
3058.         """
3059.         Generating the query string doesn't alter the query's state
3060.         in irreversible ways. Refs #18248.
3061.         """
3062.         ProxyCategory.objects.create()
3063.         qs = ProxyCategory.objects.all()
3064.         self.assertEqual(qs.count(), 1)
3065.         str(qs.query)
3066.         self.assertEqual(qs.count(), 1)
3067. 
3068. 
3069. class WhereNodeTest(SimpleTestCase):
3070.     class DummyNode:
3071.         def as_sql(self, compiler, connection):
3072.             return 'dummy', []
3073. 
3074.     class MockCompiler:
3075.         def compile(self, node):
3076.             return node.as_sql(self, connection)
3077. 
3078.         def __call__(self, name):
3079.             return connection.ops.quote_name(name)
3080. 
3081.     def test_empty_full_handling_conjunction(self):
3082.         compiler = WhereNodeTest.MockCompiler()
3083.         w = WhereNode(children=[NothingNode()])
3084.         with self.assertRaises(EmptyResultSet):
3085.             w.as_sql(compiler, connection)
3086.         w.negate()
3087.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3088.         w = WhereNode(children=[self.DummyNode(), self.DummyNode()])
3089.         self.assertEqual(w.as_sql(compiler, connection), ('(dummy AND dummy)', []))
3090.         w.negate()
3091.         self.assertEqual(w.as_sql(compiler, connection), ('NOT (dummy AND dummy)', []))
3092.         w = WhereNode(children=[NothingNode(), self.DummyNode()])
3093.         with self.assertRaises(EmptyResultSet):
3094.             w.as_sql(compiler, connection)
3095.         w.negate()
3096.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3097. 
3098.     def test_empty_full_handling_disjunction(self):
3099.         compiler = WhereNodeTest.MockCompiler()
3100.         w = WhereNode(children=[NothingNode()], connector='OR')
3101.         with self.assertRaises(EmptyResultSet):
3102.             w.as_sql(compiler, connection)
3103.         w.negate()
3104.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3105.         w = WhereNode(children=[self.DummyNode(), self.DummyNode()], connector='OR')
3106.         self.assertEqual(w.as_sql(compiler, connection), ('(dummy OR dummy)', []))
3107.         w.negate()
3108.         self.assertEqual(w.as_sql(compiler, connection), ('NOT (dummy OR dummy)', []))
3109.         w = WhereNode(children=[NothingNode(), self.DummyNode()], connector='OR')
3110.         self.assertEqual(w.as_sql(compiler, connection), ('dummy', []))
3111.         w.negate()
3112.         self.assertEqual(w.as_sql(compiler, connection), ('NOT (dummy)', []))
3113. 
3114.     def test_empty_nodes(self):
3115.         compiler = WhereNodeTest.MockCompiler()
3116.         empty_w = WhereNode()
3117.         w = WhereNode(children=[empty_w, empty_w])
3118.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3119.         w.negate()
3120.         with self.assertRaises(EmptyResultSet):
3121.             w.as_sql(compiler, connection)
3122.         w.connector = 'OR'
3123.         with self.assertRaises(EmptyResultSet):
3124.             w.as_sql(compiler, connection)
3125.         w.negate()
3126.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3127.         w = WhereNode(children=[empty_w, NothingNode()], connector='OR')
3128.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3129.         w = WhereNode(children=[empty_w, NothingNode()], connector='AND')
3130.         with self.assertRaises(EmptyResultSet):
3131.             w.as_sql(compiler, connection)
3132. 
3133. 
3134. class QuerySetExceptionTests(SimpleTestCase):
3135.     def test_iter_exceptions(self):
3136.         qs = ExtraInfo.objects.only('author')
3137.         msg = "'ManyToOneRel' object has no attribute 'attname'"
3138.         with self.assertRaisesMessage(AttributeError, msg):
3139.             list(qs)
3140. 
3141.     def test_invalid_order_by(self):
3142.         msg = (
3143.             "Cannot resolve keyword '*' into field. Choices are: created, id, "
3144.             "name"
3145.         )
3146.         with self.assertRaisesMessage(FieldError, msg):
3147.             Article.objects.order_by('*')
3148. 
3149.     def test_invalid_queryset_model(self):
3150.         msg = 'Cannot use QuerySet for "Article": Use a QuerySet for "ExtraInfo".'
3151.         with self.assertRaisesMessage(ValueError, msg):
3152.             list(Author.objects.filter(extra=Article.objects.all()))
3153. 
3154. 
3155. class NullJoinPromotionOrTest(TestCase):
3156.     @classmethod
3157.     def setUpTestData(cls):
3158.         cls.d1 = ModelD.objects.create(name='foo')
3159.         d2 = ModelD.objects.create(name='bar')
3160.         cls.a1 = ModelA.objects.create(name='a1', d=cls.d1)
3161.         c = ModelC.objects.create(name='c')
3162.         b = ModelB.objects.create(name='b', c=c)
3163.         cls.a2 = ModelA.objects.create(name='a2', b=b, d=d2)
3164. 
3165.     def test_ticket_17886(self):
3166.         # The first Q-object is generating the match, the rest of the filters
3167.         # should not remove the match even if they do not match anything. The
3168.         # problem here was that b__name generates a LOUTER JOIN, then
3169.         # b__c__name generates join to c, which the ORM tried to promote but
3170.         # failed as that join isn't nullable.
3171.         q_obj = (
3172.             Q(d__name='foo') |
3173.             Q(b__name='foo') |
3174.             Q(b__c__name='foo')
3175.         )
3176.         qset = ModelA.objects.filter(q_obj)
3177.         self.assertEqual(list(qset), [self.a1])
3178.         # We generate one INNER JOIN to D. The join is direct and not nullable
3179.         # so we can use INNER JOIN for it. However, we can NOT use INNER JOIN
3180.         # for the b->c join, as a->b is nullable.
3181.         self.assertEqual(str(qset.query).count('INNER JOIN'), 1)
3182. 
3183.     def test_isnull_filter_promotion(self):
3184.         qs = ModelA.objects.filter(Q(b__name__isnull=True))
3185.         self.assertEqual(str(qs.query).count('LEFT OUTER'), 1)
3186.         self.assertEqual(list(qs), [self.a1])
3187. 
3188.         qs = ModelA.objects.filter(~Q(b__name__isnull=True))
3189.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3190.         self.assertEqual(list(qs), [self.a2])
3191. 
3192.         qs = ModelA.objects.filter(~~Q(b__name__isnull=True))
3193.         self.assertEqual(str(qs.query).count('LEFT OUTER'), 1)
3194.         self.assertEqual(list(qs), [self.a1])
3195. 
3196.         qs = ModelA.objects.filter(Q(b__name__isnull=False))
3197.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3198.         self.assertEqual(list(qs), [self.a2])
3199. 
3200.         qs = ModelA.objects.filter(~Q(b__name__isnull=False))
3201.         self.assertEqual(str(qs.query).count('LEFT OUTER'), 1)
3202.         self.assertEqual(list(qs), [self.a1])
3203. 
3204.         qs = ModelA.objects.filter(~~Q(b__name__isnull=False))
3205.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3206.         self.assertEqual(list(qs), [self.a2])
3207. 
3208.     def test_null_join_demotion(self):
3209.         qs = ModelA.objects.filter(Q(b__name__isnull=False) & Q(b__name__isnull=True))
3210.         self.assertIn(' INNER JOIN ', str(qs.query))
3211.         qs = ModelA.objects.filter(Q(b__name__isnull=True) & Q(b__name__isnull=False))
3212.         self.assertIn(' INNER JOIN ', str(qs.query))
3213.         qs = ModelA.objects.filter(Q(b__name__isnull=False) | Q(b__name__isnull=True))
3214.         self.assertIn(' LEFT OUTER JOIN ', str(qs.query))
3215.         qs = ModelA.objects.filter(Q(b__name__isnull=True) | Q(b__name__isnull=False))
3216.         self.assertIn(' LEFT OUTER JOIN ', str(qs.query))
3217. 
3218.     def test_ticket_21366(self):
3219.         n = Note.objects.create(note='n', misc='m')
3220.         e = ExtraInfo.objects.create(info='info', note=n)
3221.         a = Author.objects.create(name='Author1', num=1, extra=e)
3222.         Ranking.objects.create(rank=1, author=a)
3223.         r1 = Report.objects.create(name='Foo', creator=a)
3224.         r2 = Report.objects.create(name='Bar')
3225.         Report.objects.create(name='Bar', creator=a)
3226.         qs = Report.objects.filter(
3227.             Q(creator__ranking__isnull=True) |
3228.             Q(creator__ranking__rank=1, name='Foo')
3229.         )
3230.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3231.         self.assertEqual(str(qs.query).count(' JOIN '), 2)
3232.         self.assertSequenceEqual(qs.order_by('name'), [r2, r1])
3233. 
3234.     def test_ticket_21748(self):
3235.         i1 = Identifier.objects.create(name='i1')
3236.         i2 = Identifier.objects.create(name='i2')
3237.         i3 = Identifier.objects.create(name='i3')
3238.         Program.objects.create(identifier=i1)
3239.         Channel.objects.create(identifier=i1)
3240.         Program.objects.create(identifier=i2)
3241.         self.assertSequenceEqual(Identifier.objects.filter(program=None, channel=None), [i3])
3242.         self.assertSequenceEqual(Identifier.objects.exclude(program=None, channel=None).order_by('name'), [i1, i2])
3243. 
3244.     def test_ticket_21748_double_negated_and(self):
3245.         i1 = Identifier.objects.create(name='i1')
3246.         i2 = Identifier.objects.create(name='i2')
3247.         Identifier.objects.create(name='i3')
3248.         p1 = Program.objects.create(identifier=i1)
3249.         c1 = Channel.objects.create(identifier=i1)
3250.         Program.objects.create(identifier=i2)
3251.         # Check the ~~Q() (or equivalently .exclude(~Q)) works like Q() for
3252.         # join promotion.
3253.         qs1_doubleneg = Identifier.objects.exclude(~Q(program__id=p1.id, channel__id=c1.id)).order_by('pk')
3254.         qs1_filter = Identifier.objects.filter(program__id=p1.id, channel__id=c1.id).order_by('pk')
3255.         self.assertQuerysetEqual(qs1_doubleneg, qs1_filter, lambda x: x)
3256.         self.assertEqual(str(qs1_filter.query).count('JOIN'),
3257.                          str(qs1_doubleneg.query).count('JOIN'))
3258.         self.assertEqual(2, str(qs1_doubleneg.query).count('INNER JOIN'))
3259.         self.assertEqual(str(qs1_filter.query).count('INNER JOIN'),
3260.                          str(qs1_doubleneg.query).count('INNER JOIN'))
3261. 
3262.     def test_ticket_21748_double_negated_or(self):
3263.         i1 = Identifier.objects.create(name='i1')
3264.         i2 = Identifier.objects.create(name='i2')
3265.         Identifier.objects.create(name='i3')
3266.         p1 = Program.objects.create(identifier=i1)
3267.         c1 = Channel.objects.create(identifier=i1)
3268.         p2 = Program.objects.create(identifier=i2)
3269.         # Test OR + doubleneg. The expected result is that channel is LOUTER
3270.         # joined, program INNER joined
3271.         qs1_filter = Identifier.objects.filter(
3272.             Q(program__id=p2.id, channel__id=c1.id) | Q(program__id=p1.id)
3273.         ).order_by('pk')
3274.         qs1_doubleneg = Identifier.objects.exclude(
3275.             ~Q(Q(program__id=p2.id, channel__id=c1.id) | Q(program__id=p1.id))
3276.         ).order_by('pk')
3277.         self.assertQuerysetEqual(qs1_doubleneg, qs1_filter, lambda x: x)
3278.         self.assertEqual(str(qs1_filter.query).count('JOIN'),
3279.                          str(qs1_doubleneg.query).count('JOIN'))
3280.         self.assertEqual(1, str(qs1_doubleneg.query).count('INNER JOIN'))
3281.         self.assertEqual(str(qs1_filter.query).count('INNER JOIN'),
3282.                          str(qs1_doubleneg.query).count('INNER JOIN'))
3283. 
3284.     def test_ticket_21748_complex_filter(self):
3285.         i1 = Identifier.objects.create(name='i1')
3286.         i2 = Identifier.objects.create(name='i2')
3287.         Identifier.objects.create(name='i3')
3288.         p1 = Program.objects.create(identifier=i1)
3289.         c1 = Channel.objects.create(identifier=i1)
3290.         p2 = Program.objects.create(identifier=i2)
3291.         # Finally, a more complex case, one time in a way where each
3292.         # NOT is pushed to lowest level in the boolean tree, and
3293.         # another query where this isn't done.
3294.         qs1 = Identifier.objects.filter(
3295.             ~Q(~Q(program__id=p2.id, channel__id=c1.id) & Q(program__id=p1.id))
3296.         ).order_by('pk')
3297.         qs2 = Identifier.objects.filter(
3298.             Q(Q(program__id=p2.id, channel__id=c1.id) | ~Q(program__id=p1.id))
3299.         ).order_by('pk')
3300.         self.assertQuerysetEqual(qs1, qs2, lambda x: x)
3301.         self.assertEqual(str(qs1.query).count('JOIN'),
3302.                          str(qs2.query).count('JOIN'))
3303.         self.assertEqual(0, str(qs1.query).count('INNER JOIN'))
3304.         self.assertEqual(str(qs1.query).count('INNER JOIN'),
3305.                          str(qs2.query).count('INNER JOIN'))
3306. 
3307. 
3308. class ReverseJoinTrimmingTest(TestCase):
3309.     def test_reverse_trimming(self):
3310.         # We don't accidentally trim reverse joins - we can't know if there is
3311.         # anything on the other side of the join, so trimming reverse joins
3312.         # can't be done, ever.
3313.         t = Tag.objects.create()
3314.         qs = Tag.objects.filter(annotation__tag=t.pk)
3315.         self.assertIn('INNER JOIN', str(qs.query))
3316.         self.assertEqual(list(qs), [])
3317. 
3318. 
3319. class JoinReuseTest(TestCase):
3320.     """
3321.     The queries reuse joins sensibly (for example, direct joins
3322.     are always reused).
3323.     """
3324.     def test_fk_reuse(self):
3325.         qs = Annotation.objects.filter(tag__name='foo').filter(tag__name='bar')
3326.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3327. 
3328.     def test_fk_reuse_select_related(self):
3329.         qs = Annotation.objects.filter(tag__name='foo').select_related('tag')
3330.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3331. 
3332.     def test_fk_reuse_annotation(self):
3333.         qs = Annotation.objects.filter(tag__name='foo').annotate(cnt=Count('tag__name'))
3334.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3335. 
3336.     def test_fk_reuse_disjunction(self):
3337.         qs = Annotation.objects.filter(Q(tag__name='foo') | Q(tag__name='bar'))
3338.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3339. 
3340.     def test_fk_reuse_order_by(self):
3341.         qs = Annotation.objects.filter(tag__name='foo').order_by('tag__name')
3342.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3343. 
3344.     def test_revo2o_reuse(self):
3345.         qs = Detail.objects.filter(member__name='foo').filter(member__name='foo')
3346.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3347. 
3348.     def test_revfk_noreuse(self):
3349.         qs = Author.objects.filter(report__name='r4').filter(report__name='r1')
3350.         self.assertEqual(str(qs.query).count('JOIN'), 2)
3351. 
3352.     def test_inverted_q_across_relations(self):
3353.         """
3354.         When a trimmable join is specified in the query (here school__), the
3355.         ORM detects it and removes unnecessary joins. The set of reusable joins
3356.         are updated after trimming the query so that other lookups don't
3357.         consider that the outer query's filters are in effect for the subquery
3358.         (#26551).
3359.         """
3360.         springfield_elementary = School.objects.create()
3361.         hogward = School.objects.create()
3362.         Student.objects.create(school=springfield_elementary)
3363.         hp = Student.objects.create(school=hogward)
3364.         Classroom.objects.create(school=hogward, name='Potion')
3365.         Classroom.objects.create(school=springfield_elementary, name='Main')
3366.         qs = Student.objects.filter(
3367.             ~(Q(school__classroom__name='Main') & Q(school__classroom__has_blackboard=None))
3368.         )
3369.         self.assertSequenceEqual(qs, [hp])
3370. 
3371. 
3372. class DisjunctionPromotionTests(TestCase):
3373.     def test_disjunction_promotion_select_related(self):
3374.         fk1 = FK1.objects.create(f1='f1', f2='f2')
3375.         basea = BaseA.objects.create(a=fk1)
3376.         qs = BaseA.objects.filter(Q(a=fk1) | Q(b=2))
3377.         self.assertEqual(str(qs.query).count(' JOIN '), 0)
3378.         qs = qs.select_related('a', 'b')
3379.         self.assertEqual(str(qs.query).count(' INNER JOIN '), 0)
3380.         self.assertEqual(str(qs.query).count(' LEFT OUTER JOIN '), 2)
3381.         with self.assertNumQueries(1):
3382.             self.assertSequenceEqual(qs, [basea])
3383.             self.assertEqual(qs[0].a, fk1)
3384.             self.assertIs(qs[0].b, None)
3385. 
3386.     def test_disjunction_promotion1(self):
3387.         # Pre-existing join, add two ORed filters to the same join,
3388.         # all joins can be INNER JOINS.
3389.         qs = BaseA.objects.filter(a__f1='foo')
3390.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3391.         qs = qs.filter(Q(b__f1='foo') | Q(b__f2='foo'))
3392.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3393.         # Reverse the order of AND and OR filters.
3394.         qs = BaseA.objects.filter(Q(b__f1='foo') | Q(b__f2='foo'))
3395.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3396.         qs = qs.filter(a__f1='foo')
3397.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3398. 
3399.     def test_disjunction_promotion2(self):
3400.         qs = BaseA.objects.filter(a__f1='foo')
3401.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3402.         # Now we have two different joins in an ORed condition, these
3403.         # must be OUTER joins. The pre-existing join should remain INNER.
3404.         qs = qs.filter(Q(b__f1='foo') | Q(c__f2='foo'))
3405.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3406.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3407.         # Reverse case.
3408.         qs = BaseA.objects.filter(Q(b__f1='foo') | Q(c__f2='foo'))
3409.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3410.         qs = qs.filter(a__f1='foo')
3411.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3412.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3413. 
3414.     def test_disjunction_promotion3(self):
3415.         qs = BaseA.objects.filter(a__f2='bar')
3416.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3417.         # The ANDed a__f2 filter allows us to use keep using INNER JOIN
3418.         # even inside the ORed case. If the join to a__ returns nothing,
3419.         # the ANDed filter for a__f2 can't be true.
3420.         qs = qs.filter(Q(a__f1='foo') | Q(b__f2='foo'))
3421.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3422.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3423. 
3424.     def test_disjunction_promotion3_demote(self):
3425.         # This one needs demotion logic: the first filter causes a to be
3426.         # outer joined, the second filter makes it inner join again.
3427.         qs = BaseA.objects.filter(
3428.             Q(a__f1='foo') | Q(b__f2='foo')).filter(a__f2='bar')
3429.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3430.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3431. 
3432.     def test_disjunction_promotion4_demote(self):
3433.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3434.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3435.         # Demote needed for the "a" join. It is marked as outer join by
3436.         # above filter (even if it is trimmed away).
3437.         qs = qs.filter(a__f1='foo')
3438.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3439. 
3440.     def test_disjunction_promotion4(self):
3441.         qs = BaseA.objects.filter(a__f1='foo')
3442.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3443.         qs = qs.filter(Q(a=1) | Q(a=2))
3444.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3445. 
3446.     def test_disjunction_promotion5_demote(self):
3447.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3448.         # Note that the above filters on a force the join to an
3449.         # inner join even if it is trimmed.
3450.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3451.         qs = qs.filter(Q(a__f1='foo') | Q(b__f1='foo'))
3452.         # So, now the a__f1 join doesn't need promotion.
3453.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3454.         # But b__f1 does.
3455.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3456.         qs = BaseA.objects.filter(Q(a__f1='foo') | Q(b__f1='foo'))
3457.         # Now the join to a is created as LOUTER
3458.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3459.         qs = qs.filter(Q(a=1) | Q(a=2))
3460.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3461.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3462. 
3463.     def test_disjunction_promotion6(self):
3464.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3465.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3466.         qs = BaseA.objects.filter(Q(a__f1='foo') & Q(b__f1='foo'))
3467.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3468.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 0)
3469. 
3470.         qs = BaseA.objects.filter(Q(a__f1='foo') & Q(b__f1='foo'))
3471.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 0)
3472.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3473.         qs = qs.filter(Q(a=1) | Q(a=2))
3474.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3475.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 0)
3476. 
3477.     def test_disjunction_promotion7(self):
3478.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3479.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3480.         qs = BaseA.objects.filter(Q(a__f1='foo') | (Q(b__f1='foo') & Q(a__f1='bar')))
3481.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3482.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3483.         qs = BaseA.objects.filter(
3484.             (Q(a__f1='foo') | Q(b__f1='foo')) & (Q(a__f1='bar') | Q(c__f1='foo'))
3485.         )
3486.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 3)
3487.         self.assertEqual(str(qs.query).count('INNER JOIN'), 0)
3488.         qs = BaseA.objects.filter(
3489.             Q(a__f1='foo') | Q(a__f1='bar') & (Q(b__f1='bar') | Q(c__f1='foo'))
3490.         )
3491.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3492.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3493. 
3494.     def test_disjunction_promotion_fexpression(self):
3495.         qs = BaseA.objects.filter(Q(a__f1=F('b__f1')) | Q(b__f1='foo'))
3496.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3497.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3498.         qs = BaseA.objects.filter(Q(a__f1=F('c__f1')) | Q(b__f1='foo'))
3499.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 3)
3500.         qs = BaseA.objects.filter(Q(a__f1=F('b__f1')) | Q(a__f2=F('b__f2')) | Q(c__f1='foo'))
3501.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 3)
3502.         qs = BaseA.objects.filter(Q(a__f1=F('c__f1')) | (Q(pk=1) & Q(pk=2)))
3503.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3504.         self.assertEqual(str(qs.query).count('INNER JOIN'), 0)
3505. 
3506. 
3507. class ManyToManyExcludeTest(TestCase):
3508.     def test_exclude_many_to_many(self):
3509.         Identifier.objects.create(name='extra')
3510.         program = Program.objects.create(identifier=Identifier.objects.create(name='program'))
3511.         channel = Channel.objects.create(identifier=Identifier.objects.create(name='channel'))
3512.         channel.programs.add(program)
3513. 
3514.         # channel contains 'program1', so all Identifiers except that one
3515.         # should be returned
3516.         self.assertQuerysetEqual(
3517.             Identifier.objects.exclude(program__channel=channel).order_by('name'),
3518.             ['<Identifier: channel>', '<Identifier: extra>']
3519.         )
3520.         self.assertQuerysetEqual(
3521.             Identifier.objects.exclude(program__channel=None).order_by('name'),
3522.             ['<Identifier: program>']
3523.         )
3524. 
3525.     def test_ticket_12823(self):
3526.         pg3 = Page.objects.create(text='pg3')
3527.         pg2 = Page.objects.create(text='pg2')
3528.         pg1 = Page.objects.create(text='pg1')
3529.         pa1 = Paragraph.objects.create(text='pa1')
3530.         pa1.page.set([pg1, pg2])
3531.         pa2 = Paragraph.objects.create(text='pa2')
3532.         pa2.page.set([pg2, pg3])
3533.         pa3 = Paragraph.objects.create(text='pa3')
3534.         ch1 = Chapter.objects.create(title='ch1', paragraph=pa1)
3535.         ch2 = Chapter.objects.create(title='ch2', paragraph=pa2)
3536.         ch3 = Chapter.objects.create(title='ch3', paragraph=pa3)
3537.         b1 = Book.objects.create(title='b1', chapter=ch1)
3538.         b2 = Book.objects.create(title='b2', chapter=ch2)
3539.         b3 = Book.objects.create(title='b3', chapter=ch3)
3540.         q = Book.objects.exclude(chapter__paragraph__page__text='pg1')
3541.         self.assertNotIn('IS NOT NULL', str(q.query))
3542.         self.assertEqual(len(q), 2)
3543.         self.assertNotIn(b1, q)
3544.         self.assertIn(b2, q)
3545.         self.assertIn(b3, q)
3546. 
3547. 
3548. class RelabelCloneTest(TestCase):
3549.     def test_ticket_19964(self):
3550.         my1 = MyObject.objects.create(data='foo')
3551.         my1.parent = my1
3552.         my1.save()
3553.         my2 = MyObject.objects.create(data='bar', parent=my1)
3554.         parents = MyObject.objects.filter(parent=F('id'))
3555.         children = MyObject.objects.filter(parent__in=parents).exclude(parent=F('id'))
3556.         self.assertEqual(list(parents), [my1])
3557.         # Evaluating the children query (which has parents as part of it) does
3558.         # not change results for the parents query.
3559.         self.assertEqual(list(children), [my2])
3560.         self.assertEqual(list(parents), [my1])
3561. 
3562. 
3563. class Ticket20101Tests(TestCase):
3564.     def test_ticket_20101(self):
3565.         """
3566.         Tests QuerySet ORed combining in exclude subquery case.
3567.         """
3568.         t = Tag.objects.create(name='foo')
3569.         a1 = Annotation.objects.create(tag=t, name='a1')
3570.         a2 = Annotation.objects.create(tag=t, name='a2')
3571.         a3 = Annotation.objects.create(tag=t, name='a3')
3572.         n = Note.objects.create(note='foo', misc='bar')
3573.         qs1 = Note.objects.exclude(annotation__in=[a1, a2])
3574.         qs2 = Note.objects.filter(annotation__in=[a3])
3575.         self.assertIn(n, qs1)
3576.         self.assertNotIn(n, qs2)
3577.         self.assertIn(n, (qs1 | qs2))
3578. 
3579. 
3580. class EmptyStringPromotionTests(SimpleTestCase):
3581.     def test_empty_string_promotion(self):
3582.         qs = RelatedObject.objects.filter(single__name='')
3583.         if connection.features.interprets_empty_strings_as_nulls:
3584.             self.assertIn('LEFT OUTER JOIN', str(qs.query))
3585.         else:
3586.             self.assertNotIn('LEFT OUTER JOIN', str(qs.query))
3587. 
3588. 
3589. class ValuesSubqueryTests(TestCase):
3590.     def test_values_in_subquery(self):
3591.         # If a values() queryset is used, then the given values
3592.         # will be used instead of forcing use of the relation's field.
3593.         o1 = Order.objects.create(id=-2)
3594.         o2 = Order.objects.create(id=-1)
3595.         oi1 = OrderItem.objects.create(order=o1, status=0)
3596.         oi1.status = oi1.pk
3597.         oi1.save()
3598.         OrderItem.objects.create(order=o2, status=0)
3599. 
3600.         # The query below should match o1 as it has related order_item
3601.         # with id == status.
3602.         self.assertSequenceEqual(Order.objects.filter(items__in=OrderItem.objects.values_list('status')), [o1])
3603. 
3604. 
3605. class DoubleInSubqueryTests(TestCase):
3606.     def test_double_subquery_in(self):
3607.         lfa1 = LeafA.objects.create(data='foo')
3608.         lfa2 = LeafA.objects.create(data='bar')
3609.         lfb1 = LeafB.objects.create(data='lfb1')
3610.         lfb2 = LeafB.objects.create(data='lfb2')
3611.         Join.objects.create(a=lfa1, b=lfb1)
3612.         Join.objects.create(a=lfa2, b=lfb2)
3613.         leaf_as = LeafA.objects.filter(data='foo').values_list('pk', flat=True)
3614.         joins = Join.objects.filter(a__in=leaf_as).values_list('b__id', flat=True)
3615.         qs = LeafB.objects.filter(pk__in=joins)
3616.         self.assertSequenceEqual(qs, [lfb1])
3617. 
3618. 
3619. class Ticket18785Tests(SimpleTestCase):
3620.     def test_ticket_18785(self):
3621.         # Test join trimming from ticket18785
3622.         qs = Item.objects.exclude(
3623.             note__isnull=False
3624.         ).filter(
3625.             name='something', creator__extra__isnull=True
3626.         ).order_by()
3627.         self.assertEqual(1, str(qs.query).count('INNER JOIN'))
3628.         self.assertEqual(0, str(qs.query).count('OUTER JOIN'))
3629. 
3630. 
3631. class Ticket20788Tests(TestCase):
3632.     def test_ticket_20788(self):
3633.         Paragraph.objects.create()
3634.         paragraph = Paragraph.objects.create()
3635.         page = paragraph.page.create()
3636.         chapter = Chapter.objects.create(paragraph=paragraph)
3637.         Book.objects.create(chapter=chapter)
3638. 
3639.         paragraph2 = Paragraph.objects.create()
3640.         Page.objects.create()
3641.         chapter2 = Chapter.objects.create(paragraph=paragraph2)
3642.         book2 = Book.objects.create(chapter=chapter2)
3643. 
3644.         sentences_not_in_pub = Book.objects.exclude(chapter__paragraph__page=page)
3645.         self.assertSequenceEqual(sentences_not_in_pub, [book2])
3646. 
3647. 
3648. class Ticket12807Tests(TestCase):
3649.     def test_ticket_12807(self):
3650.         p1 = Paragraph.objects.create()
3651.         p2 = Paragraph.objects.create()
3652.         # The ORed condition below should have no effect on the query - the
3653.         # ~Q(pk__in=[]) will always be True.
3654.         qs = Paragraph.objects.filter((Q(pk=p2.pk) | ~Q(pk__in=[])) & Q(pk=p1.pk))
3655.         self.assertSequenceEqual(qs, [p1])
3656. 
3657. 
3658. class RelatedLookupTypeTests(TestCase):
3659.     error = 'Cannot query "%s": Must be "%s" instance.'
3660. 
3661.     @classmethod
3662.     def setUpTestData(cls):
3663.         cls.oa = ObjectA.objects.create(name="oa")
3664.         cls.poa = ProxyObjectA.objects.get(name="oa")
3665.         cls.coa = ChildObjectA.objects.create(name="coa")
3666.         cls.wrong_type = Order.objects.create(id=cls.oa.pk)
3667.         cls.ob = ObjectB.objects.create(name="ob", objecta=cls.oa, num=1)
3668.         ProxyObjectB.objects.create(name="pob", objecta=cls.oa, num=2)
3669.         cls.pob = ProxyObjectB.objects.all()
3670.         ObjectC.objects.create(childobjecta=cls.coa)
3671. 
3672.     def test_wrong_type_lookup(self):
3673.         """
3674.         A ValueError is raised when the incorrect object type is passed to a
3675.         query lookup.
3676.         """
3677.         # Passing incorrect object type
3678.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectA._meta.object_name)):
3679.             ObjectB.objects.get(objecta=self.wrong_type)
3680. 
3681.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectA._meta.object_name)):
3682.             ObjectB.objects.filter(objecta__in=[self.wrong_type])
3683. 
3684.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectA._meta.object_name)):
3685.             ObjectB.objects.filter(objecta=self.wrong_type)
3686. 
3687.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectB._meta.object_name)):
3688.             ObjectA.objects.filter(objectb__in=[self.wrong_type, self.ob])
3689. 
3690.         # Passing an object of the class on which query is done.
3691.         with self.assertRaisesMessage(ValueError, self.error % (self.ob, ObjectA._meta.object_name)):
3692.             ObjectB.objects.filter(objecta__in=[self.poa, self.ob])
3693. 
3694.         with self.assertRaisesMessage(ValueError, self.error % (self.ob, ChildObjectA._meta.object_name)):
3695.             ObjectC.objects.exclude(childobjecta__in=[self.coa, self.ob])
3696. 
3697.     def test_wrong_backward_lookup(self):
3698.         """
3699.         A ValueError is raised when the incorrect object type is passed to a
3700.         query lookup for backward relations.
3701.         """
3702.         with self.assertRaisesMessage(ValueError, self.error % (self.oa, ObjectB._meta.object_name)):
3703.             ObjectA.objects.filter(objectb__in=[self.oa, self.ob])
3704. 
3705.         with self.assertRaisesMessage(ValueError, self.error % (self.oa, ObjectB._meta.object_name)):
3706.             ObjectA.objects.exclude(objectb=self.oa)
3707. 
3708.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectB._meta.object_name)):
3709.             ObjectA.objects.get(objectb=self.wrong_type)
3710. 
3711.     def test_correct_lookup(self):
3712.         """
3713.         When passing proxy model objects, child objects, or parent objects,
3714.         lookups work fine.
3715.         """
3716.         out_a = ['<ObjectA: oa>']
3717.         out_b = ['<ObjectB: ob>', '<ObjectB: pob>']
3718.         out_c = ['<ObjectC: >']
3719. 
3720.         # proxy model objects
3721.         self.assertQuerysetEqual(ObjectB.objects.filter(objecta=self.poa).order_by('name'), out_b)
3722.         self.assertQuerysetEqual(ObjectA.objects.filter(objectb__in=self.pob).order_by('pk'), out_a * 2)
3723. 
3724.         # child objects
3725.         self.assertQuerysetEqual(ObjectB.objects.filter(objecta__in=[self.coa]), [])
3726.         self.assertQuerysetEqual(ObjectB.objects.filter(objecta__in=[self.poa, self.coa]).order_by('name'), out_b)
3727.         self.assertQuerysetEqual(
3728.             ObjectB.objects.filter(objecta__in=iter([self.poa, self.coa])).order_by('name'),
3729.             out_b
3730.         )
3731. 
3732.         # parent objects
3733.         self.assertQuerysetEqual(ObjectC.objects.exclude(childobjecta=self.oa), out_c)
3734. 
3735.         # QuerySet related object type checking shouldn't issue queries
3736.         # (the querysets aren't evaluated here, hence zero queries) (#23266).
3737.         with self.assertNumQueries(0):
3738.             ObjectB.objects.filter(objecta__in=ObjectA.objects.all())
3739. 
3740.     def test_values_queryset_lookup(self):
3741.         """
3742.         #23396 - Ensure ValueQuerySets are not checked for compatibility with the lookup field
3743.         """
3744.         # Make sure the num and objecta field values match.
3745.         ob = ObjectB.objects.get(name='ob')
3746.         ob.num = ob.objecta.pk
3747.         ob.save()
3748.         pob = ObjectB.objects.get(name='pob')
3749.         pob.num = pob.objecta.pk
3750.         pob.save()
3751.         self.assertQuerysetEqual(ObjectB.objects.filter(
3752.             objecta__in=ObjectB.objects.all().values_list('num')
3753.         ).order_by('pk'), ['<ObjectB: ob>', '<ObjectB: pob>'])
3754. 
3755. 
3756. class Ticket14056Tests(TestCase):
3757.     def test_ticket_14056(self):
3758.         s1 = SharedConnection.objects.create(data='s1')
3759.         s2 = SharedConnection.objects.create(data='s2')
3760.         s3 = SharedConnection.objects.create(data='s3')
3761.         PointerA.objects.create(connection=s2)
3762.         expected_ordering = (
3763.             [s1, s3, s2] if connection.features.nulls_order_largest
3764.             else [s2, s1, s3]
3765.         )
3766.         self.assertSequenceEqual(SharedConnection.objects.order_by('-pointera__connection', 'pk'), expected_ordering)
3767. 
3768. 
3769. class Ticket20955Tests(TestCase):
3770.     def test_ticket_20955(self):
3771.         jack = Staff.objects.create(name='jackstaff')
3772.         jackstaff = StaffUser.objects.create(staff=jack)
3773.         jill = Staff.objects.create(name='jillstaff')
3774.         jillstaff = StaffUser.objects.create(staff=jill)
3775.         task = Task.objects.create(creator=jackstaff, owner=jillstaff, title="task")
3776.         task_get = Task.objects.get(pk=task.pk)
3777.         # Load data so that assertNumQueries doesn't complain about the get
3778.         # version's queries.
3779.         task_get.creator.staffuser.staff
3780.         task_get.owner.staffuser.staff
3781.         qs = Task.objects.select_related(
3782.             'creator__staffuser__staff', 'owner__staffuser__staff')
3783.         self.assertEqual(str(qs.query).count(' JOIN '), 6)
3784.         task_select_related = qs.get(pk=task.pk)
3785.         with self.assertNumQueries(0):
3786.             self.assertEqual(task_select_related.creator.staffuser.staff,
3787.                              task_get.creator.staffuser.staff)
3788.             self.assertEqual(task_select_related.owner.staffuser.staff,
3789.                              task_get.owner.staffuser.staff)
3790. 
3791. 
3792. class Ticket21203Tests(TestCase):
3793.     def test_ticket_21203(self):
3794.         p = Ticket21203Parent.objects.create(parent_bool=True)
3795.         c = Ticket21203Child.objects.create(parent=p)
3796.         qs = Ticket21203Child.objects.select_related('parent').defer('parent__created')
3797.         self.assertSequenceEqual(qs, [c])
3798.         self.assertIs(qs[0].parent.parent_bool, True)
3799. 
3800. 
3801. class ValuesJoinPromotionTests(TestCase):
3802.     def test_values_no_promotion_for_existing(self):
3803.         qs = Node.objects.filter(parent__parent__isnull=False)
3804.         self.assertIn(' INNER JOIN ', str(qs.query))
3805.         qs = qs.values('parent__parent__id')
3806.         self.assertIn(' INNER JOIN ', str(qs.query))
3807.         # Make sure there is a left outer join without the filter.
3808.         qs = Node.objects.values('parent__parent__id')
3809.         self.assertIn(' LEFT OUTER JOIN ', str(qs.query))
3810. 
3811.     def test_non_nullable_fk_not_promoted(self):
3812.         qs = ObjectB.objects.values('objecta__name')
3813.         self.assertIn(' INNER JOIN ', str(qs.query))
3814. 
3815.     def test_ticket_21376(self):
3816.         a = ObjectA.objects.create()
3817.         ObjectC.objects.create(objecta=a)
3818.         qs = ObjectC.objects.filter(
3819.             Q(objecta=a) | Q(objectb__objecta=a),
3820.         )
3821.         qs = qs.filter(
3822.             Q(objectb=1) | Q(objecta=a),
3823.         )
3824.         self.assertEqual(qs.count(), 1)
3825.         tblname = connection.ops.quote_name(ObjectB._meta.db_table)
3826.         self.assertIn(' LEFT OUTER JOIN %s' % tblname, str(qs.query))
3827. 
3828. 
3829. class ForeignKeyToBaseExcludeTests(TestCase):
3830.     def test_ticket_21787(self):
3831.         sc1 = SpecialCategory.objects.create(special_name='sc1', name='sc1')
3832.         sc2 = SpecialCategory.objects.create(special_name='sc2', name='sc2')
3833.         sc3 = SpecialCategory.objects.create(special_name='sc3', name='sc3')
3834.         c1 = CategoryItem.objects.create(category=sc1)
3835.         CategoryItem.objects.create(category=sc2)
3836.         self.assertSequenceEqual(SpecialCategory.objects.exclude(categoryitem__id=c1.pk).order_by('name'), [sc2, sc3])
3837.         self.assertSequenceEqual(SpecialCategory.objects.filter(categoryitem__id=c1.pk), [sc1])
3838. 
3839. 
3840. class ReverseM2MCustomPkTests(TestCase):
3841.     def test_ticket_21879(self):
3842.         cpt1 = CustomPkTag.objects.create(id='cpt1', tag='cpt1')
3843.         cp1 = CustomPk.objects.create(name='cp1', extra='extra')
3844.         cp1.custompktag_set.add(cpt1)
3845.         self.assertSequenceEqual(CustomPk.objects.filter(custompktag=cpt1), [cp1])
3846.         self.assertSequenceEqual(CustomPkTag.objects.filter(custom_pk=cp1), [cpt1])
3847. 
3848. 
3849. class Ticket22429Tests(TestCase):
3850.     def test_ticket_22429(self):
3851.         sc1 = School.objects.create()
3852.         st1 = Student.objects.create(school=sc1)
3853. 
3854.         sc2 = School.objects.create()
3855.         st2 = Student.objects.create(school=sc2)
3856. 
3857.         cr = Classroom.objects.create(school=sc1)
3858.         cr.students.add(st1)
3859. 
3860.         queryset = Student.objects.filter(~Q(classroom__school=F('school')))
3861.         self.assertSequenceEqual(queryset, [st2])
3862. 
3863. 
3864. class Ticket23605Tests(TestCase):
3865.     def test_ticket_23605(self):
3866.         # Test filtering on a complicated q-object from ticket's report.
3867.         # The query structure is such that we have multiple nested subqueries.
3868.         # The original problem was that the inner queries weren't relabeled
3869.         # correctly.
3870.         # See also #24090.
3871.         a1 = Ticket23605A.objects.create()
3872.         a2 = Ticket23605A.objects.create()
3873.         c1 = Ticket23605C.objects.create(field_c0=10000.0)
3874.         Ticket23605B.objects.create(
3875.             field_b0=10000.0, field_b1=True,
3876.             modelc_fk=c1, modela_fk=a1)
3877.         complex_q = Q(pk__in=Ticket23605A.objects.filter(
3878.             Q(
3879.                 # True for a1 as field_b0 = 10000, field_c0=10000
3880.                 # False for a2 as no ticket23605b found
3881.                 ticket23605b__field_b0__gte=1000000 /
3882.                 F("ticket23605b__modelc_fk__field_c0")
3883.             ) &
3884.             # True for a1 (field_b1=True)
3885.             Q(ticket23605b__field_b1=True) & ~Q(ticket23605b__pk__in=Ticket23605B.objects.filter(
3886.                 ~(
3887.                     # Same filters as above commented filters, but
3888.                     # double-negated (one for Q() above, one for
3889.                     # parentheses). So, again a1 match, a2 not.
3890.                     Q(field_b1=True) &
3891.                     Q(field_b0__gte=1000000 / F("modelc_fk__field_c0"))
3892.                 )
3893.             ))).filter(ticket23605b__field_b1=True))
3894.         qs1 = Ticket23605A.objects.filter(complex_q)
3895.         self.assertSequenceEqual(qs1, [a1])
3896.         qs2 = Ticket23605A.objects.exclude(complex_q)
3897.         self.assertSequenceEqual(qs2, [a2])
3898. 
3899. 
3900. class TestTicket24279(TestCase):
3901.     def test_ticket_24278(self):
3902.         School.objects.create()
3903.         qs = School.objects.filter(Q(pk__in=()) | Q())
3904.         self.assertQuerysetEqual(qs, [])
3905. 
3906. 
3907. class TestInvalidValuesRelation(SimpleTestCase):
3908.     def test_invalid_values(self):
3909.         msg = "Field 'id' expected a number but got 'abc'."
3910.         with self.assertRaisesMessage(ValueError, msg):
3911.             Annotation.objects.filter(tag='abc')
3912.         with self.assertRaisesMessage(ValueError, msg):
3913.             Annotation.objects.filter(tag__in=[123, 'abc'])
3914. 
3915. 
3916. class TestTicket24605(TestCase):
3917.     def test_ticket_24605(self):
3918.         """
3919.         Subquery table names should be quoted.
3920.         """
3921.         i1 = Individual.objects.create(alive=True)
3922.         RelatedIndividual.objects.create(related=i1)
3923.         i2 = Individual.objects.create(alive=False)
3924.         RelatedIndividual.objects.create(related=i2)
3925.         i3 = Individual.objects.create(alive=True)
3926.         i4 = Individual.objects.create(alive=False)
3927. 
3928.         self.assertSequenceEqual(Individual.objects.filter(Q(alive=False), Q(related_individual__isnull=True)), [i4])
3929.         self.assertSequenceEqual(
3930.             Individual.objects.exclude(Q(alive=False), Q(related_individual__isnull=True)).order_by('pk'),
3931.             [i1, i2, i3]
3932.         )
3933. 
3934. 
3935. class Ticket23622Tests(TestCase):
3936.     @skipUnlessDBFeature('can_distinct_on_fields')
3937.     def test_ticket_23622(self):
3938.         """
3939.         Make sure __pk__in and __in work the same for related fields when
3940.         using a distinct on subquery.
3941.         """
3942.         a1 = Ticket23605A.objects.create()
3943.         a2 = Ticket23605A.objects.create()
3944.         c1 = Ticket23605C.objects.create(field_c0=0.0)
3945.         Ticket23605B.objects.create(
3946.             modela_fk=a1, field_b0=123,
3947.             field_b1=True,
3948.             modelc_fk=c1,
3949.         )
3950.         Ticket23605B.objects.create(
3951.             modela_fk=a1, field_b0=23,
3952.             field_b1=True,
3953.             modelc_fk=c1,
3954.         )
3955.         Ticket23605B.objects.create(
3956.             modela_fk=a1, field_b0=234,
3957.             field_b1=True,
3958.             modelc_fk=c1,
3959.         )
3960.         Ticket23605B.objects.create(
3961.             modela_fk=a1, field_b0=12,
3962.             field_b1=True,
3963.             modelc_fk=c1,
3964.         )
3965.         Ticket23605B.objects.create(
3966.             modela_fk=a2, field_b0=567,
3967.             field_b1=True,
3968.             modelc_fk=c1,
3969.         )
3970.         Ticket23605B.objects.create(
3971.             modela_fk=a2, field_b0=76,
3972.             field_b1=True,
3973.             modelc_fk=c1,
3974.         )
3975.         Ticket23605B.objects.create(
3976.             modela_fk=a2, field_b0=7,
3977.             field_b1=True,
3978.             modelc_fk=c1,
3979.         )
3980.         Ticket23605B.objects.create(
3981.             modela_fk=a2, field_b0=56,
3982.             field_b1=True,
3983.             modelc_fk=c1,
3984.         )
3985.         qx = (
3986.             Q(ticket23605b__pk__in=Ticket23605B.objects.order_by('modela_fk', '-field_b1').distinct('modela_fk')) &
3987.             Q(ticket23605b__field_b0__gte=300)
3988.         )
3989.         qy = (
3990.             Q(ticket23605b__in=Ticket23605B.objects.order_by('modela_fk', '-field_b1').distinct('modela_fk')) &
3991.             Q(ticket23605b__field_b0__gte=300)
3992.         )
3993.         self.assertEqual(
3994.             set(Ticket23605A.objects.filter(qx).values_list('pk', flat=True)),
3995.             set(Ticket23605A.objects.filter(qy).values_list('pk', flat=True))
3996.         )
3997.         self.assertSequenceEqual(Ticket23605A.objects.filter(qx), [a2])

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 09:00:25,626 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user\'s query is "Please provide the full content of tests/queries/tests.py". This is an explicit request for the entire file.\n\n2. Extended relevance:\n   - The context contains the entire content of the requested file, split across two context blocks.\n   - Returning the full file is necessary to fulfill the user\'s explicit request.\n   - The user\'s purpose is to find tests related to `QuerySet.none()`. Providing the full file allows the user to see all relevant tests in their complete context, including imports, models, and test setup, which is essential for understanding and running the tests.', relative_path='tests/queries/tests.py', start_line=1, end_line=3997)]
2025-12-23 09:00:25,631 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of tests/queries/tests.py
2025-12-23 09:00:25,632 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 09:00:25,632 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 09:00:25,632 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-23 09:00:25,632 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-23 09:00:25,633 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.9.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: QuerySet.none() on combined queries returns all results.

Description: Description
	
I came across this issue on Stack Overflow. I'm not 100% sure it's a bug, but it does seem strange. With this code (excuse the bizarre example filtering):
class Publication(models.Model):
	pass
class Article(models.Model):
	publications = models.ManyToManyField(to=Publication, blank=True, null=True)
class ArticleForm(forms.ModelForm):
	publications = forms.ModelMultipleChoiceField(
		Publication.objects.filter(id__lt=2) | Publication.objects.filter(id__gt=5),
		required=False,
	)
	class Meta:
		model = Article
		fields = ["publications"]
class ArticleAdmin(admin.ModelAdmin):
	form = ArticleForm
This works well. However, changing the ModelMultipleChoiceField queryset to use union() breaks things.
publications = forms.ModelMultipleChoiceField(
	Publication.objects.filter(id__lt=2).union(
		Publication.objects.filter(id__gt=5)
	),
	required=False,
)
The form correctly shows only the matching objects. However, if you submit this form while empty (i.e. you didn't select any publications), ALL objects matching the queryset will be added. Using the OR query, NO objects are added, as I'd expect.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index c913267476..90c000dbf2 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1777,6 +1777,11 @@ class Query(BaseExpression):
 
     def set_empty(self):
         self.where.add(NothingNode(), AND)
+        # Clear combined query attributes to ensure .none() results in an
+        # empty queryset even if the query was a combined query (e.g. union).
+        self.combinator = None
+        self.combinator_all = False
+        self.combined_queries = ()
 
     def is_empty(self):
         return any(isinstance(c, NothingNode) for c in self.where.children)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of tests/queries/test_qs_combinators.py.
Extra Requirements: If the file is too large, please provide the full content of tests/queries/tests.py instead.
Purpose: I need to find existing test cases that demonstrate the bug with `QuerySet.none()` on combined queries, and this file is the most likely place to find them.

Previous refined query 2:
Essential Query: Please provide the full content of tests/queries/tests.py
Extra Requirements: 
Purpose: I need to find test cases that cover the behavior of `QuerySet.none()` on complex or combined querysets to find the most relevant tests for the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/queries/test_qs_combinators.py
Line number range: 1 - 316
Content:
1. import operator
2. 
3. from django.db import DatabaseError, NotSupportedError, connection
4. from django.db.models import Exists, F, IntegerField, OuterRef, Value
5. from django.test import TestCase, skipIfDBFeature, skipUnlessDBFeature
6. 
7. from .models import Number, ReservedName
8. 
9. 
10. @skipUnlessDBFeature('supports_select_union')
11. class QuerySetSetOperationTests(TestCase):
12.     @classmethod
13.     def setUpTestData(cls):
14.         Number.objects.bulk_create(Number(num=i, other_num=10 - i) for i in range(10))
15. 
16.     def assertNumbersEqual(self, queryset, expected_numbers, ordered=True):
17.         self.assertQuerysetEqual(queryset, expected_numbers, operator.attrgetter('num'), ordered)
18. 
19.     def test_simple_union(self):
20.         qs1 = Number.objects.filter(num__lte=1)
21.         qs2 = Number.objects.filter(num__gte=8)
22.         qs3 = Number.objects.filter(num=5)
23.         self.assertNumbersEqual(qs1.union(qs2, qs3), [0, 1, 5, 8, 9], ordered=False)
24. 
25.     @skipUnlessDBFeature('supports_select_intersection')
26.     def test_simple_intersection(self):
27.         qs1 = Number.objects.filter(num__lte=5)
28.         qs2 = Number.objects.filter(num__gte=5)
29.         qs3 = Number.objects.filter(num__gte=4, num__lte=6)
30.         self.assertNumbersEqual(qs1.intersection(qs2, qs3), [5], ordered=False)
31. 
32.     @skipUnlessDBFeature('supports_select_intersection')
33.     def test_intersection_with_values(self):
34.         ReservedName.objects.create(name='a', order=2)
35.         qs1 = ReservedName.objects.all()
36.         reserved_name = qs1.intersection(qs1).values('name', 'order', 'id').get()
37.         self.assertEqual(reserved_name['name'], 'a')
38.         self.assertEqual(reserved_name['order'], 2)
39.         reserved_name = qs1.intersection(qs1).values_list('name', 'order', 'id').get()
40.         self.assertEqual(reserved_name[:2], ('a', 2))
41. 
42.     @skipUnlessDBFeature('supports_select_difference')
43.     def test_simple_difference(self):
44.         qs1 = Number.objects.filter(num__lte=5)
45.         qs2 = Number.objects.filter(num__lte=4)
46.         self.assertNumbersEqual(qs1.difference(qs2), [5], ordered=False)
47. 
48.     def test_union_distinct(self):
49.         qs1 = Number.objects.all()
50.         qs2 = Number.objects.all()
51.         self.assertEqual(len(list(qs1.union(qs2, all=True))), 20)
52.         self.assertEqual(len(list(qs1.union(qs2))), 10)
53. 
54.     @skipUnlessDBFeature('supports_select_intersection')
55.     def test_intersection_with_empty_qs(self):
56.         qs1 = Number.objects.all()
57.         qs2 = Number.objects.none()
58.         qs3 = Number.objects.filter(pk__in=[])
59.         self.assertEqual(len(qs1.intersection(qs2)), 0)
60.         self.assertEqual(len(qs1.intersection(qs3)), 0)
61.         self.assertEqual(len(qs2.intersection(qs1)), 0)
62.         self.assertEqual(len(qs3.intersection(qs1)), 0)
63.         self.assertEqual(len(qs2.intersection(qs2)), 0)
64.         self.assertEqual(len(qs3.intersection(qs3)), 0)
65. 
66.     @skipUnlessDBFeature('supports_select_difference')
67.     def test_difference_with_empty_qs(self):
68.         qs1 = Number.objects.all()
69.         qs2 = Number.objects.none()
70.         qs3 = Number.objects.filter(pk__in=[])
71.         self.assertEqual(len(qs1.difference(qs2)), 10)
72.         self.assertEqual(len(qs1.difference(qs3)), 10)
73.         self.assertEqual(len(qs2.difference(qs1)), 0)
74.         self.assertEqual(len(qs3.difference(qs1)), 0)
75.         self.assertEqual(len(qs2.difference(qs2)), 0)
76.         self.assertEqual(len(qs3.difference(qs3)), 0)
77. 
78.     @skipUnlessDBFeature('supports_select_difference')
79.     def test_difference_with_values(self):
80.         ReservedName.objects.create(name='a', order=2)
81.         qs1 = ReservedName.objects.all()
82.         qs2 = ReservedName.objects.none()
83.         reserved_name = qs1.difference(qs2).values('name', 'order', 'id').get()
84.         self.assertEqual(reserved_name['name'], 'a')
85.         self.assertEqual(reserved_name['order'], 2)
86.         reserved_name = qs1.difference(qs2).values_list('name', 'order', 'id').get()
87.         self.assertEqual(reserved_name[:2], ('a', 2))
88. 
89.     def test_union_with_empty_qs(self):
90.         qs1 = Number.objects.all()
91.         qs2 = Number.objects.none()
92.         qs3 = Number.objects.filter(pk__in=[])
93.         self.assertEqual(len(qs1.union(qs2)), 10)
94.         self.assertEqual(len(qs2.union(qs1)), 10)
95.         self.assertEqual(len(qs1.union(qs3)), 10)
96.         self.assertEqual(len(qs3.union(qs1)), 10)
97.         self.assertEqual(len(qs2.union(qs1, qs1, qs1)), 10)
98.         self.assertEqual(len(qs2.union(qs1, qs1, all=True)), 20)
99.         self.assertEqual(len(qs2.union(qs2)), 0)
100.         self.assertEqual(len(qs3.union(qs3)), 0)
101. 
102.     def test_limits(self):
103.         qs1 = Number.objects.all()
104.         qs2 = Number.objects.all()
105.         self.assertEqual(len(list(qs1.union(qs2)[:2])), 2)
106. 
107.     def test_ordering(self):
108.         qs1 = Number.objects.filter(num__lte=1)
109.         qs2 = Number.objects.filter(num__gte=2, num__lte=3)
110.         self.assertNumbersEqual(qs1.union(qs2).order_by('-num'), [3, 2, 1, 0])
111. 
112.     def test_ordering_by_alias(self):
113.         qs1 = Number.objects.filter(num__lte=1).values(alias=F('num'))
114.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values(alias=F('num'))
115.         self.assertQuerysetEqual(
116.             qs1.union(qs2).order_by('-alias'),
117.             [3, 2, 1, 0],
118.             operator.itemgetter('alias'),
119.         )
120. 
121.     def test_ordering_by_f_expression(self):
122.         qs1 = Number.objects.filter(num__lte=1)
123.         qs2 = Number.objects.filter(num__gte=2, num__lte=3)
124.         self.assertNumbersEqual(qs1.union(qs2).order_by(F('num').desc()), [3, 2, 1, 0])
125. 
126.     def test_ordering_by_f_expression_and_alias(self):
127.         qs1 = Number.objects.filter(num__lte=1).values(alias=F('other_num'))
128.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values(alias=F('other_num'))
129.         self.assertQuerysetEqual(
130.             qs1.union(qs2).order_by(F('alias').desc()),
131.             [10, 9, 8, 7],
132.             operator.itemgetter('alias'),
133.         )
134.         Number.objects.create(num=-1)
135.         self.assertQuerysetEqual(
136.             qs1.union(qs2).order_by(F('alias').desc(nulls_last=True)),
137.             [10, 9, 8, 7, None],
138.             operator.itemgetter('alias'),
139.         )
140. 
141.     def test_union_with_values(self):
142.         ReservedName.objects.create(name='a', order=2)
143.         qs1 = ReservedName.objects.all()
144.         reserved_name = qs1.union(qs1).values('name', 'order', 'id').get()
145.         self.assertEqual(reserved_name['name'], 'a')
146.         self.assertEqual(reserved_name['order'], 2)
147.         reserved_name = qs1.union(qs1).values_list('name', 'order', 'id').get()
148.         self.assertEqual(reserved_name[:2], ('a', 2))
149.         # List of columns can be changed.
150.         reserved_name = qs1.union(qs1).values_list('order').get()
151.         self.assertEqual(reserved_name, (2,))
152. 
153.     def test_union_with_two_annotated_values_list(self):
154.         qs1 = Number.objects.filter(num=1).annotate(
155.             count=Value(0, IntegerField()),
156.         ).values_list('num', 'count')
157.         qs2 = Number.objects.filter(num=2).values('pk').annotate(
158.             count=F('num'),
159.         ).annotate(
160.             num=Value(1, IntegerField()),
161.         ).values_list('num', 'count')
162.         self.assertCountEqual(qs1.union(qs2), [(1, 0), (2, 1)])
163. 
164.     def test_union_with_extra_and_values_list(self):
165.         qs1 = Number.objects.filter(num=1).extra(
166.             select={'count': 0},
167.         ).values_list('num', 'count')
168.         qs2 = Number.objects.filter(num=2).extra(select={'count': 1})
169.         self.assertCountEqual(qs1.union(qs2), [(1, 0), (2, 1)])
170. 
171.     def test_union_with_values_list_on_annotated_and_unannotated(self):
172.         ReservedName.objects.create(name='rn1', order=1)
173.         qs1 = Number.objects.annotate(
174.             has_reserved_name=Exists(ReservedName.objects.filter(order=OuterRef('num')))
175.         ).filter(has_reserved_name=True)
176.         qs2 = Number.objects.filter(num=9)
177.         self.assertCountEqual(qs1.union(qs2).values_list('num', flat=True), [1, 9])
178. 
179.     def test_union_with_values_list_and_order(self):
180.         ReservedName.objects.bulk_create([
181.             ReservedName(name='rn1', order=7),
182.             ReservedName(name='rn2', order=5),
183.             ReservedName(name='rn0', order=6),
184.             ReservedName(name='rn9', order=-1),
185.         ])
186.         qs1 = ReservedName.objects.filter(order__gte=6)
187.         qs2 = ReservedName.objects.filter(order__lte=5)
188.         union_qs = qs1.union(qs2)
189.         for qs, expected_result in (
190.             # Order by a single column.
191.             (union_qs.order_by('-pk').values_list('order', flat=True), [-1, 6, 5, 7]),
192.             (union_qs.order_by('pk').values_list('order', flat=True), [7, 5, 6, -1]),
193.             (union_qs.values_list('order', flat=True).order_by('-pk'), [-1, 6, 5, 7]),
194.             (union_qs.values_list('order', flat=True).order_by('pk'), [7, 5, 6, -1]),
195.             # Order by multiple columns.
196.             (union_qs.order_by('-name', 'pk').values_list('order', flat=True), [-1, 5, 7, 6]),
197.             (union_qs.values_list('order', flat=True).order_by('-name', 'pk'), [-1, 5, 7, 6]),
198.         ):
199.             with self.subTest(qs=qs):
200.                 self.assertEqual(list(qs), expected_result)
201. 
202.     def test_count_union(self):
203.         qs1 = Number.objects.filter(num__lte=1).values('num')
204.         qs2 = Number.objects.filter(num__gte=2, num__lte=3).values('num')
205.         self.assertEqual(qs1.union(qs2).count(), 4)
206. 
207.     def test_count_union_empty_result(self):
208.         qs = Number.objects.filter(pk__in=[])
209.         self.assertEqual(qs.union(qs).count(), 0)
210. 
211.     @skipUnlessDBFeature('supports_select_difference')
212.     def test_count_difference(self):
213.         qs1 = Number.objects.filter(num__lt=10)
214.         qs2 = Number.objects.filter(num__lt=9)
215.         self.assertEqual(qs1.difference(qs2).count(), 1)
216. 
217.     @skipUnlessDBFeature('supports_select_intersection')
218.     def test_count_intersection(self):
219.         qs1 = Number.objects.filter(num__gte=5)
220.         qs2 = Number.objects.filter(num__lte=5)
221.         self.assertEqual(qs1.intersection(qs2).count(), 1)
222. 
223.     @skipUnlessDBFeature('supports_slicing_ordering_in_compound')
224.     def test_ordering_subqueries(self):
225.         qs1 = Number.objects.order_by('num')[:2]
226.         qs2 = Number.objects.order_by('-num')[:2]
227.         self.assertNumbersEqual(qs1.union(qs2).order_by('-num')[:4], [9, 8, 1, 0])
228. 
229.     @skipIfDBFeature('supports_slicing_ordering_in_compound')
230.     def test_unsupported_ordering_slicing_raises_db_error(self):
231.         qs1 = Number.objects.all()
232.         qs2 = Number.objects.all()
233.         msg = 'LIMIT/OFFSET not allowed in subqueries of compound statements'
234.         with self.assertRaisesMessage(DatabaseError, msg):
235.             list(qs1.union(qs2[:10]))
236.         msg = 'ORDER BY not allowed in subqueries of compound statements'
237.         with self.assertRaisesMessage(DatabaseError, msg):
238.             list(qs1.order_by('id').union(qs2))
239. 
240.     @skipIfDBFeature('supports_select_intersection')
241.     def test_unsupported_intersection_raises_db_error(self):
242.         qs1 = Number.objects.all()
243.         qs2 = Number.objects.all()
244.         msg = 'intersection is not supported on this database backend'
245.         with self.assertRaisesMessage(NotSupportedError, msg):
246.             list(qs1.intersection(qs2))
247. 
248.     def test_combining_multiple_models(self):
249.         ReservedName.objects.create(name='99 little bugs', order=99)
250.         qs1 = Number.objects.filter(num=1).values_list('num', flat=True)
251.         qs2 = ReservedName.objects.values_list('order')
252.         self.assertEqual(list(qs1.union(qs2).order_by('num')), [1, 99])
253. 
254.     def test_order_raises_on_non_selected_column(self):
255.         qs1 = Number.objects.filter().annotate(
256.             annotation=Value(1, IntegerField()),
257.         ).values('annotation', num2=F('num'))
258.         qs2 = Number.objects.filter().values('id', 'num')
259.         # Should not raise
260.         list(qs1.union(qs2).order_by('annotation'))
261.         list(qs1.union(qs2).order_by('num2'))
262.         msg = 'ORDER BY term does not match any column in the result set'
263.         # 'id' is not part of the select
264.         with self.assertRaisesMessage(DatabaseError, msg):
265.             list(qs1.union(qs2).order_by('id'))
266.         # 'num' got realiased to num2
267.         with self.assertRaisesMessage(DatabaseError, msg):
268.             list(qs1.union(qs2).order_by('num'))
269.         with self.assertRaisesMessage(DatabaseError, msg):
270.             list(qs1.union(qs2).order_by(F('num')))
271.         with self.assertRaisesMessage(DatabaseError, msg):
272.             list(qs1.union(qs2).order_by(F('num').desc()))
273.         # switched order, now 'exists' again:
274.         list(qs2.union(qs1).order_by('num'))
275. 
276.     @skipUnlessDBFeature('supports_select_difference', 'supports_select_intersection')
277.     def test_qs_with_subcompound_qs(self):
278.         qs1 = Number.objects.all()
279.         qs2 = Number.objects.intersection(Number.objects.filter(num__gt=1))
280.         self.assertEqual(qs1.difference(qs2).count(), 2)
281. 
282.     def test_order_by_same_type(self):
283.         qs = Number.objects.all()
284.         union = qs.union(qs)
285.         numbers = list(range(10))
286.         self.assertNumbersEqual(union.order_by('num'), numbers)
287.         self.assertNumbersEqual(union.order_by('other_num'), reversed(numbers))
288. 
289.     def test_unsupported_operations_on_combined_qs(self):
290.         qs = Number.objects.all()
291.         msg = 'Calling QuerySet.%s() after %s() is not supported.'
292.         combinators = ['union']
293.         if connection.features.supports_select_difference:
294.             combinators.append('difference')
295.         if connection.features.supports_select_intersection:
296.             combinators.append('intersection')
297.         for combinator in combinators:
298.             for operation in (
299.                 'annotate',
300.                 'defer',
301.                 'delete',
302.                 'distinct',
303.                 'exclude',
304.                 'extra',
305.                 'filter',
306.                 'only',
307.                 'prefetch_related',
308.                 'select_related',
309.                 'update',
310.             ):
311.                 with self.subTest(combinator=combinator, operation=operation):
312.                     with self.assertRaisesMessage(
313.                         NotSupportedError,
314.                         msg % (operation, combinator),
315.                     ):
316.                         getattr(getattr(qs, combinator)(qs), operation)()


File: tests/queries/tests.py
Line number range: 1 - 3997
Content:
1. import datetime
2. import pickle
3. import sys
4. import unittest
5. from operator import attrgetter
6. from threading import Lock
7. 
8. from django.core.exceptions import EmptyResultSet, FieldError
9. from django.db import DEFAULT_DB_ALIAS, connection
10. from django.db.models import Count, Exists, F, OuterRef, Q
11. from django.db.models.expressions import RawSQL
12. from django.db.models.sql.constants import LOUTER
13. from django.db.models.sql.where import NothingNode, WhereNode
14. from django.test import SimpleTestCase, TestCase, skipUnlessDBFeature
15. from django.test.utils import CaptureQueriesContext, ignore_warnings
16. from django.utils.deprecation import RemovedInDjango40Warning
17. 
18. from .models import (
19.     FK1, Annotation, Article, Author, BaseA, Book, CategoryItem,
20.     CategoryRelationship, Celebrity, Channel, Chapter, Child, ChildObjectA,
21.     Classroom, CommonMixedCaseForeignKeys, Company, Cover, CustomPk,
22.     CustomPkTag, DateTimePK, Detail, DumbCategory, Eaten, Employment,
23.     ExtraInfo, Fan, Food, Identifier, Individual, Item, Job,
24.     JobResponsibilities, Join, LeafA, LeafB, LoopX, LoopZ, ManagedModel,
25.     Member, MixedCaseDbColumnCategoryItem, MixedCaseFieldCategoryItem, ModelA,
26.     ModelB, ModelC, ModelD, MyObject, NamedCategory, Node, Note, NullableName,
27.     Number, ObjectA, ObjectB, ObjectC, OneToOneCategory, Order, OrderItem,
28.     Page, Paragraph, Person, Plaything, PointerA, Program, ProxyCategory,
29.     ProxyObjectA, ProxyObjectB, Ranking, Related, RelatedIndividual,
30.     RelatedObject, Report, ReportComment, ReservedName, Responsibility, School,
31.     SharedConnection, SimpleCategory, SingleObject, SpecialCategory, Staff,
32.     StaffUser, Student, Tag, Task, Teacher, Ticket21203Child,
33.     Ticket21203Parent, Ticket23605A, Ticket23605B, Ticket23605C, TvChef, Valid,
34.     X,
35. )
36. 
37. 
38. class Queries1Tests(TestCase):
39.     @classmethod
40.     def setUpTestData(cls):
41.         generic = NamedCategory.objects.create(name="Generic")
42.         cls.t1 = Tag.objects.create(name='t1', category=generic)
43.         cls.t2 = Tag.objects.create(name='t2', parent=cls.t1, category=generic)
44.         cls.t3 = Tag.objects.create(name='t3', parent=cls.t1)
45.         t4 = Tag.objects.create(name='t4', parent=cls.t3)
46.         cls.t5 = Tag.objects.create(name='t5', parent=cls.t3)
47. 
48.         cls.n1 = Note.objects.create(note='n1', misc='foo', id=1)
49.         cls.n2 = Note.objects.create(note='n2', misc='bar', id=2)
50.         cls.n3 = Note.objects.create(note='n3', misc='foo', id=3)
51. 
52.         ann1 = Annotation.objects.create(name='a1', tag=cls.t1)
53.         ann1.notes.add(cls.n1)
54.         ann2 = Annotation.objects.create(name='a2', tag=t4)
55.         ann2.notes.add(cls.n2, cls.n3)
56. 
57.         # Create these out of order so that sorting by 'id' will be different to sorting
58.         # by 'info'. Helps detect some problems later.
59.         cls.e2 = ExtraInfo.objects.create(info='e2', note=cls.n2, value=41, filterable=False)
60.         e1 = ExtraInfo.objects.create(info='e1', note=cls.n1, value=42)
61. 
62.         cls.a1 = Author.objects.create(name='a1', num=1001, extra=e1)
63.         cls.a2 = Author.objects.create(name='a2', num=2002, extra=e1)
64.         cls.a3 = Author.objects.create(name='a3', num=3003, extra=cls.e2)
65.         cls.a4 = Author.objects.create(name='a4', num=4004, extra=cls.e2)
66. 
67.         cls.time1 = datetime.datetime(2007, 12, 19, 22, 25, 0)
68.         cls.time2 = datetime.datetime(2007, 12, 19, 21, 0, 0)
69.         time3 = datetime.datetime(2007, 12, 20, 22, 25, 0)
70.         time4 = datetime.datetime(2007, 12, 20, 21, 0, 0)
71.         cls.i1 = Item.objects.create(name='one', created=cls.time1, modified=cls.time1, creator=cls.a1, note=cls.n3)
72.         cls.i1.tags.set([cls.t1, cls.t2])
73.         cls.i2 = Item.objects.create(name='two', created=cls.time2, creator=cls.a2, note=cls.n2)
74.         cls.i2.tags.set([cls.t1, cls.t3])
75.         cls.i3 = Item.objects.create(name='three', created=time3, creator=cls.a2, note=cls.n3)
76.         i4 = Item.objects.create(name='four', created=time4, creator=cls.a4, note=cls.n3)
77.         i4.tags.set([t4])
78. 
79.         cls.r1 = Report.objects.create(name='r1', creator=cls.a1)
80.         Report.objects.create(name='r2', creator=cls.a3)
81.         Report.objects.create(name='r3')
82. 
83.         # Ordering by 'rank' gives us rank2, rank1, rank3. Ordering by the Meta.ordering
84.         # will be rank3, rank2, rank1.
85.         cls.rank1 = Ranking.objects.create(rank=2, author=cls.a2)
86. 
87.         Cover.objects.create(title="first", item=i4)
88.         Cover.objects.create(title="second", item=cls.i2)
89. 
90.     def test_subquery_condition(self):
91.         qs1 = Tag.objects.filter(pk__lte=0)
92.         qs2 = Tag.objects.filter(parent__in=qs1)
93.         qs3 = Tag.objects.filter(parent__in=qs2)
94.         self.assertEqual(qs3.query.subq_aliases, {'T', 'U', 'V'})
95.         self.assertIn('v0', str(qs3.query).lower())
96.         qs4 = qs3.filter(parent__in=qs1)
97.         self.assertEqual(qs4.query.subq_aliases, {'T', 'U', 'V'})
98.         # It is possible to reuse U for the second subquery, no need to use W.
99.         self.assertNotIn('w0', str(qs4.query).lower())
100.         # So, 'U0."id"' is referenced in SELECT and WHERE twice.
101.         self.assertEqual(str(qs4.query).lower().count('u0.'), 4)
102. 
103.     def test_ticket1050(self):
104.         self.assertQuerysetEqual(
105.             Item.objects.filter(tags__isnull=True),
106.             ['<Item: three>']
107.         )
108.         self.assertQuerysetEqual(
109.             Item.objects.filter(tags__id__isnull=True),
110.             ['<Item: three>']
111.         )
112. 
113.     def test_ticket1801(self):
114.         self.assertQuerysetEqual(
115.             Author.objects.filter(item=self.i2),
116.             ['<Author: a2>']
117.         )
118.         self.assertQuerysetEqual(
119.             Author.objects.filter(item=self.i3),
120.             ['<Author: a2>']
121.         )
122.         self.assertQuerysetEqual(
123.             Author.objects.filter(item=self.i2) & Author.objects.filter(item=self.i3),
124.             ['<Author: a2>']
125.         )
126. 
127.     def test_ticket2306(self):
128.         # Checking that no join types are "left outer" joins.
129.         query = Item.objects.filter(tags=self.t2).query
130.         self.assertNotIn(LOUTER, [x.join_type for x in query.alias_map.values()])
131. 
132.         self.assertQuerysetEqual(
133.             Item.objects.filter(Q(tags=self.t1)).order_by('name'),
134.             ['<Item: one>', '<Item: two>']
135.         )
136.         self.assertQuerysetEqual(
137.             Item.objects.filter(Q(tags=self.t1)).filter(Q(tags=self.t2)),
138.             ['<Item: one>']
139.         )
140.         self.assertQuerysetEqual(
141.             Item.objects.filter(Q(tags=self.t1)).filter(Q(creator__name='fred') | Q(tags=self.t2)),
142.             ['<Item: one>']
143.         )
144. 
145.         # Each filter call is processed "at once" against a single table, so this is
146.         # different from the previous example as it tries to find tags that are two
147.         # things at once (rather than two tags).
148.         self.assertQuerysetEqual(
149.             Item.objects.filter(Q(tags=self.t1) & Q(tags=self.t2)),
150.             []
151.         )
152.         self.assertQuerysetEqual(
153.             Item.objects.filter(Q(tags=self.t1), Q(creator__name='fred') | Q(tags=self.t2)),
154.             []
155.         )
156. 
157.         qs = Author.objects.filter(ranking__rank=2, ranking__id=self.rank1.id)
158.         self.assertQuerysetEqual(list(qs), ['<Author: a2>'])
159.         self.assertEqual(2, qs.query.count_active_tables(), 2)
160.         qs = Author.objects.filter(ranking__rank=2).filter(ranking__id=self.rank1.id)
161.         self.assertEqual(qs.query.count_active_tables(), 3)
162. 
163.     def test_ticket4464(self):
164.         self.assertQuerysetEqual(
165.             Item.objects.filter(tags=self.t1).filter(tags=self.t2),
166.             ['<Item: one>']
167.         )
168.         self.assertQuerysetEqual(
169.             Item.objects.filter(tags__in=[self.t1, self.t2]).distinct().order_by('name'),
170.             ['<Item: one>', '<Item: two>']
171.         )
172.         self.assertQuerysetEqual(
173.             Item.objects.filter(tags__in=[self.t1, self.t2]).filter(tags=self.t3),
174.             ['<Item: two>']
175.         )
176. 
177.         # Make sure .distinct() works with slicing (this was broken in Oracle).
178.         self.assertQuerysetEqual(
179.             Item.objects.filter(tags__in=[self.t1, self.t2]).order_by('name')[:3],
180.             ['<Item: one>', '<Item: one>', '<Item: two>']
181.         )
182.         self.assertQuerysetEqual(
183.             Item.objects.filter(tags__in=[self.t1, self.t2]).distinct().order_by('name')[:3],
184.             ['<Item: one>', '<Item: two>']
185.         )
186. 
187.     def test_tickets_2080_3592(self):
188.         self.assertQuerysetEqual(
189.             Author.objects.filter(item__name='one') | Author.objects.filter(name='a3'),
190.             ['<Author: a1>', '<Author: a3>']
191.         )
192.         self.assertQuerysetEqual(
193.             Author.objects.filter(Q(item__name='one') | Q(name='a3')),
194.             ['<Author: a1>', '<Author: a3>']
195.         )
196.         self.assertQuerysetEqual(
197.             Author.objects.filter(Q(name='a3') | Q(item__name='one')),
198.             ['<Author: a1>', '<Author: a3>']
199.         )
200.         self.assertQuerysetEqual(
201.             Author.objects.filter(Q(item__name='three') | Q(report__name='r3')),
202.             ['<Author: a2>']
203.         )
204. 
205.     def test_ticket6074(self):
206.         # Merging two empty result sets shouldn't leave a queryset with no constraints
207.         # (which would match everything).
208.         self.assertQuerysetEqual(Author.objects.filter(Q(id__in=[])), [])
209.         self.assertQuerysetEqual(
210.             Author.objects.filter(Q(id__in=[]) | Q(id__in=[])),
211.             []
212.         )
213. 
214.     def test_tickets_1878_2939(self):
215.         self.assertEqual(Item.objects.values('creator').distinct().count(), 3)
216. 
217.         # Create something with a duplicate 'name' so that we can test multi-column
218.         # cases (which require some tricky SQL transformations under the covers).
219.         xx = Item(name='four', created=self.time1, creator=self.a2, note=self.n1)
220.         xx.save()
221.         self.assertEqual(
222.             Item.objects.exclude(name='two').values('creator', 'name').distinct().count(),
223.             4
224.         )
225.         self.assertEqual(
226.             (
227.                 Item.objects
228.                 .exclude(name='two')
229.                 .extra(select={'foo': '%s'}, select_params=(1,))
230.                 .values('creator', 'name', 'foo')
231.                 .distinct()
232.                 .count()
233.             ),
234.             4
235.         )
236.         self.assertEqual(
237.             (
238.                 Item.objects
239.                 .exclude(name='two')
240.                 .extra(select={'foo': '%s'}, select_params=(1,))
241.                 .values('creator', 'name')
242.                 .distinct()
243.                 .count()
244.             ),
245.             4
246.         )
247.         xx.delete()
248. 
249.     def test_ticket7323(self):
250.         self.assertEqual(Item.objects.values('creator', 'name').count(), 4)
251. 
252.     def test_ticket2253(self):
253.         q1 = Item.objects.order_by('name')
254.         q2 = Item.objects.filter(id=self.i1.id)
255.         self.assertQuerysetEqual(
256.             q1,
257.             ['<Item: four>', '<Item: one>', '<Item: three>', '<Item: two>']
258.         )
259.         self.assertQuerysetEqual(q2, ['<Item: one>'])
260.         self.assertQuerysetEqual(
261.             (q1 | q2).order_by('name'),
262.             ['<Item: four>', '<Item: one>', '<Item: three>', '<Item: two>']
263.         )
264.         self.assertQuerysetEqual((q1 & q2).order_by('name'), ['<Item: one>'])
265. 
266.         q1 = Item.objects.filter(tags=self.t1)
267.         q2 = Item.objects.filter(note=self.n3, tags=self.t2)
268.         q3 = Item.objects.filter(creator=self.a4)
269.         self.assertQuerysetEqual(
270.             ((q1 & q2) | q3).order_by('name'),
271.             ['<Item: four>', '<Item: one>']
272.         )
273. 
274.     def test_order_by_tables(self):
275.         q1 = Item.objects.order_by('name')
276.         q2 = Item.objects.filter(id=self.i1.id)
277.         list(q2)
278.         combined_query = (q1 & q2).order_by('name').query
279.         self.assertEqual(len([
280.             t for t in combined_query.alias_map if combined_query.alias_refcount[t]
281.         ]), 1)
282. 
283.     def test_order_by_join_unref(self):
284.         """
285.         This test is related to the above one, testing that there aren't
286.         old JOINs in the query.
287.         """
288.         qs = Celebrity.objects.order_by('greatest_fan__fan_of')
289.         self.assertIn('OUTER JOIN', str(qs.query))
290.         qs = qs.order_by('id')
291.         self.assertNotIn('OUTER JOIN', str(qs.query))
292. 
293.     def test_get_clears_ordering(self):
294.         """
295.         get() should clear ordering for optimization purposes.
296.         """
297.         with CaptureQueriesContext(connection) as captured_queries:
298.             Author.objects.order_by('name').get(pk=self.a1.pk)
299.         self.assertNotIn('order by', captured_queries[0]['sql'].lower())
300. 
301.     def test_tickets_4088_4306(self):
302.         self.assertQuerysetEqual(
303.             Report.objects.filter(creator=1001),
304.             ['<Report: r1>']
305.         )
306.         self.assertQuerysetEqual(
307.             Report.objects.filter(creator__num=1001),
308.             ['<Report: r1>']
309.         )
310.         self.assertQuerysetEqual(Report.objects.filter(creator__id=1001), [])
311.         self.assertQuerysetEqual(
312.             Report.objects.filter(creator__id=self.a1.id),
313.             ['<Report: r1>']
314.         )
315.         self.assertQuerysetEqual(
316.             Report.objects.filter(creator__name='a1'),
317.             ['<Report: r1>']
318.         )
319. 
320.     def test_ticket4510(self):
321.         self.assertQuerysetEqual(
322.             Author.objects.filter(report__name='r1'),
323.             ['<Author: a1>']
324.         )
325. 
326.     def test_ticket7378(self):
327.         self.assertQuerysetEqual(self.a1.report_set.all(), ['<Report: r1>'])
328. 
329.     def test_tickets_5324_6704(self):
330.         self.assertQuerysetEqual(
331.             Item.objects.filter(tags__name='t4'),
332.             ['<Item: four>']
333.         )
334.         self.assertQuerysetEqual(
335.             Item.objects.exclude(tags__name='t4').order_by('name').distinct(),
336.             ['<Item: one>', '<Item: three>', '<Item: two>']
337.         )
338.         self.assertQuerysetEqual(
339.             Item.objects.exclude(tags__name='t4').order_by('name').distinct().reverse(),
340.             ['<Item: two>', '<Item: three>', '<Item: one>']
341.         )
342.         self.assertQuerysetEqual(
343.             Author.objects.exclude(item__name='one').distinct().order_by('name'),
344.             ['<Author: a2>', '<Author: a3>', '<Author: a4>']
345.         )
346. 
347.         # Excluding across a m2m relation when there is more than one related
348.         # object associated was problematic.
349.         self.assertQuerysetEqual(
350.             Item.objects.exclude(tags__name='t1').order_by('name'),
351.             ['<Item: four>', '<Item: three>']
352.         )
353.         self.assertQuerysetEqual(
354.             Item.objects.exclude(tags__name='t1').exclude(tags__name='t4'),
355.             ['<Item: three>']
356.         )
357. 
358.         # Excluding from a relation that cannot be NULL should not use outer joins.
359.         query = Item.objects.exclude(creator__in=[self.a1, self.a2]).query
360.         self.assertNotIn(LOUTER, [x.join_type for x in query.alias_map.values()])
361. 
362.         # Similarly, when one of the joins cannot possibly, ever, involve NULL
363.         # values (Author -> ExtraInfo, in the following), it should never be
364.         # promoted to a left outer join. So the following query should only
365.         # involve one "left outer" join (Author -> Item is 0-to-many).
366.         qs = Author.objects.filter(id=self.a1.id).filter(Q(extra__note=self.n1) | Q(item__note=self.n3))
367.         self.assertEqual(
368.             len([
369.                 x for x in qs.query.alias_map.values()
370.                 if x.join_type == LOUTER and qs.query.alias_refcount[x.table_alias]
371.             ]),
372.             1
373.         )
374. 
375.         # The previous changes shouldn't affect nullable foreign key joins.
376.         self.assertQuerysetEqual(
377.             Tag.objects.filter(parent__isnull=True).order_by('name'),
378.             ['<Tag: t1>']
379.         )
380.         self.assertQuerysetEqual(
381.             Tag.objects.exclude(parent__isnull=True).order_by('name'),
382.             ['<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
383.         )
384.         self.assertQuerysetEqual(
385.             Tag.objects.exclude(Q(parent__name='t1') | Q(parent__isnull=True)).order_by('name'),
386.             ['<Tag: t4>', '<Tag: t5>']
387.         )
388.         self.assertQuerysetEqual(
389.             Tag.objects.exclude(Q(parent__isnull=True) | Q(parent__name='t1')).order_by('name'),
390.             ['<Tag: t4>', '<Tag: t5>']
391.         )
392.         self.assertQuerysetEqual(
393.             Tag.objects.exclude(Q(parent__parent__isnull=True)).order_by('name'),
394.             ['<Tag: t4>', '<Tag: t5>']
395.         )
396.         self.assertQuerysetEqual(
397.             Tag.objects.filter(~Q(parent__parent__isnull=True)).order_by('name'),
398.             ['<Tag: t4>', '<Tag: t5>']
399.         )
400. 
401.     def test_ticket2091(self):
402.         t = Tag.objects.get(name='t4')
403.         self.assertQuerysetEqual(
404.             Item.objects.filter(tags__in=[t]),
405.             ['<Item: four>']
406.         )
407. 
408.     def test_avoid_infinite_loop_on_too_many_subqueries(self):
409.         x = Tag.objects.filter(pk=1)
410.         local_recursion_limit = sys.getrecursionlimit() // 16
411.         msg = 'Maximum recursion depth exceeded: too many subqueries.'
412.         with self.assertRaisesMessage(RecursionError, msg):
413.             for i in range(local_recursion_limit + 2):
414.                 x = Tag.objects.filter(pk__in=x)
415. 
416.     def test_reasonable_number_of_subq_aliases(self):
417.         x = Tag.objects.filter(pk=1)
418.         for _ in range(20):
419.             x = Tag.objects.filter(pk__in=x)
420.         self.assertEqual(
421.             x.query.subq_aliases, {
422.                 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'AA', 'AB', 'AC', 'AD',
423.                 'AE', 'AF', 'AG', 'AH', 'AI', 'AJ', 'AK', 'AL', 'AM', 'AN',
424.             }
425.         )
426. 
427.     def test_heterogeneous_qs_combination(self):
428.         # Combining querysets built on different models should behave in a well-defined
429.         # fashion. We raise an error.
430.         with self.assertRaisesMessage(AssertionError, 'Cannot combine queries on two different base models.'):
431.             Author.objects.all() & Tag.objects.all()
432.         with self.assertRaisesMessage(AssertionError, 'Cannot combine queries on two different base models.'):
433.             Author.objects.all() | Tag.objects.all()
434. 
435.     def test_ticket3141(self):
436.         self.assertEqual(Author.objects.extra(select={'foo': '1'}).count(), 4)
437.         self.assertEqual(
438.             Author.objects.extra(select={'foo': '%s'}, select_params=(1,)).count(),
439.             4
440.         )
441. 
442.     def test_ticket2400(self):
443.         self.assertQuerysetEqual(
444.             Author.objects.filter(item__isnull=True),
445.             ['<Author: a3>']
446.         )
447.         self.assertQuerysetEqual(
448.             Tag.objects.filter(item__isnull=True),
449.             ['<Tag: t5>']
450.         )
451. 
452.     def test_ticket2496(self):
453.         self.assertQuerysetEqual(
454.             Item.objects.extra(tables=['queries_author']).select_related().order_by('name')[:1],
455.             ['<Item: four>']
456.         )
457. 
458.     def test_error_raised_on_filter_with_dictionary(self):
459.         with self.assertRaisesMessage(FieldError, 'Cannot parse keyword query as dict'):
460.             Note.objects.filter({'note': 'n1', 'misc': 'foo'})
461. 
462.     def test_tickets_2076_7256(self):
463.         # Ordering on related tables should be possible, even if the table is
464.         # not otherwise involved.
465.         self.assertQuerysetEqual(
466.             Item.objects.order_by('note__note', 'name'),
467.             ['<Item: two>', '<Item: four>', '<Item: one>', '<Item: three>']
468.         )
469. 
470.         # Ordering on a related field should use the remote model's default
471.         # ordering as a final step.
472.         self.assertQuerysetEqual(
473.             Author.objects.order_by('extra', '-name'),
474.             ['<Author: a2>', '<Author: a1>', '<Author: a4>', '<Author: a3>']
475.         )
476. 
477.         # Using remote model default ordering can span multiple models (in this
478.         # case, Cover is ordered by Item's default, which uses Note's default).
479.         self.assertQuerysetEqual(
480.             Cover.objects.all(),
481.             ['<Cover: first>', '<Cover: second>']
482.         )
483. 
484.         # If the remote model does not have a default ordering, we order by its 'id'
485.         # field.
486.         self.assertQuerysetEqual(
487.             Item.objects.order_by('creator', 'name'),
488.             ['<Item: one>', '<Item: three>', '<Item: two>', '<Item: four>']
489.         )
490. 
491.         # Ordering by a many-valued attribute (e.g. a many-to-many or reverse
492.         # ForeignKey) is legal, but the results might not make sense. That
493.         # isn't Django's problem. Garbage in, garbage out.
494.         self.assertQuerysetEqual(
495.             Item.objects.filter(tags__isnull=False).order_by('tags', 'id'),
496.             ['<Item: one>', '<Item: two>', '<Item: one>', '<Item: two>', '<Item: four>']
497.         )
498. 
499.         # If we replace the default ordering, Django adjusts the required
500.         # tables automatically. Item normally requires a join with Note to do
501.         # the default ordering, but that isn't needed here.
502.         qs = Item.objects.order_by('name')
503.         self.assertQuerysetEqual(
504.             qs,
505.             ['<Item: four>', '<Item: one>', '<Item: three>', '<Item: two>']
506.         )
507.         self.assertEqual(len(qs.query.alias_map), 1)
508. 
509.     def test_tickets_2874_3002(self):
510.         qs = Item.objects.select_related().order_by('note__note', 'name')
511.         self.assertQuerysetEqual(
512.             qs,
513.             ['<Item: two>', '<Item: four>', '<Item: one>', '<Item: three>']
514.         )
515. 
516.         # This is also a good select_related() test because there are multiple
517.         # Note entries in the SQL. The two Note items should be different.
518.         self.assertEqual(repr(qs[0].note), '<Note: n2>')
519.         self.assertEqual(repr(qs[0].creator.extra.note), '<Note: n1>')
520. 
521.     def test_ticket3037(self):
522.         self.assertQuerysetEqual(
523.             Item.objects.filter(Q(creator__name='a3', name='two') | Q(creator__name='a4', name='four')),
524.             ['<Item: four>']
525.         )
526. 
527.     def test_tickets_5321_7070(self):
528.         # Ordering columns must be included in the output columns. Note that
529.         # this means results that might otherwise be distinct are not (if there
530.         # are multiple values in the ordering cols), as in this example. This
531.         # isn't a bug; it's a warning to be careful with the selection of
532.         # ordering columns.
533.         self.assertSequenceEqual(
534.             Note.objects.values('misc').distinct().order_by('note', '-misc'),
535.             [{'misc': 'foo'}, {'misc': 'bar'}, {'misc': 'foo'}]
536.         )
537. 
538.     def test_ticket4358(self):
539.         # If you don't pass any fields to values(), relation fields are
540.         # returned as "foo_id" keys, not "foo". For consistency, you should be
541.         # able to pass "foo_id" in the fields list and have it work, too. We
542.         # actually allow both "foo" and "foo_id".
543.         # The *_id version is returned by default.
544.         self.assertIn('note_id', ExtraInfo.objects.values()[0])
545.         # You can also pass it in explicitly.
546.         self.assertSequenceEqual(ExtraInfo.objects.values('note_id'), [{'note_id': 1}, {'note_id': 2}])
547.         # ...or use the field name.
548.         self.assertSequenceEqual(ExtraInfo.objects.values('note'), [{'note': 1}, {'note': 2}])
549. 
550.     def test_ticket6154(self):
551.         # Multiple filter statements are joined using "AND" all the time.
552. 
553.         self.assertQuerysetEqual(
554.             Author.objects.filter(id=self.a1.id).filter(Q(extra__note=self.n1) | Q(item__note=self.n3)),
555.             ['<Author: a1>']
556.         )
557.         self.assertQuerysetEqual(
558.             Author.objects.filter(Q(extra__note=self.n1) | Q(item__note=self.n3)).filter(id=self.a1.id),
559.             ['<Author: a1>']
560.         )
561. 
562.     def test_ticket6981(self):
563.         self.assertQuerysetEqual(
564.             Tag.objects.select_related('parent').order_by('name'),
565.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
566.         )
567. 
568.     def test_ticket9926(self):
569.         self.assertQuerysetEqual(
570.             Tag.objects.select_related("parent", "category").order_by('name'),
571.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
572.         )
573.         self.assertQuerysetEqual(
574.             Tag.objects.select_related('parent', "parent__category").order_by('name'),
575.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>']
576.         )
577. 
578.     def test_tickets_6180_6203(self):
579.         # Dates with limits and/or counts
580.         self.assertEqual(Item.objects.count(), 4)
581.         self.assertEqual(Item.objects.datetimes('created', 'month').count(), 1)
582.         self.assertEqual(Item.objects.datetimes('created', 'day').count(), 2)
583.         self.assertEqual(len(Item.objects.datetimes('created', 'day')), 2)
584.         self.assertEqual(Item.objects.datetimes('created', 'day')[0], datetime.datetime(2007, 12, 19, 0, 0))
585. 
586.     def test_tickets_7087_12242(self):
587.         # Dates with extra select columns
588.         self.assertQuerysetEqual(
589.             Item.objects.datetimes('created', 'day').extra(select={'a': 1}),
590.             ['datetime.datetime(2007, 12, 19, 0, 0)', 'datetime.datetime(2007, 12, 20, 0, 0)']
591.         )
592.         self.assertQuerysetEqual(
593.             Item.objects.extra(select={'a': 1}).datetimes('created', 'day'),
594.             ['datetime.datetime(2007, 12, 19, 0, 0)', 'datetime.datetime(2007, 12, 20, 0, 0)']
595.         )
596. 
597.         name = "one"
598.         self.assertQuerysetEqual(
599.             Item.objects.datetimes('created', 'day').extra(where=['name=%s'], params=[name]),
600.             ['datetime.datetime(2007, 12, 19, 0, 0)']
601.         )
602. 
603.         self.assertQuerysetEqual(
604.             Item.objects.extra(where=['name=%s'], params=[name]).datetimes('created', 'day'),
605.             ['datetime.datetime(2007, 12, 19, 0, 0)']
606.         )
607. 
608.     def test_ticket7155(self):
609.         # Nullable dates
610.         self.assertQuerysetEqual(
611.             Item.objects.datetimes('modified', 'day'),
612.             ['datetime.datetime(2007, 12, 19, 0, 0)']
613.         )
614. 
615.     @ignore_warnings(category=RemovedInDjango40Warning)
616.     def test_ticket7098(self):
617.         self.assertSequenceEqual(
618.             Item.objects.values('note__note').order_by('queries_note.note', 'id'),
619.             [{'note__note': 'n2'}, {'note__note': 'n3'}, {'note__note': 'n3'}, {'note__note': 'n3'}]
620.         )
621. 
622.     def test_order_by_rawsql(self):
623.         self.assertSequenceEqual(
624.             Item.objects.values('note__note').order_by(
625.                 RawSQL('queries_note.note', ()),
626.                 'id',
627.             ),
628.             [
629.                 {'note__note': 'n2'},
630.                 {'note__note': 'n3'},
631.                 {'note__note': 'n3'},
632.                 {'note__note': 'n3'},
633.             ],
634.         )
635. 
636.     def test_order_by_raw_column_alias_warning(self):
637.         msg = (
638.             "Passing column raw column aliases to order_by() is deprecated. "
639.             "Wrap 'queries_author.name' in a RawSQL expression before "
640.             "passing it to order_by()."
641.         )
642.         with self.assertRaisesMessage(RemovedInDjango40Warning, msg):
643.             Item.objects.values('creator__name').order_by('queries_author.name')
644. 
645.     def test_ticket7096(self):
646.         # Make sure exclude() with multiple conditions continues to work.
647.         self.assertQuerysetEqual(
648.             Tag.objects.filter(parent=self.t1, name='t3').order_by('name'),
649.             ['<Tag: t3>']
650.         )
651.         self.assertQuerysetEqual(
652.             Tag.objects.exclude(parent=self.t1, name='t3').order_by('name'),
653.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t4>', '<Tag: t5>']
654.         )
655.         self.assertQuerysetEqual(
656.             Item.objects.exclude(tags__name='t1', name='one').order_by('name').distinct(),
657.             ['<Item: four>', '<Item: three>', '<Item: two>']
658.         )
659.         self.assertQuerysetEqual(
660.             Item.objects.filter(name__in=['three', 'four']).exclude(tags__name='t1').order_by('name'),
661.             ['<Item: four>', '<Item: three>']
662.         )
663. 
664.         # More twisted cases, involving nested negations.
665.         self.assertQuerysetEqual(
666.             Item.objects.exclude(~Q(tags__name='t1', name='one')),
667.             ['<Item: one>']
668.         )
669.         self.assertQuerysetEqual(
670.             Item.objects.filter(~Q(tags__name='t1', name='one'), name='two'),
671.             ['<Item: two>']
672.         )
673.         self.assertQuerysetEqual(
674.             Item.objects.exclude(~Q(tags__name='t1', name='one'), name='two'),
675.             ['<Item: four>', '<Item: one>', '<Item: three>']
676.         )
677. 
678.     def test_tickets_7204_7506(self):
679.         # Make sure querysets with related fields can be pickled. If this
680.         # doesn't crash, it's a Good Thing.
681.         pickle.dumps(Item.objects.all())
682. 
683.     def test_ticket7813(self):
684.         # We should also be able to pickle things that use select_related().
685.         # The only tricky thing here is to ensure that we do the related
686.         # selections properly after unpickling.
687.         qs = Item.objects.select_related()
688.         query = qs.query.get_compiler(qs.db).as_sql()[0]
689.         query2 = pickle.loads(pickle.dumps(qs.query))
690.         self.assertEqual(
691.             query2.get_compiler(qs.db).as_sql()[0],
692.             query
693.         )
694. 
695.     def test_deferred_load_qs_pickling(self):
696.         # Check pickling of deferred-loading querysets
697.         qs = Item.objects.defer('name', 'creator')
698.         q2 = pickle.loads(pickle.dumps(qs))
699.         self.assertEqual(list(qs), list(q2))
700.         q3 = pickle.loads(pickle.dumps(qs, pickle.HIGHEST_PROTOCOL))
701.         self.assertEqual(list(qs), list(q3))
702. 
703.     def test_ticket7277(self):
704.         self.assertQuerysetEqual(
705.             self.n1.annotation_set.filter(
706.                 Q(tag=self.t5) | Q(tag__children=self.t5) | Q(tag__children__children=self.t5)
707.             ),
708.             ['<Annotation: a1>']
709.         )
710. 
711.     def test_tickets_7448_7707(self):
712.         # Complex objects should be converted to strings before being used in
713.         # lookups.
714.         self.assertQuerysetEqual(
715.             Item.objects.filter(created__in=[self.time1, self.time2]),
716.             ['<Item: one>', '<Item: two>']
717.         )
718. 
719.     def test_ticket7235(self):
720.         # An EmptyQuerySet should not raise exceptions if it is filtered.
721.         Eaten.objects.create(meal='m')
722.         q = Eaten.objects.none()
723.         with self.assertNumQueries(0):
724.             self.assertQuerysetEqual(q.all(), [])
725.             self.assertQuerysetEqual(q.filter(meal='m'), [])
726.             self.assertQuerysetEqual(q.exclude(meal='m'), [])
727.             self.assertQuerysetEqual(q.complex_filter({'pk': 1}), [])
728.             self.assertQuerysetEqual(q.select_related('food'), [])
729.             self.assertQuerysetEqual(q.annotate(Count('food')), [])
730.             self.assertQuerysetEqual(q.order_by('meal', 'food'), [])
731.             self.assertQuerysetEqual(q.distinct(), [])
732.             self.assertQuerysetEqual(
733.                 q.extra(select={'foo': "1"}),
734.                 []
735.             )
736.             self.assertQuerysetEqual(q.reverse(), [])
737.             q.query.low_mark = 1
738.             with self.assertRaisesMessage(AssertionError, 'Cannot change a query once a slice has been taken'):
739.                 q.extra(select={'foo': "1"})
740.             self.assertQuerysetEqual(q.defer('meal'), [])
741.             self.assertQuerysetEqual(q.only('meal'), [])
742. 
743.     def test_ticket7791(self):
744.         # There were "issues" when ordering and distinct-ing on fields related
745.         # via ForeignKeys.
746.         self.assertEqual(
747.             len(Note.objects.order_by('extrainfo__info').distinct()),
748.             3
749.         )
750. 
751.         # Pickling of QuerySets using datetimes() should work.
752.         qs = Item.objects.datetimes('created', 'month')
753.         pickle.loads(pickle.dumps(qs))
754. 
755.     def test_ticket9997(self):
756.         # If a ValuesList or Values queryset is passed as an inner query, we
757.         # make sure it's only requesting a single value and use that as the
758.         # thing to select.
759.         self.assertQuerysetEqual(
760.             Tag.objects.filter(name__in=Tag.objects.filter(parent=self.t1).values('name')),
761.             ['<Tag: t2>', '<Tag: t3>']
762.         )
763. 
764.         # Multi-valued values() and values_list() querysets should raise errors.
765.         with self.assertRaisesMessage(TypeError, 'Cannot use multi-field values as a filter value.'):
766.             Tag.objects.filter(name__in=Tag.objects.filter(parent=self.t1).values('name', 'id'))
767.         with self.assertRaisesMessage(TypeError, 'Cannot use multi-field values as a filter value.'):
768.             Tag.objects.filter(name__in=Tag.objects.filter(parent=self.t1).values_list('name', 'id'))
769. 
770.     def test_ticket9985(self):
771.         # qs.values_list(...).values(...) combinations should work.
772.         self.assertSequenceEqual(
773.             Note.objects.values_list("note", flat=True).values("id").order_by("id"),
774.             [{'id': 1}, {'id': 2}, {'id': 3}]
775.         )
776.         self.assertQuerysetEqual(
777.             Annotation.objects.filter(notes__in=Note.objects.filter(note="n1").values_list('note').values('id')),
778.             ['<Annotation: a1>']
779.         )
780. 
781.     def test_ticket10205(self):
782.         # When bailing out early because of an empty "__in" filter, we need
783.         # to set things up correctly internally so that subqueries can continue properly.
784.         self.assertEqual(Tag.objects.filter(name__in=()).update(name="foo"), 0)
785. 
786.     def test_ticket10432(self):
787.         # Testing an empty "__in" filter with a generator as the value.
788.         def f():
789.             return iter([])
790.         n_obj = Note.objects.all()[0]
791. 
792.         def g():
793.             yield n_obj.pk
794.         self.assertQuerysetEqual(Note.objects.filter(pk__in=f()), [])
795.         self.assertEqual(list(Note.objects.filter(pk__in=g())), [n_obj])
796. 
797.     def test_ticket10742(self):
798.         # Queries used in an __in clause don't execute subqueries
799. 
800.         subq = Author.objects.filter(num__lt=3000)
801.         qs = Author.objects.filter(pk__in=subq)
802.         self.assertQuerysetEqual(qs, ['<Author: a1>', '<Author: a2>'])
803. 
804.         # The subquery result cache should not be populated
805.         self.assertIsNone(subq._result_cache)
806. 
807.         subq = Author.objects.filter(num__lt=3000)
808.         qs = Author.objects.exclude(pk__in=subq)
809.         self.assertQuerysetEqual(qs, ['<Author: a3>', '<Author: a4>'])
810. 
811.         # The subquery result cache should not be populated
812.         self.assertIsNone(subq._result_cache)
813. 
814.         subq = Author.objects.filter(num__lt=3000)
815.         self.assertQuerysetEqual(
816.             Author.objects.filter(Q(pk__in=subq) & Q(name='a1')),
817.             ['<Author: a1>']
818.         )
819. 
820.         # The subquery result cache should not be populated
821.         self.assertIsNone(subq._result_cache)
822. 
823.     def test_ticket7076(self):
824.         # Excluding shouldn't eliminate NULL entries.
825.         self.assertQuerysetEqual(
826.             Item.objects.exclude(modified=self.time1).order_by('name'),
827.             ['<Item: four>', '<Item: three>', '<Item: two>']
828.         )
829.         self.assertQuerysetEqual(
830.             Tag.objects.exclude(parent__name=self.t1.name),
831.             ['<Tag: t1>', '<Tag: t4>', '<Tag: t5>']
832.         )
833. 
834.     def test_ticket7181(self):
835.         # Ordering by related tables should accommodate nullable fields (this
836.         # test is a little tricky, since NULL ordering is database dependent.
837.         # Instead, we just count the number of results).
838.         self.assertEqual(len(Tag.objects.order_by('parent__name')), 5)
839. 
840.         # Empty querysets can be merged with others.
841.         self.assertQuerysetEqual(
842.             Note.objects.none() | Note.objects.all(),
843.             ['<Note: n1>', '<Note: n2>', '<Note: n3>']
844.         )
845.         self.assertQuerysetEqual(
846.             Note.objects.all() | Note.objects.none(),
847.             ['<Note: n1>', '<Note: n2>', '<Note: n3>']
848.         )
849.         self.assertQuerysetEqual(Note.objects.none() & Note.objects.all(), [])
850.         self.assertQuerysetEqual(Note.objects.all() & Note.objects.none(), [])
851. 
852.     def test_ticket9411(self):
853.         # Make sure bump_prefix() (an internal Query method) doesn't (re-)break. It's
854.         # sufficient that this query runs without error.
855.         qs = Tag.objects.values_list('id', flat=True).order_by('id')
856.         qs.query.bump_prefix(qs.query)
857.         first = qs[0]
858.         self.assertEqual(list(qs), list(range(first, first + 5)))
859. 
860.     def test_ticket8439(self):
861.         # Complex combinations of conjunctions, disjunctions and nullable
862.         # relations.
863.         self.assertQuerysetEqual(
864.             Author.objects.filter(Q(item__note__extrainfo=self.e2) | Q(report=self.r1, name='xyz')),
865.             ['<Author: a2>']
866.         )
867.         self.assertQuerysetEqual(
868.             Author.objects.filter(Q(report=self.r1, name='xyz') | Q(item__note__extrainfo=self.e2)),
869.             ['<Author: a2>']
870.         )
871.         self.assertQuerysetEqual(
872.             Annotation.objects.filter(Q(tag__parent=self.t1) | Q(notes__note='n1', name='a1')),
873.             ['<Annotation: a1>']
874.         )
875.         xx = ExtraInfo.objects.create(info='xx', note=self.n3)
876.         self.assertQuerysetEqual(
877.             Note.objects.filter(Q(extrainfo__author=self.a1) | Q(extrainfo=xx)),
878.             ['<Note: n1>', '<Note: n3>']
879.         )
880.         q = Note.objects.filter(Q(extrainfo__author=self.a1) | Q(extrainfo=xx)).query
881.         self.assertEqual(
882.             len([x for x in q.alias_map.values() if x.join_type == LOUTER and q.alias_refcount[x.table_alias]]),
883.             1
884.         )
885. 
886.     def test_ticket17429(self):
887.         """
888.         Meta.ordering=None works the same as Meta.ordering=[]
889.         """
890.         original_ordering = Tag._meta.ordering
891.         Tag._meta.ordering = None
892.         try:
893.             self.assertQuerysetEqual(
894.                 Tag.objects.all(),
895.                 ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
896.                 ordered=False
897.             )
898.         finally:
899.             Tag._meta.ordering = original_ordering
900. 
901.     def test_exclude(self):
902.         self.assertQuerysetEqual(
903.             Item.objects.exclude(tags__name='t4'),
904.             [repr(i) for i in Item.objects.filter(~Q(tags__name='t4'))])
905.         self.assertQuerysetEqual(
906.             Item.objects.exclude(Q(tags__name='t4') | Q(tags__name='t3')),
907.             [repr(i) for i in Item.objects.filter(~(Q(tags__name='t4') | Q(tags__name='t3')))])
908.         self.assertQuerysetEqual(
909.             Item.objects.exclude(Q(tags__name='t4') | ~Q(tags__name='t3')),
910.             [repr(i) for i in Item.objects.filter(~(Q(tags__name='t4') | ~Q(tags__name='t3')))])
911. 
912.     def test_nested_exclude(self):
913.         self.assertQuerysetEqual(
914.             Item.objects.exclude(~Q(tags__name='t4')),
915.             [repr(i) for i in Item.objects.filter(~~Q(tags__name='t4'))])
916. 
917.     def test_double_exclude(self):
918.         self.assertQuerysetEqual(
919.             Item.objects.filter(Q(tags__name='t4')),
920.             [repr(i) for i in Item.objects.filter(~~Q(tags__name='t4'))])
921.         self.assertQuerysetEqual(
922.             Item.objects.filter(Q(tags__name='t4')),
923.             [repr(i) for i in Item.objects.filter(~Q(~Q(tags__name='t4')))])
924. 
925.     def test_exclude_in(self):
926.         self.assertQuerysetEqual(
927.             Item.objects.exclude(Q(tags__name__in=['t4', 't3'])),
928.             [repr(i) for i in Item.objects.filter(~Q(tags__name__in=['t4', 't3']))])
929.         self.assertQuerysetEqual(
930.             Item.objects.filter(Q(tags__name__in=['t4', 't3'])),
931.             [repr(i) for i in Item.objects.filter(~~Q(tags__name__in=['t4', 't3']))])
932. 
933.     def test_ticket_10790_1(self):
934.         # Querying direct fields with isnull should trim the left outer join.
935.         # It also should not create INNER JOIN.
936.         q = Tag.objects.filter(parent__isnull=True)
937. 
938.         self.assertQuerysetEqual(q, ['<Tag: t1>'])
939.         self.assertNotIn('JOIN', str(q.query))
940. 
941.         q = Tag.objects.filter(parent__isnull=False)
942. 
943.         self.assertQuerysetEqual(
944.             q,
945.             ['<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
946.         )
947.         self.assertNotIn('JOIN', str(q.query))
948. 
949.         q = Tag.objects.exclude(parent__isnull=True)
950.         self.assertQuerysetEqual(
951.             q,
952.             ['<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
953.         )
954.         self.assertNotIn('JOIN', str(q.query))
955. 
956.         q = Tag.objects.exclude(parent__isnull=False)
957.         self.assertQuerysetEqual(q, ['<Tag: t1>'])
958.         self.assertNotIn('JOIN', str(q.query))
959. 
960.         q = Tag.objects.exclude(parent__parent__isnull=False)
961. 
962.         self.assertQuerysetEqual(
963.             q,
964.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>'],
965.         )
966.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
967.         self.assertNotIn('INNER JOIN', str(q.query))
968. 
969.     def test_ticket_10790_2(self):
970.         # Querying across several tables should strip only the last outer join,
971.         # while preserving the preceding inner joins.
972.         q = Tag.objects.filter(parent__parent__isnull=False)
973. 
974.         self.assertQuerysetEqual(
975.             q,
976.             ['<Tag: t4>', '<Tag: t5>'],
977.         )
978.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
979.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
980. 
981.         # Querying without isnull should not convert anything to left outer join.
982.         q = Tag.objects.filter(parent__parent=self.t1)
983.         self.assertQuerysetEqual(
984.             q,
985.             ['<Tag: t4>', '<Tag: t5>'],
986.         )
987.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
988.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
989. 
990.     def test_ticket_10790_3(self):
991.         # Querying via indirect fields should populate the left outer join
992.         q = NamedCategory.objects.filter(tag__isnull=True)
993.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
994.         # join to dumbcategory ptr_id
995.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
996.         self.assertQuerysetEqual(q, [])
997. 
998.         # Querying across several tables should strip only the last join, while
999.         # preserving the preceding left outer joins.
1000.         q = NamedCategory.objects.filter(tag__parent__isnull=True)
1001.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
1002.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
1003.         self.assertQuerysetEqual(q, ['<NamedCategory: Generic>'])
1004. 
1005.     def test_ticket_10790_4(self):
1006.         # Querying across m2m field should not strip the m2m table from join.
1007.         q = Author.objects.filter(item__tags__isnull=True)
1008.         self.assertQuerysetEqual(
1009.             q,
1010.             ['<Author: a2>', '<Author: a3>'],
1011.         )
1012.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 2)
1013.         self.assertNotIn('INNER JOIN', str(q.query))
1014. 
1015.         q = Author.objects.filter(item__tags__parent__isnull=True)
1016.         self.assertQuerysetEqual(
1017.             q,
1018.             ['<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a3>'],
1019.         )
1020.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 3)
1021.         self.assertNotIn('INNER JOIN', str(q.query))
1022. 
1023.     def test_ticket_10790_5(self):
1024.         # Querying with isnull=False across m2m field should not create outer joins
1025.         q = Author.objects.filter(item__tags__isnull=False)
1026.         self.assertQuerysetEqual(
1027.             q,
1028.             ['<Author: a1>', '<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a4>']
1029.         )
1030.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1031.         self.assertEqual(str(q.query).count('INNER JOIN'), 2)
1032. 
1033.         q = Author.objects.filter(item__tags__parent__isnull=False)
1034.         self.assertQuerysetEqual(
1035.             q,
1036.             ['<Author: a1>', '<Author: a2>', '<Author: a4>']
1037.         )
1038.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1039.         self.assertEqual(str(q.query).count('INNER JOIN'), 3)
1040. 
1041.         q = Author.objects.filter(item__tags__parent__parent__isnull=False)
1042.         self.assertQuerysetEqual(
1043.             q,
1044.             ['<Author: a4>']
1045.         )
1046.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1047.         self.assertEqual(str(q.query).count('INNER JOIN'), 4)
1048. 
1049.     def test_ticket_10790_6(self):
1050.         # Querying with isnull=True across m2m field should not create inner joins
1051.         # and strip last outer join
1052.         q = Author.objects.filter(item__tags__parent__parent__isnull=True)
1053.         self.assertQuerysetEqual(
1054.             q,
1055.             ['<Author: a1>', '<Author: a1>', '<Author: a2>', '<Author: a2>',
1056.              '<Author: a2>', '<Author: a3>']
1057.         )
1058.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 4)
1059.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1060. 
1061.         q = Author.objects.filter(item__tags__parent__isnull=True)
1062.         self.assertQuerysetEqual(
1063.             q,
1064.             ['<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a3>']
1065.         )
1066.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 3)
1067.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1068. 
1069.     def test_ticket_10790_7(self):
1070.         # Reverse querying with isnull should not strip the join
1071.         q = Author.objects.filter(item__isnull=True)
1072.         self.assertQuerysetEqual(
1073.             q,
1074.             ['<Author: a3>']
1075.         )
1076.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 1)
1077.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1078. 
1079.         q = Author.objects.filter(item__isnull=False)
1080.         self.assertQuerysetEqual(
1081.             q,
1082.             ['<Author: a1>', '<Author: a2>', '<Author: a2>', '<Author: a4>']
1083.         )
1084.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1085.         self.assertEqual(str(q.query).count('INNER JOIN'), 1)
1086. 
1087.     def test_ticket_10790_8(self):
1088.         # Querying with combined q-objects should also strip the left outer join
1089.         q = Tag.objects.filter(Q(parent__isnull=True) | Q(parent=self.t1))
1090.         self.assertQuerysetEqual(
1091.             q,
1092.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1093.         )
1094.         self.assertEqual(str(q.query).count('LEFT OUTER JOIN'), 0)
1095.         self.assertEqual(str(q.query).count('INNER JOIN'), 0)
1096. 
1097.     def test_ticket_10790_combine(self):
1098.         # Combining queries should not re-populate the left outer join
1099.         q1 = Tag.objects.filter(parent__isnull=True)
1100.         q2 = Tag.objects.filter(parent__isnull=False)
1101. 
1102.         q3 = q1 | q2
1103.         self.assertQuerysetEqual(
1104.             q3,
1105.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>', '<Tag: t4>', '<Tag: t5>'],
1106.         )
1107.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1108.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1109. 
1110.         q3 = q1 & q2
1111.         self.assertQuerysetEqual(q3, [])
1112.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1113.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1114. 
1115.         q2 = Tag.objects.filter(parent=self.t1)
1116.         q3 = q1 | q2
1117.         self.assertQuerysetEqual(
1118.             q3,
1119.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1120.         )
1121.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1122.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1123. 
1124.         q3 = q2 | q1
1125.         self.assertQuerysetEqual(
1126.             q3,
1127.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1128.         )
1129.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 0)
1130.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1131. 
1132.         q1 = Tag.objects.filter(parent__isnull=True)
1133.         q2 = Tag.objects.filter(parent__parent__isnull=True)
1134. 
1135.         q3 = q1 | q2
1136.         self.assertQuerysetEqual(
1137.             q3,
1138.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1139.         )
1140.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 1)
1141.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1142. 
1143.         q3 = q2 | q1
1144.         self.assertQuerysetEqual(
1145.             q3,
1146.             ['<Tag: t1>', '<Tag: t2>', '<Tag: t3>']
1147.         )
1148.         self.assertEqual(str(q3.query).count('LEFT OUTER JOIN'), 1)
1149.         self.assertEqual(str(q3.query).count('INNER JOIN'), 0)
1150. 
1151.     def test_ticket19672(self):
1152.         self.assertQuerysetEqual(
1153.             Report.objects.filter(Q(creator__isnull=False) & ~Q(creator__extra__value=41)),
1154.             ['<Report: r1>']
1155.         )
1156. 
1157.     def test_ticket_20250(self):
1158.         # A negated Q along with an annotated queryset failed in Django 1.4
1159.         qs = Author.objects.annotate(Count('item'))
1160.         qs = qs.filter(~Q(extra__value=0)).order_by('name')
1161. 
1162.         self.assertIn('SELECT', str(qs.query))
1163.         self.assertQuerysetEqual(
1164.             qs,
1165.             ['<Author: a1>', '<Author: a2>', '<Author: a3>', '<Author: a4>']
1166.         )
1167. 
1168.     def test_lookup_constraint_fielderror(self):
1169.         msg = (
1170.             "Cannot resolve keyword 'unknown_field' into field. Choices are: "
1171.             "annotation, category, category_id, children, id, item, "
1172.             "managedmodel, name, note, parent, parent_id"
1173.         )
1174.         with self.assertRaisesMessage(FieldError, msg):
1175.             Tag.objects.filter(unknown_field__name='generic')
1176. 
1177.     def test_common_mixed_case_foreign_keys(self):
1178.         """
1179.         Valid query should be generated when fields fetched from joined tables
1180.         include FKs whose names only differ by case.
1181.         """
1182.         c1 = SimpleCategory.objects.create(name='c1')
1183.         c2 = SimpleCategory.objects.create(name='c2')
1184.         c3 = SimpleCategory.objects.create(name='c3')
1185.         category = CategoryItem.objects.create(category=c1)
1186.         mixed_case_field_category = MixedCaseFieldCategoryItem.objects.create(CaTeGoRy=c2)
1187.         mixed_case_db_column_category = MixedCaseDbColumnCategoryItem.objects.create(category=c3)
1188.         CommonMixedCaseForeignKeys.objects.create(
1189.             category=category,
1190.             mixed_case_field_category=mixed_case_field_category,
1191.             mixed_case_db_column_category=mixed_case_db_column_category,
1192.         )
1193.         qs = CommonMixedCaseForeignKeys.objects.values(
1194.             'category',
1195.             'mixed_case_field_category',
1196.             'mixed_case_db_column_category',
1197.             'category__category',
1198.             'mixed_case_field_category__CaTeGoRy',
1199.             'mixed_case_db_column_category__category',
1200.         )
1201.         self.assertTrue(qs.first())
1202. 
1203.     def test_excluded_intermediary_m2m_table_joined(self):
1204.         self.assertSequenceEqual(
1205.             Note.objects.filter(~Q(tag__annotation__name=F('note'))),
1206.             [self.n1, self.n2, self.n3],
1207.         )
1208.         self.assertSequenceEqual(
1209.             Note.objects.filter(tag__annotation__name='a1').filter(~Q(tag__annotation__name=F('note'))),
1210.             [],
1211.         )
1212. 
1213.     def test_field_with_filterable(self):
1214.         self.assertSequenceEqual(
1215.             Author.objects.filter(extra=self.e2),
1216.             [self.a3, self.a4],
1217.         )
1218. 
1219. 
1220. class Queries2Tests(TestCase):
1221.     @classmethod
1222.     def setUpTestData(cls):
1223.         Number.objects.create(num=4)
1224.         Number.objects.create(num=8)
1225.         Number.objects.create(num=12)
1226. 
1227.     def test_ticket4289(self):
1228.         # A slight variation on the restricting the filtering choices by the
1229.         # lookup constraints.
1230.         self.assertQuerysetEqual(Number.objects.filter(num__lt=4), [])
1231.         self.assertQuerysetEqual(Number.objects.filter(num__gt=8, num__lt=12), [])
1232.         self.assertQuerysetEqual(
1233.             Number.objects.filter(num__gt=8, num__lt=13),
1234.             ['<Number: 12>']
1235.         )
1236.         self.assertQuerysetEqual(
1237.             Number.objects.filter(Q(num__lt=4) | Q(num__gt=8, num__lt=12)),
1238.             []
1239.         )
1240.         self.assertQuerysetEqual(
1241.             Number.objects.filter(Q(num__gt=8, num__lt=12) | Q(num__lt=4)),
1242.             []
1243.         )
1244.         self.assertQuerysetEqual(
1245.             Number.objects.filter(Q(num__gt=8) & Q(num__lt=12) | Q(num__lt=4)),
1246.             []
1247.         )
1248.         self.assertQuerysetEqual(
1249.             Number.objects.filter(Q(num__gt=7) & Q(num__lt=12) | Q(num__lt=4)),
1250.             ['<Number: 8>']
1251.         )
1252. 
1253.     def test_ticket12239(self):
1254.         # Custom lookups are registered to round float values correctly on gte
1255.         # and lt IntegerField queries.
1256.         self.assertQuerysetEqual(
1257.             Number.objects.filter(num__gt=11.9),
1258.             ['<Number: 12>']
1259.         )
1260.         self.assertQuerysetEqual(Number.objects.filter(num__gt=12), [])
1261.         self.assertQuerysetEqual(Number.objects.filter(num__gt=12.0), [])
1262.         self.assertQuerysetEqual(Number.objects.filter(num__gt=12.1), [])
1263.         self.assertQuerysetEqual(
1264.             Number.objects.filter(num__lt=12),
1265.             ['<Number: 4>', '<Number: 8>'],
1266.             ordered=False
1267.         )
1268.         self.assertQuerysetEqual(
1269.             Number.objects.filter(num__lt=12.0),
1270.             ['<Number: 4>', '<Number: 8>'],
1271.             ordered=False
1272.         )
1273.         self.assertQuerysetEqual(
1274.             Number.objects.filter(num__lt=12.1),
1275.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1276.             ordered=False
1277.         )
1278.         self.assertQuerysetEqual(
1279.             Number.objects.filter(num__gte=11.9),
1280.             ['<Number: 12>']
1281.         )
1282.         self.assertQuerysetEqual(
1283.             Number.objects.filter(num__gte=12),
1284.             ['<Number: 12>']
1285.         )
1286.         self.assertQuerysetEqual(
1287.             Number.objects.filter(num__gte=12.0),
1288.             ['<Number: 12>']
1289.         )
1290.         self.assertQuerysetEqual(Number.objects.filter(num__gte=12.1), [])
1291.         self.assertQuerysetEqual(Number.objects.filter(num__gte=12.9), [])
1292.         self.assertQuerysetEqual(
1293.             Number.objects.filter(num__lte=11.9),
1294.             ['<Number: 4>', '<Number: 8>'],
1295.             ordered=False
1296.         )
1297.         self.assertQuerysetEqual(
1298.             Number.objects.filter(num__lte=12),
1299.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1300.             ordered=False
1301.         )
1302.         self.assertQuerysetEqual(
1303.             Number.objects.filter(num__lte=12.0),
1304.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1305.             ordered=False
1306.         )
1307.         self.assertQuerysetEqual(
1308.             Number.objects.filter(num__lte=12.1),
1309.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1310.             ordered=False
1311.         )
1312.         self.assertQuerysetEqual(
1313.             Number.objects.filter(num__lte=12.9),
1314.             ['<Number: 4>', '<Number: 8>', '<Number: 12>'],
1315.             ordered=False
1316.         )
1317. 
1318.     def test_ticket7759(self):
1319.         # Count should work with a partially read result set.
1320.         count = Number.objects.count()
1321.         qs = Number.objects.all()
1322. 
1323.         def run():
1324.             for obj in qs:
1325.                 return qs.count() == count
1326.         self.assertTrue(run())
1327. 
1328. 
1329. class Queries3Tests(TestCase):
1330.     def test_ticket7107(self):
1331.         # This shouldn't create an infinite loop.
1332.         self.assertQuerysetEqual(Valid.objects.all(), [])
1333. 
1334.     def test_ticket8683(self):
1335.         # An error should be raised when QuerySet.datetimes() is passed the
1336.         # wrong type of field.
1337.         with self.assertRaisesMessage(AssertionError, "'name' isn't a DateField, TimeField, or DateTimeField."):
1338.             Item.objects.datetimes('name', 'month')
1339. 
1340.     def test_ticket22023(self):
1341.         with self.assertRaisesMessage(TypeError, "Cannot call only() after .values() or .values_list()"):
1342.             Valid.objects.values().only()
1343. 
1344.         with self.assertRaisesMessage(TypeError, "Cannot call defer() after .values() or .values_list()"):
1345.             Valid.objects.values().defer()
1346. 
1347. 
1348. class Queries4Tests(TestCase):
1349.     @classmethod
1350.     def setUpTestData(cls):
1351.         generic = NamedCategory.objects.create(name="Generic")
1352.         cls.t1 = Tag.objects.create(name='t1', category=generic)
1353. 
1354.         n1 = Note.objects.create(note='n1', misc='foo')
1355.         n2 = Note.objects.create(note='n2', misc='bar')
1356. 
1357.         e1 = ExtraInfo.objects.create(info='e1', note=n1)
1358.         e2 = ExtraInfo.objects.create(info='e2', note=n2)
1359. 
1360.         cls.a1 = Author.objects.create(name='a1', num=1001, extra=e1)
1361.         cls.a3 = Author.objects.create(name='a3', num=3003, extra=e2)
1362. 
1363.         cls.r1 = Report.objects.create(name='r1', creator=cls.a1)
1364.         cls.r2 = Report.objects.create(name='r2', creator=cls.a3)
1365.         cls.r3 = Report.objects.create(name='r3')
1366. 
1367.         Item.objects.create(name='i1', created=datetime.datetime.now(), note=n1, creator=cls.a1)
1368.         Item.objects.create(name='i2', created=datetime.datetime.now(), note=n1, creator=cls.a3)
1369. 
1370.     def test_ticket24525(self):
1371.         tag = Tag.objects.create()
1372.         anth100 = tag.note_set.create(note='ANTH', misc='100')
1373.         math101 = tag.note_set.create(note='MATH', misc='101')
1374.         s1 = tag.annotation_set.create(name='1')
1375.         s2 = tag.annotation_set.create(name='2')
1376.         s1.notes.set([math101, anth100])
1377.         s2.notes.set([math101])
1378.         result = math101.annotation_set.all() & tag.annotation_set.exclude(notes__in=[anth100])
1379.         self.assertEqual(list(result), [s2])
1380. 
1381.     def test_ticket11811(self):
1382.         unsaved_category = NamedCategory(name="Other")
1383.         msg = 'Unsaved model instance <NamedCategory: Other> cannot be used in an ORM query.'
1384.         with self.assertRaisesMessage(ValueError, msg):
1385.             Tag.objects.filter(pk=self.t1.pk).update(category=unsaved_category)
1386. 
1387.     def test_ticket14876(self):
1388.         # Note: when combining the query we need to have information available
1389.         # about the join type of the trimmed "creator__isnull" join. If we
1390.         # don't have that information, then the join is created as INNER JOIN
1391.         # and results will be incorrect.
1392.         q1 = Report.objects.filter(Q(creator__isnull=True) | Q(creator__extra__info='e1'))
1393.         q2 = Report.objects.filter(Q(creator__isnull=True)) | Report.objects.filter(Q(creator__extra__info='e1'))
1394.         self.assertQuerysetEqual(q1, ["<Report: r1>", "<Report: r3>"], ordered=False)
1395.         self.assertEqual(str(q1.query), str(q2.query))
1396. 
1397.         q1 = Report.objects.filter(Q(creator__extra__info='e1') | Q(creator__isnull=True))
1398.         q2 = Report.objects.filter(Q(creator__extra__info='e1')) | Report.objects.filter(Q(creator__isnull=True))
1399.         self.assertQuerysetEqual(q1, ["<Report: r1>", "<Report: r3>"], ordered=False)
1400.         self.assertEqual(str(q1.query), str(q2.query))
1401. 
1402.         q1 = Item.objects.filter(Q(creator=self.a1) | Q(creator__report__name='r1')).order_by()
1403.         q2 = (
1404.             Item.objects
1405.             .filter(Q(creator=self.a1)).order_by() | Item.objects.filter(Q(creator__report__name='r1'))
1406.             .order_by()
1407.         )
1408.         self.assertQuerysetEqual(q1, ["<Item: i1>"])
1409.         self.assertEqual(str(q1.query), str(q2.query))
1410. 
1411.         q1 = Item.objects.filter(Q(creator__report__name='e1') | Q(creator=self.a1)).order_by()
1412.         q2 = (
1413.             Item.objects.filter(Q(creator__report__name='e1')).order_by() |
1414.             Item.objects.filter(Q(creator=self.a1)).order_by()
1415.         )
1416.         self.assertQuerysetEqual(q1, ["<Item: i1>"])
1417.         self.assertEqual(str(q1.query), str(q2.query))
1418. 
1419.     def test_combine_join_reuse(self):
1420.         # Joins having identical connections are correctly recreated in the
1421.         # rhs query, in case the query is ORed together (#18748).
1422.         Report.objects.create(name='r4', creator=self.a1)
1423.         q1 = Author.objects.filter(report__name='r5')
1424.         q2 = Author.objects.filter(report__name='r4').filter(report__name='r1')
1425.         combined = q1 | q2
1426.         self.assertEqual(str(combined.query).count('JOIN'), 2)
1427.         self.assertEqual(len(combined), 1)
1428.         self.assertEqual(combined[0].name, 'a1')
1429. 
1430.     def test_join_reuse_order(self):
1431.         # Join aliases are reused in order. This shouldn't raise AssertionError
1432.         # because change_map contains a circular reference (#26522).
1433.         s1 = School.objects.create()
1434.         s2 = School.objects.create()
1435.         s3 = School.objects.create()
1436.         t1 = Teacher.objects.create()
1437.         otherteachers = Teacher.objects.exclude(pk=t1.pk).exclude(friends=t1)
1438.         qs1 = otherteachers.filter(schools=s1).filter(schools=s2)
1439.         qs2 = otherteachers.filter(schools=s1).filter(schools=s3)
1440.         self.assertQuerysetEqual(qs1 | qs2, [])
1441. 
1442.     def test_ticket7095(self):
1443.         # Updates that are filtered on the model being updated are somewhat
1444.         # tricky in MySQL.
1445.         ManagedModel.objects.create(data='mm1', tag=self.t1, public=True)
1446.         self.assertEqual(ManagedModel.objects.update(data='mm'), 1)
1447. 
1448.         # A values() or values_list() query across joined models must use outer
1449.         # joins appropriately.
1450.         # Note: In Oracle, we expect a null CharField to return '' instead of
1451.         # None.
1452.         if connection.features.interprets_empty_strings_as_nulls:
1453.             expected_null_charfield_repr = ''
1454.         else:
1455.             expected_null_charfield_repr = None
1456.         self.assertSequenceEqual(
1457.             Report.objects.values_list("creator__extra__info", flat=True).order_by("name"),
1458.             ['e1', 'e2', expected_null_charfield_repr],
1459.         )
1460. 
1461.         # Similarly for select_related(), joins beyond an initial nullable join
1462.         # must use outer joins so that all results are included.
1463.         self.assertQuerysetEqual(
1464.             Report.objects.select_related("creator", "creator__extra").order_by("name"),
1465.             ['<Report: r1>', '<Report: r2>', '<Report: r3>']
1466.         )
1467. 
1468.         # When there are multiple paths to a table from another table, we have
1469.         # to be careful not to accidentally reuse an inappropriate join when
1470.         # using select_related(). We used to return the parent's Detail record
1471.         # here by mistake.
1472. 
1473.         d1 = Detail.objects.create(data="d1")
1474.         d2 = Detail.objects.create(data="d2")
1475.         m1 = Member.objects.create(name="m1", details=d1)
1476.         m2 = Member.objects.create(name="m2", details=d2)
1477.         Child.objects.create(person=m2, parent=m1)
1478.         obj = m1.children.select_related("person__details")[0]
1479.         self.assertEqual(obj.person.details.data, 'd2')
1480. 
1481.     def test_order_by_resetting(self):
1482.         # Calling order_by() with no parameters removes any existing ordering on the
1483.         # model. But it should still be possible to add new ordering after that.
1484.         qs = Author.objects.order_by().order_by('name')
1485.         self.assertIn('ORDER BY', qs.query.get_compiler(qs.db).as_sql()[0])
1486. 
1487.     def test_order_by_reverse_fk(self):
1488.         # It is possible to order by reverse of foreign key, although that can lead
1489.         # to duplicate results.
1490.         c1 = SimpleCategory.objects.create(name="category1")
1491.         c2 = SimpleCategory.objects.create(name="category2")
1492.         CategoryItem.objects.create(category=c1)
1493.         CategoryItem.objects.create(category=c2)
1494.         CategoryItem.objects.create(category=c1)
1495.         self.assertSequenceEqual(SimpleCategory.objects.order_by('categoryitem', 'pk'), [c1, c2, c1])
1496. 
1497.     def test_filter_reverse_non_integer_pk(self):
1498.         date_obj = DateTimePK.objects.create()
1499.         extra_obj = ExtraInfo.objects.create(info='extra', date=date_obj)
1500.         self.assertEqual(
1501.             DateTimePK.objects.filter(extrainfo=extra_obj).get(),
1502.             date_obj,
1503.         )
1504. 
1505.     def test_ticket10181(self):
1506.         # Avoid raising an EmptyResultSet if an inner query is probably
1507.         # empty (and hence, not executed).
1508.         self.assertQuerysetEqual(
1509.             Tag.objects.filter(id__in=Tag.objects.filter(id__in=[])),
1510.             []
1511.         )
1512. 
1513.     def test_ticket15316_filter_false(self):
1514.         c1 = SimpleCategory.objects.create(name="category1")
1515.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1516.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1517. 
1518.         CategoryItem.objects.create(category=c1)
1519.         ci2 = CategoryItem.objects.create(category=c2)
1520.         ci3 = CategoryItem.objects.create(category=c3)
1521. 
1522.         qs = CategoryItem.objects.filter(category__specialcategory__isnull=False)
1523.         self.assertEqual(qs.count(), 2)
1524.         self.assertSequenceEqual(qs, [ci2, ci3])
1525. 
1526.     def test_ticket15316_exclude_false(self):
1527.         c1 = SimpleCategory.objects.create(name="category1")
1528.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1529.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1530. 
1531.         ci1 = CategoryItem.objects.create(category=c1)
1532.         CategoryItem.objects.create(category=c2)
1533.         CategoryItem.objects.create(category=c3)
1534. 
1535.         qs = CategoryItem.objects.exclude(category__specialcategory__isnull=False)
1536.         self.assertEqual(qs.count(), 1)
1537.         self.assertSequenceEqual(qs, [ci1])
1538. 
1539.     def test_ticket15316_filter_true(self):
1540.         c1 = SimpleCategory.objects.create(name="category1")
1541.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1542.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1543. 
1544.         ci1 = CategoryItem.objects.create(category=c1)
1545.         CategoryItem.objects.create(category=c2)
1546.         CategoryItem.objects.create(category=c3)
1547. 
1548.         qs = CategoryItem.objects.filter(category__specialcategory__isnull=True)
1549.         self.assertEqual(qs.count(), 1)
1550.         self.assertSequenceEqual(qs, [ci1])
1551. 
1552.     def test_ticket15316_exclude_true(self):
1553.         c1 = SimpleCategory.objects.create(name="category1")
1554.         c2 = SpecialCategory.objects.create(name="named category1", special_name="special1")
1555.         c3 = SpecialCategory.objects.create(name="named category2", special_name="special2")
1556. 
1557.         CategoryItem.objects.create(category=c1)
1558.         ci2 = CategoryItem.objects.create(category=c2)
1559.         ci3 = CategoryItem.objects.create(category=c3)
1560. 
1561.         qs = CategoryItem.objects.exclude(category__specialcategory__isnull=True)
1562.         self.assertEqual(qs.count(), 2)
1563.         self.assertSequenceEqual(qs, [ci2, ci3])
1564. 
1565.     def test_ticket15316_one2one_filter_false(self):
1566.         c = SimpleCategory.objects.create(name="cat")
1567.         c0 = SimpleCategory.objects.create(name="cat0")
1568.         c1 = SimpleCategory.objects.create(name="category1")
1569. 
1570.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1571.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1572. 
1573.         CategoryItem.objects.create(category=c)
1574.         ci2 = CategoryItem.objects.create(category=c0)
1575.         ci3 = CategoryItem.objects.create(category=c1)
1576. 
1577.         qs = CategoryItem.objects.filter(category__onetoonecategory__isnull=False).order_by('pk')
1578.         self.assertEqual(qs.count(), 2)
1579.         self.assertSequenceEqual(qs, [ci2, ci3])
1580. 
1581.     def test_ticket15316_one2one_exclude_false(self):
1582.         c = SimpleCategory.objects.create(name="cat")
1583.         c0 = SimpleCategory.objects.create(name="cat0")
1584.         c1 = SimpleCategory.objects.create(name="category1")
1585. 
1586.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1587.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1588. 
1589.         ci1 = CategoryItem.objects.create(category=c)
1590.         CategoryItem.objects.create(category=c0)
1591.         CategoryItem.objects.create(category=c1)
1592. 
1593.         qs = CategoryItem.objects.exclude(category__onetoonecategory__isnull=False)
1594.         self.assertEqual(qs.count(), 1)
1595.         self.assertSequenceEqual(qs, [ci1])
1596. 
1597.     def test_ticket15316_one2one_filter_true(self):
1598.         c = SimpleCategory.objects.create(name="cat")
1599.         c0 = SimpleCategory.objects.create(name="cat0")
1600.         c1 = SimpleCategory.objects.create(name="category1")
1601. 
1602.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1603.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1604. 
1605.         ci1 = CategoryItem.objects.create(category=c)
1606.         CategoryItem.objects.create(category=c0)
1607.         CategoryItem.objects.create(category=c1)
1608. 
1609.         qs = CategoryItem.objects.filter(category__onetoonecategory__isnull=True)
1610.         self.assertEqual(qs.count(), 1)
1611.         self.assertSequenceEqual(qs, [ci1])
1612. 
1613.     def test_ticket15316_one2one_exclude_true(self):
1614.         c = SimpleCategory.objects.create(name="cat")
1615.         c0 = SimpleCategory.objects.create(name="cat0")
1616.         c1 = SimpleCategory.objects.create(name="category1")
1617. 
1618.         OneToOneCategory.objects.create(category=c1, new_name="new1")
1619.         OneToOneCategory.objects.create(category=c0, new_name="new2")
1620. 
1621.         CategoryItem.objects.create(category=c)
1622.         ci2 = CategoryItem.objects.create(category=c0)
1623.         ci3 = CategoryItem.objects.create(category=c1)
1624. 
1625.         qs = CategoryItem.objects.exclude(category__onetoonecategory__isnull=True).order_by('pk')
1626.         self.assertEqual(qs.count(), 2)
1627.         self.assertSequenceEqual(qs, [ci2, ci3])
1628. 
1629. 
1630. class Queries5Tests(TestCase):
1631.     @classmethod
1632.     def setUpTestData(cls):
1633.         # Ordering by 'rank' gives us rank2, rank1, rank3. Ordering by the
1634.         # Meta.ordering will be rank3, rank2, rank1.
1635.         n1 = Note.objects.create(note='n1', misc='foo', id=1)
1636.         n2 = Note.objects.create(note='n2', misc='bar', id=2)
1637.         e1 = ExtraInfo.objects.create(info='e1', note=n1)
1638.         e2 = ExtraInfo.objects.create(info='e2', note=n2)
1639.         a1 = Author.objects.create(name='a1', num=1001, extra=e1)
1640.         a2 = Author.objects.create(name='a2', num=2002, extra=e1)
1641.         a3 = Author.objects.create(name='a3', num=3003, extra=e2)
1642.         cls.rank1 = Ranking.objects.create(rank=2, author=a2)
1643.         Ranking.objects.create(rank=1, author=a3)
1644.         Ranking.objects.create(rank=3, author=a1)
1645. 
1646.     def test_ordering(self):
1647.         # Cross model ordering is possible in Meta, too.
1648.         self.assertQuerysetEqual(
1649.             Ranking.objects.all(),
1650.             ['<Ranking: 3: a1>', '<Ranking: 2: a2>', '<Ranking: 1: a3>']
1651.         )
1652.         self.assertQuerysetEqual(
1653.             Ranking.objects.all().order_by('rank'),
1654.             ['<Ranking: 1: a3>', '<Ranking: 2: a2>', '<Ranking: 3: a1>']
1655.         )
1656. 
1657.         # Ordering of extra() pieces is possible, too and you can mix extra
1658.         # fields and model fields in the ordering.
1659.         self.assertQuerysetEqual(
1660.             Ranking.objects.extra(tables=['django_site'], order_by=['-django_site.id', 'rank']),
1661.             ['<Ranking: 1: a3>', '<Ranking: 2: a2>', '<Ranking: 3: a1>']
1662.         )
1663. 
1664.         sql = 'case when %s > 2 then 1 else 0 end' % connection.ops.quote_name('rank')
1665.         qs = Ranking.objects.extra(select={'good': sql})
1666.         self.assertEqual(
1667.             [o.good for o in qs.extra(order_by=('-good',))],
1668.             [True, False, False]
1669.         )
1670.         self.assertQuerysetEqual(
1671.             qs.extra(order_by=('-good', 'id')),
1672.             ['<Ranking: 3: a1>', '<Ranking: 2: a2>', '<Ranking: 1: a3>']
1673.         )
1674. 
1675.         # Despite having some extra aliases in the query, we can still omit
1676.         # them in a values() query.
1677.         dicts = qs.values('id', 'rank').order_by('id')
1678.         self.assertEqual(
1679.             [d['rank'] for d in dicts],
1680.             [2, 1, 3]
1681.         )
1682. 
1683.     def test_ticket7256(self):
1684.         # An empty values() call includes all aliases, including those from an
1685.         # extra()
1686.         sql = 'case when %s > 2 then 1 else 0 end' % connection.ops.quote_name('rank')
1687.         qs = Ranking.objects.extra(select={'good': sql})
1688.         dicts = qs.values().order_by('id')
1689.         for d in dicts:
1690.             del d['id']
1691.             del d['author_id']
1692.         self.assertEqual(
1693.             [sorted(d.items()) for d in dicts],
1694.             [[('good', 0), ('rank', 2)], [('good', 0), ('rank', 1)], [('good', 1), ('rank', 3)]]
1695.         )
1696. 
1697.     def test_ticket7045(self):
1698.         # Extra tables used to crash SQL construction on the second use.
1699.         qs = Ranking.objects.extra(tables=['django_site'])
1700.         qs.query.get_compiler(qs.db).as_sql()
1701.         # test passes if this doesn't raise an exception.
1702.         qs.query.get_compiler(qs.db).as_sql()
1703. 
1704.     def test_ticket9848(self):
1705.         # Make sure that updates which only filter on sub-tables don't
1706.         # inadvertently update the wrong records (bug #9848).
1707.         author_start = Author.objects.get(name='a1')
1708.         ranking_start = Ranking.objects.get(author__name='a1')
1709. 
1710.         # Make sure that the IDs from different tables don't happen to match.
1711.         self.assertQuerysetEqual(
1712.             Ranking.objects.filter(author__name='a1'),
1713.             ['<Ranking: 3: a1>']
1714.         )
1715.         self.assertEqual(
1716.             Ranking.objects.filter(author__name='a1').update(rank=4636),
1717.             1
1718.         )
1719. 
1720.         r = Ranking.objects.get(author__name='a1')
1721.         self.assertEqual(r.id, ranking_start.id)
1722.         self.assertEqual(r.author.id, author_start.id)
1723.         self.assertEqual(r.rank, 4636)
1724.         r.rank = 3
1725.         r.save()
1726.         self.assertQuerysetEqual(
1727.             Ranking.objects.all(),
1728.             ['<Ranking: 3: a1>', '<Ranking: 2: a2>', '<Ranking: 1: a3>']
1729.         )
1730. 
1731.     def test_ticket5261(self):
1732.         # Test different empty excludes.
1733.         self.assertQuerysetEqual(
1734.             Note.objects.exclude(Q()),
1735.             ['<Note: n1>', '<Note: n2>']
1736.         )
1737.         self.assertQuerysetEqual(
1738.             Note.objects.filter(~Q()),
1739.             ['<Note: n1>', '<Note: n2>']
1740.         )
1741.         self.assertQuerysetEqual(
1742.             Note.objects.filter(~Q() | ~Q()),
1743.             ['<Note: n1>', '<Note: n2>']
1744.         )
1745.         self.assertQuerysetEqual(
1746.             Note.objects.exclude(~Q() & ~Q()),
1747.             ['<Note: n1>', '<Note: n2>']
1748.         )
1749. 
1750.     def test_extra_select_literal_percent_s(self):
1751.         # Allow %%s to escape select clauses
1752.         self.assertEqual(
1753.             Note.objects.extra(select={'foo': "'%%s'"})[0].foo,
1754.             '%s'
1755.         )
1756.         self.assertEqual(
1757.             Note.objects.extra(select={'foo': "'%%s bar %%s'"})[0].foo,
1758.             '%s bar %s'
1759.         )
1760.         self.assertEqual(
1761.             Note.objects.extra(select={'foo': "'bar %%s'"})[0].foo,
1762.             'bar %s'
1763.         )
1764. 
1765. 
1766. class SelectRelatedTests(TestCase):
1767.     def test_tickets_3045_3288(self):
1768.         # Once upon a time, select_related() with circular relations would loop
1769.         # infinitely if you forgot to specify "depth". Now we set an arbitrary
1770.         # default upper bound.
1771.         self.assertQuerysetEqual(X.objects.all(), [])
1772.         self.assertQuerysetEqual(X.objects.select_related(), [])
1773. 
1774. 
1775. class SubclassFKTests(TestCase):
1776.     def test_ticket7778(self):
1777.         # Model subclasses could not be deleted if a nullable foreign key
1778.         # relates to a model that relates back.
1779. 
1780.         num_celebs = Celebrity.objects.count()
1781.         tvc = TvChef.objects.create(name="Huey")
1782.         self.assertEqual(Celebrity.objects.count(), num_celebs + 1)
1783.         Fan.objects.create(fan_of=tvc)
1784.         Fan.objects.create(fan_of=tvc)
1785.         tvc.delete()
1786. 
1787.         # The parent object should have been deleted as well.
1788.         self.assertEqual(Celebrity.objects.count(), num_celebs)
1789. 
1790. 
1791. class CustomPkTests(TestCase):
1792.     def test_ticket7371(self):
1793.         self.assertQuerysetEqual(Related.objects.order_by('custom'), [])
1794. 
1795. 
1796. class NullableRelOrderingTests(TestCase):
1797.     def test_ticket10028(self):
1798.         # Ordering by model related to nullable relations(!) should use outer
1799.         # joins, so that all results are included.
1800.         Plaything.objects.create(name="p1")
1801.         self.assertQuerysetEqual(
1802.             Plaything.objects.all(),
1803.             ['<Plaything: p1>']
1804.         )
1805. 
1806.     def test_join_already_in_query(self):
1807.         # Ordering by model related to nullable relations should not change
1808.         # the join type of already existing joins.
1809.         Plaything.objects.create(name="p1")
1810.         s = SingleObject.objects.create(name='s')
1811.         r = RelatedObject.objects.create(single=s, f=1)
1812.         Plaything.objects.create(name="p2", others=r)
1813.         qs = Plaything.objects.all().filter(others__isnull=False).order_by('pk')
1814.         self.assertNotIn('JOIN', str(qs.query))
1815.         qs = Plaything.objects.all().filter(others__f__isnull=False).order_by('pk')
1816.         self.assertIn('INNER', str(qs.query))
1817.         qs = qs.order_by('others__single__name')
1818.         # The ordering by others__single__pk will add one new join (to single)
1819.         # and that join must be LEFT join. The already existing join to related
1820.         # objects must be kept INNER. So, we have both an INNER and a LEFT join
1821.         # in the query.
1822.         self.assertEqual(str(qs.query).count('LEFT'), 1)
1823.         self.assertEqual(str(qs.query).count('INNER'), 1)
1824.         self.assertQuerysetEqual(
1825.             qs,
1826.             ['<Plaything: p2>']
1827.         )
1828. 
1829. 
1830. class DisjunctiveFilterTests(TestCase):
1831.     @classmethod
1832.     def setUpTestData(cls):
1833.         cls.n1 = Note.objects.create(note='n1', misc='foo', id=1)
1834.         ExtraInfo.objects.create(info='e1', note=cls.n1)
1835. 
1836.     def test_ticket7872(self):
1837.         # Another variation on the disjunctive filtering theme.
1838. 
1839.         # For the purposes of this regression test, it's important that there is no
1840.         # Join object related to the LeafA we create.
1841.         LeafA.objects.create(data='first')
1842.         self.assertQuerysetEqual(LeafA.objects.all(), ['<LeafA: first>'])
1843.         self.assertQuerysetEqual(
1844.             LeafA.objects.filter(Q(data='first') | Q(join__b__data='second')),
1845.             ['<LeafA: first>']
1846.         )
1847. 
1848.     def test_ticket8283(self):
1849.         # Checking that applying filters after a disjunction works correctly.
1850.         self.assertQuerysetEqual(
1851.             (ExtraInfo.objects.filter(note=self.n1) | ExtraInfo.objects.filter(info='e2')).filter(note=self.n1),
1852.             ['<ExtraInfo: e1>']
1853.         )
1854.         self.assertQuerysetEqual(
1855.             (ExtraInfo.objects.filter(info='e2') | ExtraInfo.objects.filter(note=self.n1)).filter(note=self.n1),
1856.             ['<ExtraInfo: e1>']
1857.         )
1858. 
1859. 
1860. class Queries6Tests(TestCase):
1861.     @classmethod
1862.     def setUpTestData(cls):
1863.         generic = NamedCategory.objects.create(name="Generic")
1864.         cls.t1 = Tag.objects.create(name='t1', category=generic)
1865.         cls.t2 = Tag.objects.create(name='t2', parent=cls.t1, category=generic)
1866.         cls.t3 = Tag.objects.create(name='t3', parent=cls.t1)
1867.         cls.t4 = Tag.objects.create(name='t4', parent=cls.t3)
1868.         cls.t5 = Tag.objects.create(name='t5', parent=cls.t3)
1869.         n1 = Note.objects.create(note='n1', misc='foo', id=1)
1870.         ann1 = Annotation.objects.create(name='a1', tag=cls.t1)
1871.         ann1.notes.add(n1)
1872.         Annotation.objects.create(name='a2', tag=cls.t4)
1873. 
1874.     def test_parallel_iterators(self):
1875.         # Parallel iterators work.
1876.         qs = Tag.objects.all()
1877.         i1, i2 = iter(qs), iter(qs)
1878.         self.assertEqual(repr(next(i1)), '<Tag: t1>')
1879.         self.assertEqual(repr(next(i1)), '<Tag: t2>')
1880.         self.assertEqual(repr(next(i2)), '<Tag: t1>')
1881.         self.assertEqual(repr(next(i2)), '<Tag: t2>')
1882.         self.assertEqual(repr(next(i2)), '<Tag: t3>')
1883.         self.assertEqual(repr(next(i1)), '<Tag: t3>')
1884. 
1885.         qs = X.objects.all()
1886.         self.assertFalse(qs)
1887.         self.assertFalse(qs)
1888. 
1889.     def test_nested_queries_sql(self):
1890.         # Nested queries should not evaluate the inner query as part of constructing the
1891.         # SQL (so we should see a nested query here, indicated by two "SELECT" calls).
1892.         qs = Annotation.objects.filter(notes__in=Note.objects.filter(note="xyzzy"))
1893.         self.assertEqual(
1894.             qs.query.get_compiler(qs.db).as_sql()[0].count('SELECT'),
1895.             2
1896.         )
1897. 
1898.     def test_tickets_8921_9188(self):
1899.         # Incorrect SQL was being generated for certain types of exclude()
1900.         # queries that crossed multi-valued relations (#8921, #9188 and some
1901.         # preemptively discovered cases).
1902. 
1903.         self.assertQuerysetEqual(
1904.             PointerA.objects.filter(connection__pointerb__id=1),
1905.             []
1906.         )
1907.         self.assertQuerysetEqual(
1908.             PointerA.objects.exclude(connection__pointerb__id=1),
1909.             []
1910.         )
1911. 
1912.         self.assertQuerysetEqual(
1913.             Tag.objects.exclude(children=None),
1914.             ['<Tag: t1>', '<Tag: t3>']
1915.         )
1916. 
1917.         # This example is tricky because the parent could be NULL, so only checking
1918.         # parents with annotations omits some results (tag t1, in this case).
1919.         self.assertQuerysetEqual(
1920.             Tag.objects.exclude(parent__annotation__name="a1"),
1921.             ['<Tag: t1>', '<Tag: t4>', '<Tag: t5>']
1922.         )
1923. 
1924.         # The annotation->tag link is single values and tag->children links is
1925.         # multi-valued. So we have to split the exclude filter in the middle
1926.         # and then optimize the inner query without losing results.
1927.         self.assertQuerysetEqual(
1928.             Annotation.objects.exclude(tag__children__name="t2"),
1929.             ['<Annotation: a2>']
1930.         )
1931. 
1932.         # Nested queries are possible (although should be used with care, since
1933.         # they have performance problems on backends like MySQL.
1934.         self.assertQuerysetEqual(
1935.             Annotation.objects.filter(notes__in=Note.objects.filter(note="n1")),
1936.             ['<Annotation: a1>']
1937.         )
1938. 
1939.     def test_ticket3739(self):
1940.         # The all() method on querysets returns a copy of the queryset.
1941.         q1 = Tag.objects.order_by('name')
1942.         self.assertIsNot(q1, q1.all())
1943. 
1944.     def test_ticket_11320(self):
1945.         qs = Tag.objects.exclude(category=None).exclude(category__name='foo')
1946.         self.assertEqual(str(qs.query).count(' INNER JOIN '), 1)
1947. 
1948.     def test_distinct_ordered_sliced_subquery_aggregation(self):
1949.         self.assertEqual(Tag.objects.distinct().order_by('category__name')[:3].count(), 3)
1950. 
1951.     def test_multiple_columns_with_the_same_name_slice(self):
1952.         self.assertEqual(
1953.             list(Tag.objects.order_by('name').values_list('name', 'category__name')[:2]),
1954.             [('t1', 'Generic'), ('t2', 'Generic')],
1955.         )
1956.         self.assertSequenceEqual(
1957.             Tag.objects.order_by('name').select_related('category')[:2],
1958.             [self.t1, self.t2],
1959.         )
1960.         self.assertEqual(
1961.             list(Tag.objects.order_by('-name').values_list('name', 'parent__name')[:2]),
1962.             [('t5', 't3'), ('t4', 't3')],
1963.         )
1964.         self.assertSequenceEqual(
1965.             Tag.objects.order_by('-name').select_related('parent')[:2],
1966.             [self.t5, self.t4],
1967.         )
1968. 
1969. 
1970. class RawQueriesTests(TestCase):
1971.     @classmethod
1972.     def setUpTestData(cls):
1973.         Note.objects.create(note='n1', misc='foo', id=1)
1974. 
1975.     def test_ticket14729(self):
1976.         # Test representation of raw query with one or few parameters passed as list
1977.         query = "SELECT * FROM queries_note WHERE note = %s"
1978.         params = ['n1']
1979.         qs = Note.objects.raw(query, params=params)
1980.         self.assertEqual(repr(qs), "<RawQuerySet: SELECT * FROM queries_note WHERE note = n1>")
1981. 
1982.         query = "SELECT * FROM queries_note WHERE note = %s and misc = %s"
1983.         params = ['n1', 'foo']
1984.         qs = Note.objects.raw(query, params=params)
1985.         self.assertEqual(repr(qs), "<RawQuerySet: SELECT * FROM queries_note WHERE note = n1 and misc = foo>")
1986. 
1987. 
1988. class GeneratorExpressionTests(SimpleTestCase):
1989.     def test_ticket10432(self):
1990.         # Using an empty iterator as the rvalue for an "__in"
1991.         # lookup is legal.
1992.         self.assertCountEqual(Note.objects.filter(pk__in=iter(())), [])
1993. 
1994. 
1995. class ComparisonTests(TestCase):
1996.     @classmethod
1997.     def setUpTestData(cls):
1998.         cls.n1 = Note.objects.create(note='n1', misc='foo', id=1)
1999.         e1 = ExtraInfo.objects.create(info='e1', note=cls.n1)
2000.         cls.a2 = Author.objects.create(name='a2', num=2002, extra=e1)
2001. 
2002.     def test_ticket8597(self):
2003.         # Regression tests for case-insensitive comparisons
2004.         Item.objects.create(name="a_b", created=datetime.datetime.now(), creator=self.a2, note=self.n1)
2005.         Item.objects.create(name="x%y", created=datetime.datetime.now(), creator=self.a2, note=self.n1)
2006.         self.assertQuerysetEqual(
2007.             Item.objects.filter(name__iexact="A_b"),
2008.             ['<Item: a_b>']
2009.         )
2010.         self.assertQuerysetEqual(
2011.             Item.objects.filter(name__iexact="x%Y"),
2012.             ['<Item: x%y>']
2013.         )
2014.         self.assertQuerysetEqual(
2015.             Item.objects.filter(name__istartswith="A_b"),
2016.             ['<Item: a_b>']
2017.         )
2018.         self.assertQuerysetEqual(
2019.             Item.objects.filter(name__iendswith="A_b"),
2020.             ['<Item: a_b>']
2021.         )
2022. 
2023. 
2024. class ExistsSql(TestCase):
2025.     def test_exists(self):
2026.         with CaptureQueriesContext(connection) as captured_queries:
2027.             self.assertFalse(Tag.objects.exists())
2028.         # Ok - so the exist query worked - but did it include too many columns?
2029.         self.assertEqual(len(captured_queries), 1)
2030.         qstr = captured_queries[0]['sql']
2031.         id, name = connection.ops.quote_name('id'), connection.ops.quote_name('name')
2032.         self.assertNotIn(id, qstr)
2033.         self.assertNotIn(name, qstr)
2034. 
2035.     def test_ticket_18414(self):
2036.         Article.objects.create(name='one', created=datetime.datetime.now())
2037.         Article.objects.create(name='one', created=datetime.datetime.now())
2038.         Article.objects.create(name='two', created=datetime.datetime.now())
2039.         self.assertTrue(Article.objects.exists())
2040.         self.assertTrue(Article.objects.distinct().exists())
2041.         self.assertTrue(Article.objects.distinct()[1:3].exists())
2042.         self.assertFalse(Article.objects.distinct()[1:1].exists())
2043. 
2044.     @skipUnlessDBFeature('can_distinct_on_fields')
2045.     def test_ticket_18414_distinct_on(self):
2046.         Article.objects.create(name='one', created=datetime.datetime.now())
2047.         Article.objects.create(name='one', created=datetime.datetime.now())
2048.         Article.objects.create(name='two', created=datetime.datetime.now())
2049.         self.assertTrue(Article.objects.distinct('name').exists())
2050.         self.assertTrue(Article.objects.distinct('name')[1:2].exists())
2051.         self.assertFalse(Article.objects.distinct('name')[2:3].exists())
2052. 
2053. 
2054. class QuerysetOrderedTests(unittest.TestCase):
2055.     """
2056.     Tests for the Queryset.ordered attribute.
2057.     """
2058. 
2059.     def test_no_default_or_explicit_ordering(self):
2060.         self.assertIs(Annotation.objects.all().ordered, False)
2061. 
2062.     def test_cleared_default_ordering(self):
2063.         self.assertIs(Tag.objects.all().ordered, True)
2064.         self.assertIs(Tag.objects.all().order_by().ordered, False)
2065. 
2066.     def test_explicit_ordering(self):
2067.         self.assertIs(Annotation.objects.all().order_by('id').ordered, True)
2068. 
2069.     def test_empty_queryset(self):
2070.         self.assertIs(Annotation.objects.none().ordered, True)
2071. 
2072.     def test_order_by_extra(self):
2073.         self.assertIs(Annotation.objects.all().extra(order_by=['id']).ordered, True)
2074. 
2075.     def test_annotated_ordering(self):
2076.         qs = Annotation.objects.annotate(num_notes=Count('notes'))
2077.         self.assertIs(qs.ordered, False)
2078.         self.assertIs(qs.order_by('num_notes').ordered, True)
2079. 
2080. 
2081. @skipUnlessDBFeature('allow_sliced_subqueries_with_in')
2082. class SubqueryTests(TestCase):
2083.     @classmethod
2084.     def setUpTestData(cls):
2085.         NamedCategory.objects.create(id=1, name='first')
2086.         NamedCategory.objects.create(id=2, name='second')
2087.         NamedCategory.objects.create(id=3, name='third')
2088.         NamedCategory.objects.create(id=4, name='fourth')
2089. 
2090.     def test_ordered_subselect(self):
2091.         "Subselects honor any manual ordering"
2092.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[0:2])
2093.         self.assertEqual(set(query.values_list('id', flat=True)), {3, 4})
2094. 
2095.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[:2])
2096.         self.assertEqual(set(query.values_list('id', flat=True)), {3, 4})
2097. 
2098.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:2])
2099.         self.assertEqual(set(query.values_list('id', flat=True)), {3})
2100. 
2101.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[2:])
2102.         self.assertEqual(set(query.values_list('id', flat=True)), {1, 2})
2103. 
2104.     def test_slice_subquery_and_query(self):
2105.         """
2106.         Slice a query that has a sliced subquery
2107.         """
2108.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[0:2])[0:2]
2109.         self.assertEqual({x.id for x in query}, {3, 4})
2110. 
2111.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:3])[1:3]
2112.         self.assertEqual({x.id for x in query}, {3})
2113. 
2114.         query = DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[2:])[1:]
2115.         self.assertEqual({x.id for x in query}, {2})
2116. 
2117.     def test_related_sliced_subquery(self):
2118.         """
2119.         Related objects constraints can safely contain sliced subqueries.
2120.         refs #22434
2121.         """
2122.         generic = NamedCategory.objects.create(id=5, name="Generic")
2123.         t1 = Tag.objects.create(name='t1', category=generic)
2124.         t2 = Tag.objects.create(name='t2', category=generic)
2125.         ManagedModel.objects.create(data='mm1', tag=t1, public=True)
2126.         mm2 = ManagedModel.objects.create(data='mm2', tag=t2, public=True)
2127. 
2128.         query = ManagedModel.normal_manager.filter(
2129.             tag__in=Tag.objects.order_by('-id')[:1]
2130.         )
2131.         self.assertEqual({x.id for x in query}, {mm2.id})
2132. 
2133.     def test_sliced_delete(self):
2134.         "Delete queries can safely contain sliced subqueries"
2135.         DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[0:1]).delete()
2136.         self.assertEqual(set(DumbCategory.objects.values_list('id', flat=True)), {1, 2, 3})
2137. 
2138.         DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:2]).delete()
2139.         self.assertEqual(set(DumbCategory.objects.values_list('id', flat=True)), {1, 3})
2140. 
2141.         DumbCategory.objects.filter(id__in=DumbCategory.objects.order_by('-id')[1:]).delete()
2142.         self.assertEqual(set(DumbCategory.objects.values_list('id', flat=True)), {3})
2143. 
2144.     def test_distinct_ordered_sliced_subquery(self):
2145.         # Implicit values('id').
2146.         self.assertSequenceEqual(
2147.             NamedCategory.objects.filter(
2148.                 id__in=NamedCategory.objects.distinct().order_by('name')[0:2],
2149.             ).order_by('name').values_list('name', flat=True), ['first', 'fourth']
2150.         )
2151.         # Explicit values('id').
2152.         self.assertSequenceEqual(
2153.             NamedCategory.objects.filter(
2154.                 id__in=NamedCategory.objects.distinct().order_by('-name').values('id')[0:2],
2155.             ).order_by('name').values_list('name', flat=True), ['second', 'third']
2156.         )
2157.         # Annotated value.
2158.         self.assertSequenceEqual(
2159.             DumbCategory.objects.filter(
2160.                 id__in=DumbCategory.objects.annotate(
2161.                     double_id=F('id') * 2
2162.                 ).order_by('id').distinct().values('double_id')[0:2],
2163.             ).order_by('id').values_list('id', flat=True), [2, 4]
2164.         )
2165. 
2166. 
2167. @skipUnlessDBFeature('allow_sliced_subqueries_with_in')
2168. class QuerySetBitwiseOperationTests(TestCase):
2169.     @classmethod
2170.     def setUpTestData(cls):
2171.         school = School.objects.create()
2172.         cls.room_1 = Classroom.objects.create(school=school, has_blackboard=False, name='Room 1')
2173.         cls.room_2 = Classroom.objects.create(school=school, has_blackboard=True, name='Room 2')
2174.         cls.room_3 = Classroom.objects.create(school=school, has_blackboard=True, name='Room 3')
2175.         cls.room_4 = Classroom.objects.create(school=school, has_blackboard=False, name='Room 4')
2176. 
2177.     def test_or_with_rhs_slice(self):
2178.         qs1 = Classroom.objects.filter(has_blackboard=True)
2179.         qs2 = Classroom.objects.filter(has_blackboard=False)[:1]
2180.         self.assertCountEqual(qs1 | qs2, [self.room_1, self.room_2, self.room_3])
2181. 
2182.     def test_or_with_lhs_slice(self):
2183.         qs1 = Classroom.objects.filter(has_blackboard=True)[:1]
2184.         qs2 = Classroom.objects.filter(has_blackboard=False)
2185.         self.assertCountEqual(qs1 | qs2, [self.room_1, self.room_2, self.room_4])
2186. 
2187.     def test_or_with_both_slice(self):
2188.         qs1 = Classroom.objects.filter(has_blackboard=False)[:1]
2189.         qs2 = Classroom.objects.filter(has_blackboard=True)[:1]
2190.         self.assertCountEqual(qs1 | qs2, [self.room_1, self.room_2])
2191. 
2192.     def test_or_with_both_slice_and_ordering(self):
2193.         qs1 = Classroom.objects.filter(has_blackboard=False).order_by('-pk')[:1]
2194.         qs2 = Classroom.objects.filter(has_blackboard=True).order_by('-name')[:1]
2195.         self.assertCountEqual(qs1 | qs2, [self.room_3, self.room_4])
2196. 
2197. 
2198. class CloneTests(TestCase):
2199. 
2200.     def test_evaluated_queryset_as_argument(self):
2201.         "#13227 -- If a queryset is already evaluated, it can still be used as a query arg"
2202.         n = Note(note='Test1', misc='misc')
2203.         n.save()
2204.         e = ExtraInfo(info='good', note=n)
2205.         e.save()
2206. 
2207.         n_list = Note.objects.all()
2208.         # Evaluate the Note queryset, populating the query cache
2209.         list(n_list)
2210.         # Make one of cached results unpickable.
2211.         n_list._result_cache[0].lock = Lock()
2212.         with self.assertRaises(TypeError):
2213.             pickle.dumps(n_list)
2214.         # Use the note queryset in a query, and evaluate
2215.         # that query in a way that involves cloning.
2216.         self.assertEqual(ExtraInfo.objects.filter(note__in=n_list)[0].info, 'good')
2217. 
2218.     def test_no_model_options_cloning(self):
2219.         """
2220.         Cloning a queryset does not get out of hand. While complete
2221.         testing is impossible, this is a sanity check against invalid use of
2222.         deepcopy. refs #16759.
2223.         """
2224.         opts_class = type(Note._meta)
2225.         note_deepcopy = getattr(opts_class, "__deepcopy__", None)
2226.         opts_class.__deepcopy__ = lambda obj, memo: self.fail("Model options shouldn't be cloned.")
2227.         try:
2228.             Note.objects.filter(pk__lte=F('pk') + 1).all()
2229.         finally:
2230.             if note_deepcopy is None:
2231.                 delattr(opts_class, "__deepcopy__")
2232.             else:
2233.                 opts_class.__deepcopy__ = note_deepcopy
2234. 
2235.     def test_no_fields_cloning(self):
2236.         """
2237.         Cloning a queryset does not get out of hand. While complete
2238.         testing is impossible, this is a sanity check against invalid use of
2239.         deepcopy. refs #16759.
2240.         """
2241.         opts_class = type(Note._meta.get_field("misc"))
2242.         note_deepcopy = getattr(opts_class, "__deepcopy__", None)
2243.         opts_class.__deepcopy__ = lambda obj, memo: self.fail("Model fields shouldn't be cloned")
2244.         try:
2245.             Note.objects.filter(note=F('misc')).all()
2246.         finally:
2247.             if note_deepcopy is None:
2248.                 delattr(opts_class, "__deepcopy__")
2249.             else:
2250.                 opts_class.__deepcopy__ = note_deepcopy
2251. 
2252. 
2253. class EmptyQuerySetTests(SimpleTestCase):
2254.     def test_emptyqueryset_values(self):
2255.         # #14366 -- Calling .values() on an empty QuerySet and then cloning
2256.         # that should not cause an error
2257.         self.assertCountEqual(Number.objects.none().values('num').order_by('num'), [])
2258. 
2259.     def test_values_subquery(self):
2260.         self.assertCountEqual(Number.objects.filter(pk__in=Number.objects.none().values('pk')), [])
2261.         self.assertCountEqual(Number.objects.filter(pk__in=Number.objects.none().values_list('pk')), [])
2262. 
2263.     def test_ticket_19151(self):
2264.         # #19151 -- Calling .values() or .values_list() on an empty QuerySet
2265.         # should return an empty QuerySet and not cause an error.
2266.         q = Author.objects.none()
2267.         self.assertCountEqual(q.values(), [])
2268.         self.assertCountEqual(q.values_list(), [])
2269. 
2270. 
2271. class ValuesQuerysetTests(TestCase):
2272.     @classmethod
2273.     def setUpTestData(cls):
2274.         Number.objects.create(num=72)
2275. 
2276.     def test_flat_values_list(self):
2277.         qs = Number.objects.values_list("num")
2278.         qs = qs.values_list("num", flat=True)
2279.         self.assertSequenceEqual(qs, [72])
2280. 
2281.     def test_extra_values(self):
2282.         # testing for ticket 14930 issues
2283.         qs = Number.objects.extra(select={'value_plus_x': 'num+%s', 'value_minus_x': 'num-%s'}, select_params=(1, 2))
2284.         qs = qs.order_by('value_minus_x')
2285.         qs = qs.values('num')
2286.         self.assertSequenceEqual(qs, [{'num': 72}])
2287. 
2288.     def test_extra_values_order_twice(self):
2289.         # testing for ticket 14930 issues
2290.         qs = Number.objects.extra(select={'value_plus_one': 'num+1', 'value_minus_one': 'num-1'})
2291.         qs = qs.order_by('value_minus_one').order_by('value_plus_one')
2292.         qs = qs.values('num')
2293.         self.assertSequenceEqual(qs, [{'num': 72}])
2294. 
2295.     def test_extra_values_order_multiple(self):
2296.         # Postgres doesn't allow constants in order by, so check for that.
2297.         qs = Number.objects.extra(select={
2298.             'value_plus_one': 'num+1',
2299.             'value_minus_one': 'num-1',
2300.             'constant_value': '1'
2301.         })
2302.         qs = qs.order_by('value_plus_one', 'value_minus_one', 'constant_value')
2303.         qs = qs.values('num')
2304.         self.assertSequenceEqual(qs, [{'num': 72}])
2305. 
2306.     def test_extra_values_order_in_extra(self):
2307.         # testing for ticket 14930 issues
2308.         qs = Number.objects.extra(
2309.             select={'value_plus_one': 'num+1', 'value_minus_one': 'num-1'},
2310.             order_by=['value_minus_one'],
2311.         )
2312.         qs = qs.values('num')
2313. 
2314.     def test_extra_select_params_values_order_in_extra(self):
2315.         # testing for 23259 issue
2316.         qs = Number.objects.extra(
2317.             select={'value_plus_x': 'num+%s'},
2318.             select_params=[1],
2319.             order_by=['value_plus_x'],
2320.         )
2321.         qs = qs.filter(num=72)
2322.         qs = qs.values('num')
2323.         self.assertSequenceEqual(qs, [{'num': 72}])
2324. 
2325.     def test_extra_multiple_select_params_values_order_by(self):
2326.         # testing for 23259 issue
2327.         qs = Number.objects.extra(select={'value_plus_x': 'num+%s', 'value_minus_x': 'num-%s'}, select_params=(72, 72))
2328.         qs = qs.order_by('value_minus_x')
2329.         qs = qs.filter(num=1)
2330.         qs = qs.values('num')
2331.         self.assertSequenceEqual(qs, [])
2332. 
2333.     def test_extra_values_list(self):
2334.         # testing for ticket 14930 issues
2335.         qs = Number.objects.extra(select={'value_plus_one': 'num+1'})
2336.         qs = qs.order_by('value_plus_one')
2337.         qs = qs.values_list('num')
2338.         self.assertSequenceEqual(qs, [(72,)])
2339. 
2340.     def test_flat_extra_values_list(self):
2341.         # testing for ticket 14930 issues
2342.         qs = Number.objects.extra(select={'value_plus_one': 'num+1'})
2343.         qs = qs.order_by('value_plus_one')
2344.         qs = qs.values_list('num', flat=True)
2345.         self.assertSequenceEqual(qs, [72])
2346. 
2347.     def test_field_error_values_list(self):
2348.         # see #23443
2349.         msg = "Cannot resolve keyword %r into field. Join on 'name' not permitted." % 'foo'
2350.         with self.assertRaisesMessage(FieldError, msg):
2351.             Tag.objects.values_list('name__foo')
2352. 
2353.     def test_named_values_list_flat(self):
2354.         msg = "'flat' and 'named' can't be used together."
2355.         with self.assertRaisesMessage(TypeError, msg):
2356.             Number.objects.values_list('num', flat=True, named=True)
2357. 
2358.     def test_named_values_list_bad_field_name(self):
2359.         msg = "Type names and field names must be valid identifiers: '1'"
2360.         with self.assertRaisesMessage(ValueError, msg):
2361.             Number.objects.extra(select={'1': 'num+1'}).values_list('1', named=True).first()
2362. 
2363.     def test_named_values_list_with_fields(self):
2364.         qs = Number.objects.extra(select={'num2': 'num+1'}).annotate(Count('id'))
2365.         values = qs.values_list('num', 'num2', named=True).first()
2366.         self.assertEqual(type(values).__name__, 'Row')
2367.         self.assertEqual(values._fields, ('num', 'num2'))
2368.         self.assertEqual(values.num, 72)
2369.         self.assertEqual(values.num2, 73)
2370. 
2371.     def test_named_values_list_without_fields(self):
2372.         qs = Number.objects.extra(select={'num2': 'num+1'}).annotate(Count('id'))
2373.         values = qs.values_list(named=True).first()
2374.         self.assertEqual(type(values).__name__, 'Row')
2375.         self.assertEqual(
2376.             values._fields,
2377.             ('num2', 'id', 'num', 'other_num', 'another_num', 'id__count'),
2378.         )
2379.         self.assertEqual(values.num, 72)
2380.         self.assertEqual(values.num2, 73)
2381.         self.assertEqual(values.id__count, 1)
2382. 
2383.     def test_named_values_list_expression_with_default_alias(self):
2384.         expr = Count('id')
2385.         values = Number.objects.annotate(id__count1=expr).values_list(expr, 'id__count1', named=True).first()
2386.         self.assertEqual(values._fields, ('id__count2', 'id__count1'))
2387. 
2388.     def test_named_values_list_expression(self):
2389.         expr = F('num') + 1
2390.         qs = Number.objects.annotate(combinedexpression1=expr).values_list(expr, 'combinedexpression1', named=True)
2391.         values = qs.first()
2392.         self.assertEqual(values._fields, ('combinedexpression2', 'combinedexpression1'))
2393. 
2394. 
2395. class QuerySetSupportsPythonIdioms(TestCase):
2396. 
2397.     @classmethod
2398.     def setUpTestData(cls):
2399.         some_date = datetime.datetime(2014, 5, 16, 12, 1)
2400.         for i in range(1, 8):
2401.             Article.objects.create(
2402.                 name="Article {}".format(i), created=some_date)
2403. 
2404.     def get_ordered_articles(self):
2405.         return Article.objects.all().order_by('name')
2406. 
2407.     def test_can_get_items_using_index_and_slice_notation(self):
2408.         self.assertEqual(self.get_ordered_articles()[0].name, 'Article 1')
2409.         self.assertQuerysetEqual(
2410.             self.get_ordered_articles()[1:3],
2411.             ["<Article: Article 2>", "<Article: Article 3>"]
2412.         )
2413. 
2414.     def test_slicing_with_steps_can_be_used(self):
2415.         self.assertQuerysetEqual(
2416.             self.get_ordered_articles()[::2], [
2417.                 "<Article: Article 1>",
2418.                 "<Article: Article 3>",
2419.                 "<Article: Article 5>",
2420.                 "<Article: Article 7>"
2421.             ]
2422.         )
2423. 
2424.     def test_slicing_without_step_is_lazy(self):
2425.         with self.assertNumQueries(0):
2426.             self.get_ordered_articles()[0:5]
2427. 
2428.     def test_slicing_with_tests_is_not_lazy(self):
2429.         with self.assertNumQueries(1):
2430.             self.get_ordered_articles()[0:5:3]
2431. 
2432.     def test_slicing_can_slice_again_after_slicing(self):
2433.         self.assertQuerysetEqual(
2434.             self.get_ordered_articles()[0:5][0:2],
2435.             ["<Article: Article 1>", "<Article: Article 2>"]
2436.         )
2437.         self.assertQuerysetEqual(self.get_ordered_articles()[0:5][4:], ["<Article: Article 5>"])
2438.         self.assertQuerysetEqual(self.get_ordered_articles()[0:5][5:], [])
2439. 
2440.         # Some more tests!
2441.         self.assertQuerysetEqual(
2442.             self.get_ordered_articles()[2:][0:2],
2443.             ["<Article: Article 3>", "<Article: Article 4>"]
2444.         )
2445.         self.assertQuerysetEqual(
2446.             self.get_ordered_articles()[2:][:2],
2447.             ["<Article: Article 3>", "<Article: Article 4>"]
2448.         )
2449.         self.assertQuerysetEqual(self.get_ordered_articles()[2:][2:3], ["<Article: Article 5>"])
2450. 
2451.         # Using an offset without a limit is also possible.
2452.         self.assertQuerysetEqual(
2453.             self.get_ordered_articles()[5:],
2454.             ["<Article: Article 6>", "<Article: Article 7>"]
2455.         )
2456. 
2457.     def test_slicing_cannot_filter_queryset_once_sliced(self):
2458.         with self.assertRaisesMessage(AssertionError, "Cannot filter a query once a slice has been taken."):
2459.             Article.objects.all()[0:5].filter(id=1)
2460. 
2461.     def test_slicing_cannot_reorder_queryset_once_sliced(self):
2462.         with self.assertRaisesMessage(AssertionError, "Cannot reorder a query once a slice has been taken."):
2463.             Article.objects.all()[0:5].order_by('id')
2464. 
2465.     def test_slicing_cannot_combine_queries_once_sliced(self):
2466.         with self.assertRaisesMessage(AssertionError, "Cannot combine queries once a slice has been taken."):
2467.             Article.objects.all()[0:1] & Article.objects.all()[4:5]
2468. 
2469.     def test_slicing_negative_indexing_not_supported_for_single_element(self):
2470.         """hint: inverting your ordering might do what you need"""
2471.         with self.assertRaisesMessage(AssertionError, "Negative indexing is not supported."):
2472.             Article.objects.all()[-1]
2473. 
2474.     def test_slicing_negative_indexing_not_supported_for_range(self):
2475.         """hint: inverting your ordering might do what you need"""
2476.         with self.assertRaisesMessage(AssertionError, "Negative indexing is not supported."):
2477.             Article.objects.all()[0:-5]
2478. 
2479.     def test_invalid_index(self):
2480.         msg = 'QuerySet indices must be integers or slices, not str.'
2481.         with self.assertRaisesMessage(TypeError, msg):
2482.             Article.objects.all()['foo']
2483. 
2484.     def test_can_get_number_of_items_in_queryset_using_standard_len(self):
2485.         self.assertEqual(len(Article.objects.filter(name__exact='Article 1')), 1)
2486. 
2487.     def test_can_combine_queries_using_and_and_or_operators(self):
2488.         s1 = Article.objects.filter(name__exact='Article 1')
2489.         s2 = Article.objects.filter(name__exact='Article 2')
2490.         self.assertQuerysetEqual(
2491.             (s1 | s2).order_by('name'),
2492.             ["<Article: Article 1>", "<Article: Article 2>"]
2493.         )
2494.         self.assertQuerysetEqual(s1 & s2, [])
2495. 
2496. 
2497. class WeirdQuerysetSlicingTests(TestCase):
2498.     @classmethod
2499.     def setUpTestData(cls):
2500.         Number.objects.create(num=1)
2501.         Number.objects.create(num=2)
2502. 
2503.         Article.objects.create(name='one', created=datetime.datetime.now())
2504.         Article.objects.create(name='two', created=datetime.datetime.now())
2505.         Article.objects.create(name='three', created=datetime.datetime.now())
2506.         Article.objects.create(name='four', created=datetime.datetime.now())
2507. 
2508.         food = Food.objects.create(name='spam')
2509.         Eaten.objects.create(meal='spam with eggs', food=food)
2510. 
2511.     def test_tickets_7698_10202(self):
2512.         # People like to slice with '0' as the high-water mark.
2513.         self.assertQuerysetEqual(Article.objects.all()[0:0], [])
2514.         self.assertQuerysetEqual(Article.objects.all()[0:0][:10], [])
2515.         self.assertEqual(Article.objects.all()[:0].count(), 0)
2516.         with self.assertRaisesMessage(TypeError, 'Cannot reverse a query once a slice has been taken.'):
2517.             Article.objects.all()[:0].latest('created')
2518. 
2519.     def test_empty_resultset_sql(self):
2520.         # ticket #12192
2521.         self.assertNumQueries(0, lambda: list(Number.objects.all()[1:1]))
2522. 
2523.     def test_empty_sliced_subquery(self):
2524.         self.assertEqual(Eaten.objects.filter(food__in=Food.objects.all()[0:0]).count(), 0)
2525. 
2526.     def test_empty_sliced_subquery_exclude(self):
2527.         self.assertEqual(Eaten.objects.exclude(food__in=Food.objects.all()[0:0]).count(), 1)
2528. 
2529.     def test_zero_length_values_slicing(self):
2530.         n = 42
2531.         with self.assertNumQueries(0):
2532.             self.assertQuerysetEqual(Article.objects.values()[n:n], [])
2533.             self.assertQuerysetEqual(Article.objects.values_list()[n:n], [])
2534. 
2535. 
2536. class EscapingTests(TestCase):
2537.     def test_ticket_7302(self):
2538.         # Reserved names are appropriately escaped
2539.         ReservedName.objects.create(name='a', order=42)
2540.         ReservedName.objects.create(name='b', order=37)
2541.         self.assertQuerysetEqual(
2542.             ReservedName.objects.all().order_by('order'),
2543.             ['<ReservedName: b>', '<ReservedName: a>']
2544.         )
2545.         self.assertQuerysetEqual(
2546.             ReservedName.objects.extra(select={'stuff': 'name'}, order_by=('order', 'stuff')),
2547.             ['<ReservedName: b>', '<ReservedName: a>']
2548.         )
2549. 
2550. 
2551. class ToFieldTests(TestCase):
2552.     def test_in_query(self):
2553.         apple = Food.objects.create(name="apple")
2554.         pear = Food.objects.create(name="pear")
2555.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2556.         dinner = Eaten.objects.create(food=pear, meal="dinner")
2557. 
2558.         self.assertEqual(
2559.             set(Eaten.objects.filter(food__in=[apple, pear])),
2560.             {lunch, dinner},
2561.         )
2562. 
2563.     def test_in_subquery(self):
2564.         apple = Food.objects.create(name="apple")
2565.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2566.         self.assertEqual(
2567.             set(Eaten.objects.filter(food__in=Food.objects.filter(name='apple'))),
2568.             {lunch}
2569.         )
2570.         self.assertEqual(
2571.             set(Eaten.objects.filter(food__in=Food.objects.filter(name='apple').values('eaten__meal'))),
2572.             set()
2573.         )
2574.         self.assertEqual(
2575.             set(Food.objects.filter(eaten__in=Eaten.objects.filter(meal='lunch'))),
2576.             {apple}
2577.         )
2578. 
2579.     def test_nested_in_subquery(self):
2580.         extra = ExtraInfo.objects.create()
2581.         author = Author.objects.create(num=42, extra=extra)
2582.         report = Report.objects.create(creator=author)
2583.         comment = ReportComment.objects.create(report=report)
2584.         comments = ReportComment.objects.filter(
2585.             report__in=Report.objects.filter(
2586.                 creator__in=extra.author_set.all(),
2587.             ),
2588.         )
2589.         self.assertSequenceEqual(comments, [comment])
2590. 
2591.     def test_reverse_in(self):
2592.         apple = Food.objects.create(name="apple")
2593.         pear = Food.objects.create(name="pear")
2594.         lunch_apple = Eaten.objects.create(food=apple, meal="lunch")
2595.         lunch_pear = Eaten.objects.create(food=pear, meal="dinner")
2596. 
2597.         self.assertEqual(
2598.             set(Food.objects.filter(eaten__in=[lunch_apple, lunch_pear])),
2599.             {apple, pear}
2600.         )
2601. 
2602.     def test_single_object(self):
2603.         apple = Food.objects.create(name="apple")
2604.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2605.         dinner = Eaten.objects.create(food=apple, meal="dinner")
2606. 
2607.         self.assertEqual(
2608.             set(Eaten.objects.filter(food=apple)),
2609.             {lunch, dinner}
2610.         )
2611. 
2612.     def test_single_object_reverse(self):
2613.         apple = Food.objects.create(name="apple")
2614.         lunch = Eaten.objects.create(food=apple, meal="lunch")
2615. 
2616.         self.assertEqual(
2617.             set(Food.objects.filter(eaten=lunch)),
2618.             {apple}
2619.         )
2620. 
2621.     def test_recursive_fk(self):
2622.         node1 = Node.objects.create(num=42)
2623.         node2 = Node.objects.create(num=1, parent=node1)
2624. 
2625.         self.assertEqual(
2626.             list(Node.objects.filter(parent=node1)),
2627.             [node2]
2628.         )
2629. 
2630.     def test_recursive_fk_reverse(self):
2631.         node1 = Node.objects.create(num=42)
2632.         node2 = Node.objects.create(num=1, parent=node1)
2633. 
2634.         self.assertEqual(
2635.             list(Node.objects.filter(node=node2)),
2636.             [node1]
2637.         )
2638. 
2639. 
2640. class IsNullTests(TestCase):
2641.     def test_primary_key(self):
2642.         custom = CustomPk.objects.create(name='pk')
2643.         null = Related.objects.create()
2644.         notnull = Related.objects.create(custom=custom)
2645.         self.assertSequenceEqual(Related.objects.filter(custom__isnull=False), [notnull])
2646.         self.assertSequenceEqual(Related.objects.filter(custom__isnull=True), [null])
2647. 
2648.     def test_to_field(self):
2649.         apple = Food.objects.create(name="apple")
2650.         Eaten.objects.create(food=apple, meal="lunch")
2651.         Eaten.objects.create(meal="lunch")
2652.         self.assertQuerysetEqual(
2653.             Eaten.objects.filter(food__isnull=False),
2654.             ['<Eaten: apple at lunch>']
2655.         )
2656.         self.assertQuerysetEqual(
2657.             Eaten.objects.filter(food__isnull=True),
2658.             ['<Eaten: None at lunch>']
2659.         )
2660. 
2661. 
2662. class ConditionalTests(TestCase):
2663.     """Tests whose execution depend on different environment conditions like
2664.     Python version or DB backend features"""
2665. 
2666.     @classmethod
2667.     def setUpTestData(cls):
2668.         generic = NamedCategory.objects.create(name="Generic")
2669.         t1 = Tag.objects.create(name='t1', category=generic)
2670.         Tag.objects.create(name='t2', parent=t1, category=generic)
2671.         t3 = Tag.objects.create(name='t3', parent=t1)
2672.         Tag.objects.create(name='t4', parent=t3)
2673.         Tag.objects.create(name='t5', parent=t3)
2674. 
2675.     def test_infinite_loop(self):
2676.         # If you're not careful, it's possible to introduce infinite loops via
2677.         # default ordering on foreign keys in a cycle. We detect that.
2678.         with self.assertRaisesMessage(FieldError, 'Infinite loop caused by ordering.'):
2679.             list(LoopX.objects.all())  # Force queryset evaluation with list()
2680.         with self.assertRaisesMessage(FieldError, 'Infinite loop caused by ordering.'):
2681.             list(LoopZ.objects.all())  # Force queryset evaluation with list()
2682. 
2683.         # Note that this doesn't cause an infinite loop, since the default
2684.         # ordering on the Tag model is empty (and thus defaults to using "id"
2685.         # for the related field).
2686.         self.assertEqual(len(Tag.objects.order_by('parent')), 5)
2687. 
2688.         # ... but you can still order in a non-recursive fashion among linked
2689.         # fields (the previous test failed because the default ordering was
2690.         # recursive).
2691.         self.assertQuerysetEqual(
2692.             LoopX.objects.all().order_by('y__x__y__x__id'),
2693.             []
2694.         )
2695. 
2696.     # When grouping without specifying ordering, we add an explicit "ORDER BY NULL"
2697.     # portion in MySQL to prevent unnecessary sorting.
2698.     @skipUnlessDBFeature('requires_explicit_null_ordering_when_grouping')
2699.     def test_null_ordering_added(self):
2700.         query = Tag.objects.values_list('parent_id', flat=True).order_by().query
2701.         query.group_by = ['parent_id']
2702.         sql = query.get_compiler(DEFAULT_DB_ALIAS).as_sql()[0]
2703.         fragment = "ORDER BY "
2704.         pos = sql.find(fragment)
2705.         self.assertEqual(sql.find(fragment, pos + 1), -1)
2706.         self.assertEqual(sql.find("NULL", pos + len(fragment)), pos + len(fragment))
2707. 
2708.     def test_in_list_limit(self):
2709.         # The "in" lookup works with lists of 1000 items or more.
2710.         # The numbers amount is picked to force three different IN batches
2711.         # for Oracle, yet to be less than 2100 parameter limit for MSSQL.
2712.         numbers = list(range(2050))
2713.         max_query_params = connection.features.max_query_params
2714.         if max_query_params is None or max_query_params >= len(numbers):
2715.             Number.objects.bulk_create(Number(num=num) for num in numbers)
2716.             for number in [1000, 1001, 2000, len(numbers)]:
2717.                 with self.subTest(number=number):
2718.                     self.assertEqual(Number.objects.filter(num__in=numbers[:number]).count(), number)
2719. 
2720. 
2721. class UnionTests(unittest.TestCase):
2722.     """
2723.     Tests for the union of two querysets. Bug #12252.
2724.     """
2725.     @classmethod
2726.     def setUpTestData(cls):
2727.         objectas = []
2728.         objectbs = []
2729.         objectcs = []
2730.         a_info = ['one', 'two', 'three']
2731.         for name in a_info:
2732.             o = ObjectA(name=name)
2733.             o.save()
2734.             objectas.append(o)
2735.         b_info = [('un', 1, objectas[0]), ('deux', 2, objectas[0]), ('trois', 3, objectas[2])]
2736.         for name, number, objecta in b_info:
2737.             o = ObjectB(name=name, num=number, objecta=objecta)
2738.             o.save()
2739.             objectbs.append(o)
2740.         c_info = [('ein', objectas[2], objectbs[2]), ('zwei', objectas[1], objectbs[1])]
2741.         for name, objecta, objectb in c_info:
2742.             o = ObjectC(name=name, objecta=objecta, objectb=objectb)
2743.             o.save()
2744.             objectcs.append(o)
2745. 
2746.     def check_union(self, model, Q1, Q2):
2747.         filter = model.objects.filter
2748.         self.assertEqual(set(filter(Q1) | filter(Q2)), set(filter(Q1 | Q2)))
2749.         self.assertEqual(set(filter(Q2) | filter(Q1)), set(filter(Q1 | Q2)))
2750. 
2751.     def test_A_AB(self):
2752.         Q1 = Q(name='two')
2753.         Q2 = Q(objectb__name='deux')
2754.         self.check_union(ObjectA, Q1, Q2)
2755. 
2756.     def test_A_AB2(self):
2757.         Q1 = Q(name='two')
2758.         Q2 = Q(objectb__name='deux', objectb__num=2)
2759.         self.check_union(ObjectA, Q1, Q2)
2760. 
2761.     def test_AB_ACB(self):
2762.         Q1 = Q(objectb__name='deux')
2763.         Q2 = Q(objectc__objectb__name='deux')
2764.         self.check_union(ObjectA, Q1, Q2)
2765. 
2766.     def test_BAB_BAC(self):
2767.         Q1 = Q(objecta__objectb__name='deux')
2768.         Q2 = Q(objecta__objectc__name='ein')
2769.         self.check_union(ObjectB, Q1, Q2)
2770. 
2771.     def test_BAB_BACB(self):
2772.         Q1 = Q(objecta__objectb__name='deux')
2773.         Q2 = Q(objecta__objectc__objectb__name='trois')
2774.         self.check_union(ObjectB, Q1, Q2)
2775. 
2776.     def test_BA_BCA__BAB_BAC_BCA(self):
2777.         Q1 = Q(objecta__name='one', objectc__objecta__name='two')
2778.         Q2 = Q(objecta__objectc__name='ein', objectc__objecta__name='three', objecta__objectb__name='trois')
2779.         self.check_union(ObjectB, Q1, Q2)
2780. 
2781. 
2782. class DefaultValuesInsertTest(TestCase):
2783.     def test_no_extra_params(self):
2784.         """
2785.         Can create an instance of a model with only the PK field (#17056)."
2786.         """
2787.         DumbCategory.objects.create()
2788. 
2789. 
2790. class ExcludeTests(TestCase):
2791.     @classmethod
2792.     def setUpTestData(cls):
2793.         f1 = Food.objects.create(name='apples')
2794.         Food.objects.create(name='oranges')
2795.         Eaten.objects.create(food=f1, meal='dinner')
2796.         j1 = Job.objects.create(name='Manager')
2797.         cls.r1 = Responsibility.objects.create(description='Playing golf')
2798.         j2 = Job.objects.create(name='Programmer')
2799.         r2 = Responsibility.objects.create(description='Programming')
2800.         JobResponsibilities.objects.create(job=j1, responsibility=cls.r1)
2801.         JobResponsibilities.objects.create(job=j2, responsibility=r2)
2802. 
2803.     def test_to_field(self):
2804.         self.assertQuerysetEqual(
2805.             Food.objects.exclude(eaten__meal='dinner'),
2806.             ['<Food: oranges>'])
2807.         self.assertQuerysetEqual(
2808.             Job.objects.exclude(responsibilities__description='Playing golf'),
2809.             ['<Job: Programmer>'])
2810.         self.assertQuerysetEqual(
2811.             Responsibility.objects.exclude(jobs__name='Manager'),
2812.             ['<Responsibility: Programming>'])
2813. 
2814.     def test_ticket14511(self):
2815.         alex = Person.objects.get_or_create(name='Alex')[0]
2816.         jane = Person.objects.get_or_create(name='Jane')[0]
2817. 
2818.         oracle = Company.objects.get_or_create(name='Oracle')[0]
2819.         google = Company.objects.get_or_create(name='Google')[0]
2820.         microsoft = Company.objects.get_or_create(name='Microsoft')[0]
2821.         intel = Company.objects.get_or_create(name='Intel')[0]
2822. 
2823.         def employ(employer, employee, title):
2824.             Employment.objects.get_or_create(employee=employee, employer=employer, title=title)
2825. 
2826.         employ(oracle, alex, 'Engineer')
2827.         employ(oracle, alex, 'Developer')
2828.         employ(google, alex, 'Engineer')
2829.         employ(google, alex, 'Manager')
2830.         employ(microsoft, alex, 'Manager')
2831.         employ(intel, alex, 'Manager')
2832. 
2833.         employ(microsoft, jane, 'Developer')
2834.         employ(intel, jane, 'Manager')
2835. 
2836.         alex_tech_employers = alex.employers.filter(
2837.             employment__title__in=('Engineer', 'Developer')).distinct().order_by('name')
2838.         self.assertSequenceEqual(alex_tech_employers, [google, oracle])
2839. 
2840.         alex_nontech_employers = alex.employers.exclude(
2841.             employment__title__in=('Engineer', 'Developer')).distinct().order_by('name')
2842.         self.assertSequenceEqual(alex_nontech_employers, [google, intel, microsoft])
2843. 
2844.     def test_exclude_reverse_fk_field_ref(self):
2845.         tag = Tag.objects.create()
2846.         Note.objects.create(tag=tag, note='note')
2847.         annotation = Annotation.objects.create(name='annotation', tag=tag)
2848.         self.assertEqual(Annotation.objects.exclude(tag__note__note=F('name')).get(), annotation)
2849. 
2850.     def test_exclude_with_circular_fk_relation(self):
2851.         self.assertEqual(ObjectB.objects.exclude(objecta__objectb__name=F('name')).count(), 0)
2852. 
2853.     def test_subquery_exclude_outerref(self):
2854.         qs = JobResponsibilities.objects.filter(
2855.             Exists(Responsibility.objects.exclude(jobs=OuterRef('job'))),
2856.         )
2857.         self.assertTrue(qs.exists())
2858.         self.r1.delete()
2859.         self.assertFalse(qs.exists())
2860. 
2861.     def test_exclude_nullable_fields(self):
2862.         number = Number.objects.create(num=1, other_num=1)
2863.         Number.objects.create(num=2, other_num=2, another_num=2)
2864.         self.assertSequenceEqual(
2865.             Number.objects.exclude(other_num=F('another_num')),
2866.             [number],
2867.         )
2868.         self.assertSequenceEqual(
2869.             Number.objects.exclude(num=F('another_num')),
2870.             [number],
2871.         )
2872. 
2873. 
2874. class ExcludeTest17600(TestCase):
2875.     """
2876.     Some regressiontests for ticket #17600. Some of these likely duplicate
2877.     other existing tests.
2878.     """
2879.     @classmethod
2880.     def setUpTestData(cls):
2881.         # Create a few Orders.
2882.         cls.o1 = Order.objects.create(pk=1)
2883.         cls.o2 = Order.objects.create(pk=2)
2884.         cls.o3 = Order.objects.create(pk=3)
2885. 
2886.         # Create some OrderItems for the first order with homogeneous
2887.         # status_id values
2888.         cls.oi1 = OrderItem.objects.create(order=cls.o1, status=1)
2889.         cls.oi2 = OrderItem.objects.create(order=cls.o1, status=1)
2890.         cls.oi3 = OrderItem.objects.create(order=cls.o1, status=1)
2891. 
2892.         # Create some OrderItems for the second order with heterogeneous
2893.         # status_id values
2894.         cls.oi4 = OrderItem.objects.create(order=cls.o2, status=1)
2895.         cls.oi5 = OrderItem.objects.create(order=cls.o2, status=2)
2896.         cls.oi6 = OrderItem.objects.create(order=cls.o2, status=3)
2897. 
2898.         # Create some OrderItems for the second order with heterogeneous
2899.         # status_id values
2900.         cls.oi7 = OrderItem.objects.create(order=cls.o3, status=2)
2901.         cls.oi8 = OrderItem.objects.create(order=cls.o3, status=3)
2902.         cls.oi9 = OrderItem.objects.create(order=cls.o3, status=4)
2903. 
2904.     def test_exclude_plain(self):
2905.         """
2906.         This should exclude Orders which have some items with status 1
2907.         """
2908.         self.assertQuerysetEqual(
2909.             Order.objects.exclude(items__status=1),
2910.             ['<Order: 3>'])
2911. 
2912.     def test_exclude_plain_distinct(self):
2913.         """
2914.         This should exclude Orders which have some items with status 1
2915.         """
2916.         self.assertQuerysetEqual(
2917.             Order.objects.exclude(items__status=1).distinct(),
2918.             ['<Order: 3>'])
2919. 
2920.     def test_exclude_with_q_object_distinct(self):
2921.         """
2922.         This should exclude Orders which have some items with status 1
2923.         """
2924.         self.assertQuerysetEqual(
2925.             Order.objects.exclude(Q(items__status=1)).distinct(),
2926.             ['<Order: 3>'])
2927. 
2928.     def test_exclude_with_q_object_no_distinct(self):
2929.         """
2930.         This should exclude Orders which have some items with status 1
2931.         """
2932.         self.assertQuerysetEqual(
2933.             Order.objects.exclude(Q(items__status=1)),
2934.             ['<Order: 3>'])
2935. 
2936.     def test_exclude_with_q_is_equal_to_plain_exclude(self):
2937.         """
2938.         Using exclude(condition) and exclude(Q(condition)) should
2939.         yield the same QuerySet
2940.         """
2941.         self.assertEqual(
2942.             list(Order.objects.exclude(items__status=1).distinct()),
2943.             list(Order.objects.exclude(Q(items__status=1)).distinct()))
2944. 
2945.     def test_exclude_with_q_is_equal_to_plain_exclude_variation(self):
2946.         """
2947.         Using exclude(condition) and exclude(Q(condition)) should
2948.         yield the same QuerySet
2949.         """
2950.         self.assertEqual(
2951.             list(Order.objects.exclude(items__status=1)),
2952.             list(Order.objects.exclude(Q(items__status=1)).distinct()))
2953. 
2954.     @unittest.expectedFailure
2955.     def test_only_orders_with_all_items_having_status_1(self):
2956.         """
2957.         This should only return orders having ALL items set to status 1, or
2958.         those items not having any orders at all. The correct way to write
2959.         this query in SQL seems to be using two nested subqueries.
2960.         """
2961.         self.assertQuerysetEqual(
2962.             Order.objects.exclude(~Q(items__status=1)).distinct(),
2963.             ['<Order: 1>'])
2964. 
2965. 
2966. class Exclude15786(TestCase):
2967.     """Regression test for #15786"""
2968.     def test_ticket15786(self):
2969.         c1 = SimpleCategory.objects.create(name='c1')
2970.         c2 = SimpleCategory.objects.create(name='c2')
2971.         OneToOneCategory.objects.create(category=c1)
2972.         OneToOneCategory.objects.create(category=c2)
2973.         rel = CategoryRelationship.objects.create(first=c1, second=c2)
2974.         self.assertEqual(
2975.             CategoryRelationship.objects.exclude(
2976.                 first__onetoonecategory=F('second__onetoonecategory')
2977.             ).get(), rel
2978.         )
2979. 
2980. 
2981. class NullInExcludeTest(TestCase):
2982.     @classmethod
2983.     def setUpTestData(cls):
2984.         NullableName.objects.create(name='i1')
2985.         NullableName.objects.create()
2986. 
2987.     def test_null_in_exclude_qs(self):
2988.         none_val = '' if connection.features.interprets_empty_strings_as_nulls else None
2989.         self.assertQuerysetEqual(
2990.             NullableName.objects.exclude(name__in=[]),
2991.             ['i1', none_val], attrgetter('name'))
2992.         self.assertQuerysetEqual(
2993.             NullableName.objects.exclude(name__in=['i1']),
2994.             [none_val], attrgetter('name'))
2995.         self.assertQuerysetEqual(
2996.             NullableName.objects.exclude(name__in=['i3']),
2997.             ['i1', none_val], attrgetter('name'))
2998.         inner_qs = NullableName.objects.filter(name='i1').values_list('name')
2999.         self.assertQuerysetEqual(
3000.             NullableName.objects.exclude(name__in=inner_qs),
3001.             [none_val], attrgetter('name'))
3002.         # The inner queryset wasn't executed - it should be turned
3003.         # into subquery above
3004.         self.assertIs(inner_qs._result_cache, None)
3005. 
3006.     @unittest.expectedFailure
3007.     def test_col_not_in_list_containing_null(self):
3008.         """
3009.         The following case is not handled properly because
3010.         SQL's COL NOT IN (list containing null) handling is too weird to
3011.         abstract away.
3012.         """
3013.         self.assertQuerysetEqual(
3014.             NullableName.objects.exclude(name__in=[None]),
3015.             ['i1'], attrgetter('name'))
3016. 
3017.     def test_double_exclude(self):
3018.         self.assertEqual(
3019.             list(NullableName.objects.filter(~~Q(name='i1'))),
3020.             list(NullableName.objects.filter(Q(name='i1'))))
3021.         self.assertNotIn(
3022.             'IS NOT NULL',
3023.             str(NullableName.objects.filter(~~Q(name='i1')).query))
3024. 
3025. 
3026. class EmptyStringsAsNullTest(TestCase):
3027.     """
3028.     Filtering on non-null character fields works as expected.
3029.     The reason for these tests is that Oracle treats '' as NULL, and this
3030.     can cause problems in query construction. Refs #17957.
3031.     """
3032.     @classmethod
3033.     def setUpTestData(cls):
3034.         cls.nc = NamedCategory.objects.create(name='')
3035. 
3036.     def test_direct_exclude(self):
3037.         self.assertQuerysetEqual(
3038.             NamedCategory.objects.exclude(name__in=['nonexistent']),
3039.             [self.nc.pk], attrgetter('pk')
3040.         )
3041. 
3042.     def test_joined_exclude(self):
3043.         self.assertQuerysetEqual(
3044.             DumbCategory.objects.exclude(namedcategory__name__in=['nonexistent']),
3045.             [self.nc.pk], attrgetter('pk')
3046.         )
3047. 
3048.     def test_21001(self):
3049.         foo = NamedCategory.objects.create(name='foo')
3050.         self.assertQuerysetEqual(
3051.             NamedCategory.objects.exclude(name=''),
3052.             [foo.pk], attrgetter('pk')
3053.         )
3054. 
3055. 
3056. class ProxyQueryCleanupTest(TestCase):
3057.     def test_evaluated_proxy_count(self):
3058.         """
3059.         Generating the query string doesn't alter the query's state
3060.         in irreversible ways. Refs #18248.
3061.         """
3062.         ProxyCategory.objects.create()
3063.         qs = ProxyCategory.objects.all()
3064.         self.assertEqual(qs.count(), 1)
3065.         str(qs.query)
3066.         self.assertEqual(qs.count(), 1)
3067. 
3068. 
3069. class WhereNodeTest(SimpleTestCase):
3070.     class DummyNode:
3071.         def as_sql(self, compiler, connection):
3072.             return 'dummy', []
3073. 
3074.     class MockCompiler:
3075.         def compile(self, node):
3076.             return node.as_sql(self, connection)
3077. 
3078.         def __call__(self, name):
3079.             return connection.ops.quote_name(name)
3080. 
3081.     def test_empty_full_handling_conjunction(self):
3082.         compiler = WhereNodeTest.MockCompiler()
3083.         w = WhereNode(children=[NothingNode()])
3084.         with self.assertRaises(EmptyResultSet):
3085.             w.as_sql(compiler, connection)
3086.         w.negate()
3087.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3088.         w = WhereNode(children=[self.DummyNode(), self.DummyNode()])
3089.         self.assertEqual(w.as_sql(compiler, connection), ('(dummy AND dummy)', []))
3090.         w.negate()
3091.         self.assertEqual(w.as_sql(compiler, connection), ('NOT (dummy AND dummy)', []))
3092.         w = WhereNode(children=[NothingNode(), self.DummyNode()])
3093.         with self.assertRaises(EmptyResultSet):
3094.             w.as_sql(compiler, connection)
3095.         w.negate()
3096.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3097. 
3098.     def test_empty_full_handling_disjunction(self):
3099.         compiler = WhereNodeTest.MockCompiler()
3100.         w = WhereNode(children=[NothingNode()], connector='OR')
3101.         with self.assertRaises(EmptyResultSet):
3102.             w.as_sql(compiler, connection)
3103.         w.negate()
3104.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3105.         w = WhereNode(children=[self.DummyNode(), self.DummyNode()], connector='OR')
3106.         self.assertEqual(w.as_sql(compiler, connection), ('(dummy OR dummy)', []))
3107.         w.negate()
3108.         self.assertEqual(w.as_sql(compiler, connection), ('NOT (dummy OR dummy)', []))
3109.         w = WhereNode(children=[NothingNode(), self.DummyNode()], connector='OR')
3110.         self.assertEqual(w.as_sql(compiler, connection), ('dummy', []))
3111.         w.negate()
3112.         self.assertEqual(w.as_sql(compiler, connection), ('NOT (dummy)', []))
3113. 
3114.     def test_empty_nodes(self):
3115.         compiler = WhereNodeTest.MockCompiler()
3116.         empty_w = WhereNode()
3117.         w = WhereNode(children=[empty_w, empty_w])
3118.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3119.         w.negate()
3120.         with self.assertRaises(EmptyResultSet):
3121.             w.as_sql(compiler, connection)
3122.         w.connector = 'OR'
3123.         with self.assertRaises(EmptyResultSet):
3124.             w.as_sql(compiler, connection)
3125.         w.negate()
3126.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3127.         w = WhereNode(children=[empty_w, NothingNode()], connector='OR')
3128.         self.assertEqual(w.as_sql(compiler, connection), ('', []))
3129.         w = WhereNode(children=[empty_w, NothingNode()], connector='AND')
3130.         with self.assertRaises(EmptyResultSet):
3131.             w.as_sql(compiler, connection)
3132. 
3133. 
3134. class QuerySetExceptionTests(SimpleTestCase):
3135.     def test_iter_exceptions(self):
3136.         qs = ExtraInfo.objects.only('author')
3137.         msg = "'ManyToOneRel' object has no attribute 'attname'"
3138.         with self.assertRaisesMessage(AttributeError, msg):
3139.             list(qs)
3140. 
3141.     def test_invalid_order_by(self):
3142.         msg = (
3143.             "Cannot resolve keyword '*' into field. Choices are: created, id, "
3144.             "name"
3145.         )
3146.         with self.assertRaisesMessage(FieldError, msg):
3147.             Article.objects.order_by('*')
3148. 
3149.     def test_invalid_queryset_model(self):
3150.         msg = 'Cannot use QuerySet for "Article": Use a QuerySet for "ExtraInfo".'
3151.         with self.assertRaisesMessage(ValueError, msg):
3152.             list(Author.objects.filter(extra=Article.objects.all()))
3153. 
3154. 
3155. class NullJoinPromotionOrTest(TestCase):
3156.     @classmethod
3157.     def setUpTestData(cls):
3158.         cls.d1 = ModelD.objects.create(name='foo')
3159.         d2 = ModelD.objects.create(name='bar')
3160.         cls.a1 = ModelA.objects.create(name='a1', d=cls.d1)
3161.         c = ModelC.objects.create(name='c')
3162.         b = ModelB.objects.create(name='b', c=c)
3163.         cls.a2 = ModelA.objects.create(name='a2', b=b, d=d2)
3164. 
3165.     def test_ticket_17886(self):
3166.         # The first Q-object is generating the match, the rest of the filters
3167.         # should not remove the match even if they do not match anything. The
3168.         # problem here was that b__name generates a LOUTER JOIN, then
3169.         # b__c__name generates join to c, which the ORM tried to promote but
3170.         # failed as that join isn't nullable.
3171.         q_obj = (
3172.             Q(d__name='foo') |
3173.             Q(b__name='foo') |
3174.             Q(b__c__name='foo')
3175.         )
3176.         qset = ModelA.objects.filter(q_obj)
3177.         self.assertEqual(list(qset), [self.a1])
3178.         # We generate one INNER JOIN to D. The join is direct and not nullable
3179.         # so we can use INNER JOIN for it. However, we can NOT use INNER JOIN
3180.         # for the b->c join, as a->b is nullable.
3181.         self.assertEqual(str(qset.query).count('INNER JOIN'), 1)
3182. 
3183.     def test_isnull_filter_promotion(self):
3184.         qs = ModelA.objects.filter(Q(b__name__isnull=True))
3185.         self.assertEqual(str(qs.query).count('LEFT OUTER'), 1)
3186.         self.assertEqual(list(qs), [self.a1])
3187. 
3188.         qs = ModelA.objects.filter(~Q(b__name__isnull=True))
3189.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3190.         self.assertEqual(list(qs), [self.a2])
3191. 
3192.         qs = ModelA.objects.filter(~~Q(b__name__isnull=True))
3193.         self.assertEqual(str(qs.query).count('LEFT OUTER'), 1)
3194.         self.assertEqual(list(qs), [self.a1])
3195. 
3196.         qs = ModelA.objects.filter(Q(b__name__isnull=False))
3197.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3198.         self.assertEqual(list(qs), [self.a2])
3199. 
3200.         qs = ModelA.objects.filter(~Q(b__name__isnull=False))
3201.         self.assertEqual(str(qs.query).count('LEFT OUTER'), 1)
3202.         self.assertEqual(list(qs), [self.a1])
3203. 
3204.         qs = ModelA.objects.filter(~~Q(b__name__isnull=False))
3205.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3206.         self.assertEqual(list(qs), [self.a2])
3207. 
3208.     def test_null_join_demotion(self):
3209.         qs = ModelA.objects.filter(Q(b__name__isnull=False) & Q(b__name__isnull=True))
3210.         self.assertIn(' INNER JOIN ', str(qs.query))
3211.         qs = ModelA.objects.filter(Q(b__name__isnull=True) & Q(b__name__isnull=False))
3212.         self.assertIn(' INNER JOIN ', str(qs.query))
3213.         qs = ModelA.objects.filter(Q(b__name__isnull=False) | Q(b__name__isnull=True))
3214.         self.assertIn(' LEFT OUTER JOIN ', str(qs.query))
3215.         qs = ModelA.objects.filter(Q(b__name__isnull=True) | Q(b__name__isnull=False))
3216.         self.assertIn(' LEFT OUTER JOIN ', str(qs.query))
3217. 
3218.     def test_ticket_21366(self):
3219.         n = Note.objects.create(note='n', misc='m')
3220.         e = ExtraInfo.objects.create(info='info', note=n)
3221.         a = Author.objects.create(name='Author1', num=1, extra=e)
3222.         Ranking.objects.create(rank=1, author=a)
3223.         r1 = Report.objects.create(name='Foo', creator=a)
3224.         r2 = Report.objects.create(name='Bar')
3225.         Report.objects.create(name='Bar', creator=a)
3226.         qs = Report.objects.filter(
3227.             Q(creator__ranking__isnull=True) |
3228.             Q(creator__ranking__rank=1, name='Foo')
3229.         )
3230.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3231.         self.assertEqual(str(qs.query).count(' JOIN '), 2)
3232.         self.assertSequenceEqual(qs.order_by('name'), [r2, r1])
3233. 
3234.     def test_ticket_21748(self):
3235.         i1 = Identifier.objects.create(name='i1')
3236.         i2 = Identifier.objects.create(name='i2')
3237.         i3 = Identifier.objects.create(name='i3')
3238.         Program.objects.create(identifier=i1)
3239.         Channel.objects.create(identifier=i1)
3240.         Program.objects.create(identifier=i2)
3241.         self.assertSequenceEqual(Identifier.objects.filter(program=None, channel=None), [i3])
3242.         self.assertSequenceEqual(Identifier.objects.exclude(program=None, channel=None).order_by('name'), [i1, i2])
3243. 
3244.     def test_ticket_21748_double_negated_and(self):
3245.         i1 = Identifier.objects.create(name='i1')
3246.         i2 = Identifier.objects.create(name='i2')
3247.         Identifier.objects.create(name='i3')
3248.         p1 = Program.objects.create(identifier=i1)
3249.         c1 = Channel.objects.create(identifier=i1)
3250.         Program.objects.create(identifier=i2)
3251.         # Check the ~~Q() (or equivalently .exclude(~Q)) works like Q() for
3252.         # join promotion.
3253.         qs1_doubleneg = Identifier.objects.exclude(~Q(program__id=p1.id, channel__id=c1.id)).order_by('pk')
3254.         qs1_filter = Identifier.objects.filter(program__id=p1.id, channel__id=c1.id).order_by('pk')
3255.         self.assertQuerysetEqual(qs1_doubleneg, qs1_filter, lambda x: x)
3256.         self.assertEqual(str(qs1_filter.query).count('JOIN'),
3257.                          str(qs1_doubleneg.query).count('JOIN'))
3258.         self.assertEqual(2, str(qs1_doubleneg.query).count('INNER JOIN'))
3259.         self.assertEqual(str(qs1_filter.query).count('INNER JOIN'),
3260.                          str(qs1_doubleneg.query).count('INNER JOIN'))
3261. 
3262.     def test_ticket_21748_double_negated_or(self):
3263.         i1 = Identifier.objects.create(name='i1')
3264.         i2 = Identifier.objects.create(name='i2')
3265.         Identifier.objects.create(name='i3')
3266.         p1 = Program.objects.create(identifier=i1)
3267.         c1 = Channel.objects.create(identifier=i1)
3268.         p2 = Program.objects.create(identifier=i2)
3269.         # Test OR + doubleneg. The expected result is that channel is LOUTER
3270.         # joined, program INNER joined
3271.         qs1_filter = Identifier.objects.filter(
3272.             Q(program__id=p2.id, channel__id=c1.id) | Q(program__id=p1.id)
3273.         ).order_by('pk')
3274.         qs1_doubleneg = Identifier.objects.exclude(
3275.             ~Q(Q(program__id=p2.id, channel__id=c1.id) | Q(program__id=p1.id))
3276.         ).order_by('pk')
3277.         self.assertQuerysetEqual(qs1_doubleneg, qs1_filter, lambda x: x)
3278.         self.assertEqual(str(qs1_filter.query).count('JOIN'),
3279.                          str(qs1_doubleneg.query).count('JOIN'))
3280.         self.assertEqual(1, str(qs1_doubleneg.query).count('INNER JOIN'))
3281.         self.assertEqual(str(qs1_filter.query).count('INNER JOIN'),
3282.                          str(qs1_doubleneg.query).count('INNER JOIN'))
3283. 
3284.     def test_ticket_21748_complex_filter(self):
3285.         i1 = Identifier.objects.create(name='i1')
3286.         i2 = Identifier.objects.create(name='i2')
3287.         Identifier.objects.create(name='i3')
3288.         p1 = Program.objects.create(identifier=i1)
3289.         c1 = Channel.objects.create(identifier=i1)
3290.         p2 = Program.objects.create(identifier=i2)
3291.         # Finally, a more complex case, one time in a way where each
3292.         # NOT is pushed to lowest level in the boolean tree, and
3293.         # another query where this isn't done.
3294.         qs1 = Identifier.objects.filter(
3295.             ~Q(~Q(program__id=p2.id, channel__id=c1.id) & Q(program__id=p1.id))
3296.         ).order_by('pk')
3297.         qs2 = Identifier.objects.filter(
3298.             Q(Q(program__id=p2.id, channel__id=c1.id) | ~Q(program__id=p1.id))
3299.         ).order_by('pk')
3300.         self.assertQuerysetEqual(qs1, qs2, lambda x: x)
3301.         self.assertEqual(str(qs1.query).count('JOIN'),
3302.                          str(qs2.query).count('JOIN'))
3303.         self.assertEqual(0, str(qs1.query).count('INNER JOIN'))
3304.         self.assertEqual(str(qs1.query).count('INNER JOIN'),
3305.                          str(qs2.query).count('INNER JOIN'))
3306. 
3307. 
3308. class ReverseJoinTrimmingTest(TestCase):
3309.     def test_reverse_trimming(self):
3310.         # We don't accidentally trim reverse joins - we can't know if there is
3311.         # anything on the other side of the join, so trimming reverse joins
3312.         # can't be done, ever.
3313.         t = Tag.objects.create()
3314.         qs = Tag.objects.filter(annotation__tag=t.pk)
3315.         self.assertIn('INNER JOIN', str(qs.query))
3316.         self.assertEqual(list(qs), [])
3317. 
3318. 
3319. class JoinReuseTest(TestCase):
3320.     """
3321.     The queries reuse joins sensibly (for example, direct joins
3322.     are always reused).
3323.     """
3324.     def test_fk_reuse(self):
3325.         qs = Annotation.objects.filter(tag__name='foo').filter(tag__name='bar')
3326.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3327. 
3328.     def test_fk_reuse_select_related(self):
3329.         qs = Annotation.objects.filter(tag__name='foo').select_related('tag')
3330.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3331. 
3332.     def test_fk_reuse_annotation(self):
3333.         qs = Annotation.objects.filter(tag__name='foo').annotate(cnt=Count('tag__name'))
3334.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3335. 
3336.     def test_fk_reuse_disjunction(self):
3337.         qs = Annotation.objects.filter(Q(tag__name='foo') | Q(tag__name='bar'))
3338.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3339. 
3340.     def test_fk_reuse_order_by(self):
3341.         qs = Annotation.objects.filter(tag__name='foo').order_by('tag__name')
3342.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3343. 
3344.     def test_revo2o_reuse(self):
3345.         qs = Detail.objects.filter(member__name='foo').filter(member__name='foo')
3346.         self.assertEqual(str(qs.query).count('JOIN'), 1)
3347. 
3348.     def test_revfk_noreuse(self):
3349.         qs = Author.objects.filter(report__name='r4').filter(report__name='r1')
3350.         self.assertEqual(str(qs.query).count('JOIN'), 2)
3351. 
3352.     def test_inverted_q_across_relations(self):
3353.         """
3354.         When a trimmable join is specified in the query (here school__), the
3355.         ORM detects it and removes unnecessary joins. The set of reusable joins
3356.         are updated after trimming the query so that other lookups don't
3357.         consider that the outer query's filters are in effect for the subquery
3358.         (#26551).
3359.         """
3360.         springfield_elementary = School.objects.create()
3361.         hogward = School.objects.create()
3362.         Student.objects.create(school=springfield_elementary)
3363.         hp = Student.objects.create(school=hogward)
3364.         Classroom.objects.create(school=hogward, name='Potion')
3365.         Classroom.objects.create(school=springfield_elementary, name='Main')
3366.         qs = Student.objects.filter(
3367.             ~(Q(school__classroom__name='Main') & Q(school__classroom__has_blackboard=None))
3368.         )
3369.         self.assertSequenceEqual(qs, [hp])
3370. 
3371. 
3372. class DisjunctionPromotionTests(TestCase):
3373.     def test_disjunction_promotion_select_related(self):
3374.         fk1 = FK1.objects.create(f1='f1', f2='f2')
3375.         basea = BaseA.objects.create(a=fk1)
3376.         qs = BaseA.objects.filter(Q(a=fk1) | Q(b=2))
3377.         self.assertEqual(str(qs.query).count(' JOIN '), 0)
3378.         qs = qs.select_related('a', 'b')
3379.         self.assertEqual(str(qs.query).count(' INNER JOIN '), 0)
3380.         self.assertEqual(str(qs.query).count(' LEFT OUTER JOIN '), 2)
3381.         with self.assertNumQueries(1):
3382.             self.assertSequenceEqual(qs, [basea])
3383.             self.assertEqual(qs[0].a, fk1)
3384.             self.assertIs(qs[0].b, None)
3385. 
3386.     def test_disjunction_promotion1(self):
3387.         # Pre-existing join, add two ORed filters to the same join,
3388.         # all joins can be INNER JOINS.
3389.         qs = BaseA.objects.filter(a__f1='foo')
3390.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3391.         qs = qs.filter(Q(b__f1='foo') | Q(b__f2='foo'))
3392.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3393.         # Reverse the order of AND and OR filters.
3394.         qs = BaseA.objects.filter(Q(b__f1='foo') | Q(b__f2='foo'))
3395.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3396.         qs = qs.filter(a__f1='foo')
3397.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3398. 
3399.     def test_disjunction_promotion2(self):
3400.         qs = BaseA.objects.filter(a__f1='foo')
3401.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3402.         # Now we have two different joins in an ORed condition, these
3403.         # must be OUTER joins. The pre-existing join should remain INNER.
3404.         qs = qs.filter(Q(b__f1='foo') | Q(c__f2='foo'))
3405.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3406.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3407.         # Reverse case.
3408.         qs = BaseA.objects.filter(Q(b__f1='foo') | Q(c__f2='foo'))
3409.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3410.         qs = qs.filter(a__f1='foo')
3411.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3412.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3413. 
3414.     def test_disjunction_promotion3(self):
3415.         qs = BaseA.objects.filter(a__f2='bar')
3416.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3417.         # The ANDed a__f2 filter allows us to use keep using INNER JOIN
3418.         # even inside the ORed case. If the join to a__ returns nothing,
3419.         # the ANDed filter for a__f2 can't be true.
3420.         qs = qs.filter(Q(a__f1='foo') | Q(b__f2='foo'))
3421.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3422.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3423. 
3424.     def test_disjunction_promotion3_demote(self):
3425.         # This one needs demotion logic: the first filter causes a to be
3426.         # outer joined, the second filter makes it inner join again.
3427.         qs = BaseA.objects.filter(
3428.             Q(a__f1='foo') | Q(b__f2='foo')).filter(a__f2='bar')
3429.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3430.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3431. 
3432.     def test_disjunction_promotion4_demote(self):
3433.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3434.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3435.         # Demote needed for the "a" join. It is marked as outer join by
3436.         # above filter (even if it is trimmed away).
3437.         qs = qs.filter(a__f1='foo')
3438.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3439. 
3440.     def test_disjunction_promotion4(self):
3441.         qs = BaseA.objects.filter(a__f1='foo')
3442.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3443.         qs = qs.filter(Q(a=1) | Q(a=2))
3444.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3445. 
3446.     def test_disjunction_promotion5_demote(self):
3447.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3448.         # Note that the above filters on a force the join to an
3449.         # inner join even if it is trimmed.
3450.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3451.         qs = qs.filter(Q(a__f1='foo') | Q(b__f1='foo'))
3452.         # So, now the a__f1 join doesn't need promotion.
3453.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3454.         # But b__f1 does.
3455.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3456.         qs = BaseA.objects.filter(Q(a__f1='foo') | Q(b__f1='foo'))
3457.         # Now the join to a is created as LOUTER
3458.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3459.         qs = qs.filter(Q(a=1) | Q(a=2))
3460.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3461.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3462. 
3463.     def test_disjunction_promotion6(self):
3464.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3465.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3466.         qs = BaseA.objects.filter(Q(a__f1='foo') & Q(b__f1='foo'))
3467.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3468.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 0)
3469. 
3470.         qs = BaseA.objects.filter(Q(a__f1='foo') & Q(b__f1='foo'))
3471.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 0)
3472.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3473.         qs = qs.filter(Q(a=1) | Q(a=2))
3474.         self.assertEqual(str(qs.query).count('INNER JOIN'), 2)
3475.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 0)
3476. 
3477.     def test_disjunction_promotion7(self):
3478.         qs = BaseA.objects.filter(Q(a=1) | Q(a=2))
3479.         self.assertEqual(str(qs.query).count('JOIN'), 0)
3480.         qs = BaseA.objects.filter(Q(a__f1='foo') | (Q(b__f1='foo') & Q(a__f1='bar')))
3481.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3482.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3483.         qs = BaseA.objects.filter(
3484.             (Q(a__f1='foo') | Q(b__f1='foo')) & (Q(a__f1='bar') | Q(c__f1='foo'))
3485.         )
3486.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 3)
3487.         self.assertEqual(str(qs.query).count('INNER JOIN'), 0)
3488.         qs = BaseA.objects.filter(
3489.             Q(a__f1='foo') | Q(a__f1='bar') & (Q(b__f1='bar') | Q(c__f1='foo'))
3490.         )
3491.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3492.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3493. 
3494.     def test_disjunction_promotion_fexpression(self):
3495.         qs = BaseA.objects.filter(Q(a__f1=F('b__f1')) | Q(b__f1='foo'))
3496.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 1)
3497.         self.assertEqual(str(qs.query).count('INNER JOIN'), 1)
3498.         qs = BaseA.objects.filter(Q(a__f1=F('c__f1')) | Q(b__f1='foo'))
3499.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 3)
3500.         qs = BaseA.objects.filter(Q(a__f1=F('b__f1')) | Q(a__f2=F('b__f2')) | Q(c__f1='foo'))
3501.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 3)
3502.         qs = BaseA.objects.filter(Q(a__f1=F('c__f1')) | (Q(pk=1) & Q(pk=2)))
3503.         self.assertEqual(str(qs.query).count('LEFT OUTER JOIN'), 2)
3504.         self.assertEqual(str(qs.query).count('INNER JOIN'), 0)
3505. 
3506. 
3507. class ManyToManyExcludeTest(TestCase):
3508.     def test_exclude_many_to_many(self):
3509.         Identifier.objects.create(name='extra')
3510.         program = Program.objects.create(identifier=Identifier.objects.create(name='program'))
3511.         channel = Channel.objects.create(identifier=Identifier.objects.create(name='channel'))
3512.         channel.programs.add(program)
3513. 
3514.         # channel contains 'program1', so all Identifiers except that one
3515.         # should be returned
3516.         self.assertQuerysetEqual(
3517.             Identifier.objects.exclude(program__channel=channel).order_by('name'),
3518.             ['<Identifier: channel>', '<Identifier: extra>']
3519.         )
3520.         self.assertQuerysetEqual(
3521.             Identifier.objects.exclude(program__channel=None).order_by('name'),
3522.             ['<Identifier: program>']
3523.         )
3524. 
3525.     def test_ticket_12823(self):
3526.         pg3 = Page.objects.create(text='pg3')
3527.         pg2 = Page.objects.create(text='pg2')
3528.         pg1 = Page.objects.create(text='pg1')
3529.         pa1 = Paragraph.objects.create(text='pa1')
3530.         pa1.page.set([pg1, pg2])
3531.         pa2 = Paragraph.objects.create(text='pa2')
3532.         pa2.page.set([pg2, pg3])
3533.         pa3 = Paragraph.objects.create(text='pa3')
3534.         ch1 = Chapter.objects.create(title='ch1', paragraph=pa1)
3535.         ch2 = Chapter.objects.create(title='ch2', paragraph=pa2)
3536.         ch3 = Chapter.objects.create(title='ch3', paragraph=pa3)
3537.         b1 = Book.objects.create(title='b1', chapter=ch1)
3538.         b2 = Book.objects.create(title='b2', chapter=ch2)
3539.         b3 = Book.objects.create(title='b3', chapter=ch3)
3540.         q = Book.objects.exclude(chapter__paragraph__page__text='pg1')
3541.         self.assertNotIn('IS NOT NULL', str(q.query))
3542.         self.assertEqual(len(q), 2)
3543.         self.assertNotIn(b1, q)
3544.         self.assertIn(b2, q)
3545.         self.assertIn(b3, q)
3546. 
3547. 
3548. class RelabelCloneTest(TestCase):
3549.     def test_ticket_19964(self):
3550.         my1 = MyObject.objects.create(data='foo')
3551.         my1.parent = my1
3552.         my1.save()
3553.         my2 = MyObject.objects.create(data='bar', parent=my1)
3554.         parents = MyObject.objects.filter(parent=F('id'))
3555.         children = MyObject.objects.filter(parent__in=parents).exclude(parent=F('id'))
3556.         self.assertEqual(list(parents), [my1])
3557.         # Evaluating the children query (which has parents as part of it) does
3558.         # not change results for the parents query.
3559.         self.assertEqual(list(children), [my2])
3560.         self.assertEqual(list(parents), [my1])
3561. 
3562. 
3563. class Ticket20101Tests(TestCase):
3564.     def test_ticket_20101(self):
3565.         """
3566.         Tests QuerySet ORed combining in exclude subquery case.
3567.         """
3568.         t = Tag.objects.create(name='foo')
3569.         a1 = Annotation.objects.create(tag=t, name='a1')
3570.         a2 = Annotation.objects.create(tag=t, name='a2')
3571.         a3 = Annotation.objects.create(tag=t, name='a3')
3572.         n = Note.objects.create(note='foo', misc='bar')
3573.         qs1 = Note.objects.exclude(annotation__in=[a1, a2])
3574.         qs2 = Note.objects.filter(annotation__in=[a3])
3575.         self.assertIn(n, qs1)
3576.         self.assertNotIn(n, qs2)
3577.         self.assertIn(n, (qs1 | qs2))
3578. 
3579. 
3580. class EmptyStringPromotionTests(SimpleTestCase):
3581.     def test_empty_string_promotion(self):
3582.         qs = RelatedObject.objects.filter(single__name='')
3583.         if connection.features.interprets_empty_strings_as_nulls:
3584.             self.assertIn('LEFT OUTER JOIN', str(qs.query))
3585.         else:
3586.             self.assertNotIn('LEFT OUTER JOIN', str(qs.query))
3587. 
3588. 
3589. class ValuesSubqueryTests(TestCase):
3590.     def test_values_in_subquery(self):
3591.         # If a values() queryset is used, then the given values
3592.         # will be used instead of forcing use of the relation's field.
3593.         o1 = Order.objects.create(id=-2)
3594.         o2 = Order.objects.create(id=-1)
3595.         oi1 = OrderItem.objects.create(order=o1, status=0)
3596.         oi1.status = oi1.pk
3597.         oi1.save()
3598.         OrderItem.objects.create(order=o2, status=0)
3599. 
3600.         # The query below should match o1 as it has related order_item
3601.         # with id == status.
3602.         self.assertSequenceEqual(Order.objects.filter(items__in=OrderItem.objects.values_list('status')), [o1])
3603. 
3604. 
3605. class DoubleInSubqueryTests(TestCase):
3606.     def test_double_subquery_in(self):
3607.         lfa1 = LeafA.objects.create(data='foo')
3608.         lfa2 = LeafA.objects.create(data='bar')
3609.         lfb1 = LeafB.objects.create(data='lfb1')
3610.         lfb2 = LeafB.objects.create(data='lfb2')
3611.         Join.objects.create(a=lfa1, b=lfb1)
3612.         Join.objects.create(a=lfa2, b=lfb2)
3613.         leaf_as = LeafA.objects.filter(data='foo').values_list('pk', flat=True)
3614.         joins = Join.objects.filter(a__in=leaf_as).values_list('b__id', flat=True)
3615.         qs = LeafB.objects.filter(pk__in=joins)
3616.         self.assertSequenceEqual(qs, [lfb1])
3617. 
3618. 
3619. class Ticket18785Tests(SimpleTestCase):
3620.     def test_ticket_18785(self):
3621.         # Test join trimming from ticket18785
3622.         qs = Item.objects.exclude(
3623.             note__isnull=False
3624.         ).filter(
3625.             name='something', creator__extra__isnull=True
3626.         ).order_by()
3627.         self.assertEqual(1, str(qs.query).count('INNER JOIN'))
3628.         self.assertEqual(0, str(qs.query).count('OUTER JOIN'))
3629. 
3630. 
3631. class Ticket20788Tests(TestCase):
3632.     def test_ticket_20788(self):
3633.         Paragraph.objects.create()
3634.         paragraph = Paragraph.objects.create()
3635.         page = paragraph.page.create()
3636.         chapter = Chapter.objects.create(paragraph=paragraph)
3637.         Book.objects.create(chapter=chapter)
3638. 
3639.         paragraph2 = Paragraph.objects.create()
3640.         Page.objects.create()
3641.         chapter2 = Chapter.objects.create(paragraph=paragraph2)
3642.         book2 = Book.objects.create(chapter=chapter2)
3643. 
3644.         sentences_not_in_pub = Book.objects.exclude(chapter__paragraph__page=page)
3645.         self.assertSequenceEqual(sentences_not_in_pub, [book2])
3646. 
3647. 
3648. class Ticket12807Tests(TestCase):
3649.     def test_ticket_12807(self):
3650.         p1 = Paragraph.objects.create()
3651.         p2 = Paragraph.objects.create()
3652.         # The ORed condition below should have no effect on the query - the
3653.         # ~Q(pk__in=[]) will always be True.
3654.         qs = Paragraph.objects.filter((Q(pk=p2.pk) | ~Q(pk__in=[])) & Q(pk=p1.pk))
3655.         self.assertSequenceEqual(qs, [p1])
3656. 
3657. 
3658. class RelatedLookupTypeTests(TestCase):
3659.     error = 'Cannot query "%s": Must be "%s" instance.'
3660. 
3661.     @classmethod
3662.     def setUpTestData(cls):
3663.         cls.oa = ObjectA.objects.create(name="oa")
3664.         cls.poa = ProxyObjectA.objects.get(name="oa")
3665.         cls.coa = ChildObjectA.objects.create(name="coa")
3666.         cls.wrong_type = Order.objects.create(id=cls.oa.pk)
3667.         cls.ob = ObjectB.objects.create(name="ob", objecta=cls.oa, num=1)
3668.         ProxyObjectB.objects.create(name="pob", objecta=cls.oa, num=2)
3669.         cls.pob = ProxyObjectB.objects.all()
3670.         ObjectC.objects.create(childobjecta=cls.coa)
3671. 
3672.     def test_wrong_type_lookup(self):
3673.         """
3674.         A ValueError is raised when the incorrect object type is passed to a
3675.         query lookup.
3676.         """
3677.         # Passing incorrect object type
3678.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectA._meta.object_name)):
3679.             ObjectB.objects.get(objecta=self.wrong_type)
3680. 
3681.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectA._meta.object_name)):
3682.             ObjectB.objects.filter(objecta__in=[self.wrong_type])
3683. 
3684.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectA._meta.object_name)):
3685.             ObjectB.objects.filter(objecta=self.wrong_type)
3686. 
3687.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectB._meta.object_name)):
3688.             ObjectA.objects.filter(objectb__in=[self.wrong_type, self.ob])
3689. 
3690.         # Passing an object of the class on which query is done.
3691.         with self.assertRaisesMessage(ValueError, self.error % (self.ob, ObjectA._meta.object_name)):
3692.             ObjectB.objects.filter(objecta__in=[self.poa, self.ob])
3693. 
3694.         with self.assertRaisesMessage(ValueError, self.error % (self.ob, ChildObjectA._meta.object_name)):
3695.             ObjectC.objects.exclude(childobjecta__in=[self.coa, self.ob])
3696. 
3697.     def test_wrong_backward_lookup(self):
3698.         """
3699.         A ValueError is raised when the incorrect object type is passed to a
3700.         query lookup for backward relations.
3701.         """
3702.         with self.assertRaisesMessage(ValueError, self.error % (self.oa, ObjectB._meta.object_name)):
3703.             ObjectA.objects.filter(objectb__in=[self.oa, self.ob])
3704. 
3705.         with self.assertRaisesMessage(ValueError, self.error % (self.oa, ObjectB._meta.object_name)):
3706.             ObjectA.objects.exclude(objectb=self.oa)
3707. 
3708.         with self.assertRaisesMessage(ValueError, self.error % (self.wrong_type, ObjectB._meta.object_name)):
3709.             ObjectA.objects.get(objectb=self.wrong_type)
3710. 
3711.     def test_correct_lookup(self):
3712.         """
3713.         When passing proxy model objects, child objects, or parent objects,
3714.         lookups work fine.
3715.         """
3716.         out_a = ['<ObjectA: oa>']
3717.         out_b = ['<ObjectB: ob>', '<ObjectB: pob>']
3718.         out_c = ['<ObjectC: >']
3719. 
3720.         # proxy model objects
3721.         self.assertQuerysetEqual(ObjectB.objects.filter(objecta=self.poa).order_by('name'), out_b)
3722.         self.assertQuerysetEqual(ObjectA.objects.filter(objectb__in=self.pob).order_by('pk'), out_a * 2)
3723. 
3724.         # child objects
3725.         self.assertQuerysetEqual(ObjectB.objects.filter(objecta__in=[self.coa]), [])
3726.         self.assertQuerysetEqual(ObjectB.objects.filter(objecta__in=[self.poa, self.coa]).order_by('name'), out_b)
3727.         self.assertQuerysetEqual(
3728.             ObjectB.objects.filter(objecta__in=iter([self.poa, self.coa])).order_by('name'),
3729.             out_b
3730.         )
3731. 
3732.         # parent objects
3733.         self.assertQuerysetEqual(ObjectC.objects.exclude(childobjecta=self.oa), out_c)
3734. 
3735.         # QuerySet related object type checking shouldn't issue queries
3736.         # (the querysets aren't evaluated here, hence zero queries) (#23266).
3737.         with self.assertNumQueries(0):
3738.             ObjectB.objects.filter(objecta__in=ObjectA.objects.all())
3739. 
3740.     def test_values_queryset_lookup(self):
3741.         """
3742.         #23396 - Ensure ValueQuerySets are not checked for compatibility with the lookup field
3743.         """
3744.         # Make sure the num and objecta field values match.
3745.         ob = ObjectB.objects.get(name='ob')
3746.         ob.num = ob.objecta.pk
3747.         ob.save()
3748.         pob = ObjectB.objects.get(name='pob')
3749.         pob.num = pob.objecta.pk
3750.         pob.save()
3751.         self.assertQuerysetEqual(ObjectB.objects.filter(
3752.             objecta__in=ObjectB.objects.all().values_list('num')
3753.         ).order_by('pk'), ['<ObjectB: ob>', '<ObjectB: pob>'])
3754. 
3755. 
3756. class Ticket14056Tests(TestCase):
3757.     def test_ticket_14056(self):
3758.         s1 = SharedConnection.objects.create(data='s1')
3759.         s2 = SharedConnection.objects.create(data='s2')
3760.         s3 = SharedConnection.objects.create(data='s3')
3761.         PointerA.objects.create(connection=s2)
3762.         expected_ordering = (
3763.             [s1, s3, s2] if connection.features.nulls_order_largest
3764.             else [s2, s1, s3]
3765.         )
3766.         self.assertSequenceEqual(SharedConnection.objects.order_by('-pointera__connection', 'pk'), expected_ordering)
3767. 
3768. 
3769. class Ticket20955Tests(TestCase):
3770.     def test_ticket_20955(self):
3771.         jack = Staff.objects.create(name='jackstaff')
3772.         jackstaff = StaffUser.objects.create(staff=jack)
3773.         jill = Staff.objects.create(name='jillstaff')
3774.         jillstaff = StaffUser.objects.create(staff=jill)
3775.         task = Task.objects.create(creator=jackstaff, owner=jillstaff, title="task")
3776.         task_get = Task.objects.get(pk=task.pk)
3777.         # Load data so that assertNumQueries doesn't complain about the get
3778.         # version's queries.
3779.         task_get.creator.staffuser.staff
3780.         task_get.owner.staffuser.staff
3781.         qs = Task.objects.select_related(
3782.             'creator__staffuser__staff', 'owner__staffuser__staff')
3783.         self.assertEqual(str(qs.query).count(' JOIN '), 6)
3784.         task_select_related = qs.get(pk=task.pk)
3785.         with self.assertNumQueries(0):
3786.             self.assertEqual(task_select_related.creator.staffuser.staff,
3787.                              task_get.creator.staffuser.staff)
3788.             self.assertEqual(task_select_related.owner.staffuser.staff,
3789.                              task_get.owner.staffuser.staff)
3790. 
3791. 
3792. class Ticket21203Tests(TestCase):
3793.     def test_ticket_21203(self):
3794.         p = Ticket21203Parent.objects.create(parent_bool=True)
3795.         c = Ticket21203Child.objects.create(parent=p)
3796.         qs = Ticket21203Child.objects.select_related('parent').defer('parent__created')
3797.         self.assertSequenceEqual(qs, [c])
3798.         self.assertIs(qs[0].parent.parent_bool, True)
3799. 
3800. 
3801. class ValuesJoinPromotionTests(TestCase):
3802.     def test_values_no_promotion_for_existing(self):
3803.         qs = Node.objects.filter(parent__parent__isnull=False)
3804.         self.assertIn(' INNER JOIN ', str(qs.query))
3805.         qs = qs.values('parent__parent__id')
3806.         self.assertIn(' INNER JOIN ', str(qs.query))
3807.         # Make sure there is a left outer join without the filter.
3808.         qs = Node.objects.values('parent__parent__id')
3809.         self.assertIn(' LEFT OUTER JOIN ', str(qs.query))
3810. 
3811.     def test_non_nullable_fk_not_promoted(self):
3812.         qs = ObjectB.objects.values('objecta__name')
3813.         self.assertIn(' INNER JOIN ', str(qs.query))
3814. 
3815.     def test_ticket_21376(self):
3816.         a = ObjectA.objects.create()
3817.         ObjectC.objects.create(objecta=a)
3818.         qs = ObjectC.objects.filter(
3819.             Q(objecta=a) | Q(objectb__objecta=a),
3820.         )
3821.         qs = qs.filter(
3822.             Q(objectb=1) | Q(objecta=a),
3823.         )
3824.         self.assertEqual(qs.count(), 1)
3825.         tblname = connection.ops.quote_name(ObjectB._meta.db_table)
3826.         self.assertIn(' LEFT OUTER JOIN %s' % tblname, str(qs.query))
3827. 
3828. 
3829. class ForeignKeyToBaseExcludeTests(TestCase):
3830.     def test_ticket_21787(self):
3831.         sc1 = SpecialCategory.objects.create(special_name='sc1', name='sc1')
3832.         sc2 = SpecialCategory.objects.create(special_name='sc2', name='sc2')
3833.         sc3 = SpecialCategory.objects.create(special_name='sc3', name='sc3')
3834.         c1 = CategoryItem.objects.create(category=sc1)
3835.         CategoryItem.objects.create(category=sc2)
3836.         self.assertSequenceEqual(SpecialCategory.objects.exclude(categoryitem__id=c1.pk).order_by('name'), [sc2, sc3])
3837.         self.assertSequenceEqual(SpecialCategory.objects.filter(categoryitem__id=c1.pk), [sc1])
3838. 
3839. 
3840. class ReverseM2MCustomPkTests(TestCase):
3841.     def test_ticket_21879(self):
3842.         cpt1 = CustomPkTag.objects.create(id='cpt1', tag='cpt1')
3843.         cp1 = CustomPk.objects.create(name='cp1', extra='extra')
3844.         cp1.custompktag_set.add(cpt1)
3845.         self.assertSequenceEqual(CustomPk.objects.filter(custompktag=cpt1), [cp1])
3846.         self.assertSequenceEqual(CustomPkTag.objects.filter(custom_pk=cp1), [cpt1])
3847. 
3848. 
3849. class Ticket22429Tests(TestCase):
3850.     def test_ticket_22429(self):
3851.         sc1 = School.objects.create()
3852.         st1 = Student.objects.create(school=sc1)
3853. 
3854.         sc2 = School.objects.create()
3855.         st2 = Student.objects.create(school=sc2)
3856. 
3857.         cr = Classroom.objects.create(school=sc1)
3858.         cr.students.add(st1)
3859. 
3860.         queryset = Student.objects.filter(~Q(classroom__school=F('school')))
3861.         self.assertSequenceEqual(queryset, [st2])
3862. 
3863. 
3864. class Ticket23605Tests(TestCase):
3865.     def test_ticket_23605(self):
3866.         # Test filtering on a complicated q-object from ticket's report.
3867.         # The query structure is such that we have multiple nested subqueries.
3868.         # The original problem was that the inner queries weren't relabeled
3869.         # correctly.
3870.         # See also #24090.
3871.         a1 = Ticket23605A.objects.create()
3872.         a2 = Ticket23605A.objects.create()
3873.         c1 = Ticket23605C.objects.create(field_c0=10000.0)
3874.         Ticket23605B.objects.create(
3875.             field_b0=10000.0, field_b1=True,
3876.             modelc_fk=c1, modela_fk=a1)
3877.         complex_q = Q(pk__in=Ticket23605A.objects.filter(
3878.             Q(
3879.                 # True for a1 as field_b0 = 10000, field_c0=10000
3880.                 # False for a2 as no ticket23605b found
3881.                 ticket23605b__field_b0__gte=1000000 /
3882.                 F("ticket23605b__modelc_fk__field_c0")
3883.             ) &
3884.             # True for a1 (field_b1=True)
3885.             Q(ticket23605b__field_b1=True) & ~Q(ticket23605b__pk__in=Ticket23605B.objects.filter(
3886.                 ~(
3887.                     # Same filters as above commented filters, but
3888.                     # double-negated (one for Q() above, one for
3889.                     # parentheses). So, again a1 match, a2 not.
3890.                     Q(field_b1=True) &
3891.                     Q(field_b0__gte=1000000 / F("modelc_fk__field_c0"))
3892.                 )
3893.             ))).filter(ticket23605b__field_b1=True))
3894.         qs1 = Ticket23605A.objects.filter(complex_q)
3895.         self.assertSequenceEqual(qs1, [a1])
3896.         qs2 = Ticket23605A.objects.exclude(complex_q)
3897.         self.assertSequenceEqual(qs2, [a2])
3898. 
3899. 
3900. class TestTicket24279(TestCase):
3901.     def test_ticket_24278(self):
3902.         School.objects.create()
3903.         qs = School.objects.filter(Q(pk__in=()) | Q())
3904.         self.assertQuerysetEqual(qs, [])
3905. 
3906. 
3907. class TestInvalidValuesRelation(SimpleTestCase):
3908.     def test_invalid_values(self):
3909.         msg = "Field 'id' expected a number but got 'abc'."
3910.         with self.assertRaisesMessage(ValueError, msg):
3911.             Annotation.objects.filter(tag='abc')
3912.         with self.assertRaisesMessage(ValueError, msg):
3913.             Annotation.objects.filter(tag__in=[123, 'abc'])
3914. 
3915. 
3916. class TestTicket24605(TestCase):
3917.     def test_ticket_24605(self):
3918.         """
3919.         Subquery table names should be quoted.
3920.         """
3921.         i1 = Individual.objects.create(alive=True)
3922.         RelatedIndividual.objects.create(related=i1)
3923.         i2 = Individual.objects.create(alive=False)
3924.         RelatedIndividual.objects.create(related=i2)
3925.         i3 = Individual.objects.create(alive=True)
3926.         i4 = Individual.objects.create(alive=False)
3927. 
3928.         self.assertSequenceEqual(Individual.objects.filter(Q(alive=False), Q(related_individual__isnull=True)), [i4])
3929.         self.assertSequenceEqual(
3930.             Individual.objects.exclude(Q(alive=False), Q(related_individual__isnull=True)).order_by('pk'),
3931.             [i1, i2, i3]
3932.         )
3933. 
3934. 
3935. class Ticket23622Tests(TestCase):
3936.     @skipUnlessDBFeature('can_distinct_on_fields')
3937.     def test_ticket_23622(self):
3938.         """
3939.         Make sure __pk__in and __in work the same for related fields when
3940.         using a distinct on subquery.
3941.         """
3942.         a1 = Ticket23605A.objects.create()
3943.         a2 = Ticket23605A.objects.create()
3944.         c1 = Ticket23605C.objects.create(field_c0=0.0)
3945.         Ticket23605B.objects.create(
3946.             modela_fk=a1, field_b0=123,
3947.             field_b1=True,
3948.             modelc_fk=c1,
3949.         )
3950.         Ticket23605B.objects.create(
3951.             modela_fk=a1, field_b0=23,
3952.             field_b1=True,
3953.             modelc_fk=c1,
3954.         )
3955.         Ticket23605B.objects.create(
3956.             modela_fk=a1, field_b0=234,
3957.             field_b1=True,
3958.             modelc_fk=c1,
3959.         )
3960.         Ticket23605B.objects.create(
3961.             modela_fk=a1, field_b0=12,
3962.             field_b1=True,
3963.             modelc_fk=c1,
3964.         )
3965.         Ticket23605B.objects.create(
3966.             modela_fk=a2, field_b0=567,
3967.             field_b1=True,
3968.             modelc_fk=c1,
3969.         )
3970.         Ticket23605B.objects.create(
3971.             modela_fk=a2, field_b0=76,
3972.             field_b1=True,
3973.             modelc_fk=c1,
3974.         )
3975.         Ticket23605B.objects.create(
3976.             modela_fk=a2, field_b0=7,
3977.             field_b1=True,
3978.             modelc_fk=c1,
3979.         )
3980.         Ticket23605B.objects.create(
3981.             modela_fk=a2, field_b0=56,
3982.             field_b1=True,
3983.             modelc_fk=c1,
3984.         )
3985.         qx = (
3986.             Q(ticket23605b__pk__in=Ticket23605B.objects.order_by('modela_fk', '-field_b1').distinct('modela_fk')) &
3987.             Q(ticket23605b__field_b0__gte=300)
3988.         )
3989.         qy = (
3990.             Q(ticket23605b__in=Ticket23605B.objects.order_by('modela_fk', '-field_b1').distinct('modela_fk')) &
3991.             Q(ticket23605b__field_b0__gte=300)
3992.         )
3993.         self.assertEqual(
3994.             set(Ticket23605A.objects.filter(qx).values_list('pk', flat=True)),
3995.             set(Ticket23605A.objects.filter(qy).values_list('pk', flat=True))
3996.         )
3997.         self.assertSequenceEqual(Ticket23605A.objects.filter(qx), [a2])

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 09:01:18,562 - thread-128424504956608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user wants to find test cases related to `QuerySet.none()` on combined queries.\n2. The provided patch modifies `Query.set_empty()` to clear combinator attributes, which is used by `QuerySet.none()`.\n3. This points to an issue with how `none()` interacts with querysets created using `union()`, `intersection()`, or `difference()`.\n4. The file `tests/queries/test_qs_combinators.py` specifically tests these queryset combination methods.\n5. Within this file, the tests `test_union_with_empty_qs`, `test_intersection_with_empty_qs`, and `test_difference_with_empty_qs` are the most relevant as they test the interaction between combinators and empty querysets created with `QuerySet.none()`.\n6. Although these tests don't cover the exact `combined_qs.none()` scenario, they are the most similar existing tests, demonstrating the behavior of combinators with empty sets.\n7. All necessary code, including the test file and the referenced models, is present in the current context. Therefore, I have sufficient information and do not need to request additional context." query='' extra_requirements='' purpose=''
2025-12-23 09:01:18,563 - thread-128424504956608.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
