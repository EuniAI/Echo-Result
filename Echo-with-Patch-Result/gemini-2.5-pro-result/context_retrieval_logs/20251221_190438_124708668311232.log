2025-12-21 19:04:38,443 - thread-124708668311232.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

2025-12-21 19:04:38,589 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   └── yacc.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:04:59,019 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to understand a fix for the `InheritDocstrings` metaclass in `astropy/utils/misc.py`. The provided patch shows the change but not the original implementation or surrounding code. To fully grasp the issue and the solution, I need to examine the complete source code of the `InheritDocstrings` metaclass within its module.' query='Please provide the full content of the file `astropy/utils/misc.py`.' extra_requirements='' purpose='This will allow me to see the original implementation of the `InheritDocstrings` metaclass and understand how the patch addresses the issue of inheriting docstrings for properties.'
2025-12-21 19:04:59,020 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/utils/misc.py`.
2025-12-21 19:04:59,020 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:04:59,021 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:04:59,022 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:04:59,022 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/utils/misc.py`.
Purpose: This will allow me to see the original implementation of the `InheritDocstrings` metaclass and understand how the patch addresses the issue of inheriting docstrings for properties.
2025-12-21 19:05:01,548 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the `astropy/utils/misc.py` file. This will allow you to examine the original implementation of the `InheritDocstrings` metaclass and understand how the patch addresses the issue of inheriting docstrings for properties.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/utils/misc.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2145, 'candidates_token_count': 76, 'total_token_count': 2405, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2145}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 184, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12573840743617007, 'model_name': 'gemini-2.5-pro'} id='run--1903a3cb-6157-4f48-b7c7-1e8b5dbe3c6c-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/utils/misc.py'}, 'id': 'ca3f5546-1220-46ab-a8ae-dd0411b78f51', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2145, 'output_tokens': 76, 'total_tokens': 2405, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 184}}
2025-12-21 19:05:03,921 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the first 500 lines of `astropy/utils/misc.py` as initially requested. Since this is only a partial view of the file, I will now fetch the remaining content to provide you with the complete implementation details.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/utils/misc.py", "start_line": 501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8645, 'candidates_token_count': 76, 'total_token_count': 8758, 'cached_content_token_count': 1818, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8645}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1818}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 37}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13196244992707906, 'model_name': 'gemini-2.5-pro'} id='run--c742c58e-d9ff-4fa3-9bfa-6d8fb0dd33a8-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/utils/misc.py', 'start_line': 501.0}, 'id': '20104f1f-277a-4ab3-87b5-574f74227a21', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8645, 'output_tokens': 76, 'total_tokens': 8758, 'input_token_details': {'cache_read': 1818}, 'output_token_details': {'reasoning': 37}}
2025-12-21 19:05:07,790 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the first 500 lines of `astropy/utils/misc.py` and encountered an error when attempting to fetch the remainder of the file. I will now correct my approach and retrieve the rest of the file's content for you." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/utils/misc.py", "start_line": 501.0, "end_line": 1000.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8767, 'candidates_token_count': 82, 'total_token_count': 9118, 'cached_content_token_count': 7255, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8767}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7255}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 269}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3415651088807641, 'model_name': 'gemini-2.5-pro'} id='run--d7a3f6aa-0e2a-47cd-86f0-fb8f4eeb709c-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/utils/misc.py', 'start_line': 501.0, 'end_line': 1000.0}, 'id': 'dcdc296d-5e69-4154-85fc-9cc6775f4a8e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8767, 'output_tokens': 82, 'total_tokens': 9118, 'input_token_details': {'cache_read': 7255}, 'output_token_details': {'reasoning': 269}}
2025-12-21 19:05:32,017 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now retrieved the entire content of `astropy/utils/misc.py`. The full code is available for your review, which should facilitate a comprehensive understanding of the `InheritDocstrings` metaclass and its interaction with property docstrings.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/utils/misc.py", "start_line": 1001.0, "end_line": 1500.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16201, 'candidates_token_count': 79, 'total_token_count': 17336, 'cached_content_token_count': 7547, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16201}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7547}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 79}], 'thoughts_token_count': 1056}, 'finish_reason': 'STOP', 'avg_logprobs': -2.804027895384197, 'model_name': 'gemini-2.5-pro'} id='run--0bd352ef-8ba3-474c-a1e2-b7f36bce1756-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/utils/misc.py', 'start_line': 1001.0, 'end_line': 1500.0}, 'id': 'd6aa4b05-47e2-4a2d-9aae-114385259140', 'type': 'tool_call'}] usage_metadata={'input_tokens': 16201, 'output_tokens': 79, 'total_tokens': 17336, 'input_token_details': {'cache_read': 7547}, 'output_token_details': {'reasoning': 1056}}
2025-12-21 19:05:41,956 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the `astropy/utils/misc.py` file in three parts. You can now examine the complete implementation of the `InheritDocstrings` metaclass. This will provide the necessary context to understand how a patch might address the issue of inheriting docstrings for properties.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 533, 'end_index': 1041, 'uri': 'http://gala.adrian.pw/en/v1.2/_modules/astropy/utils/misc.html', 'title': '', 'license_': ''}, {'start_index': 1058, 'end_index': 1724, 'uri': 'http://gala.adrian.pw/en/v1.2/_modules/astropy/utils/misc.html', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 18184, 'candidates_token_count': 64, 'total_token_count': 19285, 'cached_content_token_count': 15144, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18184}], 'cache_tokens_details': [{'modality': 1, 'token_count': 15144}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 1037}, 'finish_reason': 'STOP', 'avg_logprobs': -1.8028719425201416, 'model_name': 'gemini-2.5-pro'} id='run--5dc668d9-aac6-4a14-96f4-7d4049598351-0' usage_metadata={'input_tokens': 18184, 'output_tokens': 64, 'total_tokens': 19285, 'input_token_details': {'cache_read': 15144}, 'output_token_details': {'reasoning': 1037}}
2025-12-21 19:05:41,959 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/utils/misc.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This will allow me to see the original implementation of the `InheritDocstrings` metaclass and understand how the patch addresses the issue of inheriting docstrings for properties.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/utils/misc.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. """
4. A "grab bag" of relatively small general-purpose utilities that don't have
5. a clear module/package to live in.
6. """
7. 
8. 
9. 
10. import abc
11. import contextlib
12. import difflib
13. import inspect
14. import json
15. import os
16. import signal
17. import sys
18. import traceback
19. import unicodedata
20. import locale
21. import threading
22. import re
23. import urllib.request
24. 
25. from itertools import zip_longest
26. from contextlib import contextmanager
27. from collections import defaultdict, OrderedDict
28. 
29. 
30. 
31. __all__ = ['isiterable', 'silence', 'format_exception', 'NumpyRNGContext',
32.            'find_api_page', 'is_path_hidden', 'walk_skip_hidden',
33.            'JsonCustomEncoder', 'indent', 'InheritDocstrings',
34.            'OrderedDescriptor', 'OrderedDescriptorContainer', 'set_locale',
35.            'ShapedLikeNDArray', 'check_broadcast', 'IncompatibleShapeError',
36.            'dtype_bytes_or_chars']
37. 
38. 
39. def isiterable(obj):
40.     """Returns `True` if the given object is iterable."""
41. 
42.     try:
43.         iter(obj)
44.         return True
45.     except TypeError:
46.         return False
47. 
48. 
49. def indent(s, shift=1, width=4):
50.     """Indent a block of text.  The indentation is applied to each line."""
51. 
52.     indented = '\n'.join(' ' * (width * shift) + l if l else ''
53.                          for l in s.splitlines())
54.     if s[-1] == '\n':
55.         indented += '\n'
56. 
57.     return indented
58. 
59. 
60. class _DummyFile:
61.     """A noop writeable object."""
62. 
63.     def write(self, s):
64.         pass
65. 
66. 
67. @contextlib.contextmanager
68. def silence():
69.     """A context manager that silences sys.stdout and sys.stderr."""
70. 
71.     old_stdout = sys.stdout
72.     old_stderr = sys.stderr
73.     sys.stdout = _DummyFile()
74.     sys.stderr = _DummyFile()
75.     yield
76.     sys.stdout = old_stdout
77.     sys.stderr = old_stderr
78. 
79. 
80. def format_exception(msg, *args, **kwargs):
81.     """
82.     Given an exception message string, uses new-style formatting arguments
83.     ``{filename}``, ``{lineno}``, ``{func}`` and/or ``{text}`` to fill in
84.     information about the exception that occurred.  For example:
85. 
86.         try:
87.             1/0
88.         except:
89.             raise ZeroDivisionError(
90.                 format_except('A divide by zero occurred in {filename} at '
91.                               'line {lineno} of function {func}.'))
92. 
93.     Any additional positional or keyword arguments passed to this function are
94.     also used to format the message.
95. 
96.     .. note::
97.         This uses `sys.exc_info` to gather up the information needed to fill
98.         in the formatting arguments. Since `sys.exc_info` is not carried
99.         outside a handled exception, it's not wise to use this
100.         outside of an ``except`` clause - if it is, this will substitute
101.         '<unkown>' for the 4 formatting arguments.
102.     """
103. 
104.     tb = traceback.extract_tb(sys.exc_info()[2], limit=1)
105.     if len(tb) > 0:
106.         filename, lineno, func, text = tb[0]
107.     else:
108.         filename = lineno = func = text = '<unknown>'
109. 
110.     return msg.format(*args, filename=filename, lineno=lineno, func=func,
111.                       text=text, **kwargs)
112. 
113. 
114. class NumpyRNGContext:
115.     """
116.     A context manager (for use with the ``with`` statement) that will seed the
117.     numpy random number generator (RNG) to a specific value, and then restore
118.     the RNG state back to whatever it was before.
119. 
120.     This is primarily intended for use in the astropy testing suit, but it
121.     may be useful in ensuring reproducibility of Monte Carlo simulations in a
122.     science context.
123. 
124.     Parameters
125.     ----------
126.     seed : int
127.         The value to use to seed the numpy RNG
128. 
129.     Examples
130.     --------
131.     A typical use case might be::
132. 
133.         with NumpyRNGContext(<some seed value you pick>):
134.             from numpy import random
135. 
136.             randarr = random.randn(100)
137.             ... run your test using `randarr` ...
138. 
139.         #Any code using numpy.random at this indent level will act just as it
140.         #would have if it had been before the with statement - e.g. whatever
141.         #the default seed is.
142. 
143. 
144.     """
145. 
146.     def __init__(self, seed):
147.         self.seed = seed
148. 
149.     def __enter__(self):
150.         from numpy import random
151. 
152.         self.startstate = random.get_state()
153.         random.seed(self.seed)
154. 
155.     def __exit__(self, exc_type, exc_value, traceback):
156.         from numpy import random
157. 
158.         random.set_state(self.startstate)
159. 
160. 
161. def find_api_page(obj, version=None, openinbrowser=True, timeout=None):
162.     """
163.     Determines the URL of the API page for the specified object, and
164.     optionally open that page in a web browser.
165. 
166.     .. note::
167.         You must be connected to the internet for this to function even if
168.         ``openinbrowser`` is `False`, unless you provide a local version of
169.         the documentation to ``version`` (e.g., ``file:///path/to/docs``).
170. 
171.     Parameters
172.     ----------
173.     obj
174.         The object to open the docs for or its fully-qualified name
175.         (as a str).
176.     version : str
177.         The doc version - either a version number like '0.1', 'dev' for
178.         the development/latest docs, or a URL to point to a specific
179.         location that should be the *base* of the documentation. Defaults to
180.         latest if you are on aren't on a release, otherwise, the version you
181.         are on.
182.     openinbrowser : bool
183.         If `True`, the `webbrowser` package will be used to open the doc
184.         page in a new web browser window.
185.     timeout : number, optional
186.         The number of seconds to wait before timing-out the query to
187.         the astropy documentation.  If not given, the default python
188.         stdlib timeout will be used.
189. 
190.     Returns
191.     -------
192.     url : str
193.         The loaded URL
194. 
195.     Raises
196.     ------
197.     ValueError
198.         If the documentation can't be found
199. 
200.     """
201.     import webbrowser
202. 
203.     from zlib import decompress
204. 
205.     if (not isinstance(obj, str) and
206.             hasattr(obj, '__module__') and
207.             hasattr(obj, '__name__')):
208.         obj = obj.__module__ + '.' + obj.__name__
209.     elif inspect.ismodule(obj):
210.         obj = obj.__name__
211. 
212.     if version is None:
213.         from .. import version
214. 
215.         if version.release:
216.             version = 'v' + version.version
217.         else:
218.             version = 'dev'
219. 
220.     if '://' in version:
221.         if version.endswith('index.html'):
222.             baseurl = version[:-10]
223.         elif version.endswith('/'):
224.             baseurl = version
225.         else:
226.             baseurl = version + '/'
227.     elif version == 'dev' or version == 'latest':
228.         baseurl = 'http://devdocs.astropy.org/'
229.     else:
230.         baseurl = 'http://docs.astropy.org/en/{vers}/'.format(vers=version)
231. 
232.     if timeout is None:
233.         uf = urllib.request.urlopen(baseurl + 'objects.inv')
234.     else:
235.         uf = urllib.request.urlopen(baseurl + 'objects.inv', timeout=timeout)
236. 
237.     try:
238.         oiread = uf.read()
239. 
240.         # need to first read/remove the first four lines, which have info before
241.         # the compressed section with the actual object inventory
242.         idx = -1
243.         headerlines = []
244.         for _ in range(4):
245.             oldidx = idx
246.             idx = oiread.index(b'\n', oldidx + 1)
247.             headerlines.append(oiread[(oldidx+1):idx].decode('utf-8'))
248. 
249.         # intersphinx version line, project name, and project version
250.         ivers, proj, vers, compr = headerlines
251.         if 'The remainder of this file is compressed using zlib' not in compr:
252.             raise ValueError('The file downloaded from {0} does not seem to be'
253.                              'the usual Sphinx objects.inv format.  Maybe it '
254.                              'has changed?'.format(baseurl + 'objects.inv'))
255. 
256.         compressed = oiread[(idx+1):]
257.     finally:
258.         uf.close()
259. 
260.     decompressed = decompress(compressed).decode('utf-8')
261. 
262.     resurl = None
263. 
264.     for l in decompressed.strip().splitlines():
265.         ls = l.split()
266.         name = ls[0]
267.         loc = ls[3]
268.         if loc.endswith('$'):
269.             loc = loc[:-1] + name
270. 
271.         if name == obj:
272.             resurl = baseurl + loc
273.             break
274. 
275.     if resurl is None:
276.         raise ValueError('Could not find the docs for the object {obj}'.format(obj=obj))
277.     elif openinbrowser:
278.         webbrowser.open(resurl)
279. 
280.     return resurl
281. 
282. 
283. def signal_number_to_name(signum):
284.     """
285.     Given an OS signal number, returns a signal name.  If the signal
286.     number is unknown, returns ``'UNKNOWN'``.
287.     """
288.     # Since these numbers and names are platform specific, we use the
289.     # builtin signal module and build a reverse mapping.
290. 
291.     signal_to_name_map = dict((k, v) for v, k in signal.__dict__.items()
292.                               if v.startswith('SIG'))
293. 
294.     return signal_to_name_map.get(signum, 'UNKNOWN')
295. 
296. 
297. if sys.platform == 'win32':
298.     import ctypes
299. 
300.     def _has_hidden_attribute(filepath):
301.         """
302.         Returns True if the given filepath has the hidden attribute on
303.         MS-Windows.  Based on a post here:
304.         http://stackoverflow.com/questions/284115/cross-platform-hidden-file-detection
305.         """
306.         if isinstance(filepath, bytes):
307.             filepath = filepath.decode(sys.getfilesystemencoding())
308.         try:
309.             attrs = ctypes.windll.kernel32.GetFileAttributesW(filepath)
310.             result = bool(attrs & 2) and attrs != -1
311.         except AttributeError:
312.             result = False
313.         return result
314. else:
315.     def _has_hidden_attribute(filepath):
316.         return False
317. 
318. 
319. def is_path_hidden(filepath):
320.     """
321.     Determines if a given file or directory is hidden.
322. 
323.     Parameters
324.     ----------
325.     filepath : str
326.         The path to a file or directory
327. 
328.     Returns
329.     -------
330.     hidden : bool
331.         Returns `True` if the file is hidden
332.     """
333.     name = os.path.basename(os.path.abspath(filepath))
334.     if isinstance(name, bytes):
335.         is_dotted = name.startswith(b'.')
336.     else:
337.         is_dotted = name.startswith('.')
338.     return is_dotted or _has_hidden_attribute(filepath)
339. 
340. 
341. def walk_skip_hidden(top, onerror=None, followlinks=False):
342.     """
343.     A wrapper for `os.walk` that skips hidden files and directories.
344. 
345.     This function does not have the parameter ``topdown`` from
346.     `os.walk`: the directories must always be recursed top-down when
347.     using this function.
348. 
349.     See also
350.     --------
351.     os.walk : For a description of the parameters
352.     """
353.     for root, dirs, files in os.walk(
354.             top, topdown=True, onerror=onerror,
355.             followlinks=followlinks):
356.         # These lists must be updated in-place so os.walk will skip
357.         # hidden directories
358.         dirs[:] = [d for d in dirs if not is_path_hidden(d)]
359.         files[:] = [f for f in files if not is_path_hidden(f)]
360.         yield root, dirs, files
361. 
362. 
363. class JsonCustomEncoder(json.JSONEncoder):
364.     """Support for data types that JSON default encoder
365.     does not do.
366. 
367.     This includes:
368. 
369.         * Numpy array or number
370.         * Complex number
371.         * Set
372.         * Bytes
373.         * astropy.UnitBase
374.         * astropy.Quantity
375. 
376.     Examples
377.     --------
378.     >>> import json
379.     >>> import numpy as np
380.     >>> from astropy.utils.misc import JsonCustomEncoder
381.     >>> json.dumps(np.arange(3), cls=JsonCustomEncoder)
382.     '[0, 1, 2]'
383. 
384.     """
385. 
386.     def default(self, obj):
387.         from .. import units as u
388.         import numpy as np
389.         if isinstance(obj, u.Quantity):
390.             return dict(value=obj.value, unit=obj.unit.to_string())
391.         if isinstance(obj, (np.number, np.ndarray)):
392.             return obj.tolist()
393.         elif isinstance(obj, complex):
394.             return [obj.real, obj.imag]
395.         elif isinstance(obj, set):
396.             return list(obj)
397.         elif isinstance(obj, bytes):  # pragma: py3
398.             return obj.decode()
399.         elif isinstance(obj, (u.UnitBase, u.FunctionUnitBase)):
400.             if obj == u.dimensionless_unscaled:
401.                 obj = 'dimensionless_unit'
402.             else:
403.                 return obj.to_string()
404. 
405.         return json.JSONEncoder.default(self, obj)
406. 
407. 
408. def strip_accents(s):
409.     """
410.     Remove accents from a Unicode string.
411. 
412.     This helps with matching "ångström" to "angstrom", for example.
413.     """
414.     return ''.join(
415.         c for c in unicodedata.normalize('NFD', s)
416.         if unicodedata.category(c) != 'Mn')
417. 
418. 
419. def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
420.     """
421.     When a string isn't found in a set of candidates, we can be nice
422.     to provide a list of alternatives in the exception.  This
423.     convenience function helps to format that part of the exception.
424. 
425.     Parameters
426.     ----------
427.     s : str
428. 
429.     candidates : sequence of str or dict of str keys
430. 
431.     n : int
432.         The maximum number of results to include.  See
433.         `difflib.get_close_matches`.
434. 
435.     cutoff : float
436.         In the range [0, 1]. Possibilities that don't score at least
437.         that similar to word are ignored.  See
438.         `difflib.get_close_matches`.
439. 
440.     fix : callable
441.         A callable to modify the results after matching.  It should
442.         take a single string and return a sequence of strings
443.         containing the fixed matches.
444. 
445.     Returns
446.     -------
447.     message : str
448.         Returns the string "Did you mean X, Y, or Z?", or the empty
449.         string if no alternatives were found.
450.     """
451.     if isinstance(s, str):
452.         s = strip_accents(s)
453.     s_lower = s.lower()
454. 
455.     # Create a mapping from the lower case name to all capitalization
456.     # variants of that name.
457.     candidates_lower = {}
458.     for candidate in candidates:
459.         candidate_lower = candidate.lower()
460.         candidates_lower.setdefault(candidate_lower, [])
461.         candidates_lower[candidate_lower].append(candidate)
462. 
463.     # The heuristic here is to first try "singularizing" the word.  If
464.     # that doesn't match anything use difflib to find close matches in
465.     # original, lower and upper case.
466.     if s_lower.endswith('s') and s_lower[:-1] in candidates_lower:
467.         matches = [s_lower[:-1]]
468.     else:
469.         matches = difflib.get_close_matches(
470.             s_lower, candidates_lower, n=n, cutoff=cutoff)
471. 
472.     if len(matches):
473.         capitalized_matches = set()
474.         for match in matches:
475.             capitalized_matches.update(candidates_lower[match])
476.         matches = capitalized_matches
477. 
478.         if fix is not None:
479.             mapped_matches = []
480.             for match in matches:
481.                 mapped_matches.extend(fix(match))
482.             matches = mapped_matches
483. 
484.         matches = list(set(matches))
485.         matches = sorted(matches)
486. 
487.         if len(matches) == 1:
488.             matches = matches[0]
489.         else:
490.             matches = (', '.join(matches[:-1]) + ' or ' +
491.                        matches[-1])
492.         return 'Did you mean {0}?'.format(matches)
493. 
494.     return ''
495. 
496. 
497. class InheritDocstrings(type):
498.     """
499.     This metaclass makes methods of a class automatically have their
500.     docstrings filled in from the methods they override in the base


File: astropy/utils/misc.py
Line number range: 501 - 1000
Content:
501.     class.
502. 
503.     If the class uses multiple inheritance, the docstring will be
504.     chosen from the first class in the bases list, in the same way as
505.     methods are normally resolved in Python.  If this results in
506.     selecting the wrong docstring, the docstring will need to be
507.     explicitly included on the method.
508. 
509.     For example::
510. 
511.         >>> from astropy.utils.misc import InheritDocstrings
512.         >>> class A(metaclass=InheritDocstrings):
513.         ...     def wiggle(self):
514.         ...         "Wiggle the thingamajig"
515.         ...         pass
516.         >>> class B(A):
517.         ...     def wiggle(self):
518.         ...         pass
519.         >>> B.wiggle.__doc__
520.         u'Wiggle the thingamajig'
521.     """
522. 
523.     def __init__(cls, name, bases, dct):
524.         def is_public_member(key):
525.             return (
526.                 (key.startswith('__') and key.endswith('__')
527.                  and len(key) > 4) or
528.                 not key.startswith('_'))
529. 
530.         for key, val in dct.items():
531.             if (inspect.isfunction(val) and
532.                 is_public_member(key) and
533.                 val.__doc__ is None):
534.                 for base in cls.__mro__[1:]:
535.                     super_method = getattr(base, key, None)
536.                     if super_method is not None:
537.                         val.__doc__ = super_method.__doc__
538.                         break
539. 
540.         super().__init__(name, bases, dct)
541. 
542. 
543. class OrderedDescriptor(metaclass=abc.ABCMeta):
544.     """
545.     Base class for descriptors whose order in the class body should be
546.     preserved.  Intended for use in concert with the
547.     `OrderedDescriptorContainer` metaclass.
548. 
549.     Subclasses of `OrderedDescriptor` must define a value for a class attribute
550.     called ``_class_attribute_``.  This is the name of a class attribute on the
551.     *container* class for these descriptors, which will be set to an
552.     `~collections.OrderedDict` at class creation time.  This
553.     `~collections.OrderedDict` will contain a mapping of all class attributes
554.     that were assigned instances of the `OrderedDescriptor` subclass, to the
555.     instances themselves.  See the documentation for
556.     `OrderedDescriptorContainer` for a concrete example.
557. 
558.     Optionally, subclasses of `OrderedDescriptor` may define a value for a
559.     class attribute called ``_name_attribute_``.  This should be the name of
560.     an attribute on instances of the subclass.  When specified, during
561.     creation of a class containing these descriptors, the name attribute on
562.     each instance will be set to the name of the class attribute it was
563.     assigned to on the class.
564. 
565.     .. note::
566. 
567.         Although this class is intended for use with *descriptors* (i.e.
568.         classes that define any of the ``__get__``, ``__set__``, or
569.         ``__delete__`` magic methods), this base class is not itself a
570.         descriptor, and technically this could be used for classes that are
571.         not descriptors too.  However, use with descriptors is the original
572.         intended purpose.
573.     """
574. 
575.     # This id increments for each OrderedDescriptor instance created, so they
576.     # are always ordered in the order they were created.  Class bodies are
577.     # guaranteed to be executed from top to bottom.  Not sure if this is
578.     # thread-safe though.
579.     _nextid = 1
580. 
581.     @property
582.     @abc.abstractmethod
583.     def _class_attribute_(self):
584.         """
585.         Subclasses should define this attribute to the name of an attribute on
586.         classes containing this subclass.  That attribute will contain the mapping
587.         of all instances of that `OrderedDescriptor` subclass defined in the class
588.         body.  If the same descriptor needs to be used with different classes,
589.         each with different names of this attribute, multiple subclasses will be
590.         needed.
591.         """
592. 
593.     _name_attribute_ = None
594.     """
595.     Subclasses may optionally define this attribute to specify the name of an
596.     attribute on instances of the class that should be filled with the
597.     instance's attribute name at class creation time.
598.     """
599. 
600.     def __init__(self, *args, **kwargs):
601.         # The _nextid attribute is shared across all subclasses so that
602.         # different subclasses of OrderedDescriptors can be sorted correctly
603.         # between themselves
604.         self.__order = OrderedDescriptor._nextid
605.         OrderedDescriptor._nextid += 1
606.         super().__init__()
607. 
608.     def __lt__(self, other):
609.         """
610.         Defined for convenient sorting of `OrderedDescriptor` instances, which
611.         are defined to sort in their creation order.
612.         """
613. 
614.         if (isinstance(self, OrderedDescriptor) and
615.                 isinstance(other, OrderedDescriptor)):
616.             try:
617.                 return self.__order < other.__order
618.             except AttributeError:
619.                 raise RuntimeError(
620.                     'Could not determine ordering for {0} and {1}; at least '
621.                     'one of them is not calling super().__init__ in its '
622.                     '__init__.'.format(self, other))
623.         else:
624.             return NotImplemented
625. 
626. 
627. class OrderedDescriptorContainer(type):
628.     """
629.     Classes should use this metaclass if they wish to use `OrderedDescriptor`
630.     attributes, which are class attributes that "remember" the order in which
631.     they were defined in the class body.
632. 
633.     Every subclass of `OrderedDescriptor` has an attribute called
634.     ``_class_attribute_``.  For example, if we have
635. 
636.     .. code:: python
637. 
638.         class ExampleDecorator(OrderedDescriptor):
639.             _class_attribute_ = '_examples_'
640. 
641.     Then when a class with the `OrderedDescriptorContainer` metaclass is
642.     created, it will automatically be assigned a class attribute ``_examples_``
643.     referencing an `~collections.OrderedDict` containing all instances of
644.     ``ExampleDecorator`` defined in the class body, mapped to by the names of
645.     the attributes they were assigned to.
646. 
647.     When subclassing a class with this metaclass, the descriptor dict (i.e.
648.     ``_examples_`` in the above example) will *not* contain descriptors
649.     inherited from the base class.  That is, this only works by default with
650.     decorators explicitly defined in the class body.  However, the subclass
651.     *may* define an attribute ``_inherit_decorators_`` which lists
652.     `OrderedDescriptor` classes that *should* be added from base classes.
653.     See the examples section below for an example of this.
654. 
655.     Examples
656.     --------
657. 
658.     >>> from astropy.utils import OrderedDescriptor, OrderedDescriptorContainer
659.     >>> class TypedAttribute(OrderedDescriptor):
660.     ...     \"\"\"
661.     ...     Attributes that may only be assigned objects of a specific type,
662.     ...     or subclasses thereof.  For some reason we care about their order.
663.     ...     \"\"\"
664.     ...
665.     ...     _class_attribute_ = 'typed_attributes'
666.     ...     _name_attribute_ = 'name'
667.     ...     # A default name so that instances not attached to a class can
668.     ...     # still be repr'd; useful for debugging
669.     ...     name = '<unbound>'
670.     ...
671.     ...     def __init__(self, type):
672.     ...         # Make sure not to forget to call the super __init__
673.     ...         super().__init__()
674.     ...         self.type = type
675.     ...
676.     ...     def __get__(self, obj, objtype=None):
677.     ...         if obj is None:
678.     ...             return self
679.     ...         if self.name in obj.__dict__:
680.     ...             return obj.__dict__[self.name]
681.     ...         else:
682.     ...             raise AttributeError(self.name)
683.     ...
684.     ...     def __set__(self, obj, value):
685.     ...         if not isinstance(value, self.type):
686.     ...             raise ValueError('{0}.{1} must be of type {2!r}'.format(
687.     ...                 obj.__class__.__name__, self.name, self.type))
688.     ...         obj.__dict__[self.name] = value
689.     ...
690.     ...     def __delete__(self, obj):
691.     ...         if self.name in obj.__dict__:
692.     ...             del obj.__dict__[self.name]
693.     ...         else:
694.     ...             raise AttributeError(self.name)
695.     ...
696.     ...     def __repr__(self):
697.     ...         if isinstance(self.type, tuple) and len(self.type) > 1:
698.     ...             typestr = '({0})'.format(
699.     ...                 ', '.join(t.__name__ for t in self.type))
700.     ...         else:
701.     ...             typestr = self.type.__name__
702.     ...         return '<{0}(name={1}, type={2})>'.format(
703.     ...                 self.__class__.__name__, self.name, typestr)
704.     ...
705. 
706.     Now let's create an example class that uses this ``TypedAttribute``::
707. 
708.         >>> class Point2D(metaclass=OrderedDescriptorContainer):
709.         ...     x = TypedAttribute((float, int))
710.         ...     y = TypedAttribute((float, int))
711.         ...
712.         ...     def __init__(self, x, y):
713.         ...         self.x, self.y = x, y
714.         ...
715.         >>> p1 = Point2D(1.0, 2.0)
716.         >>> p1.x
717.         1.0
718.         >>> p1.y
719.         2.0
720.         >>> p2 = Point2D('a', 'b')  # doctest: +IGNORE_EXCEPTION_DETAIL
721.         Traceback (most recent call last):
722.             ...
723.         ValueError: Point2D.x must be of type (float, int>)
724. 
725.     We see that ``TypedAttribute`` works more or less as advertised, but
726.     there's nothing special about that.  Let's see what
727.     `OrderedDescriptorContainer` did for us::
728. 
729.         >>> Point2D.typed_attributes
730.         OrderedDict([('x', <TypedAttribute(name=x, type=(float, int))>),
731.         ('y', <TypedAttribute(name=y, type=(float, int))>)])
732. 
733.     If we create a subclass, it does *not* by default add inherited descriptors
734.     to ``typed_attributes``::
735. 
736.         >>> class Point3D(Point2D):
737.         ...     z = TypedAttribute((float, int))
738.         ...
739.         >>> Point3D.typed_attributes
740.         OrderedDict([('z', <TypedAttribute(name=z, type=(float, int))>)])
741. 
742.     However, if we specify ``_inherit_descriptors_`` from ``Point2D`` then
743.     it will do so::
744. 
745.         >>> class Point3D(Point2D):
746.         ...     _inherit_descriptors_ = (TypedAttribute,)
747.         ...     z = TypedAttribute((float, int))
748.         ...
749.         >>> Point3D.typed_attributes
750.         OrderedDict([('x', <TypedAttribute(name=x, type=(float, int))>),
751.         ('y', <TypedAttribute(name=y, type=(float, int))>),
752.         ('z', <TypedAttribute(name=z, type=(float, int))>)])
753. 
754.     .. note::
755. 
756.         Hopefully it is clear from these examples that this construction
757.         also allows a class of type `OrderedDescriptorContainer` to use
758.         multiple different `OrderedDescriptor` classes simultaneously.
759.     """
760. 
761.     _inherit_descriptors_ = ()
762. 
763.     def __init__(cls, cls_name, bases, members):
764.         descriptors = defaultdict(list)
765.         seen = set()
766.         inherit_descriptors = ()
767.         descr_bases = {}
768. 
769.         for mro_cls in cls.__mro__:
770.             for name, obj in mro_cls.__dict__.items():
771.                 if name in seen:
772.                     # Checks if we've already seen an attribute of the given
773.                     # name (if so it will override anything of the same name in
774.                     # any base class)
775.                     continue
776. 
777.                 seen.add(name)
778. 
779.                 if (not isinstance(obj, OrderedDescriptor) or
780.                         (inherit_descriptors and
781.                             not isinstance(obj, inherit_descriptors))):
782.                     # The second condition applies when checking any
783.                     # subclasses, to see if we can inherit any descriptors of
784.                     # the given type from subclasses (by default inheritance is
785.                     # disabled unless the class has _inherit_descriptors_
786.                     # defined)
787.                     continue
788. 
789.                 if obj._name_attribute_ is not None:
790.                     setattr(obj, obj._name_attribute_, name)
791. 
792.                 # Don't just use the descriptor's class directly; instead go
793.                 # through its MRO and find the class on which _class_attribute_
794.                 # is defined directly.  This way subclasses of some
795.                 # OrderedDescriptor *may* override _class_attribute_ and have
796.                 # its own _class_attribute_, but by default all subclasses of
797.                 # some OrderedDescriptor are still grouped together
798.                 # TODO: It might be worth clarifying this in the docs
799.                 if obj.__class__ not in descr_bases:
800.                     for obj_cls_base in obj.__class__.__mro__:
801.                         if '_class_attribute_' in obj_cls_base.__dict__:
802.                             descr_bases[obj.__class__] = obj_cls_base
803.                             descriptors[obj_cls_base].append((obj, name))
804.                             break
805.                 else:
806.                     # Make sure to put obj first for sorting purposes
807.                     obj_cls_base = descr_bases[obj.__class__]
808.                     descriptors[obj_cls_base].append((obj, name))
809. 
810.             if not getattr(mro_cls, '_inherit_descriptors_', False):
811.                 # If _inherit_descriptors_ is undefined then we don't inherit
812.                 # any OrderedDescriptors from any of the base classes, and
813.                 # there's no reason to continue through the MRO
814.                 break
815.             else:
816.                 inherit_descriptors = mro_cls._inherit_descriptors_
817. 
818.         for descriptor_cls, instances in descriptors.items():
819.             instances.sort()
820.             instances = OrderedDict((key, value) for value, key in instances)
821.             setattr(cls, descriptor_cls._class_attribute_, instances)
822. 
823.         super().__init__(cls_name, bases, members)
824. 
825. 
826. LOCALE_LOCK = threading.Lock()
827. 
828. 
829. @contextmanager
830. def set_locale(name):
831.     """
832.     Context manager to temporarily set the locale to ``name``.
833. 
834.     An example is setting locale to "C" so that the C strtod()
835.     function will use "." as the decimal point to enable consistent
836.     numerical string parsing.
837. 
838.     Note that one cannot nest multiple set_locale() context manager
839.     statements as this causes a threading lock.
840. 
841.     This code taken from https://stackoverflow.com/questions/18593661/how-do-i-strftime-a-date-object-in-a-different-locale.
842. 
843.     Parameters
844.     ==========
845.     name : str
846.         Locale name, e.g. "C" or "fr_FR".
847.     """
848.     name = str(name)
849. 
850.     with LOCALE_LOCK:
851.         saved = locale.setlocale(locale.LC_ALL)
852.         if saved == name:
853.             # Don't do anything if locale is already the requested locale
854.             yield
855.         else:
856.             try:
857.                 locale.setlocale(locale.LC_ALL, name)
858.                 yield
859.             finally:
860.                 locale.setlocale(locale.LC_ALL, saved)
861. 
862. 
863. class ShapedLikeNDArray(metaclass=abc.ABCMeta):
864.     """Mixin class to provide shape-changing methods.
865. 
866.     The class proper is assumed to have some underlying data, which are arrays
867.     or array-like structures. It must define a ``shape`` property, which gives
868.     the shape of those data, as well as an ``_apply`` method that creates a new
869.     instance in which a `~numpy.ndarray` method has been applied to those.
870. 
871.     Furthermore, for consistency with `~numpy.ndarray`, it is recommended to
872.     define a setter for the ``shape`` property, which, like the
873.     `~numpy.ndarray.shape` property allows in-place reshaping the internal data
874.     (and, unlike the ``reshape`` method raises an exception if this is not
875.     possible).
876. 
877.     This class also defines default implementations for ``ndim`` and ``size``
878.     properties, calculating those from the ``shape``.  These can be overridden
879.     by subclasses if there are faster ways to obtain those numbers.
880. 
881.     """
882. 
883.     # Note to developers: if new methods are added here, be sure to check that
884.     # they work properly with the classes that use this, such as Time and
885.     # BaseRepresentation, i.e., look at their ``_apply`` methods and add
886.     # relevant tests.  This is particularly important for methods that imply
887.     # copies rather than views of data (see the special-case treatment of
888.     # 'flatten' in Time).
889. 
890.     @property
891.     @abc.abstractmethod
892.     def shape(self):
893.         """The shape of the instance and underlying arrays."""
894. 
895.     @abc.abstractmethod
896.     def _apply(method, *args, **kwargs):
897.         """Create a new instance, with ``method`` applied to underlying data.
898. 
899.         The method is any of the shape-changing methods for `~numpy.ndarray`
900.         (``reshape``, ``swapaxes``, etc.), as well as those picking particular
901.         elements (``__getitem__``, ``take``, etc.). It will be applied to the
902.         underlying arrays (e.g., ``jd1`` and ``jd2`` in `~astropy.time.Time`),
903.         with the results used to create a new instance.
904. 
905.         Parameters
906.         ----------
907.         method : str
908.             Method to be applied to the instance's internal data arrays.
909.         args : tuple
910.             Any positional arguments for ``method``.
911.         kwargs : dict
912.             Any keyword arguments for ``method``.
913. 
914.         """
915. 
916.     @property
917.     def ndim(self):
918.         """The number of dimensions of the instance and underlying arrays."""
919.         return len(self.shape)
920. 
921.     @property
922.     def size(self):
923.         """The size of the object, as calculated from its shape."""
924.         size = 1
925.         for sh in self.shape:
926.             size *= sh
927.         return size
928. 
929.     @property
930.     def isscalar(self):
931.         return self.shape == ()
932. 
933.     def __len__(self):
934.         if self.isscalar:
935.             raise TypeError("Scalar {0!r} object has no len()"
936.                             .format(self.__class__.__name__))
937.         return self.shape[0]
938. 
939.     def __bool__(self):
940.         """Any instance should evaluate to True, except when it is empty."""
941.         return self.size > 0
942. 
943.     def __getitem__(self, item):
944.         try:
945.             return self._apply('__getitem__', item)
946.         except IndexError:
947.             if self.isscalar:
948.                 raise TypeError('scalar {0!r} object is not subscriptable.'
949.                                 .format(self.__class__.__name__))
950.             else:
951.                 raise
952. 
953.     def __iter__(self):
954.         if self.isscalar:
955.             raise TypeError('scalar {0!r} object is not iterable.'
956.                             .format(self.__class__.__name__))
957. 
958.         # We cannot just write a generator here, since then the above error
959.         # would only be raised once we try to use the iterator, rather than
960.         # upon its definition using iter(self).
961.         def self_iter():
962.             for idx in range(len(self)):
963.                 yield self[idx]
964. 
965.         return self_iter()
966. 
967.     def copy(self, *args, **kwargs):
968.         """Return an instance containing copies of the internal data.
969. 
970.         Parameters are as for :meth:`~numpy.ndarray.copy`.
971.         """
972.         return self._apply('copy', *args, **kwargs)
973. 
974.     def reshape(self, *args, **kwargs):
975.         """Returns an instance containing the same data with a new shape.
976. 
977.         Parameters are as for :meth:`~numpy.ndarray.reshape`.  Note that it is
978.         not always possible to change the shape of an array without copying the
979.         data (see :func:`~numpy.reshape` documentation). If you want an error
980.         to be raise if the data is copied, you should assign the new shape to
981.         the shape attribute (note: this may not be implemented for all classes
982.         using ``ShapedLikeNDArray``).
983.         """
984.         return self._apply('reshape', *args, **kwargs)
985. 
986.     def ravel(self, *args, **kwargs):
987.         """Return an instance with the array collapsed into one dimension.
988. 
989.         Parameters are as for :meth:`~numpy.ndarray.ravel`. Note that it is
990.         not always possible to unravel an array without copying the data.
991.         If you want an error to be raise if the data is copied, you should
992.         should assign shape ``(-1,)`` to the shape attribute.
993.         """
994.         return self._apply('ravel', *args, **kwargs)
995. 
996.     def flatten(self, *args, **kwargs):
997.         """Return a copy with the array collapsed into one dimension.
998. 
999.         Parameters are as for :meth:`~numpy.ndarray.flatten`.
1000.         """


File: astropy/utils/misc.py
Line number range: 1001 - 1500
Content:
1001.         return self._apply('flatten', *args, **kwargs)
1002. 
1003.     def transpose(self, *args, **kwargs):
1004.         """Return an instance with the data transposed.
1005. 
1006.         Parameters are as for :meth:`~numpy.ndarray.transpose`.  All internal
1007.         data are views of the data of the original.
1008.         """
1009.         return self._apply('transpose', *args, **kwargs)
1010. 
1011.     @property
1012.     def T(self):
1013.         """Return an instance with the data transposed.
1014. 
1015.         Parameters are as for :attr:`~numpy.ndarray.T`.  All internal
1016.         data are views of the data of the original.
1017.         """
1018.         if self.ndim < 2:
1019.             return self
1020.         else:
1021.             return self.transpose()
1022. 
1023.     def swapaxes(self, *args, **kwargs):
1024.         """Return an instance with the given axes interchanged.
1025. 
1026.         Parameters are as for :meth:`~numpy.ndarray.swapaxes`:
1027.         ``axis1, axis2``.  All internal data are views of the data of the
1028.         original.
1029.         """
1030.         return self._apply('swapaxes', *args, **kwargs)
1031. 
1032.     def diagonal(self, *args, **kwargs):
1033.         """Return an instance with the specified diagonals.
1034. 
1035.         Parameters are as for :meth:`~numpy.ndarray.diagonal`.  All internal
1036.         data are views of the data of the original.
1037.         """
1038.         return self._apply('diagonal', *args, **kwargs)
1039. 
1040.     def squeeze(self, *args, **kwargs):
1041.         """Return an instance with single-dimensional shape entries removed
1042. 
1043.         Parameters are as for :meth:`~numpy.ndarray.squeeze`.  All internal
1044.         data are views of the data of the original.
1045.         """
1046.         return self._apply('squeeze', *args, **kwargs)
1047. 
1048.     def take(self, indices, axis=None, mode='raise'):
1049.         """Return a new instance formed from the elements at the given indices.
1050. 
1051.         Parameters are as for :meth:`~numpy.ndarray.take`, except that,
1052.         obviously, no output array can be given.
1053.         """
1054.         return self._apply('take', indices, axis=axis, mode=mode)
1055. 
1056. 
1057. class IncompatibleShapeError(ValueError):
1058.     def __init__(self, shape_a, shape_a_idx, shape_b, shape_b_idx):
1059.         super().__init__(shape_a, shape_a_idx, shape_b, shape_b_idx)
1060. 
1061. 
1062. def check_broadcast(*shapes):
1063.     """
1064.     Determines whether two or more Numpy arrays can be broadcast with each
1065.     other based on their shape tuple alone.
1066. 
1067.     Parameters
1068.     ----------
1069.     *shapes : tuple
1070.         All shapes to include in the comparison.  If only one shape is given it
1071.         is passed through unmodified.  If no shapes are given returns an empty
1072.         `tuple`.
1073. 
1074.     Returns
1075.     -------
1076.     broadcast : `tuple`
1077.         If all shapes are mutually broadcastable, returns a tuple of the full
1078.         broadcast shape.
1079.     """
1080. 
1081.     if len(shapes) == 0:
1082.         return ()
1083.     elif len(shapes) == 1:
1084.         return shapes[0]
1085. 
1086.     reversed_shapes = (reversed(shape) for shape in shapes)
1087. 
1088.     full_shape = []
1089. 
1090.     for dims in zip_longest(*reversed_shapes, fillvalue=1):
1091.         max_dim = 1
1092.         max_dim_idx = None
1093.         for idx, dim in enumerate(dims):
1094.             if dim == 1:
1095.                 continue
1096. 
1097.             if max_dim == 1:
1098.                 # The first dimension of size greater than 1
1099.                 max_dim = dim
1100.                 max_dim_idx = idx
1101.             elif dim != max_dim:
1102.                 raise IncompatibleShapeError(
1103.                     shapes[max_dim_idx], max_dim_idx, shapes[idx], idx)
1104. 
1105.         full_shape.append(max_dim)
1106. 
1107.     return tuple(full_shape[::-1])
1108. 
1109. 
1110. def dtype_bytes_or_chars(dtype):
1111.     """
1112.     Parse the number out of a dtype.str value like '<U5' or '<f8'.
1113. 
1114.     See #5819 for discussion on the need for this function for getting
1115.     the number of characters corresponding to a string dtype.
1116. 
1117.     Parameters
1118.     ----------
1119.     dtype : numpy dtype object
1120.         Input dtype
1121. 
1122.     Returns
1123.     -------
1124.     bytes_or_chars : int or None
1125.         Bits (for numeric types) or characters (for string types)
1126.     """
1127.     match = re.search(r'(\d+)$', dtype.str)
1128.     out = int(match.group(1)) if match else None
1129.     return out

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:05:47,082 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the 'full content' of the file 'astropy/utils/misc.py'.\n2. Extended relevance:\n   - The provided context contains the entire content of the file 'astropy/utils/misc.py' from line 1 to 1129, which directly fulfills the user's request.", relative_path='astropy/utils/misc.py', start_line=1, end_line=1129)]
2025-12-21 19:05:47,084 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/utils/misc.py`.
2025-12-21 19:05:47,084 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:05:47,084 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:05:47,085 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 19:05:47,085 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 19:05:47,086 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   └── yacc.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/utils/misc.py`.
Extra Requirements: 
Purpose: This will allow me to see the original implementation of the `InheritDocstrings` metaclass and understand how the patch addresses the issue of inheriting docstrings for properties.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/utils/misc.py
Line number range: 1 - 1129
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. """
4. A "grab bag" of relatively small general-purpose utilities that don't have
5. a clear module/package to live in.
6. """
7. 
8. 
9. 
10. import abc
11. import contextlib
12. import difflib
13. import inspect
14. import json
15. import os
16. import signal
17. import sys
18. import traceback
19. import unicodedata
20. import locale
21. import threading
22. import re
23. import urllib.request
24. 
25. from itertools import zip_longest
26. from contextlib import contextmanager
27. from collections import defaultdict, OrderedDict
28. 
29. 
30. 
31. __all__ = ['isiterable', 'silence', 'format_exception', 'NumpyRNGContext',
32.            'find_api_page', 'is_path_hidden', 'walk_skip_hidden',
33.            'JsonCustomEncoder', 'indent', 'InheritDocstrings',
34.            'OrderedDescriptor', 'OrderedDescriptorContainer', 'set_locale',
35.            'ShapedLikeNDArray', 'check_broadcast', 'IncompatibleShapeError',
36.            'dtype_bytes_or_chars']
37. 
38. 
39. def isiterable(obj):
40.     """Returns `True` if the given object is iterable."""
41. 
42.     try:
43.         iter(obj)
44.         return True
45.     except TypeError:
46.         return False
47. 
48. 
49. def indent(s, shift=1, width=4):
50.     """Indent a block of text.  The indentation is applied to each line."""
51. 
52.     indented = '\n'.join(' ' * (width * shift) + l if l else ''
53.                          for l in s.splitlines())
54.     if s[-1] == '\n':
55.         indented += '\n'
56. 
57.     return indented
58. 
59. 
60. class _DummyFile:
61.     """A noop writeable object."""
62. 
63.     def write(self, s):
64.         pass
65. 
66. 
67. @contextlib.contextmanager
68. def silence():
69.     """A context manager that silences sys.stdout and sys.stderr."""
70. 
71.     old_stdout = sys.stdout
72.     old_stderr = sys.stderr
73.     sys.stdout = _DummyFile()
74.     sys.stderr = _DummyFile()
75.     yield
76.     sys.stdout = old_stdout
77.     sys.stderr = old_stderr
78. 
79. 
80. def format_exception(msg, *args, **kwargs):
81.     """
82.     Given an exception message string, uses new-style formatting arguments
83.     ``{filename}``, ``{lineno}``, ``{func}`` and/or ``{text}`` to fill in
84.     information about the exception that occurred.  For example:
85. 
86.         try:
87.             1/0
88.         except:
89.             raise ZeroDivisionError(
90.                 format_except('A divide by zero occurred in {filename} at '
91.                               'line {lineno} of function {func}.'))
92. 
93.     Any additional positional or keyword arguments passed to this function are
94.     also used to format the message.
95. 
96.     .. note::
97.         This uses `sys.exc_info` to gather up the information needed to fill
98.         in the formatting arguments. Since `sys.exc_info` is not carried
99.         outside a handled exception, it's not wise to use this
100.         outside of an ``except`` clause - if it is, this will substitute
101.         '<unkown>' for the 4 formatting arguments.
102.     """
103. 
104.     tb = traceback.extract_tb(sys.exc_info()[2], limit=1)
105.     if len(tb) > 0:
106.         filename, lineno, func, text = tb[0]
107.     else:
108.         filename = lineno = func = text = '<unknown>'
109. 
110.     return msg.format(*args, filename=filename, lineno=lineno, func=func,
111.                       text=text, **kwargs)
112. 
113. 
114. class NumpyRNGContext:
115.     """
116.     A context manager (for use with the ``with`` statement) that will seed the
117.     numpy random number generator (RNG) to a specific value, and then restore
118.     the RNG state back to whatever it was before.
119. 
120.     This is primarily intended for use in the astropy testing suit, but it
121.     may be useful in ensuring reproducibility of Monte Carlo simulations in a
122.     science context.
123. 
124.     Parameters
125.     ----------
126.     seed : int
127.         The value to use to seed the numpy RNG
128. 
129.     Examples
130.     --------
131.     A typical use case might be::
132. 
133.         with NumpyRNGContext(<some seed value you pick>):
134.             from numpy import random
135. 
136.             randarr = random.randn(100)
137.             ... run your test using `randarr` ...
138. 
139.         #Any code using numpy.random at this indent level will act just as it
140.         #would have if it had been before the with statement - e.g. whatever
141.         #the default seed is.
142. 
143. 
144.     """
145. 
146.     def __init__(self, seed):
147.         self.seed = seed
148. 
149.     def __enter__(self):
150.         from numpy import random
151. 
152.         self.startstate = random.get_state()
153.         random.seed(self.seed)
154. 
155.     def __exit__(self, exc_type, exc_value, traceback):
156.         from numpy import random
157. 
158.         random.set_state(self.startstate)
159. 
160. 
161. def find_api_page(obj, version=None, openinbrowser=True, timeout=None):
162.     """
163.     Determines the URL of the API page for the specified object, and
164.     optionally open that page in a web browser.
165. 
166.     .. note::
167.         You must be connected to the internet for this to function even if
168.         ``openinbrowser`` is `False`, unless you provide a local version of
169.         the documentation to ``version`` (e.g., ``file:///path/to/docs``).
170. 
171.     Parameters
172.     ----------
173.     obj
174.         The object to open the docs for or its fully-qualified name
175.         (as a str).
176.     version : str
177.         The doc version - either a version number like '0.1', 'dev' for
178.         the development/latest docs, or a URL to point to a specific
179.         location that should be the *base* of the documentation. Defaults to
180.         latest if you are on aren't on a release, otherwise, the version you
181.         are on.
182.     openinbrowser : bool
183.         If `True`, the `webbrowser` package will be used to open the doc
184.         page in a new web browser window.
185.     timeout : number, optional
186.         The number of seconds to wait before timing-out the query to
187.         the astropy documentation.  If not given, the default python
188.         stdlib timeout will be used.
189. 
190.     Returns
191.     -------
192.     url : str
193.         The loaded URL
194. 
195.     Raises
196.     ------
197.     ValueError
198.         If the documentation can't be found
199. 
200.     """
201.     import webbrowser
202. 
203.     from zlib import decompress
204. 
205.     if (not isinstance(obj, str) and
206.             hasattr(obj, '__module__') and
207.             hasattr(obj, '__name__')):
208.         obj = obj.__module__ + '.' + obj.__name__
209.     elif inspect.ismodule(obj):
210.         obj = obj.__name__
211. 
212.     if version is None:
213.         from .. import version
214. 
215.         if version.release:
216.             version = 'v' + version.version
217.         else:
218.             version = 'dev'
219. 
220.     if '://' in version:
221.         if version.endswith('index.html'):
222.             baseurl = version[:-10]
223.         elif version.endswith('/'):
224.             baseurl = version
225.         else:
226.             baseurl = version + '/'
227.     elif version == 'dev' or version == 'latest':
228.         baseurl = 'http://devdocs.astropy.org/'
229.     else:
230.         baseurl = 'http://docs.astropy.org/en/{vers}/'.format(vers=version)
231. 
232.     if timeout is None:
233.         uf = urllib.request.urlopen(baseurl + 'objects.inv')
234.     else:
235.         uf = urllib.request.urlopen(baseurl + 'objects.inv', timeout=timeout)
236. 
237.     try:
238.         oiread = uf.read()
239. 
240.         # need to first read/remove the first four lines, which have info before
241.         # the compressed section with the actual object inventory
242.         idx = -1
243.         headerlines = []
244.         for _ in range(4):
245.             oldidx = idx
246.             idx = oiread.index(b'\n', oldidx + 1)
247.             headerlines.append(oiread[(oldidx+1):idx].decode('utf-8'))
248. 
249.         # intersphinx version line, project name, and project version
250.         ivers, proj, vers, compr = headerlines
251.         if 'The remainder of this file is compressed using zlib' not in compr:
252.             raise ValueError('The file downloaded from {0} does not seem to be'
253.                              'the usual Sphinx objects.inv format.  Maybe it '
254.                              'has changed?'.format(baseurl + 'objects.inv'))
255. 
256.         compressed = oiread[(idx+1):]
257.     finally:
258.         uf.close()
259. 
260.     decompressed = decompress(compressed).decode('utf-8')
261. 
262.     resurl = None
263. 
264.     for l in decompressed.strip().splitlines():
265.         ls = l.split()
266.         name = ls[0]
267.         loc = ls[3]
268.         if loc.endswith('$'):
269.             loc = loc[:-1] + name
270. 
271.         if name == obj:
272.             resurl = baseurl + loc
273.             break
274. 
275.     if resurl is None:
276.         raise ValueError('Could not find the docs for the object {obj}'.format(obj=obj))
277.     elif openinbrowser:
278.         webbrowser.open(resurl)
279. 
280.     return resurl
281. 
282. 
283. def signal_number_to_name(signum):
284.     """
285.     Given an OS signal number, returns a signal name.  If the signal
286.     number is unknown, returns ``'UNKNOWN'``.
287.     """
288.     # Since these numbers and names are platform specific, we use the
289.     # builtin signal module and build a reverse mapping.
290. 
291.     signal_to_name_map = dict((k, v) for v, k in signal.__dict__.items()
292.                               if v.startswith('SIG'))
293. 
294.     return signal_to_name_map.get(signum, 'UNKNOWN')
295. 
296. 
297. if sys.platform == 'win32':
298.     import ctypes
299. 
300.     def _has_hidden_attribute(filepath):
301.         """
302.         Returns True if the given filepath has the hidden attribute on
303.         MS-Windows.  Based on a post here:
304.         http://stackoverflow.com/questions/284115/cross-platform-hidden-file-detection
305.         """
306.         if isinstance(filepath, bytes):
307.             filepath = filepath.decode(sys.getfilesystemencoding())
308.         try:
309.             attrs = ctypes.windll.kernel32.GetFileAttributesW(filepath)
310.             result = bool(attrs & 2) and attrs != -1
311.         except AttributeError:
312.             result = False
313.         return result
314. else:
315.     def _has_hidden_attribute(filepath):
316.         return False
317. 
318. 
319. def is_path_hidden(filepath):
320.     """
321.     Determines if a given file or directory is hidden.
322. 
323.     Parameters
324.     ----------
325.     filepath : str
326.         The path to a file or directory
327. 
328.     Returns
329.     -------
330.     hidden : bool
331.         Returns `True` if the file is hidden
332.     """
333.     name = os.path.basename(os.path.abspath(filepath))
334.     if isinstance(name, bytes):
335.         is_dotted = name.startswith(b'.')
336.     else:
337.         is_dotted = name.startswith('.')
338.     return is_dotted or _has_hidden_attribute(filepath)
339. 
340. 
341. def walk_skip_hidden(top, onerror=None, followlinks=False):
342.     """
343.     A wrapper for `os.walk` that skips hidden files and directories.
344. 
345.     This function does not have the parameter ``topdown`` from
346.     `os.walk`: the directories must always be recursed top-down when
347.     using this function.
348. 
349.     See also
350.     --------
351.     os.walk : For a description of the parameters
352.     """
353.     for root, dirs, files in os.walk(
354.             top, topdown=True, onerror=onerror,
355.             followlinks=followlinks):
356.         # These lists must be updated in-place so os.walk will skip
357.         # hidden directories
358.         dirs[:] = [d for d in dirs if not is_path_hidden(d)]
359.         files[:] = [f for f in files if not is_path_hidden(f)]
360.         yield root, dirs, files
361. 
362. 
363. class JsonCustomEncoder(json.JSONEncoder):
364.     """Support for data types that JSON default encoder
365.     does not do.
366. 
367.     This includes:
368. 
369.         * Numpy array or number
370.         * Complex number
371.         * Set
372.         * Bytes
373.         * astropy.UnitBase
374.         * astropy.Quantity
375. 
376.     Examples
377.     --------
378.     >>> import json
379.     >>> import numpy as np
380.     >>> from astropy.utils.misc import JsonCustomEncoder
381.     >>> json.dumps(np.arange(3), cls=JsonCustomEncoder)
382.     '[0, 1, 2]'
383. 
384.     """
385. 
386.     def default(self, obj):
387.         from .. import units as u
388.         import numpy as np
389.         if isinstance(obj, u.Quantity):
390.             return dict(value=obj.value, unit=obj.unit.to_string())
391.         if isinstance(obj, (np.number, np.ndarray)):
392.             return obj.tolist()
393.         elif isinstance(obj, complex):
394.             return [obj.real, obj.imag]
395.         elif isinstance(obj, set):
396.             return list(obj)
397.         elif isinstance(obj, bytes):  # pragma: py3
398.             return obj.decode()
399.         elif isinstance(obj, (u.UnitBase, u.FunctionUnitBase)):
400.             if obj == u.dimensionless_unscaled:
401.                 obj = 'dimensionless_unit'
402.             else:
403.                 return obj.to_string()
404. 
405.         return json.JSONEncoder.default(self, obj)
406. 
407. 
408. def strip_accents(s):
409.     """
410.     Remove accents from a Unicode string.
411. 
412.     This helps with matching "ångström" to "angstrom", for example.
413.     """
414.     return ''.join(
415.         c for c in unicodedata.normalize('NFD', s)
416.         if unicodedata.category(c) != 'Mn')
417. 
418. 
419. def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
420.     """
421.     When a string isn't found in a set of candidates, we can be nice
422.     to provide a list of alternatives in the exception.  This
423.     convenience function helps to format that part of the exception.
424. 
425.     Parameters
426.     ----------
427.     s : str
428. 
429.     candidates : sequence of str or dict of str keys
430. 
431.     n : int
432.         The maximum number of results to include.  See
433.         `difflib.get_close_matches`.
434. 
435.     cutoff : float
436.         In the range [0, 1]. Possibilities that don't score at least
437.         that similar to word are ignored.  See
438.         `difflib.get_close_matches`.
439. 
440.     fix : callable
441.         A callable to modify the results after matching.  It should
442.         take a single string and return a sequence of strings
443.         containing the fixed matches.
444. 
445.     Returns
446.     -------
447.     message : str
448.         Returns the string "Did you mean X, Y, or Z?", or the empty
449.         string if no alternatives were found.
450.     """
451.     if isinstance(s, str):
452.         s = strip_accents(s)
453.     s_lower = s.lower()
454. 
455.     # Create a mapping from the lower case name to all capitalization
456.     # variants of that name.
457.     candidates_lower = {}
458.     for candidate in candidates:
459.         candidate_lower = candidate.lower()
460.         candidates_lower.setdefault(candidate_lower, [])
461.         candidates_lower[candidate_lower].append(candidate)
462. 
463.     # The heuristic here is to first try "singularizing" the word.  If
464.     # that doesn't match anything use difflib to find close matches in
465.     # original, lower and upper case.
466.     if s_lower.endswith('s') and s_lower[:-1] in candidates_lower:
467.         matches = [s_lower[:-1]]
468.     else:
469.         matches = difflib.get_close_matches(
470.             s_lower, candidates_lower, n=n, cutoff=cutoff)
471. 
472.     if len(matches):
473.         capitalized_matches = set()
474.         for match in matches:
475.             capitalized_matches.update(candidates_lower[match])
476.         matches = capitalized_matches
477. 
478.         if fix is not None:
479.             mapped_matches = []
480.             for match in matches:
481.                 mapped_matches.extend(fix(match))
482.             matches = mapped_matches
483. 
484.         matches = list(set(matches))
485.         matches = sorted(matches)
486. 
487.         if len(matches) == 1:
488.             matches = matches[0]
489.         else:
490.             matches = (', '.join(matches[:-1]) + ' or ' +
491.                        matches[-1])
492.         return 'Did you mean {0}?'.format(matches)
493. 
494.     return ''
495. 
496. 
497. class InheritDocstrings(type):
498.     """
499.     This metaclass makes methods of a class automatically have their
500.     docstrings filled in from the methods they override in the base
501.     class.
502. 
503.     If the class uses multiple inheritance, the docstring will be
504.     chosen from the first class in the bases list, in the same way as
505.     methods are normally resolved in Python.  If this results in
506.     selecting the wrong docstring, the docstring will need to be
507.     explicitly included on the method.
508. 
509.     For example::
510. 
511.         >>> from astropy.utils.misc import InheritDocstrings
512.         >>> class A(metaclass=InheritDocstrings):
513.         ...     def wiggle(self):
514.         ...         "Wiggle the thingamajig"
515.         ...         pass
516.         >>> class B(A):
517.         ...     def wiggle(self):
518.         ...         pass
519.         >>> B.wiggle.__doc__
520.         u'Wiggle the thingamajig'
521.     """
522. 
523.     def __init__(cls, name, bases, dct):
524.         def is_public_member(key):
525.             return (
526.                 (key.startswith('__') and key.endswith('__')
527.                  and len(key) > 4) or
528.                 not key.startswith('_'))
529. 
530.         for key, val in dct.items():
531.             if (inspect.isfunction(val) and
532.                 is_public_member(key) and
533.                 val.__doc__ is None):
534.                 for base in cls.__mro__[1:]:
535.                     super_method = getattr(base, key, None)
536.                     if super_method is not None:
537.                         val.__doc__ = super_method.__doc__
538.                         break
539. 
540.         super().__init__(name, bases, dct)
541. 
542. 
543. class OrderedDescriptor(metaclass=abc.ABCMeta):
544.     """
545.     Base class for descriptors whose order in the class body should be
546.     preserved.  Intended for use in concert with the
547.     `OrderedDescriptorContainer` metaclass.
548. 
549.     Subclasses of `OrderedDescriptor` must define a value for a class attribute
550.     called ``_class_attribute_``.  This is the name of a class attribute on the
551.     *container* class for these descriptors, which will be set to an
552.     `~collections.OrderedDict` at class creation time.  This
553.     `~collections.OrderedDict` will contain a mapping of all class attributes
554.     that were assigned instances of the `OrderedDescriptor` subclass, to the
555.     instances themselves.  See the documentation for
556.     `OrderedDescriptorContainer` for a concrete example.
557. 
558.     Optionally, subclasses of `OrderedDescriptor` may define a value for a
559.     class attribute called ``_name_attribute_``.  This should be the name of
560.     an attribute on instances of the subclass.  When specified, during
561.     creation of a class containing these descriptors, the name attribute on
562.     each instance will be set to the name of the class attribute it was
563.     assigned to on the class.
564. 
565.     .. note::
566. 
567.         Although this class is intended for use with *descriptors* (i.e.
568.         classes that define any of the ``__get__``, ``__set__``, or
569.         ``__delete__`` magic methods), this base class is not itself a
570.         descriptor, and technically this could be used for classes that are
571.         not descriptors too.  However, use with descriptors is the original
572.         intended purpose.
573.     """
574. 
575.     # This id increments for each OrderedDescriptor instance created, so they
576.     # are always ordered in the order they were created.  Class bodies are
577.     # guaranteed to be executed from top to bottom.  Not sure if this is
578.     # thread-safe though.
579.     _nextid = 1
580. 
581.     @property
582.     @abc.abstractmethod
583.     def _class_attribute_(self):
584.         """
585.         Subclasses should define this attribute to the name of an attribute on
586.         classes containing this subclass.  That attribute will contain the mapping
587.         of all instances of that `OrderedDescriptor` subclass defined in the class
588.         body.  If the same descriptor needs to be used with different classes,
589.         each with different names of this attribute, multiple subclasses will be
590.         needed.
591.         """
592. 
593.     _name_attribute_ = None
594.     """
595.     Subclasses may optionally define this attribute to specify the name of an
596.     attribute on instances of the class that should be filled with the
597.     instance's attribute name at class creation time.
598.     """
599. 
600.     def __init__(self, *args, **kwargs):
601.         # The _nextid attribute is shared across all subclasses so that
602.         # different subclasses of OrderedDescriptors can be sorted correctly
603.         # between themselves
604.         self.__order = OrderedDescriptor._nextid
605.         OrderedDescriptor._nextid += 1
606.         super().__init__()
607. 
608.     def __lt__(self, other):
609.         """
610.         Defined for convenient sorting of `OrderedDescriptor` instances, which
611.         are defined to sort in their creation order.
612.         """
613. 
614.         if (isinstance(self, OrderedDescriptor) and
615.                 isinstance(other, OrderedDescriptor)):
616.             try:
617.                 return self.__order < other.__order
618.             except AttributeError:
619.                 raise RuntimeError(
620.                     'Could not determine ordering for {0} and {1}; at least '
621.                     'one of them is not calling super().__init__ in its '
622.                     '__init__.'.format(self, other))
623.         else:
624.             return NotImplemented
625. 
626. 
627. class OrderedDescriptorContainer(type):
628.     """
629.     Classes should use this metaclass if they wish to use `OrderedDescriptor`
630.     attributes, which are class attributes that "remember" the order in which
631.     they were defined in the class body.
632. 
633.     Every subclass of `OrderedDescriptor` has an attribute called
634.     ``_class_attribute_``.  For example, if we have
635. 
636.     .. code:: python
637. 
638.         class ExampleDecorator(OrderedDescriptor):
639.             _class_attribute_ = '_examples_'
640. 
641.     Then when a class with the `OrderedDescriptorContainer` metaclass is
642.     created, it will automatically be assigned a class attribute ``_examples_``
643.     referencing an `~collections.OrderedDict` containing all instances of
644.     ``ExampleDecorator`` defined in the class body, mapped to by the names of
645.     the attributes they were assigned to.
646. 
647.     When subclassing a class with this metaclass, the descriptor dict (i.e.
648.     ``_examples_`` in the above example) will *not* contain descriptors
649.     inherited from the base class.  That is, this only works by default with
650.     decorators explicitly defined in the class body.  However, the subclass
651.     *may* define an attribute ``_inherit_decorators_`` which lists
652.     `OrderedDescriptor` classes that *should* be added from base classes.
653.     See the examples section below for an example of this.
654. 
655.     Examples
656.     --------
657. 
658.     >>> from astropy.utils import OrderedDescriptor, OrderedDescriptorContainer
659.     >>> class TypedAttribute(OrderedDescriptor):
660.     ...     \"\"\"
661.     ...     Attributes that may only be assigned objects of a specific type,
662.     ...     or subclasses thereof.  For some reason we care about their order.
663.     ...     \"\"\"
664.     ...
665.     ...     _class_attribute_ = 'typed_attributes'
666.     ...     _name_attribute_ = 'name'
667.     ...     # A default name so that instances not attached to a class can
668.     ...     # still be repr'd; useful for debugging
669.     ...     name = '<unbound>'
670.     ...
671.     ...     def __init__(self, type):
672.     ...         # Make sure not to forget to call the super __init__
673.     ...         super().__init__()
674.     ...         self.type = type
675.     ...
676.     ...     def __get__(self, obj, objtype=None):
677.     ...         if obj is None:
678.     ...             return self
679.     ...         if self.name in obj.__dict__:
680.     ...             return obj.__dict__[self.name]
681.     ...         else:
682.     ...             raise AttributeError(self.name)
683.     ...
684.     ...     def __set__(self, obj, value):
685.     ...         if not isinstance(value, self.type):
686.     ...             raise ValueError('{0}.{1} must be of type {2!r}'.format(
687.     ...                 obj.__class__.__name__, self.name, self.type))
688.     ...         obj.__dict__[self.name] = value
689.     ...
690.     ...     def __delete__(self, obj):
691.     ...         if self.name in obj.__dict__:
692.     ...             del obj.__dict__[self.name]
693.     ...         else:
694.     ...             raise AttributeError(self.name)
695.     ...
696.     ...     def __repr__(self):
697.     ...         if isinstance(self.type, tuple) and len(self.type) > 1:
698.     ...             typestr = '({0})'.format(
699.     ...                 ', '.join(t.__name__ for t in self.type))
700.     ...         else:
701.     ...             typestr = self.type.__name__
702.     ...         return '<{0}(name={1}, type={2})>'.format(
703.     ...                 self.__class__.__name__, self.name, typestr)
704.     ...
705. 
706.     Now let's create an example class that uses this ``TypedAttribute``::
707. 
708.         >>> class Point2D(metaclass=OrderedDescriptorContainer):
709.         ...     x = TypedAttribute((float, int))
710.         ...     y = TypedAttribute((float, int))
711.         ...
712.         ...     def __init__(self, x, y):
713.         ...         self.x, self.y = x, y
714.         ...
715.         >>> p1 = Point2D(1.0, 2.0)
716.         >>> p1.x
717.         1.0
718.         >>> p1.y
719.         2.0
720.         >>> p2 = Point2D('a', 'b')  # doctest: +IGNORE_EXCEPTION_DETAIL
721.         Traceback (most recent call last):
722.             ...
723.         ValueError: Point2D.x must be of type (float, int>)
724. 
725.     We see that ``TypedAttribute`` works more or less as advertised, but
726.     there's nothing special about that.  Let's see what
727.     `OrderedDescriptorContainer` did for us::
728. 
729.         >>> Point2D.typed_attributes
730.         OrderedDict([('x', <TypedAttribute(name=x, type=(float, int))>),
731.         ('y', <TypedAttribute(name=y, type=(float, int))>)])
732. 
733.     If we create a subclass, it does *not* by default add inherited descriptors
734.     to ``typed_attributes``::
735. 
736.         >>> class Point3D(Point2D):
737.         ...     z = TypedAttribute((float, int))
738.         ...
739.         >>> Point3D.typed_attributes
740.         OrderedDict([('z', <TypedAttribute(name=z, type=(float, int))>)])
741. 
742.     However, if we specify ``_inherit_descriptors_`` from ``Point2D`` then
743.     it will do so::
744. 
745.         >>> class Point3D(Point2D):
746.         ...     _inherit_descriptors_ = (TypedAttribute,)
747.         ...     z = TypedAttribute((float, int))
748.         ...
749.         >>> Point3D.typed_attributes
750.         OrderedDict([('x', <TypedAttribute(name=x, type=(float, int))>),
751.         ('y', <TypedAttribute(name=y, type=(float, int))>),
752.         ('z', <TypedAttribute(name=z, type=(float, int))>)])
753. 
754.     .. note::
755. 
756.         Hopefully it is clear from these examples that this construction
757.         also allows a class of type `OrderedDescriptorContainer` to use
758.         multiple different `OrderedDescriptor` classes simultaneously.
759.     """
760. 
761.     _inherit_descriptors_ = ()
762. 
763.     def __init__(cls, cls_name, bases, members):
764.         descriptors = defaultdict(list)
765.         seen = set()
766.         inherit_descriptors = ()
767.         descr_bases = {}
768. 
769.         for mro_cls in cls.__mro__:
770.             for name, obj in mro_cls.__dict__.items():
771.                 if name in seen:
772.                     # Checks if we've already seen an attribute of the given
773.                     # name (if so it will override anything of the same name in
774.                     # any base class)
775.                     continue
776. 
777.                 seen.add(name)
778. 
779.                 if (not isinstance(obj, OrderedDescriptor) or
780.                         (inherit_descriptors and
781.                             not isinstance(obj, inherit_descriptors))):
782.                     # The second condition applies when checking any
783.                     # subclasses, to see if we can inherit any descriptors of
784.                     # the given type from subclasses (by default inheritance is
785.                     # disabled unless the class has _inherit_descriptors_
786.                     # defined)
787.                     continue
788. 
789.                 if obj._name_attribute_ is not None:
790.                     setattr(obj, obj._name_attribute_, name)
791. 
792.                 # Don't just use the descriptor's class directly; instead go
793.                 # through its MRO and find the class on which _class_attribute_
794.                 # is defined directly.  This way subclasses of some
795.                 # OrderedDescriptor *may* override _class_attribute_ and have
796.                 # its own _class_attribute_, but by default all subclasses of
797.                 # some OrderedDescriptor are still grouped together
798.                 # TODO: It might be worth clarifying this in the docs
799.                 if obj.__class__ not in descr_bases:
800.                     for obj_cls_base in obj.__class__.__mro__:
801.                         if '_class_attribute_' in obj_cls_base.__dict__:
802.                             descr_bases[obj.__class__] = obj_cls_base
803.                             descriptors[obj_cls_base].append((obj, name))
804.                             break
805.                 else:
806.                     # Make sure to put obj first for sorting purposes
807.                     obj_cls_base = descr_bases[obj.__class__]
808.                     descriptors[obj_cls_base].append((obj, name))
809. 
810.             if not getattr(mro_cls, '_inherit_descriptors_', False):
811.                 # If _inherit_descriptors_ is undefined then we don't inherit
812.                 # any OrderedDescriptors from any of the base classes, and
813.                 # there's no reason to continue through the MRO
814.                 break
815.             else:
816.                 inherit_descriptors = mro_cls._inherit_descriptors_
817. 
818.         for descriptor_cls, instances in descriptors.items():
819.             instances.sort()
820.             instances = OrderedDict((key, value) for value, key in instances)
821.             setattr(cls, descriptor_cls._class_attribute_, instances)
822. 
823.         super().__init__(cls_name, bases, members)
824. 
825. 
826. LOCALE_LOCK = threading.Lock()
827. 
828. 
829. @contextmanager
830. def set_locale(name):
831.     """
832.     Context manager to temporarily set the locale to ``name``.
833. 
834.     An example is setting locale to "C" so that the C strtod()
835.     function will use "." as the decimal point to enable consistent
836.     numerical string parsing.
837. 
838.     Note that one cannot nest multiple set_locale() context manager
839.     statements as this causes a threading lock.
840. 
841.     This code taken from https://stackoverflow.com/questions/18593661/how-do-i-strftime-a-date-object-in-a-different-locale.
842. 
843.     Parameters
844.     ==========
845.     name : str
846.         Locale name, e.g. "C" or "fr_FR".
847.     """
848.     name = str(name)
849. 
850.     with LOCALE_LOCK:
851.         saved = locale.setlocale(locale.LC_ALL)
852.         if saved == name:
853.             # Don't do anything if locale is already the requested locale
854.             yield
855.         else:
856.             try:
857.                 locale.setlocale(locale.LC_ALL, name)
858.                 yield
859.             finally:
860.                 locale.setlocale(locale.LC_ALL, saved)
861. 
862. 
863. class ShapedLikeNDArray(metaclass=abc.ABCMeta):
864.     """Mixin class to provide shape-changing methods.
865. 
866.     The class proper is assumed to have some underlying data, which are arrays
867.     or array-like structures. It must define a ``shape`` property, which gives
868.     the shape of those data, as well as an ``_apply`` method that creates a new
869.     instance in which a `~numpy.ndarray` method has been applied to those.
870. 
871.     Furthermore, for consistency with `~numpy.ndarray`, it is recommended to
872.     define a setter for the ``shape`` property, which, like the
873.     `~numpy.ndarray.shape` property allows in-place reshaping the internal data
874.     (and, unlike the ``reshape`` method raises an exception if this is not
875.     possible).
876. 
877.     This class also defines default implementations for ``ndim`` and ``size``
878.     properties, calculating those from the ``shape``.  These can be overridden
879.     by subclasses if there are faster ways to obtain those numbers.
880. 
881.     """
882. 
883.     # Note to developers: if new methods are added here, be sure to check that
884.     # they work properly with the classes that use this, such as Time and
885.     # BaseRepresentation, i.e., look at their ``_apply`` methods and add
886.     # relevant tests.  This is particularly important for methods that imply
887.     # copies rather than views of data (see the special-case treatment of
888.     # 'flatten' in Time).
889. 
890.     @property
891.     @abc.abstractmethod
892.     def shape(self):
893.         """The shape of the instance and underlying arrays."""
894. 
895.     @abc.abstractmethod
896.     def _apply(method, *args, **kwargs):
897.         """Create a new instance, with ``method`` applied to underlying data.
898. 
899.         The method is any of the shape-changing methods for `~numpy.ndarray`
900.         (``reshape``, ``swapaxes``, etc.), as well as those picking particular
901.         elements (``__getitem__``, ``take``, etc.). It will be applied to the
902.         underlying arrays (e.g., ``jd1`` and ``jd2`` in `~astropy.time.Time`),
903.         with the results used to create a new instance.
904. 
905.         Parameters
906.         ----------
907.         method : str
908.             Method to be applied to the instance's internal data arrays.
909.         args : tuple
910.             Any positional arguments for ``method``.
911.         kwargs : dict
912.             Any keyword arguments for ``method``.
913. 
914.         """
915. 
916.     @property
917.     def ndim(self):
918.         """The number of dimensions of the instance and underlying arrays."""
919.         return len(self.shape)
920. 
921.     @property
922.     def size(self):
923.         """The size of the object, as calculated from its shape."""
924.         size = 1
925.         for sh in self.shape:
926.             size *= sh
927.         return size
928. 
929.     @property
930.     def isscalar(self):
931.         return self.shape == ()
932. 
933.     def __len__(self):
934.         if self.isscalar:
935.             raise TypeError("Scalar {0!r} object has no len()"
936.                             .format(self.__class__.__name__))
937.         return self.shape[0]
938. 
939.     def __bool__(self):
940.         """Any instance should evaluate to True, except when it is empty."""
941.         return self.size > 0
942. 
943.     def __getitem__(self, item):
944.         try:
945.             return self._apply('__getitem__', item)
946.         except IndexError:
947.             if self.isscalar:
948.                 raise TypeError('scalar {0!r} object is not subscriptable.'
949.                                 .format(self.__class__.__name__))
950.             else:
951.                 raise
952. 
953.     def __iter__(self):
954.         if self.isscalar:
955.             raise TypeError('scalar {0!r} object is not iterable.'
956.                             .format(self.__class__.__name__))
957. 
958.         # We cannot just write a generator here, since then the above error
959.         # would only be raised once we try to use the iterator, rather than
960.         # upon its definition using iter(self).
961.         def self_iter():
962.             for idx in range(len(self)):
963.                 yield self[idx]
964. 
965.         return self_iter()
966. 
967.     def copy(self, *args, **kwargs):
968.         """Return an instance containing copies of the internal data.
969. 
970.         Parameters are as for :meth:`~numpy.ndarray.copy`.
971.         """
972.         return self._apply('copy', *args, **kwargs)
973. 
974.     def reshape(self, *args, **kwargs):
975.         """Returns an instance containing the same data with a new shape.
976. 
977.         Parameters are as for :meth:`~numpy.ndarray.reshape`.  Note that it is
978.         not always possible to change the shape of an array without copying the
979.         data (see :func:`~numpy.reshape` documentation). If you want an error
980.         to be raise if the data is copied, you should assign the new shape to
981.         the shape attribute (note: this may not be implemented for all classes
982.         using ``ShapedLikeNDArray``).
983.         """
984.         return self._apply('reshape', *args, **kwargs)
985. 
986.     def ravel(self, *args, **kwargs):
987.         """Return an instance with the array collapsed into one dimension.
988. 
989.         Parameters are as for :meth:`~numpy.ndarray.ravel`. Note that it is
990.         not always possible to unravel an array without copying the data.
991.         If you want an error to be raise if the data is copied, you should
992.         should assign shape ``(-1,)`` to the shape attribute.
993.         """
994.         return self._apply('ravel', *args, **kwargs)
995. 
996.     def flatten(self, *args, **kwargs):
997.         """Return a copy with the array collapsed into one dimension.
998. 
999.         Parameters are as for :meth:`~numpy.ndarray.flatten`.
1000.         """
1001.         return self._apply('flatten', *args, **kwargs)
1002. 
1003.     def transpose(self, *args, **kwargs):
1004.         """Return an instance with the data transposed.
1005. 
1006.         Parameters are as for :meth:`~numpy.ndarray.transpose`.  All internal
1007.         data are views of the data of the original.
1008.         """
1009.         return self._apply('transpose', *args, **kwargs)
1010. 
1011.     @property
1012.     def T(self):
1013.         """Return an instance with the data transposed.
1014. 
1015.         Parameters are as for :attr:`~numpy.ndarray.T`.  All internal
1016.         data are views of the data of the original.
1017.         """
1018.         if self.ndim < 2:
1019.             return self
1020.         else:
1021.             return self.transpose()
1022. 
1023.     def swapaxes(self, *args, **kwargs):
1024.         """Return an instance with the given axes interchanged.
1025. 
1026.         Parameters are as for :meth:`~numpy.ndarray.swapaxes`:
1027.         ``axis1, axis2``.  All internal data are views of the data of the
1028.         original.
1029.         """
1030.         return self._apply('swapaxes', *args, **kwargs)
1031. 
1032.     def diagonal(self, *args, **kwargs):
1033.         """Return an instance with the specified diagonals.
1034. 
1035.         Parameters are as for :meth:`~numpy.ndarray.diagonal`.  All internal
1036.         data are views of the data of the original.
1037.         """
1038.         return self._apply('diagonal', *args, **kwargs)
1039. 
1040.     def squeeze(self, *args, **kwargs):
1041.         """Return an instance with single-dimensional shape entries removed
1042. 
1043.         Parameters are as for :meth:`~numpy.ndarray.squeeze`.  All internal
1044.         data are views of the data of the original.
1045.         """
1046.         return self._apply('squeeze', *args, **kwargs)
1047. 
1048.     def take(self, indices, axis=None, mode='raise'):
1049.         """Return a new instance formed from the elements at the given indices.
1050. 
1051.         Parameters are as for :meth:`~numpy.ndarray.take`, except that,
1052.         obviously, no output array can be given.
1053.         """
1054.         return self._apply('take', indices, axis=axis, mode=mode)
1055. 
1056. 
1057. class IncompatibleShapeError(ValueError):
1058.     def __init__(self, shape_a, shape_a_idx, shape_b, shape_b_idx):
1059.         super().__init__(shape_a, shape_a_idx, shape_b, shape_b_idx)
1060. 
1061. 
1062. def check_broadcast(*shapes):
1063.     """
1064.     Determines whether two or more Numpy arrays can be broadcast with each
1065.     other based on their shape tuple alone.
1066. 
1067.     Parameters
1068.     ----------
1069.     *shapes : tuple
1070.         All shapes to include in the comparison.  If only one shape is given it
1071.         is passed through unmodified.  If no shapes are given returns an empty
1072.         `tuple`.
1073. 
1074.     Returns
1075.     -------
1076.     broadcast : `tuple`
1077.         If all shapes are mutually broadcastable, returns a tuple of the full
1078.         broadcast shape.
1079.     """
1080. 
1081.     if len(shapes) == 0:
1082.         return ()
1083.     elif len(shapes) == 1:
1084.         return shapes[0]
1085. 
1086.     reversed_shapes = (reversed(shape) for shape in shapes)
1087. 
1088.     full_shape = []
1089. 
1090.     for dims in zip_longest(*reversed_shapes, fillvalue=1):
1091.         max_dim = 1
1092.         max_dim_idx = None
1093.         for idx, dim in enumerate(dims):
1094.             if dim == 1:
1095.                 continue
1096. 
1097.             if max_dim == 1:
1098.                 # The first dimension of size greater than 1
1099.                 max_dim = dim
1100.                 max_dim_idx = idx
1101.             elif dim != max_dim:
1102.                 raise IncompatibleShapeError(
1103.                     shapes[max_dim_idx], max_dim_idx, shapes[idx], idx)
1104. 
1105.         full_shape.append(max_dim)
1106. 
1107.     return tuple(full_shape[::-1])
1108. 
1109. 
1110. def dtype_bytes_or_chars(dtype):
1111.     """
1112.     Parse the number out of a dtype.str value like '<U5' or '<f8'.
1113. 
1114.     See #5819 for discussion on the need for this function for getting
1115.     the number of characters corresponding to a string dtype.
1116. 
1117.     Parameters
1118.     ----------
1119.     dtype : numpy dtype object
1120.         Input dtype
1121. 
1122.     Returns
1123.     -------
1124.     bytes_or_chars : int or None
1125.         Bits (for numeric types) or characters (for string types)
1126.     """
1127.     match = re.search(r'(\d+)$', dtype.str)
1128.     out = int(match.group(1)) if match else None
1129.     return out

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:06:04,375 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to understand a patch for the `InheritDocstrings` metaclass which adds support for properties. I have the code for the metaclass from `astropy/utils/misc.py`. To understand the necessity and impact of the patch, I need to see an example of its usage. The `astropy.modeling` package likely contains class hierarchies with properties that would benefit from this fix. `astropy/modeling/core.py` is a good place to start as it probably defines the base `Model` class which may use the `InheritDocstrings` metaclass.' query='Please provide the full content of the file `astropy/modeling/core.py`.' extra_requirements='' purpose='I need to examine how the `InheritDocstrings` metaclass is used, particularly in classes with properties, to understand the context of the bug fix.'
2025-12-21 19:06:04,376 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/modeling/core.py`.
2025-12-21 19:06:04,376 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:06:04,377 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:06:04,377 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:06:04,377 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/modeling/core.py`.
Purpose: I need to examine how the `InheritDocstrings` metaclass is used, particularly in classes with properties, to understand the context of the bug fix.
2025-12-21 19:06:07,655 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `astropy/modeling/core.py` so you can examine the usage of the `InheritDocstrings` metaclass. This will help you understand the context of the bug fix, especially in classes that use properties.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/modeling/core.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2143, 'candidates_token_count': 75, 'total_token_count': 2429, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2143}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 75}], 'thoughts_token_count': 211, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13499473571777343, 'model_name': 'gemini-2.5-pro'} id='run--f3b6c634-bbf2-49f8-a425-4c83409e62d0-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/modeling/core.py'}, 'id': '105edc44-978b-43e1-bc75-d38553d8ef15', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2143, 'output_tokens': 75, 'total_tokens': 2429, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 211}}
2025-12-21 19:06:08,523 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={} response_metadata={'usage_metadata': {'prompt_token_count': 9141, 'total_token_count': 9141, 'cached_content_token_count': 1833, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9141}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1833}], 'candidates_token_count': 0, 'thoughts_token_count': 0, 'candidates_tokens_details': []}, 'model_name': 'gemini-2.5-pro'} id='run--7d30d900-7e2b-4ec3-9626-b0b70748b968-0' usage_metadata={'input_tokens': 9141, 'output_tokens': 0, 'total_tokens': 9141, 'input_token_details': {'cache_read': 1833}}
2025-12-21 19:06:08,525 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/modeling/core.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to examine how the `InheritDocstrings` metaclass is used, particularly in classes with properties, to understand the context of the bug fix.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/modeling/core.py
Line number range: 1 - 500
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. """
4. This module defines base classes for all models.  The base class of all
5. models is `~astropy.modeling.Model`. `~astropy.modeling.FittableModel` is
6. the base class for all fittable models. Fittable models can be linear or
7. nonlinear in a regression analysis sense.
8. 
9. All models provide a `__call__` method which performs the transformation in
10. a purely mathematical way, i.e. the models are unitless.  Model instances can
11. represent either a single model, or a "model set" representing multiple copies
12. of the same type of model, but with potentially different values of the
13. parameters in each model making up the set.
14. """
15. 
16. 
17. import abc
18. import copy
19. import copyreg
20. import inspect
21. import functools
22. import operator
23. import sys
24. import types
25. import warnings
26. 
27. from collections import defaultdict, OrderedDict
28. from contextlib import suppress
29. from inspect import signature
30. from itertools import chain, islice
31. 
32. import numpy as np
33. 
34. from ..utils import indent, isinstancemethod, metadata
35. from ..table import Table
36. from ..units import Quantity, UnitsError, dimensionless_unscaled
37. from ..units.utils import quantity_asanyarray
38. from ..utils import (sharedmethod, find_current_module,
39.                      InheritDocstrings, OrderedDescriptorContainer,
40.                      check_broadcast, IncompatibleShapeError, isiterable)
41. from ..utils.codegen import make_function_with_signature
42. from ..utils.exceptions import AstropyDeprecationWarning
43. from .utils import (combine_labels, make_binary_operator_eval,
44.                     ExpressionTree, AliasDict, get_inputs_and_params,
45.                     _BoundingBox, _combine_equivalency_dict)
46. from ..nddata.utils import add_array, extract_array
47. 
48. from .parameters import Parameter, InputParameterError, param_repr_oneline
49. 
50. 
51. __all__ = ['Model', 'FittableModel', 'Fittable1DModel', 'Fittable2DModel',
52.            'custom_model', 'ModelDefinitionError']
53. 
54. 
55. class ModelDefinitionError(TypeError):
56.     """Used for incorrect models definitions"""
57. 
58. 
59. def _model_oper(oper, **kwargs):
60.     """
61.     Returns a function that evaluates a given Python arithmetic operator
62.     between two models.  The operator should be given as a string, like ``'+'``
63.     or ``'**'``.
64. 
65.     Any additional keyword arguments passed in are passed to
66.     `_CompoundModelMeta._from_operator`.
67.     """
68. 
69.     # Note: Originally this used functools.partial, but that won't work when
70.     # used in the class definition of _CompoundModelMeta since
71.     # _CompoundModelMeta has not been defined yet.
72. 
73.     # Perform an arithmetic operation on two models.
74.     return lambda left, right: _CompoundModelMeta._from_operator(oper,
75.             left, right, **kwargs)
76. 
77. 
78. class _ModelMeta(OrderedDescriptorContainer, InheritDocstrings, abc.ABCMeta):
79.     """
80.     Metaclass for Model.
81. 
82.     Currently just handles auto-generating the param_names list based on
83.     Parameter descriptors declared at the class-level of Model subclasses.
84.     """
85. 
86.     _is_dynamic = False
87.     """
88.     This flag signifies whether this class was created in the "normal" way,
89.     with a class statement in the body of a module, as opposed to a call to
90.     `type` or some other metaclass constructor, such that the resulting class
91.     does not belong to a specific module.  This is important for pickling of
92.     dynamic classes.
93. 
94.     This flag is always forced to False for new classes, so code that creates
95.     dynamic classes should manually set it to True on those classes when
96.     creating them.
97.     """
98. 
99.     # Default empty dict for _parameters_, which will be empty on model
100.     # classes that don't have any Parameters
101.     _parameters_ = OrderedDict()
102. 
103.     def __new__(mcls, name, bases, members):
104.         # See the docstring for _is_dynamic above
105.         if '_is_dynamic' not in members:
106.             members['_is_dynamic'] = mcls._is_dynamic
107. 
108.         return super().__new__(mcls, name, bases, members)
109. 
110.     def __init__(cls, name, bases, members):
111.         # Make sure OrderedDescriptorContainer gets to run before doing
112.         # anything else
113.         super().__init__(name, bases, members)
114. 
115.         if cls._parameters_:
116.             if hasattr(cls, '_param_names'):
117.                 # Slight kludge to support compound models, where
118.                 # cls.param_names is a property; could be improved with a
119.                 # little refactoring but fine for now
120.                 cls._param_names = tuple(cls._parameters_)
121.             else:
122.                 cls.param_names = tuple(cls._parameters_)
123. 
124.         cls._create_inverse_property(members)
125.         cls._create_bounding_box_property(members)
126.         cls._handle_special_methods(members)
127. 
128.     def __repr__(cls):
129.         """
130.         Custom repr for Model subclasses.
131.         """
132. 
133.         return cls._format_cls_repr()
134. 
135.     def _repr_pretty_(cls, p, cycle):
136.         """
137.         Repr for IPython's pretty printer.
138. 
139.         By default IPython "pretty prints" classes, so we need to implement
140.         this so that IPython displays the custom repr for Models.
141.         """
142. 
143.         p.text(repr(cls))
144. 
145.     def __reduce__(cls):
146.         if not cls._is_dynamic:
147.             # Just return a string specifying where the class can be imported
148.             # from
149.             return cls.__name__
150.         else:
151.             members = dict(cls.__dict__)
152.             # Delete any ABC-related attributes--these will be restored when
153.             # the class is reconstructed:
154.             for key in list(members):
155.                 if key.startswith('_abc_'):
156.                     del members[key]
157. 
158.             # Delete custom __init__ and __call__ if they exist:
159.             for key in ('__init__', '__call__'):
160.                 if key in members:
161.                     del members[key]
162. 
163.             return (type(cls), (cls.__name__, cls.__bases__, members))
164. 
165.     @property
166.     def name(cls):
167.         """
168.         The name of this model class--equivalent to ``cls.__name__``.
169. 
170.         This attribute is provided for symmetry with the `Model.name` attribute
171.         of model instances.
172.         """
173. 
174.         return cls.__name__
175. 
176.     @property
177.     def n_inputs(cls):
178.         return len(cls.inputs)
179. 
180.     @property
181.     def n_outputs(cls):
182.         return len(cls.outputs)
183. 
184.     @property
185.     def _is_concrete(cls):
186.         """
187.         A class-level property that determines whether the class is a concrete
188.         implementation of a Model--i.e. it is not some abstract base class or
189.         internal implementation detail (i.e. begins with '_').
190.         """
191.         return not (cls.__name__.startswith('_') or inspect.isabstract(cls))
192. 
193.     def rename(cls, name):
194.         """
195.         Creates a copy of this model class with a new name.
196. 
197.         The new class is technically a subclass of the original class, so that
198.         instance and type checks will still work.  For example::
199. 
200.             >>> from astropy.modeling.models import Rotation2D
201.             >>> SkyRotation = Rotation2D.rename('SkyRotation')
202.             >>> SkyRotation
203.             <class '__main__.SkyRotation'>
204.             Name: SkyRotation (Rotation2D)
205.             Inputs: ('x', 'y')
206.             Outputs: ('x', 'y')
207.             Fittable parameters: ('angle',)
208.             >>> issubclass(SkyRotation, Rotation2D)
209.             True
210.             >>> r = SkyRotation(90)
211.             >>> isinstance(r, Rotation2D)
212.             True
213.         """
214. 
215.         mod = find_current_module(2)
216.         if mod:
217.             modname = mod.__name__
218.         else:
219.             modname = '__main__'
220. 
221.         new_cls = type(name, (cls,), {})
222.         new_cls.__module__ = modname
223. 
224.         if hasattr(cls, '__qualname__'):
225.             if new_cls.__module__ == '__main__':
226.                 # __main__ is not added to a class's qualified name
227.                 new_cls.__qualname__ = name
228.             else:
229.                 new_cls.__qualname__ = '{0}.{1}'.format(modname, name)
230. 
231.         return new_cls
232. 
233.     def _create_inverse_property(cls, members):
234.         inverse = members.get('inverse')
235.         if inverse is None or cls.__bases__[0] is object:
236.             # The latter clause is the prevent the below code from running on
237.             # the Model base class, which implements the default getter and
238.             # setter for .inverse
239.             return
240. 
241.         if isinstance(inverse, property):
242.             # We allow the @property decorator to be omitted entirely from
243.             # the class definition, though its use should be encouraged for
244.             # clarity
245.             inverse = inverse.fget
246. 
247.         # Store the inverse getter internally, then delete the given .inverse
248.         # attribute so that cls.inverse resolves to Model.inverse instead
249.         cls._inverse = inverse
250.         del cls.inverse
251. 
252.     def _create_bounding_box_property(cls, members):
253.         """
254.         Takes any bounding_box defined on a concrete Model subclass (either
255.         as a fixed tuple or a property or method) and wraps it in the generic
256.         getter/setter interface for the bounding_box attribute.
257.         """
258. 
259.         # TODO: Much of this is verbatim from _create_inverse_property--I feel
260.         # like there could be a way to generify properties that work this way,
261.         # but for the time being that would probably only confuse things more.
262.         bounding_box = members.get('bounding_box')
263.         if bounding_box is None or cls.__bases__[0] is object:
264.             return
265. 
266.         if isinstance(bounding_box, property):
267.             bounding_box = bounding_box.fget
268. 
269.         if not callable(bounding_box):
270.             # See if it's a hard-coded bounding_box (as a sequence) and
271.             # normalize it
272.             try:
273.                 bounding_box = _BoundingBox.validate(cls, bounding_box)
274.             except ValueError as exc:
275.                 raise ModelDefinitionError(exc.args[0])
276.         else:
277.             sig = signature(bounding_box)
278.             # May be a method that only takes 'self' as an argument (like a
279.             # property, but the @property decorator was forgotten)
280.             # TODO: Maybe warn in the above case?
281.             #
282.             # However, if the method takes additional arguments then this is a
283.             # parameterized bounding box and should be callable
284.             if len(sig.parameters) > 1:
285.                 bounding_box = \
286.                         cls._create_bounding_box_subclass(bounding_box, sig)
287. 
288.         # See the Model.bounding_box getter definition for how this attribute
289.         # is used
290.         cls._bounding_box = bounding_box
291.         del cls.bounding_box
292. 
293.     def _create_bounding_box_subclass(cls, func, sig):
294.         """
295.         For Models that take optional arguments for defining their bounding
296.         box, we create a subclass of _BoundingBox with a ``__call__`` method
297.         that supports those additional arguments.
298. 
299.         Takes the function's Signature as an argument since that is already
300.         computed in _create_bounding_box_property, so no need to duplicate that
301.         effort.
302.         """
303. 
304.         # TODO: Might be convenient if calling the bounding box also
305.         # automatically sets the _user_bounding_box.  So that
306.         #
307.         #    >>> model.bounding_box(arg=1)
308.         #
309.         # in addition to returning the computed bbox, also sets it, so that
310.         # it's a shortcut for
311.         #
312.         #    >>> model.bounding_box = model.bounding_box(arg=1)
313.         #
314.         # Not sure if that would be non-obvious / confusing though...
315. 
316.         def __call__(self, **kwargs):
317.             return func(self._model, **kwargs)
318. 
319.         kwargs = []
320.         for idx, param in enumerate(sig.parameters.values()):
321.             if idx == 0:
322.                 # Presumed to be a 'self' argument
323.                 continue
324. 
325.             if param.default is param.empty:
326.                 raise ModelDefinitionError(
327.                     'The bounding_box method for {0} is not correctly '
328.                     'defined: If defined as a method all arguments to that '
329.                     'method (besides self) must be keyword arguments with '
330.                     'default values that can be used to compute a default '
331.                     'bounding box.'.format(cls.name))
332. 
333.             kwargs.append((param.name, param.default))
334. 
335.         __call__ = make_function_with_signature(__call__, ('self',), kwargs)
336. 
337.         return type(str('_{0}BoundingBox'.format(cls.name)), (_BoundingBox,),
338.                     {'__call__': __call__})
339. 
340.     def _handle_special_methods(cls, members):
341. 
342.         # Handle init creation from inputs
343.         def update_wrapper(wrapper, cls):
344.             # Set up the new __call__'s metadata attributes as though it were
345.             # manually defined in the class definition
346.             # A bit like functools.update_wrapper but uses the class instead of
347.             # the wrapped function
348.             wrapper.__module__ = cls.__module__
349.             wrapper.__doc__ = getattr(cls, wrapper.__name__).__doc__
350.             if hasattr(cls, '__qualname__'):
351.                 wrapper.__qualname__ = '{0}.{1}'.format(
352.                         cls.__qualname__, wrapper.__name__)
353. 
354.         if ('__call__' not in members and 'inputs' in members and
355.                 isinstance(members['inputs'], tuple)):
356. 
357.             # Don't create a custom __call__ for classes that already have one
358.             # explicitly defined (this includes the Model base class, and any
359.             # other classes that manually override __call__
360. 
361.             def __call__(self, *inputs, **kwargs):
362.                 """Evaluate this model on the supplied inputs."""
363.                 return super(cls, self).__call__(*inputs, **kwargs)
364. 
365.             # When called, models can take two optional keyword arguments:
366.             #
367.             # * model_set_axis, which indicates (for multi-dimensional input)
368.             #   which axis is used to indicate different models
369.             #
370.             # * equivalencies, a dictionary of equivalencies to be applied to
371.             #   the input values, where each key should correspond to one of
372.             #   the inputs.
373.             #
374.             # The following code creates the __call__ function with these
375.             # two keyword arguments.
376.             inputs = members['inputs']
377.             args = ('self',) + inputs
378.             new_call = make_function_with_signature(
379.                     __call__, args, [('model_set_axis', None),
380.                                      ('with_bounding_box', False),
381.                                      ('fill_value', np.nan),
382.                                      ('equivalencies', None)])
383. 
384.             # The following makes it look like __call__ was defined in the class
385.             update_wrapper(new_call, cls)
386. 
387.             cls.__call__ = new_call
388. 
389.         if ('__init__' not in members and not inspect.isabstract(cls) and
390.                 cls._parameters_):
391. 
392.             # If *all* the parameters have default values we can make them
393.             # keyword arguments; otherwise they must all be positional arguments
394.             if all(p.default is not None for p in cls._parameters_.values()):
395.                 args = ('self',)
396.                 kwargs = []
397.                 for param_name in cls.param_names:
398.                     default = cls._parameters_[param_name].default
399.                     unit = cls._parameters_[param_name].unit
400.                     # If the unit was specified in the parameter but the default
401.                     # is not a Quantity, attach the unit to the default.
402.                     if unit is not None:
403.                         default = Quantity(default, unit, copy=False)
404.                     kwargs.append((param_name, default))
405.             else:
406.                 args = ('self',) + cls.param_names
407.                 kwargs = {}
408. 
409.             def __init__(self, *params, **kwargs):
410.                 return super(cls, self).__init__(*params, **kwargs)
411. 
412.             new_init = make_function_with_signature(
413.                     __init__, args, kwargs, varkwargs='kwargs')
414.             update_wrapper(new_init, cls)
415.             cls.__init__ = new_init
416. 
417.     # *** Arithmetic operators for creating compound models ***
418.     __add__ = _model_oper('+')
419.     __sub__ = _model_oper('-')
420.     __mul__ = _model_oper('*')
421.     __truediv__ = _model_oper('/')
422.     __pow__ = _model_oper('**')
423.     __or__ = _model_oper('|')
424.     __and__ = _model_oper('&')
425. 
426.     # *** Other utilities ***
427. 
428.     def _format_cls_repr(cls, keywords=[]):
429.         """
430.         Internal implementation of ``__repr__``.
431. 
432.         This is separated out for ease of use by subclasses that wish to
433.         override the default ``__repr__`` while keeping the same basic
434.         formatting.
435.         """
436. 
437.         # For the sake of familiarity start the output with the standard class
438.         # __repr__
439.         parts = [super().__repr__()]
440. 
441.         if not cls._is_concrete:
442.             return parts[0]
443. 
444.         def format_inheritance(cls):
445.             bases = []
446.             for base in cls.mro()[1:]:
447.                 if not issubclass(base, Model):
448.                     continue
449.                 elif (inspect.isabstract(base) or
450.                         base.__name__.startswith('_')):
451.                     break
452.                 bases.append(base.name)
453.             if bases:
454.                 return '{0} ({1})'.format(cls.name, ' -> '.join(bases))
455.             else:
456.                 return cls.name
457. 
458.         try:
459.             default_keywords = [
460.                 ('Name', format_inheritance(cls)),
461.                 ('Inputs', cls.inputs),
462.                 ('Outputs', cls.outputs),
463.             ]
464. 
465.             if cls.param_names:
466.                 default_keywords.append(('Fittable parameters',
467.                                          cls.param_names))
468. 
469.             for keyword, value in default_keywords + keywords:
470.                 if value is not None:
471.                     parts.append('{0}: {1}'.format(keyword, value))
472. 
473.             return '\n'.join(parts)
474.         except Exception:
475.             # If any of the above formatting fails fall back on the basic repr
476.             # (this is particularly useful in debugging)
477.             return parts[0]
478. 
479. 
480. class Model(metaclass=_ModelMeta):
481.     """
482.     Base class for all models.
483. 
484.     This is an abstract class and should not be instantiated directly.
485. 
486.     This class sets the constraints and other properties for all individual
487.     parameters and performs parameter validation.
488. 
489.     The following initialization arguments apply to the majority of Model
490.     subclasses by default (exceptions include specialized utility models
491.     like `~astropy.modeling.mappings.Mapping`).  Parametric models take all
492.     their parameters as arguments, followed by any of the following optional
493.     keyword arguments:
494. 
495.     Parameters
496.     ----------
497.     name : str, optional
498.         A human-friendly name associated with this model instance
499.         (particularly useful for identifying the individual components of a
500.         compound model).

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:06:23,495 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file `astropy/modeling/core.py`. The provided context contains the first 500 lines of this file, which directly addresses the user's request.", relative_path='astropy/modeling/core.py', start_line=1, end_line=500)]
2025-12-21 19:06:23,497 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/modeling/core.py`.
2025-12-21 19:06:23,497 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:06:23,497 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:06:23,498 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-21 19:06:23,498 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 19:06:23,498 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   └── yacc.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: InheritDocstrings metaclass doesn't work for properties

Description: Inside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.

Patch information:
diff --git a/astropy/utils/misc.py b/astropy/utils/misc.py
index de3fb01d18..4d502fafed 100644
--- a/astropy/utils/misc.py
+++ b/astropy/utils/misc.py
@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
 
 class InheritDocstrings(type):
     """
-    This metaclass makes methods of a class automatically have their
-    docstrings filled in from the methods they override in the base
+    This metaclass makes methods and properties of a class automatically have their
+    docstrings filled in from the members they override in the base
     class.
 
     If the class uses multiple inheritance, the docstring will be
@@ -528,13 +528,24 @@ class InheritDocstrings(type):
                 not key.startswith('_'))
 
         for key, val in dct.items():
-            if (inspect.isfunction(val) and
+            if ((inspect.isfunction(val) or isinstance(val, property)) and
                 is_public_member(key) and
-                val.__doc__ is None):
+                getattr(val, '__doc__', None) is None):
                 for base in cls.__mro__[1:]:
-                    super_method = getattr(base, key, None)
-                    if super_method is not None:
-                        val.__doc__ = super_method.__doc__
+                    super_member = getattr(base, key, None)
+                    if super_member is not None and getattr(super_member, '__doc__', None) is not None:
+                        inherited_doc = super_member.__doc__
+                        if inspect.isfunction(val):
+                            val.__doc__ = inherited_doc
+                        else:
+                            try:
+                                val.__doc__ = inherited_doc
+                            except Exception:
+                                try:
+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)
+                                except Exception:
+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)
+                                setattr(cls, key, new_prop)
                         break
 
         super().__init__(name, bases, dct)


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/utils/misc.py`.
Extra Requirements: 
Purpose: This will allow me to see the original implementation of the `InheritDocstrings` metaclass and understand how the patch addresses the issue of inheriting docstrings for properties.

Previous refined query 2:
Essential Query: Please provide the full content of the file `astropy/modeling/core.py`.
Extra Requirements: 
Purpose: I need to examine how the `InheritDocstrings` metaclass is used, particularly in classes with properties, to understand the context of the bug fix.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/modeling/core.py
Line number range: 1 - 500
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. """
4. This module defines base classes for all models.  The base class of all
5. models is `~astropy.modeling.Model`. `~astropy.modeling.FittableModel` is
6. the base class for all fittable models. Fittable models can be linear or
7. nonlinear in a regression analysis sense.
8. 
9. All models provide a `__call__` method which performs the transformation in
10. a purely mathematical way, i.e. the models are unitless.  Model instances can
11. represent either a single model, or a "model set" representing multiple copies
12. of the same type of model, but with potentially different values of the
13. parameters in each model making up the set.
14. """
15. 
16. 
17. import abc
18. import copy
19. import copyreg
20. import inspect
21. import functools
22. import operator
23. import sys
24. import types
25. import warnings
26. 
27. from collections import defaultdict, OrderedDict
28. from contextlib import suppress
29. from inspect import signature
30. from itertools import chain, islice
31. 
32. import numpy as np
33. 
34. from ..utils import indent, isinstancemethod, metadata
35. from ..table import Table
36. from ..units import Quantity, UnitsError, dimensionless_unscaled
37. from ..units.utils import quantity_asanyarray
38. from ..utils import (sharedmethod, find_current_module,
39.                      InheritDocstrings, OrderedDescriptorContainer,
40.                      check_broadcast, IncompatibleShapeError, isiterable)
41. from ..utils.codegen import make_function_with_signature
42. from ..utils.exceptions import AstropyDeprecationWarning
43. from .utils import (combine_labels, make_binary_operator_eval,
44.                     ExpressionTree, AliasDict, get_inputs_and_params,
45.                     _BoundingBox, _combine_equivalency_dict)
46. from ..nddata.utils import add_array, extract_array
47. 
48. from .parameters import Parameter, InputParameterError, param_repr_oneline
49. 
50. 
51. __all__ = ['Model', 'FittableModel', 'Fittable1DModel', 'Fittable2DModel',
52.            'custom_model', 'ModelDefinitionError']
53. 
54. 
55. class ModelDefinitionError(TypeError):
56.     """Used for incorrect models definitions"""
57. 
58. 
59. def _model_oper(oper, **kwargs):
60.     """
61.     Returns a function that evaluates a given Python arithmetic operator
62.     between two models.  The operator should be given as a string, like ``'+'``
63.     or ``'**'``.
64. 
65.     Any additional keyword arguments passed in are passed to
66.     `_CompoundModelMeta._from_operator`.
67.     """
68. 
69.     # Note: Originally this used functools.partial, but that won't work when
70.     # used in the class definition of _CompoundModelMeta since
71.     # _CompoundModelMeta has not been defined yet.
72. 
73.     # Perform an arithmetic operation on two models.
74.     return lambda left, right: _CompoundModelMeta._from_operator(oper,
75.             left, right, **kwargs)
76. 
77. 
78. class _ModelMeta(OrderedDescriptorContainer, InheritDocstrings, abc.ABCMeta):
79.     """
80.     Metaclass for Model.
81. 
82.     Currently just handles auto-generating the param_names list based on
83.     Parameter descriptors declared at the class-level of Model subclasses.
84.     """
85. 
86.     _is_dynamic = False
87.     """
88.     This flag signifies whether this class was created in the "normal" way,
89.     with a class statement in the body of a module, as opposed to a call to
90.     `type` or some other metaclass constructor, such that the resulting class
91.     does not belong to a specific module.  This is important for pickling of
92.     dynamic classes.
93. 
94.     This flag is always forced to False for new classes, so code that creates
95.     dynamic classes should manually set it to True on those classes when
96.     creating them.
97.     """
98. 
99.     # Default empty dict for _parameters_, which will be empty on model
100.     # classes that don't have any Parameters
101.     _parameters_ = OrderedDict()
102. 
103.     def __new__(mcls, name, bases, members):
104.         # See the docstring for _is_dynamic above
105.         if '_is_dynamic' not in members:
106.             members['_is_dynamic'] = mcls._is_dynamic
107. 
108.         return super().__new__(mcls, name, bases, members)
109. 
110.     def __init__(cls, name, bases, members):
111.         # Make sure OrderedDescriptorContainer gets to run before doing
112.         # anything else
113.         super().__init__(name, bases, members)
114. 
115.         if cls._parameters_:
116.             if hasattr(cls, '_param_names'):
117.                 # Slight kludge to support compound models, where
118.                 # cls.param_names is a property; could be improved with a
119.                 # little refactoring but fine for now
120.                 cls._param_names = tuple(cls._parameters_)
121.             else:
122.                 cls.param_names = tuple(cls._parameters_)
123. 
124.         cls._create_inverse_property(members)
125.         cls._create_bounding_box_property(members)
126.         cls._handle_special_methods(members)
127. 
128.     def __repr__(cls):
129.         """
130.         Custom repr for Model subclasses.
131.         """
132. 
133.         return cls._format_cls_repr()
134. 
135.     def _repr_pretty_(cls, p, cycle):
136.         """
137.         Repr for IPython's pretty printer.
138. 
139.         By default IPython "pretty prints" classes, so we need to implement
140.         this so that IPython displays the custom repr for Models.
141.         """
142. 
143.         p.text(repr(cls))
144. 
145.     def __reduce__(cls):
146.         if not cls._is_dynamic:
147.             # Just return a string specifying where the class can be imported
148.             # from
149.             return cls.__name__
150.         else:
151.             members = dict(cls.__dict__)
152.             # Delete any ABC-related attributes--these will be restored when
153.             # the class is reconstructed:
154.             for key in list(members):
155.                 if key.startswith('_abc_'):
156.                     del members[key]
157. 
158.             # Delete custom __init__ and __call__ if they exist:
159.             for key in ('__init__', '__call__'):
160.                 if key in members:
161.                     del members[key]
162. 
163.             return (type(cls), (cls.__name__, cls.__bases__, members))
164. 
165.     @property
166.     def name(cls):
167.         """
168.         The name of this model class--equivalent to ``cls.__name__``.
169. 
170.         This attribute is provided for symmetry with the `Model.name` attribute
171.         of model instances.
172.         """
173. 
174.         return cls.__name__
175. 
176.     @property
177.     def n_inputs(cls):
178.         return len(cls.inputs)
179. 
180.     @property
181.     def n_outputs(cls):
182.         return len(cls.outputs)
183. 
184.     @property
185.     def _is_concrete(cls):
186.         """
187.         A class-level property that determines whether the class is a concrete
188.         implementation of a Model--i.e. it is not some abstract base class or
189.         internal implementation detail (i.e. begins with '_').
190.         """
191.         return not (cls.__name__.startswith('_') or inspect.isabstract(cls))
192. 
193.     def rename(cls, name):
194.         """
195.         Creates a copy of this model class with a new name.
196. 
197.         The new class is technically a subclass of the original class, so that
198.         instance and type checks will still work.  For example::
199. 
200.             >>> from astropy.modeling.models import Rotation2D
201.             >>> SkyRotation = Rotation2D.rename('SkyRotation')
202.             >>> SkyRotation
203.             <class '__main__.SkyRotation'>
204.             Name: SkyRotation (Rotation2D)
205.             Inputs: ('x', 'y')
206.             Outputs: ('x', 'y')
207.             Fittable parameters: ('angle',)
208.             >>> issubclass(SkyRotation, Rotation2D)
209.             True
210.             >>> r = SkyRotation(90)
211.             >>> isinstance(r, Rotation2D)
212.             True
213.         """
214. 
215.         mod = find_current_module(2)
216.         if mod:
217.             modname = mod.__name__
218.         else:
219.             modname = '__main__'
220. 
221.         new_cls = type(name, (cls,), {})
222.         new_cls.__module__ = modname
223. 
224.         if hasattr(cls, '__qualname__'):
225.             if new_cls.__module__ == '__main__':
226.                 # __main__ is not added to a class's qualified name
227.                 new_cls.__qualname__ = name
228.             else:
229.                 new_cls.__qualname__ = '{0}.{1}'.format(modname, name)
230. 
231.         return new_cls
232. 
233.     def _create_inverse_property(cls, members):
234.         inverse = members.get('inverse')
235.         if inverse is None or cls.__bases__[0] is object:
236.             # The latter clause is the prevent the below code from running on
237.             # the Model base class, which implements the default getter and
238.             # setter for .inverse
239.             return
240. 
241.         if isinstance(inverse, property):
242.             # We allow the @property decorator to be omitted entirely from
243.             # the class definition, though its use should be encouraged for
244.             # clarity
245.             inverse = inverse.fget
246. 
247.         # Store the inverse getter internally, then delete the given .inverse
248.         # attribute so that cls.inverse resolves to Model.inverse instead
249.         cls._inverse = inverse
250.         del cls.inverse
251. 
252.     def _create_bounding_box_property(cls, members):
253.         """
254.         Takes any bounding_box defined on a concrete Model subclass (either
255.         as a fixed tuple or a property or method) and wraps it in the generic
256.         getter/setter interface for the bounding_box attribute.
257.         """
258. 
259.         # TODO: Much of this is verbatim from _create_inverse_property--I feel
260.         # like there could be a way to generify properties that work this way,
261.         # but for the time being that would probably only confuse things more.
262.         bounding_box = members.get('bounding_box')
263.         if bounding_box is None or cls.__bases__[0] is object:
264.             return
265. 
266.         if isinstance(bounding_box, property):
267.             bounding_box = bounding_box.fget
268. 
269.         if not callable(bounding_box):
270.             # See if it's a hard-coded bounding_box (as a sequence) and
271.             # normalize it
272.             try:
273.                 bounding_box = _BoundingBox.validate(cls, bounding_box)
274.             except ValueError as exc:
275.                 raise ModelDefinitionError(exc.args[0])
276.         else:
277.             sig = signature(bounding_box)
278.             # May be a method that only takes 'self' as an argument (like a
279.             # property, but the @property decorator was forgotten)
280.             # TODO: Maybe warn in the above case?
281.             #
282.             # However, if the method takes additional arguments then this is a
283.             # parameterized bounding box and should be callable
284.             if len(sig.parameters) > 1:
285.                 bounding_box = \
286.                         cls._create_bounding_box_subclass(bounding_box, sig)
287. 
288.         # See the Model.bounding_box getter definition for how this attribute
289.         # is used
290.         cls._bounding_box = bounding_box
291.         del cls.bounding_box
292. 
293.     def _create_bounding_box_subclass(cls, func, sig):
294.         """
295.         For Models that take optional arguments for defining their bounding
296.         box, we create a subclass of _BoundingBox with a ``__call__`` method
297.         that supports those additional arguments.
298. 
299.         Takes the function's Signature as an argument since that is already
300.         computed in _create_bounding_box_property, so no need to duplicate that
301.         effort.
302.         """
303. 
304.         # TODO: Might be convenient if calling the bounding box also
305.         # automatically sets the _user_bounding_box.  So that
306.         #
307.         #    >>> model.bounding_box(arg=1)
308.         #
309.         # in addition to returning the computed bbox, also sets it, so that
310.         # it's a shortcut for
311.         #
312.         #    >>> model.bounding_box = model.bounding_box(arg=1)
313.         #
314.         # Not sure if that would be non-obvious / confusing though...
315. 
316.         def __call__(self, **kwargs):
317.             return func(self._model, **kwargs)
318. 
319.         kwargs = []
320.         for idx, param in enumerate(sig.parameters.values()):
321.             if idx == 0:
322.                 # Presumed to be a 'self' argument
323.                 continue
324. 
325.             if param.default is param.empty:
326.                 raise ModelDefinitionError(
327.                     'The bounding_box method for {0} is not correctly '
328.                     'defined: If defined as a method all arguments to that '
329.                     'method (besides self) must be keyword arguments with '
330.                     'default values that can be used to compute a default '
331.                     'bounding box.'.format(cls.name))
332. 
333.             kwargs.append((param.name, param.default))
334. 
335.         __call__ = make_function_with_signature(__call__, ('self',), kwargs)
336. 
337.         return type(str('_{0}BoundingBox'.format(cls.name)), (_BoundingBox,),
338.                     {'__call__': __call__})
339. 
340.     def _handle_special_methods(cls, members):
341. 
342.         # Handle init creation from inputs
343.         def update_wrapper(wrapper, cls):
344.             # Set up the new __call__'s metadata attributes as though it were
345.             # manually defined in the class definition
346.             # A bit like functools.update_wrapper but uses the class instead of
347.             # the wrapped function
348.             wrapper.__module__ = cls.__module__
349.             wrapper.__doc__ = getattr(cls, wrapper.__name__).__doc__
350.             if hasattr(cls, '__qualname__'):
351.                 wrapper.__qualname__ = '{0}.{1}'.format(
352.                         cls.__qualname__, wrapper.__name__)
353. 
354.         if ('__call__' not in members and 'inputs' in members and
355.                 isinstance(members['inputs'], tuple)):
356. 
357.             # Don't create a custom __call__ for classes that already have one
358.             # explicitly defined (this includes the Model base class, and any
359.             # other classes that manually override __call__
360. 
361.             def __call__(self, *inputs, **kwargs):
362.                 """Evaluate this model on the supplied inputs."""
363.                 return super(cls, self).__call__(*inputs, **kwargs)
364. 
365.             # When called, models can take two optional keyword arguments:
366.             #
367.             # * model_set_axis, which indicates (for multi-dimensional input)
368.             #   which axis is used to indicate different models
369.             #
370.             # * equivalencies, a dictionary of equivalencies to be applied to
371.             #   the input values, where each key should correspond to one of
372.             #   the inputs.
373.             #
374.             # The following code creates the __call__ function with these
375.             # two keyword arguments.
376.             inputs = members['inputs']
377.             args = ('self',) + inputs
378.             new_call = make_function_with_signature(
379.                     __call__, args, [('model_set_axis', None),
380.                                      ('with_bounding_box', False),
381.                                      ('fill_value', np.nan),
382.                                      ('equivalencies', None)])
383. 
384.             # The following makes it look like __call__ was defined in the class
385.             update_wrapper(new_call, cls)
386. 
387.             cls.__call__ = new_call
388. 
389.         if ('__init__' not in members and not inspect.isabstract(cls) and
390.                 cls._parameters_):
391. 
392.             # If *all* the parameters have default values we can make them
393.             # keyword arguments; otherwise they must all be positional arguments
394.             if all(p.default is not None for p in cls._parameters_.values()):
395.                 args = ('self',)
396.                 kwargs = []
397.                 for param_name in cls.param_names:
398.                     default = cls._parameters_[param_name].default
399.                     unit = cls._parameters_[param_name].unit
400.                     # If the unit was specified in the parameter but the default
401.                     # is not a Quantity, attach the unit to the default.
402.                     if unit is not None:
403.                         default = Quantity(default, unit, copy=False)
404.                     kwargs.append((param_name, default))
405.             else:
406.                 args = ('self',) + cls.param_names
407.                 kwargs = {}
408. 
409.             def __init__(self, *params, **kwargs):
410.                 return super(cls, self).__init__(*params, **kwargs)
411. 
412.             new_init = make_function_with_signature(
413.                     __init__, args, kwargs, varkwargs='kwargs')
414.             update_wrapper(new_init, cls)
415.             cls.__init__ = new_init
416. 
417.     # *** Arithmetic operators for creating compound models ***
418.     __add__ = _model_oper('+')
419.     __sub__ = _model_oper('-')
420.     __mul__ = _model_oper('*')
421.     __truediv__ = _model_oper('/')
422.     __pow__ = _model_oper('**')
423.     __or__ = _model_oper('|')
424.     __and__ = _model_oper('&')
425. 
426.     # *** Other utilities ***
427. 
428.     def _format_cls_repr(cls, keywords=[]):
429.         """
430.         Internal implementation of ``__repr__``.
431. 
432.         This is separated out for ease of use by subclasses that wish to
433.         override the default ``__repr__`` while keeping the same basic
434.         formatting.
435.         """
436. 
437.         # For the sake of familiarity start the output with the standard class
438.         # __repr__
439.         parts = [super().__repr__()]
440. 
441.         if not cls._is_concrete:
442.             return parts[0]
443. 
444.         def format_inheritance(cls):
445.             bases = []
446.             for base in cls.mro()[1:]:
447.                 if not issubclass(base, Model):
448.                     continue
449.                 elif (inspect.isabstract(base) or
450.                         base.__name__.startswith('_')):
451.                     break
452.                 bases.append(base.name)
453.             if bases:
454.                 return '{0} ({1})'.format(cls.name, ' -> '.join(bases))
455.             else:
456.                 return cls.name
457. 
458.         try:
459.             default_keywords = [
460.                 ('Name', format_inheritance(cls)),
461.                 ('Inputs', cls.inputs),
462.                 ('Outputs', cls.outputs),
463.             ]
464. 
465.             if cls.param_names:
466.                 default_keywords.append(('Fittable parameters',
467.                                          cls.param_names))
468. 
469.             for keyword, value in default_keywords + keywords:
470.                 if value is not None:
471.                     parts.append('{0}: {1}'.format(keyword, value))
472. 
473.             return '\n'.join(parts)
474.         except Exception:
475.             # If any of the above formatting fails fall back on the basic repr
476.             # (this is particularly useful in debugging)
477.             return parts[0]
478. 
479. 
480. class Model(metaclass=_ModelMeta):
481.     """
482.     Base class for all models.
483. 
484.     This is an abstract class and should not be instantiated directly.
485. 
486.     This class sets the constraints and other properties for all individual
487.     parameters and performs parameter validation.
488. 
489.     The following initialization arguments apply to the majority of Model
490.     subclasses by default (exceptions include specialized utility models
491.     like `~astropy.modeling.mappings.Mapping`).  Parametric models take all
492.     their parameters as arguments, followed by any of the following optional
493.     keyword arguments:
494. 
495.     Parameters
496.     ----------
497.     name : str, optional
498.         A human-friendly name associated with this model instance
499.         (particularly useful for identifying the individual components of a
500.         compound model).


File: astropy/utils/misc.py
Line number range: 1 - 1129
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. """
4. A "grab bag" of relatively small general-purpose utilities that don't have
5. a clear module/package to live in.
6. """
7. 
8. 
9. 
10. import abc
11. import contextlib
12. import difflib
13. import inspect
14. import json
15. import os
16. import signal
17. import sys
18. import traceback
19. import unicodedata
20. import locale
21. import threading
22. import re
23. import urllib.request
24. 
25. from itertools import zip_longest
26. from contextlib import contextmanager
27. from collections import defaultdict, OrderedDict
28. 
29. 
30. 
31. __all__ = ['isiterable', 'silence', 'format_exception', 'NumpyRNGContext',
32.            'find_api_page', 'is_path_hidden', 'walk_skip_hidden',
33.            'JsonCustomEncoder', 'indent', 'InheritDocstrings',
34.            'OrderedDescriptor', 'OrderedDescriptorContainer', 'set_locale',
35.            'ShapedLikeNDArray', 'check_broadcast', 'IncompatibleShapeError',
36.            'dtype_bytes_or_chars']
37. 
38. 
39. def isiterable(obj):
40.     """Returns `True` if the given object is iterable."""
41. 
42.     try:
43.         iter(obj)
44.         return True
45.     except TypeError:
46.         return False
47. 
48. 
49. def indent(s, shift=1, width=4):
50.     """Indent a block of text.  The indentation is applied to each line."""
51. 
52.     indented = '\n'.join(' ' * (width * shift) + l if l else ''
53.                          for l in s.splitlines())
54.     if s[-1] == '\n':
55.         indented += '\n'
56. 
57.     return indented
58. 
59. 
60. class _DummyFile:
61.     """A noop writeable object."""
62. 
63.     def write(self, s):
64.         pass
65. 
66. 
67. @contextlib.contextmanager
68. def silence():
69.     """A context manager that silences sys.stdout and sys.stderr."""
70. 
71.     old_stdout = sys.stdout
72.     old_stderr = sys.stderr
73.     sys.stdout = _DummyFile()
74.     sys.stderr = _DummyFile()
75.     yield
76.     sys.stdout = old_stdout
77.     sys.stderr = old_stderr
78. 
79. 
80. def format_exception(msg, *args, **kwargs):
81.     """
82.     Given an exception message string, uses new-style formatting arguments
83.     ``{filename}``, ``{lineno}``, ``{func}`` and/or ``{text}`` to fill in
84.     information about the exception that occurred.  For example:
85. 
86.         try:
87.             1/0
88.         except:
89.             raise ZeroDivisionError(
90.                 format_except('A divide by zero occurred in {filename} at '
91.                               'line {lineno} of function {func}.'))
92. 
93.     Any additional positional or keyword arguments passed to this function are
94.     also used to format the message.
95. 
96.     .. note::
97.         This uses `sys.exc_info` to gather up the information needed to fill
98.         in the formatting arguments. Since `sys.exc_info` is not carried
99.         outside a handled exception, it's not wise to use this
100.         outside of an ``except`` clause - if it is, this will substitute
101.         '<unkown>' for the 4 formatting arguments.
102.     """
103. 
104.     tb = traceback.extract_tb(sys.exc_info()[2], limit=1)
105.     if len(tb) > 0:
106.         filename, lineno, func, text = tb[0]
107.     else:
108.         filename = lineno = func = text = '<unknown>'
109. 
110.     return msg.format(*args, filename=filename, lineno=lineno, func=func,
111.                       text=text, **kwargs)
112. 
113. 
114. class NumpyRNGContext:
115.     """
116.     A context manager (for use with the ``with`` statement) that will seed the
117.     numpy random number generator (RNG) to a specific value, and then restore
118.     the RNG state back to whatever it was before.
119. 
120.     This is primarily intended for use in the astropy testing suit, but it
121.     may be useful in ensuring reproducibility of Monte Carlo simulations in a
122.     science context.
123. 
124.     Parameters
125.     ----------
126.     seed : int
127.         The value to use to seed the numpy RNG
128. 
129.     Examples
130.     --------
131.     A typical use case might be::
132. 
133.         with NumpyRNGContext(<some seed value you pick>):
134.             from numpy import random
135. 
136.             randarr = random.randn(100)
137.             ... run your test using `randarr` ...
138. 
139.         #Any code using numpy.random at this indent level will act just as it
140.         #would have if it had been before the with statement - e.g. whatever
141.         #the default seed is.
142. 
143. 
144.     """
145. 
146.     def __init__(self, seed):
147.         self.seed = seed
148. 
149.     def __enter__(self):
150.         from numpy import random
151. 
152.         self.startstate = random.get_state()
153.         random.seed(self.seed)
154. 
155.     def __exit__(self, exc_type, exc_value, traceback):
156.         from numpy import random
157. 
158.         random.set_state(self.startstate)
159. 
160. 
161. def find_api_page(obj, version=None, openinbrowser=True, timeout=None):
162.     """
163.     Determines the URL of the API page for the specified object, and
164.     optionally open that page in a web browser.
165. 
166.     .. note::
167.         You must be connected to the internet for this to function even if
168.         ``openinbrowser`` is `False`, unless you provide a local version of
169.         the documentation to ``version`` (e.g., ``file:///path/to/docs``).
170. 
171.     Parameters
172.     ----------
173.     obj
174.         The object to open the docs for or its fully-qualified name
175.         (as a str).
176.     version : str
177.         The doc version - either a version number like '0.1', 'dev' for
178.         the development/latest docs, or a URL to point to a specific
179.         location that should be the *base* of the documentation. Defaults to
180.         latest if you are on aren't on a release, otherwise, the version you
181.         are on.
182.     openinbrowser : bool
183.         If `True`, the `webbrowser` package will be used to open the doc
184.         page in a new web browser window.
185.     timeout : number, optional
186.         The number of seconds to wait before timing-out the query to
187.         the astropy documentation.  If not given, the default python
188.         stdlib timeout will be used.
189. 
190.     Returns
191.     -------
192.     url : str
193.         The loaded URL
194. 
195.     Raises
196.     ------
197.     ValueError
198.         If the documentation can't be found
199. 
200.     """
201.     import webbrowser
202. 
203.     from zlib import decompress
204. 
205.     if (not isinstance(obj, str) and
206.             hasattr(obj, '__module__') and
207.             hasattr(obj, '__name__')):
208.         obj = obj.__module__ + '.' + obj.__name__
209.     elif inspect.ismodule(obj):
210.         obj = obj.__name__
211. 
212.     if version is None:
213.         from .. import version
214. 
215.         if version.release:
216.             version = 'v' + version.version
217.         else:
218.             version = 'dev'
219. 
220.     if '://' in version:
221.         if version.endswith('index.html'):
222.             baseurl = version[:-10]
223.         elif version.endswith('/'):
224.             baseurl = version
225.         else:
226.             baseurl = version + '/'
227.     elif version == 'dev' or version == 'latest':
228.         baseurl = 'http://devdocs.astropy.org/'
229.     else:
230.         baseurl = 'http://docs.astropy.org/en/{vers}/'.format(vers=version)
231. 
232.     if timeout is None:
233.         uf = urllib.request.urlopen(baseurl + 'objects.inv')
234.     else:
235.         uf = urllib.request.urlopen(baseurl + 'objects.inv', timeout=timeout)
236. 
237.     try:
238.         oiread = uf.read()
239. 
240.         # need to first read/remove the first four lines, which have info before
241.         # the compressed section with the actual object inventory
242.         idx = -1
243.         headerlines = []
244.         for _ in range(4):
245.             oldidx = idx
246.             idx = oiread.index(b'\n', oldidx + 1)
247.             headerlines.append(oiread[(oldidx+1):idx].decode('utf-8'))
248. 
249.         # intersphinx version line, project name, and project version
250.         ivers, proj, vers, compr = headerlines
251.         if 'The remainder of this file is compressed using zlib' not in compr:
252.             raise ValueError('The file downloaded from {0} does not seem to be'
253.                              'the usual Sphinx objects.inv format.  Maybe it '
254.                              'has changed?'.format(baseurl + 'objects.inv'))
255. 
256.         compressed = oiread[(idx+1):]
257.     finally:
258.         uf.close()
259. 
260.     decompressed = decompress(compressed).decode('utf-8')
261. 
262.     resurl = None
263. 
264.     for l in decompressed.strip().splitlines():
265.         ls = l.split()
266.         name = ls[0]
267.         loc = ls[3]
268.         if loc.endswith('$'):
269.             loc = loc[:-1] + name
270. 
271.         if name == obj:
272.             resurl = baseurl + loc
273.             break
274. 
275.     if resurl is None:
276.         raise ValueError('Could not find the docs for the object {obj}'.format(obj=obj))
277.     elif openinbrowser:
278.         webbrowser.open(resurl)
279. 
280.     return resurl
281. 
282. 
283. def signal_number_to_name(signum):
284.     """
285.     Given an OS signal number, returns a signal name.  If the signal
286.     number is unknown, returns ``'UNKNOWN'``.
287.     """
288.     # Since these numbers and names are platform specific, we use the
289.     # builtin signal module and build a reverse mapping.
290. 
291.     signal_to_name_map = dict((k, v) for v, k in signal.__dict__.items()
292.                               if v.startswith('SIG'))
293. 
294.     return signal_to_name_map.get(signum, 'UNKNOWN')
295. 
296. 
297. if sys.platform == 'win32':
298.     import ctypes
299. 
300.     def _has_hidden_attribute(filepath):
301.         """
302.         Returns True if the given filepath has the hidden attribute on
303.         MS-Windows.  Based on a post here:
304.         http://stackoverflow.com/questions/284115/cross-platform-hidden-file-detection
305.         """
306.         if isinstance(filepath, bytes):
307.             filepath = filepath.decode(sys.getfilesystemencoding())
308.         try:
309.             attrs = ctypes.windll.kernel32.GetFileAttributesW(filepath)
310.             result = bool(attrs & 2) and attrs != -1
311.         except AttributeError:
312.             result = False
313.         return result
314. else:
315.     def _has_hidden_attribute(filepath):
316.         return False
317. 
318. 
319. def is_path_hidden(filepath):
320.     """
321.     Determines if a given file or directory is hidden.
322. 
323.     Parameters
324.     ----------
325.     filepath : str
326.         The path to a file or directory
327. 
328.     Returns
329.     -------
330.     hidden : bool
331.         Returns `True` if the file is hidden
332.     """
333.     name = os.path.basename(os.path.abspath(filepath))
334.     if isinstance(name, bytes):
335.         is_dotted = name.startswith(b'.')
336.     else:
337.         is_dotted = name.startswith('.')
338.     return is_dotted or _has_hidden_attribute(filepath)
339. 
340. 
341. def walk_skip_hidden(top, onerror=None, followlinks=False):
342.     """
343.     A wrapper for `os.walk` that skips hidden files and directories.
344. 
345.     This function does not have the parameter ``topdown`` from
346.     `os.walk`: the directories must always be recursed top-down when
347.     using this function.
348. 
349.     See also
350.     --------
351.     os.walk : For a description of the parameters
352.     """
353.     for root, dirs, files in os.walk(
354.             top, topdown=True, onerror=onerror,
355.             followlinks=followlinks):
356.         # These lists must be updated in-place so os.walk will skip
357.         # hidden directories
358.         dirs[:] = [d for d in dirs if not is_path_hidden(d)]
359.         files[:] = [f for f in files if not is_path_hidden(f)]
360.         yield root, dirs, files
361. 
362. 
363. class JsonCustomEncoder(json.JSONEncoder):
364.     """Support for data types that JSON default encoder
365.     does not do.
366. 
367.     This includes:
368. 
369.         * Numpy array or number
370.         * Complex number
371.         * Set
372.         * Bytes
373.         * astropy.UnitBase
374.         * astropy.Quantity
375. 
376.     Examples
377.     --------
378.     >>> import json
379.     >>> import numpy as np
380.     >>> from astropy.utils.misc import JsonCustomEncoder
381.     >>> json.dumps(np.arange(3), cls=JsonCustomEncoder)
382.     '[0, 1, 2]'
383. 
384.     """
385. 
386.     def default(self, obj):
387.         from .. import units as u
388.         import numpy as np
389.         if isinstance(obj, u.Quantity):
390.             return dict(value=obj.value, unit=obj.unit.to_string())
391.         if isinstance(obj, (np.number, np.ndarray)):
392.             return obj.tolist()
393.         elif isinstance(obj, complex):
394.             return [obj.real, obj.imag]
395.         elif isinstance(obj, set):
396.             return list(obj)
397.         elif isinstance(obj, bytes):  # pragma: py3
398.             return obj.decode()
399.         elif isinstance(obj, (u.UnitBase, u.FunctionUnitBase)):
400.             if obj == u.dimensionless_unscaled:
401.                 obj = 'dimensionless_unit'
402.             else:
403.                 return obj.to_string()
404. 
405.         return json.JSONEncoder.default(self, obj)
406. 
407. 
408. def strip_accents(s):
409.     """
410.     Remove accents from a Unicode string.
411. 
412.     This helps with matching "ångström" to "angstrom", for example.
413.     """
414.     return ''.join(
415.         c for c in unicodedata.normalize('NFD', s)
416.         if unicodedata.category(c) != 'Mn')
417. 
418. 
419. def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):
420.     """
421.     When a string isn't found in a set of candidates, we can be nice
422.     to provide a list of alternatives in the exception.  This
423.     convenience function helps to format that part of the exception.
424. 
425.     Parameters
426.     ----------
427.     s : str
428. 
429.     candidates : sequence of str or dict of str keys
430. 
431.     n : int
432.         The maximum number of results to include.  See
433.         `difflib.get_close_matches`.
434. 
435.     cutoff : float
436.         In the range [0, 1]. Possibilities that don't score at least
437.         that similar to word are ignored.  See
438.         `difflib.get_close_matches`.
439. 
440.     fix : callable
441.         A callable to modify the results after matching.  It should
442.         take a single string and return a sequence of strings
443.         containing the fixed matches.
444. 
445.     Returns
446.     -------
447.     message : str
448.         Returns the string "Did you mean X, Y, or Z?", or the empty
449.         string if no alternatives were found.
450.     """
451.     if isinstance(s, str):
452.         s = strip_accents(s)
453.     s_lower = s.lower()
454. 
455.     # Create a mapping from the lower case name to all capitalization
456.     # variants of that name.
457.     candidates_lower = {}
458.     for candidate in candidates:
459.         candidate_lower = candidate.lower()
460.         candidates_lower.setdefault(candidate_lower, [])
461.         candidates_lower[candidate_lower].append(candidate)
462. 
463.     # The heuristic here is to first try "singularizing" the word.  If
464.     # that doesn't match anything use difflib to find close matches in
465.     # original, lower and upper case.
466.     if s_lower.endswith('s') and s_lower[:-1] in candidates_lower:
467.         matches = [s_lower[:-1]]
468.     else:
469.         matches = difflib.get_close_matches(
470.             s_lower, candidates_lower, n=n, cutoff=cutoff)
471. 
472.     if len(matches):
473.         capitalized_matches = set()
474.         for match in matches:
475.             capitalized_matches.update(candidates_lower[match])
476.         matches = capitalized_matches
477. 
478.         if fix is not None:
479.             mapped_matches = []
480.             for match in matches:
481.                 mapped_matches.extend(fix(match))
482.             matches = mapped_matches
483. 
484.         matches = list(set(matches))
485.         matches = sorted(matches)
486. 
487.         if len(matches) == 1:
488.             matches = matches[0]
489.         else:
490.             matches = (', '.join(matches[:-1]) + ' or ' +
491.                        matches[-1])
492.         return 'Did you mean {0}?'.format(matches)
493. 
494.     return ''
495. 
496. 
497. class InheritDocstrings(type):
498.     """
499.     This metaclass makes methods of a class automatically have their
500.     docstrings filled in from the methods they override in the base
501.     class.
502. 
503.     If the class uses multiple inheritance, the docstring will be
504.     chosen from the first class in the bases list, in the same way as
505.     methods are normally resolved in Python.  If this results in
506.     selecting the wrong docstring, the docstring will need to be
507.     explicitly included on the method.
508. 
509.     For example::
510. 
511.         >>> from astropy.utils.misc import InheritDocstrings
512.         >>> class A(metaclass=InheritDocstrings):
513.         ...     def wiggle(self):
514.         ...         "Wiggle the thingamajig"
515.         ...         pass
516.         >>> class B(A):
517.         ...     def wiggle(self):
518.         ...         pass
519.         >>> B.wiggle.__doc__
520.         u'Wiggle the thingamajig'
521.     """
522. 
523.     def __init__(cls, name, bases, dct):
524.         def is_public_member(key):
525.             return (
526.                 (key.startswith('__') and key.endswith('__')
527.                  and len(key) > 4) or
528.                 not key.startswith('_'))
529. 
530.         for key, val in dct.items():
531.             if (inspect.isfunction(val) and
532.                 is_public_member(key) and
533.                 val.__doc__ is None):
534.                 for base in cls.__mro__[1:]:
535.                     super_method = getattr(base, key, None)
536.                     if super_method is not None:
537.                         val.__doc__ = super_method.__doc__
538.                         break
539. 
540.         super().__init__(name, bases, dct)
541. 
542. 
543. class OrderedDescriptor(metaclass=abc.ABCMeta):
544.     """
545.     Base class for descriptors whose order in the class body should be
546.     preserved.  Intended for use in concert with the
547.     `OrderedDescriptorContainer` metaclass.
548. 
549.     Subclasses of `OrderedDescriptor` must define a value for a class attribute
550.     called ``_class_attribute_``.  This is the name of a class attribute on the
551.     *container* class for these descriptors, which will be set to an
552.     `~collections.OrderedDict` at class creation time.  This
553.     `~collections.OrderedDict` will contain a mapping of all class attributes
554.     that were assigned instances of the `OrderedDescriptor` subclass, to the
555.     instances themselves.  See the documentation for
556.     `OrderedDescriptorContainer` for a concrete example.
557. 
558.     Optionally, subclasses of `OrderedDescriptor` may define a value for a
559.     class attribute called ``_name_attribute_``.  This should be the name of
560.     an attribute on instances of the subclass.  When specified, during
561.     creation of a class containing these descriptors, the name attribute on
562.     each instance will be set to the name of the class attribute it was
563.     assigned to on the class.
564. 
565.     .. note::
566. 
567.         Although this class is intended for use with *descriptors* (i.e.
568.         classes that define any of the ``__get__``, ``__set__``, or
569.         ``__delete__`` magic methods), this base class is not itself a
570.         descriptor, and technically this could be used for classes that are
571.         not descriptors too.  However, use with descriptors is the original
572.         intended purpose.
573.     """
574. 
575.     # This id increments for each OrderedDescriptor instance created, so they
576.     # are always ordered in the order they were created.  Class bodies are
577.     # guaranteed to be executed from top to bottom.  Not sure if this is
578.     # thread-safe though.
579.     _nextid = 1
580. 
581.     @property
582.     @abc.abstractmethod
583.     def _class_attribute_(self):
584.         """
585.         Subclasses should define this attribute to the name of an attribute on
586.         classes containing this subclass.  That attribute will contain the mapping
587.         of all instances of that `OrderedDescriptor` subclass defined in the class
588.         body.  If the same descriptor needs to be used with different classes,
589.         each with different names of this attribute, multiple subclasses will be
590.         needed.
591.         """
592. 
593.     _name_attribute_ = None
594.     """
595.     Subclasses may optionally define this attribute to specify the name of an
596.     attribute on instances of the class that should be filled with the
597.     instance's attribute name at class creation time.
598.     """
599. 
600.     def __init__(self, *args, **kwargs):
601.         # The _nextid attribute is shared across all subclasses so that
602.         # different subclasses of OrderedDescriptors can be sorted correctly
603.         # between themselves
604.         self.__order = OrderedDescriptor._nextid
605.         OrderedDescriptor._nextid += 1
606.         super().__init__()
607. 
608.     def __lt__(self, other):
609.         """
610.         Defined for convenient sorting of `OrderedDescriptor` instances, which
611.         are defined to sort in their creation order.
612.         """
613. 
614.         if (isinstance(self, OrderedDescriptor) and
615.                 isinstance(other, OrderedDescriptor)):
616.             try:
617.                 return self.__order < other.__order
618.             except AttributeError:
619.                 raise RuntimeError(
620.                     'Could not determine ordering for {0} and {1}; at least '
621.                     'one of them is not calling super().__init__ in its '
622.                     '__init__.'.format(self, other))
623.         else:
624.             return NotImplemented
625. 
626. 
627. class OrderedDescriptorContainer(type):
628.     """
629.     Classes should use this metaclass if they wish to use `OrderedDescriptor`
630.     attributes, which are class attributes that "remember" the order in which
631.     they were defined in the class body.
632. 
633.     Every subclass of `OrderedDescriptor` has an attribute called
634.     ``_class_attribute_``.  For example, if we have
635. 
636.     .. code:: python
637. 
638.         class ExampleDecorator(OrderedDescriptor):
639.             _class_attribute_ = '_examples_'
640. 
641.     Then when a class with the `OrderedDescriptorContainer` metaclass is
642.     created, it will automatically be assigned a class attribute ``_examples_``
643.     referencing an `~collections.OrderedDict` containing all instances of
644.     ``ExampleDecorator`` defined in the class body, mapped to by the names of
645.     the attributes they were assigned to.
646. 
647.     When subclassing a class with this metaclass, the descriptor dict (i.e.
648.     ``_examples_`` in the above example) will *not* contain descriptors
649.     inherited from the base class.  That is, this only works by default with
650.     decorators explicitly defined in the class body.  However, the subclass
651.     *may* define an attribute ``_inherit_decorators_`` which lists
652.     `OrderedDescriptor` classes that *should* be added from base classes.
653.     See the examples section below for an example of this.
654. 
655.     Examples
656.     --------
657. 
658.     >>> from astropy.utils import OrderedDescriptor, OrderedDescriptorContainer
659.     >>> class TypedAttribute(OrderedDescriptor):
660.     ...     \"\"\"
661.     ...     Attributes that may only be assigned objects of a specific type,
662.     ...     or subclasses thereof.  For some reason we care about their order.
663.     ...     \"\"\"
664.     ...
665.     ...     _class_attribute_ = 'typed_attributes'
666.     ...     _name_attribute_ = 'name'
667.     ...     # A default name so that instances not attached to a class can
668.     ...     # still be repr'd; useful for debugging
669.     ...     name = '<unbound>'
670.     ...
671.     ...     def __init__(self, type):
672.     ...         # Make sure not to forget to call the super __init__
673.     ...         super().__init__()
674.     ...         self.type = type
675.     ...
676.     ...     def __get__(self, obj, objtype=None):
677.     ...         if obj is None:
678.     ...             return self
679.     ...         if self.name in obj.__dict__:
680.     ...             return obj.__dict__[self.name]
681.     ...         else:
682.     ...             raise AttributeError(self.name)
683.     ...
684.     ...     def __set__(self, obj, value):
685.     ...         if not isinstance(value, self.type):
686.     ...             raise ValueError('{0}.{1} must be of type {2!r}'.format(
687.     ...                 obj.__class__.__name__, self.name, self.type))
688.     ...         obj.__dict__[self.name] = value
689.     ...
690.     ...     def __delete__(self, obj):
691.     ...         if self.name in obj.__dict__:
692.     ...             del obj.__dict__[self.name]
693.     ...         else:
694.     ...             raise AttributeError(self.name)
695.     ...
696.     ...     def __repr__(self):
697.     ...         if isinstance(self.type, tuple) and len(self.type) > 1:
698.     ...             typestr = '({0})'.format(
699.     ...                 ', '.join(t.__name__ for t in self.type))
700.     ...         else:
701.     ...             typestr = self.type.__name__
702.     ...         return '<{0}(name={1}, type={2})>'.format(
703.     ...                 self.__class__.__name__, self.name, typestr)
704.     ...
705. 
706.     Now let's create an example class that uses this ``TypedAttribute``::
707. 
708.         >>> class Point2D(metaclass=OrderedDescriptorContainer):
709.         ...     x = TypedAttribute((float, int))
710.         ...     y = TypedAttribute((float, int))
711.         ...
712.         ...     def __init__(self, x, y):
713.         ...         self.x, self.y = x, y
714.         ...
715.         >>> p1 = Point2D(1.0, 2.0)
716.         >>> p1.x
717.         1.0
718.         >>> p1.y
719.         2.0
720.         >>> p2 = Point2D('a', 'b')  # doctest: +IGNORE_EXCEPTION_DETAIL
721.         Traceback (most recent call last):
722.             ...
723.         ValueError: Point2D.x must be of type (float, int>)
724. 
725.     We see that ``TypedAttribute`` works more or less as advertised, but
726.     there's nothing special about that.  Let's see what
727.     `OrderedDescriptorContainer` did for us::
728. 
729.         >>> Point2D.typed_attributes
730.         OrderedDict([('x', <TypedAttribute(name=x, type=(float, int))>),
731.         ('y', <TypedAttribute(name=y, type=(float, int))>)])
732. 
733.     If we create a subclass, it does *not* by default add inherited descriptors
734.     to ``typed_attributes``::
735. 
736.         >>> class Point3D(Point2D):
737.         ...     z = TypedAttribute((float, int))
738.         ...
739.         >>> Point3D.typed_attributes
740.         OrderedDict([('z', <TypedAttribute(name=z, type=(float, int))>)])
741. 
742.     However, if we specify ``_inherit_descriptors_`` from ``Point2D`` then
743.     it will do so::
744. 
745.         >>> class Point3D(Point2D):
746.         ...     _inherit_descriptors_ = (TypedAttribute,)
747.         ...     z = TypedAttribute((float, int))
748.         ...
749.         >>> Point3D.typed_attributes
750.         OrderedDict([('x', <TypedAttribute(name=x, type=(float, int))>),
751.         ('y', <TypedAttribute(name=y, type=(float, int))>),
752.         ('z', <TypedAttribute(name=z, type=(float, int))>)])
753. 
754.     .. note::
755. 
756.         Hopefully it is clear from these examples that this construction
757.         also allows a class of type `OrderedDescriptorContainer` to use
758.         multiple different `OrderedDescriptor` classes simultaneously.
759.     """
760. 
761.     _inherit_descriptors_ = ()
762. 
763.     def __init__(cls, cls_name, bases, members):
764.         descriptors = defaultdict(list)
765.         seen = set()
766.         inherit_descriptors = ()
767.         descr_bases = {}
768. 
769.         for mro_cls in cls.__mro__:
770.             for name, obj in mro_cls.__dict__.items():
771.                 if name in seen:
772.                     # Checks if we've already seen an attribute of the given
773.                     # name (if so it will override anything of the same name in
774.                     # any base class)
775.                     continue
776. 
777.                 seen.add(name)
778. 
779.                 if (not isinstance(obj, OrderedDescriptor) or
780.                         (inherit_descriptors and
781.                             not isinstance(obj, inherit_descriptors))):
782.                     # The second condition applies when checking any
783.                     # subclasses, to see if we can inherit any descriptors of
784.                     # the given type from subclasses (by default inheritance is
785.                     # disabled unless the class has _inherit_descriptors_
786.                     # defined)
787.                     continue
788. 
789.                 if obj._name_attribute_ is not None:
790.                     setattr(obj, obj._name_attribute_, name)
791. 
792.                 # Don't just use the descriptor's class directly; instead go
793.                 # through its MRO and find the class on which _class_attribute_
794.                 # is defined directly.  This way subclasses of some
795.                 # OrderedDescriptor *may* override _class_attribute_ and have
796.                 # its own _class_attribute_, but by default all subclasses of
797.                 # some OrderedDescriptor are still grouped together
798.                 # TODO: It might be worth clarifying this in the docs
799.                 if obj.__class__ not in descr_bases:
800.                     for obj_cls_base in obj.__class__.__mro__:
801.                         if '_class_attribute_' in obj_cls_base.__dict__:
802.                             descr_bases[obj.__class__] = obj_cls_base
803.                             descriptors[obj_cls_base].append((obj, name))
804.                             break
805.                 else:
806.                     # Make sure to put obj first for sorting purposes
807.                     obj_cls_base = descr_bases[obj.__class__]
808.                     descriptors[obj_cls_base].append((obj, name))
809. 
810.             if not getattr(mro_cls, '_inherit_descriptors_', False):
811.                 # If _inherit_descriptors_ is undefined then we don't inherit
812.                 # any OrderedDescriptors from any of the base classes, and
813.                 # there's no reason to continue through the MRO
814.                 break
815.             else:
816.                 inherit_descriptors = mro_cls._inherit_descriptors_
817. 
818.         for descriptor_cls, instances in descriptors.items():
819.             instances.sort()
820.             instances = OrderedDict((key, value) for value, key in instances)
821.             setattr(cls, descriptor_cls._class_attribute_, instances)
822. 
823.         super().__init__(cls_name, bases, members)
824. 
825. 
826. LOCALE_LOCK = threading.Lock()
827. 
828. 
829. @contextmanager
830. def set_locale(name):
831.     """
832.     Context manager to temporarily set the locale to ``name``.
833. 
834.     An example is setting locale to "C" so that the C strtod()
835.     function will use "." as the decimal point to enable consistent
836.     numerical string parsing.
837. 
838.     Note that one cannot nest multiple set_locale() context manager
839.     statements as this causes a threading lock.
840. 
841.     This code taken from https://stackoverflow.com/questions/18593661/how-do-i-strftime-a-date-object-in-a-different-locale.
842. 
843.     Parameters
844.     ==========
845.     name : str
846.         Locale name, e.g. "C" or "fr_FR".
847.     """
848.     name = str(name)
849. 
850.     with LOCALE_LOCK:
851.         saved = locale.setlocale(locale.LC_ALL)
852.         if saved == name:
853.             # Don't do anything if locale is already the requested locale
854.             yield
855.         else:
856.             try:
857.                 locale.setlocale(locale.LC_ALL, name)
858.                 yield
859.             finally:
860.                 locale.setlocale(locale.LC_ALL, saved)
861. 
862. 
863. class ShapedLikeNDArray(metaclass=abc.ABCMeta):
864.     """Mixin class to provide shape-changing methods.
865. 
866.     The class proper is assumed to have some underlying data, which are arrays
867.     or array-like structures. It must define a ``shape`` property, which gives
868.     the shape of those data, as well as an ``_apply`` method that creates a new
869.     instance in which a `~numpy.ndarray` method has been applied to those.
870. 
871.     Furthermore, for consistency with `~numpy.ndarray`, it is recommended to
872.     define a setter for the ``shape`` property, which, like the
873.     `~numpy.ndarray.shape` property allows in-place reshaping the internal data
874.     (and, unlike the ``reshape`` method raises an exception if this is not
875.     possible).
876. 
877.     This class also defines default implementations for ``ndim`` and ``size``
878.     properties, calculating those from the ``shape``.  These can be overridden
879.     by subclasses if there are faster ways to obtain those numbers.
880. 
881.     """
882. 
883.     # Note to developers: if new methods are added here, be sure to check that
884.     # they work properly with the classes that use this, such as Time and
885.     # BaseRepresentation, i.e., look at their ``_apply`` methods and add
886.     # relevant tests.  This is particularly important for methods that imply
887.     # copies rather than views of data (see the special-case treatment of
888.     # 'flatten' in Time).
889. 
890.     @property
891.     @abc.abstractmethod
892.     def shape(self):
893.         """The shape of the instance and underlying arrays."""
894. 
895.     @abc.abstractmethod
896.     def _apply(method, *args, **kwargs):
897.         """Create a new instance, with ``method`` applied to underlying data.
898. 
899.         The method is any of the shape-changing methods for `~numpy.ndarray`
900.         (``reshape``, ``swapaxes``, etc.), as well as those picking particular
901.         elements (``__getitem__``, ``take``, etc.). It will be applied to the
902.         underlying arrays (e.g., ``jd1`` and ``jd2`` in `~astropy.time.Time`),
903.         with the results used to create a new instance.
904. 
905.         Parameters
906.         ----------
907.         method : str
908.             Method to be applied to the instance's internal data arrays.
909.         args : tuple
910.             Any positional arguments for ``method``.
911.         kwargs : dict
912.             Any keyword arguments for ``method``.
913. 
914.         """
915. 
916.     @property
917.     def ndim(self):
918.         """The number of dimensions of the instance and underlying arrays."""
919.         return len(self.shape)
920. 
921.     @property
922.     def size(self):
923.         """The size of the object, as calculated from its shape."""
924.         size = 1
925.         for sh in self.shape:
926.             size *= sh
927.         return size
928. 
929.     @property
930.     def isscalar(self):
931.         return self.shape == ()
932. 
933.     def __len__(self):
934.         if self.isscalar:
935.             raise TypeError("Scalar {0!r} object has no len()"
936.                             .format(self.__class__.__name__))
937.         return self.shape[0]
938. 
939.     def __bool__(self):
940.         """Any instance should evaluate to True, except when it is empty."""
941.         return self.size > 0
942. 
943.     def __getitem__(self, item):
944.         try:
945.             return self._apply('__getitem__', item)
946.         except IndexError:
947.             if self.isscalar:
948.                 raise TypeError('scalar {0!r} object is not subscriptable.'
949.                                 .format(self.__class__.__name__))
950.             else:
951.                 raise
952. 
953.     def __iter__(self):
954.         if self.isscalar:
955.             raise TypeError('scalar {0!r} object is not iterable.'
956.                             .format(self.__class__.__name__))
957. 
958.         # We cannot just write a generator here, since then the above error
959.         # would only be raised once we try to use the iterator, rather than
960.         # upon its definition using iter(self).
961.         def self_iter():
962.             for idx in range(len(self)):
963.                 yield self[idx]
964. 
965.         return self_iter()
966. 
967.     def copy(self, *args, **kwargs):
968.         """Return an instance containing copies of the internal data.
969. 
970.         Parameters are as for :meth:`~numpy.ndarray.copy`.
971.         """
972.         return self._apply('copy', *args, **kwargs)
973. 
974.     def reshape(self, *args, **kwargs):
975.         """Returns an instance containing the same data with a new shape.
976. 
977.         Parameters are as for :meth:`~numpy.ndarray.reshape`.  Note that it is
978.         not always possible to change the shape of an array without copying the
979.         data (see :func:`~numpy.reshape` documentation). If you want an error
980.         to be raise if the data is copied, you should assign the new shape to
981.         the shape attribute (note: this may not be implemented for all classes
982.         using ``ShapedLikeNDArray``).
983.         """
984.         return self._apply('reshape', *args, **kwargs)
985. 
986.     def ravel(self, *args, **kwargs):
987.         """Return an instance with the array collapsed into one dimension.
988. 
989.         Parameters are as for :meth:`~numpy.ndarray.ravel`. Note that it is
990.         not always possible to unravel an array without copying the data.
991.         If you want an error to be raise if the data is copied, you should
992.         should assign shape ``(-1,)`` to the shape attribute.
993.         """
994.         return self._apply('ravel', *args, **kwargs)
995. 
996.     def flatten(self, *args, **kwargs):
997.         """Return a copy with the array collapsed into one dimension.
998. 
999.         Parameters are as for :meth:`~numpy.ndarray.flatten`.
1000.         """
1001.         return self._apply('flatten', *args, **kwargs)
1002. 
1003.     def transpose(self, *args, **kwargs):
1004.         """Return an instance with the data transposed.
1005. 
1006.         Parameters are as for :meth:`~numpy.ndarray.transpose`.  All internal
1007.         data are views of the data of the original.
1008.         """
1009.         return self._apply('transpose', *args, **kwargs)
1010. 
1011.     @property
1012.     def T(self):
1013.         """Return an instance with the data transposed.
1014. 
1015.         Parameters are as for :attr:`~numpy.ndarray.T`.  All internal
1016.         data are views of the data of the original.
1017.         """
1018.         if self.ndim < 2:
1019.             return self
1020.         else:
1021.             return self.transpose()
1022. 
1023.     def swapaxes(self, *args, **kwargs):
1024.         """Return an instance with the given axes interchanged.
1025. 
1026.         Parameters are as for :meth:`~numpy.ndarray.swapaxes`:
1027.         ``axis1, axis2``.  All internal data are views of the data of the
1028.         original.
1029.         """
1030.         return self._apply('swapaxes', *args, **kwargs)
1031. 
1032.     def diagonal(self, *args, **kwargs):
1033.         """Return an instance with the specified diagonals.
1034. 
1035.         Parameters are as for :meth:`~numpy.ndarray.diagonal`.  All internal
1036.         data are views of the data of the original.
1037.         """
1038.         return self._apply('diagonal', *args, **kwargs)
1039. 
1040.     def squeeze(self, *args, **kwargs):
1041.         """Return an instance with single-dimensional shape entries removed
1042. 
1043.         Parameters are as for :meth:`~numpy.ndarray.squeeze`.  All internal
1044.         data are views of the data of the original.
1045.         """
1046.         return self._apply('squeeze', *args, **kwargs)
1047. 
1048.     def take(self, indices, axis=None, mode='raise'):
1049.         """Return a new instance formed from the elements at the given indices.
1050. 
1051.         Parameters are as for :meth:`~numpy.ndarray.take`, except that,
1052.         obviously, no output array can be given.
1053.         """
1054.         return self._apply('take', indices, axis=axis, mode=mode)
1055. 
1056. 
1057. class IncompatibleShapeError(ValueError):
1058.     def __init__(self, shape_a, shape_a_idx, shape_b, shape_b_idx):
1059.         super().__init__(shape_a, shape_a_idx, shape_b, shape_b_idx)
1060. 
1061. 
1062. def check_broadcast(*shapes):
1063.     """
1064.     Determines whether two or more Numpy arrays can be broadcast with each
1065.     other based on their shape tuple alone.
1066. 
1067.     Parameters
1068.     ----------
1069.     *shapes : tuple
1070.         All shapes to include in the comparison.  If only one shape is given it
1071.         is passed through unmodified.  If no shapes are given returns an empty
1072.         `tuple`.
1073. 
1074.     Returns
1075.     -------
1076.     broadcast : `tuple`
1077.         If all shapes are mutually broadcastable, returns a tuple of the full
1078.         broadcast shape.
1079.     """
1080. 
1081.     if len(shapes) == 0:
1082.         return ()
1083.     elif len(shapes) == 1:
1084.         return shapes[0]
1085. 
1086.     reversed_shapes = (reversed(shape) for shape in shapes)
1087. 
1088.     full_shape = []
1089. 
1090.     for dims in zip_longest(*reversed_shapes, fillvalue=1):
1091.         max_dim = 1
1092.         max_dim_idx = None
1093.         for idx, dim in enumerate(dims):
1094.             if dim == 1:
1095.                 continue
1096. 
1097.             if max_dim == 1:
1098.                 # The first dimension of size greater than 1
1099.                 max_dim = dim
1100.                 max_dim_idx = idx
1101.             elif dim != max_dim:
1102.                 raise IncompatibleShapeError(
1103.                     shapes[max_dim_idx], max_dim_idx, shapes[idx], idx)
1104. 
1105.         full_shape.append(max_dim)
1106. 
1107.     return tuple(full_shape[::-1])
1108. 
1109. 
1110. def dtype_bytes_or_chars(dtype):
1111.     """
1112.     Parse the number out of a dtype.str value like '<U5' or '<f8'.
1113. 
1114.     See #5819 for discussion on the need for this function for getting
1115.     the number of characters corresponding to a string dtype.
1116. 
1117.     Parameters
1118.     ----------
1119.     dtype : numpy dtype object
1120.         Input dtype
1121. 
1122.     Returns
1123.     -------
1124.     bytes_or_chars : int or None
1125.         Bits (for numeric types) or characters (for string types)
1126.     """
1127.     match = re.search(r'(\d+)$', dtype.str)
1128.     out = int(match.group(1)) if match else None
1129.     return out

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:07:12,313 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have the implementation of `InheritDocstrings` and I can see it's used by the `Model` class. To fully understand the problem, I need to see how `Model` subclasses are implemented and how they handle properties. The file `astropy/modeling/models.py` is likely to contain many concrete model classes that inherit from `Model`, which will provide the necessary context to identify a case where docstring inheritance for a property is failing." query='Please provide the full content of the file `astropy/modeling/models.py`.' extra_requirements='' purpose='I need to examine concrete subclasses of `Model` to find an example of a property that is not inheriting its docstring, which will demonstrate the problem this patch is fixing.'
2025-12-21 19:07:12,314 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/modeling/models.py`.
2025-12-21 19:07:12,314 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:07:12,314 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:07:12,315 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:07:12,315 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/modeling/models.py`.
Purpose: I need to examine concrete subclasses of `Model` to find an example of a property that is not inheriting its docstring, which will demonstrate the problem this patch is fixing.
2025-12-21 19:07:15,737 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have fetched the entire content of `astropy/modeling/models.py` for you to examine. This will allow you to inspect the concrete subclasses of `Model` and identify a property that does not inherit its docstring, which you mentioned is the problem this patch is intended to fix.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/modeling/models.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2146, 'candidates_token_count': 82, 'total_token_count': 2360, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2146}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 132, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2484446734916873, 'model_name': 'gemini-2.5-pro'} id='run--9a890323-086f-4aa3-a3ed-07f9c3fa535a-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/modeling/models.py'}, 'id': 'e0eb109e-e772-4b8c-8dcb-006248f11ae2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2146, 'output_tokens': 82, 'total_tokens': 2360, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 132}}
2025-12-21 19:07:19,396 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the contents of `astropy/modeling/models.py` for you. You can now examine the file to find a concrete subclass of `Model` with a property that isn't inheriting its docstring, which you mentioned as the problem this patch is intended to address." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3223, 'candidates_token_count': 59, 'total_token_count': 3526, 'cached_content_token_count': 1599, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3223}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1599}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 59}], 'thoughts_token_count': 244}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6031845868644068, 'model_name': 'gemini-2.5-pro'} id='run--b1979477-f97d-419d-afa4-92015c9c0908-0' usage_metadata={'input_tokens': 3223, 'output_tokens': 59, 'total_tokens': 3526, 'input_token_details': {'cache_read': 1599}, 'output_token_details': {'reasoning': 244}}
2025-12-21 19:07:19,397 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/modeling/models.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to examine concrete subclasses of `Model` to find an example of a property that is not inheriting its docstring, which will demonstrate the problem this patch is fixing.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/modeling/models.py
Line number range: 1 - 68
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. """
4. Creates a common namespace for all pre-defined models.
5. """
6. 
7. 
8. from .core import custom_model  # pylint: disable=W0611
9. from .mappings import *
10. from .projections import *
11. from .rotations import *
12. from .polynomial import *
13. from .functional_models import *
14. from .powerlaws import *
15. from .tabular import *
16. from .blackbody import BlackBody1D
17. 
18. 
19. """
20. Attach a docstring explaining constraints to all models which support them.
21. 
22. Note: add new models to this list
23. """
24. 
25. CONSTRAINTS_DOC = """
26.     Other Parameters
27.     ----------------
28.     fixed : a dict
29.         A dictionary ``{parameter_name: boolean}`` of parameters to not be
30.         varied during fitting. True means the parameter is held fixed.
31.         Alternatively the `~astropy.modeling.Parameter.fixed`
32.         property of a parameter may be used.
33.     tied : dict
34.         A dictionary ``{parameter_name: callable}`` of parameters which are
35.         linked to some other parameter. The dictionary values are callables
36.         providing the linking relationship.  Alternatively the
37.         `~astropy.modeling.Parameter.tied` property of a parameter
38.         may be used.
39.     bounds : dict
40.         A dictionary ``{parameter_name: boolean}`` of lower and upper bounds of
41.         parameters. Keys  are parameter names. Values  are a list of length 2
42.         giving the desired range for the parameter.  Alternatively the
43.         `~astropy.modeling.Parameter.min` and
44.         `~astropy.modeling.Parameter.max` properties of a parameter
45.         may be used.
46.     eqcons : list
47.         A list of functions of length ``n`` such that ``eqcons[j](x0,*args) ==
48.         0.0`` in a successfully optimized problem.
49.     ineqcons : list
50.         A list of functions of length ``n`` such that ``ieqcons[j](x0,*args) >=
51.         0.0`` is a successfully optimized problem.
52. """
53. 
54. 
55. MODELS_WITH_CONSTRAINTS = [
56.     AiryDisk2D, Moffat1D, Moffat2D, Box1D, Box2D,
57.     Const1D, Const2D, Ellipse2D, Disk2D,
58.     Gaussian1D, Gaussian2D,
59.     Linear1D, Lorentz1D, MexicanHat1D, MexicanHat2D,
60.     PowerLaw1D, Sersic1D, Sersic2D, Sine1D, Trapezoid1D, TrapezoidDisk2D,
61.     Chebyshev1D, Chebyshev2D, Hermite1D, Hermite2D, Legendre2D, Legendre1D,
62.     Polynomial1D, Polynomial2D, Voigt1D
63. ]
64. 
65. 
66. for item in MODELS_WITH_CONSTRAINTS:
67.     if isinstance(item.__doc__, str):
68.         item.__doc__ += CONSTRAINTS_DOC

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:07:25,319 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file `astropy/modeling/models.py`.\n\n2. Extended relevance:\n   - The provided context is the entire content of the requested file, which is necessary to fulfill the user's request to examine concrete subclasses of `Model`.", relative_path='astropy/modeling/models.py', start_line=1, end_line=68)]
2025-12-21 19:07:25,320 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/modeling/models.py`.
2025-12-21 19:07:25,320 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:07:25,320 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:07:25,321 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 2 existing contexts
2025-12-21 19:07:25,321 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-21 19:07:25,321 - thread-124708668311232.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-21 19:07:25,322 - thread-124708668311232.prometheus_context_collector - INFO - Successfully retrieved 3 context snippets
