2025-12-21 00:38:39,314 - thread-133211025835712.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: [Bug]: `align` in `HPacker` is reversed

Description: ### Bug summary

For the `align` parameter in `HPacker`, the options `top` and `bottom` seems reversed

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib.offsetbox import DrawingArea, HPacker, VPacker, AnchoredOffsetbox, TextArea
from matplotlib.patches import Rectangle

da1 = DrawingArea(10, 20)
rect1 = Rectangle((0, 0), 10, 20)
da1.add_artist(rect1)

da2 = DrawingArea(10, 30)
rect2 = Rectangle((0, 0), 10, 30)
da2.add_artist(rect2)

align = "bottom"

pack = HPacker(children=[da1, da2], pad=10, sep=10, align=align)
title = TextArea(f"align='{align}'")
pack = VPacker(children=[title, pack], sep=10, pad=10, align="center")

box = AnchoredOffsetbox(child=pack, loc="center")

_, ax = plt.subplots()
ax.add_artist(box)
```


### Actual outcome

![download](https://user-images.githubusercontent.com/23433306/200162888-702626bf-ad47-40e2-8751-7dffe91df85c.png)


### Expected outcome

![download](https://user-images.githubusercontent.com/23433306/200162908-e0e9dfd5-6f8b-4aac-975e-bb363d809c41.png)


### Additional information

_No response_

### Operating system

_No response_

### Matplotlib Version

3.6.2

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

_No response_

Patch information:
diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py
index 3a506543ac..d1b2c9714c 100644
--- a/lib/matplotlib/offsetbox.py
+++ b/lib/matplotlib/offsetbox.py
@@ -475,9 +475,10 @@ class HPacker(PackerBase):
             return 2 * pad, 2 * pad, pad, pad, []
 
         hd_list = [(h, yd) for w, h, xd, yd in whd_list]
+        v_align = {"top": "bottom", "bottom": "top"}.get(self.align, self.align)
         height, ydescent, yoffsets = _get_aligned_offsets(hd_list,
                                                           self.height,
-                                                          self.align)
+                                                          v_align)
 
         pack_list = [w for w, h, xd, yd in whd_list]
         width, xoffsets_ = _get_packed_offsets(pack_list, self.width,


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 00:38:39,385 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   └── 24189-JB.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   └── 24455-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   └── 24257-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       └── 24356-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   └── view_current_axis_format.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           └── test_axes3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: `align` in `HPacker` is reversed

Description: ### Bug summary

For the `align` parameter in `HPacker`, the options `top` and `bottom` seems reversed

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib.offsetbox import DrawingArea, HPacker, VPacker, AnchoredOffsetbox, TextArea
from matplotlib.patches import Rectangle

da1 = DrawingArea(10, 20)
rect1 = Rectangle((0, 0), 10, 20)
da1.add_artist(rect1)

da2 = DrawingArea(10, 30)
rect2 = Rectangle((0, 0), 10, 30)
da2.add_artist(rect2)

align = "bottom"

pack = HPacker(children=[da1, da2], pad=10, sep=10, align=align)
title = TextArea(f"align='{align}'")
pack = VPacker(children=[title, pack], sep=10, pad=10, align="center")

box = AnchoredOffsetbox(child=pack, loc="center")

_, ax = plt.subplots()
ax.add_artist(box)
```


### Actual outcome

![download](https://user-images.githubusercontent.com/23433306/200162888-702626bf-ad47-40e2-8751-7dffe91df85c.png)


### Expected outcome

![download](https://user-images.githubusercontent.com/23433306/200162908-e0e9dfd5-6f8b-4aac-975e-bb363d809c41.png)


### Additional information

_No response_

### Operating system

_No response_

### Matplotlib Version

3.6.2

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

_No response_

Patch information:
diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py
index 3a506543ac..d1b2c9714c 100644
--- a/lib/matplotlib/offsetbox.py
+++ b/lib/matplotlib/offsetbox.py
@@ -475,9 +475,10 @@ class HPacker(PackerBase):
             return 2 * pad, 2 * pad, pad, pad, []
 
         hd_list = [(h, yd) for w, h, xd, yd in whd_list]
+        v_align = {"top": "bottom", "bottom": "top"}.get(self.align, self.align)
         height, ydescent, yoffsets = _get_aligned_offsets(hd_list,
                                                           self.height,
-                                                          self.align)
+                                                          v_align)
 
         pack_list = [w for w, h, xd, yd in whd_list]
         width, xoffsets_ = _get_packed_offsets(pack_list, self.width,


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 00:38:46,578 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user is asking for test cases related to a bug in `HPacker` from `matplotlib.offsetbox`. The bug report indicates an issue with the `align` parameter. To find relevant tests, I need to examine the test file associated with `offsetbox`. Based on the file structure, `lib/matplotlib/tests/test_offsetbox.py` is the correct file to investigate for tests of `HPacker` and its alignment behavior.' query='Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.' extra_requirements='' purpose='I need to analyze the tests for offsetbox to find 3 test cases that are relevant to the `HPacker` alignment bug.'
2025-12-21 00:38:46,579 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.
2025-12-21 00:38:46,579 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 00:38:46,580 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 00:38:46,581 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 00:38:46,581 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.
Purpose: I need to analyze the tests for offsetbox to find 3 test cases that are relevant to the `HPacker` alignment bug.
2025-12-21 00:38:48,836 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have fetched the entire content of the `lib/matplotlib/tests/test_offsetbox.py` file. This will allow you to examine all the tests for `offsetbox` and identify the ones that are most relevant to the `HPacker` alignment bug you are investigating.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_offsetbox.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2137, 'candidates_token_count': 85, 'total_token_count': 2307, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2137}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 85}], 'thoughts_token_count': 85, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.14130433026482078, 'model_name': 'gemini-2.5-pro'} id='run--76660670-5a8b-4d2e-a8ce-b0ea7424583b-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_offsetbox.py'}, 'id': 'ba6a39f4-7c63-41ea-bb8d-ef59fed273b3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2137, 'output_tokens': 85, 'total_tokens': 2307, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 85}}
2025-12-21 00:39:00,713 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the content of `lib/matplotlib/tests/test_offsetbox.py`. Based on your query about the `HPacker` alignment bug, I suggest you focus on the tests related to `_get_packed_offsets` and legend expansion, as these are most relevant to packing and alignment logic. You should have all the information you need to analyze the tests and find the relevant cases.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7861, 'candidates_token_count': 84, 'total_token_count': 9204, 'cached_content_token_count': 1819, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7861}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1819}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 84}], 'thoughts_token_count': 1259}, 'finish_reason': 'STOP', 'avg_logprobs': -1.9476521809895833, 'model_name': 'gemini-2.5-pro'} id='run--9d7a5d56-00f4-44b6-9670-5930c06574e1-0' usage_metadata={'input_tokens': 7861, 'output_tokens': 84, 'total_tokens': 9204, 'input_token_details': {'cache_read': 1819}, 'output_token_details': {'reasoning': 1259}}
2025-12-21 00:39:00,715 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to analyze the tests for offsetbox to find 3 test cases that are relevant to the `HPacker` alignment bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_offsetbox.py
Line number range: 1 - 337
Content:
1. from collections import namedtuple
2. import io
3. 
4. import numpy as np
5. from numpy.testing import assert_allclose
6. import pytest
7. 
8. from matplotlib.testing.decorators import image_comparison
9. import matplotlib.pyplot as plt
10. import matplotlib.patches as mpatches
11. import matplotlib.lines as mlines
12. from matplotlib.backend_bases import MouseButton, MouseEvent
13. 
14. from matplotlib.offsetbox import (
15.     AnchoredOffsetbox, AnnotationBbox, AnchoredText, DrawingArea, OffsetBox,
16.     OffsetImage, TextArea, _get_packed_offsets)
17. 
18. 
19. @image_comparison(['offsetbox_clipping'], remove_text=True)
20. def test_offsetbox_clipping():
21.     # - create a plot
22.     # - put an AnchoredOffsetbox with a child DrawingArea
23.     #   at the center of the axes
24.     # - give the DrawingArea a gray background
25.     # - put a black line across the bounds of the DrawingArea
26.     # - see that the black line is clipped to the edges of
27.     #   the DrawingArea.
28.     fig, ax = plt.subplots()
29.     size = 100
30.     da = DrawingArea(size, size, clip=True)
31.     bg = mpatches.Rectangle((0, 0), size, size,
32.                             facecolor='#CCCCCC',
33.                             edgecolor='None',
34.                             linewidth=0)
35.     line = mlines.Line2D([-size*.5, size*1.5], [size/2, size/2],
36.                          color='black',
37.                          linewidth=10)
38.     anchored_box = AnchoredOffsetbox(
39.         loc='center',
40.         child=da,
41.         pad=0.,
42.         frameon=False,
43.         bbox_to_anchor=(.5, .5),
44.         bbox_transform=ax.transAxes,
45.         borderpad=0.)
46. 
47.     da.add_artist(bg)
48.     da.add_artist(line)
49.     ax.add_artist(anchored_box)
50.     ax.set_xlim((0, 1))
51.     ax.set_ylim((0, 1))
52. 
53. 
54. def test_offsetbox_clip_children():
55.     # - create a plot
56.     # - put an AnchoredOffsetbox with a child DrawingArea
57.     #   at the center of the axes
58.     # - give the DrawingArea a gray background
59.     # - put a black line across the bounds of the DrawingArea
60.     # - see that the black line is clipped to the edges of
61.     #   the DrawingArea.
62.     fig, ax = plt.subplots()
63.     size = 100
64.     da = DrawingArea(size, size, clip=True)
65.     bg = mpatches.Rectangle((0, 0), size, size,
66.                             facecolor='#CCCCCC',
67.                             edgecolor='None',
68.                             linewidth=0)
69.     line = mlines.Line2D([-size*.5, size*1.5], [size/2, size/2],
70.                          color='black',
71.                          linewidth=10)
72.     anchored_box = AnchoredOffsetbox(
73.         loc='center',
74.         child=da,
75.         pad=0.,
76.         frameon=False,
77.         bbox_to_anchor=(.5, .5),
78.         bbox_transform=ax.transAxes,
79.         borderpad=0.)
80. 
81.     da.add_artist(bg)
82.     da.add_artist(line)
83.     ax.add_artist(anchored_box)
84. 
85.     fig.canvas.draw()
86.     assert not fig.stale
87.     da.clip_children = True
88.     assert fig.stale
89. 
90. 
91. def test_offsetbox_loc_codes():
92.     # Check that valid string location codes all work with an AnchoredOffsetbox
93.     codes = {'upper right': 1,
94.              'upper left': 2,
95.              'lower left': 3,
96.              'lower right': 4,
97.              'right': 5,
98.              'center left': 6,
99.              'center right': 7,
100.              'lower center': 8,
101.              'upper center': 9,
102.              'center': 10,
103.              }
104.     fig, ax = plt.subplots()
105.     da = DrawingArea(100, 100)
106.     for code in codes:
107.         anchored_box = AnchoredOffsetbox(loc=code, child=da)
108.         ax.add_artist(anchored_box)
109.     fig.canvas.draw()
110. 
111. 
112. def test_expand_with_tight_layout():
113.     # Check issue reported in #10476, and updated due to #10784
114.     fig, ax = plt.subplots()
115. 
116.     d1 = [1, 2]
117.     d2 = [2, 1]
118.     ax.plot(d1, label='series 1')
119.     ax.plot(d2, label='series 2')
120.     ax.legend(ncols=2, mode='expand')
121. 
122.     fig.tight_layout()  # where the crash used to happen
123. 
124. 
125. @pytest.mark.parametrize('widths',
126.                          ([150], [150, 150, 150], [0.1], [0.1, 0.1]))
127. @pytest.mark.parametrize('total', (250, 100, 0, -1, None))
128. @pytest.mark.parametrize('sep', (250, 1, 0, -1))
129. @pytest.mark.parametrize('mode', ("expand", "fixed", "equal"))
130. def test_get_packed_offsets(widths, total, sep, mode):
131.     # Check a (rather arbitrary) set of parameters due to successive similar
132.     # issue tickets (at least #10476 and #10784) related to corner cases
133.     # triggered inside this function when calling higher-level functions
134.     # (e.g. `Axes.legend`).
135.     # These are just some additional smoke tests. The output is untested.
136.     _get_packed_offsets(widths, total, sep, mode=mode)
137. 
138. 
139. _Params = namedtuple('_params', 'wd_list, total, sep, expected')
140. 
141. 
142. @pytest.mark.parametrize('widths, total, sep, expected', [
143.     _Params(  # total=None
144.         [3, 1, 2], total=None, sep=1, expected=(8, [0, 4, 6])),
145.     _Params(  # total larger than required
146.         [3, 1, 2], total=10, sep=1, expected=(10, [0, 4, 6])),
147.     _Params(  # total smaller than required
148.         [3, 1, 2], total=5, sep=1, expected=(5, [0, 4, 6])),
149. ])
150. def test_get_packed_offsets_fixed(widths, total, sep, expected):
151.     result = _get_packed_offsets(widths, total, sep, mode='fixed')
152.     assert result[0] == expected[0]
153.     assert_allclose(result[1], expected[1])
154. 
155. 
156. @pytest.mark.parametrize('widths, total, sep, expected', [
157.     _Params(  # total=None (implicit 1)
158.         [.1, .1, .1], total=None, sep=None, expected=(1, [0, .45, .9])),
159.     _Params(  # total larger than sum of widths
160.         [3, 1, 2], total=10, sep=1, expected=(10, [0, 5, 8])),
161.     _Params(  # total smaller sum of widths: overlapping boxes
162.         [3, 1, 2], total=5, sep=1, expected=(5, [0, 2.5, 3])),
163. ])
164. def test_get_packed_offsets_expand(widths, total, sep, expected):
165.     result = _get_packed_offsets(widths, total, sep, mode='expand')
166.     assert result[0] == expected[0]
167.     assert_allclose(result[1], expected[1])
168. 
169. 
170. @pytest.mark.parametrize('widths, total, sep, expected', [
171.     _Params(  # total larger than required
172.         [3, 2, 1], total=6, sep=None, expected=(6, [0, 2, 4])),
173.     _Params(  # total smaller sum of widths: overlapping boxes
174.         [3, 2, 1, .5], total=2, sep=None, expected=(2, [0, 0.5, 1, 1.5])),
175.     _Params(  # total larger than required
176.         [.5, 1, .2], total=None, sep=1, expected=(6, [0, 2, 4])),
177.     # the case total=None, sep=None is tested separately below
178. ])
179. def test_get_packed_offsets_equal(widths, total, sep, expected):
180.     result = _get_packed_offsets(widths, total, sep, mode='equal')
181.     assert result[0] == expected[0]
182.     assert_allclose(result[1], expected[1])
183. 
184. 
185. def test_get_packed_offsets_equal_total_none_sep_none():
186.     with pytest.raises(ValueError):
187.         _get_packed_offsets([1, 1, 1], total=None, sep=None, mode='equal')
188. 
189. 
190. @pytest.mark.parametrize('child_type', ['draw', 'image', 'text'])
191. @pytest.mark.parametrize('boxcoords',
192.                          ['axes fraction', 'axes pixels', 'axes points',
193.                           'data'])
194. def test_picking(child_type, boxcoords):
195.     # These all take up approximately the same area.
196.     if child_type == 'draw':
197.         picking_child = DrawingArea(5, 5)
198.         picking_child.add_artist(mpatches.Rectangle((0, 0), 5, 5, linewidth=0))
199.     elif child_type == 'image':
200.         im = np.ones((5, 5))
201.         im[2, 2] = 0
202.         picking_child = OffsetImage(im)
203.     elif child_type == 'text':
204.         picking_child = TextArea('\N{Black Square}', textprops={'fontsize': 5})
205.     else:
206.         assert False, f'Unknown picking child type {child_type}'
207. 
208.     fig, ax = plt.subplots()
209.     ab = AnnotationBbox(picking_child, (0.5, 0.5), boxcoords=boxcoords)
210.     ab.set_picker(True)
211.     ax.add_artist(ab)
212. 
213.     calls = []
214.     fig.canvas.mpl_connect('pick_event', lambda event: calls.append(event))
215. 
216.     # Annotation should be picked by an event occurring at its center.
217.     if boxcoords == 'axes points':
218.         x, y = ax.transAxes.transform_point((0, 0))
219.         x += 0.5 * fig.dpi / 72
220.         y += 0.5 * fig.dpi / 72
221.     elif boxcoords == 'axes pixels':
222.         x, y = ax.transAxes.transform_point((0, 0))
223.         x += 0.5
224.         y += 0.5
225.     else:
226.         x, y = ax.transAxes.transform_point((0.5, 0.5))
227.     fig.canvas.draw()
228.     calls.clear()
229.     MouseEvent(
230.         "button_press_event", fig.canvas, x, y, MouseButton.LEFT)._process()
231.     assert len(calls) == 1 and calls[0].artist == ab
232. 
233.     # Annotation should *not* be picked by an event at its original center
234.     # point when the limits have changed enough to hide the *xy* point.
235.     ax.set_xlim(-1, 0)
236.     ax.set_ylim(-1, 0)
237.     fig.canvas.draw()
238.     calls.clear()
239.     MouseEvent(
240.         "button_press_event", fig.canvas, x, y, MouseButton.LEFT)._process()
241.     assert len(calls) == 0
242. 
243. 
244. @image_comparison(['anchoredtext_align.png'], remove_text=True, style='mpl20')
245. def test_anchoredtext_horizontal_alignment():
246.     fig, ax = plt.subplots()
247. 
248.     text0 = AnchoredText("test\ntest long text", loc="center left",
249.                          pad=0.2, prop={"ha": "left"})
250.     ax.add_artist(text0)
251.     text1 = AnchoredText("test\ntest long text", loc="center",
252.                          pad=0.2, prop={"ha": "center"})
253.     ax.add_artist(text1)
254.     text2 = AnchoredText("test\ntest long text", loc="center right",
255.                          pad=0.2, prop={"ha": "right"})
256.     ax.add_artist(text2)
257. 
258. 
259. def test_annotationbbox_extents():
260.     plt.rcParams.update(plt.rcParamsDefault)
261.     fig, ax = plt.subplots(figsize=(4, 3), dpi=100)
262. 
263.     ax.axis([0, 1, 0, 1])
264. 
265.     an1 = ax.annotate("Annotation", xy=(.9, .9), xytext=(1.1, 1.1),
266.                       arrowprops=dict(arrowstyle="->"), clip_on=False,
267.                       va="baseline", ha="left")
268. 
269.     da = DrawingArea(20, 20, 0, 0, clip=True)
270.     p = mpatches.Circle((-10, 30), 32)
271.     da.add_artist(p)
272. 
273.     ab3 = AnnotationBbox(da, [.5, .5], xybox=(-0.2, 0.5), xycoords='data',
274.                          boxcoords="axes fraction", box_alignment=(0., .5),
275.                          arrowprops=dict(arrowstyle="->"))
276.     ax.add_artist(ab3)
277. 
278.     im = OffsetImage(np.random.rand(10, 10), zoom=3)
279.     im.image.axes = ax
280.     ab6 = AnnotationBbox(im, (0.5, -.3), xybox=(0, 75),
281.                          xycoords='axes fraction',
282.                          boxcoords="offset points", pad=0.3,
283.                          arrowprops=dict(arrowstyle="->"))
284.     ax.add_artist(ab6)
285. 
286.     fig.canvas.draw()
287.     renderer = fig.canvas.get_renderer()
288. 
289.     # Test Annotation
290.     bb1w = an1.get_window_extent(renderer)
291.     bb1e = an1.get_tightbbox(renderer)
292. 
293.     target1 = [332.9, 242.8, 467.0, 298.9]
294.     assert_allclose(bb1w.extents, target1, atol=2)
295.     assert_allclose(bb1e.extents, target1, atol=2)
296. 
297.     # Test AnnotationBbox
298.     bb3w = ab3.get_window_extent(renderer)
299.     bb3e = ab3.get_tightbbox(renderer)
300. 
301.     target3 = [-17.6, 129.0, 200.7, 167.9]
302.     assert_allclose(bb3w.extents, target3, atol=2)
303.     assert_allclose(bb3e.extents, target3, atol=2)
304. 
305.     bb6w = ab6.get_window_extent(renderer)
306.     bb6e = ab6.get_tightbbox(renderer)
307. 
308.     target6 = [180.0, -32.0, 230.0, 92.9]
309.     assert_allclose(bb6w.extents, target6, atol=2)
310.     assert_allclose(bb6e.extents, target6, atol=2)
311. 
312.     # Test bbox_inches='tight'
313.     buf = io.BytesIO()
314.     fig.savefig(buf, bbox_inches='tight')
315.     buf.seek(0)
316.     shape = plt.imread(buf).shape
317.     targetshape = (350, 504, 4)
318.     assert_allclose(shape, targetshape, atol=2)
319. 
320.     # Simple smoke test for tight_layout, to make sure it does not error out.
321.     fig.canvas.draw()
322.     fig.tight_layout()
323.     fig.canvas.draw()
324. 
325. 
326. def test_zorder():
327.     assert OffsetBox(zorder=42).zorder == 42
328. 
329. 
330. def test_arrowprops_copied():
331.     da = DrawingArea(20, 20, 0, 0, clip=True)
332.     arrowprops = {"arrowstyle": "->", "relpos": (.3, .7)}
333.     ab = AnnotationBbox(da, [.5, .5], xybox=(-0.2, 0.5), xycoords='data',
334.                         boxcoords="axes fraction", box_alignment=(0., .5),
335.                         arrowprops=arrowprops)
336.     assert ab.arrowprops is not ab
337.     assert arrowprops["relpos"] == (.3, .7)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 00:39:07,131 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly asks for the 'full content of the file lib/matplotlib/tests/test_offsetbox.py'.\n\n2. Extended relevance:\n   - The provided context is the exact file requested by the user.\n   - To fulfill the user's request for the full content, the entire file is relevant.", relative_path='lib/matplotlib/tests/test_offsetbox.py', start_line=1, end_line=337)]
2025-12-21 00:39:07,132 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.
2025-12-21 00:39:07,132 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 00:39:07,132 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 00:39:07,133 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 00:39:07,133 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 00:39:07,134 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   └── 24189-JB.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   └── 24455-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   └── 24257-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       └── 24356-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   └── view_current_axis_format.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           └── test_axes3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: `align` in `HPacker` is reversed

Description: ### Bug summary

For the `align` parameter in `HPacker`, the options `top` and `bottom` seems reversed

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib.offsetbox import DrawingArea, HPacker, VPacker, AnchoredOffsetbox, TextArea
from matplotlib.patches import Rectangle

da1 = DrawingArea(10, 20)
rect1 = Rectangle((0, 0), 10, 20)
da1.add_artist(rect1)

da2 = DrawingArea(10, 30)
rect2 = Rectangle((0, 0), 10, 30)
da2.add_artist(rect2)

align = "bottom"

pack = HPacker(children=[da1, da2], pad=10, sep=10, align=align)
title = TextArea(f"align='{align}'")
pack = VPacker(children=[title, pack], sep=10, pad=10, align="center")

box = AnchoredOffsetbox(child=pack, loc="center")

_, ax = plt.subplots()
ax.add_artist(box)
```


### Actual outcome

![download](https://user-images.githubusercontent.com/23433306/200162888-702626bf-ad47-40e2-8751-7dffe91df85c.png)


### Expected outcome

![download](https://user-images.githubusercontent.com/23433306/200162908-e0e9dfd5-6f8b-4aac-975e-bb363d809c41.png)


### Additional information

_No response_

### Operating system

_No response_

### Matplotlib Version

3.6.2

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

_No response_

Patch information:
diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py
index 3a506543ac..d1b2c9714c 100644
--- a/lib/matplotlib/offsetbox.py
+++ b/lib/matplotlib/offsetbox.py
@@ -475,9 +475,10 @@ class HPacker(PackerBase):
             return 2 * pad, 2 * pad, pad, pad, []
 
         hd_list = [(h, yd) for w, h, xd, yd in whd_list]
+        v_align = {"top": "bottom", "bottom": "top"}.get(self.align, self.align)
         height, ydescent, yoffsets = _get_aligned_offsets(hd_list,
                                                           self.height,
-                                                          self.align)
+                                                          v_align)
 
         pack_list = [w for w, h, xd, yd in whd_list]
         width, xoffsets_ = _get_packed_offsets(pack_list, self.width,


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.
Extra Requirements: 
Purpose: I need to analyze the tests for offsetbox to find 3 test cases that are relevant to the `HPacker` alignment bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_offsetbox.py
Line number range: 1 - 337
Content:
1. from collections import namedtuple
2. import io
3. 
4. import numpy as np
5. from numpy.testing import assert_allclose
6. import pytest
7. 
8. from matplotlib.testing.decorators import image_comparison
9. import matplotlib.pyplot as plt
10. import matplotlib.patches as mpatches
11. import matplotlib.lines as mlines
12. from matplotlib.backend_bases import MouseButton, MouseEvent
13. 
14. from matplotlib.offsetbox import (
15.     AnchoredOffsetbox, AnnotationBbox, AnchoredText, DrawingArea, OffsetBox,
16.     OffsetImage, TextArea, _get_packed_offsets)
17. 
18. 
19. @image_comparison(['offsetbox_clipping'], remove_text=True)
20. def test_offsetbox_clipping():
21.     # - create a plot
22.     # - put an AnchoredOffsetbox with a child DrawingArea
23.     #   at the center of the axes
24.     # - give the DrawingArea a gray background
25.     # - put a black line across the bounds of the DrawingArea
26.     # - see that the black line is clipped to the edges of
27.     #   the DrawingArea.
28.     fig, ax = plt.subplots()
29.     size = 100
30.     da = DrawingArea(size, size, clip=True)
31.     bg = mpatches.Rectangle((0, 0), size, size,
32.                             facecolor='#CCCCCC',
33.                             edgecolor='None',
34.                             linewidth=0)
35.     line = mlines.Line2D([-size*.5, size*1.5], [size/2, size/2],
36.                          color='black',
37.                          linewidth=10)
38.     anchored_box = AnchoredOffsetbox(
39.         loc='center',
40.         child=da,
41.         pad=0.,
42.         frameon=False,
43.         bbox_to_anchor=(.5, .5),
44.         bbox_transform=ax.transAxes,
45.         borderpad=0.)
46. 
47.     da.add_artist(bg)
48.     da.add_artist(line)
49.     ax.add_artist(anchored_box)
50.     ax.set_xlim((0, 1))
51.     ax.set_ylim((0, 1))
52. 
53. 
54. def test_offsetbox_clip_children():
55.     # - create a plot
56.     # - put an AnchoredOffsetbox with a child DrawingArea
57.     #   at the center of the axes
58.     # - give the DrawingArea a gray background
59.     # - put a black line across the bounds of the DrawingArea
60.     # - see that the black line is clipped to the edges of
61.     #   the DrawingArea.
62.     fig, ax = plt.subplots()
63.     size = 100
64.     da = DrawingArea(size, size, clip=True)
65.     bg = mpatches.Rectangle((0, 0), size, size,
66.                             facecolor='#CCCCCC',
67.                             edgecolor='None',
68.                             linewidth=0)
69.     line = mlines.Line2D([-size*.5, size*1.5], [size/2, size/2],
70.                          color='black',
71.                          linewidth=10)
72.     anchored_box = AnchoredOffsetbox(
73.         loc='center',
74.         child=da,
75.         pad=0.,
76.         frameon=False,
77.         bbox_to_anchor=(.5, .5),
78.         bbox_transform=ax.transAxes,
79.         borderpad=0.)
80. 
81.     da.add_artist(bg)
82.     da.add_artist(line)
83.     ax.add_artist(anchored_box)
84. 
85.     fig.canvas.draw()
86.     assert not fig.stale
87.     da.clip_children = True
88.     assert fig.stale
89. 
90. 
91. def test_offsetbox_loc_codes():
92.     # Check that valid string location codes all work with an AnchoredOffsetbox
93.     codes = {'upper right': 1,
94.              'upper left': 2,
95.              'lower left': 3,
96.              'lower right': 4,
97.              'right': 5,
98.              'center left': 6,
99.              'center right': 7,
100.              'lower center': 8,
101.              'upper center': 9,
102.              'center': 10,
103.              }
104.     fig, ax = plt.subplots()
105.     da = DrawingArea(100, 100)
106.     for code in codes:
107.         anchored_box = AnchoredOffsetbox(loc=code, child=da)
108.         ax.add_artist(anchored_box)
109.     fig.canvas.draw()
110. 
111. 
112. def test_expand_with_tight_layout():
113.     # Check issue reported in #10476, and updated due to #10784
114.     fig, ax = plt.subplots()
115. 
116.     d1 = [1, 2]
117.     d2 = [2, 1]
118.     ax.plot(d1, label='series 1')
119.     ax.plot(d2, label='series 2')
120.     ax.legend(ncols=2, mode='expand')
121. 
122.     fig.tight_layout()  # where the crash used to happen
123. 
124. 
125. @pytest.mark.parametrize('widths',
126.                          ([150], [150, 150, 150], [0.1], [0.1, 0.1]))
127. @pytest.mark.parametrize('total', (250, 100, 0, -1, None))
128. @pytest.mark.parametrize('sep', (250, 1, 0, -1))
129. @pytest.mark.parametrize('mode', ("expand", "fixed", "equal"))
130. def test_get_packed_offsets(widths, total, sep, mode):
131.     # Check a (rather arbitrary) set of parameters due to successive similar
132.     # issue tickets (at least #10476 and #10784) related to corner cases
133.     # triggered inside this function when calling higher-level functions
134.     # (e.g. `Axes.legend`).
135.     # These are just some additional smoke tests. The output is untested.
136.     _get_packed_offsets(widths, total, sep, mode=mode)
137. 
138. 
139. _Params = namedtuple('_params', 'wd_list, total, sep, expected')
140. 
141. 
142. @pytest.mark.parametrize('widths, total, sep, expected', [
143.     _Params(  # total=None
144.         [3, 1, 2], total=None, sep=1, expected=(8, [0, 4, 6])),
145.     _Params(  # total larger than required
146.         [3, 1, 2], total=10, sep=1, expected=(10, [0, 4, 6])),
147.     _Params(  # total smaller than required
148.         [3, 1, 2], total=5, sep=1, expected=(5, [0, 4, 6])),
149. ])
150. def test_get_packed_offsets_fixed(widths, total, sep, expected):
151.     result = _get_packed_offsets(widths, total, sep, mode='fixed')
152.     assert result[0] == expected[0]
153.     assert_allclose(result[1], expected[1])
154. 
155. 
156. @pytest.mark.parametrize('widths, total, sep, expected', [
157.     _Params(  # total=None (implicit 1)
158.         [.1, .1, .1], total=None, sep=None, expected=(1, [0, .45, .9])),
159.     _Params(  # total larger than sum of widths
160.         [3, 1, 2], total=10, sep=1, expected=(10, [0, 5, 8])),
161.     _Params(  # total smaller sum of widths: overlapping boxes
162.         [3, 1, 2], total=5, sep=1, expected=(5, [0, 2.5, 3])),
163. ])
164. def test_get_packed_offsets_expand(widths, total, sep, expected):
165.     result = _get_packed_offsets(widths, total, sep, mode='expand')
166.     assert result[0] == expected[0]
167.     assert_allclose(result[1], expected[1])
168. 
169. 
170. @pytest.mark.parametrize('widths, total, sep, expected', [
171.     _Params(  # total larger than required
172.         [3, 2, 1], total=6, sep=None, expected=(6, [0, 2, 4])),
173.     _Params(  # total smaller sum of widths: overlapping boxes
174.         [3, 2, 1, .5], total=2, sep=None, expected=(2, [0, 0.5, 1, 1.5])),
175.     _Params(  # total larger than required
176.         [.5, 1, .2], total=None, sep=1, expected=(6, [0, 2, 4])),
177.     # the case total=None, sep=None is tested separately below
178. ])
179. def test_get_packed_offsets_equal(widths, total, sep, expected):
180.     result = _get_packed_offsets(widths, total, sep, mode='equal')
181.     assert result[0] == expected[0]
182.     assert_allclose(result[1], expected[1])
183. 
184. 
185. def test_get_packed_offsets_equal_total_none_sep_none():
186.     with pytest.raises(ValueError):
187.         _get_packed_offsets([1, 1, 1], total=None, sep=None, mode='equal')
188. 
189. 
190. @pytest.mark.parametrize('child_type', ['draw', 'image', 'text'])
191. @pytest.mark.parametrize('boxcoords',
192.                          ['axes fraction', 'axes pixels', 'axes points',
193.                           'data'])
194. def test_picking(child_type, boxcoords):
195.     # These all take up approximately the same area.
196.     if child_type == 'draw':
197.         picking_child = DrawingArea(5, 5)
198.         picking_child.add_artist(mpatches.Rectangle((0, 0), 5, 5, linewidth=0))
199.     elif child_type == 'image':
200.         im = np.ones((5, 5))
201.         im[2, 2] = 0
202.         picking_child = OffsetImage(im)
203.     elif child_type == 'text':
204.         picking_child = TextArea('\N{Black Square}', textprops={'fontsize': 5})
205.     else:
206.         assert False, f'Unknown picking child type {child_type}'
207. 
208.     fig, ax = plt.subplots()
209.     ab = AnnotationBbox(picking_child, (0.5, 0.5), boxcoords=boxcoords)
210.     ab.set_picker(True)
211.     ax.add_artist(ab)
212. 
213.     calls = []
214.     fig.canvas.mpl_connect('pick_event', lambda event: calls.append(event))
215. 
216.     # Annotation should be picked by an event occurring at its center.
217.     if boxcoords == 'axes points':
218.         x, y = ax.transAxes.transform_point((0, 0))
219.         x += 0.5 * fig.dpi / 72
220.         y += 0.5 * fig.dpi / 72
221.     elif boxcoords == 'axes pixels':
222.         x, y = ax.transAxes.transform_point((0, 0))
223.         x += 0.5
224.         y += 0.5
225.     else:
226.         x, y = ax.transAxes.transform_point((0.5, 0.5))
227.     fig.canvas.draw()
228.     calls.clear()
229.     MouseEvent(
230.         "button_press_event", fig.canvas, x, y, MouseButton.LEFT)._process()
231.     assert len(calls) == 1 and calls[0].artist == ab
232. 
233.     # Annotation should *not* be picked by an event at its original center
234.     # point when the limits have changed enough to hide the *xy* point.
235.     ax.set_xlim(-1, 0)
236.     ax.set_ylim(-1, 0)
237.     fig.canvas.draw()
238.     calls.clear()
239.     MouseEvent(
240.         "button_press_event", fig.canvas, x, y, MouseButton.LEFT)._process()
241.     assert len(calls) == 0
242. 
243. 
244. @image_comparison(['anchoredtext_align.png'], remove_text=True, style='mpl20')
245. def test_anchoredtext_horizontal_alignment():
246.     fig, ax = plt.subplots()
247. 
248.     text0 = AnchoredText("test\ntest long text", loc="center left",
249.                          pad=0.2, prop={"ha": "left"})
250.     ax.add_artist(text0)
251.     text1 = AnchoredText("test\ntest long text", loc="center",
252.                          pad=0.2, prop={"ha": "center"})
253.     ax.add_artist(text1)
254.     text2 = AnchoredText("test\ntest long text", loc="center right",
255.                          pad=0.2, prop={"ha": "right"})
256.     ax.add_artist(text2)
257. 
258. 
259. def test_annotationbbox_extents():
260.     plt.rcParams.update(plt.rcParamsDefault)
261.     fig, ax = plt.subplots(figsize=(4, 3), dpi=100)
262. 
263.     ax.axis([0, 1, 0, 1])
264. 
265.     an1 = ax.annotate("Annotation", xy=(.9, .9), xytext=(1.1, 1.1),
266.                       arrowprops=dict(arrowstyle="->"), clip_on=False,
267.                       va="baseline", ha="left")
268. 
269.     da = DrawingArea(20, 20, 0, 0, clip=True)
270.     p = mpatches.Circle((-10, 30), 32)
271.     da.add_artist(p)
272. 
273.     ab3 = AnnotationBbox(da, [.5, .5], xybox=(-0.2, 0.5), xycoords='data',
274.                          boxcoords="axes fraction", box_alignment=(0., .5),
275.                          arrowprops=dict(arrowstyle="->"))
276.     ax.add_artist(ab3)
277. 
278.     im = OffsetImage(np.random.rand(10, 10), zoom=3)
279.     im.image.axes = ax
280.     ab6 = AnnotationBbox(im, (0.5, -.3), xybox=(0, 75),
281.                          xycoords='axes fraction',
282.                          boxcoords="offset points", pad=0.3,
283.                          arrowprops=dict(arrowstyle="->"))
284.     ax.add_artist(ab6)
285. 
286.     fig.canvas.draw()
287.     renderer = fig.canvas.get_renderer()
288. 
289.     # Test Annotation
290.     bb1w = an1.get_window_extent(renderer)
291.     bb1e = an1.get_tightbbox(renderer)
292. 
293.     target1 = [332.9, 242.8, 467.0, 298.9]
294.     assert_allclose(bb1w.extents, target1, atol=2)
295.     assert_allclose(bb1e.extents, target1, atol=2)
296. 
297.     # Test AnnotationBbox
298.     bb3w = ab3.get_window_extent(renderer)
299.     bb3e = ab3.get_tightbbox(renderer)
300. 
301.     target3 = [-17.6, 129.0, 200.7, 167.9]
302.     assert_allclose(bb3w.extents, target3, atol=2)
303.     assert_allclose(bb3e.extents, target3, atol=2)
304. 
305.     bb6w = ab6.get_window_extent(renderer)
306.     bb6e = ab6.get_tightbbox(renderer)
307. 
308.     target6 = [180.0, -32.0, 230.0, 92.9]
309.     assert_allclose(bb6w.extents, target6, atol=2)
310.     assert_allclose(bb6e.extents, target6, atol=2)
311. 
312.     # Test bbox_inches='tight'
313.     buf = io.BytesIO()
314.     fig.savefig(buf, bbox_inches='tight')
315.     buf.seek(0)
316.     shape = plt.imread(buf).shape
317.     targetshape = (350, 504, 4)
318.     assert_allclose(shape, targetshape, atol=2)
319. 
320.     # Simple smoke test for tight_layout, to make sure it does not error out.
321.     fig.canvas.draw()
322.     fig.tight_layout()
323.     fig.canvas.draw()
324. 
325. 
326. def test_zorder():
327.     assert OffsetBox(zorder=42).zorder == 42
328. 
329. 
330. def test_arrowprops_copied():
331.     da = DrawingArea(20, 20, 0, 0, clip=True)
332.     arrowprops = {"arrowstyle": "->", "relpos": (.3, .7)}
333.     ab = AnnotationBbox(da, [.5, .5], xybox=(-0.2, 0.5), xycoords='data',
334.                         boxcoords="axes fraction", box_alignment=(0., .5),
335.                         arrowprops=arrowprops)
336.     assert ab.arrowprops is not ab
337.     assert arrowprops["relpos"] == (.3, .7)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 00:39:36,731 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases for a bug in `HPacker` alignment. The provided context, `lib/matplotlib/tests/test_offsetbox.py`, does not contain any tests for `HPacker` or its alignment functionality. The `matplotlib.legend` functionality uses offsetboxes for layout, so its tests might contain relevant test cases that exercise the packer classes.' query='Please provide the full content of the file lib/matplotlib/tests/test_legend.py.' extra_requirements='' purpose='I need to analyze the legend tests to find test cases that are relevant to the `HPacker` alignment bug, as the legend implementation may use `HPacker` internally.'
2025-12-21 00:39:36,732 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file lib/matplotlib/tests/test_legend.py.
2025-12-21 00:39:36,732 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 00:39:36,733 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 00:39:36,733 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 00:39:36,733 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file lib/matplotlib/tests/test_legend.py.
Purpose: I need to analyze the legend tests to find test cases that are relevant to the `HPacker` alignment bug, as the legend implementation may use `HPacker` internally.
2025-12-21 00:39:39,897 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `lib/matplotlib/tests/test_legend.py` for you to analyze. This will allow you to examine the legend tests and identify any test cases that might be relevant to the `HPacker` alignment bug you are investigating.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_legend.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2145, 'candidates_token_count': 83, 'total_token_count': 2468, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2145}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 83}], 'thoughts_token_count': 240, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2315918336431664, 'model_name': 'gemini-2.5-pro'} id='run--b669374e-6978-4b21-962d-7b9714c797d6-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_legend.py'}, 'id': 'cc22cc66-06f5-4975-bb1c-afafe82194c8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2145, 'output_tokens': 83, 'total_tokens': 2468, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 240}}
2025-12-21 00:39:43,202 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have provided the full content of `lib/matplotlib/tests/test_legend.py`. You can now analyze the legend tests to find cases relevant to the `HPacker` alignment bug.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1000.0, "start_line": 501.0, "relative_path": "lib/matplotlib/tests/test_legend.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11187, 'candidates_token_count': 72, 'total_token_count': 11437, 'cached_content_token_count': 1861, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11187}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1861}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 72}], 'thoughts_token_count': 178}, 'finish_reason': 'STOP', 'avg_logprobs': -0.33066937658521867, 'model_name': 'gemini-2.5-pro'} id='run--e1183d7d-6462-41ee-97e0-360f6b58ab59-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1000.0, 'start_line': 501.0, 'relative_path': 'lib/matplotlib/tests/test_legend.py'}, 'id': '6063ba5e-d48f-4dc6-bda1-e53aa7317b80', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11187, 'output_tokens': 72, 'total_tokens': 11437, 'input_token_details': {'cache_read': 1861}, 'output_token_details': {'reasoning': 178}}
2025-12-21 00:39:44,784 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the rest of the content of the file `lib/matplotlib/tests/test_legend.py`. You now have the complete file for your analysis.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1269.0, "start_line": 1001.0, "relative_path": "lib/matplotlib/tests/test_legend.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20578, 'candidates_token_count': 65, 'total_token_count': 20643, 'cached_content_token_count': 11490, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20578}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11490}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 65}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.19980291219858023, 'model_name': 'gemini-2.5-pro'} id='run--a172d870-953d-4c16-ac39-d46d020bb8df-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1269.0, 'start_line': 1001.0, 'relative_path': 'lib/matplotlib/tests/test_legend.py'}, 'id': 'dfe7fc35-db74-41b2-bc10-aa90140ee440', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20578, 'output_tokens': 65, 'total_tokens': 20643, 'input_token_details': {'cache_read': 11490}}
2025-12-21 00:39:46,881 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have provided the full content of `lib/matplotlib/tests/test_legend.py`. You can now analyze the legend tests to find cases relevant to the `HPacker` alignment bug.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22336, 'candidates_token_count': 41, 'total_token_count': 22486, 'cached_content_token_count': 19177, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22336}], 'cache_tokens_details': [{'modality': 1, 'token_count': 19177}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 41}], 'thoughts_token_count': 109}, 'finish_reason': 'STOP', 'avg_logprobs': -0.38068929532679113, 'model_name': 'gemini-2.5-pro'} id='run--1433eb49-57cb-4649-89fa-1a204b00c152-0' usage_metadata={'input_tokens': 22336, 'output_tokens': 41, 'total_tokens': 22486, 'input_token_details': {'cache_read': 19177}, 'output_token_details': {'reasoning': 109}}
2025-12-21 00:39:46,883 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file lib/matplotlib/tests/test_legend.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to analyze the legend tests to find test cases that are relevant to the `HPacker` alignment bug, as the legend implementation may use `HPacker` internally.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_legend.py
Line number range: 1 - 500
Content:
1. import collections
2. import platform
3. from unittest import mock
4. import warnings
5. 
6. import numpy as np
7. import pytest
8. 
9. from matplotlib.testing.decorators import check_figures_equal, image_comparison
10. from matplotlib.testing._markers import needs_usetex
11. import matplotlib.pyplot as plt
12. import matplotlib as mpl
13. import matplotlib.transforms as mtransforms
14. import matplotlib.collections as mcollections
15. import matplotlib.lines as mlines
16. from matplotlib.legend_handler import HandlerTuple
17. import matplotlib.legend as mlegend
18. from matplotlib import rc_context
19. from matplotlib.font_manager import FontProperties
20. 
21. 
22. def test_legend_ordereddict():
23.     # smoketest that ordereddict inputs work...
24. 
25.     X = np.random.randn(10)
26.     Y = np.random.randn(10)
27.     labels = ['a'] * 5 + ['b'] * 5
28.     colors = ['r'] * 5 + ['g'] * 5
29. 
30.     fig, ax = plt.subplots()
31.     for x, y, label, color in zip(X, Y, labels, colors):
32.         ax.scatter(x, y, label=label, c=color)
33. 
34.     handles, labels = ax.get_legend_handles_labels()
35.     legend = collections.OrderedDict(zip(labels, handles))
36.     ax.legend(legend.values(), legend.keys(),
37.               loc='center left', bbox_to_anchor=(1, .5))
38. 
39. 
40. @image_comparison(['legend_auto1'], remove_text=True)
41. def test_legend_auto1():
42.     """Test automatic legend placement"""
43.     fig, ax = plt.subplots()
44.     x = np.arange(100)
45.     ax.plot(x, 50 - x, 'o', label='y=1')
46.     ax.plot(x, x - 50, 'o', label='y=-1')
47.     ax.legend(loc='best')
48. 
49. 
50. @image_comparison(['legend_auto2'], remove_text=True)
51. def test_legend_auto2():
52.     """Test automatic legend placement"""
53.     fig, ax = plt.subplots()
54.     x = np.arange(100)
55.     b1 = ax.bar(x, x, align='edge', color='m')
56.     b2 = ax.bar(x, x[::-1], align='edge', color='g')
57.     ax.legend([b1[0], b2[0]], ['up', 'down'], loc='best')
58. 
59. 
60. @image_comparison(['legend_auto3'])
61. def test_legend_auto3():
62.     """Test automatic legend placement"""
63.     fig, ax = plt.subplots()
64.     x = [0.9, 0.1, 0.1, 0.9, 0.9, 0.5]
65.     y = [0.95, 0.95, 0.05, 0.05, 0.5, 0.5]
66.     ax.plot(x, y, 'o-', label='line')
67.     ax.set_xlim(0.0, 1.0)
68.     ax.set_ylim(0.0, 1.0)
69.     ax.legend(loc='best')
70. 
71. 
72. @image_comparison(['legend_various_labels'], remove_text=True)
73. def test_various_labels():
74.     # tests all sorts of label types
75.     fig = plt.figure()
76.     ax = fig.add_subplot(121)
77.     ax.plot(np.arange(4), 'o', label=1)
78.     ax.plot(np.linspace(4, 4.1), 'o', label='Développés')
79.     ax.plot(np.arange(4, 1, -1), 'o', label='__nolegend__')
80.     ax.legend(numpoints=1, loc='best')
81. 
82. 
83. def test_legend_label_with_leading_underscore():
84.     """
85.     Test that artists with labels starting with an underscore are not added to
86.     the legend, and that a warning is issued if one tries to add them
87.     explicitly.
88.     """
89.     fig, ax = plt.subplots()
90.     line, = ax.plot([0, 1], label='_foo')
91.     with pytest.warns(UserWarning,
92.                       match=r"starts with '_'.*excluded from the legend."):
93.         legend = ax.legend(handles=[line])
94.     assert len(legend.legendHandles) == 0
95. 
96. 
97. @image_comparison(['legend_labels_first.png'], remove_text=True)
98. def test_labels_first():
99.     # test labels to left of markers
100.     fig, ax = plt.subplots()
101.     ax.plot(np.arange(10), '-o', label=1)
102.     ax.plot(np.ones(10)*5, ':x', label="x")
103.     ax.plot(np.arange(20, 10, -1), 'd', label="diamond")
104.     ax.legend(loc='best', markerfirst=False)
105. 
106. 
107. @image_comparison(['legend_multiple_keys.png'], remove_text=True)
108. def test_multiple_keys():
109.     # test legend entries with multiple keys
110.     fig, ax = plt.subplots()
111.     p1, = ax.plot([1, 2, 3], '-o')
112.     p2, = ax.plot([2, 3, 4], '-x')
113.     p3, = ax.plot([3, 4, 5], '-d')
114.     ax.legend([(p1, p2), (p2, p1), p3], ['two keys', 'pad=0', 'one key'],
115.               numpoints=1,
116.               handler_map={(p1, p2): HandlerTuple(ndivide=None),
117.                            (p2, p1): HandlerTuple(ndivide=None, pad=0)})
118. 
119. 
120. @image_comparison(['rgba_alpha.png'], remove_text=True,
121.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
122. def test_alpha_rgba():
123.     fig, ax = plt.subplots()
124.     ax.plot(range(10), lw=5)
125.     leg = plt.legend(['Longlabel that will go away'], loc='center')
126.     leg.legendPatch.set_facecolor([1, 0, 0, 0.5])
127. 
128. 
129. @image_comparison(['rcparam_alpha.png'], remove_text=True,
130.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
131. def test_alpha_rcparam():
132.     fig, ax = plt.subplots()
133.     ax.plot(range(10), lw=5)
134.     with mpl.rc_context(rc={'legend.framealpha': .75}):
135.         leg = plt.legend(['Longlabel that will go away'], loc='center')
136.         # this alpha is going to be over-ridden by the rcparam with
137.         # sets the alpha of the patch to be non-None which causes the alpha
138.         # value of the face color to be discarded.  This behavior may not be
139.         # ideal, but it is what it is and we should keep track of it changing
140.         leg.legendPatch.set_facecolor([1, 0, 0, 0.5])
141. 
142. 
143. @image_comparison(['fancy'], remove_text=True)
144. def test_fancy():
145.     # using subplot triggers some offsetbox functionality untested elsewhere
146.     plt.subplot(121)
147.     plt.plot([5] * 10, 'o--', label='XX')
148.     plt.scatter(np.arange(10), np.arange(10, 0, -1), label='XX\nXX')
149.     plt.errorbar(np.arange(10), np.arange(10), xerr=0.5,
150.                  yerr=0.5, label='XX')
151.     plt.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
152.                ncols=2, shadow=True, title="My legend", numpoints=1)
153. 
154. 
155. @image_comparison(['framealpha'], remove_text=True,
156.                   tol=0 if platform.machine() == 'x86_64' else 0.02)
157. def test_framealpha():
158.     x = np.linspace(1, 100, 100)
159.     y = x
160.     plt.plot(x, y, label='mylabel', lw=10)
161.     plt.legend(framealpha=0.5)
162. 
163. 
164. @image_comparison(['scatter_rc3', 'scatter_rc1'], remove_text=True)
165. def test_rc():
166.     # using subplot triggers some offsetbox functionality untested elsewhere
167.     plt.figure()
168.     ax = plt.subplot(121)
169.     ax.scatter(np.arange(10), np.arange(10, 0, -1), label='three')
170.     ax.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
171.               title="My legend")
172. 
173.     mpl.rcParams['legend.scatterpoints'] = 1
174.     plt.figure()
175.     ax = plt.subplot(121)
176.     ax.scatter(np.arange(10), np.arange(10, 0, -1), label='one')
177.     ax.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
178.               title="My legend")
179. 
180. 
181. @image_comparison(['legend_expand'], remove_text=True)
182. def test_legend_expand():
183.     """Test expand mode"""
184.     legend_modes = [None, "expand"]
185.     fig, axs = plt.subplots(len(legend_modes), 1)
186.     x = np.arange(100)
187.     for ax, mode in zip(axs, legend_modes):
188.         ax.plot(x, 50 - x, 'o', label='y=1')
189.         l1 = ax.legend(loc='upper left', mode=mode)
190.         ax.add_artist(l1)
191.         ax.plot(x, x - 50, 'o', label='y=-1')
192.         l2 = ax.legend(loc='right', mode=mode)
193.         ax.add_artist(l2)
194.         ax.legend(loc='lower left', mode=mode, ncols=2)
195. 
196. 
197. @image_comparison(['hatching'], remove_text=True, style='default')
198. def test_hatching():
199.     # Remove this line when this test image is regenerated.
200.     plt.rcParams['text.kerning_factor'] = 6
201. 
202.     fig, ax = plt.subplots()
203. 
204.     # Patches
205.     patch = plt.Rectangle((0, 0), 0.3, 0.3, hatch='xx',
206.                           label='Patch\ndefault color\nfilled')
207.     ax.add_patch(patch)
208.     patch = plt.Rectangle((0.33, 0), 0.3, 0.3, hatch='||', edgecolor='C1',
209.                           label='Patch\nexplicit color\nfilled')
210.     ax.add_patch(patch)
211.     patch = plt.Rectangle((0, 0.4), 0.3, 0.3, hatch='xx', fill=False,
212.                           label='Patch\ndefault color\nunfilled')
213.     ax.add_patch(patch)
214.     patch = plt.Rectangle((0.33, 0.4), 0.3, 0.3, hatch='||', fill=False,
215.                           edgecolor='C1',
216.                           label='Patch\nexplicit color\nunfilled')
217.     ax.add_patch(patch)
218. 
219.     # Paths
220.     ax.fill_between([0, .15, .3], [.8, .8, .8], [.9, 1.0, .9],
221.                     hatch='+', label='Path\ndefault color')
222.     ax.fill_between([.33, .48, .63], [.8, .8, .8], [.9, 1.0, .9],
223.                     hatch='+', edgecolor='C2', label='Path\nexplicit color')
224. 
225.     ax.set_xlim(-0.01, 1.1)
226.     ax.set_ylim(-0.01, 1.1)
227.     ax.legend(handlelength=4, handleheight=4)
228. 
229. 
230. def test_legend_remove():
231.     fig, ax = plt.subplots()
232.     lines = ax.plot(range(10))
233.     leg = fig.legend(lines, "test")
234.     leg.remove()
235.     assert fig.legends == []
236.     leg = ax.legend("test")
237.     leg.remove()
238.     assert ax.get_legend() is None
239. 
240. 
241. class TestLegendFunction:
242.     # Tests the legend function on the Axes and pyplot.
243.     def test_legend_no_args(self):
244.         lines = plt.plot(range(10), label='hello world')
245.         with mock.patch('matplotlib.legend.Legend') as Legend:
246.             plt.legend()
247.         Legend.assert_called_with(plt.gca(), lines, ['hello world'])
248. 
249.     def test_legend_positional_handles_labels(self):
250.         lines = plt.plot(range(10))
251.         with mock.patch('matplotlib.legend.Legend') as Legend:
252.             plt.legend(lines, ['hello world'])
253.         Legend.assert_called_with(plt.gca(), lines, ['hello world'])
254. 
255.     def test_legend_positional_handles_only(self):
256.         lines = plt.plot(range(10))
257.         with pytest.raises(TypeError, match='but found an Artist'):
258.             # a single arg is interpreted as labels
259.             # it's a common error to just pass handles
260.             plt.legend(lines)
261. 
262.     def test_legend_positional_labels_only(self):
263.         lines = plt.plot(range(10), label='hello world')
264.         with mock.patch('matplotlib.legend.Legend') as Legend:
265.             plt.legend(['foobar'])
266.         Legend.assert_called_with(plt.gca(), lines, ['foobar'])
267. 
268.     def test_legend_three_args(self):
269.         lines = plt.plot(range(10), label='hello world')
270.         with mock.patch('matplotlib.legend.Legend') as Legend:
271.             plt.legend(lines, ['foobar'], loc='right')
272.         Legend.assert_called_with(plt.gca(), lines, ['foobar'], loc='right')
273. 
274.     def test_legend_handler_map(self):
275.         lines = plt.plot(range(10), label='hello world')
276.         with mock.patch('matplotlib.legend.'
277.                         '_get_legend_handles_labels') as handles_labels:
278.             handles_labels.return_value = lines, ['hello world']
279.             plt.legend(handler_map={'1': 2})
280.         handles_labels.assert_called_with([plt.gca()], {'1': 2})
281. 
282.     def test_legend_kwargs_handles_only(self):
283.         fig, ax = plt.subplots()
284.         x = np.linspace(0, 1, 11)
285.         ln1, = ax.plot(x, x, label='x')
286.         ln2, = ax.plot(x, 2*x, label='2x')
287.         ln3, = ax.plot(x, 3*x, label='3x')
288.         with mock.patch('matplotlib.legend.Legend') as Legend:
289.             ax.legend(handles=[ln3, ln2])  # reversed and not ln1
290.         Legend.assert_called_with(ax, [ln3, ln2], ['3x', '2x'])
291. 
292.     def test_legend_kwargs_labels_only(self):
293.         fig, ax = plt.subplots()
294.         x = np.linspace(0, 1, 11)
295.         ln1, = ax.plot(x, x)
296.         ln2, = ax.plot(x, 2*x)
297.         with mock.patch('matplotlib.legend.Legend') as Legend:
298.             ax.legend(labels=['x', '2x'])
299.         Legend.assert_called_with(ax, [ln1, ln2], ['x', '2x'])
300. 
301.     def test_legend_kwargs_handles_labels(self):
302.         fig, ax = plt.subplots()
303.         th = np.linspace(0, 2*np.pi, 1024)
304.         lns, = ax.plot(th, np.sin(th), label='sin')
305.         lnc, = ax.plot(th, np.cos(th), label='cos')
306.         with mock.patch('matplotlib.legend.Legend') as Legend:
307.             # labels of lns, lnc are overwritten with explicit ('a', 'b')
308.             ax.legend(labels=('a', 'b'), handles=(lnc, lns))
309.         Legend.assert_called_with(ax, (lnc, lns), ('a', 'b'))
310. 
311.     def test_warn_mixed_args_and_kwargs(self):
312.         fig, ax = plt.subplots()
313.         th = np.linspace(0, 2*np.pi, 1024)
314.         lns, = ax.plot(th, np.sin(th), label='sin')
315.         lnc, = ax.plot(th, np.cos(th), label='cos')
316.         with pytest.warns(UserWarning) as record:
317.             ax.legend((lnc, lns), labels=('a', 'b'))
318.         assert len(record) == 1
319.         assert str(record[0].message) == (
320.             "You have mixed positional and keyword arguments, some input may "
321.             "be discarded.")
322. 
323.     def test_parasite(self):
324.         from mpl_toolkits.axes_grid1 import host_subplot
325. 
326.         host = host_subplot(111)
327.         par = host.twinx()
328. 
329.         p1, = host.plot([0, 1, 2], [0, 1, 2], label="Density")
330.         p2, = par.plot([0, 1, 2], [0, 3, 2], label="Temperature")
331. 
332.         with mock.patch('matplotlib.legend.Legend') as Legend:
333.             plt.legend()
334.         Legend.assert_called_with(host, [p1, p2], ['Density', 'Temperature'])
335. 
336. 
337. class TestLegendFigureFunction:
338.     # Tests the legend function for figure
339.     def test_legend_handle_label(self):
340.         fig, ax = plt.subplots()
341.         lines = ax.plot(range(10))
342.         with mock.patch('matplotlib.legend.Legend') as Legend:
343.             fig.legend(lines, ['hello world'])
344.         Legend.assert_called_with(fig, lines, ['hello world'],
345.                                   bbox_transform=fig.transFigure)
346. 
347.     def test_legend_no_args(self):
348.         fig, ax = plt.subplots()
349.         lines = ax.plot(range(10), label='hello world')
350.         with mock.patch('matplotlib.legend.Legend') as Legend:
351.             fig.legend()
352.         Legend.assert_called_with(fig, lines, ['hello world'],
353.                                   bbox_transform=fig.transFigure)
354. 
355.     def test_legend_label_arg(self):
356.         fig, ax = plt.subplots()
357.         lines = ax.plot(range(10))
358.         with mock.patch('matplotlib.legend.Legend') as Legend:
359.             fig.legend(['foobar'])
360.         Legend.assert_called_with(fig, lines, ['foobar'],
361.                                   bbox_transform=fig.transFigure)
362. 
363.     def test_legend_label_three_args(self):
364.         fig, ax = plt.subplots()
365.         lines = ax.plot(range(10))
366.         with mock.patch('matplotlib.legend.Legend') as Legend:
367.             fig.legend(lines, ['foobar'], 'right')
368.         Legend.assert_called_with(fig, lines, ['foobar'], 'right',
369.                                   bbox_transform=fig.transFigure)
370. 
371.     def test_legend_label_three_args_pluskw(self):
372.         # test that third argument and loc=  called together give
373.         # Exception
374.         fig, ax = plt.subplots()
375.         lines = ax.plot(range(10))
376.         with pytest.raises(Exception):
377.             fig.legend(lines, ['foobar'], 'right', loc='left')
378. 
379.     def test_legend_kw_args(self):
380.         fig, axs = plt.subplots(1, 2)
381.         lines = axs[0].plot(range(10))
382.         lines2 = axs[1].plot(np.arange(10) * 2.)
383.         with mock.patch('matplotlib.legend.Legend') as Legend:
384.             fig.legend(loc='right', labels=('a', 'b'), handles=(lines, lines2))
385.         Legend.assert_called_with(
386.             fig, (lines, lines2), ('a', 'b'), loc='right',
387.             bbox_transform=fig.transFigure)
388. 
389.     def test_warn_args_kwargs(self):
390.         fig, axs = plt.subplots(1, 2)
391.         lines = axs[0].plot(range(10))
392.         lines2 = axs[1].plot(np.arange(10) * 2.)
393.         with pytest.warns(UserWarning) as record:
394.             fig.legend((lines, lines2), labels=('a', 'b'))
395.         assert len(record) == 1
396.         assert str(record[0].message) == (
397.             "You have mixed positional and keyword arguments, some input may "
398.             "be discarded.")
399. 
400. 
401. @image_comparison(['legend_stackplot.png'])
402. def test_legend_stackplot():
403.     """Test legend for PolyCollection using stackplot."""
404.     # related to #1341, #1943, and PR #3303
405.     fig, ax = plt.subplots()
406.     x = np.linspace(0, 10, 10)
407.     y1 = 1.0 * x
408.     y2 = 2.0 * x + 1
409.     y3 = 3.0 * x + 2
410.     ax.stackplot(x, y1, y2, y3, labels=['y1', 'y2', 'y3'])
411.     ax.set_xlim((0, 10))
412.     ax.set_ylim((0, 70))
413.     ax.legend(loc='best')
414. 
415. 
416. def test_cross_figure_patch_legend():
417.     fig, ax = plt.subplots()
418.     fig2, ax2 = plt.subplots()
419. 
420.     brs = ax.bar(range(3), range(3))
421.     fig2.legend(brs, 'foo')
422. 
423. 
424. def test_nanscatter():
425.     fig, ax = plt.subplots()
426. 
427.     h = ax.scatter([np.nan], [np.nan], marker="o",
428.                    facecolor="r", edgecolor="r", s=3)
429. 
430.     ax.legend([h], ["scatter"])
431. 
432.     fig, ax = plt.subplots()
433.     for color in ['red', 'green', 'blue']:
434.         n = 750
435.         x, y = np.random.rand(2, n)
436.         scale = 200.0 * np.random.rand(n)
437.         ax.scatter(x, y, c=color, s=scale, label=color,
438.                    alpha=0.3, edgecolors='none')
439. 
440.     ax.legend()
441.     ax.grid(True)
442. 
443. 
444. def test_legend_repeatcheckok():
445.     fig, ax = plt.subplots()
446.     ax.scatter(0.0, 1.0, color='k', marker='o', label='test')
447.     ax.scatter(0.5, 0.0, color='r', marker='v', label='test')
448.     ax.legend()
449.     hand, lab = mlegend._get_legend_handles_labels([ax])
450.     assert len(lab) == 2
451.     fig, ax = plt.subplots()
452.     ax.scatter(0.0, 1.0, color='k', marker='o', label='test')
453.     ax.scatter(0.5, 0.0, color='k', marker='v', label='test')
454.     ax.legend()
455.     hand, lab = mlegend._get_legend_handles_labels([ax])
456.     assert len(lab) == 2
457. 
458. 
459. @image_comparison(['not_covering_scatter.png'])
460. def test_not_covering_scatter():
461.     colors = ['b', 'g', 'r']
462. 
463.     for n in range(3):
464.         plt.scatter([n], [n], color=colors[n])
465. 
466.     plt.legend(['foo', 'foo', 'foo'], loc='best')
467.     plt.gca().set_xlim(-0.5, 2.2)
468.     plt.gca().set_ylim(-0.5, 2.2)
469. 
470. 
471. @image_comparison(['not_covering_scatter_transform.png'])
472. def test_not_covering_scatter_transform():
473.     # Offsets point to top left, the default auto position
474.     offset = mtransforms.Affine2D().translate(-20, 20)
475.     x = np.linspace(0, 30, 1000)
476.     plt.plot(x, x)
477. 
478.     plt.scatter([20], [10], transform=offset + plt.gca().transData)
479. 
480.     plt.legend(['foo', 'bar'], loc='best')
481. 
482. 
483. def test_linecollection_scaled_dashes():
484.     lines1 = [[(0, .5), (.5, 1)], [(.3, .6), (.2, .2)]]
485.     lines2 = [[[0.7, .2], [.8, .4]], [[.5, .7], [.6, .1]]]
486.     lines3 = [[[0.6, .2], [.8, .4]], [[.5, .7], [.1, .1]]]
487.     lc1 = mcollections.LineCollection(lines1, linestyles="--", lw=3)
488.     lc2 = mcollections.LineCollection(lines2, linestyles="-.")
489.     lc3 = mcollections.LineCollection(lines3, linestyles=":", lw=.5)
490. 
491.     fig, ax = plt.subplots()
492.     ax.add_collection(lc1)
493.     ax.add_collection(lc2)
494.     ax.add_collection(lc3)
495. 
496.     leg = ax.legend([lc1, lc2, lc3], ["line1", "line2", 'line 3'])
497.     h1, h2, h3 = leg.legendHandles
498. 
499.     for oh, lh in zip((lc1, lc2, lc3), (h1, h2, h3)):
500.         assert oh.get_linestyles()[0] == lh._dash_pattern


File: lib/matplotlib/tests/test_legend.py
Line number range: 501 - 1000
Content:
501. 
502. 
503. def test_handler_numpoints():
504.     """Test legend handler with numpoints <= 1."""
505.     # related to #6921 and PR #8478
506.     fig, ax = plt.subplots()
507.     ax.plot(range(5), label='test')
508.     ax.legend(numpoints=0.5)
509. 
510. 
511. def test_text_nohandler_warning():
512.     """Test that Text artists with labels raise a warning"""
513.     fig, ax = plt.subplots()
514.     ax.text(x=0, y=0, s="text", label="label")
515.     with pytest.warns(UserWarning) as record:
516.         ax.legend()
517.     assert len(record) == 1
518. 
519.     # this should _not_ warn:
520.     f, ax = plt.subplots()
521.     ax.pcolormesh(np.random.uniform(0, 1, (10, 10)))
522.     with warnings.catch_warnings():
523.         warnings.simplefilter("error")
524.         ax.get_legend_handles_labels()
525. 
526. 
527. def test_empty_bar_chart_with_legend():
528.     """Test legend when bar chart is empty with a label."""
529.     # related to issue #13003. Calling plt.legend() should not
530.     # raise an IndexError.
531.     plt.bar([], [], label='test')
532.     plt.legend()
533. 
534. 
535. def test_shadow_framealpha():
536.     # Test if framealpha is activated when shadow is True
537.     # and framealpha is not explicitly passed'''
538.     fig, ax = plt.subplots()
539.     ax.plot(range(100), label="test")
540.     leg = ax.legend(shadow=True, facecolor='w')
541.     assert leg.get_frame().get_alpha() == 1
542. 
543. 
544. def test_legend_title_empty():
545.     # test that if we don't set the legend title, that
546.     # it comes back as an empty string, and that it is not
547.     # visible:
548.     fig, ax = plt.subplots()
549.     ax.plot(range(10))
550.     leg = ax.legend()
551.     assert leg.get_title().get_text() == ""
552.     assert not leg.get_title().get_visible()
553. 
554. 
555. def test_legend_proper_window_extent():
556.     # test that legend returns the expected extent under various dpi...
557.     fig, ax = plt.subplots(dpi=100)
558.     ax.plot(range(10), label='Aardvark')
559.     leg = ax.legend()
560.     x01 = leg.get_window_extent(fig.canvas.get_renderer()).x0
561. 
562.     fig, ax = plt.subplots(dpi=200)
563.     ax.plot(range(10), label='Aardvark')
564.     leg = ax.legend()
565.     x02 = leg.get_window_extent(fig.canvas.get_renderer()).x0
566.     assert pytest.approx(x01*2, 0.1) == x02
567. 
568. 
569. def test_window_extent_cached_renderer():
570.     fig, ax = plt.subplots(dpi=100)
571.     ax.plot(range(10), label='Aardvark')
572.     leg = ax.legend()
573.     leg2 = fig.legend()
574.     fig.canvas.draw()
575.     # check that get_window_extent will use the cached renderer
576.     leg.get_window_extent()
577.     leg2.get_window_extent()
578. 
579. 
580. def test_legend_title_fontprop_fontsize():
581.     # test the title_fontsize kwarg
582.     plt.plot(range(10))
583.     with pytest.raises(ValueError):
584.         plt.legend(title='Aardvark', title_fontsize=22,
585.                    title_fontproperties={'family': 'serif', 'size': 22})
586. 
587.     leg = plt.legend(title='Aardvark', title_fontproperties=FontProperties(
588.                                        family='serif', size=22))
589.     assert leg.get_title().get_size() == 22
590. 
591.     fig, axes = plt.subplots(2, 3, figsize=(10, 6))
592.     axes = axes.flat
593.     axes[0].plot(range(10))
594.     leg0 = axes[0].legend(title='Aardvark', title_fontsize=22)
595.     assert leg0.get_title().get_fontsize() == 22
596.     axes[1].plot(range(10))
597.     leg1 = axes[1].legend(title='Aardvark',
598.                           title_fontproperties={'family': 'serif', 'size': 22})
599.     assert leg1.get_title().get_fontsize() == 22
600.     axes[2].plot(range(10))
601.     mpl.rcParams['legend.title_fontsize'] = None
602.     leg2 = axes[2].legend(title='Aardvark',
603.                           title_fontproperties={'family': 'serif'})
604.     assert leg2.get_title().get_fontsize() == mpl.rcParams['font.size']
605.     axes[3].plot(range(10))
606.     leg3 = axes[3].legend(title='Aardvark')
607.     assert leg3.get_title().get_fontsize() == mpl.rcParams['font.size']
608.     axes[4].plot(range(10))
609.     mpl.rcParams['legend.title_fontsize'] = 20
610.     leg4 = axes[4].legend(title='Aardvark',
611.                           title_fontproperties={'family': 'serif'})
612.     assert leg4.get_title().get_fontsize() == 20
613.     axes[5].plot(range(10))
614.     leg5 = axes[5].legend(title='Aardvark')
615.     assert leg5.get_title().get_fontsize() == 20
616. 
617. 
618. @pytest.mark.parametrize('alignment', ('center', 'left', 'right'))
619. def test_legend_alignment(alignment):
620.     fig, ax = plt.subplots()
621.     ax.plot(range(10), label='test')
622.     leg = ax.legend(title="Aardvark", alignment=alignment)
623.     assert leg.get_children()[0].align == alignment
624.     assert leg.get_alignment() == alignment
625. 
626. 
627. @pytest.mark.parametrize('alignment', ('center', 'left', 'right'))
628. def test_legend_set_alignment(alignment):
629.     fig, ax = plt.subplots()
630.     ax.plot(range(10), label='test')
631.     leg = ax.legend()
632.     leg.set_alignment(alignment)
633.     assert leg.get_children()[0].align == alignment
634.     assert leg.get_alignment() == alignment
635. 
636. 
637. @pytest.mark.parametrize('color', ('red', 'none', (.5, .5, .5)))
638. def test_legend_labelcolor_single(color):
639.     # test labelcolor for a single color
640.     fig, ax = plt.subplots()
641.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
642.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
643.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
644. 
645.     leg = ax.legend(labelcolor=color)
646.     for text in leg.get_texts():
647.         assert mpl.colors.same_color(text.get_color(), color)
648. 
649. 
650. def test_legend_labelcolor_list():
651.     # test labelcolor for a list of colors
652.     fig, ax = plt.subplots()
653.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
654.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
655.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
656. 
657.     leg = ax.legend(labelcolor=['r', 'g', 'b'])
658.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
659.         assert mpl.colors.same_color(text.get_color(), color)
660. 
661. 
662. def test_legend_labelcolor_linecolor():
663.     # test the labelcolor for labelcolor='linecolor'
664.     fig, ax = plt.subplots()
665.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', color='r')
666.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', color='g')
667.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', color='b')
668. 
669.     leg = ax.legend(labelcolor='linecolor')
670.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
671.         assert mpl.colors.same_color(text.get_color(), color)
672. 
673. 
674. def test_legend_pathcollection_labelcolor_linecolor():
675.     # test the labelcolor for labelcolor='linecolor' on PathCollection
676.     fig, ax = plt.subplots()
677.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c='r')
678.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', c='g')
679.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', c='b')
680. 
681.     leg = ax.legend(labelcolor='linecolor')
682.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
683.         assert mpl.colors.same_color(text.get_color(), color)
684. 
685. 
686. def test_legend_pathcollection_labelcolor_linecolor_iterable():
687.     # test the labelcolor for labelcolor='linecolor' on PathCollection
688.     # with iterable colors
689.     fig, ax = plt.subplots()
690.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
691.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c=colors)
692. 
693.     leg = ax.legend(labelcolor='linecolor')
694.     text, = leg.get_texts()
695.     assert mpl.colors.same_color(text.get_color(), 'black')
696. 
697. 
698. def test_legend_pathcollection_labelcolor_linecolor_cmap():
699.     # test the labelcolor for labelcolor='linecolor' on PathCollection
700.     # with a colormap
701.     fig, ax = plt.subplots()
702.     ax.scatter(np.arange(10), np.arange(10), c=np.arange(10), label='#1')
703. 
704.     leg = ax.legend(labelcolor='linecolor')
705.     text, = leg.get_texts()
706.     assert mpl.colors.same_color(text.get_color(), 'black')
707. 
708. 
709. def test_legend_labelcolor_markeredgecolor():
710.     # test the labelcolor for labelcolor='markeredgecolor'
711.     fig, ax = plt.subplots()
712.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
713.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
714.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
715. 
716.     leg = ax.legend(labelcolor='markeredgecolor')
717.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
718.         assert mpl.colors.same_color(text.get_color(), color)
719. 
720. 
721. def test_legend_pathcollection_labelcolor_markeredgecolor():
722.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
723.     fig, ax = plt.subplots()
724.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor='r')
725.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', edgecolor='g')
726.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', edgecolor='b')
727. 
728.     leg = ax.legend(labelcolor='markeredgecolor')
729.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
730.         assert mpl.colors.same_color(text.get_color(), color)
731. 
732. 
733. def test_legend_pathcollection_labelcolor_markeredgecolor_iterable():
734.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
735.     # with iterable colors
736.     fig, ax = plt.subplots()
737.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
738.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor=colors)
739. 
740.     leg = ax.legend(labelcolor='markeredgecolor')
741.     for text, color in zip(leg.get_texts(), ['k']):
742.         assert mpl.colors.same_color(text.get_color(), color)
743. 
744. 
745. def test_legend_pathcollection_labelcolor_markeredgecolor_cmap():
746.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
747.     # with a colormap
748.     fig, ax = plt.subplots()
749.     edgecolors = mpl.cm.viridis(np.random.rand(10))
750.     ax.scatter(
751.         np.arange(10),
752.         np.arange(10),
753.         label='#1',
754.         c=np.arange(10),
755.         edgecolor=edgecolors,
756.         cmap="Reds"
757.     )
758. 
759.     leg = ax.legend(labelcolor='markeredgecolor')
760.     for text, color in zip(leg.get_texts(), ['k']):
761.         assert mpl.colors.same_color(text.get_color(), color)
762. 
763. 
764. def test_legend_labelcolor_markerfacecolor():
765.     # test the labelcolor for labelcolor='markerfacecolor'
766.     fig, ax = plt.subplots()
767.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
768.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
769.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
770. 
771.     leg = ax.legend(labelcolor='markerfacecolor')
772.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
773.         assert mpl.colors.same_color(text.get_color(), color)
774. 
775. 
776. def test_legend_pathcollection_labelcolor_markerfacecolor():
777.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
778.     fig, ax = plt.subplots()
779.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor='r')
780.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', facecolor='g')
781.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', facecolor='b')
782. 
783.     leg = ax.legend(labelcolor='markerfacecolor')
784.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
785.         assert mpl.colors.same_color(text.get_color(), color)
786. 
787. 
788. def test_legend_pathcollection_labelcolor_markerfacecolor_iterable():
789.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
790.     # with iterable colors
791.     fig, ax = plt.subplots()
792.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
793.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor=colors)
794. 
795.     leg = ax.legend(labelcolor='markerfacecolor')
796.     for text, color in zip(leg.get_texts(), ['k']):
797.         assert mpl.colors.same_color(text.get_color(), color)
798. 
799. 
800. def test_legend_pathcollection_labelcolor_markfacecolor_cmap():
801.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
802.     # with colormaps
803.     fig, ax = plt.subplots()
804.     facecolors = mpl.cm.viridis(np.random.rand(10))
805.     ax.scatter(
806.         np.arange(10),
807.         np.arange(10),
808.         label='#1',
809.         c=np.arange(10),
810.         facecolor=facecolors
811.     )
812. 
813.     leg = ax.legend(labelcolor='markerfacecolor')
814.     for text, color in zip(leg.get_texts(), ['k']):
815.         assert mpl.colors.same_color(text.get_color(), color)
816. 
817. 
818. @pytest.mark.parametrize('color', ('red', 'none', (.5, .5, .5)))
819. def test_legend_labelcolor_rcparam_single(color):
820.     # test the rcParams legend.labelcolor for a single color
821.     fig, ax = plt.subplots()
822.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
823.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
824.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
825. 
826.     mpl.rcParams['legend.labelcolor'] = color
827.     leg = ax.legend()
828.     for text in leg.get_texts():
829.         assert mpl.colors.same_color(text.get_color(), color)
830. 
831. 
832. def test_legend_labelcolor_rcparam_linecolor():
833.     # test the rcParams legend.labelcolor for a linecolor
834.     fig, ax = plt.subplots()
835.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', color='r')
836.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', color='g')
837.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', color='b')
838. 
839.     mpl.rcParams['legend.labelcolor'] = 'linecolor'
840.     leg = ax.legend()
841.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
842.         assert mpl.colors.same_color(text.get_color(), color)
843. 
844. 
845. def test_legend_labelcolor_rcparam_markeredgecolor():
846.     # test the labelcolor for labelcolor='markeredgecolor'
847.     fig, ax = plt.subplots()
848.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
849.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
850.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
851. 
852.     mpl.rcParams['legend.labelcolor'] = 'markeredgecolor'
853.     leg = ax.legend()
854.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
855.         assert mpl.colors.same_color(text.get_color(), color)
856. 
857. 
858. def test_legend_labelcolor_rcparam_markeredgecolor_short():
859.     # test the labelcolor for labelcolor='markeredgecolor'
860.     fig, ax = plt.subplots()
861.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
862.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
863.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
864. 
865.     mpl.rcParams['legend.labelcolor'] = 'mec'
866.     leg = ax.legend()
867.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
868.         assert mpl.colors.same_color(text.get_color(), color)
869. 
870. 
871. def test_legend_labelcolor_rcparam_markerfacecolor():
872.     # test the labelcolor for labelcolor='markeredgecolor'
873.     fig, ax = plt.subplots()
874.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
875.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
876.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
877. 
878.     mpl.rcParams['legend.labelcolor'] = 'markerfacecolor'
879.     leg = ax.legend()
880.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
881.         assert mpl.colors.same_color(text.get_color(), color)
882. 
883. 
884. def test_legend_labelcolor_rcparam_markerfacecolor_short():
885.     # test the labelcolor for labelcolor='markeredgecolor'
886.     fig, ax = plt.subplots()
887.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
888.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
889.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
890. 
891.     mpl.rcParams['legend.labelcolor'] = 'mfc'
892.     leg = ax.legend()
893.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
894.         assert mpl.colors.same_color(text.get_color(), color)
895. 
896. 
897. def test_get_set_draggable():
898.     legend = plt.legend()
899.     assert not legend.get_draggable()
900.     legend.set_draggable(True)
901.     assert legend.get_draggable()
902.     legend.set_draggable(False)
903.     assert not legend.get_draggable()
904. 
905. 
906. @pytest.mark.parametrize('draggable', (True, False))
907. def test_legend_draggable(draggable):
908.     fig, ax = plt.subplots()
909.     ax.plot(range(10), label='shabnams')
910.     leg = ax.legend(draggable=draggable)
911.     assert leg.get_draggable() is draggable
912. 
913. 
914. def test_alpha_handles():
915.     x, n, hh = plt.hist([1, 2, 3], alpha=0.25, label='data', color='red')
916.     legend = plt.legend()
917.     for lh in legend.legendHandles:
918.         lh.set_alpha(1.0)
919.     assert lh.get_facecolor()[:-1] == hh[1].get_facecolor()[:-1]
920.     assert lh.get_edgecolor()[:-1] == hh[1].get_edgecolor()[:-1]
921. 
922. 
923. @needs_usetex
924. def test_usetex_no_warn(caplog):
925.     mpl.rcParams['font.family'] = 'serif'
926.     mpl.rcParams['font.serif'] = 'Computer Modern'
927.     mpl.rcParams['text.usetex'] = True
928. 
929.     fig, ax = plt.subplots()
930.     ax.plot(0, 0, label='input')
931.     ax.legend(title="My legend")
932. 
933.     fig.canvas.draw()
934.     assert "Font family ['serif'] not found." not in caplog.text
935. 
936. 
937. def test_warn_big_data_best_loc():
938.     fig, ax = plt.subplots()
939.     fig.canvas.draw()  # So that we can call draw_artist later.
940.     for idx in range(1000):
941.         ax.plot(np.arange(5000), label=idx)
942.     with rc_context({'legend.loc': 'best'}):
943.         legend = ax.legend()
944.     with pytest.warns(UserWarning) as records:
945.         fig.draw_artist(legend)  # Don't bother drawing the lines -- it's slow.
946.     # The _find_best_position method of Legend is called twice, duplicating
947.     # the warning message.
948.     assert len(records) == 2
949.     for record in records:
950.         assert str(record.message) == (
951.             'Creating legend with loc="best" can be slow with large '
952.             'amounts of data.')
953. 
954. 
955. def test_no_warn_big_data_when_loc_specified():
956.     fig, ax = plt.subplots()
957.     fig.canvas.draw()
958.     for idx in range(1000):
959.         ax.plot(np.arange(5000), label=idx)
960.     legend = ax.legend('best')
961.     fig.draw_artist(legend)  # Check that no warning is emitted.
962. 
963. 
964. @pytest.mark.parametrize('label_array', [['low', 'high'],
965.                                          ('low', 'high'),
966.                                          np.array(['low', 'high'])])
967. def test_plot_multiple_input_multiple_label(label_array):
968.     # test ax.plot() with multidimensional input
969.     # and multiple labels
970.     x = [1, 2, 3]
971.     y = [[1, 2],
972.          [2, 5],
973.          [4, 9]]
974. 
975.     fig, ax = plt.subplots()
976.     ax.plot(x, y, label=label_array)
977.     leg = ax.legend()
978.     legend_texts = [entry.get_text() for entry in leg.get_texts()]
979.     assert legend_texts == ['low', 'high']
980. 
981. 
982. @pytest.mark.parametrize('label', ['one', 1, int])
983. def test_plot_multiple_input_single_label(label):
984.     # test ax.plot() with multidimensional input
985.     # and single label
986.     x = [1, 2, 3]
987.     y = [[1, 2],
988.          [2, 5],
989.          [4, 9]]
990. 
991.     fig, ax = plt.subplots()
992.     ax.plot(x, y, label=label)
993.     leg = ax.legend()
994.     legend_texts = [entry.get_text() for entry in leg.get_texts()]
995.     assert legend_texts == [str(label)] * 2
996. 
997. 
998. @pytest.mark.parametrize('label_array', [['low', 'high'],
999.                                          ('low', 'high'),
1000.                                          np.array(['low', 'high'])])


File: lib/matplotlib/tests/test_legend.py
Line number range: 1001 - 1269
Content:
1001. def test_plot_single_input_multiple_label(label_array):
1002.     # test ax.plot() with 1D array like input
1003.     # and iterable label
1004.     x = [1, 2, 3]
1005.     y = [2, 5, 6]
1006.     fig, ax = plt.subplots()
1007.     ax.plot(x, y, label=label_array)
1008.     leg = ax.legend()
1009.     assert len(leg.get_texts()) == 1
1010.     assert leg.get_texts()[0].get_text() == str(label_array)
1011. 
1012. 
1013. def test_plot_multiple_label_incorrect_length_exception():
1014.     # check that exception is raised if multiple labels
1015.     # are given, but number of on labels != number of lines
1016.     with pytest.raises(ValueError):
1017.         x = [1, 2, 3]
1018.         y = [[1, 2],
1019.              [2, 5],
1020.              [4, 9]]
1021.         label = ['high', 'low', 'medium']
1022.         fig, ax = plt.subplots()
1023.         ax.plot(x, y, label=label)
1024. 
1025. 
1026. def test_legend_face_edgecolor():
1027.     # Smoke test for PolyCollection legend handler with 'face' edgecolor.
1028.     fig, ax = plt.subplots()
1029.     ax.fill_between([0, 1, 2], [1, 2, 3], [2, 3, 4],
1030.                     facecolor='r', edgecolor='face', label='Fill')
1031.     ax.legend()
1032. 
1033. 
1034. def test_legend_text_axes():
1035.     fig, ax = plt.subplots()
1036.     ax.plot([1, 2], [3, 4], label='line')
1037.     leg = ax.legend()
1038. 
1039.     assert leg.axes is ax
1040.     assert leg.get_texts()[0].axes is ax
1041. 
1042. 
1043. def test_handlerline2d():
1044.     # Test marker consistency for monolithic Line2D legend handler (#11357).
1045.     fig, ax = plt.subplots()
1046.     ax.scatter([0, 1], [0, 1], marker="v")
1047.     handles = [mlines.Line2D([0], [0], marker="v")]
1048.     leg = ax.legend(handles, ["Aardvark"], numpoints=1)
1049.     assert handles[0].get_marker() == leg.legendHandles[0].get_marker()
1050. 
1051. 
1052. def test_subfigure_legend():
1053.     # Test that legend can be added to subfigure (#20723)
1054.     subfig = plt.figure().subfigures()
1055.     ax = subfig.subplots()
1056.     ax.plot([0, 1], [0, 1], label="line")
1057.     leg = subfig.legend()
1058.     assert leg.figure is subfig
1059. 
1060. 
1061. def test_setting_alpha_keeps_polycollection_color():
1062.     pc = plt.fill_between([0, 1], [2, 3], color='#123456', label='label')
1063.     patch = plt.legend().get_patches()[0]
1064.     patch.set_alpha(0.5)
1065.     assert patch.get_facecolor()[:3] == tuple(pc.get_facecolor()[0][:3])
1066.     assert patch.get_edgecolor()[:3] == tuple(pc.get_edgecolor()[0][:3])
1067. 
1068. 
1069. def test_legend_markers_from_line2d():
1070.     # Test that markers can be copied for legend lines (#17960)
1071.     _markers = ['.', '*', 'v']
1072.     fig, ax = plt.subplots()
1073.     lines = [mlines.Line2D([0], [0], ls='None', marker=mark)
1074.              for mark in _markers]
1075.     labels = ["foo", "bar", "xyzzy"]
1076.     markers = [line.get_marker() for line in lines]
1077.     legend = ax.legend(lines, labels)
1078. 
1079.     new_markers = [line.get_marker() for line in legend.get_lines()]
1080.     new_labels = [text.get_text() for text in legend.get_texts()]
1081. 
1082.     assert markers == new_markers == _markers
1083.     assert labels == new_labels
1084. 
1085. 
1086. @check_figures_equal()
1087. def test_ncol_ncols(fig_test, fig_ref):
1088.     # Test that both ncol and ncols work
1089.     strings = ["a", "b", "c", "d", "e", "f"]
1090.     ncols = 3
1091.     fig_test.legend(strings, ncol=ncols)
1092.     fig_ref.legend(strings, ncols=ncols)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 00:39:55,828 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The query asks for the full content of the file `lib/matplotlib/tests/test_legend.py`.\n   - This context is the first part of the file, containing lines 1 to 500.\n2. Extended relevance:\n   - This is a direct and essential part of the user's request.", relative_path='lib/matplotlib/tests/test_legend.py', start_line=1, end_line=500), ContextOutput(reasoning="1. Query requirement analysis:\n   - The query asks for the full content of the file `lib/matplotlib/tests/test_legend.py`.\n   - This context is the second part of the file, containing lines 501 to 1000.\n2. Extended relevance:\n   - This is a direct and essential part of the user's request.", relative_path='lib/matplotlib/tests/test_legend.py', start_line=501, end_line=1000), ContextOutput(reasoning="1. Query requirement analysis:\n   - The query asks for the full content of the file `lib/matplotlib/tests/test_legend.py`.\n   - This context is the third and final part of the file, containing lines 1001 to 1269.\n2. Extended relevance:\n   - This is a direct and essential part of the user's request.", relative_path='lib/matplotlib/tests/test_legend.py', start_line=1001, end_line=1269)]
2025-12-21 00:39:55,832 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the full content of the file lib/matplotlib/tests/test_legend.py.
2025-12-21 00:39:55,832 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 00:39:55,832 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 00:39:55,833 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 1 existing contexts
2025-12-21 00:39:55,833 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 4 total contexts (removed 0 duplicates)
2025-12-21 00:39:55,834 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   └── 24189-JB.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   └── 24455-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   └── 24257-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       └── 24356-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   └── view_current_axis_format.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           └── test_axes3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: `align` in `HPacker` is reversed

Description: ### Bug summary

For the `align` parameter in `HPacker`, the options `top` and `bottom` seems reversed

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib.offsetbox import DrawingArea, HPacker, VPacker, AnchoredOffsetbox, TextArea
from matplotlib.patches import Rectangle

da1 = DrawingArea(10, 20)
rect1 = Rectangle((0, 0), 10, 20)
da1.add_artist(rect1)

da2 = DrawingArea(10, 30)
rect2 = Rectangle((0, 0), 10, 30)
da2.add_artist(rect2)

align = "bottom"

pack = HPacker(children=[da1, da2], pad=10, sep=10, align=align)
title = TextArea(f"align='{align}'")
pack = VPacker(children=[title, pack], sep=10, pad=10, align="center")

box = AnchoredOffsetbox(child=pack, loc="center")

_, ax = plt.subplots()
ax.add_artist(box)
```


### Actual outcome

![download](https://user-images.githubusercontent.com/23433306/200162888-702626bf-ad47-40e2-8751-7dffe91df85c.png)


### Expected outcome

![download](https://user-images.githubusercontent.com/23433306/200162908-e0e9dfd5-6f8b-4aac-975e-bb363d809c41.png)


### Additional information

_No response_

### Operating system

_No response_

### Matplotlib Version

3.6.2

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

_No response_

Patch information:
diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py
index 3a506543ac..d1b2c9714c 100644
--- a/lib/matplotlib/offsetbox.py
+++ b/lib/matplotlib/offsetbox.py
@@ -475,9 +475,10 @@ class HPacker(PackerBase):
             return 2 * pad, 2 * pad, pad, pad, []
 
         hd_list = [(h, yd) for w, h, xd, yd in whd_list]
+        v_align = {"top": "bottom", "bottom": "top"}.get(self.align, self.align)
         height, ydescent, yoffsets = _get_aligned_offsets(hd_list,
                                                           self.height,
-                                                          self.align)
+                                                          v_align)
 
         pack_list = [w for w, h, xd, yd in whd_list]
         width, xoffsets_ = _get_packed_offsets(pack_list, self.width,


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file lib/matplotlib/tests/test_offsetbox.py.
Extra Requirements: 
Purpose: I need to analyze the tests for offsetbox to find 3 test cases that are relevant to the `HPacker` alignment bug.

Previous refined query 2:
Essential Query: Please provide the full content of the file lib/matplotlib/tests/test_legend.py.
Extra Requirements: 
Purpose: I need to analyze the legend tests to find test cases that are relevant to the `HPacker` alignment bug, as the legend implementation may use `HPacker` internally.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_legend.py
Line number range: 1 - 500
Content:
1. import collections
2. import platform
3. from unittest import mock
4. import warnings
5. 
6. import numpy as np
7. import pytest
8. 
9. from matplotlib.testing.decorators import check_figures_equal, image_comparison
10. from matplotlib.testing._markers import needs_usetex
11. import matplotlib.pyplot as plt
12. import matplotlib as mpl
13. import matplotlib.transforms as mtransforms
14. import matplotlib.collections as mcollections
15. import matplotlib.lines as mlines
16. from matplotlib.legend_handler import HandlerTuple
17. import matplotlib.legend as mlegend
18. from matplotlib import rc_context
19. from matplotlib.font_manager import FontProperties
20. 
21. 
22. def test_legend_ordereddict():
23.     # smoketest that ordereddict inputs work...
24. 
25.     X = np.random.randn(10)
26.     Y = np.random.randn(10)
27.     labels = ['a'] * 5 + ['b'] * 5
28.     colors = ['r'] * 5 + ['g'] * 5
29. 
30.     fig, ax = plt.subplots()
31.     for x, y, label, color in zip(X, Y, labels, colors):
32.         ax.scatter(x, y, label=label, c=color)
33. 
34.     handles, labels = ax.get_legend_handles_labels()
35.     legend = collections.OrderedDict(zip(labels, handles))
36.     ax.legend(legend.values(), legend.keys(),
37.               loc='center left', bbox_to_anchor=(1, .5))
38. 
39. 
40. @image_comparison(['legend_auto1'], remove_text=True)
41. def test_legend_auto1():
42.     """Test automatic legend placement"""
43.     fig, ax = plt.subplots()
44.     x = np.arange(100)
45.     ax.plot(x, 50 - x, 'o', label='y=1')
46.     ax.plot(x, x - 50, 'o', label='y=-1')
47.     ax.legend(loc='best')
48. 
49. 
50. @image_comparison(['legend_auto2'], remove_text=True)
51. def test_legend_auto2():
52.     """Test automatic legend placement"""
53.     fig, ax = plt.subplots()
54.     x = np.arange(100)
55.     b1 = ax.bar(x, x, align='edge', color='m')
56.     b2 = ax.bar(x, x[::-1], align='edge', color='g')
57.     ax.legend([b1[0], b2[0]], ['up', 'down'], loc='best')
58. 
59. 
60. @image_comparison(['legend_auto3'])
61. def test_legend_auto3():
62.     """Test automatic legend placement"""
63.     fig, ax = plt.subplots()
64.     x = [0.9, 0.1, 0.1, 0.9, 0.9, 0.5]
65.     y = [0.95, 0.95, 0.05, 0.05, 0.5, 0.5]
66.     ax.plot(x, y, 'o-', label='line')
67.     ax.set_xlim(0.0, 1.0)
68.     ax.set_ylim(0.0, 1.0)
69.     ax.legend(loc='best')
70. 
71. 
72. @image_comparison(['legend_various_labels'], remove_text=True)
73. def test_various_labels():
74.     # tests all sorts of label types
75.     fig = plt.figure()
76.     ax = fig.add_subplot(121)
77.     ax.plot(np.arange(4), 'o', label=1)
78.     ax.plot(np.linspace(4, 4.1), 'o', label='Développés')
79.     ax.plot(np.arange(4, 1, -1), 'o', label='__nolegend__')
80.     ax.legend(numpoints=1, loc='best')
81. 
82. 
83. def test_legend_label_with_leading_underscore():
84.     """
85.     Test that artists with labels starting with an underscore are not added to
86.     the legend, and that a warning is issued if one tries to add them
87.     explicitly.
88.     """
89.     fig, ax = plt.subplots()
90.     line, = ax.plot([0, 1], label='_foo')
91.     with pytest.warns(UserWarning,
92.                       match=r"starts with '_'.*excluded from the legend."):
93.         legend = ax.legend(handles=[line])
94.     assert len(legend.legendHandles) == 0
95. 
96. 
97. @image_comparison(['legend_labels_first.png'], remove_text=True)
98. def test_labels_first():
99.     # test labels to left of markers
100.     fig, ax = plt.subplots()
101.     ax.plot(np.arange(10), '-o', label=1)
102.     ax.plot(np.ones(10)*5, ':x', label="x")
103.     ax.plot(np.arange(20, 10, -1), 'd', label="diamond")
104.     ax.legend(loc='best', markerfirst=False)
105. 
106. 
107. @image_comparison(['legend_multiple_keys.png'], remove_text=True)
108. def test_multiple_keys():
109.     # test legend entries with multiple keys
110.     fig, ax = plt.subplots()
111.     p1, = ax.plot([1, 2, 3], '-o')
112.     p2, = ax.plot([2, 3, 4], '-x')
113.     p3, = ax.plot([3, 4, 5], '-d')
114.     ax.legend([(p1, p2), (p2, p1), p3], ['two keys', 'pad=0', 'one key'],
115.               numpoints=1,
116.               handler_map={(p1, p2): HandlerTuple(ndivide=None),
117.                            (p2, p1): HandlerTuple(ndivide=None, pad=0)})
118. 
119. 
120. @image_comparison(['rgba_alpha.png'], remove_text=True,
121.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
122. def test_alpha_rgba():
123.     fig, ax = plt.subplots()
124.     ax.plot(range(10), lw=5)
125.     leg = plt.legend(['Longlabel that will go away'], loc='center')
126.     leg.legendPatch.set_facecolor([1, 0, 0, 0.5])
127. 
128. 
129. @image_comparison(['rcparam_alpha.png'], remove_text=True,
130.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
131. def test_alpha_rcparam():
132.     fig, ax = plt.subplots()
133.     ax.plot(range(10), lw=5)
134.     with mpl.rc_context(rc={'legend.framealpha': .75}):
135.         leg = plt.legend(['Longlabel that will go away'], loc='center')
136.         # this alpha is going to be over-ridden by the rcparam with
137.         # sets the alpha of the patch to be non-None which causes the alpha
138.         # value of the face color to be discarded.  This behavior may not be
139.         # ideal, but it is what it is and we should keep track of it changing
140.         leg.legendPatch.set_facecolor([1, 0, 0, 0.5])
141. 
142. 
143. @image_comparison(['fancy'], remove_text=True)
144. def test_fancy():
145.     # using subplot triggers some offsetbox functionality untested elsewhere
146.     plt.subplot(121)
147.     plt.plot([5] * 10, 'o--', label='XX')
148.     plt.scatter(np.arange(10), np.arange(10, 0, -1), label='XX\nXX')
149.     plt.errorbar(np.arange(10), np.arange(10), xerr=0.5,
150.                  yerr=0.5, label='XX')
151.     plt.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
152.                ncols=2, shadow=True, title="My legend", numpoints=1)
153. 
154. 
155. @image_comparison(['framealpha'], remove_text=True,
156.                   tol=0 if platform.machine() == 'x86_64' else 0.02)
157. def test_framealpha():
158.     x = np.linspace(1, 100, 100)
159.     y = x
160.     plt.plot(x, y, label='mylabel', lw=10)
161.     plt.legend(framealpha=0.5)
162. 
163. 
164. @image_comparison(['scatter_rc3', 'scatter_rc1'], remove_text=True)
165. def test_rc():
166.     # using subplot triggers some offsetbox functionality untested elsewhere
167.     plt.figure()
168.     ax = plt.subplot(121)
169.     ax.scatter(np.arange(10), np.arange(10, 0, -1), label='three')
170.     ax.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
171.               title="My legend")
172. 
173.     mpl.rcParams['legend.scatterpoints'] = 1
174.     plt.figure()
175.     ax = plt.subplot(121)
176.     ax.scatter(np.arange(10), np.arange(10, 0, -1), label='one')
177.     ax.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
178.               title="My legend")
179. 
180. 
181. @image_comparison(['legend_expand'], remove_text=True)
182. def test_legend_expand():
183.     """Test expand mode"""
184.     legend_modes = [None, "expand"]
185.     fig, axs = plt.subplots(len(legend_modes), 1)
186.     x = np.arange(100)
187.     for ax, mode in zip(axs, legend_modes):
188.         ax.plot(x, 50 - x, 'o', label='y=1')
189.         l1 = ax.legend(loc='upper left', mode=mode)
190.         ax.add_artist(l1)
191.         ax.plot(x, x - 50, 'o', label='y=-1')
192.         l2 = ax.legend(loc='right', mode=mode)
193.         ax.add_artist(l2)
194.         ax.legend(loc='lower left', mode=mode, ncols=2)
195. 
196. 
197. @image_comparison(['hatching'], remove_text=True, style='default')
198. def test_hatching():
199.     # Remove this line when this test image is regenerated.
200.     plt.rcParams['text.kerning_factor'] = 6
201. 
202.     fig, ax = plt.subplots()
203. 
204.     # Patches
205.     patch = plt.Rectangle((0, 0), 0.3, 0.3, hatch='xx',
206.                           label='Patch\ndefault color\nfilled')
207.     ax.add_patch(patch)
208.     patch = plt.Rectangle((0.33, 0), 0.3, 0.3, hatch='||', edgecolor='C1',
209.                           label='Patch\nexplicit color\nfilled')
210.     ax.add_patch(patch)
211.     patch = plt.Rectangle((0, 0.4), 0.3, 0.3, hatch='xx', fill=False,
212.                           label='Patch\ndefault color\nunfilled')
213.     ax.add_patch(patch)
214.     patch = plt.Rectangle((0.33, 0.4), 0.3, 0.3, hatch='||', fill=False,
215.                           edgecolor='C1',
216.                           label='Patch\nexplicit color\nunfilled')
217.     ax.add_patch(patch)
218. 
219.     # Paths
220.     ax.fill_between([0, .15, .3], [.8, .8, .8], [.9, 1.0, .9],
221.                     hatch='+', label='Path\ndefault color')
222.     ax.fill_between([.33, .48, .63], [.8, .8, .8], [.9, 1.0, .9],
223.                     hatch='+', edgecolor='C2', label='Path\nexplicit color')
224. 
225.     ax.set_xlim(-0.01, 1.1)
226.     ax.set_ylim(-0.01, 1.1)
227.     ax.legend(handlelength=4, handleheight=4)
228. 
229. 
230. def test_legend_remove():
231.     fig, ax = plt.subplots()
232.     lines = ax.plot(range(10))
233.     leg = fig.legend(lines, "test")
234.     leg.remove()
235.     assert fig.legends == []
236.     leg = ax.legend("test")
237.     leg.remove()
238.     assert ax.get_legend() is None
239. 
240. 
241. class TestLegendFunction:
242.     # Tests the legend function on the Axes and pyplot.
243.     def test_legend_no_args(self):
244.         lines = plt.plot(range(10), label='hello world')
245.         with mock.patch('matplotlib.legend.Legend') as Legend:
246.             plt.legend()
247.         Legend.assert_called_with(plt.gca(), lines, ['hello world'])
248. 
249.     def test_legend_positional_handles_labels(self):
250.         lines = plt.plot(range(10))
251.         with mock.patch('matplotlib.legend.Legend') as Legend:
252.             plt.legend(lines, ['hello world'])
253.         Legend.assert_called_with(plt.gca(), lines, ['hello world'])
254. 
255.     def test_legend_positional_handles_only(self):
256.         lines = plt.plot(range(10))
257.         with pytest.raises(TypeError, match='but found an Artist'):
258.             # a single arg is interpreted as labels
259.             # it's a common error to just pass handles
260.             plt.legend(lines)
261. 
262.     def test_legend_positional_labels_only(self):
263.         lines = plt.plot(range(10), label='hello world')
264.         with mock.patch('matplotlib.legend.Legend') as Legend:
265.             plt.legend(['foobar'])
266.         Legend.assert_called_with(plt.gca(), lines, ['foobar'])
267. 
268.     def test_legend_three_args(self):
269.         lines = plt.plot(range(10), label='hello world')
270.         with mock.patch('matplotlib.legend.Legend') as Legend:
271.             plt.legend(lines, ['foobar'], loc='right')
272.         Legend.assert_called_with(plt.gca(), lines, ['foobar'], loc='right')
273. 
274.     def test_legend_handler_map(self):
275.         lines = plt.plot(range(10), label='hello world')
276.         with mock.patch('matplotlib.legend.'
277.                         '_get_legend_handles_labels') as handles_labels:
278.             handles_labels.return_value = lines, ['hello world']
279.             plt.legend(handler_map={'1': 2})
280.         handles_labels.assert_called_with([plt.gca()], {'1': 2})
281. 
282.     def test_legend_kwargs_handles_only(self):
283.         fig, ax = plt.subplots()
284.         x = np.linspace(0, 1, 11)
285.         ln1, = ax.plot(x, x, label='x')
286.         ln2, = ax.plot(x, 2*x, label='2x')
287.         ln3, = ax.plot(x, 3*x, label='3x')
288.         with mock.patch('matplotlib.legend.Legend') as Legend:
289.             ax.legend(handles=[ln3, ln2])  # reversed and not ln1
290.         Legend.assert_called_with(ax, [ln3, ln2], ['3x', '2x'])
291. 
292.     def test_legend_kwargs_labels_only(self):
293.         fig, ax = plt.subplots()
294.         x = np.linspace(0, 1, 11)
295.         ln1, = ax.plot(x, x)
296.         ln2, = ax.plot(x, 2*x)
297.         with mock.patch('matplotlib.legend.Legend') as Legend:
298.             ax.legend(labels=['x', '2x'])
299.         Legend.assert_called_with(ax, [ln1, ln2], ['x', '2x'])
300. 
301.     def test_legend_kwargs_handles_labels(self):
302.         fig, ax = plt.subplots()
303.         th = np.linspace(0, 2*np.pi, 1024)
304.         lns, = ax.plot(th, np.sin(th), label='sin')
305.         lnc, = ax.plot(th, np.cos(th), label='cos')
306.         with mock.patch('matplotlib.legend.Legend') as Legend:
307.             # labels of lns, lnc are overwritten with explicit ('a', 'b')
308.             ax.legend(labels=('a', 'b'), handles=(lnc, lns))
309.         Legend.assert_called_with(ax, (lnc, lns), ('a', 'b'))
310. 
311.     def test_warn_mixed_args_and_kwargs(self):
312.         fig, ax = plt.subplots()
313.         th = np.linspace(0, 2*np.pi, 1024)
314.         lns, = ax.plot(th, np.sin(th), label='sin')
315.         lnc, = ax.plot(th, np.cos(th), label='cos')
316.         with pytest.warns(UserWarning) as record:
317.             ax.legend((lnc, lns), labels=('a', 'b'))
318.         assert len(record) == 1
319.         assert str(record[0].message) == (
320.             "You have mixed positional and keyword arguments, some input may "
321.             "be discarded.")
322. 
323.     def test_parasite(self):
324.         from mpl_toolkits.axes_grid1 import host_subplot
325. 
326.         host = host_subplot(111)
327.         par = host.twinx()
328. 
329.         p1, = host.plot([0, 1, 2], [0, 1, 2], label="Density")
330.         p2, = par.plot([0, 1, 2], [0, 3, 2], label="Temperature")
331. 
332.         with mock.patch('matplotlib.legend.Legend') as Legend:
333.             plt.legend()
334.         Legend.assert_called_with(host, [p1, p2], ['Density', 'Temperature'])
335. 
336. 
337. class TestLegendFigureFunction:
338.     # Tests the legend function for figure
339.     def test_legend_handle_label(self):
340.         fig, ax = plt.subplots()
341.         lines = ax.plot(range(10))
342.         with mock.patch('matplotlib.legend.Legend') as Legend:
343.             fig.legend(lines, ['hello world'])
344.         Legend.assert_called_with(fig, lines, ['hello world'],
345.                                   bbox_transform=fig.transFigure)
346. 
347.     def test_legend_no_args(self):
348.         fig, ax = plt.subplots()
349.         lines = ax.plot(range(10), label='hello world')
350.         with mock.patch('matplotlib.legend.Legend') as Legend:
351.             fig.legend()
352.         Legend.assert_called_with(fig, lines, ['hello world'],
353.                                   bbox_transform=fig.transFigure)
354. 
355.     def test_legend_label_arg(self):
356.         fig, ax = plt.subplots()
357.         lines = ax.plot(range(10))
358.         with mock.patch('matplotlib.legend.Legend') as Legend:
359.             fig.legend(['foobar'])
360.         Legend.assert_called_with(fig, lines, ['foobar'],
361.                                   bbox_transform=fig.transFigure)
362. 
363.     def test_legend_label_three_args(self):
364.         fig, ax = plt.subplots()
365.         lines = ax.plot(range(10))
366.         with mock.patch('matplotlib.legend.Legend') as Legend:
367.             fig.legend(lines, ['foobar'], 'right')
368.         Legend.assert_called_with(fig, lines, ['foobar'], 'right',
369.                                   bbox_transform=fig.transFigure)
370. 
371.     def test_legend_label_three_args_pluskw(self):
372.         # test that third argument and loc=  called together give
373.         # Exception
374.         fig, ax = plt.subplots()
375.         lines = ax.plot(range(10))
376.         with pytest.raises(Exception):
377.             fig.legend(lines, ['foobar'], 'right', loc='left')
378. 
379.     def test_legend_kw_args(self):
380.         fig, axs = plt.subplots(1, 2)
381.         lines = axs[0].plot(range(10))
382.         lines2 = axs[1].plot(np.arange(10) * 2.)
383.         with mock.patch('matplotlib.legend.Legend') as Legend:
384.             fig.legend(loc='right', labels=('a', 'b'), handles=(lines, lines2))
385.         Legend.assert_called_with(
386.             fig, (lines, lines2), ('a', 'b'), loc='right',
387.             bbox_transform=fig.transFigure)
388. 
389.     def test_warn_args_kwargs(self):
390.         fig, axs = plt.subplots(1, 2)
391.         lines = axs[0].plot(range(10))
392.         lines2 = axs[1].plot(np.arange(10) * 2.)
393.         with pytest.warns(UserWarning) as record:
394.             fig.legend((lines, lines2), labels=('a', 'b'))
395.         assert len(record) == 1
396.         assert str(record[0].message) == (
397.             "You have mixed positional and keyword arguments, some input may "
398.             "be discarded.")
399. 
400. 
401. @image_comparison(['legend_stackplot.png'])
402. def test_legend_stackplot():
403.     """Test legend for PolyCollection using stackplot."""
404.     # related to #1341, #1943, and PR #3303
405.     fig, ax = plt.subplots()
406.     x = np.linspace(0, 10, 10)
407.     y1 = 1.0 * x
408.     y2 = 2.0 * x + 1
409.     y3 = 3.0 * x + 2
410.     ax.stackplot(x, y1, y2, y3, labels=['y1', 'y2', 'y3'])
411.     ax.set_xlim((0, 10))
412.     ax.set_ylim((0, 70))
413.     ax.legend(loc='best')
414. 
415. 
416. def test_cross_figure_patch_legend():
417.     fig, ax = plt.subplots()
418.     fig2, ax2 = plt.subplots()
419. 
420.     brs = ax.bar(range(3), range(3))
421.     fig2.legend(brs, 'foo')
422. 
423. 
424. def test_nanscatter():
425.     fig, ax = plt.subplots()
426. 
427.     h = ax.scatter([np.nan], [np.nan], marker="o",
428.                    facecolor="r", edgecolor="r", s=3)
429. 
430.     ax.legend([h], ["scatter"])
431. 
432.     fig, ax = plt.subplots()
433.     for color in ['red', 'green', 'blue']:
434.         n = 750
435.         x, y = np.random.rand(2, n)
436.         scale = 200.0 * np.random.rand(n)
437.         ax.scatter(x, y, c=color, s=scale, label=color,
438.                    alpha=0.3, edgecolors='none')
439. 
440.     ax.legend()
441.     ax.grid(True)
442. 
443. 
444. def test_legend_repeatcheckok():
445.     fig, ax = plt.subplots()
446.     ax.scatter(0.0, 1.0, color='k', marker='o', label='test')
447.     ax.scatter(0.5, 0.0, color='r', marker='v', label='test')
448.     ax.legend()
449.     hand, lab = mlegend._get_legend_handles_labels([ax])
450.     assert len(lab) == 2
451.     fig, ax = plt.subplots()
452.     ax.scatter(0.0, 1.0, color='k', marker='o', label='test')
453.     ax.scatter(0.5, 0.0, color='k', marker='v', label='test')
454.     ax.legend()
455.     hand, lab = mlegend._get_legend_handles_labels([ax])
456.     assert len(lab) == 2
457. 
458. 
459. @image_comparison(['not_covering_scatter.png'])
460. def test_not_covering_scatter():
461.     colors = ['b', 'g', 'r']
462. 
463.     for n in range(3):
464.         plt.scatter([n], [n], color=colors[n])
465. 
466.     plt.legend(['foo', 'foo', 'foo'], loc='best')
467.     plt.gca().set_xlim(-0.5, 2.2)
468.     plt.gca().set_ylim(-0.5, 2.2)
469. 
470. 
471. @image_comparison(['not_covering_scatter_transform.png'])
472. def test_not_covering_scatter_transform():
473.     # Offsets point to top left, the default auto position
474.     offset = mtransforms.Affine2D().translate(-20, 20)
475.     x = np.linspace(0, 30, 1000)
476.     plt.plot(x, x)
477. 
478.     plt.scatter([20], [10], transform=offset + plt.gca().transData)
479. 
480.     plt.legend(['foo', 'bar'], loc='best')
481. 
482. 
483. def test_linecollection_scaled_dashes():
484.     lines1 = [[(0, .5), (.5, 1)], [(.3, .6), (.2, .2)]]
485.     lines2 = [[[0.7, .2], [.8, .4]], [[.5, .7], [.6, .1]]]
486.     lines3 = [[[0.6, .2], [.8, .4]], [[.5, .7], [.1, .1]]]
487.     lc1 = mcollections.LineCollection(lines1, linestyles="--", lw=3)
488.     lc2 = mcollections.LineCollection(lines2, linestyles="-.")
489.     lc3 = mcollections.LineCollection(lines3, linestyles=":", lw=.5)
490. 
491.     fig, ax = plt.subplots()
492.     ax.add_collection(lc1)
493.     ax.add_collection(lc2)
494.     ax.add_collection(lc3)
495. 
496.     leg = ax.legend([lc1, lc2, lc3], ["line1", "line2", 'line 3'])
497.     h1, h2, h3 = leg.legendHandles
498. 
499.     for oh, lh in zip((lc1, lc2, lc3), (h1, h2, h3)):
500.         assert oh.get_linestyles()[0] == lh._dash_pattern


File: lib/matplotlib/tests/test_legend.py
Line number range: 501 - 1000
Content:
501. 
502. 
503. def test_handler_numpoints():
504.     """Test legend handler with numpoints <= 1."""
505.     # related to #6921 and PR #8478
506.     fig, ax = plt.subplots()
507.     ax.plot(range(5), label='test')
508.     ax.legend(numpoints=0.5)
509. 
510. 
511. def test_text_nohandler_warning():
512.     """Test that Text artists with labels raise a warning"""
513.     fig, ax = plt.subplots()
514.     ax.text(x=0, y=0, s="text", label="label")
515.     with pytest.warns(UserWarning) as record:
516.         ax.legend()
517.     assert len(record) == 1
518. 
519.     # this should _not_ warn:
520.     f, ax = plt.subplots()
521.     ax.pcolormesh(np.random.uniform(0, 1, (10, 10)))
522.     with warnings.catch_warnings():
523.         warnings.simplefilter("error")
524.         ax.get_legend_handles_labels()
525. 
526. 
527. def test_empty_bar_chart_with_legend():
528.     """Test legend when bar chart is empty with a label."""
529.     # related to issue #13003. Calling plt.legend() should not
530.     # raise an IndexError.
531.     plt.bar([], [], label='test')
532.     plt.legend()
533. 
534. 
535. def test_shadow_framealpha():
536.     # Test if framealpha is activated when shadow is True
537.     # and framealpha is not explicitly passed'''
538.     fig, ax = plt.subplots()
539.     ax.plot(range(100), label="test")
540.     leg = ax.legend(shadow=True, facecolor='w')
541.     assert leg.get_frame().get_alpha() == 1
542. 
543. 
544. def test_legend_title_empty():
545.     # test that if we don't set the legend title, that
546.     # it comes back as an empty string, and that it is not
547.     # visible:
548.     fig, ax = plt.subplots()
549.     ax.plot(range(10))
550.     leg = ax.legend()
551.     assert leg.get_title().get_text() == ""
552.     assert not leg.get_title().get_visible()
553. 
554. 
555. def test_legend_proper_window_extent():
556.     # test that legend returns the expected extent under various dpi...
557.     fig, ax = plt.subplots(dpi=100)
558.     ax.plot(range(10), label='Aardvark')
559.     leg = ax.legend()
560.     x01 = leg.get_window_extent(fig.canvas.get_renderer()).x0
561. 
562.     fig, ax = plt.subplots(dpi=200)
563.     ax.plot(range(10), label='Aardvark')
564.     leg = ax.legend()
565.     x02 = leg.get_window_extent(fig.canvas.get_renderer()).x0
566.     assert pytest.approx(x01*2, 0.1) == x02
567. 
568. 
569. def test_window_extent_cached_renderer():
570.     fig, ax = plt.subplots(dpi=100)
571.     ax.plot(range(10), label='Aardvark')
572.     leg = ax.legend()
573.     leg2 = fig.legend()
574.     fig.canvas.draw()
575.     # check that get_window_extent will use the cached renderer
576.     leg.get_window_extent()
577.     leg2.get_window_extent()
578. 
579. 
580. def test_legend_title_fontprop_fontsize():
581.     # test the title_fontsize kwarg
582.     plt.plot(range(10))
583.     with pytest.raises(ValueError):
584.         plt.legend(title='Aardvark', title_fontsize=22,
585.                    title_fontproperties={'family': 'serif', 'size': 22})
586. 
587.     leg = plt.legend(title='Aardvark', title_fontproperties=FontProperties(
588.                                        family='serif', size=22))
589.     assert leg.get_title().get_size() == 22
590. 
591.     fig, axes = plt.subplots(2, 3, figsize=(10, 6))
592.     axes = axes.flat
593.     axes[0].plot(range(10))
594.     leg0 = axes[0].legend(title='Aardvark', title_fontsize=22)
595.     assert leg0.get_title().get_fontsize() == 22
596.     axes[1].plot(range(10))
597.     leg1 = axes[1].legend(title='Aardvark',
598.                           title_fontproperties={'family': 'serif', 'size': 22})
599.     assert leg1.get_title().get_fontsize() == 22
600.     axes[2].plot(range(10))
601.     mpl.rcParams['legend.title_fontsize'] = None
602.     leg2 = axes[2].legend(title='Aardvark',
603.                           title_fontproperties={'family': 'serif'})
604.     assert leg2.get_title().get_fontsize() == mpl.rcParams['font.size']
605.     axes[3].plot(range(10))
606.     leg3 = axes[3].legend(title='Aardvark')
607.     assert leg3.get_title().get_fontsize() == mpl.rcParams['font.size']
608.     axes[4].plot(range(10))
609.     mpl.rcParams['legend.title_fontsize'] = 20
610.     leg4 = axes[4].legend(title='Aardvark',
611.                           title_fontproperties={'family': 'serif'})
612.     assert leg4.get_title().get_fontsize() == 20
613.     axes[5].plot(range(10))
614.     leg5 = axes[5].legend(title='Aardvark')
615.     assert leg5.get_title().get_fontsize() == 20
616. 
617. 
618. @pytest.mark.parametrize('alignment', ('center', 'left', 'right'))
619. def test_legend_alignment(alignment):
620.     fig, ax = plt.subplots()
621.     ax.plot(range(10), label='test')
622.     leg = ax.legend(title="Aardvark", alignment=alignment)
623.     assert leg.get_children()[0].align == alignment
624.     assert leg.get_alignment() == alignment
625. 
626. 
627. @pytest.mark.parametrize('alignment', ('center', 'left', 'right'))
628. def test_legend_set_alignment(alignment):
629.     fig, ax = plt.subplots()
630.     ax.plot(range(10), label='test')
631.     leg = ax.legend()
632.     leg.set_alignment(alignment)
633.     assert leg.get_children()[0].align == alignment
634.     assert leg.get_alignment() == alignment
635. 
636. 
637. @pytest.mark.parametrize('color', ('red', 'none', (.5, .5, .5)))
638. def test_legend_labelcolor_single(color):
639.     # test labelcolor for a single color
640.     fig, ax = plt.subplots()
641.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
642.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
643.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
644. 
645.     leg = ax.legend(labelcolor=color)
646.     for text in leg.get_texts():
647.         assert mpl.colors.same_color(text.get_color(), color)
648. 
649. 
650. def test_legend_labelcolor_list():
651.     # test labelcolor for a list of colors
652.     fig, ax = plt.subplots()
653.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
654.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
655.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
656. 
657.     leg = ax.legend(labelcolor=['r', 'g', 'b'])
658.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
659.         assert mpl.colors.same_color(text.get_color(), color)
660. 
661. 
662. def test_legend_labelcolor_linecolor():
663.     # test the labelcolor for labelcolor='linecolor'
664.     fig, ax = plt.subplots()
665.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', color='r')
666.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', color='g')
667.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', color='b')
668. 
669.     leg = ax.legend(labelcolor='linecolor')
670.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
671.         assert mpl.colors.same_color(text.get_color(), color)
672. 
673. 
674. def test_legend_pathcollection_labelcolor_linecolor():
675.     # test the labelcolor for labelcolor='linecolor' on PathCollection
676.     fig, ax = plt.subplots()
677.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c='r')
678.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', c='g')
679.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', c='b')
680. 
681.     leg = ax.legend(labelcolor='linecolor')
682.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
683.         assert mpl.colors.same_color(text.get_color(), color)
684. 
685. 
686. def test_legend_pathcollection_labelcolor_linecolor_iterable():
687.     # test the labelcolor for labelcolor='linecolor' on PathCollection
688.     # with iterable colors
689.     fig, ax = plt.subplots()
690.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
691.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c=colors)
692. 
693.     leg = ax.legend(labelcolor='linecolor')
694.     text, = leg.get_texts()
695.     assert mpl.colors.same_color(text.get_color(), 'black')
696. 
697. 
698. def test_legend_pathcollection_labelcolor_linecolor_cmap():
699.     # test the labelcolor for labelcolor='linecolor' on PathCollection
700.     # with a colormap
701.     fig, ax = plt.subplots()
702.     ax.scatter(np.arange(10), np.arange(10), c=np.arange(10), label='#1')
703. 
704.     leg = ax.legend(labelcolor='linecolor')
705.     text, = leg.get_texts()
706.     assert mpl.colors.same_color(text.get_color(), 'black')
707. 
708. 
709. def test_legend_labelcolor_markeredgecolor():
710.     # test the labelcolor for labelcolor='markeredgecolor'
711.     fig, ax = plt.subplots()
712.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
713.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
714.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
715. 
716.     leg = ax.legend(labelcolor='markeredgecolor')
717.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
718.         assert mpl.colors.same_color(text.get_color(), color)
719. 
720. 
721. def test_legend_pathcollection_labelcolor_markeredgecolor():
722.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
723.     fig, ax = plt.subplots()
724.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor='r')
725.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', edgecolor='g')
726.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', edgecolor='b')
727. 
728.     leg = ax.legend(labelcolor='markeredgecolor')
729.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
730.         assert mpl.colors.same_color(text.get_color(), color)
731. 
732. 
733. def test_legend_pathcollection_labelcolor_markeredgecolor_iterable():
734.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
735.     # with iterable colors
736.     fig, ax = plt.subplots()
737.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
738.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor=colors)
739. 
740.     leg = ax.legend(labelcolor='markeredgecolor')
741.     for text, color in zip(leg.get_texts(), ['k']):
742.         assert mpl.colors.same_color(text.get_color(), color)
743. 
744. 
745. def test_legend_pathcollection_labelcolor_markeredgecolor_cmap():
746.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
747.     # with a colormap
748.     fig, ax = plt.subplots()
749.     edgecolors = mpl.cm.viridis(np.random.rand(10))
750.     ax.scatter(
751.         np.arange(10),
752.         np.arange(10),
753.         label='#1',
754.         c=np.arange(10),
755.         edgecolor=edgecolors,
756.         cmap="Reds"
757.     )
758. 
759.     leg = ax.legend(labelcolor='markeredgecolor')
760.     for text, color in zip(leg.get_texts(), ['k']):
761.         assert mpl.colors.same_color(text.get_color(), color)
762. 
763. 
764. def test_legend_labelcolor_markerfacecolor():
765.     # test the labelcolor for labelcolor='markerfacecolor'
766.     fig, ax = plt.subplots()
767.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
768.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
769.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
770. 
771.     leg = ax.legend(labelcolor='markerfacecolor')
772.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
773.         assert mpl.colors.same_color(text.get_color(), color)
774. 
775. 
776. def test_legend_pathcollection_labelcolor_markerfacecolor():
777.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
778.     fig, ax = plt.subplots()
779.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor='r')
780.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', facecolor='g')
781.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', facecolor='b')
782. 
783.     leg = ax.legend(labelcolor='markerfacecolor')
784.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
785.         assert mpl.colors.same_color(text.get_color(), color)
786. 
787. 
788. def test_legend_pathcollection_labelcolor_markerfacecolor_iterable():
789.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
790.     # with iterable colors
791.     fig, ax = plt.subplots()
792.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
793.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor=colors)
794. 
795.     leg = ax.legend(labelcolor='markerfacecolor')
796.     for text, color in zip(leg.get_texts(), ['k']):
797.         assert mpl.colors.same_color(text.get_color(), color)
798. 
799. 
800. def test_legend_pathcollection_labelcolor_markfacecolor_cmap():
801.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
802.     # with colormaps
803.     fig, ax = plt.subplots()
804.     facecolors = mpl.cm.viridis(np.random.rand(10))
805.     ax.scatter(
806.         np.arange(10),
807.         np.arange(10),
808.         label='#1',
809.         c=np.arange(10),
810.         facecolor=facecolors
811.     )
812. 
813.     leg = ax.legend(labelcolor='markerfacecolor')
814.     for text, color in zip(leg.get_texts(), ['k']):
815.         assert mpl.colors.same_color(text.get_color(), color)
816. 
817. 
818. @pytest.mark.parametrize('color', ('red', 'none', (.5, .5, .5)))
819. def test_legend_labelcolor_rcparam_single(color):
820.     # test the rcParams legend.labelcolor for a single color
821.     fig, ax = plt.subplots()
822.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
823.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
824.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
825. 
826.     mpl.rcParams['legend.labelcolor'] = color
827.     leg = ax.legend()
828.     for text in leg.get_texts():
829.         assert mpl.colors.same_color(text.get_color(), color)
830. 
831. 
832. def test_legend_labelcolor_rcparam_linecolor():
833.     # test the rcParams legend.labelcolor for a linecolor
834.     fig, ax = plt.subplots()
835.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', color='r')
836.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', color='g')
837.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', color='b')
838. 
839.     mpl.rcParams['legend.labelcolor'] = 'linecolor'
840.     leg = ax.legend()
841.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
842.         assert mpl.colors.same_color(text.get_color(), color)
843. 
844. 
845. def test_legend_labelcolor_rcparam_markeredgecolor():
846.     # test the labelcolor for labelcolor='markeredgecolor'
847.     fig, ax = plt.subplots()
848.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
849.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
850.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
851. 
852.     mpl.rcParams['legend.labelcolor'] = 'markeredgecolor'
853.     leg = ax.legend()
854.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
855.         assert mpl.colors.same_color(text.get_color(), color)
856. 
857. 
858. def test_legend_labelcolor_rcparam_markeredgecolor_short():
859.     # test the labelcolor for labelcolor='markeredgecolor'
860.     fig, ax = plt.subplots()
861.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
862.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
863.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
864. 
865.     mpl.rcParams['legend.labelcolor'] = 'mec'
866.     leg = ax.legend()
867.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
868.         assert mpl.colors.same_color(text.get_color(), color)
869. 
870. 
871. def test_legend_labelcolor_rcparam_markerfacecolor():
872.     # test the labelcolor for labelcolor='markeredgecolor'
873.     fig, ax = plt.subplots()
874.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
875.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
876.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
877. 
878.     mpl.rcParams['legend.labelcolor'] = 'markerfacecolor'
879.     leg = ax.legend()
880.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
881.         assert mpl.colors.same_color(text.get_color(), color)
882. 
883. 
884. def test_legend_labelcolor_rcparam_markerfacecolor_short():
885.     # test the labelcolor for labelcolor='markeredgecolor'
886.     fig, ax = plt.subplots()
887.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
888.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
889.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
890. 
891.     mpl.rcParams['legend.labelcolor'] = 'mfc'
892.     leg = ax.legend()
893.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
894.         assert mpl.colors.same_color(text.get_color(), color)
895. 
896. 
897. def test_get_set_draggable():
898.     legend = plt.legend()
899.     assert not legend.get_draggable()
900.     legend.set_draggable(True)
901.     assert legend.get_draggable()
902.     legend.set_draggable(False)
903.     assert not legend.get_draggable()
904. 
905. 
906. @pytest.mark.parametrize('draggable', (True, False))
907. def test_legend_draggable(draggable):
908.     fig, ax = plt.subplots()
909.     ax.plot(range(10), label='shabnams')
910.     leg = ax.legend(draggable=draggable)
911.     assert leg.get_draggable() is draggable
912. 
913. 
914. def test_alpha_handles():
915.     x, n, hh = plt.hist([1, 2, 3], alpha=0.25, label='data', color='red')
916.     legend = plt.legend()
917.     for lh in legend.legendHandles:
918.         lh.set_alpha(1.0)
919.     assert lh.get_facecolor()[:-1] == hh[1].get_facecolor()[:-1]
920.     assert lh.get_edgecolor()[:-1] == hh[1].get_edgecolor()[:-1]
921. 
922. 
923. @needs_usetex
924. def test_usetex_no_warn(caplog):
925.     mpl.rcParams['font.family'] = 'serif'
926.     mpl.rcParams['font.serif'] = 'Computer Modern'
927.     mpl.rcParams['text.usetex'] = True
928. 
929.     fig, ax = plt.subplots()
930.     ax.plot(0, 0, label='input')
931.     ax.legend(title="My legend")
932. 
933.     fig.canvas.draw()
934.     assert "Font family ['serif'] not found." not in caplog.text
935. 
936. 
937. def test_warn_big_data_best_loc():
938.     fig, ax = plt.subplots()
939.     fig.canvas.draw()  # So that we can call draw_artist later.
940.     for idx in range(1000):
941.         ax.plot(np.arange(5000), label=idx)
942.     with rc_context({'legend.loc': 'best'}):
943.         legend = ax.legend()
944.     with pytest.warns(UserWarning) as records:
945.         fig.draw_artist(legend)  # Don't bother drawing the lines -- it's slow.
946.     # The _find_best_position method of Legend is called twice, duplicating
947.     # the warning message.
948.     assert len(records) == 2
949.     for record in records:
950.         assert str(record.message) == (
951.             'Creating legend with loc="best" can be slow with large '
952.             'amounts of data.')
953. 
954. 
955. def test_no_warn_big_data_when_loc_specified():
956.     fig, ax = plt.subplots()
957.     fig.canvas.draw()
958.     for idx in range(1000):
959.         ax.plot(np.arange(5000), label=idx)
960.     legend = ax.legend('best')
961.     fig.draw_artist(legend)  # Check that no warning is emitted.
962. 
963. 
964. @pytest.mark.parametrize('label_array', [['low', 'high'],
965.                                          ('low', 'high'),
966.                                          np.array(['low', 'high'])])
967. def test_plot_multiple_input_multiple_label(label_array):
968.     # test ax.plot() with multidimensional input
969.     # and multiple labels
970.     x = [1, 2, 3]
971.     y = [[1, 2],
972.          [2, 5],
973.          [4, 9]]
974. 
975.     fig, ax = plt.subplots()
976.     ax.plot(x, y, label=label_array)
977.     leg = ax.legend()
978.     legend_texts = [entry.get_text() for entry in leg.get_texts()]
979.     assert legend_texts == ['low', 'high']
980. 
981. 
982. @pytest.mark.parametrize('label', ['one', 1, int])
983. def test_plot_multiple_input_single_label(label):
984.     # test ax.plot() with multidimensional input
985.     # and single label
986.     x = [1, 2, 3]
987.     y = [[1, 2],
988.          [2, 5],
989.          [4, 9]]
990. 
991.     fig, ax = plt.subplots()
992.     ax.plot(x, y, label=label)
993.     leg = ax.legend()
994.     legend_texts = [entry.get_text() for entry in leg.get_texts()]
995.     assert legend_texts == [str(label)] * 2
996. 
997. 
998. @pytest.mark.parametrize('label_array', [['low', 'high'],
999.                                          ('low', 'high'),
1000.                                          np.array(['low', 'high'])])


File: lib/matplotlib/tests/test_legend.py
Line number range: 1001 - 1269
Content:
1001. def test_plot_single_input_multiple_label(label_array):
1002.     # test ax.plot() with 1D array like input
1003.     # and iterable label
1004.     x = [1, 2, 3]
1005.     y = [2, 5, 6]
1006.     fig, ax = plt.subplots()
1007.     ax.plot(x, y, label=label_array)
1008.     leg = ax.legend()
1009.     assert len(leg.get_texts()) == 1
1010.     assert leg.get_texts()[0].get_text() == str(label_array)
1011. 
1012. 
1013. def test_plot_multiple_label_incorrect_length_exception():
1014.     # check that exception is raised if multiple labels
1015.     # are given, but number of on labels != number of lines
1016.     with pytest.raises(ValueError):
1017.         x = [1, 2, 3]
1018.         y = [[1, 2],
1019.              [2, 5],
1020.              [4, 9]]
1021.         label = ['high', 'low', 'medium']
1022.         fig, ax = plt.subplots()
1023.         ax.plot(x, y, label=label)
1024. 
1025. 
1026. def test_legend_face_edgecolor():
1027.     # Smoke test for PolyCollection legend handler with 'face' edgecolor.
1028.     fig, ax = plt.subplots()
1029.     ax.fill_between([0, 1, 2], [1, 2, 3], [2, 3, 4],
1030.                     facecolor='r', edgecolor='face', label='Fill')
1031.     ax.legend()
1032. 
1033. 
1034. def test_legend_text_axes():
1035.     fig, ax = plt.subplots()
1036.     ax.plot([1, 2], [3, 4], label='line')
1037.     leg = ax.legend()
1038. 
1039.     assert leg.axes is ax
1040.     assert leg.get_texts()[0].axes is ax
1041. 
1042. 
1043. def test_handlerline2d():
1044.     # Test marker consistency for monolithic Line2D legend handler (#11357).
1045.     fig, ax = plt.subplots()
1046.     ax.scatter([0, 1], [0, 1], marker="v")
1047.     handles = [mlines.Line2D([0], [0], marker="v")]
1048.     leg = ax.legend(handles, ["Aardvark"], numpoints=1)
1049.     assert handles[0].get_marker() == leg.legendHandles[0].get_marker()
1050. 
1051. 
1052. def test_subfigure_legend():
1053.     # Test that legend can be added to subfigure (#20723)
1054.     subfig = plt.figure().subfigures()
1055.     ax = subfig.subplots()
1056.     ax.plot([0, 1], [0, 1], label="line")
1057.     leg = subfig.legend()
1058.     assert leg.figure is subfig
1059. 
1060. 
1061. def test_setting_alpha_keeps_polycollection_color():
1062.     pc = plt.fill_between([0, 1], [2, 3], color='#123456', label='label')
1063.     patch = plt.legend().get_patches()[0]
1064.     patch.set_alpha(0.5)
1065.     assert patch.get_facecolor()[:3] == tuple(pc.get_facecolor()[0][:3])
1066.     assert patch.get_edgecolor()[:3] == tuple(pc.get_edgecolor()[0][:3])
1067. 
1068. 
1069. def test_legend_markers_from_line2d():
1070.     # Test that markers can be copied for legend lines (#17960)
1071.     _markers = ['.', '*', 'v']
1072.     fig, ax = plt.subplots()
1073.     lines = [mlines.Line2D([0], [0], ls='None', marker=mark)
1074.              for mark in _markers]
1075.     labels = ["foo", "bar", "xyzzy"]
1076.     markers = [line.get_marker() for line in lines]
1077.     legend = ax.legend(lines, labels)
1078. 
1079.     new_markers = [line.get_marker() for line in legend.get_lines()]
1080.     new_labels = [text.get_text() for text in legend.get_texts()]
1081. 
1082.     assert markers == new_markers == _markers
1083.     assert labels == new_labels
1084. 
1085. 
1086. @check_figures_equal()
1087. def test_ncol_ncols(fig_test, fig_ref):
1088.     # Test that both ncol and ncols work
1089.     strings = ["a", "b", "c", "d", "e", "f"]
1090.     ncols = 3
1091.     fig_test.legend(strings, ncol=ncols)
1092.     fig_ref.legend(strings, ncols=ncols)


File: lib/matplotlib/tests/test_offsetbox.py
Line number range: 1 - 337
Content:
1. from collections import namedtuple
2. import io
3. 
4. import numpy as np
5. from numpy.testing import assert_allclose
6. import pytest
7. 
8. from matplotlib.testing.decorators import image_comparison
9. import matplotlib.pyplot as plt
10. import matplotlib.patches as mpatches
11. import matplotlib.lines as mlines
12. from matplotlib.backend_bases import MouseButton, MouseEvent
13. 
14. from matplotlib.offsetbox import (
15.     AnchoredOffsetbox, AnnotationBbox, AnchoredText, DrawingArea, OffsetBox,
16.     OffsetImage, TextArea, _get_packed_offsets)
17. 
18. 
19. @image_comparison(['offsetbox_clipping'], remove_text=True)
20. def test_offsetbox_clipping():
21.     # - create a plot
22.     # - put an AnchoredOffsetbox with a child DrawingArea
23.     #   at the center of the axes
24.     # - give the DrawingArea a gray background
25.     # - put a black line across the bounds of the DrawingArea
26.     # - see that the black line is clipped to the edges of
27.     #   the DrawingArea.
28.     fig, ax = plt.subplots()
29.     size = 100
30.     da = DrawingArea(size, size, clip=True)
31.     bg = mpatches.Rectangle((0, 0), size, size,
32.                             facecolor='#CCCCCC',
33.                             edgecolor='None',
34.                             linewidth=0)
35.     line = mlines.Line2D([-size*.5, size*1.5], [size/2, size/2],
36.                          color='black',
37.                          linewidth=10)
38.     anchored_box = AnchoredOffsetbox(
39.         loc='center',
40.         child=da,
41.         pad=0.,
42.         frameon=False,
43.         bbox_to_anchor=(.5, .5),
44.         bbox_transform=ax.transAxes,
45.         borderpad=0.)
46. 
47.     da.add_artist(bg)
48.     da.add_artist(line)
49.     ax.add_artist(anchored_box)
50.     ax.set_xlim((0, 1))
51.     ax.set_ylim((0, 1))
52. 
53. 
54. def test_offsetbox_clip_children():
55.     # - create a plot
56.     # - put an AnchoredOffsetbox with a child DrawingArea
57.     #   at the center of the axes
58.     # - give the DrawingArea a gray background
59.     # - put a black line across the bounds of the DrawingArea
60.     # - see that the black line is clipped to the edges of
61.     #   the DrawingArea.
62.     fig, ax = plt.subplots()
63.     size = 100
64.     da = DrawingArea(size, size, clip=True)
65.     bg = mpatches.Rectangle((0, 0), size, size,
66.                             facecolor='#CCCCCC',
67.                             edgecolor='None',
68.                             linewidth=0)
69.     line = mlines.Line2D([-size*.5, size*1.5], [size/2, size/2],
70.                          color='black',
71.                          linewidth=10)
72.     anchored_box = AnchoredOffsetbox(
73.         loc='center',
74.         child=da,
75.         pad=0.,
76.         frameon=False,
77.         bbox_to_anchor=(.5, .5),
78.         bbox_transform=ax.transAxes,
79.         borderpad=0.)
80. 
81.     da.add_artist(bg)
82.     da.add_artist(line)
83.     ax.add_artist(anchored_box)
84. 
85.     fig.canvas.draw()
86.     assert not fig.stale
87.     da.clip_children = True
88.     assert fig.stale
89. 
90. 
91. def test_offsetbox_loc_codes():
92.     # Check that valid string location codes all work with an AnchoredOffsetbox
93.     codes = {'upper right': 1,
94.              'upper left': 2,
95.              'lower left': 3,
96.              'lower right': 4,
97.              'right': 5,
98.              'center left': 6,
99.              'center right': 7,
100.              'lower center': 8,
101.              'upper center': 9,
102.              'center': 10,
103.              }
104.     fig, ax = plt.subplots()
105.     da = DrawingArea(100, 100)
106.     for code in codes:
107.         anchored_box = AnchoredOffsetbox(loc=code, child=da)
108.         ax.add_artist(anchored_box)
109.     fig.canvas.draw()
110. 
111. 
112. def test_expand_with_tight_layout():
113.     # Check issue reported in #10476, and updated due to #10784
114.     fig, ax = plt.subplots()
115. 
116.     d1 = [1, 2]
117.     d2 = [2, 1]
118.     ax.plot(d1, label='series 1')
119.     ax.plot(d2, label='series 2')
120.     ax.legend(ncols=2, mode='expand')
121. 
122.     fig.tight_layout()  # where the crash used to happen
123. 
124. 
125. @pytest.mark.parametrize('widths',
126.                          ([150], [150, 150, 150], [0.1], [0.1, 0.1]))
127. @pytest.mark.parametrize('total', (250, 100, 0, -1, None))
128. @pytest.mark.parametrize('sep', (250, 1, 0, -1))
129. @pytest.mark.parametrize('mode', ("expand", "fixed", "equal"))
130. def test_get_packed_offsets(widths, total, sep, mode):
131.     # Check a (rather arbitrary) set of parameters due to successive similar
132.     # issue tickets (at least #10476 and #10784) related to corner cases
133.     # triggered inside this function when calling higher-level functions
134.     # (e.g. `Axes.legend`).
135.     # These are just some additional smoke tests. The output is untested.
136.     _get_packed_offsets(widths, total, sep, mode=mode)
137. 
138. 
139. _Params = namedtuple('_params', 'wd_list, total, sep, expected')
140. 
141. 
142. @pytest.mark.parametrize('widths, total, sep, expected', [
143.     _Params(  # total=None
144.         [3, 1, 2], total=None, sep=1, expected=(8, [0, 4, 6])),
145.     _Params(  # total larger than required
146.         [3, 1, 2], total=10, sep=1, expected=(10, [0, 4, 6])),
147.     _Params(  # total smaller than required
148.         [3, 1, 2], total=5, sep=1, expected=(5, [0, 4, 6])),
149. ])
150. def test_get_packed_offsets_fixed(widths, total, sep, expected):
151.     result = _get_packed_offsets(widths, total, sep, mode='fixed')
152.     assert result[0] == expected[0]
153.     assert_allclose(result[1], expected[1])
154. 
155. 
156. @pytest.mark.parametrize('widths, total, sep, expected', [
157.     _Params(  # total=None (implicit 1)
158.         [.1, .1, .1], total=None, sep=None, expected=(1, [0, .45, .9])),
159.     _Params(  # total larger than sum of widths
160.         [3, 1, 2], total=10, sep=1, expected=(10, [0, 5, 8])),
161.     _Params(  # total smaller sum of widths: overlapping boxes
162.         [3, 1, 2], total=5, sep=1, expected=(5, [0, 2.5, 3])),
163. ])
164. def test_get_packed_offsets_expand(widths, total, sep, expected):
165.     result = _get_packed_offsets(widths, total, sep, mode='expand')
166.     assert result[0] == expected[0]
167.     assert_allclose(result[1], expected[1])
168. 
169. 
170. @pytest.mark.parametrize('widths, total, sep, expected', [
171.     _Params(  # total larger than required
172.         [3, 2, 1], total=6, sep=None, expected=(6, [0, 2, 4])),
173.     _Params(  # total smaller sum of widths: overlapping boxes
174.         [3, 2, 1, .5], total=2, sep=None, expected=(2, [0, 0.5, 1, 1.5])),
175.     _Params(  # total larger than required
176.         [.5, 1, .2], total=None, sep=1, expected=(6, [0, 2, 4])),
177.     # the case total=None, sep=None is tested separately below
178. ])
179. def test_get_packed_offsets_equal(widths, total, sep, expected):
180.     result = _get_packed_offsets(widths, total, sep, mode='equal')
181.     assert result[0] == expected[0]
182.     assert_allclose(result[1], expected[1])
183. 
184. 
185. def test_get_packed_offsets_equal_total_none_sep_none():
186.     with pytest.raises(ValueError):
187.         _get_packed_offsets([1, 1, 1], total=None, sep=None, mode='equal')
188. 
189. 
190. @pytest.mark.parametrize('child_type', ['draw', 'image', 'text'])
191. @pytest.mark.parametrize('boxcoords',
192.                          ['axes fraction', 'axes pixels', 'axes points',
193.                           'data'])
194. def test_picking(child_type, boxcoords):
195.     # These all take up approximately the same area.
196.     if child_type == 'draw':
197.         picking_child = DrawingArea(5, 5)
198.         picking_child.add_artist(mpatches.Rectangle((0, 0), 5, 5, linewidth=0))
199.     elif child_type == 'image':
200.         im = np.ones((5, 5))
201.         im[2, 2] = 0
202.         picking_child = OffsetImage(im)
203.     elif child_type == 'text':
204.         picking_child = TextArea('\N{Black Square}', textprops={'fontsize': 5})
205.     else:
206.         assert False, f'Unknown picking child type {child_type}'
207. 
208.     fig, ax = plt.subplots()
209.     ab = AnnotationBbox(picking_child, (0.5, 0.5), boxcoords=boxcoords)
210.     ab.set_picker(True)
211.     ax.add_artist(ab)
212. 
213.     calls = []
214.     fig.canvas.mpl_connect('pick_event', lambda event: calls.append(event))
215. 
216.     # Annotation should be picked by an event occurring at its center.
217.     if boxcoords == 'axes points':
218.         x, y = ax.transAxes.transform_point((0, 0))
219.         x += 0.5 * fig.dpi / 72
220.         y += 0.5 * fig.dpi / 72
221.     elif boxcoords == 'axes pixels':
222.         x, y = ax.transAxes.transform_point((0, 0))
223.         x += 0.5
224.         y += 0.5
225.     else:
226.         x, y = ax.transAxes.transform_point((0.5, 0.5))
227.     fig.canvas.draw()
228.     calls.clear()
229.     MouseEvent(
230.         "button_press_event", fig.canvas, x, y, MouseButton.LEFT)._process()
231.     assert len(calls) == 1 and calls[0].artist == ab
232. 
233.     # Annotation should *not* be picked by an event at its original center
234.     # point when the limits have changed enough to hide the *xy* point.
235.     ax.set_xlim(-1, 0)
236.     ax.set_ylim(-1, 0)
237.     fig.canvas.draw()
238.     calls.clear()
239.     MouseEvent(
240.         "button_press_event", fig.canvas, x, y, MouseButton.LEFT)._process()
241.     assert len(calls) == 0
242. 
243. 
244. @image_comparison(['anchoredtext_align.png'], remove_text=True, style='mpl20')
245. def test_anchoredtext_horizontal_alignment():
246.     fig, ax = plt.subplots()
247. 
248.     text0 = AnchoredText("test\ntest long text", loc="center left",
249.                          pad=0.2, prop={"ha": "left"})
250.     ax.add_artist(text0)
251.     text1 = AnchoredText("test\ntest long text", loc="center",
252.                          pad=0.2, prop={"ha": "center"})
253.     ax.add_artist(text1)
254.     text2 = AnchoredText("test\ntest long text", loc="center right",
255.                          pad=0.2, prop={"ha": "right"})
256.     ax.add_artist(text2)
257. 
258. 
259. def test_annotationbbox_extents():
260.     plt.rcParams.update(plt.rcParamsDefault)
261.     fig, ax = plt.subplots(figsize=(4, 3), dpi=100)
262. 
263.     ax.axis([0, 1, 0, 1])
264. 
265.     an1 = ax.annotate("Annotation", xy=(.9, .9), xytext=(1.1, 1.1),
266.                       arrowprops=dict(arrowstyle="->"), clip_on=False,
267.                       va="baseline", ha="left")
268. 
269.     da = DrawingArea(20, 20, 0, 0, clip=True)
270.     p = mpatches.Circle((-10, 30), 32)
271.     da.add_artist(p)
272. 
273.     ab3 = AnnotationBbox(da, [.5, .5], xybox=(-0.2, 0.5), xycoords='data',
274.                          boxcoords="axes fraction", box_alignment=(0., .5),
275.                          arrowprops=dict(arrowstyle="->"))
276.     ax.add_artist(ab3)
277. 
278.     im = OffsetImage(np.random.rand(10, 10), zoom=3)
279.     im.image.axes = ax
280.     ab6 = AnnotationBbox(im, (0.5, -.3), xybox=(0, 75),
281.                          xycoords='axes fraction',
282.                          boxcoords="offset points", pad=0.3,
283.                          arrowprops=dict(arrowstyle="->"))
284.     ax.add_artist(ab6)
285. 
286.     fig.canvas.draw()
287.     renderer = fig.canvas.get_renderer()
288. 
289.     # Test Annotation
290.     bb1w = an1.get_window_extent(renderer)
291.     bb1e = an1.get_tightbbox(renderer)
292. 
293.     target1 = [332.9, 242.8, 467.0, 298.9]
294.     assert_allclose(bb1w.extents, target1, atol=2)
295.     assert_allclose(bb1e.extents, target1, atol=2)
296. 
297.     # Test AnnotationBbox
298.     bb3w = ab3.get_window_extent(renderer)
299.     bb3e = ab3.get_tightbbox(renderer)
300. 
301.     target3 = [-17.6, 129.0, 200.7, 167.9]
302.     assert_allclose(bb3w.extents, target3, atol=2)
303.     assert_allclose(bb3e.extents, target3, atol=2)
304. 
305.     bb6w = ab6.get_window_extent(renderer)
306.     bb6e = ab6.get_tightbbox(renderer)
307. 
308.     target6 = [180.0, -32.0, 230.0, 92.9]
309.     assert_allclose(bb6w.extents, target6, atol=2)
310.     assert_allclose(bb6e.extents, target6, atol=2)
311. 
312.     # Test bbox_inches='tight'
313.     buf = io.BytesIO()
314.     fig.savefig(buf, bbox_inches='tight')
315.     buf.seek(0)
316.     shape = plt.imread(buf).shape
317.     targetshape = (350, 504, 4)
318.     assert_allclose(shape, targetshape, atol=2)
319. 
320.     # Simple smoke test for tight_layout, to make sure it does not error out.
321.     fig.canvas.draw()
322.     fig.tight_layout()
323.     fig.canvas.draw()
324. 
325. 
326. def test_zorder():
327.     assert OffsetBox(zorder=42).zorder == 42
328. 
329. 
330. def test_arrowprops_copied():
331.     da = DrawingArea(20, 20, 0, 0, clip=True)
332.     arrowprops = {"arrowstyle": "->", "relpos": (.3, .7)}
333.     ab = AnnotationBbox(da, [.5, .5], xybox=(-0.2, 0.5), xycoords='data',
334.                         boxcoords="axes fraction", box_alignment=(0., .5),
335.                         arrowprops=arrowprops)
336.     assert ab.arrowprops is not ab
337.     assert arrowprops["relpos"] == (.3, .7)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 00:40:36,647 - thread-133211025835712.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have analyzed the provided test files, `lib/matplotlib/tests/test_offsetbox.py` and `lib/matplotlib/tests/test_legend.py`. While there are no direct test cases for `HPacker`'s vertical alignment, I have found three relevant existing test cases. One tests the alignment property of a `VPacker` within a `Legend` context, which is conceptually similar to the bug. Another tests horizontal alignment within an `AnchoredText` box, demonstrating alignment testing for offset boxes. The third is an image comparison test for a multi-column legend, which uses `HPacker` internally. These are the most similar test cases I could find in the provided files. Therefore, the current context is sufficient to answer the user's query." query='' extra_requirements='' purpose=''
2025-12-21 00:40:36,648 - thread-133211025835712.prometheus_context_collector - INFO - Successfully retrieved 4 context snippets
