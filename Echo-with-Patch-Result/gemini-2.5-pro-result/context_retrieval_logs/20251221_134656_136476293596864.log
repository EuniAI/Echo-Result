2025-12-21 13:46:56,926 - thread-136476293596864.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: `Permutation` constructor fails with non-disjoint cycles

Description: Calling `Permutation([[0,1],[0,1]])` raises a `ValueError` instead of constructing the identity permutation.  If the cycles passed in are non-disjoint, they should be applied in left-to-right order and the resulting permutation should be returned.

This should be easy to compute.  I don't see a reason why non-disjoint cycles should be forbidden.

Patch information:
diff --git a/sympy/combinatorics/permutations.py b/sympy/combinatorics/permutations.py
index 136ed5a478..27f6311f4d 100644
--- a/sympy/combinatorics/permutations.py
+++ b/sympy/combinatorics/permutations.py
@@ -800,9 +800,12 @@ class Permutation(Basic):
 
     def __new__(cls, *args, **kwargs):
         """
-        Constructor for the Permutation object from a list or a
-        list of lists in which all elements of the permutation may
-        appear only once.
+        Constructor for the Permutation object from a list or from a
+        list of lists (cycles). When given cycles, overlapping elements
+        are allowed and cycles are composed from left to right to form
+        the resulting permutation. However, an element that appears as a
+        singleton (a 1-element cycle) must not appear in any other cycle
+        in the input.
 
         Examples
         ========
@@ -894,14 +897,20 @@ def __new__(cls, *args, **kwargs):
         # for convenience in case one wants to enter permutations where
         # counting starts from 1.
 
-        temp = flatten(args)
-        if has_dups(temp):
-            if is_cycle:
-                raise ValueError('there were repeated elements; to resolve '
-                'cycles use Cycle%s.' % ''.join([str(tuple(c)) for c in args]))
-            else:
+        ftemp = flatten(args)
+        if not is_cycle:
+            if has_dups(ftemp):
                 raise ValueError('there were repeated elements.')
-        temp = set(temp)
+        else:
+            singles = [c[0] for c in args if len(c) == 1]
+            if singles:
+                counts = {}
+                for x in ftemp:
+                    counts[x] = counts.get(x, 0) + 1
+                for s in set(singles):
+                    if counts.get(s, 0) > 1:
+                        raise ValueError('a singleton element must not appear in any other cycle.')
+        temp = set(ftemp)
 
         if not is_cycle and \
                 any(i not in temp for i in range(len(temp))):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 13:46:57,062 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── python-comparisons.rst
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── release
|   ├── README.md
|   └── fabfile.py
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── ffunctions.py
    |   └── tests
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       └── test_ffunctions.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_eval_power.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   ├── test_var.py
    |   |   └── test_wester.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   ├── sympy_tokenize.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   └── natural.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── unitsystems.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   └── test_theanocode.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       └── test_mutable_ndim_array.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_index_methods.py
    |       ├── test_indexed.py
    |       └── test_tensor.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   └── test_timeutils.py
    |   └── timeutils.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: `Permutation` constructor fails with non-disjoint cycles

Description: Calling `Permutation([[0,1],[0,1]])` raises a `ValueError` instead of constructing the identity permutation.  If the cycles passed in are non-disjoint, they should be applied in left-to-right order and the resulting permutation should be returned.

This should be easy to compute.  I don't see a reason why non-disjoint cycles should be forbidden.

Patch information:
diff --git a/sympy/combinatorics/permutations.py b/sympy/combinatorics/permutations.py
index 136ed5a478..27f6311f4d 100644
--- a/sympy/combinatorics/permutations.py
+++ b/sympy/combinatorics/permutations.py
@@ -800,9 +800,12 @@ class Permutation(Basic):
 
     def __new__(cls, *args, **kwargs):
         """
-        Constructor for the Permutation object from a list or a
-        list of lists in which all elements of the permutation may
-        appear only once.
+        Constructor for the Permutation object from a list or from a
+        list of lists (cycles). When given cycles, overlapping elements
+        are allowed and cycles are composed from left to right to form
+        the resulting permutation. However, an element that appears as a
+        singleton (a 1-element cycle) must not appear in any other cycle
+        in the input.
 
         Examples
         ========
@@ -894,14 +897,20 @@ def __new__(cls, *args, **kwargs):
         # for convenience in case one wants to enter permutations where
         # counting starts from 1.
 
-        temp = flatten(args)
-        if has_dups(temp):
-            if is_cycle:
-                raise ValueError('there were repeated elements; to resolve '
-                'cycles use Cycle%s.' % ''.join([str(tuple(c)) for c in args]))
-            else:
+        ftemp = flatten(args)
+        if not is_cycle:
+            if has_dups(ftemp):
                 raise ValueError('there were repeated elements.')
-        temp = set(temp)
+        else:
+            singles = [c[0] for c in args if len(c) == 1]
+            if singles:
+                counts = {}
+                for x in ftemp:
+                    counts[x] = counts.get(x, 0) + 1
+                for s in set(singles):
+                    if counts.get(s, 0) > 1:
+                        raise ValueError('a singleton element must not appear in any other cycle.')
+        temp = set(ftemp)
 
         if not is_cycle and \
                 any(i not in temp for i in range(len(temp))):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 13:47:12,041 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find 3 relevant test cases for a bug in the `Permutation` constructor. The bug occurs when non-disjoint cycles are passed to the constructor. To find relevant tests, I need to examine the tests for the `Permutation` class, which are located in `sympy/combinatorics/tests/test_permutations.py`. This file is not in the current context, so I need to request it.' query='Please provide the full content of the file `sympy/combinatorics/tests/test_permutations.py`.' extra_requirements='' purpose='I need to inspect the test file for the Permutation class to find test cases that are relevant to its constructor, especially those dealing with cycle notation and error handling.'
2025-12-21 13:47:12,043 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `sympy/combinatorics/tests/test_permutations.py`.
2025-12-21 13:47:12,043 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 13:47:12,044 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 13:47:12,044 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 13:47:12,044 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `sympy/combinatorics/tests/test_permutations.py`.
Purpose: I need to inspect the test file for the Permutation class to find test cases that are relevant to its constructor, especially those dealing with cycle notation and error handling.
2025-12-21 13:47:18,039 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I first searched for the file `sympy/combinatorics/tests/test_permutations.py` to get its metadata. Then, I used the line numbers from the file's metadata to read the entire content of the file." additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "sympy/combinatorics/tests/test_permutations.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2073, 'candidates_token_count': 75, 'total_token_count': 2598, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2073}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 75}], 'thoughts_token_count': 450, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5909578450520834, 'model_name': 'gemini-2.5-pro'} id='run--b668cc16-5134-420f-9d57-ee18cf32d121-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'sympy/combinatorics/tests/test_permutations.py'}, 'id': '9431a25b-134f-4646-80a3-c4d75ef7342d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2073, 'output_tokens': 75, 'total_tokens': 2598, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 450}}
2025-12-21 13:47:20,061 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/combinatorics/tests/test_permutations.py"}'}, '__gemini_function_call_thought_signatures__': {'c27ad3f0-cf51-42b9-a302-856d49e6f9ad': 'Ct0DAY89a1/YCXOZ8g5LhU3TDgxNzH6vu35HTYAwqlq5IiHxZqnZh26u4/ayxK2ajtxs4UrzOc37fUV62GbvfPR41DbFuXu5Bj07OQgsX8B9A5orDsMjPIk1lUKBcJLj8Aq3s5NOlaHJheIx+PcjBtFCwG393IWlvo/1lg3kJCcvxAjVKkZCdJIIm7AI5qb6hjtAVdRFy3kBHaJiEcCIJ1oD8cElcriflKHWtPVg0P9ewc1Wu26kP3/pgC8g7G1TfakrJbdTVcBw65rrRxLucx+AcoTKgHxPIFcD25mLbbffgPEt4aIbl5xDw7OJ8eN2xGq2HzgcQuwHonrGSYFYjPhePBbmE4scfouqusaBIEMR+DEofQIrrpPN51qi5eWMUN3v9YpGJIDbgk+C+dzmytDrwgOdzUjhgTnh260MHwp+fXKVskHaUAhlSZEEwQ9QEuS8pgOgccqJhpBXMSxRIHuqTmEQXHJ0ivfLV2cLTb/YbTdIMx+bOploy4QDDGBAxvU+2aKUiHlUaZSMCihBgF0y+sUo/BFWINOFillu5Oaf5fk6ZMq2/pyrmFy1BEONHfeLa0SuaL0bOKHDETGCM2fss1VRYwphz9UoXxlNLmahnmYhw50bn4g+n48Wtdg+'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2213, 'candidates_token_count': 27, 'total_token_count': 2355, 'cached_content_token_count': 1466, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2213}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1466}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 115}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3486836751302083, 'model_name': 'gemini-2.5-pro'} id='run--f8d1f503-19d4-44b0-92ea-d8252f5d13dd-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/combinatorics/tests/test_permutations.py'}, 'id': 'c27ad3f0-cf51-42b9-a302-856d49e6f9ad', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2213, 'output_tokens': 27, 'total_tokens': 2355, 'input_token_details': {'cache_read': 1466}, 'output_token_details': {'reasoning': 115}}
2025-12-21 13:47:22,426 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1000.0, "start_line": 422.0, "relative_path": "sympy/combinatorics/tests/test_permutations.py"}'}, '__gemini_function_call_thought_signatures__': {'2f230912-d79f-4eb6-afc9-b2c5f7769dce': 'CrIDAY89a1+Q8c+dJb9bGmBgqz4XyQ51GNwBZZhn80mCLbOkJ1Bo48ttizghpGOhCCe0OHNCjeRoe5m9mAIMH5j5l3A2f4wNliFwphTyQcPe+wFpJpxnBXB3SDJQJLJ/aJRN7zZtI59LnF0PJMxUUSzq2ejYjBeoVWnmz3cF9vxVp95krv3iasyKQTbYHxmdKt5AIonnDhcszANMcuhn6qREDbtKd3ufo5+7cpUmwuak5QUgtWSKcvRMI1GT3KzP+DcmlhsYqWZzuqM8eBV7VB6lSzyY9NTnO3RDtAwNVK2keUwFdjQXjw9K8u8MOcq45nCSMI/cOnCuxgI+PJeKepVybVrDPA6J5hPZ3ZWbDV2WvFmes0fw+NScTmCdJZcdoB3PZEA4DP7tybdwznBUCNxPiogdOFKnEX08z0y5hJw3WWIw8y3lWaiOZbgEoF1mHfS3hx4MDXd1BCipZLbRlzM3J7yHBv90vtdPLYuKBB7qjWnRUOIPexzq7+wWnbc8oHQ/UQbpZzSgCBkKe5kqFBIdtORDk78exFsm19vRlmgHvUtntVx4LtXt4PSyIaSj8DIrmRk='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10958, 'candidates_token_count': 33, 'total_token_count': 11104, 'cached_content_token_count': 1879, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11073}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1879}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 33}], 'thoughts_token_count': 113}, 'finish_reason': 'STOP', 'avg_logprobs': -0.26452006715716736, 'model_name': 'gemini-2.5-pro'} id='run--6f787203-5c32-47b9-afba-3e9e98d22675-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1000.0, 'start_line': 422.0, 'relative_path': 'sympy/combinatorics/tests/test_permutations.py'}, 'id': '2f230912-d79f-4eb6-afc9-b2c5f7769dce', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10958, 'output_tokens': 33, 'total_tokens': 11104, 'input_token_details': {'cache_read': 1879}, 'output_token_details': {'reasoning': 113}}
2025-12-21 13:47:26,452 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `sympy/combinatorics/tests/test_permutations.py` as you requested. I first located the file within the project structure and then read its contents in two parts to ensure the entire file was captured. The test file is now fully available for your inspection.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11083, 'candidates_token_count': 64, 'total_token_count': 11430, 'cached_content_token_count': 9368, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11311}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9368}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 283}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3267633318901062, 'model_name': 'gemini-2.5-pro'} id='run--6af59637-833b-480c-84d3-f96f50bca0c8-0' usage_metadata={'input_tokens': 11083, 'output_tokens': 64, 'total_tokens': 11430, 'input_token_details': {'cache_read': 9368}, 'output_token_details': {'reasoning': 283}}
2025-12-21 13:47:26,454 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `sympy/combinatorics/tests/test_permutations.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to inspect the test file for the Permutation class to find test cases that are relevant to its constructor, especially those dealing with cycle notation and error handling.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/combinatorics/tests/test_permutations.py
Line number range: 1 - 421
Content:
1. from itertools import permutations
2. 
3. from sympy.core.compatibility import range
4. from sympy.core.symbol import Symbol
5. from sympy.combinatorics.permutations import (Permutation, _af_parity,
6.     _af_rmul, _af_rmuln, Cycle)
7. from sympy.utilities.pytest import raises
8. 
9. rmul = Permutation.rmul
10. a = Symbol('a', integer=True)
11. 
12. 
13. def test_Permutation():
14.     # don't auto fill 0
15.     raises(ValueError, lambda: Permutation([1]))
16.     p = Permutation([0, 1, 2, 3])
17.     # call as bijective
18.     assert [p(i) for i in range(p.size)] == list(p)
19.     # call as operator
20.     assert p(list(range(p.size))) == list(p)
21.     # call as function
22.     assert list(p(1, 2)) == [0, 2, 1, 3]
23.     # conversion to list
24.     assert list(p) == list(range(4))
25.     assert Permutation(size=4) == Permutation(3)
26.     assert Permutation(Permutation(3), size=5) == Permutation(4)
27.     # cycle form with size
28.     assert Permutation([[1, 2]], size=4) == Permutation([[1, 2], [0], [3]])
29.     # random generation
30.     assert Permutation.random(2) in (Permutation([1, 0]), Permutation([0, 1]))
31. 
32.     p = Permutation([2, 5, 1, 6, 3, 0, 4])
33.     q = Permutation([[1], [0, 3, 5, 6, 2, 4]])
34.     assert len({p, p}) == 1
35.     r = Permutation([1, 3, 2, 0, 4, 6, 5])
36.     ans = Permutation(_af_rmuln(*[w.array_form for w in (p, q, r)])).array_form
37.     assert rmul(p, q, r).array_form == ans
38.     # make sure no other permutation of p, q, r could have given
39.     # that answer
40.     for a, b, c in permutations((p, q, r)):
41.         if (a, b, c) == (p, q, r):
42.             continue
43.         assert rmul(a, b, c).array_form != ans
44. 
45.     assert p.support() == list(range(7))
46.     assert q.support() == [0, 2, 3, 4, 5, 6]
47.     assert Permutation(p.cyclic_form).array_form == p.array_form
48.     assert p.cardinality == 5040
49.     assert q.cardinality == 5040
50.     assert q.cycles == 2
51.     assert rmul(q, p) == Permutation([4, 6, 1, 2, 5, 3, 0])
52.     assert rmul(p, q) == Permutation([6, 5, 3, 0, 2, 4, 1])
53.     assert _af_rmul(p.array_form, q.array_form) == \
54.         [6, 5, 3, 0, 2, 4, 1]
55. 
56.     assert rmul(Permutation([[1, 2, 3], [0, 4]]),
57.                 Permutation([[1, 2, 4], [0], [3]])).cyclic_form == \
58.         [[0, 4, 2], [1, 3]]
59.     assert q.array_form == [3, 1, 4, 5, 0, 6, 2]
60.     assert q.cyclic_form == [[0, 3, 5, 6, 2, 4]]
61.     assert q.full_cyclic_form == [[0, 3, 5, 6, 2, 4], [1]]
62.     assert p.cyclic_form == [[0, 2, 1, 5], [3, 6, 4]]
63.     t = p.transpositions()
64.     assert t == [(0, 5), (0, 1), (0, 2), (3, 4), (3, 6)]
65.     assert Permutation.rmul(*[Permutation(Cycle(*ti)) for ti in (t)])
66.     assert Permutation([1, 0]).transpositions() == [(0, 1)]
67. 
68.     assert p**13 == p
69.     assert q**0 == Permutation(list(range(q.size)))
70.     assert q**-2 == ~q**2
71.     assert q**2 == Permutation([5, 1, 0, 6, 3, 2, 4])
72.     assert q**3 == q**2*q
73.     assert q**4 == q**2*q**2
74. 
75.     a = Permutation(1, 3)
76.     b = Permutation(2, 0, 3)
77.     I = Permutation(3)
78.     assert ~a == a**-1
79.     assert a*~a == I
80.     assert a*b**-1 == a*~b
81. 
82.     ans = Permutation(0, 5, 3, 1, 6)(2, 4)
83.     assert (p + q.rank()).rank() == ans.rank()
84.     assert (p + q.rank())._rank == ans.rank()
85.     assert (q + p.rank()).rank() == ans.rank()
86.     raises(TypeError, lambda: p + Permutation(list(range(10))))
87. 
88.     assert (p - q.rank()).rank() == Permutation(0, 6, 3, 1, 2, 5, 4).rank()
89.     assert p.rank() - q.rank() < 0  # for coverage: make sure mod is used
90.     assert (q - p.rank()).rank() == Permutation(1, 4, 6, 2)(3, 5).rank()
91. 
92.     assert p*q == Permutation(_af_rmuln(*[list(w) for w in (q, p)]))
93.     assert p*Permutation([]) == p
94.     assert Permutation([])*p == p
95.     assert p*Permutation([[0, 1]]) == Permutation([2, 5, 0, 6, 3, 1, 4])
96.     assert Permutation([[0, 1]])*p == Permutation([5, 2, 1, 6, 3, 0, 4])
97. 
98.     pq = p ^ q
99.     assert pq == Permutation([5, 6, 0, 4, 1, 2, 3])
100.     assert pq == rmul(q, p, ~q)
101.     qp = q ^ p
102.     assert qp == Permutation([4, 3, 6, 2, 1, 5, 0])
103.     assert qp == rmul(p, q, ~p)
104.     raises(ValueError, lambda: p ^ Permutation([]))
105. 
106.     assert p.commutator(q) == Permutation(0, 1, 3, 4, 6, 5, 2)
107.     assert q.commutator(p) == Permutation(0, 2, 5, 6, 4, 3, 1)
108.     assert p.commutator(q) == ~q.commutator(p)
109.     raises(ValueError, lambda: p.commutator(Permutation([])))
110. 
111.     assert len(p.atoms()) == 7
112.     assert q.atoms() == {0, 1, 2, 3, 4, 5, 6}
113. 
114.     assert p.inversion_vector() == [2, 4, 1, 3, 1, 0]
115.     assert q.inversion_vector() == [3, 1, 2, 2, 0, 1]
116. 
117.     assert Permutation.from_inversion_vector(p.inversion_vector()) == p
118.     assert Permutation.from_inversion_vector(q.inversion_vector()).array_form\
119.         == q.array_form
120.     raises(ValueError, lambda: Permutation.from_inversion_vector([0, 2]))
121.     assert Permutation([i for i in range(500, -1, -1)]).inversions() == 125250
122. 
123.     s = Permutation([0, 4, 1, 3, 2])
124.     assert s.parity() == 0
125.     _ = s.cyclic_form  # needed to create a value for _cyclic_form
126.     assert len(s._cyclic_form) != s.size and s.parity() == 0
127.     assert not s.is_odd
128.     assert s.is_even
129.     assert Permutation([0, 1, 4, 3, 2]).parity() == 1
130.     assert _af_parity([0, 4, 1, 3, 2]) == 0
131.     assert _af_parity([0, 1, 4, 3, 2]) == 1
132. 
133.     s = Permutation([0])
134. 
135.     assert s.is_Singleton
136.     assert Permutation([]).is_Empty
137. 
138.     r = Permutation([3, 2, 1, 0])
139.     assert (r**2).is_Identity
140. 
141.     assert rmul(~p, p).is_Identity
142.     assert (~p)**13 == Permutation([5, 2, 0, 4, 6, 1, 3])
143.     assert ~(r**2).is_Identity
144.     assert p.max() == 6
145.     assert p.min() == 0
146. 
147.     q = Permutation([[6], [5], [0, 1, 2, 3, 4]])
148. 
149.     assert q.max() == 4
150.     assert q.min() == 0
151. 
152.     p = Permutation([1, 5, 2, 0, 3, 6, 4])
153.     q = Permutation([[1, 2, 3, 5, 6], [0, 4]])
154. 
155.     assert p.ascents() == [0, 3, 4]
156.     assert q.ascents() == [1, 2, 4]
157.     assert r.ascents() == []
158. 
159.     assert p.descents() == [1, 2, 5]
160.     assert q.descents() == [0, 3, 5]
161.     assert Permutation(r.descents()).is_Identity
162. 
163.     assert p.inversions() == 7
164.     # test the merge-sort with a longer permutation
165.     big = list(p) + list(range(p.max() + 1, p.max() + 130))
166.     assert Permutation(big).inversions() == 7
167.     assert p.signature() == -1
168.     assert q.inversions() == 11
169.     assert q.signature() == -1
170.     assert rmul(p, ~p).inversions() == 0
171.     assert rmul(p, ~p).signature() == 1
172. 
173.     assert p.order() == 6
174.     assert q.order() == 10
175.     assert (p**(p.order())).is_Identity
176. 
177.     assert p.length() == 6
178.     assert q.length() == 7
179.     assert r.length() == 4
180. 
181.     assert p.runs() == [[1, 5], [2], [0, 3, 6], [4]]
182.     assert q.runs() == [[4], [2, 3, 5], [0, 6], [1]]
183.     assert r.runs() == [[3], [2], [1], [0]]
184. 
185.     assert p.index() == 8
186.     assert q.index() == 8
187.     assert r.index() == 3
188. 
189.     assert p.get_precedence_distance(q) == q.get_precedence_distance(p)
190.     assert p.get_adjacency_distance(q) == p.get_adjacency_distance(q)
191.     assert p.get_positional_distance(q) == p.get_positional_distance(q)
192.     p = Permutation([0, 1, 2, 3])
193.     q = Permutation([3, 2, 1, 0])
194.     assert p.get_precedence_distance(q) == 6
195.     assert p.get_adjacency_distance(q) == 3
196.     assert p.get_positional_distance(q) == 8
197.     p = Permutation([0, 3, 1, 2, 4])
198.     q = Permutation.josephus(4, 5, 2)
199.     assert p.get_adjacency_distance(q) == 3
200.     raises(ValueError, lambda: p.get_adjacency_distance(Permutation([])))
201.     raises(ValueError, lambda: p.get_positional_distance(Permutation([])))
202.     raises(ValueError, lambda: p.get_precedence_distance(Permutation([])))
203. 
204.     a = [Permutation.unrank_nonlex(4, i) for i in range(5)]
205.     iden = Permutation([0, 1, 2, 3])
206.     for i in range(5):
207.         for j in range(i + 1, 5):
208.             assert a[i].commutes_with(a[j]) == \
209.                 (rmul(a[i], a[j]) == rmul(a[j], a[i]))
210.             if a[i].commutes_with(a[j]):
211.                 assert a[i].commutator(a[j]) == iden
212.                 assert a[j].commutator(a[i]) == iden
213. 
214.     a = Permutation(3)
215.     b = Permutation(0, 6, 3)(1, 2)
216.     assert a.cycle_structure == {1: 4}
217.     assert b.cycle_structure == {2: 1, 3: 1, 1: 2}
218. 
219. 
220. def test_josephus():
221.     assert Permutation.josephus(4, 6, 1) == Permutation([3, 1, 0, 2, 5, 4])
222.     assert Permutation.josephus(1, 5, 1).is_Identity
223. 
224. 
225. def test_ranking():
226.     assert Permutation.unrank_lex(5, 10).rank() == 10
227.     p = Permutation.unrank_lex(15, 225)
228.     assert p.rank() == 225
229.     p1 = p.next_lex()
230.     assert p1.rank() == 226
231.     assert Permutation.unrank_lex(15, 225).rank() == 225
232.     assert Permutation.unrank_lex(10, 0).is_Identity
233.     p = Permutation.unrank_lex(4, 23)
234.     assert p.rank() == 23
235.     assert p.array_form == [3, 2, 1, 0]
236.     assert p.next_lex() is None
237. 
238.     p = Permutation([1, 5, 2, 0, 3, 6, 4])
239.     q = Permutation([[1, 2, 3, 5, 6], [0, 4]])
240.     a = [Permutation.unrank_trotterjohnson(4, i).array_form for i in range(5)]
241.     assert a == [[0, 1, 2, 3], [0, 1, 3, 2], [0, 3, 1, 2], [3, 0, 1,
242.         2], [3, 0, 2, 1] ]
243.     assert [Permutation(pa).rank_trotterjohnson() for pa in a] == list(range(5))
244.     assert Permutation([0, 1, 2, 3]).next_trotterjohnson() == \
245.         Permutation([0, 1, 3, 2])
246. 
247.     assert q.rank_trotterjohnson() == 2283
248.     assert p.rank_trotterjohnson() == 3389
249.     assert Permutation([1, 0]).rank_trotterjohnson() == 1
250.     a = Permutation(list(range(3)))
251.     b = a
252.     l = []
253.     tj = []
254.     for i in range(6):
255.         l.append(a)
256.         tj.append(b)
257.         a = a.next_lex()
258.         b = b.next_trotterjohnson()
259.     assert a == b is None
260.     assert {tuple(a) for a in l} == {tuple(a) for a in tj}
261. 
262.     p = Permutation([2, 5, 1, 6, 3, 0, 4])
263.     q = Permutation([[6], [5], [0, 1, 2, 3, 4]])
264.     assert p.rank() == 1964
265.     assert q.rank() == 870
266.     assert Permutation([]).rank_nonlex() == 0
267.     prank = p.rank_nonlex()
268.     assert prank == 1600
269.     assert Permutation.unrank_nonlex(7, 1600) == p
270.     qrank = q.rank_nonlex()
271.     assert qrank == 41
272.     assert Permutation.unrank_nonlex(7, 41) == Permutation(q.array_form)
273. 
274.     a = [Permutation.unrank_nonlex(4, i).array_form for i in range(24)]
275.     assert a == [
276.         [1, 2, 3, 0], [3, 2, 0, 1], [1, 3, 0, 2], [1, 2, 0, 3], [2, 3, 1, 0],
277.         [2, 0, 3, 1], [3, 0, 1, 2], [2, 0, 1, 3], [1, 3, 2, 0], [3, 0, 2, 1],
278.         [1, 0, 3, 2], [1, 0, 2, 3], [2, 1, 3, 0], [2, 3, 0, 1], [3, 1, 0, 2],
279.         [2, 1, 0, 3], [3, 2, 1, 0], [0, 2, 3, 1], [0, 3, 1, 2], [0, 2, 1, 3],
280.         [3, 1, 2, 0], [0, 3, 2, 1], [0, 1, 3, 2], [0, 1, 2, 3]]
281. 
282.     N = 10
283.     p1 = Permutation(a[0])
284.     for i in range(1, N+1):
285.         p1 = p1*Permutation(a[i])
286.     p2 = Permutation.rmul_with_af(*[Permutation(h) for h in a[N::-1]])
287.     assert p1 == p2
288. 
289.     ok = []
290.     p = Permutation([1, 0])
291.     for i in range(3):
292.         ok.append(p.array_form)
293.         p = p.next_nonlex()
294.         if p is None:
295.             ok.append(None)
296.             break
297.     assert ok == [[1, 0], [0, 1], None]
298.     assert Permutation([3, 2, 0, 1]).next_nonlex() == Permutation([1, 3, 0, 2])
299.     assert [Permutation(pa).rank_nonlex() for pa in a] == list(range(24))
300. 
301. 
302. def test_mul():
303.     a, b = [0, 2, 1, 3], [0, 1, 3, 2]
304.     assert _af_rmul(a, b) == [0, 2, 3, 1]
305.     assert _af_rmuln(a, b, list(range(4))) == [0, 2, 3, 1]
306.     assert rmul(Permutation(a), Permutation(b)).array_form == [0, 2, 3, 1]
307. 
308.     a = Permutation([0, 2, 1, 3])
309.     b = (0, 1, 3, 2)
310.     c = (3, 1, 2, 0)
311.     assert Permutation.rmul(a, b, c) == Permutation([1, 2, 3, 0])
312.     assert Permutation.rmul(a, c) == Permutation([3, 2, 1, 0])
313.     raises(TypeError, lambda: Permutation.rmul(b, c))
314. 
315.     n = 6
316.     m = 8
317.     a = [Permutation.unrank_nonlex(n, i).array_form for i in range(m)]
318.     h = list(range(n))
319.     for i in range(m):
320.         h = _af_rmul(h, a[i])
321.         h2 = _af_rmuln(*a[:i + 1])
322.         assert h == h2
323. 
324. 
325. def test_args():
326.     p = Permutation([(0, 3, 1, 2), (4, 5)])
327.     assert p._cyclic_form is None
328.     assert Permutation(p) == p
329.     assert p.cyclic_form == [[0, 3, 1, 2], [4, 5]]
330.     assert p._array_form == [3, 2, 0, 1, 5, 4]
331.     p = Permutation((0, 3, 1, 2))
332.     assert p._cyclic_form is None
333.     assert p._array_form == [0, 3, 1, 2]
334.     assert Permutation([0]) == Permutation((0, ))
335.     assert Permutation([[0], [1]]) == Permutation(((0, ), (1, ))) == \
336.         Permutation(((0, ), [1]))
337.     assert Permutation([[1, 2]]) == Permutation([0, 2, 1])
338.     assert Permutation([[1], [4, 2]]) == Permutation([0, 1, 4, 3, 2])
339.     assert Permutation([[1], [4, 2]], size=1) == Permutation([0, 1, 4, 3, 2])
340.     assert Permutation(
341.         [[1], [4, 2]], size=6) == Permutation([0, 1, 4, 3, 2, 5])
342.     assert Permutation([], size=3) == Permutation([0, 1, 2])
343.     assert Permutation(3).list(5) == [0, 1, 2, 3, 4]
344.     assert Permutation(3).list(-1) == []
345.     assert Permutation(5)(1, 2).list(-1) == [0, 2, 1]
346.     assert Permutation(5)(1, 2).list() == [0, 2, 1, 3, 4, 5]
347.     raises(ValueError, lambda: Permutation([1, 2], [0]))
348.            # enclosing brackets needed
349.     raises(ValueError, lambda: Permutation([[1, 2], 0]))
350.            # enclosing brackets needed on 0
351.     raises(ValueError, lambda: Permutation([1, 1, 0]))
352.     raises(ValueError, lambda: Permutation([[1], [1, 2]]))
353.     raises(ValueError, lambda: Permutation([4, 5], size=10))  # where are 0-3?
354.     # but this is ok because cycles imply that only those listed moved
355.     assert Permutation(4, 5) == Permutation([0, 1, 2, 3, 5, 4])
356. 
357. 
358. def test_Cycle():
359.     assert str(Cycle()) == '()'
360.     assert Cycle(Cycle(1,2)) == Cycle(1, 2)
361.     assert Cycle(1,2).copy() == Cycle(1,2)
362.     assert list(Cycle(1, 3, 2)) == [0, 3, 1, 2]
363.     assert Cycle(1, 2)(2, 3) == Cycle(1, 3, 2)
364.     assert Cycle(1, 2)(2, 3)(4, 5) == Cycle(1, 3, 2)(4, 5)
365.     assert Permutation(Cycle(1, 2)(2, 1, 0, 3)).cyclic_form, Cycle(0, 2, 1)
366.     raises(ValueError, lambda: Cycle().list())
367.     assert Cycle(1, 2).list() == [0, 2, 1]
368.     assert Cycle(1, 2).list(4) == [0, 2, 1, 3]
369.     assert Cycle(3).list(2) == [0, 1]
370.     assert Cycle(3).list(6) == [0, 1, 2, 3, 4, 5]
371.     assert Permutation(Cycle(1, 2), size=4) == \
372.         Permutation([0, 2, 1, 3])
373.     assert str(Cycle(1, 2)(4, 5)) == '(1 2)(4 5)'
374.     assert str(Cycle(1, 2)) == '(1 2)'
375.     assert Cycle(Permutation(list(range(3)))) == Cycle()
376.     assert Cycle(1, 2).list() == [0, 2, 1]
377.     assert Cycle(1, 2).list(4) == [0, 2, 1, 3]
378.     assert Cycle().size == 0
379.     raises(ValueError, lambda: Cycle((1, 2)))
380.     raises(ValueError, lambda: Cycle(1, 2, 1))
381.     raises(TypeError, lambda: Cycle(1, 2)*{})
382.     raises(ValueError, lambda: Cycle(4)[a])
383.     raises(ValueError, lambda: Cycle(2, -4, 3))
384. 
385.     # check round-trip
386.     p = Permutation([[1, 2], [4, 3]], size=5)
387.     assert Permutation(Cycle(p)) == p
388. 
389. 
390. def test_from_sequence():
391.     assert Permutation.from_sequence('SymPy') == Permutation(4)(0, 1, 3)
392.     assert Permutation.from_sequence('SymPy', key=lambda x: x.lower()) == \
393.         Permutation(4)(0, 2)(1, 3)
394. 
395. 
396. def test_printing_cyclic():
397.     Permutation.print_cyclic = True
398.     p1 = Permutation([0, 2, 1])
399.     assert repr(p1) == 'Permutation(1, 2)'
400.     assert str(p1) == '(1 2)'
401.     p2 = Permutation()
402.     assert repr(p2) == 'Permutation()'
403.     assert str(p2) == '()'
404.     p3 = Permutation([1, 2, 0, 3])
405.     assert repr(p3) == 'Permutation(3)(0, 1, 2)'
406. 
407. 
408. def test_printing_non_cyclic():
409.     Permutation.print_cyclic = False
410.     p1 = Permutation([0, 1, 2, 3, 4, 5])
411.     assert repr(p1) == 'Permutation([], size=6)'
412.     assert str(p1) == 'Permutation([], size=6)'
413.     p2 = Permutation([0, 1, 2])
414.     assert repr(p2) == 'Permutation([0, 1, 2])'
415.     assert str(p2) == 'Permutation([0, 1, 2])'
416. 
417.     p3 = Permutation([0, 2, 1])
418.     assert repr(p3) == 'Permutation([0, 2, 1])'
419.     assert str(p3) == 'Permutation([0, 2, 1])'
420.     p4 = Permutation([0, 1, 3, 2, 4, 5, 6, 7])
421.     assert repr(p4) == 'Permutation([0, 1, 3, 2], size=8)'

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 13:47:33,052 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the 'full content of the file `sympy/combinatorics/tests/test_permutations.py`'.\n\n2. Extended relevance:\n   - The provided context contains the entire content of the requested file, from line 1 to 421. This directly and completely fulfills the user's request. The user's purpose is to inspect the test cases for the Permutation class, and this file contains all of them, including tests for the constructor, cycle notation, and error handling which are mentioned in the purpose.", relative_path='sympy/combinatorics/tests/test_permutations.py', start_line=1, end_line=421)]
2025-12-21 13:47:33,054 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `sympy/combinatorics/tests/test_permutations.py`.
2025-12-21 13:47:33,054 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 13:47:33,054 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 13:47:33,054 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 13:47:33,054 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 13:47:33,055 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── python-comparisons.rst
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── release
|   ├── README.md
|   └── fabfile.py
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── ffunctions.py
    |   └── tests
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       └── test_ffunctions.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_eval_power.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   ├── test_var.py
    |   |   └── test_wester.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   ├── sympy_tokenize.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   └── natural.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── unitsystems.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   └── test_theanocode.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       └── test_mutable_ndim_array.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_index_methods.py
    |       ├── test_indexed.py
    |       └── test_tensor.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   └── test_timeutils.py
    |   └── timeutils.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: `Permutation` constructor fails with non-disjoint cycles

Description: Calling `Permutation([[0,1],[0,1]])` raises a `ValueError` instead of constructing the identity permutation.  If the cycles passed in are non-disjoint, they should be applied in left-to-right order and the resulting permutation should be returned.

This should be easy to compute.  I don't see a reason why non-disjoint cycles should be forbidden.

Patch information:
diff --git a/sympy/combinatorics/permutations.py b/sympy/combinatorics/permutations.py
index 136ed5a478..27f6311f4d 100644
--- a/sympy/combinatorics/permutations.py
+++ b/sympy/combinatorics/permutations.py
@@ -800,9 +800,12 @@ class Permutation(Basic):
 
     def __new__(cls, *args, **kwargs):
         """
-        Constructor for the Permutation object from a list or a
-        list of lists in which all elements of the permutation may
-        appear only once.
+        Constructor for the Permutation object from a list or from a
+        list of lists (cycles). When given cycles, overlapping elements
+        are allowed and cycles are composed from left to right to form
+        the resulting permutation. However, an element that appears as a
+        singleton (a 1-element cycle) must not appear in any other cycle
+        in the input.
 
         Examples
         ========
@@ -894,14 +897,20 @@ def __new__(cls, *args, **kwargs):
         # for convenience in case one wants to enter permutations where
         # counting starts from 1.
 
-        temp = flatten(args)
-        if has_dups(temp):
-            if is_cycle:
-                raise ValueError('there were repeated elements; to resolve '
-                'cycles use Cycle%s.' % ''.join([str(tuple(c)) for c in args]))
-            else:
+        ftemp = flatten(args)
+        if not is_cycle:
+            if has_dups(ftemp):
                 raise ValueError('there were repeated elements.')
-        temp = set(temp)
+        else:
+            singles = [c[0] for c in args if len(c) == 1]
+            if singles:
+                counts = {}
+                for x in ftemp:
+                    counts[x] = counts.get(x, 0) + 1
+                for s in set(singles):
+                    if counts.get(s, 0) > 1:
+                        raise ValueError('a singleton element must not appear in any other cycle.')
+        temp = set(ftemp)
 
         if not is_cycle and \
                 any(i not in temp for i in range(len(temp))):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `sympy/combinatorics/tests/test_permutations.py`.
Extra Requirements: 
Purpose: I need to inspect the test file for the Permutation class to find test cases that are relevant to its constructor, especially those dealing with cycle notation and error handling.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/combinatorics/tests/test_permutations.py
Line number range: 1 - 421
Content:
1. from itertools import permutations
2. 
3. from sympy.core.compatibility import range
4. from sympy.core.symbol import Symbol
5. from sympy.combinatorics.permutations import (Permutation, _af_parity,
6.     _af_rmul, _af_rmuln, Cycle)
7. from sympy.utilities.pytest import raises
8. 
9. rmul = Permutation.rmul
10. a = Symbol('a', integer=True)
11. 
12. 
13. def test_Permutation():
14.     # don't auto fill 0
15.     raises(ValueError, lambda: Permutation([1]))
16.     p = Permutation([0, 1, 2, 3])
17.     # call as bijective
18.     assert [p(i) for i in range(p.size)] == list(p)
19.     # call as operator
20.     assert p(list(range(p.size))) == list(p)
21.     # call as function
22.     assert list(p(1, 2)) == [0, 2, 1, 3]
23.     # conversion to list
24.     assert list(p) == list(range(4))
25.     assert Permutation(size=4) == Permutation(3)
26.     assert Permutation(Permutation(3), size=5) == Permutation(4)
27.     # cycle form with size
28.     assert Permutation([[1, 2]], size=4) == Permutation([[1, 2], [0], [3]])
29.     # random generation
30.     assert Permutation.random(2) in (Permutation([1, 0]), Permutation([0, 1]))
31. 
32.     p = Permutation([2, 5, 1, 6, 3, 0, 4])
33.     q = Permutation([[1], [0, 3, 5, 6, 2, 4]])
34.     assert len({p, p}) == 1
35.     r = Permutation([1, 3, 2, 0, 4, 6, 5])
36.     ans = Permutation(_af_rmuln(*[w.array_form for w in (p, q, r)])).array_form
37.     assert rmul(p, q, r).array_form == ans
38.     # make sure no other permutation of p, q, r could have given
39.     # that answer
40.     for a, b, c in permutations((p, q, r)):
41.         if (a, b, c) == (p, q, r):
42.             continue
43.         assert rmul(a, b, c).array_form != ans
44. 
45.     assert p.support() == list(range(7))
46.     assert q.support() == [0, 2, 3, 4, 5, 6]
47.     assert Permutation(p.cyclic_form).array_form == p.array_form
48.     assert p.cardinality == 5040
49.     assert q.cardinality == 5040
50.     assert q.cycles == 2
51.     assert rmul(q, p) == Permutation([4, 6, 1, 2, 5, 3, 0])
52.     assert rmul(p, q) == Permutation([6, 5, 3, 0, 2, 4, 1])
53.     assert _af_rmul(p.array_form, q.array_form) == \
54.         [6, 5, 3, 0, 2, 4, 1]
55. 
56.     assert rmul(Permutation([[1, 2, 3], [0, 4]]),
57.                 Permutation([[1, 2, 4], [0], [3]])).cyclic_form == \
58.         [[0, 4, 2], [1, 3]]
59.     assert q.array_form == [3, 1, 4, 5, 0, 6, 2]
60.     assert q.cyclic_form == [[0, 3, 5, 6, 2, 4]]
61.     assert q.full_cyclic_form == [[0, 3, 5, 6, 2, 4], [1]]
62.     assert p.cyclic_form == [[0, 2, 1, 5], [3, 6, 4]]
63.     t = p.transpositions()
64.     assert t == [(0, 5), (0, 1), (0, 2), (3, 4), (3, 6)]
65.     assert Permutation.rmul(*[Permutation(Cycle(*ti)) for ti in (t)])
66.     assert Permutation([1, 0]).transpositions() == [(0, 1)]
67. 
68.     assert p**13 == p
69.     assert q**0 == Permutation(list(range(q.size)))
70.     assert q**-2 == ~q**2
71.     assert q**2 == Permutation([5, 1, 0, 6, 3, 2, 4])
72.     assert q**3 == q**2*q
73.     assert q**4 == q**2*q**2
74. 
75.     a = Permutation(1, 3)
76.     b = Permutation(2, 0, 3)
77.     I = Permutation(3)
78.     assert ~a == a**-1
79.     assert a*~a == I
80.     assert a*b**-1 == a*~b
81. 
82.     ans = Permutation(0, 5, 3, 1, 6)(2, 4)
83.     assert (p + q.rank()).rank() == ans.rank()
84.     assert (p + q.rank())._rank == ans.rank()
85.     assert (q + p.rank()).rank() == ans.rank()
86.     raises(TypeError, lambda: p + Permutation(list(range(10))))
87. 
88.     assert (p - q.rank()).rank() == Permutation(0, 6, 3, 1, 2, 5, 4).rank()
89.     assert p.rank() - q.rank() < 0  # for coverage: make sure mod is used
90.     assert (q - p.rank()).rank() == Permutation(1, 4, 6, 2)(3, 5).rank()
91. 
92.     assert p*q == Permutation(_af_rmuln(*[list(w) for w in (q, p)]))
93.     assert p*Permutation([]) == p
94.     assert Permutation([])*p == p
95.     assert p*Permutation([[0, 1]]) == Permutation([2, 5, 0, 6, 3, 1, 4])
96.     assert Permutation([[0, 1]])*p == Permutation([5, 2, 1, 6, 3, 0, 4])
97. 
98.     pq = p ^ q
99.     assert pq == Permutation([5, 6, 0, 4, 1, 2, 3])
100.     assert pq == rmul(q, p, ~q)
101.     qp = q ^ p
102.     assert qp == Permutation([4, 3, 6, 2, 1, 5, 0])
103.     assert qp == rmul(p, q, ~p)
104.     raises(ValueError, lambda: p ^ Permutation([]))
105. 
106.     assert p.commutator(q) == Permutation(0, 1, 3, 4, 6, 5, 2)
107.     assert q.commutator(p) == Permutation(0, 2, 5, 6, 4, 3, 1)
108.     assert p.commutator(q) == ~q.commutator(p)
109.     raises(ValueError, lambda: p.commutator(Permutation([])))
110. 
111.     assert len(p.atoms()) == 7
112.     assert q.atoms() == {0, 1, 2, 3, 4, 5, 6}
113. 
114.     assert p.inversion_vector() == [2, 4, 1, 3, 1, 0]
115.     assert q.inversion_vector() == [3, 1, 2, 2, 0, 1]
116. 
117.     assert Permutation.from_inversion_vector(p.inversion_vector()) == p
118.     assert Permutation.from_inversion_vector(q.inversion_vector()).array_form\
119.         == q.array_form
120.     raises(ValueError, lambda: Permutation.from_inversion_vector([0, 2]))
121.     assert Permutation([i for i in range(500, -1, -1)]).inversions() == 125250
122. 
123.     s = Permutation([0, 4, 1, 3, 2])
124.     assert s.parity() == 0
125.     _ = s.cyclic_form  # needed to create a value for _cyclic_form
126.     assert len(s._cyclic_form) != s.size and s.parity() == 0
127.     assert not s.is_odd
128.     assert s.is_even
129.     assert Permutation([0, 1, 4, 3, 2]).parity() == 1
130.     assert _af_parity([0, 4, 1, 3, 2]) == 0
131.     assert _af_parity([0, 1, 4, 3, 2]) == 1
132. 
133.     s = Permutation([0])
134. 
135.     assert s.is_Singleton
136.     assert Permutation([]).is_Empty
137. 
138.     r = Permutation([3, 2, 1, 0])
139.     assert (r**2).is_Identity
140. 
141.     assert rmul(~p, p).is_Identity
142.     assert (~p)**13 == Permutation([5, 2, 0, 4, 6, 1, 3])
143.     assert ~(r**2).is_Identity
144.     assert p.max() == 6
145.     assert p.min() == 0
146. 
147.     q = Permutation([[6], [5], [0, 1, 2, 3, 4]])
148. 
149.     assert q.max() == 4
150.     assert q.min() == 0
151. 
152.     p = Permutation([1, 5, 2, 0, 3, 6, 4])
153.     q = Permutation([[1, 2, 3, 5, 6], [0, 4]])
154. 
155.     assert p.ascents() == [0, 3, 4]
156.     assert q.ascents() == [1, 2, 4]
157.     assert r.ascents() == []
158. 
159.     assert p.descents() == [1, 2, 5]
160.     assert q.descents() == [0, 3, 5]
161.     assert Permutation(r.descents()).is_Identity
162. 
163.     assert p.inversions() == 7
164.     # test the merge-sort with a longer permutation
165.     big = list(p) + list(range(p.max() + 1, p.max() + 130))
166.     assert Permutation(big).inversions() == 7
167.     assert p.signature() == -1
168.     assert q.inversions() == 11
169.     assert q.signature() == -1
170.     assert rmul(p, ~p).inversions() == 0
171.     assert rmul(p, ~p).signature() == 1
172. 
173.     assert p.order() == 6
174.     assert q.order() == 10
175.     assert (p**(p.order())).is_Identity
176. 
177.     assert p.length() == 6
178.     assert q.length() == 7
179.     assert r.length() == 4
180. 
181.     assert p.runs() == [[1, 5], [2], [0, 3, 6], [4]]
182.     assert q.runs() == [[4], [2, 3, 5], [0, 6], [1]]
183.     assert r.runs() == [[3], [2], [1], [0]]
184. 
185.     assert p.index() == 8
186.     assert q.index() == 8
187.     assert r.index() == 3
188. 
189.     assert p.get_precedence_distance(q) == q.get_precedence_distance(p)
190.     assert p.get_adjacency_distance(q) == p.get_adjacency_distance(q)
191.     assert p.get_positional_distance(q) == p.get_positional_distance(q)
192.     p = Permutation([0, 1, 2, 3])
193.     q = Permutation([3, 2, 1, 0])
194.     assert p.get_precedence_distance(q) == 6
195.     assert p.get_adjacency_distance(q) == 3
196.     assert p.get_positional_distance(q) == 8
197.     p = Permutation([0, 3, 1, 2, 4])
198.     q = Permutation.josephus(4, 5, 2)
199.     assert p.get_adjacency_distance(q) == 3
200.     raises(ValueError, lambda: p.get_adjacency_distance(Permutation([])))
201.     raises(ValueError, lambda: p.get_positional_distance(Permutation([])))
202.     raises(ValueError, lambda: p.get_precedence_distance(Permutation([])))
203. 
204.     a = [Permutation.unrank_nonlex(4, i) for i in range(5)]
205.     iden = Permutation([0, 1, 2, 3])
206.     for i in range(5):
207.         for j in range(i + 1, 5):
208.             assert a[i].commutes_with(a[j]) == \
209.                 (rmul(a[i], a[j]) == rmul(a[j], a[i]))
210.             if a[i].commutes_with(a[j]):
211.                 assert a[i].commutator(a[j]) == iden
212.                 assert a[j].commutator(a[i]) == iden
213. 
214.     a = Permutation(3)
215.     b = Permutation(0, 6, 3)(1, 2)
216.     assert a.cycle_structure == {1: 4}
217.     assert b.cycle_structure == {2: 1, 3: 1, 1: 2}
218. 
219. 
220. def test_josephus():
221.     assert Permutation.josephus(4, 6, 1) == Permutation([3, 1, 0, 2, 5, 4])
222.     assert Permutation.josephus(1, 5, 1).is_Identity
223. 
224. 
225. def test_ranking():
226.     assert Permutation.unrank_lex(5, 10).rank() == 10
227.     p = Permutation.unrank_lex(15, 225)
228.     assert p.rank() == 225
229.     p1 = p.next_lex()
230.     assert p1.rank() == 226
231.     assert Permutation.unrank_lex(15, 225).rank() == 225
232.     assert Permutation.unrank_lex(10, 0).is_Identity
233.     p = Permutation.unrank_lex(4, 23)
234.     assert p.rank() == 23
235.     assert p.array_form == [3, 2, 1, 0]
236.     assert p.next_lex() is None
237. 
238.     p = Permutation([1, 5, 2, 0, 3, 6, 4])
239.     q = Permutation([[1, 2, 3, 5, 6], [0, 4]])
240.     a = [Permutation.unrank_trotterjohnson(4, i).array_form for i in range(5)]
241.     assert a == [[0, 1, 2, 3], [0, 1, 3, 2], [0, 3, 1, 2], [3, 0, 1,
242.         2], [3, 0, 2, 1] ]
243.     assert [Permutation(pa).rank_trotterjohnson() for pa in a] == list(range(5))
244.     assert Permutation([0, 1, 2, 3]).next_trotterjohnson() == \
245.         Permutation([0, 1, 3, 2])
246. 
247.     assert q.rank_trotterjohnson() == 2283
248.     assert p.rank_trotterjohnson() == 3389
249.     assert Permutation([1, 0]).rank_trotterjohnson() == 1
250.     a = Permutation(list(range(3)))
251.     b = a
252.     l = []
253.     tj = []
254.     for i in range(6):
255.         l.append(a)
256.         tj.append(b)
257.         a = a.next_lex()
258.         b = b.next_trotterjohnson()
259.     assert a == b is None
260.     assert {tuple(a) for a in l} == {tuple(a) for a in tj}
261. 
262.     p = Permutation([2, 5, 1, 6, 3, 0, 4])
263.     q = Permutation([[6], [5], [0, 1, 2, 3, 4]])
264.     assert p.rank() == 1964
265.     assert q.rank() == 870
266.     assert Permutation([]).rank_nonlex() == 0
267.     prank = p.rank_nonlex()
268.     assert prank == 1600
269.     assert Permutation.unrank_nonlex(7, 1600) == p
270.     qrank = q.rank_nonlex()
271.     assert qrank == 41
272.     assert Permutation.unrank_nonlex(7, 41) == Permutation(q.array_form)
273. 
274.     a = [Permutation.unrank_nonlex(4, i).array_form for i in range(24)]
275.     assert a == [
276.         [1, 2, 3, 0], [3, 2, 0, 1], [1, 3, 0, 2], [1, 2, 0, 3], [2, 3, 1, 0],
277.         [2, 0, 3, 1], [3, 0, 1, 2], [2, 0, 1, 3], [1, 3, 2, 0], [3, 0, 2, 1],
278.         [1, 0, 3, 2], [1, 0, 2, 3], [2, 1, 3, 0], [2, 3, 0, 1], [3, 1, 0, 2],
279.         [2, 1, 0, 3], [3, 2, 1, 0], [0, 2, 3, 1], [0, 3, 1, 2], [0, 2, 1, 3],
280.         [3, 1, 2, 0], [0, 3, 2, 1], [0, 1, 3, 2], [0, 1, 2, 3]]
281. 
282.     N = 10
283.     p1 = Permutation(a[0])
284.     for i in range(1, N+1):
285.         p1 = p1*Permutation(a[i])
286.     p2 = Permutation.rmul_with_af(*[Permutation(h) for h in a[N::-1]])
287.     assert p1 == p2
288. 
289.     ok = []
290.     p = Permutation([1, 0])
291.     for i in range(3):
292.         ok.append(p.array_form)
293.         p = p.next_nonlex()
294.         if p is None:
295.             ok.append(None)
296.             break
297.     assert ok == [[1, 0], [0, 1], None]
298.     assert Permutation([3, 2, 0, 1]).next_nonlex() == Permutation([1, 3, 0, 2])
299.     assert [Permutation(pa).rank_nonlex() for pa in a] == list(range(24))
300. 
301. 
302. def test_mul():
303.     a, b = [0, 2, 1, 3], [0, 1, 3, 2]
304.     assert _af_rmul(a, b) == [0, 2, 3, 1]
305.     assert _af_rmuln(a, b, list(range(4))) == [0, 2, 3, 1]
306.     assert rmul(Permutation(a), Permutation(b)).array_form == [0, 2, 3, 1]
307. 
308.     a = Permutation([0, 2, 1, 3])
309.     b = (0, 1, 3, 2)
310.     c = (3, 1, 2, 0)
311.     assert Permutation.rmul(a, b, c) == Permutation([1, 2, 3, 0])
312.     assert Permutation.rmul(a, c) == Permutation([3, 2, 1, 0])
313.     raises(TypeError, lambda: Permutation.rmul(b, c))
314. 
315.     n = 6
316.     m = 8
317.     a = [Permutation.unrank_nonlex(n, i).array_form for i in range(m)]
318.     h = list(range(n))
319.     for i in range(m):
320.         h = _af_rmul(h, a[i])
321.         h2 = _af_rmuln(*a[:i + 1])
322.         assert h == h2
323. 
324. 
325. def test_args():
326.     p = Permutation([(0, 3, 1, 2), (4, 5)])
327.     assert p._cyclic_form is None
328.     assert Permutation(p) == p
329.     assert p.cyclic_form == [[0, 3, 1, 2], [4, 5]]
330.     assert p._array_form == [3, 2, 0, 1, 5, 4]
331.     p = Permutation((0, 3, 1, 2))
332.     assert p._cyclic_form is None
333.     assert p._array_form == [0, 3, 1, 2]
334.     assert Permutation([0]) == Permutation((0, ))
335.     assert Permutation([[0], [1]]) == Permutation(((0, ), (1, ))) == \
336.         Permutation(((0, ), [1]))
337.     assert Permutation([[1, 2]]) == Permutation([0, 2, 1])
338.     assert Permutation([[1], [4, 2]]) == Permutation([0, 1, 4, 3, 2])
339.     assert Permutation([[1], [4, 2]], size=1) == Permutation([0, 1, 4, 3, 2])
340.     assert Permutation(
341.         [[1], [4, 2]], size=6) == Permutation([0, 1, 4, 3, 2, 5])
342.     assert Permutation([], size=3) == Permutation([0, 1, 2])
343.     assert Permutation(3).list(5) == [0, 1, 2, 3, 4]
344.     assert Permutation(3).list(-1) == []
345.     assert Permutation(5)(1, 2).list(-1) == [0, 2, 1]
346.     assert Permutation(5)(1, 2).list() == [0, 2, 1, 3, 4, 5]
347.     raises(ValueError, lambda: Permutation([1, 2], [0]))
348.            # enclosing brackets needed
349.     raises(ValueError, lambda: Permutation([[1, 2], 0]))
350.            # enclosing brackets needed on 0
351.     raises(ValueError, lambda: Permutation([1, 1, 0]))
352.     raises(ValueError, lambda: Permutation([[1], [1, 2]]))
353.     raises(ValueError, lambda: Permutation([4, 5], size=10))  # where are 0-3?
354.     # but this is ok because cycles imply that only those listed moved
355.     assert Permutation(4, 5) == Permutation([0, 1, 2, 3, 5, 4])
356. 
357. 
358. def test_Cycle():
359.     assert str(Cycle()) == '()'
360.     assert Cycle(Cycle(1,2)) == Cycle(1, 2)
361.     assert Cycle(1,2).copy() == Cycle(1,2)
362.     assert list(Cycle(1, 3, 2)) == [0, 3, 1, 2]
363.     assert Cycle(1, 2)(2, 3) == Cycle(1, 3, 2)
364.     assert Cycle(1, 2)(2, 3)(4, 5) == Cycle(1, 3, 2)(4, 5)
365.     assert Permutation(Cycle(1, 2)(2, 1, 0, 3)).cyclic_form, Cycle(0, 2, 1)
366.     raises(ValueError, lambda: Cycle().list())
367.     assert Cycle(1, 2).list() == [0, 2, 1]
368.     assert Cycle(1, 2).list(4) == [0, 2, 1, 3]
369.     assert Cycle(3).list(2) == [0, 1]
370.     assert Cycle(3).list(6) == [0, 1, 2, 3, 4, 5]
371.     assert Permutation(Cycle(1, 2), size=4) == \
372.         Permutation([0, 2, 1, 3])
373.     assert str(Cycle(1, 2)(4, 5)) == '(1 2)(4 5)'
374.     assert str(Cycle(1, 2)) == '(1 2)'
375.     assert Cycle(Permutation(list(range(3)))) == Cycle()
376.     assert Cycle(1, 2).list() == [0, 2, 1]
377.     assert Cycle(1, 2).list(4) == [0, 2, 1, 3]
378.     assert Cycle().size == 0
379.     raises(ValueError, lambda: Cycle((1, 2)))
380.     raises(ValueError, lambda: Cycle(1, 2, 1))
381.     raises(TypeError, lambda: Cycle(1, 2)*{})
382.     raises(ValueError, lambda: Cycle(4)[a])
383.     raises(ValueError, lambda: Cycle(2, -4, 3))
384. 
385.     # check round-trip
386.     p = Permutation([[1, 2], [4, 3]], size=5)
387.     assert Permutation(Cycle(p)) == p
388. 
389. 
390. def test_from_sequence():
391.     assert Permutation.from_sequence('SymPy') == Permutation(4)(0, 1, 3)
392.     assert Permutation.from_sequence('SymPy', key=lambda x: x.lower()) == \
393.         Permutation(4)(0, 2)(1, 3)
394. 
395. 
396. def test_printing_cyclic():
397.     Permutation.print_cyclic = True
398.     p1 = Permutation([0, 2, 1])
399.     assert repr(p1) == 'Permutation(1, 2)'
400.     assert str(p1) == '(1 2)'
401.     p2 = Permutation()
402.     assert repr(p2) == 'Permutation()'
403.     assert str(p2) == '()'
404.     p3 = Permutation([1, 2, 0, 3])
405.     assert repr(p3) == 'Permutation(3)(0, 1, 2)'
406. 
407. 
408. def test_printing_non_cyclic():
409.     Permutation.print_cyclic = False
410.     p1 = Permutation([0, 1, 2, 3, 4, 5])
411.     assert repr(p1) == 'Permutation([], size=6)'
412.     assert str(p1) == 'Permutation([], size=6)'
413.     p2 = Permutation([0, 1, 2])
414.     assert repr(p2) == 'Permutation([0, 1, 2])'
415.     assert str(p2) == 'Permutation([0, 1, 2])'
416. 
417.     p3 = Permutation([0, 2, 1])
418.     assert repr(p3) == 'Permutation([0, 2, 1])'
419.     assert str(p3) == 'Permutation([0, 2, 1])'
420.     p4 = Permutation([0, 1, 3, 2, 4, 5, 6, 7])
421.     assert repr(p4) == 'Permutation([0, 1, 3, 2], size=8)'

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 13:48:07,954 - thread-136476293596864.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find 3 relevant test cases for a bug fix related to the `Permutation` constructor handling non-disjoint cycles. The provided context contains the full content of `sympy/combinatorics/tests/test_permutations.py`, which is the test file for permutations. This file includes `test_args`, which directly tests the constructor with various arguments including invalid ones that are relevant to the bug. It also contains `test_mul` and `test_Cycle`, which demonstrate permutation and cycle composition, a behavior that the bug fix intends to implement in the constructor for non-disjoint cycles. Therefore, I have sufficient information to select the three most relevant test cases from the provided file.' query='' extra_requirements='' purpose=''
2025-12-21 13:48:07,955 - thread-136476293596864.prometheus_context_collector - INFO - Successfully retrieved 1 context snippets
