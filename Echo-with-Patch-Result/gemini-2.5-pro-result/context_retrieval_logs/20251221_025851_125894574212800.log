2025-12-21 02:58:51,445 - thread-125894574212800.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Issues with Latex printing output in second quantization module

Description: There are Latex rendering problems within the "secondquant" module, as it does not correctly interpret double superscripts containing the "dagger" command within Jupyter Notebook.

Let's see a minimal example

```
In [1]: import sympy as sp
        from sympy.physics.secondquant import B, Bd, Commutator
        sp.init_printing()

In [2]: a = sp.Symbol('0')

In [3]: Commutator(Bd(a)**2, B(a))
Out[3]: \displaystyle - \left[b_{0},b^\dagger_{0}^{2}\right]
```
So, it doesn't render correctly, and that's because the double superscript `"b^\dagger_{0}^{2}"`. It should be correct by adding curly brackets `"{b^\dagger_{0}}^{2}"`

Patch information:
diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py
index 64d3207d09..14634b0447 100644
--- a/sympy/printing/latex.py
+++ b/sympy/printing/latex.py
@@ -638,6 +638,9 @@ def _print_Pow(self, expr):
                 base = self.parenthesize_super(base)
             if expr.base.is_Function:
                 return self._print(expr.base, exp="%s/%s" % (p, q))
+            # If base LaTeX already contains a superscript (e.g., dagger), group it
+            if (not expr.base.is_Symbol) and ("^" in base):
+                base = "{%s}" % base
             return r"%s^{%s/%s}" % (base, p, q)
         elif expr.exp.is_Rational and expr.exp.is_negative and \
                 expr.base.is_commutative:
@@ -673,6 +676,9 @@ def _helper_print_standard_power(self, expr, template):
             and base.endswith(r'\right)')):
             # don't use parentheses around dotted derivative
             base = base[6: -7]  # remove outermost added parens
+        # If base LaTeX already contains a superscript (e.g., dagger), group it
+        if (not expr.base.is_Symbol) and ("^" in base):
+            base = "{%s}" % base
         return template % (base, exp)
 
     def _print_UnevaluatedExpr(self, expr):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 02:58:51,524 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .github
|   └── workflows
|       ├── comment-on-pr.yml
|       └── runtests.yml
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.md
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_optional_dependencies.py
|   ├── test_py2_import.py
|   ├── test_setup.py
|   ├── test_sphinx.sh
|   ├── test_submodule_imports.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── contributing
|       |   └── index.rst
|       ├── documentation-style-guide.rst
|       ├── explanation
|       |   └── index.rst
|       ├── getting_started
|       |   ├── index.rst
|       |   └── install.rst
|       ├── gotchas.rst
|       ├── guides
|       |   ├── assumptions.rst
|       |   ├── booleans.rst
|       |   └── index.rst
|       ├── how_to_guide
|       |   └── index.rst
|       ├── index.rst
|       ├── logo
|       |   └── info.txt
|       ├── miscellaneous
|       |   └── index.rst
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── index.rst
|       |   |   ├── predicates.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── sparse.rst
|       |   |   └── sparsetools.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── control
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── domainmatrix.rst
|       |   |   ├── domainsintro.rst
|       |   |   ├── domainsref.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   ├── solvers.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── fu.rst
|       |   |   ├── hyperexpand.rst
|       |   |   ├── index.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── testing
|       |   |   ├── index.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   └── runtests.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       ├── intro.rst
|       |       └── vector_integration.rst
|       ├── outreach.rst
|       ├── pics
|       ├── reference
|       |   └── index.rst
|       ├── special_topics
|       |   ├── classification.rst
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── aptinstall.sh
|   ├── authors.py
|   ├── build_docs.py
|   ├── compare_tar_against_git.py
|   ├── fabfile.py
|   ├── github_release.py
|   ├── helpers.py
|   ├── pull_and_run_rever.sh
|   ├── release.sh
|   ├── releasecheck.py
|   ├── requirements.txt
|   ├── sha256.py
|   ├── test_install.py
|   ├── update_docs.py
|   └── update_requirements.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── facts.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── predicates
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── relation
    |   |   ├── __init__.py
    |   |   ├── binrel.py
    |   |   └── equality.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_assumptions_2.py
    |   |   ├── test_context.py
    |   |   ├── test_matrices.py
    |   |   ├── test_query.py
    |   |   ├── test_refine.py
    |   |   ├── test_satask.py
    |   |   ├── test_sathandlers.py
    |   |   └── test_wrapper.py
    |   └── wrapper.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── numpy_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   ├── scipy_nodes.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_numpy_nodes.py
    |       ├── test_pyutils.py
    |       ├── test_rewriting.py
    |       └── test_scipy_nodes.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── schur_number.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_schur_number.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── _print_helpers.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── kind.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── parameters.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_kind.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_parameters.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── gmpy.py
    |   ├── importtools.py
    |   ├── pythonmpq.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_pythonmpq.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   ├── minisat22_wrapper.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── decompositions.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── determinant.py
    |   ├── eigen.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── companion.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── sets.py
    |   |   ├── slice.py
    |   |   ├── special.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_companion.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_sets.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_special.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── graph.py
    |   ├── immutable.py
    |   ├── inverse.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── reductions.py
    |   ├── repmatrix.py
    |   ├── solvers.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   ├── subspaces.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_commonmatrix.py
    |   |   ├── test_decompositions.py
    |   |   ├── test_densearith.py
    |   |   ├── test_densesolve.py
    |   |   ├── test_densetools.py
    |   |   ├── test_determinant.py
    |   |   ├── test_eigen.py
    |   |   ├── test_graph.py
    |   |   ├── test_immutable.py
    |   |   ├── test_interactions.py
    |   |   ├── test_matrices.py
    |   |   ├── test_normalforms.py
    |   |   ├── test_reductions.py
    |   |   ├── test_solvers.py
    |   |   ├── test_sparse.py
    |   |   ├── test_sparsetools.py
    |   |   └── test_subspaces.py
    |   └── utilities.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── digits.py
    |   ├── ecm.py
    |   ├── egyptian_fraction.py
    |   ├── elliptic_curve.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── qs.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_digits.py
    |       ├── test_ecm.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_elliptic_curve.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       ├── test_qs.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── README.txt
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── control
    |   |   ├── __init__.py
    |   |   ├── control_plots.py
    |   |   ├── lti.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_control_plots.py
    |   |       └── test_lti.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── joint.py
    |   |   ├── jointsmethod.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── method.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_joint.py
    |   |       ├── test_jointsmethod.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_method.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domainmatrix.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── expressionrawdomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gaussiandomains.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── matrices
    |   |   ├── __init__.py
    |   |   ├── ddm.py
    |   |   ├── dense.py
    |   |   ├── domainmatrix.py
    |   |   ├── domainscalar.py
    |   |   ├── eigen.py
    |   |   ├── exceptions.py
    |   |   ├── linsolve.py
    |   |   ├── normalforms.py
    |   |   ├── sdm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_ddm.py
    |   |       ├── test_dense.py
    |   |       ├── test_domainmatrix.py
    |   |       ├── test_domainscalar.py
    |   |       ├── test_eigen.py
    |   |       ├── test_linsolve.py
    |   |       ├── test_normalforms.py
    |   |       └── test_sdm.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── aesaracode.py
    |   ├── c.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxx.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── fortran.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── numpy.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_aesaracode.py
    |   |   ├── test_c.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cupy.py
    |   |   ├── test_cxx.py
    |   |   ├── test_dot.py
    |   |   ├── test_fortran.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── comparison.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine
    |   |   ├── __init__.py
    |   |   ├── diophantine.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_diophantine.py
    |   ├── inequalities.py
    |   ├── ode
    |   |   ├── __init__.py
    |   |   ├── hypergeometric.py
    |   |   ├── lie_group.py
    |   |   ├── nonhomogeneous.py
    |   |   ├── ode.py
    |   |   ├── riccati.py
    |   |   ├── single.py
    |   |   ├── subscheck.py
    |   |   ├── systems.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_lie_group.py
    |   |       ├── test_ode.py
    |   |       ├── test_riccati.py
    |   |       ├── test_single.py
    |   |       ├── test_subscheck.py
    |   |       └── test_systems.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── compound_rv.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── matrix_distributions.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── sampling
    |   |   ├── __init__.py
    |   |   ├── sample_numpy.py
    |   |   ├── sample_pymc3.py
    |   |   ├── sample_scipy.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_sample_continuous_rv.py
    |   |       ├── test_sample_discrete_rv.py
    |   |       └── test_sample_finite_rv.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_multivariate_probability.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_compound_rv.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_matrix_distributions.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       ├── test_symbolic_multivariate.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── array_derivatives.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── expressions
    |   |   |   ├── __init__.py
    |   |   |   ├── array_expressions.py
    |   |   |   ├── arrayexpr_derivatives.py
    |   |   |   ├── conv_array_to_matrix.py
    |   |   |   ├── conv_indexed_to_array.py
    |   |   |   ├── conv_matrix_to_array.py
    |   |   |   ├── tests
    |   |   |   └── utils.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_array_derivatives.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── testing
    |   ├── __init__.py
    |   ├── benchmarking.py
    |   ├── matrices.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_module_imports.py
    |   |   └── test_pytest.py
    |   └── tmpfiles.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_matchpy_connector.py
    |   |   ├── test_misc.py
    |   |   ├── test_pickling.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── implicitregion.py
        ├── integrals.py
        ├── operators.py
        ├── orienters.py
        ├── parametricregion.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_implicitregion.py
        |   ├── test_integrals.py
        |   ├── test_operators.py
        |   ├── test_parametricregion.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Issues with Latex printing output in second quantization module

Description: There are Latex rendering problems within the "secondquant" module, as it does not correctly interpret double superscripts containing the "dagger" command within Jupyter Notebook.

Let's see a minimal example

```
In [1]: import sympy as sp
        from sympy.physics.secondquant import B, Bd, Commutator
        sp.init_printing()

In [2]: a = sp.Symbol('0')

In [3]: Commutator(Bd(a)**2, B(a))
Out[3]: \displaystyle - \left[b_{0},b^\dagger_{0}^{2}\right]
```
So, it doesn't render correctly, and that's because the double superscript `"b^\dagger_{0}^{2}"`. It should be correct by adding curly brackets `"{b^\dagger_{0}}^{2}"`

Patch information:
diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py
index 64d3207d09..14634b0447 100644
--- a/sympy/printing/latex.py
+++ b/sympy/printing/latex.py
@@ -638,6 +638,9 @@ def _print_Pow(self, expr):
                 base = self.parenthesize_super(base)
             if expr.base.is_Function:
                 return self._print(expr.base, exp="%s/%s" % (p, q))
+            # If base LaTeX already contains a superscript (e.g., dagger), group it
+            if (not expr.base.is_Symbol) and ("^" in base):
+                base = "{%s}" % base
             return r"%s^{%s/%s}" % (base, p, q)
         elif expr.exp.is_Rational and expr.exp.is_negative and \
                 expr.base.is_commutative:
@@ -673,6 +676,9 @@ def _helper_print_standard_power(self, expr, template):
             and base.endswith(r'\right)')):
             # don't use parentheses around dotted derivative
             base = base[6: -7]  # remove outermost added parens
+        # If base LaTeX already contains a superscript (e.g., dagger), group it
+        if (not expr.base.is_Symbol) and ("^" in base):
+            base = "{%s}" % base
         return template % (base, exp)
 
     def _print_UnevaluatedExpr(self, expr):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 02:59:15,872 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a LaTeX printing issue. The patch is in `sympy/printing/latex.py`, so the most relevant tests will be in `sympy/printing/tests/test_latex.py`. I need to examine this file to find tests related to printing powers and superscripts, which is central to the bug.' query='Please provide the content of the file `sympy/printing/tests/test_latex.py`.' extra_requirements='' purpose='This file is needed to find existing test cases that test the LaTeX printing of powers (`_print_Pow`) and to see how expressions with superscripts are currently tested.'
2025-12-21 02:59:15,873 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the content of the file `sympy/printing/tests/test_latex.py`.
2025-12-21 02:59:15,873 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 02:59:15,874 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 02:59:15,876 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 02:59:15,876 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the content of the file `sympy/printing/tests/test_latex.py`.
Purpose: This file is needed to find existing test cases that test the LaTeX printing of powers (`_print_Pow`) and to see how expressions with superscripts are currently tested.
2025-12-21 02:59:18,531 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/printing/tests/test_latex.py"}'}, '__gemini_function_call_thought_signatures__': {'3ccebaaa-d2a0-446d-b6eb-067ba5f3d223': 'CtAGAY89a1/+pN7i66ylp06OKTkMFwyzrf/77PbyLB2aux2TGL76mFK2iSdY9pWU1BI7vIcxzwSL6eAEi2os8j2q9e6ebWPSB/ouQVHKAI+ks4vNU7u8lzqi21kj+L5t8JYUWHEXZajOLMNzbrxTRuQhQSDAxH2LvntOz94EMjZn7FrRStSd6sRQmMMezcgns6HczuKMwpDMtve7nHsaHEVRAIV71PBcRIG0sTNJtvVwDF0/yTaacRAkrlyCSJ3fmzfp9uMZgjWLK5LzCyyV43vkUs8Np17iS7qz74r72h12vm75u/vQoBy0T/3tZb4dmoRuyf2kn4NQrxzlYY5p5WPxixCYrdCUq0y5mfVrhSVKelR1kT7SkaOjcDAvQrz2SFCvospyeuFW2DDxE+2elUrNlfpfwFdmOHBFUhadbkNUFX74QDvVx5Dq/RLKykJcbKY6DXNzFstZwrwfj44ihIVUgTBmUBNhIZJMKQJuf20agzzupESVcpdJtpj6Uc1bMnAYX3mzo6C8GKVOiVuWMdlgoYdIDhzQDFpX58j7J7cxPZyAKmb4FS0vMqPN5FTgzxmsBQy5idluCzNeJEqii+NTr57sCZZxD3+N5+HOAuiqFxBc7Rt0Ap4sAQFgiDH/5DsTvvR0dybjo74PXVNPm2WB9tNDh8nJPap414140Cb/xe48PEGzlzllSoPPkFI+XSugJbaVQweX7zBULY0EsWNMylbmlr4cnzHmR1XeMKM3J7xhvSGAHmI41qSj+jx4f7xAnFCC8chTgOU+tJO20dOC0STV0uOt5jP1BKEqFZ0poegRVhj+xSyiU3qnzHKhAaGnP1ngs/34IAYwSy/P2t95BJrzTc2jWkBRL3tKZO2IxRHOL3ATL3tOD1iO2BooFGAENo7PmjWJRIZR1iERupmxQArYKP28TLlumzFO1OX+gNrEXY7H7Ag6sqx850o0bElKbaTi3HBHWyUGihbLpDM9skDao0iFg02UZSCABR+36KxI72jtPTLVVAXVrEict3Y9E6UaksuVdYKg6wUaaCBI93+mprRpIjxptC5FMfxbTTC7LDqgx/vRKw3zWGFoylhV6DRnCDJawfzUrrNRIJoOvFUvnSUrjDdye/soNE0sPS4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2122, 'candidates_token_count': 25, 'total_token_count': 2367, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2122}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 220, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.31276771545410154, 'model_name': 'gemini-2.5-pro'} id='run--06eb315e-4a55-4d45-aab7-32ae290e544c-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/printing/tests/test_latex.py'}, 'id': '3ccebaaa-d2a0-446d-b6eb-067ba5f3d223', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2122, 'output_tokens': 25, 'total_tokens': 2367, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 220}}
2025-12-21 02:59:21,170 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the content of `sympy/printing/tests/test_latex.py`. I will now search for occurrences of `_print_Pow` within the file to identify the specific test cases that are relevant to the LaTeX printing of powers and superscripts, as you requested.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "sympy/printing/tests/test_latex.py", "text": "_print_Pow"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13839, 'candidates_token_count': 96, 'total_token_count': 14009, 'cached_content_token_count': 1846, 'prompt_tokens_details': [{'modality': 1, 'token_count': 14059}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1846}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 96}], 'thoughts_token_count': 74}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1712999939918518, 'model_name': 'gemini-2.5-pro'} id='run--74d98799-3743-400f-8ec6-d6c62c873257-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'sympy/printing/tests/test_latex.py', 'text': '_print_Pow'}, 'id': '7a3d1f2b-2b96-4c3c-a4db-e9244962a044', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13839, 'output_tokens': 96, 'total_tokens': 14009, 'input_token_details': {'cache_read': 1846}, 'output_token_details': {'reasoning': 74}}
2025-12-21 02:59:22,931 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I was unable to find any occurrences of `_print_Pow` in the file. However, I did find a number of test cases that verify the LaTeX printing of powers and superscripts. I will now read the file to get the full context of these tests.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "sympy/printing/tests/test_latex.py", "end_line": 154.0, "start_line": 80.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13967, 'candidates_token_count': 85, 'total_token_count': 14052, 'cached_content_token_count': 12910, 'prompt_tokens_details': [{'modality': 1, 'token_count': 14187}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12910}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 85}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1532007890589097, 'model_name': 'gemini-2.5-pro'} id='run--d2302fb4-f184-476d-b3b4-523ff813bec7-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'sympy/printing/tests/test_latex.py', 'end_line': 154.0, 'start_line': 80.0}, 'id': 'd806d7cf-203d-47ab-815a-1a7b7bb5cb81', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13967, 'output_tokens': 85, 'total_tokens': 14052, 'input_token_details': {'cache_read': 12910}}
2025-12-21 02:59:28,700 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the content of `sympy/printing/tests/test_latex.py` and searched for test cases related to the LaTeX printing of powers. Although I did not find any direct references to `_print_Pow`, I did find a function, `test_latex_basic`, that contains a number of relevant test cases for powers and superscripts. The code I have read provides examples of how to test the LaTeX representation of expressions with integer, symbolic, and rational powers, as well as how to control the output format.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16166, 'candidates_token_count': 109, 'total_token_count': 16722, 'cached_content_token_count': 12961, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16386}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12961}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 109}], 'thoughts_token_count': 447}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3682452210592567, 'model_name': 'gemini-2.5-pro'} id='run--a31ace44-c4ce-487f-884c-604d7a1ab024-0' usage_metadata={'input_tokens': 16166, 'output_tokens': 109, 'total_tokens': 16722, 'input_token_details': {'cache_read': 12961}, 'output_token_details': {'reasoning': 447}}
2025-12-21 02:59:28,707 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the content of the file `sympy/printing/tests/test_latex.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file is needed to find existing test cases that test the LaTeX printing of powers (`_print_Pow`) and to see how expressions with superscripts are currently tested.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/printing/tests/test_latex.py
Line number range: 1 - 500
Content:
1. from sympy.tensor.array.expressions.array_expressions import ArraySymbol, ArrayElement
2. from sympy.tensor.toperators import PartialDerivative
3. 
4. from sympy import (
5.     Abs, Chi, Ci, CosineTransform, Dict, Ei, Eq, FallingFactorial,
6.     FiniteSet, Float, FourierTransform, Function, Indexed, IndexedBase, Integral,
7.     Interval, InverseCosineTransform, InverseFourierTransform, Derivative,
8.     InverseLaplaceTransform, InverseMellinTransform, InverseSineTransform,
9.     Lambda, LaplaceTransform, Limit, Matrix, Max, MellinTransform, Min, Mul,
10.     Order, Piecewise, Poly, ring, field, ZZ, Pow, Product, Range, Rational, Integer,
11.     RisingFactorial, rootof, RootSum, S, Shi, Si, SineTransform, Subs,
12.     Sum, Symbol, ImageSet, Tuple, Ynm, Znm, arg, asin, acsc, asinh, Mod,
13.     assoc_laguerre, assoc_legendre, beta, binomial, catalan, ceiling,
14.     chebyshevt, chebyshevu, conjugate, cot, coth, diff, dirichlet_eta, euler,
15.     exp, expint, factorial, factorial2, floor, gamma, gegenbauer, hermite,
16.     hyper, im, jacobi, laguerre, legendre, lerchphi, log, frac,
17.     meijerg, oo, polar_lift, polylog, re, root, sin, sqrt, symbols,
18.     uppergamma, zeta, subfactorial, totient, elliptic_k, elliptic_f,
19.     elliptic_e, elliptic_pi, cos, tan, Wild, true, false, Equivalent, Not,
20.     Contains, divisor_sigma, SeqPer, SeqFormula, MatrixSlice,
21.     SeqAdd, SeqMul, fourier_series, pi, ConditionSet, ComplexRegion, fps,
22.     AccumBounds, reduced_totient, primenu, primeomega, SingularityFunction,
23.     stieltjes, mathieuc, mathieus, mathieucprime, mathieusprime,
24.     UnevaluatedExpr, Quaternion, I, KroneckerProduct, LambertW)
25. 
26. from sympy.ntheory.factor_ import udivisor_sigma
27. 
28. from sympy.abc import mu, tau
29. from sympy.printing.latex import (latex, translate, greek_letters_set,
30.                                   tex_greek_dictionary, multiline_latex,
31.                                   latex_escape, LatexPrinter)
32. from sympy.tensor.array import (ImmutableDenseNDimArray,
33.                                 ImmutableSparseNDimArray,
34.                                 MutableSparseNDimArray,
35.                                 MutableDenseNDimArray,
36.                                 tensorproduct)
37. from sympy.testing.pytest import XFAIL, raises, _both_exp_pow
38. from sympy.functions import DiracDelta, Heaviside, KroneckerDelta, LeviCivita
39. from sympy.functions.combinatorial.numbers import bernoulli, bell, lucas, \
40.     fibonacci, tribonacci
41. from sympy.logic import Implies
42. from sympy.logic.boolalg import And, Or, Xor
43. from sympy.physics.control.lti import TransferFunction, Series, Parallel, \
44.     Feedback, TransferFunctionMatrix, MIMOSeries, MIMOParallel, MIMOFeedback
45. from sympy.physics.quantum import Commutator, Operator
46. from sympy.physics.units import meter, gibibyte, microgram, second
47. from sympy.core.trace import Tr
48. from sympy.combinatorics.permutations import \
49.     Cycle, Permutation, AppliedPermutation
50. from sympy.matrices.expressions.permutation import PermutationMatrix
51. from sympy import MatrixSymbol, ln
52. from sympy.vector import CoordSys3D, Cross, Curl, Dot, Divergence, Gradient, Laplacian
53. from sympy.sets.setexpr import SetExpr
54. from sympy.sets.sets import \
55.     Union, Intersection, Complement, SymmetricDifference, ProductSet
56. 
57. import sympy as sym
58. 
59. 
60. class lowergamma(sym.lowergamma):
61.     pass   # testing notation inheritance by a subclass with same name
62. 
63. 
64. x, y, z, t, w, a, b, c, s, p = symbols('x y z t w a b c s p')
65. k, m, n = symbols('k m n', integer=True)
66. 
67. 
68. def test_printmethod():
69.     class R(Abs):
70.         def _latex(self, printer):
71.             return "foo(%s)" % printer._print(self.args[0])
72.     assert latex(R(x)) == r"foo(x)"
73. 
74.     class R(Abs):
75.         def _latex(self, printer):
76.             return "foo"
77.     assert latex(R(x)) == r"foo"
78. 
79. 
80. def test_latex_basic():
81.     assert latex(1 + x) == r"x + 1"
82.     assert latex(x**2) == r"x^{2}"
83.     assert latex(x**(1 + x)) == r"x^{x + 1}"
84.     assert latex(x**3 + x + 1 + x**2) == r"x^{3} + x^{2} + x + 1"
85. 
86.     assert latex(2*x*y) == r"2 x y"
87.     assert latex(2*x*y, mul_symbol='dot') == r"2 \cdot x \cdot y"
88.     assert latex(3*x**2*y, mul_symbol='\\,') == r"3\,x^{2}\,y"
89.     assert latex(1.5*3**x, mul_symbol='\\,') == r"1.5 \cdot 3^{x}"
90. 
91.     assert latex(Mul(0, 1, evaluate=False)) == r'0 \cdot 1'
92.     assert latex(Mul(1, 0, evaluate=False)) == r'1 \cdot 0'
93.     assert latex(Mul(1, 1, evaluate=False)) == r'1 \cdot 1'
94.     assert latex(Mul(-1, 1, evaluate=False)) == r'\left(-1\right) 1'
95.     assert latex(Mul(1, 1, 1, evaluate=False)) == r'1 \cdot 1 \cdot 1'
96.     assert latex(Mul(1, 2, evaluate=False)) == r'1 \cdot 2'
97.     assert latex(Mul(1, S.Half, evaluate=False)) == r'1 \frac{1}{2}'
98.     assert latex(Mul(1, 1, S.Half, evaluate=False)) == \
99.         r'1 \cdot 1 \frac{1}{2}'
100.     assert latex(Mul(1, 1, 2, 3, x, evaluate=False)) == \
101.         r'1 \cdot 1 \cdot 2 \cdot 3 x'
102.     assert latex(Mul(1, -1, evaluate=False)) == r'1 \left(-1\right)'
103.     assert latex(Mul(4, 3, 2, 1, 0, y, x, evaluate=False)) == \
104.         r'4 \cdot 3 \cdot 2 \cdot 1 \cdot 0 y x'
105.     assert latex(Mul(4, 3, 2, 1+z, 0, y, x, evaluate=False)) == \
106.         r'4 \cdot 3 \cdot 2 \left(z + 1\right) 0 y x'
107.     assert latex(Mul(Rational(2, 3), Rational(5, 7), evaluate=False)) == \
108.         r'\frac{2}{3} \frac{5}{7}'
109. 
110.     assert latex(1/x) == r"\frac{1}{x}"
111.     assert latex(1/x, fold_short_frac=True) == r"1 / x"
112.     assert latex(-S(3)/2) == r"- \frac{3}{2}"
113.     assert latex(-S(3)/2, fold_short_frac=True) == r"- 3 / 2"
114.     assert latex(1/x**2) == r"\frac{1}{x^{2}}"
115.     assert latex(1/(x + y)/2) == r"\frac{1}{2 \left(x + y\right)}"
116.     assert latex(x/2) == r"\frac{x}{2}"
117.     assert latex(x/2, fold_short_frac=True) == r"x / 2"
118.     assert latex((x + y)/(2*x)) == r"\frac{x + y}{2 x}"
119.     assert latex((x + y)/(2*x), fold_short_frac=True) == \
120.         r"\left(x + y\right) / 2 x"
121.     assert latex((x + y)/(2*x), long_frac_ratio=0) == \
122.         r"\frac{1}{2 x} \left(x + y\right)"
123.     assert latex((x + y)/x) == r"\frac{x + y}{x}"
124.     assert latex((x + y)/x, long_frac_ratio=3) == r"\frac{x + y}{x}"
125.     assert latex((2*sqrt(2)*x)/3) == r"\frac{2 \sqrt{2} x}{3}"
126.     assert latex((2*sqrt(2)*x)/3, long_frac_ratio=2) == \
127.         r"\frac{2 x}{3} \sqrt{2}"
128.     assert latex(binomial(x, y)) == r"{\binom{x}{y}}"
129. 
130.     x_star = Symbol('x^*')
131.     f = Function('f')
132.     assert latex(x_star**2) == r"\left(x^{*}\right)^{2}"
133.     assert latex(x_star**2, parenthesize_super=False) == r"{x^{*}}^{2}"
134.     assert latex(Derivative(f(x_star), x_star,2)) == r"\frac{d^{2}}{d \left(x^{*}\right)^{2}} f{\left(x^{*} \right)}"
135.     assert latex(Derivative(f(x_star), x_star,2), parenthesize_super=False) == r"\frac{d^{2}}{d {x^{*}}^{2}} f{\left(x^{*} \right)}"
136. 
137.     assert latex(2*Integral(x, x)/3) == r"\frac{2 \int x\, dx}{3}"
138.     assert latex(2*Integral(x, x)/3, fold_short_frac=True) == \
139.         r"\left(2 \int x\, dx\right) / 3"
140. 
141.     assert latex(sqrt(x)) == r"\sqrt{x}"
142.     assert latex(x**Rational(1, 3)) == r"\sqrt[3]{x}"
143.     assert latex(x**Rational(1, 3), root_notation=False) == r"x^{\frac{1}{3}}"
144.     assert latex(sqrt(x)**3) == r"x^{\frac{3}{2}}"
145.     assert latex(sqrt(x), itex=True) == r"\sqrt{x}"
146.     assert latex(x**Rational(1, 3), itex=True) == r"\root{3}{x}"
147.     assert latex(sqrt(x)**3, itex=True) == r"x^{\frac{3}{2}}"
148.     assert latex(x**Rational(3, 4)) == r"x^{\frac{3}{4}}"
149.     assert latex(x**Rational(3, 4), fold_frac_powers=True) == r"x^{3/4}"
150.     assert latex((x + 1)**Rational(3, 4)) == \
151.         r"\left(x + 1\right)^{\frac{3}{4}}"
152.     assert latex((x + 1)**Rational(3, 4), fold_frac_powers=True) == \
153.         r"\left(x + 1\right)^{3/4}"
154. 
155.     assert latex(1.5e20*x) == r"1.5 \cdot 10^{20} x"
156.     assert latex(1.5e20*x, mul_symbol='dot') == r"1.5 \cdot 10^{20} \cdot x"
157.     assert latex(1.5e20*x, mul_symbol='times') == \
158.         r"1.5 \times 10^{20} \times x"
159. 
160.     assert latex(1/sin(x)) == r"\frac{1}{\sin{\left(x \right)}}"
161.     assert latex(sin(x)**-1) == r"\frac{1}{\sin{\left(x \right)}}"
162.     assert latex(sin(x)**Rational(3, 2)) == \
163.         r"\sin^{\frac{3}{2}}{\left(x \right)}"
164.     assert latex(sin(x)**Rational(3, 2), fold_frac_powers=True) == \
165.         r"\sin^{3/2}{\left(x \right)}"
166. 
167.     assert latex(~x) == r"\neg x"
168.     assert latex(x & y) == r"x \wedge y"
169.     assert latex(x & y & z) == r"x \wedge y \wedge z"
170.     assert latex(x | y) == r"x \vee y"
171.     assert latex(x | y | z) == r"x \vee y \vee z"
172.     assert latex((x & y) | z) == r"z \vee \left(x \wedge y\right)"
173.     assert latex(Implies(x, y)) == r"x \Rightarrow y"
174.     assert latex(~(x >> ~y)) == r"x \not\Rightarrow \neg y"
175.     assert latex(Implies(Or(x,y), z)) == r"\left(x \vee y\right) \Rightarrow z"
176.     assert latex(Implies(z, Or(x,y))) == r"z \Rightarrow \left(x \vee y\right)"
177.     assert latex(~(x & y)) == r"\neg \left(x \wedge y\right)"
178. 
179.     assert latex(~x, symbol_names={x: "x_i"}) == r"\neg x_i"
180.     assert latex(x & y, symbol_names={x: "x_i", y: "y_i"}) == \
181.         r"x_i \wedge y_i"
182.     assert latex(x & y & z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
183.         r"x_i \wedge y_i \wedge z_i"
184.     assert latex(x | y, symbol_names={x: "x_i", y: "y_i"}) == r"x_i \vee y_i"
185.     assert latex(x | y | z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
186.         r"x_i \vee y_i \vee z_i"
187.     assert latex((x & y) | z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
188.         r"z_i \vee \left(x_i \wedge y_i\right)"
189.     assert latex(Implies(x, y), symbol_names={x: "x_i", y: "y_i"}) == \
190.         r"x_i \Rightarrow y_i"
191.     assert latex(Pow(Rational(1, 3), -1, evaluate=False)) == r"\frac{1}{\frac{1}{3}}"
192.     assert latex(Pow(Rational(1, 3), -2, evaluate=False)) == r"\frac{1}{(\frac{1}{3})^{2}}"
193.     assert latex(Pow(Integer(1)/100, -1, evaluate=False)) == r"\frac{1}{\frac{1}{100}}"
194. 
195. 
196.     p = Symbol('p', positive=True)
197.     assert latex(exp(-p)*log(p)) == r"e^{- p} \log{\left(p \right)}"
198. 
199. 
200. def test_latex_builtins():
201.     assert latex(True) == r"\text{True}"
202.     assert latex(False) == r"\text{False}"
203.     assert latex(None) == r"\text{None}"
204.     assert latex(true) == r"\text{True}"
205.     assert latex(false) == r'\text{False}'
206. 
207. 
208. def test_latex_SingularityFunction():
209.     assert latex(SingularityFunction(x, 4, 5)) == \
210.         r"{\left\langle x - 4 \right\rangle}^{5}"
211.     assert latex(SingularityFunction(x, -3, 4)) == \
212.         r"{\left\langle x + 3 \right\rangle}^{4}"
213.     assert latex(SingularityFunction(x, 0, 4)) == \
214.         r"{\left\langle x \right\rangle}^{4}"
215.     assert latex(SingularityFunction(x, a, n)) == \
216.         r"{\left\langle - a + x \right\rangle}^{n}"
217.     assert latex(SingularityFunction(x, 4, -2)) == \
218.         r"{\left\langle x - 4 \right\rangle}^{-2}"
219.     assert latex(SingularityFunction(x, 4, -1)) == \
220.         r"{\left\langle x - 4 \right\rangle}^{-1}"
221. 
222.     assert latex(SingularityFunction(x, 4, 5)**3) == \
223.         r"{\left({\langle x - 4 \rangle}^{5}\right)}^{3}"
224.     assert latex(SingularityFunction(x, -3, 4)**3) == \
225.         r"{\left({\langle x + 3 \rangle}^{4}\right)}^{3}"
226.     assert latex(SingularityFunction(x, 0, 4)**3) == \
227.         r"{\left({\langle x \rangle}^{4}\right)}^{3}"
228.     assert latex(SingularityFunction(x, a, n)**3) == \
229.         r"{\left({\langle - a + x \rangle}^{n}\right)}^{3}"
230.     assert latex(SingularityFunction(x, 4, -2)**3) == \
231.         r"{\left({\langle x - 4 \rangle}^{-2}\right)}^{3}"
232.     assert latex((SingularityFunction(x, 4, -1)**3)**3) == \
233.         r"{\left({\langle x - 4 \rangle}^{-1}\right)}^{9}"
234. 
235. 
236. def test_latex_cycle():
237.     assert latex(Cycle(1, 2, 4)) == r"\left( 1\; 2\; 4\right)"
238.     assert latex(Cycle(1, 2)(4, 5, 6)) == \
239.         r"\left( 1\; 2\right)\left( 4\; 5\; 6\right)"
240.     assert latex(Cycle()) == r"\left( \right)"
241. 
242. 
243. def test_latex_permutation():
244.     assert latex(Permutation(1, 2, 4)) == r"\left( 1\; 2\; 4\right)"
245.     assert latex(Permutation(1, 2)(4, 5, 6)) == \
246.         r"\left( 1\; 2\right)\left( 4\; 5\; 6\right)"
247.     assert latex(Permutation()) == r"\left( \right)"
248.     assert latex(Permutation(2, 4)*Permutation(5)) == \
249.         r"\left( 2\; 4\right)\left( 5\right)"
250.     assert latex(Permutation(5)) == r"\left( 5\right)"
251. 
252.     assert latex(Permutation(0, 1), perm_cyclic=False) == \
253.         r"\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}"
254.     assert latex(Permutation(0, 1)(2, 3), perm_cyclic=False) == \
255.         r"\begin{pmatrix} 0 & 1 & 2 & 3 \\ 1 & 0 & 3 & 2 \end{pmatrix}"
256.     assert latex(Permutation(), perm_cyclic=False) == \
257.         r"\left( \right)"
258. 
259. 
260. def test_latex_Float():
261.     assert latex(Float(1.0e100)) == r"1.0 \cdot 10^{100}"
262.     assert latex(Float(1.0e-100)) == r"1.0 \cdot 10^{-100}"
263.     assert latex(Float(1.0e-100), mul_symbol="times") == \
264.         r"1.0 \times 10^{-100}"
265.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=2) == \
266.         r"1.0 \cdot 10^{4}"
267.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=4) == \
268.         r"1.0 \cdot 10^{4}"
269.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=5) == \
270.         r"10000.0"
271.     assert latex(Float('0.099999'), full_prec=True,  min=-2, max=5) == \
272.         r"9.99990000000000 \cdot 10^{-2}"
273. 
274. 
275. def test_latex_vector_expressions():
276.     A = CoordSys3D('A')
277. 
278.     assert latex(Cross(A.i, A.j*A.x*3+A.k)) == \
279.         r"\mathbf{\hat{i}_{A}} \times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}} + \mathbf{\hat{k}_{A}}\right)"
280.     assert latex(Cross(A.i, A.j)) == \
281.         r"\mathbf{\hat{i}_{A}} \times \mathbf{\hat{j}_{A}}"
282.     assert latex(x*Cross(A.i, A.j)) == \
283.         r"x \left(\mathbf{\hat{i}_{A}} \times \mathbf{\hat{j}_{A}}\right)"
284.     assert latex(Cross(x*A.i, A.j)) == \
285.         r'- \mathbf{\hat{j}_{A}} \times \left((x)\mathbf{\hat{i}_{A}}\right)'
286. 
287.     assert latex(Curl(3*A.x*A.j)) == \
288.         r"\nabla\times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
289.     assert latex(Curl(3*A.x*A.j+A.i)) == \
290.         r"\nabla\times \left(\mathbf{\hat{i}_{A}} + (3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
291.     assert latex(Curl(3*x*A.x*A.j)) == \
292.         r"\nabla\times \left((3 \mathbf{{x}_{A}} x)\mathbf{\hat{j}_{A}}\right)"
293.     assert latex(x*Curl(3*A.x*A.j)) == \
294.         r"x \left(\nabla\times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)\right)"
295. 
296.     assert latex(Divergence(3*A.x*A.j+A.i)) == \
297.         r"\nabla\cdot \left(\mathbf{\hat{i}_{A}} + (3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
298.     assert latex(Divergence(3*A.x*A.j)) == \
299.         r"\nabla\cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
300.     assert latex(x*Divergence(3*A.x*A.j)) == \
301.         r"x \left(\nabla\cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)\right)"
302. 
303.     assert latex(Dot(A.i, A.j*A.x*3+A.k)) == \
304.         r"\mathbf{\hat{i}_{A}} \cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}} + \mathbf{\hat{k}_{A}}\right)"
305.     assert latex(Dot(A.i, A.j)) == \
306.         r"\mathbf{\hat{i}_{A}} \cdot \mathbf{\hat{j}_{A}}"
307.     assert latex(Dot(x*A.i, A.j)) == \
308.         r"\mathbf{\hat{j}_{A}} \cdot \left((x)\mathbf{\hat{i}_{A}}\right)"
309.     assert latex(x*Dot(A.i, A.j)) == \
310.         r"x \left(\mathbf{\hat{i}_{A}} \cdot \mathbf{\hat{j}_{A}}\right)"
311. 
312.     assert latex(Gradient(A.x)) == r"\nabla \mathbf{{x}_{A}}"
313.     assert latex(Gradient(A.x + 3*A.y)) == \
314.         r"\nabla \left(\mathbf{{x}_{A}} + 3 \mathbf{{y}_{A}}\right)"
315.     assert latex(x*Gradient(A.x)) == r"x \left(\nabla \mathbf{{x}_{A}}\right)"
316.     assert latex(Gradient(x*A.x)) == r"\nabla \left(\mathbf{{x}_{A}} x\right)"
317. 
318.     assert latex(Laplacian(A.x)) == r"\triangle \mathbf{{x}_{A}}"
319.     assert latex(Laplacian(A.x + 3*A.y)) == \
320.         r"\triangle \left(\mathbf{{x}_{A}} + 3 \mathbf{{y}_{A}}\right)"
321.     assert latex(x*Laplacian(A.x)) == r"x \left(\triangle \mathbf{{x}_{A}}\right)"
322.     assert latex(Laplacian(x*A.x)) == r"\triangle \left(\mathbf{{x}_{A}} x\right)"
323. 
324. def test_latex_symbols():
325.     Gamma, lmbda, rho = symbols('Gamma, lambda, rho')
326.     tau, Tau, TAU, taU = symbols('tau, Tau, TAU, taU')
327.     assert latex(tau) == r"\tau"
328.     assert latex(Tau) == r"T"
329.     assert latex(TAU) == r"\tau"
330.     assert latex(taU) == r"\tau"
331.     # Check that all capitalized greek letters are handled explicitly
332.     capitalized_letters = {l.capitalize() for l in greek_letters_set}
333.     assert len(capitalized_letters - set(tex_greek_dictionary.keys())) == 0
334.     assert latex(Gamma + lmbda) == r"\Gamma + \lambda"
335.     assert latex(Gamma * lmbda) == r"\Gamma \lambda"
336.     assert latex(Symbol('q1')) == r"q_{1}"
337.     assert latex(Symbol('q21')) == r"q_{21}"
338.     assert latex(Symbol('epsilon0')) == r"\epsilon_{0}"
339.     assert latex(Symbol('omega1')) == r"\omega_{1}"
340.     assert latex(Symbol('91')) == r"91"
341.     assert latex(Symbol('alpha_new')) == r"\alpha_{new}"
342.     assert latex(Symbol('C^orig')) == r"C^{orig}"
343.     assert latex(Symbol('x^alpha')) == r"x^{\alpha}"
344.     assert latex(Symbol('beta^alpha')) == r"\beta^{\alpha}"
345.     assert latex(Symbol('e^Alpha')) == r"e^{A}"
346.     assert latex(Symbol('omega_alpha^beta')) == r"\omega^{\beta}_{\alpha}"
347.     assert latex(Symbol('omega') ** Symbol('beta')) == r"\omega^{\beta}"
348. 
349. 
350. @XFAIL
351. def test_latex_symbols_failing():
352.     rho, mass, volume = symbols('rho, mass, volume')
353.     assert latex(
354.         volume * rho == mass) == r"\rho \mathrm{volume} = \mathrm{mass}"
355.     assert latex(volume / mass * rho == 1) == \
356.         r"\rho \mathrm{volume} {\mathrm{mass}}^{(-1)} = 1"
357.     assert latex(mass**3 * volume**3) == \
358.         r"{\mathrm{mass}}^{3} \cdot {\mathrm{volume}}^{3}"
359. 
360. 
361. @_both_exp_pow
362. def test_latex_functions():
363.     assert latex(exp(x)) == r"e^{x}"
364.     assert latex(exp(1) + exp(2)) == r"e + e^{2}"
365. 
366.     f = Function('f')
367.     assert latex(f(x)) == r'f{\left(x \right)}'
368.     assert latex(f) == r'f'
369. 
370.     g = Function('g')
371.     assert latex(g(x, y)) == r'g{\left(x,y \right)}'
372.     assert latex(g) == r'g'
373. 
374.     h = Function('h')
375.     assert latex(h(x, y, z)) == r'h{\left(x,y,z \right)}'
376.     assert latex(h) == r'h'
377. 
378.     Li = Function('Li')
379.     assert latex(Li) == r'\operatorname{Li}'
380.     assert latex(Li(x)) == r'\operatorname{Li}{\left(x \right)}'
381. 
382.     mybeta = Function('beta')
383.     # not to be confused with the beta function
384.     assert latex(mybeta(x, y, z)) == r"\beta{\left(x,y,z \right)}"
385.     assert latex(beta(x, y)) == r'\operatorname{B}\left(x, y\right)'
386.     assert latex(beta(x, y)**2) == r'\operatorname{B}^{2}\left(x, y\right)'
387.     assert latex(mybeta(x)) == r"\beta{\left(x \right)}"
388.     assert latex(mybeta) == r"\beta"
389. 
390.     g = Function('gamma')
391.     # not to be confused with the gamma function
392.     assert latex(g(x, y, z)) == r"\gamma{\left(x,y,z \right)}"
393.     assert latex(g(x)) == r"\gamma{\left(x \right)}"
394.     assert latex(g) == r"\gamma"
395. 
396.     a1 = Function('a_1')
397. 
398.     assert latex(a1) == r"\operatorname{a_{1}}"
399.     assert latex(a1(x)) == r"\operatorname{a_{1}}{\left(x \right)}"
400. 
401.     # issue 5868
402.     omega1 = Function('omega1')
403.     assert latex(omega1) == r"\omega_{1}"
404.     assert latex(omega1(x)) == r"\omega_{1}{\left(x \right)}"
405. 
406.     assert latex(sin(x)) == r"\sin{\left(x \right)}"
407.     assert latex(sin(x), fold_func_brackets=True) == r"\sin {x}"
408.     assert latex(sin(2*x**2), fold_func_brackets=True) == \
409.         r"\sin {2 x^{2}}"
410.     assert latex(sin(x**2), fold_func_brackets=True) == \
411.         r"\sin {x^{2}}"
412. 
413.     assert latex(asin(x)**2) == r"\operatorname{asin}^{2}{\left(x \right)}"
414.     assert latex(asin(x)**2, inv_trig_style="full") == \
415.         r"\arcsin^{2}{\left(x \right)}"
416.     assert latex(asin(x)**2, inv_trig_style="power") == \
417.         r"\sin^{-1}{\left(x \right)}^{2}"
418.     assert latex(asin(x**2), inv_trig_style="power",
419.                  fold_func_brackets=True) == \
420.         r"\sin^{-1} {x^{2}}"
421.     assert latex(acsc(x), inv_trig_style="full") == \
422.         r"\operatorname{arccsc}{\left(x \right)}"
423.     assert latex(asinh(x), inv_trig_style="full") == \
424.         r"\operatorname{arcsinh}{\left(x \right)}"
425. 
426.     assert latex(factorial(k)) == r"k!"
427.     assert latex(factorial(-k)) == r"\left(- k\right)!"
428.     assert latex(factorial(k)**2) == r"k!^{2}"
429. 
430.     assert latex(subfactorial(k)) == r"!k"
431.     assert latex(subfactorial(-k)) == r"!\left(- k\right)"
432.     assert latex(subfactorial(k)**2) == r"\left(!k\right)^{2}"
433. 
434.     assert latex(factorial2(k)) == r"k!!"
435.     assert latex(factorial2(-k)) == r"\left(- k\right)!!"
436.     assert latex(factorial2(k)**2) == r"k!!^{2}"
437. 
438.     assert latex(binomial(2, k)) == r"{\binom{2}{k}}"
439.     assert latex(binomial(2, k)**2) == r"{\binom{2}{k}}^{2}"
440. 
441.     assert latex(FallingFactorial(3, k)) == r"{\left(3\right)}_{k}"
442.     assert latex(RisingFactorial(3, k)) == r"{3}^{\left(k\right)}"
443. 
444.     assert latex(floor(x)) == r"\left\lfloor{x}\right\rfloor"
445.     assert latex(ceiling(x)) == r"\left\lceil{x}\right\rceil"
446.     assert latex(frac(x)) == r"\operatorname{frac}{\left(x\right)}"
447.     assert latex(floor(x)**2) == r"\left\lfloor{x}\right\rfloor^{2}"
448.     assert latex(ceiling(x)**2) == r"\left\lceil{x}\right\rceil^{2}"
449.     assert latex(frac(x)**2) == r"\operatorname{frac}{\left(x\right)}^{2}"
450. 
451.     assert latex(Min(x, 2, x**3)) == r"\min\left(2, x, x^{3}\right)"
452.     assert latex(Min(x, y)**2) == r"\min\left(x, y\right)^{2}"
453.     assert latex(Max(x, 2, x**3)) == r"\max\left(2, x, x^{3}\right)"
454.     assert latex(Max(x, y)**2) == r"\max\left(x, y\right)^{2}"
455.     assert latex(Abs(x)) == r"\left|{x}\right|"
456.     assert latex(Abs(x)**2) == r"\left|{x}\right|^{2}"
457.     assert latex(re(x)) == r"\operatorname{re}{\left(x\right)}"
458.     assert latex(re(x + y)) == \
459.         r"\operatorname{re}{\left(x\right)} + \operatorname{re}{\left(y\right)}"
460.     assert latex(im(x)) == r"\operatorname{im}{\left(x\right)}"
461.     assert latex(conjugate(x)) == r"\overline{x}"
462.     assert latex(conjugate(x)**2) == r"\overline{x}^{2}"
463.     assert latex(conjugate(x**2)) == r"\overline{x}^{2}"
464.     assert latex(gamma(x)) == r"\Gamma\left(x\right)"
465.     w = Wild('w')
466.     assert latex(gamma(w)) == r"\Gamma\left(w\right)"
467.     assert latex(Order(x)) == r"O\left(x\right)"
468.     assert latex(Order(x, x)) == r"O\left(x\right)"
469.     assert latex(Order(x, (x, 0))) == r"O\left(x\right)"
470.     assert latex(Order(x, (x, oo))) == r"O\left(x; x\rightarrow \infty\right)"
471.     assert latex(Order(x - y, (x, y))) == \
472.         r"O\left(x - y; x\rightarrow y\right)"
473.     assert latex(Order(x, x, y)) == \
474.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( 0, \  0\right)\right)"
475.     assert latex(Order(x, x, y)) == \
476.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( 0, \  0\right)\right)"
477.     assert latex(Order(x, (x, oo), (y, oo))) == \
478.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( \infty, \  \infty\right)\right)"
479.     assert latex(lowergamma(x, y)) == r'\gamma\left(x, y\right)'
480.     assert latex(lowergamma(x, y)**2) == r'\gamma^{2}\left(x, y\right)'
481.     assert latex(uppergamma(x, y)) == r'\Gamma\left(x, y\right)'
482.     assert latex(uppergamma(x, y)**2) == r'\Gamma^{2}\left(x, y\right)'
483. 
484.     assert latex(cot(x)) == r'\cot{\left(x \right)}'
485.     assert latex(coth(x)) == r'\coth{\left(x \right)}'
486.     assert latex(re(x)) == r'\operatorname{re}{\left(x\right)}'
487.     assert latex(im(x)) == r'\operatorname{im}{\left(x\right)}'
488.     assert latex(root(x, y)) == r'x^{\frac{1}{y}}'
489.     assert latex(arg(x)) == r'\arg{\left(x \right)}'
490. 
491.     assert latex(zeta(x)) == r"\zeta\left(x\right)"
492.     assert latex(zeta(x)**2) == r"\zeta^{2}\left(x\right)"
493.     assert latex(zeta(x, y)) == r"\zeta\left(x, y\right)"
494.     assert latex(zeta(x, y)**2) == r"\zeta^{2}\left(x, y\right)"
495.     assert latex(dirichlet_eta(x)) == r"\eta\left(x\right)"
496.     assert latex(dirichlet_eta(x)**2) == r"\eta^{2}\left(x\right)"
497.     assert latex(polylog(x, y)) == r"\operatorname{Li}_{x}\left(y\right)"
498.     assert latex(
499.         polylog(x, y)**2) == r"\operatorname{Li}_{x}^{2}\left(y\right)"
500.     assert latex(lerchphi(x, y, n)) == r"\Phi\left(x, y, n\right)"

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 02:59:36,162 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the content of the file `sympy/printing/tests/test_latex.py`.\n2. Extended relevance:\n   - The user's stated purpose is to find test cases for LaTeX printing of powers (`_print_Pow`) and superscripts.\n   - This file contains the test suite for LaTeX printing in SymPy, and therefore includes numerous relevant examples. For instance, the `test_latex_basic` function tests powers like `x**2`, and other functions test powers of trigonometric functions and other expressions. The entire file is relevant to the user's purpose.", relative_path='sympy/printing/tests/test_latex.py', start_line=1, end_line=500)]
2025-12-21 02:59:36,164 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the content of the file `sympy/printing/tests/test_latex.py`.
2025-12-21 02:59:36,164 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 02:59:36,164 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 02:59:36,164 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 02:59:36,164 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 02:59:36,165 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .github
|   └── workflows
|       ├── comment-on-pr.yml
|       └── runtests.yml
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.md
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_optional_dependencies.py
|   ├── test_py2_import.py
|   ├── test_setup.py
|   ├── test_sphinx.sh
|   ├── test_submodule_imports.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── contributing
|       |   └── index.rst
|       ├── documentation-style-guide.rst
|       ├── explanation
|       |   └── index.rst
|       ├── getting_started
|       |   ├── index.rst
|       |   └── install.rst
|       ├── gotchas.rst
|       ├── guides
|       |   ├── assumptions.rst
|       |   ├── booleans.rst
|       |   └── index.rst
|       ├── how_to_guide
|       |   └── index.rst
|       ├── index.rst
|       ├── logo
|       |   └── info.txt
|       ├── miscellaneous
|       |   └── index.rst
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── index.rst
|       |   |   ├── predicates.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── sparse.rst
|       |   |   └── sparsetools.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── control
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── domainmatrix.rst
|       |   |   ├── domainsintro.rst
|       |   |   ├── domainsref.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   ├── solvers.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── fu.rst
|       |   |   ├── hyperexpand.rst
|       |   |   ├── index.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── testing
|       |   |   ├── index.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   └── runtests.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       ├── intro.rst
|       |       └── vector_integration.rst
|       ├── outreach.rst
|       ├── pics
|       ├── reference
|       |   └── index.rst
|       ├── special_topics
|       |   ├── classification.rst
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── aptinstall.sh
|   ├── authors.py
|   ├── build_docs.py
|   ├── compare_tar_against_git.py
|   ├── fabfile.py
|   ├── github_release.py
|   ├── helpers.py
|   ├── pull_and_run_rever.sh
|   ├── release.sh
|   ├── releasecheck.py
|   ├── requirements.txt
|   ├── sha256.py
|   ├── test_install.py
|   ├── update_docs.py
|   └── update_requirements.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── facts.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── predicates
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── relation
    |   |   ├── __init__.py
    |   |   ├── binrel.py
    |   |   └── equality.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_assumptions_2.py
    |   |   ├── test_context.py
    |   |   ├── test_matrices.py
    |   |   ├── test_query.py
    |   |   ├── test_refine.py
    |   |   ├── test_satask.py
    |   |   ├── test_sathandlers.py
    |   |   └── test_wrapper.py
    |   └── wrapper.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── numpy_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   ├── scipy_nodes.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_numpy_nodes.py
    |       ├── test_pyutils.py
    |       ├── test_rewriting.py
    |       └── test_scipy_nodes.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── schur_number.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_schur_number.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── _print_helpers.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── kind.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── parameters.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_kind.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_parameters.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── gmpy.py
    |   ├── importtools.py
    |   ├── pythonmpq.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_pythonmpq.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   ├── minisat22_wrapper.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── decompositions.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── determinant.py
    |   ├── eigen.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── companion.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── sets.py
    |   |   ├── slice.py
    |   |   ├── special.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_companion.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_sets.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_special.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── graph.py
    |   ├── immutable.py
    |   ├── inverse.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── reductions.py
    |   ├── repmatrix.py
    |   ├── solvers.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   ├── subspaces.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_commonmatrix.py
    |   |   ├── test_decompositions.py
    |   |   ├── test_densearith.py
    |   |   ├── test_densesolve.py
    |   |   ├── test_densetools.py
    |   |   ├── test_determinant.py
    |   |   ├── test_eigen.py
    |   |   ├── test_graph.py
    |   |   ├── test_immutable.py
    |   |   ├── test_interactions.py
    |   |   ├── test_matrices.py
    |   |   ├── test_normalforms.py
    |   |   ├── test_reductions.py
    |   |   ├── test_solvers.py
    |   |   ├── test_sparse.py
    |   |   ├── test_sparsetools.py
    |   |   └── test_subspaces.py
    |   └── utilities.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── digits.py
    |   ├── ecm.py
    |   ├── egyptian_fraction.py
    |   ├── elliptic_curve.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── qs.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_digits.py
    |       ├── test_ecm.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_elliptic_curve.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       ├── test_qs.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── README.txt
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── control
    |   |   ├── __init__.py
    |   |   ├── control_plots.py
    |   |   ├── lti.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_control_plots.py
    |   |       └── test_lti.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── joint.py
    |   |   ├── jointsmethod.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── method.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_joint.py
    |   |       ├── test_jointsmethod.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_method.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domainmatrix.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── expressionrawdomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gaussiandomains.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── matrices
    |   |   ├── __init__.py
    |   |   ├── ddm.py
    |   |   ├── dense.py
    |   |   ├── domainmatrix.py
    |   |   ├── domainscalar.py
    |   |   ├── eigen.py
    |   |   ├── exceptions.py
    |   |   ├── linsolve.py
    |   |   ├── normalforms.py
    |   |   ├── sdm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_ddm.py
    |   |       ├── test_dense.py
    |   |       ├── test_domainmatrix.py
    |   |       ├── test_domainscalar.py
    |   |       ├── test_eigen.py
    |   |       ├── test_linsolve.py
    |   |       ├── test_normalforms.py
    |   |       └── test_sdm.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── aesaracode.py
    |   ├── c.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxx.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── fortran.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── numpy.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_aesaracode.py
    |   |   ├── test_c.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cupy.py
    |   |   ├── test_cxx.py
    |   |   ├── test_dot.py
    |   |   ├── test_fortran.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── comparison.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine
    |   |   ├── __init__.py
    |   |   ├── diophantine.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_diophantine.py
    |   ├── inequalities.py
    |   ├── ode
    |   |   ├── __init__.py
    |   |   ├── hypergeometric.py
    |   |   ├── lie_group.py
    |   |   ├── nonhomogeneous.py
    |   |   ├── ode.py
    |   |   ├── riccati.py
    |   |   ├── single.py
    |   |   ├── subscheck.py
    |   |   ├── systems.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_lie_group.py
    |   |       ├── test_ode.py
    |   |       ├── test_riccati.py
    |   |       ├── test_single.py
    |   |       ├── test_subscheck.py
    |   |       └── test_systems.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── compound_rv.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── matrix_distributions.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── sampling
    |   |   ├── __init__.py
    |   |   ├── sample_numpy.py
    |   |   ├── sample_pymc3.py
    |   |   ├── sample_scipy.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_sample_continuous_rv.py
    |   |       ├── test_sample_discrete_rv.py
    |   |       └── test_sample_finite_rv.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_multivariate_probability.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_compound_rv.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_matrix_distributions.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       ├── test_symbolic_multivariate.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── array_derivatives.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── expressions
    |   |   |   ├── __init__.py
    |   |   |   ├── array_expressions.py
    |   |   |   ├── arrayexpr_derivatives.py
    |   |   |   ├── conv_array_to_matrix.py
    |   |   |   ├── conv_indexed_to_array.py
    |   |   |   ├── conv_matrix_to_array.py
    |   |   |   ├── tests
    |   |   |   └── utils.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_array_derivatives.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── testing
    |   ├── __init__.py
    |   ├── benchmarking.py
    |   ├── matrices.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_module_imports.py
    |   |   └── test_pytest.py
    |   └── tmpfiles.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_matchpy_connector.py
    |   |   ├── test_misc.py
    |   |   ├── test_pickling.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── implicitregion.py
        ├── integrals.py
        ├── operators.py
        ├── orienters.py
        ├── parametricregion.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_implicitregion.py
        |   ├── test_integrals.py
        |   ├── test_operators.py
        |   ├── test_parametricregion.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Issues with Latex printing output in second quantization module

Description: There are Latex rendering problems within the "secondquant" module, as it does not correctly interpret double superscripts containing the "dagger" command within Jupyter Notebook.

Let's see a minimal example

```
In [1]: import sympy as sp
        from sympy.physics.secondquant import B, Bd, Commutator
        sp.init_printing()

In [2]: a = sp.Symbol('0')

In [3]: Commutator(Bd(a)**2, B(a))
Out[3]: \displaystyle - \left[b_{0},b^\dagger_{0}^{2}\right]
```
So, it doesn't render correctly, and that's because the double superscript `"b^\dagger_{0}^{2}"`. It should be correct by adding curly brackets `"{b^\dagger_{0}}^{2}"`

Patch information:
diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py
index 64d3207d09..14634b0447 100644
--- a/sympy/printing/latex.py
+++ b/sympy/printing/latex.py
@@ -638,6 +638,9 @@ def _print_Pow(self, expr):
                 base = self.parenthesize_super(base)
             if expr.base.is_Function:
                 return self._print(expr.base, exp="%s/%s" % (p, q))
+            # If base LaTeX already contains a superscript (e.g., dagger), group it
+            if (not expr.base.is_Symbol) and ("^" in base):
+                base = "{%s}" % base
             return r"%s^{%s/%s}" % (base, p, q)
         elif expr.exp.is_Rational and expr.exp.is_negative and \
                 expr.base.is_commutative:
@@ -673,6 +676,9 @@ def _helper_print_standard_power(self, expr, template):
             and base.endswith(r'\right)')):
             # don't use parentheses around dotted derivative
             base = base[6: -7]  # remove outermost added parens
+        # If base LaTeX already contains a superscript (e.g., dagger), group it
+        if (not expr.base.is_Symbol) and ("^" in base):
+            base = "{%s}" % base
         return template % (base, exp)
 
     def _print_UnevaluatedExpr(self, expr):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the content of the file `sympy/printing/tests/test_latex.py`.
Extra Requirements: 
Purpose: This file is needed to find existing test cases that test the LaTeX printing of powers (`_print_Pow`) and to see how expressions with superscripts are currently tested.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/printing/tests/test_latex.py
Line number range: 1 - 500
Content:
1. from sympy.tensor.array.expressions.array_expressions import ArraySymbol, ArrayElement
2. from sympy.tensor.toperators import PartialDerivative
3. 
4. from sympy import (
5.     Abs, Chi, Ci, CosineTransform, Dict, Ei, Eq, FallingFactorial,
6.     FiniteSet, Float, FourierTransform, Function, Indexed, IndexedBase, Integral,
7.     Interval, InverseCosineTransform, InverseFourierTransform, Derivative,
8.     InverseLaplaceTransform, InverseMellinTransform, InverseSineTransform,
9.     Lambda, LaplaceTransform, Limit, Matrix, Max, MellinTransform, Min, Mul,
10.     Order, Piecewise, Poly, ring, field, ZZ, Pow, Product, Range, Rational, Integer,
11.     RisingFactorial, rootof, RootSum, S, Shi, Si, SineTransform, Subs,
12.     Sum, Symbol, ImageSet, Tuple, Ynm, Znm, arg, asin, acsc, asinh, Mod,
13.     assoc_laguerre, assoc_legendre, beta, binomial, catalan, ceiling,
14.     chebyshevt, chebyshevu, conjugate, cot, coth, diff, dirichlet_eta, euler,
15.     exp, expint, factorial, factorial2, floor, gamma, gegenbauer, hermite,
16.     hyper, im, jacobi, laguerre, legendre, lerchphi, log, frac,
17.     meijerg, oo, polar_lift, polylog, re, root, sin, sqrt, symbols,
18.     uppergamma, zeta, subfactorial, totient, elliptic_k, elliptic_f,
19.     elliptic_e, elliptic_pi, cos, tan, Wild, true, false, Equivalent, Not,
20.     Contains, divisor_sigma, SeqPer, SeqFormula, MatrixSlice,
21.     SeqAdd, SeqMul, fourier_series, pi, ConditionSet, ComplexRegion, fps,
22.     AccumBounds, reduced_totient, primenu, primeomega, SingularityFunction,
23.     stieltjes, mathieuc, mathieus, mathieucprime, mathieusprime,
24.     UnevaluatedExpr, Quaternion, I, KroneckerProduct, LambertW)
25. 
26. from sympy.ntheory.factor_ import udivisor_sigma
27. 
28. from sympy.abc import mu, tau
29. from sympy.printing.latex import (latex, translate, greek_letters_set,
30.                                   tex_greek_dictionary, multiline_latex,
31.                                   latex_escape, LatexPrinter)
32. from sympy.tensor.array import (ImmutableDenseNDimArray,
33.                                 ImmutableSparseNDimArray,
34.                                 MutableSparseNDimArray,
35.                                 MutableDenseNDimArray,
36.                                 tensorproduct)
37. from sympy.testing.pytest import XFAIL, raises, _both_exp_pow
38. from sympy.functions import DiracDelta, Heaviside, KroneckerDelta, LeviCivita
39. from sympy.functions.combinatorial.numbers import bernoulli, bell, lucas, \
40.     fibonacci, tribonacci
41. from sympy.logic import Implies
42. from sympy.logic.boolalg import And, Or, Xor
43. from sympy.physics.control.lti import TransferFunction, Series, Parallel, \
44.     Feedback, TransferFunctionMatrix, MIMOSeries, MIMOParallel, MIMOFeedback
45. from sympy.physics.quantum import Commutator, Operator
46. from sympy.physics.units import meter, gibibyte, microgram, second
47. from sympy.core.trace import Tr
48. from sympy.combinatorics.permutations import \
49.     Cycle, Permutation, AppliedPermutation
50. from sympy.matrices.expressions.permutation import PermutationMatrix
51. from sympy import MatrixSymbol, ln
52. from sympy.vector import CoordSys3D, Cross, Curl, Dot, Divergence, Gradient, Laplacian
53. from sympy.sets.setexpr import SetExpr
54. from sympy.sets.sets import \
55.     Union, Intersection, Complement, SymmetricDifference, ProductSet
56. 
57. import sympy as sym
58. 
59. 
60. class lowergamma(sym.lowergamma):
61.     pass   # testing notation inheritance by a subclass with same name
62. 
63. 
64. x, y, z, t, w, a, b, c, s, p = symbols('x y z t w a b c s p')
65. k, m, n = symbols('k m n', integer=True)
66. 
67. 
68. def test_printmethod():
69.     class R(Abs):
70.         def _latex(self, printer):
71.             return "foo(%s)" % printer._print(self.args[0])
72.     assert latex(R(x)) == r"foo(x)"
73. 
74.     class R(Abs):
75.         def _latex(self, printer):
76.             return "foo"
77.     assert latex(R(x)) == r"foo"
78. 
79. 
80. def test_latex_basic():
81.     assert latex(1 + x) == r"x + 1"
82.     assert latex(x**2) == r"x^{2}"
83.     assert latex(x**(1 + x)) == r"x^{x + 1}"
84.     assert latex(x**3 + x + 1 + x**2) == r"x^{3} + x^{2} + x + 1"
85. 
86.     assert latex(2*x*y) == r"2 x y"
87.     assert latex(2*x*y, mul_symbol='dot') == r"2 \cdot x \cdot y"
88.     assert latex(3*x**2*y, mul_symbol='\\,') == r"3\,x^{2}\,y"
89.     assert latex(1.5*3**x, mul_symbol='\\,') == r"1.5 \cdot 3^{x}"
90. 
91.     assert latex(Mul(0, 1, evaluate=False)) == r'0 \cdot 1'
92.     assert latex(Mul(1, 0, evaluate=False)) == r'1 \cdot 0'
93.     assert latex(Mul(1, 1, evaluate=False)) == r'1 \cdot 1'
94.     assert latex(Mul(-1, 1, evaluate=False)) == r'\left(-1\right) 1'
95.     assert latex(Mul(1, 1, 1, evaluate=False)) == r'1 \cdot 1 \cdot 1'
96.     assert latex(Mul(1, 2, evaluate=False)) == r'1 \cdot 2'
97.     assert latex(Mul(1, S.Half, evaluate=False)) == r'1 \frac{1}{2}'
98.     assert latex(Mul(1, 1, S.Half, evaluate=False)) == \
99.         r'1 \cdot 1 \frac{1}{2}'
100.     assert latex(Mul(1, 1, 2, 3, x, evaluate=False)) == \
101.         r'1 \cdot 1 \cdot 2 \cdot 3 x'
102.     assert latex(Mul(1, -1, evaluate=False)) == r'1 \left(-1\right)'
103.     assert latex(Mul(4, 3, 2, 1, 0, y, x, evaluate=False)) == \
104.         r'4 \cdot 3 \cdot 2 \cdot 1 \cdot 0 y x'
105.     assert latex(Mul(4, 3, 2, 1+z, 0, y, x, evaluate=False)) == \
106.         r'4 \cdot 3 \cdot 2 \left(z + 1\right) 0 y x'
107.     assert latex(Mul(Rational(2, 3), Rational(5, 7), evaluate=False)) == \
108.         r'\frac{2}{3} \frac{5}{7}'
109. 
110.     assert latex(1/x) == r"\frac{1}{x}"
111.     assert latex(1/x, fold_short_frac=True) == r"1 / x"
112.     assert latex(-S(3)/2) == r"- \frac{3}{2}"
113.     assert latex(-S(3)/2, fold_short_frac=True) == r"- 3 / 2"
114.     assert latex(1/x**2) == r"\frac{1}{x^{2}}"
115.     assert latex(1/(x + y)/2) == r"\frac{1}{2 \left(x + y\right)}"
116.     assert latex(x/2) == r"\frac{x}{2}"
117.     assert latex(x/2, fold_short_frac=True) == r"x / 2"
118.     assert latex((x + y)/(2*x)) == r"\frac{x + y}{2 x}"
119.     assert latex((x + y)/(2*x), fold_short_frac=True) == \
120.         r"\left(x + y\right) / 2 x"
121.     assert latex((x + y)/(2*x), long_frac_ratio=0) == \
122.         r"\frac{1}{2 x} \left(x + y\right)"
123.     assert latex((x + y)/x) == r"\frac{x + y}{x}"
124.     assert latex((x + y)/x, long_frac_ratio=3) == r"\frac{x + y}{x}"
125.     assert latex((2*sqrt(2)*x)/3) == r"\frac{2 \sqrt{2} x}{3}"
126.     assert latex((2*sqrt(2)*x)/3, long_frac_ratio=2) == \
127.         r"\frac{2 x}{3} \sqrt{2}"
128.     assert latex(binomial(x, y)) == r"{\binom{x}{y}}"
129. 
130.     x_star = Symbol('x^*')
131.     f = Function('f')
132.     assert latex(x_star**2) == r"\left(x^{*}\right)^{2}"
133.     assert latex(x_star**2, parenthesize_super=False) == r"{x^{*}}^{2}"
134.     assert latex(Derivative(f(x_star), x_star,2)) == r"\frac{d^{2}}{d \left(x^{*}\right)^{2}} f{\left(x^{*} \right)}"
135.     assert latex(Derivative(f(x_star), x_star,2), parenthesize_super=False) == r"\frac{d^{2}}{d {x^{*}}^{2}} f{\left(x^{*} \right)}"
136. 
137.     assert latex(2*Integral(x, x)/3) == r"\frac{2 \int x\, dx}{3}"
138.     assert latex(2*Integral(x, x)/3, fold_short_frac=True) == \
139.         r"\left(2 \int x\, dx\right) / 3"
140. 
141.     assert latex(sqrt(x)) == r"\sqrt{x}"
142.     assert latex(x**Rational(1, 3)) == r"\sqrt[3]{x}"
143.     assert latex(x**Rational(1, 3), root_notation=False) == r"x^{\frac{1}{3}}"
144.     assert latex(sqrt(x)**3) == r"x^{\frac{3}{2}}"
145.     assert latex(sqrt(x), itex=True) == r"\sqrt{x}"
146.     assert latex(x**Rational(1, 3), itex=True) == r"\root{3}{x}"
147.     assert latex(sqrt(x)**3, itex=True) == r"x^{\frac{3}{2}}"
148.     assert latex(x**Rational(3, 4)) == r"x^{\frac{3}{4}}"
149.     assert latex(x**Rational(3, 4), fold_frac_powers=True) == r"x^{3/4}"
150.     assert latex((x + 1)**Rational(3, 4)) == \
151.         r"\left(x + 1\right)^{\frac{3}{4}}"
152.     assert latex((x + 1)**Rational(3, 4), fold_frac_powers=True) == \
153.         r"\left(x + 1\right)^{3/4}"
154. 
155.     assert latex(1.5e20*x) == r"1.5 \cdot 10^{20} x"
156.     assert latex(1.5e20*x, mul_symbol='dot') == r"1.5 \cdot 10^{20} \cdot x"
157.     assert latex(1.5e20*x, mul_symbol='times') == \
158.         r"1.5 \times 10^{20} \times x"
159. 
160.     assert latex(1/sin(x)) == r"\frac{1}{\sin{\left(x \right)}}"
161.     assert latex(sin(x)**-1) == r"\frac{1}{\sin{\left(x \right)}}"
162.     assert latex(sin(x)**Rational(3, 2)) == \
163.         r"\sin^{\frac{3}{2}}{\left(x \right)}"
164.     assert latex(sin(x)**Rational(3, 2), fold_frac_powers=True) == \
165.         r"\sin^{3/2}{\left(x \right)}"
166. 
167.     assert latex(~x) == r"\neg x"
168.     assert latex(x & y) == r"x \wedge y"
169.     assert latex(x & y & z) == r"x \wedge y \wedge z"
170.     assert latex(x | y) == r"x \vee y"
171.     assert latex(x | y | z) == r"x \vee y \vee z"
172.     assert latex((x & y) | z) == r"z \vee \left(x \wedge y\right)"
173.     assert latex(Implies(x, y)) == r"x \Rightarrow y"
174.     assert latex(~(x >> ~y)) == r"x \not\Rightarrow \neg y"
175.     assert latex(Implies(Or(x,y), z)) == r"\left(x \vee y\right) \Rightarrow z"
176.     assert latex(Implies(z, Or(x,y))) == r"z \Rightarrow \left(x \vee y\right)"
177.     assert latex(~(x & y)) == r"\neg \left(x \wedge y\right)"
178. 
179.     assert latex(~x, symbol_names={x: "x_i"}) == r"\neg x_i"
180.     assert latex(x & y, symbol_names={x: "x_i", y: "y_i"}) == \
181.         r"x_i \wedge y_i"
182.     assert latex(x & y & z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
183.         r"x_i \wedge y_i \wedge z_i"
184.     assert latex(x | y, symbol_names={x: "x_i", y: "y_i"}) == r"x_i \vee y_i"
185.     assert latex(x | y | z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
186.         r"x_i \vee y_i \vee z_i"
187.     assert latex((x & y) | z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
188.         r"z_i \vee \left(x_i \wedge y_i\right)"
189.     assert latex(Implies(x, y), symbol_names={x: "x_i", y: "y_i"}) == \
190.         r"x_i \Rightarrow y_i"
191.     assert latex(Pow(Rational(1, 3), -1, evaluate=False)) == r"\frac{1}{\frac{1}{3}}"
192.     assert latex(Pow(Rational(1, 3), -2, evaluate=False)) == r"\frac{1}{(\frac{1}{3})^{2}}"
193.     assert latex(Pow(Integer(1)/100, -1, evaluate=False)) == r"\frac{1}{\frac{1}{100}}"
194. 
195. 
196.     p = Symbol('p', positive=True)
197.     assert latex(exp(-p)*log(p)) == r"e^{- p} \log{\left(p \right)}"
198. 
199. 
200. def test_latex_builtins():
201.     assert latex(True) == r"\text{True}"
202.     assert latex(False) == r"\text{False}"
203.     assert latex(None) == r"\text{None}"
204.     assert latex(true) == r"\text{True}"
205.     assert latex(false) == r'\text{False}'
206. 
207. 
208. def test_latex_SingularityFunction():
209.     assert latex(SingularityFunction(x, 4, 5)) == \
210.         r"{\left\langle x - 4 \right\rangle}^{5}"
211.     assert latex(SingularityFunction(x, -3, 4)) == \
212.         r"{\left\langle x + 3 \right\rangle}^{4}"
213.     assert latex(SingularityFunction(x, 0, 4)) == \
214.         r"{\left\langle x \right\rangle}^{4}"
215.     assert latex(SingularityFunction(x, a, n)) == \
216.         r"{\left\langle - a + x \right\rangle}^{n}"
217.     assert latex(SingularityFunction(x, 4, -2)) == \
218.         r"{\left\langle x - 4 \right\rangle}^{-2}"
219.     assert latex(SingularityFunction(x, 4, -1)) == \
220.         r"{\left\langle x - 4 \right\rangle}^{-1}"
221. 
222.     assert latex(SingularityFunction(x, 4, 5)**3) == \
223.         r"{\left({\langle x - 4 \rangle}^{5}\right)}^{3}"
224.     assert latex(SingularityFunction(x, -3, 4)**3) == \
225.         r"{\left({\langle x + 3 \rangle}^{4}\right)}^{3}"
226.     assert latex(SingularityFunction(x, 0, 4)**3) == \
227.         r"{\left({\langle x \rangle}^{4}\right)}^{3}"
228.     assert latex(SingularityFunction(x, a, n)**3) == \
229.         r"{\left({\langle - a + x \rangle}^{n}\right)}^{3}"
230.     assert latex(SingularityFunction(x, 4, -2)**3) == \
231.         r"{\left({\langle x - 4 \rangle}^{-2}\right)}^{3}"
232.     assert latex((SingularityFunction(x, 4, -1)**3)**3) == \
233.         r"{\left({\langle x - 4 \rangle}^{-1}\right)}^{9}"
234. 
235. 
236. def test_latex_cycle():
237.     assert latex(Cycle(1, 2, 4)) == r"\left( 1\; 2\; 4\right)"
238.     assert latex(Cycle(1, 2)(4, 5, 6)) == \
239.         r"\left( 1\; 2\right)\left( 4\; 5\; 6\right)"
240.     assert latex(Cycle()) == r"\left( \right)"
241. 
242. 
243. def test_latex_permutation():
244.     assert latex(Permutation(1, 2, 4)) == r"\left( 1\; 2\; 4\right)"
245.     assert latex(Permutation(1, 2)(4, 5, 6)) == \
246.         r"\left( 1\; 2\right)\left( 4\; 5\; 6\right)"
247.     assert latex(Permutation()) == r"\left( \right)"
248.     assert latex(Permutation(2, 4)*Permutation(5)) == \
249.         r"\left( 2\; 4\right)\left( 5\right)"
250.     assert latex(Permutation(5)) == r"\left( 5\right)"
251. 
252.     assert latex(Permutation(0, 1), perm_cyclic=False) == \
253.         r"\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}"
254.     assert latex(Permutation(0, 1)(2, 3), perm_cyclic=False) == \
255.         r"\begin{pmatrix} 0 & 1 & 2 & 3 \\ 1 & 0 & 3 & 2 \end{pmatrix}"
256.     assert latex(Permutation(), perm_cyclic=False) == \
257.         r"\left( \right)"
258. 
259. 
260. def test_latex_Float():
261.     assert latex(Float(1.0e100)) == r"1.0 \cdot 10^{100}"
262.     assert latex(Float(1.0e-100)) == r"1.0 \cdot 10^{-100}"
263.     assert latex(Float(1.0e-100), mul_symbol="times") == \
264.         r"1.0 \times 10^{-100}"
265.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=2) == \
266.         r"1.0 \cdot 10^{4}"
267.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=4) == \
268.         r"1.0 \cdot 10^{4}"
269.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=5) == \
270.         r"10000.0"
271.     assert latex(Float('0.099999'), full_prec=True,  min=-2, max=5) == \
272.         r"9.99990000000000 \cdot 10^{-2}"
273. 
274. 
275. def test_latex_vector_expressions():
276.     A = CoordSys3D('A')
277. 
278.     assert latex(Cross(A.i, A.j*A.x*3+A.k)) == \
279.         r"\mathbf{\hat{i}_{A}} \times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}} + \mathbf{\hat{k}_{A}}\right)"
280.     assert latex(Cross(A.i, A.j)) == \
281.         r"\mathbf{\hat{i}_{A}} \times \mathbf{\hat{j}_{A}}"
282.     assert latex(x*Cross(A.i, A.j)) == \
283.         r"x \left(\mathbf{\hat{i}_{A}} \times \mathbf{\hat{j}_{A}}\right)"
284.     assert latex(Cross(x*A.i, A.j)) == \
285.         r'- \mathbf{\hat{j}_{A}} \times \left((x)\mathbf{\hat{i}_{A}}\right)'
286. 
287.     assert latex(Curl(3*A.x*A.j)) == \
288.         r"\nabla\times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
289.     assert latex(Curl(3*A.x*A.j+A.i)) == \
290.         r"\nabla\times \left(\mathbf{\hat{i}_{A}} + (3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
291.     assert latex(Curl(3*x*A.x*A.j)) == \
292.         r"\nabla\times \left((3 \mathbf{{x}_{A}} x)\mathbf{\hat{j}_{A}}\right)"
293.     assert latex(x*Curl(3*A.x*A.j)) == \
294.         r"x \left(\nabla\times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)\right)"
295. 
296.     assert latex(Divergence(3*A.x*A.j+A.i)) == \
297.         r"\nabla\cdot \left(\mathbf{\hat{i}_{A}} + (3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
298.     assert latex(Divergence(3*A.x*A.j)) == \
299.         r"\nabla\cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
300.     assert latex(x*Divergence(3*A.x*A.j)) == \
301.         r"x \left(\nabla\cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)\right)"
302. 
303.     assert latex(Dot(A.i, A.j*A.x*3+A.k)) == \
304.         r"\mathbf{\hat{i}_{A}} \cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}} + \mathbf{\hat{k}_{A}}\right)"
305.     assert latex(Dot(A.i, A.j)) == \
306.         r"\mathbf{\hat{i}_{A}} \cdot \mathbf{\hat{j}_{A}}"
307.     assert latex(Dot(x*A.i, A.j)) == \
308.         r"\mathbf{\hat{j}_{A}} \cdot \left((x)\mathbf{\hat{i}_{A}}\right)"
309.     assert latex(x*Dot(A.i, A.j)) == \
310.         r"x \left(\mathbf{\hat{i}_{A}} \cdot \mathbf{\hat{j}_{A}}\right)"
311. 
312.     assert latex(Gradient(A.x)) == r"\nabla \mathbf{{x}_{A}}"
313.     assert latex(Gradient(A.x + 3*A.y)) == \
314.         r"\nabla \left(\mathbf{{x}_{A}} + 3 \mathbf{{y}_{A}}\right)"
315.     assert latex(x*Gradient(A.x)) == r"x \left(\nabla \mathbf{{x}_{A}}\right)"
316.     assert latex(Gradient(x*A.x)) == r"\nabla \left(\mathbf{{x}_{A}} x\right)"
317. 
318.     assert latex(Laplacian(A.x)) == r"\triangle \mathbf{{x}_{A}}"
319.     assert latex(Laplacian(A.x + 3*A.y)) == \
320.         r"\triangle \left(\mathbf{{x}_{A}} + 3 \mathbf{{y}_{A}}\right)"
321.     assert latex(x*Laplacian(A.x)) == r"x \left(\triangle \mathbf{{x}_{A}}\right)"
322.     assert latex(Laplacian(x*A.x)) == r"\triangle \left(\mathbf{{x}_{A}} x\right)"
323. 
324. def test_latex_symbols():
325.     Gamma, lmbda, rho = symbols('Gamma, lambda, rho')
326.     tau, Tau, TAU, taU = symbols('tau, Tau, TAU, taU')
327.     assert latex(tau) == r"\tau"
328.     assert latex(Tau) == r"T"
329.     assert latex(TAU) == r"\tau"
330.     assert latex(taU) == r"\tau"
331.     # Check that all capitalized greek letters are handled explicitly
332.     capitalized_letters = {l.capitalize() for l in greek_letters_set}
333.     assert len(capitalized_letters - set(tex_greek_dictionary.keys())) == 0
334.     assert latex(Gamma + lmbda) == r"\Gamma + \lambda"
335.     assert latex(Gamma * lmbda) == r"\Gamma \lambda"
336.     assert latex(Symbol('q1')) == r"q_{1}"
337.     assert latex(Symbol('q21')) == r"q_{21}"
338.     assert latex(Symbol('epsilon0')) == r"\epsilon_{0}"
339.     assert latex(Symbol('omega1')) == r"\omega_{1}"
340.     assert latex(Symbol('91')) == r"91"
341.     assert latex(Symbol('alpha_new')) == r"\alpha_{new}"
342.     assert latex(Symbol('C^orig')) == r"C^{orig}"
343.     assert latex(Symbol('x^alpha')) == r"x^{\alpha}"
344.     assert latex(Symbol('beta^alpha')) == r"\beta^{\alpha}"
345.     assert latex(Symbol('e^Alpha')) == r"e^{A}"
346.     assert latex(Symbol('omega_alpha^beta')) == r"\omega^{\beta}_{\alpha}"
347.     assert latex(Symbol('omega') ** Symbol('beta')) == r"\omega^{\beta}"
348. 
349. 
350. @XFAIL
351. def test_latex_symbols_failing():
352.     rho, mass, volume = symbols('rho, mass, volume')
353.     assert latex(
354.         volume * rho == mass) == r"\rho \mathrm{volume} = \mathrm{mass}"
355.     assert latex(volume / mass * rho == 1) == \
356.         r"\rho \mathrm{volume} {\mathrm{mass}}^{(-1)} = 1"
357.     assert latex(mass**3 * volume**3) == \
358.         r"{\mathrm{mass}}^{3} \cdot {\mathrm{volume}}^{3}"
359. 
360. 
361. @_both_exp_pow
362. def test_latex_functions():
363.     assert latex(exp(x)) == r"e^{x}"
364.     assert latex(exp(1) + exp(2)) == r"e + e^{2}"
365. 
366.     f = Function('f')
367.     assert latex(f(x)) == r'f{\left(x \right)}'
368.     assert latex(f) == r'f'
369. 
370.     g = Function('g')
371.     assert latex(g(x, y)) == r'g{\left(x,y \right)}'
372.     assert latex(g) == r'g'
373. 
374.     h = Function('h')
375.     assert latex(h(x, y, z)) == r'h{\left(x,y,z \right)}'
376.     assert latex(h) == r'h'
377. 
378.     Li = Function('Li')
379.     assert latex(Li) == r'\operatorname{Li}'
380.     assert latex(Li(x)) == r'\operatorname{Li}{\left(x \right)}'
381. 
382.     mybeta = Function('beta')
383.     # not to be confused with the beta function
384.     assert latex(mybeta(x, y, z)) == r"\beta{\left(x,y,z \right)}"
385.     assert latex(beta(x, y)) == r'\operatorname{B}\left(x, y\right)'
386.     assert latex(beta(x, y)**2) == r'\operatorname{B}^{2}\left(x, y\right)'
387.     assert latex(mybeta(x)) == r"\beta{\left(x \right)}"
388.     assert latex(mybeta) == r"\beta"
389. 
390.     g = Function('gamma')
391.     # not to be confused with the gamma function
392.     assert latex(g(x, y, z)) == r"\gamma{\left(x,y,z \right)}"
393.     assert latex(g(x)) == r"\gamma{\left(x \right)}"
394.     assert latex(g) == r"\gamma"
395. 
396.     a1 = Function('a_1')
397. 
398.     assert latex(a1) == r"\operatorname{a_{1}}"
399.     assert latex(a1(x)) == r"\operatorname{a_{1}}{\left(x \right)}"
400. 
401.     # issue 5868
402.     omega1 = Function('omega1')
403.     assert latex(omega1) == r"\omega_{1}"
404.     assert latex(omega1(x)) == r"\omega_{1}{\left(x \right)}"
405. 
406.     assert latex(sin(x)) == r"\sin{\left(x \right)}"
407.     assert latex(sin(x), fold_func_brackets=True) == r"\sin {x}"
408.     assert latex(sin(2*x**2), fold_func_brackets=True) == \
409.         r"\sin {2 x^{2}}"
410.     assert latex(sin(x**2), fold_func_brackets=True) == \
411.         r"\sin {x^{2}}"
412. 
413.     assert latex(asin(x)**2) == r"\operatorname{asin}^{2}{\left(x \right)}"
414.     assert latex(asin(x)**2, inv_trig_style="full") == \
415.         r"\arcsin^{2}{\left(x \right)}"
416.     assert latex(asin(x)**2, inv_trig_style="power") == \
417.         r"\sin^{-1}{\left(x \right)}^{2}"
418.     assert latex(asin(x**2), inv_trig_style="power",
419.                  fold_func_brackets=True) == \
420.         r"\sin^{-1} {x^{2}}"
421.     assert latex(acsc(x), inv_trig_style="full") == \
422.         r"\operatorname{arccsc}{\left(x \right)}"
423.     assert latex(asinh(x), inv_trig_style="full") == \
424.         r"\operatorname{arcsinh}{\left(x \right)}"
425. 
426.     assert latex(factorial(k)) == r"k!"
427.     assert latex(factorial(-k)) == r"\left(- k\right)!"
428.     assert latex(factorial(k)**2) == r"k!^{2}"
429. 
430.     assert latex(subfactorial(k)) == r"!k"
431.     assert latex(subfactorial(-k)) == r"!\left(- k\right)"
432.     assert latex(subfactorial(k)**2) == r"\left(!k\right)^{2}"
433. 
434.     assert latex(factorial2(k)) == r"k!!"
435.     assert latex(factorial2(-k)) == r"\left(- k\right)!!"
436.     assert latex(factorial2(k)**2) == r"k!!^{2}"
437. 
438.     assert latex(binomial(2, k)) == r"{\binom{2}{k}}"
439.     assert latex(binomial(2, k)**2) == r"{\binom{2}{k}}^{2}"
440. 
441.     assert latex(FallingFactorial(3, k)) == r"{\left(3\right)}_{k}"
442.     assert latex(RisingFactorial(3, k)) == r"{3}^{\left(k\right)}"
443. 
444.     assert latex(floor(x)) == r"\left\lfloor{x}\right\rfloor"
445.     assert latex(ceiling(x)) == r"\left\lceil{x}\right\rceil"
446.     assert latex(frac(x)) == r"\operatorname{frac}{\left(x\right)}"
447.     assert latex(floor(x)**2) == r"\left\lfloor{x}\right\rfloor^{2}"
448.     assert latex(ceiling(x)**2) == r"\left\lceil{x}\right\rceil^{2}"
449.     assert latex(frac(x)**2) == r"\operatorname{frac}{\left(x\right)}^{2}"
450. 
451.     assert latex(Min(x, 2, x**3)) == r"\min\left(2, x, x^{3}\right)"
452.     assert latex(Min(x, y)**2) == r"\min\left(x, y\right)^{2}"
453.     assert latex(Max(x, 2, x**3)) == r"\max\left(2, x, x^{3}\right)"
454.     assert latex(Max(x, y)**2) == r"\max\left(x, y\right)^{2}"
455.     assert latex(Abs(x)) == r"\left|{x}\right|"
456.     assert latex(Abs(x)**2) == r"\left|{x}\right|^{2}"
457.     assert latex(re(x)) == r"\operatorname{re}{\left(x\right)}"
458.     assert latex(re(x + y)) == \
459.         r"\operatorname{re}{\left(x\right)} + \operatorname{re}{\left(y\right)}"
460.     assert latex(im(x)) == r"\operatorname{im}{\left(x\right)}"
461.     assert latex(conjugate(x)) == r"\overline{x}"
462.     assert latex(conjugate(x)**2) == r"\overline{x}^{2}"
463.     assert latex(conjugate(x**2)) == r"\overline{x}^{2}"
464.     assert latex(gamma(x)) == r"\Gamma\left(x\right)"
465.     w = Wild('w')
466.     assert latex(gamma(w)) == r"\Gamma\left(w\right)"
467.     assert latex(Order(x)) == r"O\left(x\right)"
468.     assert latex(Order(x, x)) == r"O\left(x\right)"
469.     assert latex(Order(x, (x, 0))) == r"O\left(x\right)"
470.     assert latex(Order(x, (x, oo))) == r"O\left(x; x\rightarrow \infty\right)"
471.     assert latex(Order(x - y, (x, y))) == \
472.         r"O\left(x - y; x\rightarrow y\right)"
473.     assert latex(Order(x, x, y)) == \
474.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( 0, \  0\right)\right)"
475.     assert latex(Order(x, x, y)) == \
476.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( 0, \  0\right)\right)"
477.     assert latex(Order(x, (x, oo), (y, oo))) == \
478.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( \infty, \  \infty\right)\right)"
479.     assert latex(lowergamma(x, y)) == r'\gamma\left(x, y\right)'
480.     assert latex(lowergamma(x, y)**2) == r'\gamma^{2}\left(x, y\right)'
481.     assert latex(uppergamma(x, y)) == r'\Gamma\left(x, y\right)'
482.     assert latex(uppergamma(x, y)**2) == r'\Gamma^{2}\left(x, y\right)'
483. 
484.     assert latex(cot(x)) == r'\cot{\left(x \right)}'
485.     assert latex(coth(x)) == r'\coth{\left(x \right)}'
486.     assert latex(re(x)) == r'\operatorname{re}{\left(x\right)}'
487.     assert latex(im(x)) == r'\operatorname{im}{\left(x\right)}'
488.     assert latex(root(x, y)) == r'x^{\frac{1}{y}}'
489.     assert latex(arg(x)) == r'\arg{\left(x \right)}'
490. 
491.     assert latex(zeta(x)) == r"\zeta\left(x\right)"
492.     assert latex(zeta(x)**2) == r"\zeta^{2}\left(x\right)"
493.     assert latex(zeta(x, y)) == r"\zeta\left(x, y\right)"
494.     assert latex(zeta(x, y)**2) == r"\zeta^{2}\left(x, y\right)"
495.     assert latex(dirichlet_eta(x)) == r"\eta\left(x\right)"
496.     assert latex(dirichlet_eta(x)**2) == r"\eta^{2}\left(x\right)"
497.     assert latex(polylog(x, y)) == r"\operatorname{Li}_{x}\left(y\right)"
498.     assert latex(
499.         polylog(x, y)**2) == r"\operatorname{Li}_{x}^{2}\left(y\right)"
500.     assert latex(lerchphi(x, y, n)) == r"\Phi\left(x, y, n\right)"

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 03:00:50,537 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user is reporting a bug related to the LaTeX printing of objects from the `secondquant` module. The provided context, `sympy/printing/tests/test_latex.py`, contains general printing tests but lacks specific tests for `secondquant` objects like `Bd` which are central to the bug report. While `test_latex_SingularityFunction` is partially relevant as it tests powers of expressions containing superscripts, it's not a direct match for the user's scenario. To find the most relevant test cases that replicate the bug, I need to examine the tests for the `secondquant` module itself." query='Please provide the content of the file `sympy/physics/tests/test_secondquant.py`.' extra_requirements='If the file is large, please prioritize any tests that verify the LaTeX output of `secondquant` objects, especially those involving powers of operators.' purpose='I need this file to find test cases that use the `Bd` operator and check its LaTeX representation when raised to a power, which is the core of the reported issue.'
2025-12-21 03:00:50,538 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the content of the file `sympy/physics/tests/test_secondquant.py`.
2025-12-21 03:00:50,538 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 03:00:50,539 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 03:00:50,539 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 03:00:50,539 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the content of the file `sympy/physics/tests/test_secondquant.py`.
Extra requirements: If the file is large, please prioritize any tests that verify the LaTeX output of `secondquant` objects, especially those involving powers of operators.
Purpose: I need this file to find test cases that use the `Bd` operator and check its LaTeX representation when raised to a power, which is the core of the reported issue.
2025-12-21 03:00:53,379 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will first read the specified file to get an overview of its contents. Then, I will specifically look for any tests that are related to LaTeX output to narrow down the code for you.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/physics/tests/test_secondquant.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2157, 'candidates_token_count': 64, 'total_token_count': 2402, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2157}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 181, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.31086447834968567, 'model_name': 'gemini-2.5-pro'} id='run--8f8cefe0-372c-45a4-bdcc-caf451d2a9a5-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/physics/tests/test_secondquant.py'}, 'id': 'a169d917-06ae-4a7f-8bb1-2a8ad20ffcb7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2157, 'output_tokens': 64, 'total_tokens': 2402, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 181}}
2025-12-21 03:00:59,588 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the file `sympy/physics/tests/test_secondquant.py` and identified the test functions that are most relevant to your query. I focused on tests that verify the LaTeX output of `secondquant` objects, particularly those involving powers of operators like `Bd`. The `test_dagger` and `test_create` functions appear to be the most pertinent, as they deal with operator powers and the LaTeX representation of the `Bd` operator.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 106.0, "relative_path": "sympy/physics/tests/test_secondquant.py", "start_line": 65.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12262, 'candidates_token_count': 127, 'total_token_count': 12901, 'cached_content_token_count': 1898, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12262}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1898}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 127}], 'thoughts_token_count': 512}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3562813405915508, 'model_name': 'gemini-2.5-pro'} id='run--8d573bdd-597c-453a-9000-0fca83935233-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 106.0, 'relative_path': 'sympy/physics/tests/test_secondquant.py', 'start_line': 65.0}, 'id': '7a82c03f-b7ee-4b7f-988c-fe5699b05ba8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12262, 'output_tokens': 127, 'total_tokens': 12901, 'input_token_details': {'cache_read': 1898}, 'output_token_details': {'reasoning': 512}}
2025-12-21 03:01:04,924 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have examined the `test_secondquant.py` file and found the `test_dagger` and `test_create` functions. The `test_dagger` function includes a test for the dagger of an operator raised to a power, and the `test_create` function checks the LaTeX representation of the `Bd` operator. However, I could not find a test case that specifically verifies the LaTeX output for a power of the `Bd` operator.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13184, 'candidates_token_count': 94, 'total_token_count': 13742, 'cached_content_token_count': 11403, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13184}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11403}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 94}], 'thoughts_token_count': 464}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4099938412930103, 'model_name': 'gemini-2.5-pro'} id='run--594f8cd4-124d-43df-8a84-5cef589c9a02-0' usage_metadata={'input_tokens': 13184, 'output_tokens': 94, 'total_tokens': 13742, 'input_token_details': {'cache_read': 11403}, 'output_token_details': {'reasoning': 464}}
2025-12-21 03:01:04,926 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the content of the file `sympy/physics/tests/test_secondquant.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is large, please prioritize any tests that verify the LaTeX output of `secondquant` objects, especially those involving powers of operators.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need this file to find test cases that use the `Bd` operator and check its LaTeX representation when raised to a power, which is the core of the reported issue.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/physics/tests/test_secondquant.py
Line number range: 1 - 500
Content:
1. from sympy.physics.secondquant import (
2.     Dagger, Bd, VarBosonicBasis, BBra, B, BKet, FixedBosonicBasis,
3.     matrix_rep, apply_operators, InnerProduct, Commutator, KroneckerDelta,
4.     AnnihilateBoson, CreateBoson, BosonicOperator,
5.     F, Fd, FKet, BosonState, CreateFermion, AnnihilateFermion,
6.     evaluate_deltas, AntiSymmetricTensor, contraction, NO, wicks,
7.     PermutationOperator, simplify_index_permutations,
8.     _sort_anticommuting_fermions, _get_ordered_dummies,
9.     substitute_dummies, FockStateBosonKet,
10.     ContractionAppliesOnlyToFermions
11. )
12. 
13. from sympy import (Dummy, expand, Function, I, S, simplify, sqrt, Sum,
14.                    Symbol, symbols, srepr, Rational)
15. 
16. from sympy.testing.pytest import slow, raises
17. from sympy.printing.latex import latex
18. 
19. 
20. def test_PermutationOperator():
21.     p, q, r, s = symbols('p,q,r,s')
22.     f, g, h, i = map(Function, 'fghi')
23.     P = PermutationOperator
24.     assert P(p, q).get_permuted(f(p)*g(q)) == -f(q)*g(p)
25.     assert P(p, q).get_permuted(f(p, q)) == -f(q, p)
26.     assert P(p, q).get_permuted(f(p)) == f(p)
27.     expr = (f(p)*g(q)*h(r)*i(s)
28.         - f(q)*g(p)*h(r)*i(s)
29.         - f(p)*g(q)*h(s)*i(r)
30.         + f(q)*g(p)*h(s)*i(r))
31.     perms = [P(p, q), P(r, s)]
32.     assert (simplify_index_permutations(expr, perms) ==
33.         P(p, q)*P(r, s)*f(p)*g(q)*h(r)*i(s))
34.     assert latex(P(p, q)) == 'P(pq)'
35. 
36. 
37. def test_index_permutations_with_dummies():
38.     a, b, c, d = symbols('a b c d')
39.     p, q, r, s = symbols('p q r s', cls=Dummy)
40.     f, g = map(Function, 'fg')
41.     P = PermutationOperator
42. 
43.     # No dummy substitution necessary
44.     expr = f(a, b, p, q) - f(b, a, p, q)
45.     assert simplify_index_permutations(
46.         expr, [P(a, b)]) == P(a, b)*f(a, b, p, q)
47. 
48.     # Cases where dummy substitution is needed
49.     expected = P(a, b)*substitute_dummies(f(a, b, p, q))
50. 
51.     expr = f(a, b, p, q) - f(b, a, q, p)
52.     result = simplify_index_permutations(expr, [P(a, b)])
53.     assert expected == substitute_dummies(result)
54. 
55.     expr = f(a, b, q, p) - f(b, a, p, q)
56.     result = simplify_index_permutations(expr, [P(a, b)])
57.     assert expected == substitute_dummies(result)
58. 
59.     # A case where nothing can be done
60.     expr = f(a, b, q, p) - g(b, a, p, q)
61.     result = simplify_index_permutations(expr, [P(a, b)])
62.     assert expr == result
63. 
64. 
65. def test_dagger():
66.     i, j, n, m = symbols('i,j,n,m')
67.     assert Dagger(1) == 1
68.     assert Dagger(1.0) == 1.0
69.     assert Dagger(2*I) == -2*I
70.     assert Dagger(S.Half*I/3.0) == I*Rational(-1, 2)/3.0
71.     assert Dagger(BKet([n])) == BBra([n])
72.     assert Dagger(B(0)) == Bd(0)
73.     assert Dagger(Bd(0)) == B(0)
74.     assert Dagger(B(n)) == Bd(n)
75.     assert Dagger(Bd(n)) == B(n)
76.     assert Dagger(B(0) + B(1)) == Bd(0) + Bd(1)
77.     assert Dagger(n*m) == Dagger(n)*Dagger(m)  # n, m commute
78.     assert Dagger(B(n)*B(m)) == Bd(m)*Bd(n)
79.     assert Dagger(B(n)**10) == Dagger(B(n))**10
80.     assert Dagger('a') == Dagger(Symbol('a'))
81.     assert Dagger(Dagger('a')) == Symbol('a')
82. 
83. 
84. def test_operator():
85.     i, j = symbols('i,j')
86.     o = BosonicOperator(i)
87.     assert o.state == i
88.     assert o.is_symbolic
89.     o = BosonicOperator(1)
90.     assert o.state == 1
91.     assert not o.is_symbolic
92. 
93. 
94. def test_create():
95.     i, j, n, m = symbols('i,j,n,m')
96.     o = Bd(i)
97.     assert latex(o) == "b^\\dagger_{i}"
98.     assert isinstance(o, CreateBoson)
99.     o = o.subs(i, j)
100.     assert o.atoms(Symbol) == {j}
101.     o = Bd(0)
102.     assert o.apply_operator(BKet([n])) == sqrt(n + 1)*BKet([n + 1])
103.     o = Bd(n)
104.     assert o.apply_operator(BKet([n])) == o*BKet([n])
105. 
106. 
107. def test_annihilate():
108.     i, j, n, m = symbols('i,j,n,m')
109.     o = B(i)
110.     assert latex(o) == "b_{i}"
111.     assert isinstance(o, AnnihilateBoson)
112.     o = o.subs(i, j)
113.     assert o.atoms(Symbol) == {j}
114.     o = B(0)
115.     assert o.apply_operator(BKet([n])) == sqrt(n)*BKet([n - 1])
116.     o = B(n)
117.     assert o.apply_operator(BKet([n])) == o*BKet([n])
118. 
119. 
120. def test_basic_state():
121.     i, j, n, m = symbols('i,j,n,m')
122.     s = BosonState([0, 1, 2, 3, 4])
123.     assert len(s) == 5
124.     assert s.args[0] == tuple(range(5))
125.     assert s.up(0) == BosonState([1, 1, 2, 3, 4])
126.     assert s.down(4) == BosonState([0, 1, 2, 3, 3])
127.     for i in range(5):
128.         assert s.up(i).down(i) == s
129.     assert s.down(0) == 0
130.     for i in range(5):
131.         assert s[i] == i
132.     s = BosonState([n, m])
133.     assert s.down(0) == BosonState([n - 1, m])
134.     assert s.up(0) == BosonState([n + 1, m])
135. 
136. 
137. def test_basic_apply():
138.     n = symbols("n")
139.     e = B(0)*BKet([n])
140.     assert apply_operators(e) == sqrt(n)*BKet([n - 1])
141.     e = Bd(0)*BKet([n])
142.     assert apply_operators(e) == sqrt(n + 1)*BKet([n + 1])
143. 
144. 
145. def test_complex_apply():
146.     n, m = symbols("n,m")
147.     o = Bd(0)*B(0)*Bd(1)*B(0)
148.     e = apply_operators(o*BKet([n, m]))
149.     answer = sqrt(n)*sqrt(m + 1)*(-1 + n)*BKet([-1 + n, 1 + m])
150.     assert expand(e) == expand(answer)
151. 
152. 
153. def test_number_operator():
154.     n = symbols("n")
155.     o = Bd(0)*B(0)
156.     e = apply_operators(o*BKet([n]))
157.     assert e == n*BKet([n])
158. 
159. 
160. def test_inner_product():
161.     i, j, k, l = symbols('i,j,k,l')
162.     s1 = BBra([0])
163.     s2 = BKet([1])
164.     assert InnerProduct(s1, Dagger(s1)) == 1
165.     assert InnerProduct(s1, s2) == 0
166.     s1 = BBra([i, j])
167.     s2 = BKet([k, l])
168.     r = InnerProduct(s1, s2)
169.     assert r == KroneckerDelta(i, k)*KroneckerDelta(j, l)
170. 
171. 
172. def test_symbolic_matrix_elements():
173.     n, m = symbols('n,m')
174.     s1 = BBra([n])
175.     s2 = BKet([m])
176.     o = B(0)
177.     e = apply_operators(s1*o*s2)
178.     assert e == sqrt(m)*KroneckerDelta(n, m - 1)
179. 
180. 
181. def test_matrix_elements():
182.     b = VarBosonicBasis(5)
183.     o = B(0)
184.     m = matrix_rep(o, b)
185.     for i in range(4):
186.         assert m[i, i + 1] == sqrt(i + 1)
187.     o = Bd(0)
188.     m = matrix_rep(o, b)
189.     for i in range(4):
190.         assert m[i + 1, i] == sqrt(i + 1)
191. 
192. 
193. def test_fixed_bosonic_basis():
194.     b = FixedBosonicBasis(2, 2)
195.     # assert b == [FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]
196.     state = b.state(1)
197.     assert state == FockStateBosonKet((1, 1))
198.     assert b.index(state) == 1
199.     assert b.state(1) == b[1]
200.     assert len(b) == 3
201.     assert str(b) == '[FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]'
202.     assert repr(b) == '[FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]'
203.     assert srepr(b) == '[FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]'
204. 
205. 
206. @slow
207. def test_sho():
208.     n, m = symbols('n,m')
209.     h_n = Bd(n)*B(n)*(n + S.Half)
210.     H = Sum(h_n, (n, 0, 5))
211.     o = H.doit(deep=False)
212.     b = FixedBosonicBasis(2, 6)
213.     m = matrix_rep(o, b)
214.     # We need to double check these energy values to make sure that they
215.     # are correct and have the proper degeneracies!
216.     diag = [1, 2, 3, 3, 4, 5, 4, 5, 6, 7, 5, 6, 7, 8, 9, 6, 7, 8, 9, 10, 11]
217.     for i in range(len(diag)):
218.         assert diag[i] == m[i, i]
219. 
220. 
221. def test_commutation():
222.     n, m = symbols("n,m", above_fermi=True)
223.     c = Commutator(B(0), Bd(0))
224.     assert c == 1
225.     c = Commutator(Bd(0), B(0))
226.     assert c == -1
227.     c = Commutator(B(n), Bd(0))
228.     assert c == KroneckerDelta(n, 0)
229.     c = Commutator(B(0), B(0))
230.     assert c == 0
231.     c = Commutator(B(0), Bd(0))
232.     e = simplify(apply_operators(c*BKet([n])))
233.     assert e == BKet([n])
234.     c = Commutator(B(0), B(1))
235.     e = simplify(apply_operators(c*BKet([n, m])))
236.     assert e == 0
237. 
238.     c = Commutator(F(m), Fd(m))
239.     assert c == +1 - 2*NO(Fd(m)*F(m))
240.     c = Commutator(Fd(m), F(m))
241.     assert c.expand() == -1 + 2*NO(Fd(m)*F(m))
242. 
243.     C = Commutator
244.     X, Y, Z = symbols('X,Y,Z', commutative=False)
245.     assert C(C(X, Y), Z) != 0
246.     assert C(C(X, Z), Y) != 0
247.     assert C(Y, C(X, Z)) != 0
248. 
249.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
250.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
251.     p, q, r, s = symbols('p,q,r,s')
252.     D = KroneckerDelta
253. 
254.     assert C(Fd(a), F(i)) == -2*NO(F(i)*Fd(a))
255.     assert C(Fd(j), NO(Fd(a)*F(i))).doit(wicks=True) == -D(j, i)*Fd(a)
256.     assert C(Fd(a)*F(i), Fd(b)*F(j)).doit(wicks=True) == 0
257. 
258.     c1 = Commutator(F(a), Fd(a))
259.     assert Commutator.eval(c1, c1) == 0
260.     c = Commutator(Fd(a)*F(i),Fd(b)*F(j))
261.     assert latex(c) == r'\left[a^\dagger_{a} a_{i},a^\dagger_{b} a_{j}\right]'
262.     assert repr(c) == 'Commutator(CreateFermion(a)*AnnihilateFermion(i),CreateFermion(b)*AnnihilateFermion(j))'
263.     assert str(c) == '[CreateFermion(a)*AnnihilateFermion(i),CreateFermion(b)*AnnihilateFermion(j)]'
264. 
265. 
266. def test_create_f():
267.     i, j, n, m = symbols('i,j,n,m')
268.     o = Fd(i)
269.     assert isinstance(o, CreateFermion)
270.     o = o.subs(i, j)
271.     assert o.atoms(Symbol) == {j}
272.     o = Fd(1)
273.     assert o.apply_operator(FKet([n])) == FKet([1, n])
274.     assert o.apply_operator(FKet([n])) == -FKet([n, 1])
275.     o = Fd(n)
276.     assert o.apply_operator(FKet([])) == FKet([n])
277. 
278.     vacuum = FKet([], fermi_level=4)
279.     assert vacuum == FKet([], fermi_level=4)
280. 
281.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
282.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
283.     p, q, r, s = symbols('p,q,r,s')
284. 
285.     assert Fd(i).apply_operator(FKet([i, j, k], 4)) == FKet([j, k], 4)
286.     assert Fd(a).apply_operator(FKet([i, b, k], 4)) == FKet([a, i, b, k], 4)
287. 
288.     assert Dagger(B(p)).apply_operator(q) == q*CreateBoson(p)
289.     assert repr(Fd(p)) == 'CreateFermion(p)'
290.     assert srepr(Fd(p)) == "CreateFermion(Symbol('p'))"
291.     assert latex(Fd(p)) == r'a^\dagger_{p}'
292. 
293. 
294. def test_annihilate_f():
295.     i, j, n, m = symbols('i,j,n,m')
296.     o = F(i)
297.     assert isinstance(o, AnnihilateFermion)
298.     o = o.subs(i, j)
299.     assert o.atoms(Symbol) == {j}
300.     o = F(1)
301.     assert o.apply_operator(FKet([1, n])) == FKet([n])
302.     assert o.apply_operator(FKet([n, 1])) == -FKet([n])
303.     o = F(n)
304.     assert o.apply_operator(FKet([n])) == FKet([])
305. 
306.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
307.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
308.     p, q, r, s = symbols('p,q,r,s')
309.     assert F(i).apply_operator(FKet([i, j, k], 4)) == 0
310.     assert F(a).apply_operator(FKet([i, b, k], 4)) == 0
311.     assert F(l).apply_operator(FKet([i, j, k], 3)) == 0
312.     assert F(l).apply_operator(FKet([i, j, k], 4)) == FKet([l, i, j, k], 4)
313.     assert str(F(p)) == 'f(p)'
314.     assert repr(F(p)) == 'AnnihilateFermion(p)'
315.     assert srepr(F(p)) == "AnnihilateFermion(Symbol('p'))"
316.     assert latex(F(p)) == 'a_{p}'
317. 
318. 
319. def test_create_b():
320.     i, j, n, m = symbols('i,j,n,m')
321.     o = Bd(i)
322.     assert isinstance(o, CreateBoson)
323.     o = o.subs(i, j)
324.     assert o.atoms(Symbol) == {j}
325.     o = Bd(0)
326.     assert o.apply_operator(BKet([n])) == sqrt(n + 1)*BKet([n + 1])
327.     o = Bd(n)
328.     assert o.apply_operator(BKet([n])) == o*BKet([n])
329. 
330. 
331. def test_annihilate_b():
332.     i, j, n, m = symbols('i,j,n,m')
333.     o = B(i)
334.     assert isinstance(o, AnnihilateBoson)
335.     o = o.subs(i, j)
336.     assert o.atoms(Symbol) == {j}
337.     o = B(0)
338. 
339. 
340. def test_wicks():
341.     p, q, r, s = symbols('p,q,r,s', above_fermi=True)
342. 
343.     # Testing for particles only
344. 
345.     str = F(p)*Fd(q)
346.     assert wicks(str) == NO(F(p)*Fd(q)) + KroneckerDelta(p, q)
347.     str = Fd(p)*F(q)
348.     assert wicks(str) == NO(Fd(p)*F(q))
349. 
350.     str = F(p)*Fd(q)*F(r)*Fd(s)
351.     nstr = wicks(str)
352.     fasit = NO(
353.         KroneckerDelta(p, q)*KroneckerDelta(r, s)
354.         + KroneckerDelta(p, q)*AnnihilateFermion(r)*CreateFermion(s)
355.         + KroneckerDelta(r, s)*AnnihilateFermion(p)*CreateFermion(q)
356.         - KroneckerDelta(p, s)*AnnihilateFermion(r)*CreateFermion(q)
357.         - AnnihilateFermion(p)*AnnihilateFermion(r)*CreateFermion(q)*CreateFermion(s))
358.     assert nstr == fasit
359. 
360.     assert (p*q*nstr).expand() == wicks(p*q*str)
361.     assert (nstr*p*q*2).expand() == wicks(str*p*q*2)
362. 
363.     # Testing CC equations particles and holes
364.     i, j, k, l = symbols('i j k l', below_fermi=True, cls=Dummy)
365.     a, b, c, d = symbols('a b c d', above_fermi=True, cls=Dummy)
366.     p, q, r, s = symbols('p q r s', cls=Dummy)
367. 
368.     assert (wicks(F(a)*NO(F(i)*F(j))*Fd(b)) ==
369.             NO(F(a)*F(i)*F(j)*Fd(b)) +
370.             KroneckerDelta(a, b)*NO(F(i)*F(j)))
371.     assert (wicks(F(a)*NO(F(i)*F(j)*F(k))*Fd(b)) ==
372.             NO(F(a)*F(i)*F(j)*F(k)*Fd(b)) -
373.             KroneckerDelta(a, b)*NO(F(i)*F(j)*F(k)))
374. 
375.     expr = wicks(Fd(i)*NO(Fd(j)*F(k))*F(l))
376.     assert (expr ==
377.            -KroneckerDelta(i, k)*NO(Fd(j)*F(l)) -
378.             KroneckerDelta(j, l)*NO(Fd(i)*F(k)) -
379.             KroneckerDelta(i, k)*KroneckerDelta(j, l) +
380.             KroneckerDelta(i, l)*NO(Fd(j)*F(k)) +
381.             NO(Fd(i)*Fd(j)*F(k)*F(l)))
382.     expr = wicks(F(a)*NO(F(b)*Fd(c))*Fd(d))
383.     assert (expr ==
384.            -KroneckerDelta(a, c)*NO(F(b)*Fd(d)) -
385.             KroneckerDelta(b, d)*NO(F(a)*Fd(c)) -
386.             KroneckerDelta(a, c)*KroneckerDelta(b, d) +
387.             KroneckerDelta(a, d)*NO(F(b)*Fd(c)) +
388.             NO(F(a)*F(b)*Fd(c)*Fd(d)))
389. 
390. 
391. def test_NO():
392.     i, j, k, l = symbols('i j k l', below_fermi=True)
393.     a, b, c, d = symbols('a b c d', above_fermi=True)
394.     p, q, r, s = symbols('p q r s', cls=Dummy)
395. 
396.     assert (NO(Fd(p)*F(q) + Fd(a)*F(b)) ==
397.        NO(Fd(p)*F(q)) + NO(Fd(a)*F(b)))
398.     assert (NO(Fd(i)*NO(F(j)*Fd(a))) ==
399.        NO(Fd(i)*F(j)*Fd(a)))
400.     assert NO(1) == 1
401.     assert NO(i) == i
402.     assert (NO(Fd(a)*Fd(b)*(F(c) + F(d))) ==
403.             NO(Fd(a)*Fd(b)*F(c)) +
404.             NO(Fd(a)*Fd(b)*F(d)))
405. 
406.     assert NO(Fd(a)*F(b))._remove_brackets() == Fd(a)*F(b)
407.     assert NO(F(j)*Fd(i))._remove_brackets() == F(j)*Fd(i)
408. 
409.     assert (NO(Fd(p)*F(q)).subs(Fd(p), Fd(a) + Fd(i)) ==
410.             NO(Fd(a)*F(q)) + NO(Fd(i)*F(q)))
411.     assert (NO(Fd(p)*F(q)).subs(F(q), F(a) + F(i)) ==
412.             NO(Fd(p)*F(a)) + NO(Fd(p)*F(i)))
413. 
414.     expr = NO(Fd(p)*F(q))._remove_brackets()
415.     assert wicks(expr) == NO(expr)
416. 
417.     assert NO(Fd(a)*F(b)) == - NO(F(b)*Fd(a))
418. 
419.     no = NO(Fd(a)*F(i)*F(b)*Fd(j))
420.     l1 = [ ind for ind in no.iter_q_creators() ]
421.     assert l1 == [0, 1]
422.     l2 = [ ind for ind in no.iter_q_annihilators() ]
423.     assert l2 == [3, 2]
424.     no = NO(Fd(a)*Fd(i))
425.     assert no.has_q_creators == 1
426.     assert no.has_q_annihilators == -1
427.     assert str(no) == ':CreateFermion(a)*CreateFermion(i):'
428.     assert repr(no) == 'NO(CreateFermion(a)*CreateFermion(i))'
429.     assert latex(no) == r'\left\{a^\dagger_{a} a^\dagger_{i}\right\}'
430.     raises(NotImplementedError, lambda:  NO(Bd(p)*F(q)))
431. 
432. 
433. def test_sorting():
434.     i, j = symbols('i,j', below_fermi=True)
435.     a, b = symbols('a,b', above_fermi=True)
436.     p, q = symbols('p,q')
437. 
438.     # p, q
439.     assert _sort_anticommuting_fermions([Fd(p), F(q)]) == ([Fd(p), F(q)], 0)
440.     assert _sort_anticommuting_fermions([F(p), Fd(q)]) == ([Fd(q), F(p)], 1)
441. 
442.     # i, p
443.     assert _sort_anticommuting_fermions([F(p), Fd(i)]) == ([F(p), Fd(i)], 0)
444.     assert _sort_anticommuting_fermions([Fd(i), F(p)]) == ([F(p), Fd(i)], 1)
445.     assert _sort_anticommuting_fermions([Fd(p), Fd(i)]) == ([Fd(p), Fd(i)], 0)
446.     assert _sort_anticommuting_fermions([Fd(i), Fd(p)]) == ([Fd(p), Fd(i)], 1)
447.     assert _sort_anticommuting_fermions([F(p), F(i)]) == ([F(i), F(p)], 1)
448.     assert _sort_anticommuting_fermions([F(i), F(p)]) == ([F(i), F(p)], 0)
449.     assert _sort_anticommuting_fermions([Fd(p), F(i)]) == ([F(i), Fd(p)], 1)
450.     assert _sort_anticommuting_fermions([F(i), Fd(p)]) == ([F(i), Fd(p)], 0)
451. 
452.     # a, p
453.     assert _sort_anticommuting_fermions([F(p), Fd(a)]) == ([Fd(a), F(p)], 1)
454.     assert _sort_anticommuting_fermions([Fd(a), F(p)]) == ([Fd(a), F(p)], 0)
455.     assert _sort_anticommuting_fermions([Fd(p), Fd(a)]) == ([Fd(a), Fd(p)], 1)
456.     assert _sort_anticommuting_fermions([Fd(a), Fd(p)]) == ([Fd(a), Fd(p)], 0)
457.     assert _sort_anticommuting_fermions([F(p), F(a)]) == ([F(p), F(a)], 0)
458.     assert _sort_anticommuting_fermions([F(a), F(p)]) == ([F(p), F(a)], 1)
459.     assert _sort_anticommuting_fermions([Fd(p), F(a)]) == ([Fd(p), F(a)], 0)
460.     assert _sort_anticommuting_fermions([F(a), Fd(p)]) == ([Fd(p), F(a)], 1)
461. 
462.     # i, a
463.     assert _sort_anticommuting_fermions([F(i), Fd(j)]) == ([F(i), Fd(j)], 0)
464.     assert _sort_anticommuting_fermions([Fd(j), F(i)]) == ([F(i), Fd(j)], 1)
465.     assert _sort_anticommuting_fermions([Fd(a), Fd(i)]) == ([Fd(a), Fd(i)], 0)
466.     assert _sort_anticommuting_fermions([Fd(i), Fd(a)]) == ([Fd(a), Fd(i)], 1)
467.     assert _sort_anticommuting_fermions([F(a), F(i)]) == ([F(i), F(a)], 1)
468.     assert _sort_anticommuting_fermions([F(i), F(a)]) == ([F(i), F(a)], 0)
469. 
470. 
471. def test_contraction():
472.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
473.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
474.     p, q, r, s = symbols('p,q,r,s')
475.     assert contraction(Fd(i), F(j)) == KroneckerDelta(i, j)
476.     assert contraction(F(a), Fd(b)) == KroneckerDelta(a, b)
477.     assert contraction(F(a), Fd(i)) == 0
478.     assert contraction(Fd(a), F(i)) == 0
479.     assert contraction(F(i), Fd(a)) == 0
480.     assert contraction(Fd(i), F(a)) == 0
481.     assert contraction(Fd(i), F(p)) == KroneckerDelta(i, p)
482.     restr = evaluate_deltas(contraction(Fd(p), F(q)))
483.     assert restr.is_only_below_fermi
484.     restr = evaluate_deltas(contraction(F(p), Fd(q)))
485.     assert restr.is_only_above_fermi
486.     raises(ContractionAppliesOnlyToFermions, lambda: contraction(B(a), Fd(b)))
487. 
488. 
489. def test_evaluate_deltas():
490.     i, j, k = symbols('i,j,k')
491. 
492.     r = KroneckerDelta(i, j) * KroneckerDelta(j, k)
493.     assert evaluate_deltas(r) == KroneckerDelta(i, k)
494. 
495.     r = KroneckerDelta(i, 0) * KroneckerDelta(j, k)
496.     assert evaluate_deltas(r) == KroneckerDelta(i, 0) * KroneckerDelta(j, k)
497. 
498.     r = KroneckerDelta(1, j) * KroneckerDelta(j, k)
499.     assert evaluate_deltas(r) == KroneckerDelta(1, k)
500.

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 03:01:44,043 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user requested the content of the file `sympy/physics/tests/test_secondquant.py`.\n   - This context provides the entire visible content of the requested file.\n2. Extended relevance:\n   - Providing the full file content directly addresses the primary user query. It contains all tests, including those for LaTeX output and operators like `Bd`, allowing the user to have the complete context they asked for.', relative_path='sympy/physics/tests/test_secondquant.py', start_line=1, end_line=500), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is specifically interested in tests for the LaTeX output of `secondquant` objects, particularly the `Bd` operator.\n2. Extended relevance:\n   - This test function, `test_create`, contains a direct assertion for the LaTeX representation of the `Bd` operator: `assert latex(o) == "b^\\\\dagger_{i}"`. This is highly relevant to the user\'s purpose of investigating LaTeX representation issues.', relative_path='sympy/physics/tests/test_secondquant.py', start_line=94, end_line=105), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is interested in tests involving powers of operators.\n2. Extended relevance:\n   - This test function, `test_dagger`, includes a test for the `Dagger` of a powered operator: `assert Dagger(B(n)**10) == Dagger(B(n))**10`. Since `Dagger(B(n))` is `Bd(n)`, this test is directly related to the behavior of powers of boson operators, which is the core of the user's issue.", relative_path='sympy/physics/tests/test_secondquant.py', start_line=65, end_line=82), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is interested in LaTeX output tests for `secondquant` objects.\n2. Extended relevance:\n   - This test function, `test_NO`, provides an example of a LaTeX test for a more complex, composite operator (`NO` for Normal-Ordered product). The assertion `assert latex(no) == r'\\left\\{a^\\dagger_{a} a^\\dagger_{i}\\right\\}'` demonstrates the testing pattern for LaTeX output of non-trivial objects, which is relevant to the user's interest in the output of a powered (and thus composite) operator.", relative_path='sympy/physics/tests/test_secondquant.py', start_line=391, end_line=431), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is interested in LaTeX output tests for `secondquant` objects.\n2. Extended relevance:\n   - This test function, `test_annihilate`, checks the LaTeX representation of the `B` operator, which is the annihilation counterpart to the `Bd` operator. This provides useful context for how related bosonic operators are handled and tested for their LaTeX output.', relative_path='sympy/physics/tests/test_secondquant.py', start_line=107, end_line=118)]
2025-12-21 03:01:44,046 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the content of the file `sympy/physics/tests/test_secondquant.py`.
2025-12-21 03:01:44,046 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 03:01:44,046 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 03:01:44,046 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-21 03:01:44,046 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 03:01:44,047 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .github
|   └── workflows
|       ├── comment-on-pr.yml
|       └── runtests.yml
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.md
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_optional_dependencies.py
|   ├── test_py2_import.py
|   ├── test_setup.py
|   ├── test_sphinx.sh
|   ├── test_submodule_imports.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── contributing
|       |   └── index.rst
|       ├── documentation-style-guide.rst
|       ├── explanation
|       |   └── index.rst
|       ├── getting_started
|       |   ├── index.rst
|       |   └── install.rst
|       ├── gotchas.rst
|       ├── guides
|       |   ├── assumptions.rst
|       |   ├── booleans.rst
|       |   └── index.rst
|       ├── how_to_guide
|       |   └── index.rst
|       ├── index.rst
|       ├── logo
|       |   └── info.txt
|       ├── miscellaneous
|       |   └── index.rst
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── index.rst
|       |   |   ├── predicates.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── sparse.rst
|       |   |   └── sparsetools.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── control
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── domainmatrix.rst
|       |   |   ├── domainsintro.rst
|       |   |   ├── domainsref.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   ├── solvers.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── fu.rst
|       |   |   ├── hyperexpand.rst
|       |   |   ├── index.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── testing
|       |   |   ├── index.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   └── runtests.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       ├── intro.rst
|       |       └── vector_integration.rst
|       ├── outreach.rst
|       ├── pics
|       ├── reference
|       |   └── index.rst
|       ├── special_topics
|       |   ├── classification.rst
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── aptinstall.sh
|   ├── authors.py
|   ├── build_docs.py
|   ├── compare_tar_against_git.py
|   ├── fabfile.py
|   ├── github_release.py
|   ├── helpers.py
|   ├── pull_and_run_rever.sh
|   ├── release.sh
|   ├── releasecheck.py
|   ├── requirements.txt
|   ├── sha256.py
|   ├── test_install.py
|   ├── update_docs.py
|   └── update_requirements.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── facts.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── predicates
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── relation
    |   |   ├── __init__.py
    |   |   ├── binrel.py
    |   |   └── equality.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_assumptions_2.py
    |   |   ├── test_context.py
    |   |   ├── test_matrices.py
    |   |   ├── test_query.py
    |   |   ├── test_refine.py
    |   |   ├── test_satask.py
    |   |   ├── test_sathandlers.py
    |   |   └── test_wrapper.py
    |   └── wrapper.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── numpy_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   ├── scipy_nodes.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_numpy_nodes.py
    |       ├── test_pyutils.py
    |       ├── test_rewriting.py
    |       └── test_scipy_nodes.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── schur_number.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_schur_number.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── _print_helpers.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── kind.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── parameters.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_kind.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_parameters.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── gmpy.py
    |   ├── importtools.py
    |   ├── pythonmpq.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_pythonmpq.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   ├── minisat22_wrapper.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── decompositions.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── determinant.py
    |   ├── eigen.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── companion.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── sets.py
    |   |   ├── slice.py
    |   |   ├── special.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_companion.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_sets.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_special.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── graph.py
    |   ├── immutable.py
    |   ├── inverse.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── reductions.py
    |   ├── repmatrix.py
    |   ├── solvers.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   ├── subspaces.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_commonmatrix.py
    |   |   ├── test_decompositions.py
    |   |   ├── test_densearith.py
    |   |   ├── test_densesolve.py
    |   |   ├── test_densetools.py
    |   |   ├── test_determinant.py
    |   |   ├── test_eigen.py
    |   |   ├── test_graph.py
    |   |   ├── test_immutable.py
    |   |   ├── test_interactions.py
    |   |   ├── test_matrices.py
    |   |   ├── test_normalforms.py
    |   |   ├── test_reductions.py
    |   |   ├── test_solvers.py
    |   |   ├── test_sparse.py
    |   |   ├── test_sparsetools.py
    |   |   └── test_subspaces.py
    |   └── utilities.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── digits.py
    |   ├── ecm.py
    |   ├── egyptian_fraction.py
    |   ├── elliptic_curve.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── qs.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_digits.py
    |       ├── test_ecm.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_elliptic_curve.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       ├── test_qs.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── README.txt
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── control
    |   |   ├── __init__.py
    |   |   ├── control_plots.py
    |   |   ├── lti.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_control_plots.py
    |   |       └── test_lti.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── joint.py
    |   |   ├── jointsmethod.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── method.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_joint.py
    |   |       ├── test_jointsmethod.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_method.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domainmatrix.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── expressionrawdomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gaussiandomains.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── matrices
    |   |   ├── __init__.py
    |   |   ├── ddm.py
    |   |   ├── dense.py
    |   |   ├── domainmatrix.py
    |   |   ├── domainscalar.py
    |   |   ├── eigen.py
    |   |   ├── exceptions.py
    |   |   ├── linsolve.py
    |   |   ├── normalforms.py
    |   |   ├── sdm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_ddm.py
    |   |       ├── test_dense.py
    |   |       ├── test_domainmatrix.py
    |   |       ├── test_domainscalar.py
    |   |       ├── test_eigen.py
    |   |       ├── test_linsolve.py
    |   |       ├── test_normalforms.py
    |   |       └── test_sdm.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── aesaracode.py
    |   ├── c.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxx.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── fortran.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── numpy.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_aesaracode.py
    |   |   ├── test_c.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cupy.py
    |   |   ├── test_cxx.py
    |   |   ├── test_dot.py
    |   |   ├── test_fortran.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── comparison.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine
    |   |   ├── __init__.py
    |   |   ├── diophantine.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_diophantine.py
    |   ├── inequalities.py
    |   ├── ode
    |   |   ├── __init__.py
    |   |   ├── hypergeometric.py
    |   |   ├── lie_group.py
    |   |   ├── nonhomogeneous.py
    |   |   ├── ode.py
    |   |   ├── riccati.py
    |   |   ├── single.py
    |   |   ├── subscheck.py
    |   |   ├── systems.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_lie_group.py
    |   |       ├── test_ode.py
    |   |       ├── test_riccati.py
    |   |       ├── test_single.py
    |   |       ├── test_subscheck.py
    |   |       └── test_systems.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── compound_rv.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── matrix_distributions.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── sampling
    |   |   ├── __init__.py
    |   |   ├── sample_numpy.py
    |   |   ├── sample_pymc3.py
    |   |   ├── sample_scipy.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_sample_continuous_rv.py
    |   |       ├── test_sample_discrete_rv.py
    |   |       └── test_sample_finite_rv.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_multivariate_probability.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_compound_rv.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_matrix_distributions.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       ├── test_symbolic_multivariate.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── array_derivatives.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── expressions
    |   |   |   ├── __init__.py
    |   |   |   ├── array_expressions.py
    |   |   |   ├── arrayexpr_derivatives.py
    |   |   |   ├── conv_array_to_matrix.py
    |   |   |   ├── conv_indexed_to_array.py
    |   |   |   ├── conv_matrix_to_array.py
    |   |   |   ├── tests
    |   |   |   └── utils.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_array_derivatives.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── testing
    |   ├── __init__.py
    |   ├── benchmarking.py
    |   ├── matrices.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_module_imports.py
    |   |   └── test_pytest.py
    |   └── tmpfiles.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_matchpy_connector.py
    |   |   ├── test_misc.py
    |   |   ├── test_pickling.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── implicitregion.py
        ├── integrals.py
        ├── operators.py
        ├── orienters.py
        ├── parametricregion.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_implicitregion.py
        |   ├── test_integrals.py
        |   ├── test_operators.py
        |   ├── test_parametricregion.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Issues with Latex printing output in second quantization module

Description: There are Latex rendering problems within the "secondquant" module, as it does not correctly interpret double superscripts containing the "dagger" command within Jupyter Notebook.

Let's see a minimal example

```
In [1]: import sympy as sp
        from sympy.physics.secondquant import B, Bd, Commutator
        sp.init_printing()

In [2]: a = sp.Symbol('0')

In [3]: Commutator(Bd(a)**2, B(a))
Out[3]: \displaystyle - \left[b_{0},b^\dagger_{0}^{2}\right]
```
So, it doesn't render correctly, and that's because the double superscript `"b^\dagger_{0}^{2}"`. It should be correct by adding curly brackets `"{b^\dagger_{0}}^{2}"`

Patch information:
diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py
index 64d3207d09..14634b0447 100644
--- a/sympy/printing/latex.py
+++ b/sympy/printing/latex.py
@@ -638,6 +638,9 @@ def _print_Pow(self, expr):
                 base = self.parenthesize_super(base)
             if expr.base.is_Function:
                 return self._print(expr.base, exp="%s/%s" % (p, q))
+            # If base LaTeX already contains a superscript (e.g., dagger), group it
+            if (not expr.base.is_Symbol) and ("^" in base):
+                base = "{%s}" % base
             return r"%s^{%s/%s}" % (base, p, q)
         elif expr.exp.is_Rational and expr.exp.is_negative and \
                 expr.base.is_commutative:
@@ -673,6 +676,9 @@ def _helper_print_standard_power(self, expr, template):
             and base.endswith(r'\right)')):
             # don't use parentheses around dotted derivative
             base = base[6: -7]  # remove outermost added parens
+        # If base LaTeX already contains a superscript (e.g., dagger), group it
+        if (not expr.base.is_Symbol) and ("^" in base):
+            base = "{%s}" % base
         return template % (base, exp)
 
     def _print_UnevaluatedExpr(self, expr):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the content of the file `sympy/printing/tests/test_latex.py`.
Extra Requirements: 
Purpose: This file is needed to find existing test cases that test the LaTeX printing of powers (`_print_Pow`) and to see how expressions with superscripts are currently tested.

Previous refined query 2:
Essential Query: Please provide the content of the file `sympy/physics/tests/test_secondquant.py`.
Extra Requirements: If the file is large, please prioritize any tests that verify the LaTeX output of `secondquant` objects, especially those involving powers of operators.
Purpose: I need this file to find test cases that use the `Bd` operator and check its LaTeX representation when raised to a power, which is the core of the reported issue.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/physics/tests/test_secondquant.py
Line number range: 1 - 500
Content:
1. from sympy.physics.secondquant import (
2.     Dagger, Bd, VarBosonicBasis, BBra, B, BKet, FixedBosonicBasis,
3.     matrix_rep, apply_operators, InnerProduct, Commutator, KroneckerDelta,
4.     AnnihilateBoson, CreateBoson, BosonicOperator,
5.     F, Fd, FKet, BosonState, CreateFermion, AnnihilateFermion,
6.     evaluate_deltas, AntiSymmetricTensor, contraction, NO, wicks,
7.     PermutationOperator, simplify_index_permutations,
8.     _sort_anticommuting_fermions, _get_ordered_dummies,
9.     substitute_dummies, FockStateBosonKet,
10.     ContractionAppliesOnlyToFermions
11. )
12. 
13. from sympy import (Dummy, expand, Function, I, S, simplify, sqrt, Sum,
14.                    Symbol, symbols, srepr, Rational)
15. 
16. from sympy.testing.pytest import slow, raises
17. from sympy.printing.latex import latex
18. 
19. 
20. def test_PermutationOperator():
21.     p, q, r, s = symbols('p,q,r,s')
22.     f, g, h, i = map(Function, 'fghi')
23.     P = PermutationOperator
24.     assert P(p, q).get_permuted(f(p)*g(q)) == -f(q)*g(p)
25.     assert P(p, q).get_permuted(f(p, q)) == -f(q, p)
26.     assert P(p, q).get_permuted(f(p)) == f(p)
27.     expr = (f(p)*g(q)*h(r)*i(s)
28.         - f(q)*g(p)*h(r)*i(s)
29.         - f(p)*g(q)*h(s)*i(r)
30.         + f(q)*g(p)*h(s)*i(r))
31.     perms = [P(p, q), P(r, s)]
32.     assert (simplify_index_permutations(expr, perms) ==
33.         P(p, q)*P(r, s)*f(p)*g(q)*h(r)*i(s))
34.     assert latex(P(p, q)) == 'P(pq)'
35. 
36. 
37. def test_index_permutations_with_dummies():
38.     a, b, c, d = symbols('a b c d')
39.     p, q, r, s = symbols('p q r s', cls=Dummy)
40.     f, g = map(Function, 'fg')
41.     P = PermutationOperator
42. 
43.     # No dummy substitution necessary
44.     expr = f(a, b, p, q) - f(b, a, p, q)
45.     assert simplify_index_permutations(
46.         expr, [P(a, b)]) == P(a, b)*f(a, b, p, q)
47. 
48.     # Cases where dummy substitution is needed
49.     expected = P(a, b)*substitute_dummies(f(a, b, p, q))
50. 
51.     expr = f(a, b, p, q) - f(b, a, q, p)
52.     result = simplify_index_permutations(expr, [P(a, b)])
53.     assert expected == substitute_dummies(result)
54. 
55.     expr = f(a, b, q, p) - f(b, a, p, q)
56.     result = simplify_index_permutations(expr, [P(a, b)])
57.     assert expected == substitute_dummies(result)
58. 
59.     # A case where nothing can be done
60.     expr = f(a, b, q, p) - g(b, a, p, q)
61.     result = simplify_index_permutations(expr, [P(a, b)])
62.     assert expr == result
63. 
64. 
65. def test_dagger():
66.     i, j, n, m = symbols('i,j,n,m')
67.     assert Dagger(1) == 1
68.     assert Dagger(1.0) == 1.0
69.     assert Dagger(2*I) == -2*I
70.     assert Dagger(S.Half*I/3.0) == I*Rational(-1, 2)/3.0
71.     assert Dagger(BKet([n])) == BBra([n])
72.     assert Dagger(B(0)) == Bd(0)
73.     assert Dagger(Bd(0)) == B(0)
74.     assert Dagger(B(n)) == Bd(n)
75.     assert Dagger(Bd(n)) == B(n)
76.     assert Dagger(B(0) + B(1)) == Bd(0) + Bd(1)
77.     assert Dagger(n*m) == Dagger(n)*Dagger(m)  # n, m commute
78.     assert Dagger(B(n)*B(m)) == Bd(m)*Bd(n)
79.     assert Dagger(B(n)**10) == Dagger(B(n))**10
80.     assert Dagger('a') == Dagger(Symbol('a'))
81.     assert Dagger(Dagger('a')) == Symbol('a')
82. 
83. 
84. def test_operator():
85.     i, j = symbols('i,j')
86.     o = BosonicOperator(i)
87.     assert o.state == i
88.     assert o.is_symbolic
89.     o = BosonicOperator(1)
90.     assert o.state == 1
91.     assert not o.is_symbolic
92. 
93. 
94. def test_create():
95.     i, j, n, m = symbols('i,j,n,m')
96.     o = Bd(i)
97.     assert latex(o) == "b^\\dagger_{i}"
98.     assert isinstance(o, CreateBoson)
99.     o = o.subs(i, j)
100.     assert o.atoms(Symbol) == {j}
101.     o = Bd(0)
102.     assert o.apply_operator(BKet([n])) == sqrt(n + 1)*BKet([n + 1])
103.     o = Bd(n)
104.     assert o.apply_operator(BKet([n])) == o*BKet([n])
105. 
106. 
107. def test_annihilate():
108.     i, j, n, m = symbols('i,j,n,m')
109.     o = B(i)
110.     assert latex(o) == "b_{i}"
111.     assert isinstance(o, AnnihilateBoson)
112.     o = o.subs(i, j)
113.     assert o.atoms(Symbol) == {j}
114.     o = B(0)
115.     assert o.apply_operator(BKet([n])) == sqrt(n)*BKet([n - 1])
116.     o = B(n)
117.     assert o.apply_operator(BKet([n])) == o*BKet([n])
118. 
119. 
120. def test_basic_state():
121.     i, j, n, m = symbols('i,j,n,m')
122.     s = BosonState([0, 1, 2, 3, 4])
123.     assert len(s) == 5
124.     assert s.args[0] == tuple(range(5))
125.     assert s.up(0) == BosonState([1, 1, 2, 3, 4])
126.     assert s.down(4) == BosonState([0, 1, 2, 3, 3])
127.     for i in range(5):
128.         assert s.up(i).down(i) == s
129.     assert s.down(0) == 0
130.     for i in range(5):
131.         assert s[i] == i
132.     s = BosonState([n, m])
133.     assert s.down(0) == BosonState([n - 1, m])
134.     assert s.up(0) == BosonState([n + 1, m])
135. 
136. 
137. def test_basic_apply():
138.     n = symbols("n")
139.     e = B(0)*BKet([n])
140.     assert apply_operators(e) == sqrt(n)*BKet([n - 1])
141.     e = Bd(0)*BKet([n])
142.     assert apply_operators(e) == sqrt(n + 1)*BKet([n + 1])
143. 
144. 
145. def test_complex_apply():
146.     n, m = symbols("n,m")
147.     o = Bd(0)*B(0)*Bd(1)*B(0)
148.     e = apply_operators(o*BKet([n, m]))
149.     answer = sqrt(n)*sqrt(m + 1)*(-1 + n)*BKet([-1 + n, 1 + m])
150.     assert expand(e) == expand(answer)
151. 
152. 
153. def test_number_operator():
154.     n = symbols("n")
155.     o = Bd(0)*B(0)
156.     e = apply_operators(o*BKet([n]))
157.     assert e == n*BKet([n])
158. 
159. 
160. def test_inner_product():
161.     i, j, k, l = symbols('i,j,k,l')
162.     s1 = BBra([0])
163.     s2 = BKet([1])
164.     assert InnerProduct(s1, Dagger(s1)) == 1
165.     assert InnerProduct(s1, s2) == 0
166.     s1 = BBra([i, j])
167.     s2 = BKet([k, l])
168.     r = InnerProduct(s1, s2)
169.     assert r == KroneckerDelta(i, k)*KroneckerDelta(j, l)
170. 
171. 
172. def test_symbolic_matrix_elements():
173.     n, m = symbols('n,m')
174.     s1 = BBra([n])
175.     s2 = BKet([m])
176.     o = B(0)
177.     e = apply_operators(s1*o*s2)
178.     assert e == sqrt(m)*KroneckerDelta(n, m - 1)
179. 
180. 
181. def test_matrix_elements():
182.     b = VarBosonicBasis(5)
183.     o = B(0)
184.     m = matrix_rep(o, b)
185.     for i in range(4):
186.         assert m[i, i + 1] == sqrt(i + 1)
187.     o = Bd(0)
188.     m = matrix_rep(o, b)
189.     for i in range(4):
190.         assert m[i + 1, i] == sqrt(i + 1)
191. 
192. 
193. def test_fixed_bosonic_basis():
194.     b = FixedBosonicBasis(2, 2)
195.     # assert b == [FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]
196.     state = b.state(1)
197.     assert state == FockStateBosonKet((1, 1))
198.     assert b.index(state) == 1
199.     assert b.state(1) == b[1]
200.     assert len(b) == 3
201.     assert str(b) == '[FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]'
202.     assert repr(b) == '[FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]'
203.     assert srepr(b) == '[FockState((2, 0)), FockState((1, 1)), FockState((0, 2))]'
204. 
205. 
206. @slow
207. def test_sho():
208.     n, m = symbols('n,m')
209.     h_n = Bd(n)*B(n)*(n + S.Half)
210.     H = Sum(h_n, (n, 0, 5))
211.     o = H.doit(deep=False)
212.     b = FixedBosonicBasis(2, 6)
213.     m = matrix_rep(o, b)
214.     # We need to double check these energy values to make sure that they
215.     # are correct and have the proper degeneracies!
216.     diag = [1, 2, 3, 3, 4, 5, 4, 5, 6, 7, 5, 6, 7, 8, 9, 6, 7, 8, 9, 10, 11]
217.     for i in range(len(diag)):
218.         assert diag[i] == m[i, i]
219. 
220. 
221. def test_commutation():
222.     n, m = symbols("n,m", above_fermi=True)
223.     c = Commutator(B(0), Bd(0))
224.     assert c == 1
225.     c = Commutator(Bd(0), B(0))
226.     assert c == -1
227.     c = Commutator(B(n), Bd(0))
228.     assert c == KroneckerDelta(n, 0)
229.     c = Commutator(B(0), B(0))
230.     assert c == 0
231.     c = Commutator(B(0), Bd(0))
232.     e = simplify(apply_operators(c*BKet([n])))
233.     assert e == BKet([n])
234.     c = Commutator(B(0), B(1))
235.     e = simplify(apply_operators(c*BKet([n, m])))
236.     assert e == 0
237. 
238.     c = Commutator(F(m), Fd(m))
239.     assert c == +1 - 2*NO(Fd(m)*F(m))
240.     c = Commutator(Fd(m), F(m))
241.     assert c.expand() == -1 + 2*NO(Fd(m)*F(m))
242. 
243.     C = Commutator
244.     X, Y, Z = symbols('X,Y,Z', commutative=False)
245.     assert C(C(X, Y), Z) != 0
246.     assert C(C(X, Z), Y) != 0
247.     assert C(Y, C(X, Z)) != 0
248. 
249.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
250.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
251.     p, q, r, s = symbols('p,q,r,s')
252.     D = KroneckerDelta
253. 
254.     assert C(Fd(a), F(i)) == -2*NO(F(i)*Fd(a))
255.     assert C(Fd(j), NO(Fd(a)*F(i))).doit(wicks=True) == -D(j, i)*Fd(a)
256.     assert C(Fd(a)*F(i), Fd(b)*F(j)).doit(wicks=True) == 0
257. 
258.     c1 = Commutator(F(a), Fd(a))
259.     assert Commutator.eval(c1, c1) == 0
260.     c = Commutator(Fd(a)*F(i),Fd(b)*F(j))
261.     assert latex(c) == r'\left[a^\dagger_{a} a_{i},a^\dagger_{b} a_{j}\right]'
262.     assert repr(c) == 'Commutator(CreateFermion(a)*AnnihilateFermion(i),CreateFermion(b)*AnnihilateFermion(j))'
263.     assert str(c) == '[CreateFermion(a)*AnnihilateFermion(i),CreateFermion(b)*AnnihilateFermion(j)]'
264. 
265. 
266. def test_create_f():
267.     i, j, n, m = symbols('i,j,n,m')
268.     o = Fd(i)
269.     assert isinstance(o, CreateFermion)
270.     o = o.subs(i, j)
271.     assert o.atoms(Symbol) == {j}
272.     o = Fd(1)
273.     assert o.apply_operator(FKet([n])) == FKet([1, n])
274.     assert o.apply_operator(FKet([n])) == -FKet([n, 1])
275.     o = Fd(n)
276.     assert o.apply_operator(FKet([])) == FKet([n])
277. 
278.     vacuum = FKet([], fermi_level=4)
279.     assert vacuum == FKet([], fermi_level=4)
280. 
281.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
282.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
283.     p, q, r, s = symbols('p,q,r,s')
284. 
285.     assert Fd(i).apply_operator(FKet([i, j, k], 4)) == FKet([j, k], 4)
286.     assert Fd(a).apply_operator(FKet([i, b, k], 4)) == FKet([a, i, b, k], 4)
287. 
288.     assert Dagger(B(p)).apply_operator(q) == q*CreateBoson(p)
289.     assert repr(Fd(p)) == 'CreateFermion(p)'
290.     assert srepr(Fd(p)) == "CreateFermion(Symbol('p'))"
291.     assert latex(Fd(p)) == r'a^\dagger_{p}'
292. 
293. 
294. def test_annihilate_f():
295.     i, j, n, m = symbols('i,j,n,m')
296.     o = F(i)
297.     assert isinstance(o, AnnihilateFermion)
298.     o = o.subs(i, j)
299.     assert o.atoms(Symbol) == {j}
300.     o = F(1)
301.     assert o.apply_operator(FKet([1, n])) == FKet([n])
302.     assert o.apply_operator(FKet([n, 1])) == -FKet([n])
303.     o = F(n)
304.     assert o.apply_operator(FKet([n])) == FKet([])
305. 
306.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
307.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
308.     p, q, r, s = symbols('p,q,r,s')
309.     assert F(i).apply_operator(FKet([i, j, k], 4)) == 0
310.     assert F(a).apply_operator(FKet([i, b, k], 4)) == 0
311.     assert F(l).apply_operator(FKet([i, j, k], 3)) == 0
312.     assert F(l).apply_operator(FKet([i, j, k], 4)) == FKet([l, i, j, k], 4)
313.     assert str(F(p)) == 'f(p)'
314.     assert repr(F(p)) == 'AnnihilateFermion(p)'
315.     assert srepr(F(p)) == "AnnihilateFermion(Symbol('p'))"
316.     assert latex(F(p)) == 'a_{p}'
317. 
318. 
319. def test_create_b():
320.     i, j, n, m = symbols('i,j,n,m')
321.     o = Bd(i)
322.     assert isinstance(o, CreateBoson)
323.     o = o.subs(i, j)
324.     assert o.atoms(Symbol) == {j}
325.     o = Bd(0)
326.     assert o.apply_operator(BKet([n])) == sqrt(n + 1)*BKet([n + 1])
327.     o = Bd(n)
328.     assert o.apply_operator(BKet([n])) == o*BKet([n])
329. 
330. 
331. def test_annihilate_b():
332.     i, j, n, m = symbols('i,j,n,m')
333.     o = B(i)
334.     assert isinstance(o, AnnihilateBoson)
335.     o = o.subs(i, j)
336.     assert o.atoms(Symbol) == {j}
337.     o = B(0)
338. 
339. 
340. def test_wicks():
341.     p, q, r, s = symbols('p,q,r,s', above_fermi=True)
342. 
343.     # Testing for particles only
344. 
345.     str = F(p)*Fd(q)
346.     assert wicks(str) == NO(F(p)*Fd(q)) + KroneckerDelta(p, q)
347.     str = Fd(p)*F(q)
348.     assert wicks(str) == NO(Fd(p)*F(q))
349. 
350.     str = F(p)*Fd(q)*F(r)*Fd(s)
351.     nstr = wicks(str)
352.     fasit = NO(
353.         KroneckerDelta(p, q)*KroneckerDelta(r, s)
354.         + KroneckerDelta(p, q)*AnnihilateFermion(r)*CreateFermion(s)
355.         + KroneckerDelta(r, s)*AnnihilateFermion(p)*CreateFermion(q)
356.         - KroneckerDelta(p, s)*AnnihilateFermion(r)*CreateFermion(q)
357.         - AnnihilateFermion(p)*AnnihilateFermion(r)*CreateFermion(q)*CreateFermion(s))
358.     assert nstr == fasit
359. 
360.     assert (p*q*nstr).expand() == wicks(p*q*str)
361.     assert (nstr*p*q*2).expand() == wicks(str*p*q*2)
362. 
363.     # Testing CC equations particles and holes
364.     i, j, k, l = symbols('i j k l', below_fermi=True, cls=Dummy)
365.     a, b, c, d = symbols('a b c d', above_fermi=True, cls=Dummy)
366.     p, q, r, s = symbols('p q r s', cls=Dummy)
367. 
368.     assert (wicks(F(a)*NO(F(i)*F(j))*Fd(b)) ==
369.             NO(F(a)*F(i)*F(j)*Fd(b)) +
370.             KroneckerDelta(a, b)*NO(F(i)*F(j)))
371.     assert (wicks(F(a)*NO(F(i)*F(j)*F(k))*Fd(b)) ==
372.             NO(F(a)*F(i)*F(j)*F(k)*Fd(b)) -
373.             KroneckerDelta(a, b)*NO(F(i)*F(j)*F(k)))
374. 
375.     expr = wicks(Fd(i)*NO(Fd(j)*F(k))*F(l))
376.     assert (expr ==
377.            -KroneckerDelta(i, k)*NO(Fd(j)*F(l)) -
378.             KroneckerDelta(j, l)*NO(Fd(i)*F(k)) -
379.             KroneckerDelta(i, k)*KroneckerDelta(j, l) +
380.             KroneckerDelta(i, l)*NO(Fd(j)*F(k)) +
381.             NO(Fd(i)*Fd(j)*F(k)*F(l)))
382.     expr = wicks(F(a)*NO(F(b)*Fd(c))*Fd(d))
383.     assert (expr ==
384.            -KroneckerDelta(a, c)*NO(F(b)*Fd(d)) -
385.             KroneckerDelta(b, d)*NO(F(a)*Fd(c)) -
386.             KroneckerDelta(a, c)*KroneckerDelta(b, d) +
387.             KroneckerDelta(a, d)*NO(F(b)*Fd(c)) +
388.             NO(F(a)*F(b)*Fd(c)*Fd(d)))
389. 
390. 
391. def test_NO():
392.     i, j, k, l = symbols('i j k l', below_fermi=True)
393.     a, b, c, d = symbols('a b c d', above_fermi=True)
394.     p, q, r, s = symbols('p q r s', cls=Dummy)
395. 
396.     assert (NO(Fd(p)*F(q) + Fd(a)*F(b)) ==
397.        NO(Fd(p)*F(q)) + NO(Fd(a)*F(b)))
398.     assert (NO(Fd(i)*NO(F(j)*Fd(a))) ==
399.        NO(Fd(i)*F(j)*Fd(a)))
400.     assert NO(1) == 1
401.     assert NO(i) == i
402.     assert (NO(Fd(a)*Fd(b)*(F(c) + F(d))) ==
403.             NO(Fd(a)*Fd(b)*F(c)) +
404.             NO(Fd(a)*Fd(b)*F(d)))
405. 
406.     assert NO(Fd(a)*F(b))._remove_brackets() == Fd(a)*F(b)
407.     assert NO(F(j)*Fd(i))._remove_brackets() == F(j)*Fd(i)
408. 
409.     assert (NO(Fd(p)*F(q)).subs(Fd(p), Fd(a) + Fd(i)) ==
410.             NO(Fd(a)*F(q)) + NO(Fd(i)*F(q)))
411.     assert (NO(Fd(p)*F(q)).subs(F(q), F(a) + F(i)) ==
412.             NO(Fd(p)*F(a)) + NO(Fd(p)*F(i)))
413. 
414.     expr = NO(Fd(p)*F(q))._remove_brackets()
415.     assert wicks(expr) == NO(expr)
416. 
417.     assert NO(Fd(a)*F(b)) == - NO(F(b)*Fd(a))
418. 
419.     no = NO(Fd(a)*F(i)*F(b)*Fd(j))
420.     l1 = [ ind for ind in no.iter_q_creators() ]
421.     assert l1 == [0, 1]
422.     l2 = [ ind for ind in no.iter_q_annihilators() ]
423.     assert l2 == [3, 2]
424.     no = NO(Fd(a)*Fd(i))
425.     assert no.has_q_creators == 1
426.     assert no.has_q_annihilators == -1
427.     assert str(no) == ':CreateFermion(a)*CreateFermion(i):'
428.     assert repr(no) == 'NO(CreateFermion(a)*CreateFermion(i))'
429.     assert latex(no) == r'\left\{a^\dagger_{a} a^\dagger_{i}\right\}'
430.     raises(NotImplementedError, lambda:  NO(Bd(p)*F(q)))
431. 
432. 
433. def test_sorting():
434.     i, j = symbols('i,j', below_fermi=True)
435.     a, b = symbols('a,b', above_fermi=True)
436.     p, q = symbols('p,q')
437. 
438.     # p, q
439.     assert _sort_anticommuting_fermions([Fd(p), F(q)]) == ([Fd(p), F(q)], 0)
440.     assert _sort_anticommuting_fermions([F(p), Fd(q)]) == ([Fd(q), F(p)], 1)
441. 
442.     # i, p
443.     assert _sort_anticommuting_fermions([F(p), Fd(i)]) == ([F(p), Fd(i)], 0)
444.     assert _sort_anticommuting_fermions([Fd(i), F(p)]) == ([F(p), Fd(i)], 1)
445.     assert _sort_anticommuting_fermions([Fd(p), Fd(i)]) == ([Fd(p), Fd(i)], 0)
446.     assert _sort_anticommuting_fermions([Fd(i), Fd(p)]) == ([Fd(p), Fd(i)], 1)
447.     assert _sort_anticommuting_fermions([F(p), F(i)]) == ([F(i), F(p)], 1)
448.     assert _sort_anticommuting_fermions([F(i), F(p)]) == ([F(i), F(p)], 0)
449.     assert _sort_anticommuting_fermions([Fd(p), F(i)]) == ([F(i), Fd(p)], 1)
450.     assert _sort_anticommuting_fermions([F(i), Fd(p)]) == ([F(i), Fd(p)], 0)
451. 
452.     # a, p
453.     assert _sort_anticommuting_fermions([F(p), Fd(a)]) == ([Fd(a), F(p)], 1)
454.     assert _sort_anticommuting_fermions([Fd(a), F(p)]) == ([Fd(a), F(p)], 0)
455.     assert _sort_anticommuting_fermions([Fd(p), Fd(a)]) == ([Fd(a), Fd(p)], 1)
456.     assert _sort_anticommuting_fermions([Fd(a), Fd(p)]) == ([Fd(a), Fd(p)], 0)
457.     assert _sort_anticommuting_fermions([F(p), F(a)]) == ([F(p), F(a)], 0)
458.     assert _sort_anticommuting_fermions([F(a), F(p)]) == ([F(p), F(a)], 1)
459.     assert _sort_anticommuting_fermions([Fd(p), F(a)]) == ([Fd(p), F(a)], 0)
460.     assert _sort_anticommuting_fermions([F(a), Fd(p)]) == ([Fd(p), F(a)], 1)
461. 
462.     # i, a
463.     assert _sort_anticommuting_fermions([F(i), Fd(j)]) == ([F(i), Fd(j)], 0)
464.     assert _sort_anticommuting_fermions([Fd(j), F(i)]) == ([F(i), Fd(j)], 1)
465.     assert _sort_anticommuting_fermions([Fd(a), Fd(i)]) == ([Fd(a), Fd(i)], 0)
466.     assert _sort_anticommuting_fermions([Fd(i), Fd(a)]) == ([Fd(a), Fd(i)], 1)
467.     assert _sort_anticommuting_fermions([F(a), F(i)]) == ([F(i), F(a)], 1)
468.     assert _sort_anticommuting_fermions([F(i), F(a)]) == ([F(i), F(a)], 0)
469. 
470. 
471. def test_contraction():
472.     i, j, k, l = symbols('i,j,k,l', below_fermi=True)
473.     a, b, c, d = symbols('a,b,c,d', above_fermi=True)
474.     p, q, r, s = symbols('p,q,r,s')
475.     assert contraction(Fd(i), F(j)) == KroneckerDelta(i, j)
476.     assert contraction(F(a), Fd(b)) == KroneckerDelta(a, b)
477.     assert contraction(F(a), Fd(i)) == 0
478.     assert contraction(Fd(a), F(i)) == 0
479.     assert contraction(F(i), Fd(a)) == 0
480.     assert contraction(Fd(i), F(a)) == 0
481.     assert contraction(Fd(i), F(p)) == KroneckerDelta(i, p)
482.     restr = evaluate_deltas(contraction(Fd(p), F(q)))
483.     assert restr.is_only_below_fermi
484.     restr = evaluate_deltas(contraction(F(p), Fd(q)))
485.     assert restr.is_only_above_fermi
486.     raises(ContractionAppliesOnlyToFermions, lambda: contraction(B(a), Fd(b)))
487. 
488. 
489. def test_evaluate_deltas():
490.     i, j, k = symbols('i,j,k')
491. 
492.     r = KroneckerDelta(i, j) * KroneckerDelta(j, k)
493.     assert evaluate_deltas(r) == KroneckerDelta(i, k)
494. 
495.     r = KroneckerDelta(i, 0) * KroneckerDelta(j, k)
496.     assert evaluate_deltas(r) == KroneckerDelta(i, 0) * KroneckerDelta(j, k)
497. 
498.     r = KroneckerDelta(1, j) * KroneckerDelta(j, k)
499.     assert evaluate_deltas(r) == KroneckerDelta(1, k)
500. 


File: sympy/printing/tests/test_latex.py
Line number range: 1 - 500
Content:
1. from sympy.tensor.array.expressions.array_expressions import ArraySymbol, ArrayElement
2. from sympy.tensor.toperators import PartialDerivative
3. 
4. from sympy import (
5.     Abs, Chi, Ci, CosineTransform, Dict, Ei, Eq, FallingFactorial,
6.     FiniteSet, Float, FourierTransform, Function, Indexed, IndexedBase, Integral,
7.     Interval, InverseCosineTransform, InverseFourierTransform, Derivative,
8.     InverseLaplaceTransform, InverseMellinTransform, InverseSineTransform,
9.     Lambda, LaplaceTransform, Limit, Matrix, Max, MellinTransform, Min, Mul,
10.     Order, Piecewise, Poly, ring, field, ZZ, Pow, Product, Range, Rational, Integer,
11.     RisingFactorial, rootof, RootSum, S, Shi, Si, SineTransform, Subs,
12.     Sum, Symbol, ImageSet, Tuple, Ynm, Znm, arg, asin, acsc, asinh, Mod,
13.     assoc_laguerre, assoc_legendre, beta, binomial, catalan, ceiling,
14.     chebyshevt, chebyshevu, conjugate, cot, coth, diff, dirichlet_eta, euler,
15.     exp, expint, factorial, factorial2, floor, gamma, gegenbauer, hermite,
16.     hyper, im, jacobi, laguerre, legendre, lerchphi, log, frac,
17.     meijerg, oo, polar_lift, polylog, re, root, sin, sqrt, symbols,
18.     uppergamma, zeta, subfactorial, totient, elliptic_k, elliptic_f,
19.     elliptic_e, elliptic_pi, cos, tan, Wild, true, false, Equivalent, Not,
20.     Contains, divisor_sigma, SeqPer, SeqFormula, MatrixSlice,
21.     SeqAdd, SeqMul, fourier_series, pi, ConditionSet, ComplexRegion, fps,
22.     AccumBounds, reduced_totient, primenu, primeomega, SingularityFunction,
23.     stieltjes, mathieuc, mathieus, mathieucprime, mathieusprime,
24.     UnevaluatedExpr, Quaternion, I, KroneckerProduct, LambertW)
25. 
26. from sympy.ntheory.factor_ import udivisor_sigma
27. 
28. from sympy.abc import mu, tau
29. from sympy.printing.latex import (latex, translate, greek_letters_set,
30.                                   tex_greek_dictionary, multiline_latex,
31.                                   latex_escape, LatexPrinter)
32. from sympy.tensor.array import (ImmutableDenseNDimArray,
33.                                 ImmutableSparseNDimArray,
34.                                 MutableSparseNDimArray,
35.                                 MutableDenseNDimArray,
36.                                 tensorproduct)
37. from sympy.testing.pytest import XFAIL, raises, _both_exp_pow
38. from sympy.functions import DiracDelta, Heaviside, KroneckerDelta, LeviCivita
39. from sympy.functions.combinatorial.numbers import bernoulli, bell, lucas, \
40.     fibonacci, tribonacci
41. from sympy.logic import Implies
42. from sympy.logic.boolalg import And, Or, Xor
43. from sympy.physics.control.lti import TransferFunction, Series, Parallel, \
44.     Feedback, TransferFunctionMatrix, MIMOSeries, MIMOParallel, MIMOFeedback
45. from sympy.physics.quantum import Commutator, Operator
46. from sympy.physics.units import meter, gibibyte, microgram, second
47. from sympy.core.trace import Tr
48. from sympy.combinatorics.permutations import \
49.     Cycle, Permutation, AppliedPermutation
50. from sympy.matrices.expressions.permutation import PermutationMatrix
51. from sympy import MatrixSymbol, ln
52. from sympy.vector import CoordSys3D, Cross, Curl, Dot, Divergence, Gradient, Laplacian
53. from sympy.sets.setexpr import SetExpr
54. from sympy.sets.sets import \
55.     Union, Intersection, Complement, SymmetricDifference, ProductSet
56. 
57. import sympy as sym
58. 
59. 
60. class lowergamma(sym.lowergamma):
61.     pass   # testing notation inheritance by a subclass with same name
62. 
63. 
64. x, y, z, t, w, a, b, c, s, p = symbols('x y z t w a b c s p')
65. k, m, n = symbols('k m n', integer=True)
66. 
67. 
68. def test_printmethod():
69.     class R(Abs):
70.         def _latex(self, printer):
71.             return "foo(%s)" % printer._print(self.args[0])
72.     assert latex(R(x)) == r"foo(x)"
73. 
74.     class R(Abs):
75.         def _latex(self, printer):
76.             return "foo"
77.     assert latex(R(x)) == r"foo"
78. 
79. 
80. def test_latex_basic():
81.     assert latex(1 + x) == r"x + 1"
82.     assert latex(x**2) == r"x^{2}"
83.     assert latex(x**(1 + x)) == r"x^{x + 1}"
84.     assert latex(x**3 + x + 1 + x**2) == r"x^{3} + x^{2} + x + 1"
85. 
86.     assert latex(2*x*y) == r"2 x y"
87.     assert latex(2*x*y, mul_symbol='dot') == r"2 \cdot x \cdot y"
88.     assert latex(3*x**2*y, mul_symbol='\\,') == r"3\,x^{2}\,y"
89.     assert latex(1.5*3**x, mul_symbol='\\,') == r"1.5 \cdot 3^{x}"
90. 
91.     assert latex(Mul(0, 1, evaluate=False)) == r'0 \cdot 1'
92.     assert latex(Mul(1, 0, evaluate=False)) == r'1 \cdot 0'
93.     assert latex(Mul(1, 1, evaluate=False)) == r'1 \cdot 1'
94.     assert latex(Mul(-1, 1, evaluate=False)) == r'\left(-1\right) 1'
95.     assert latex(Mul(1, 1, 1, evaluate=False)) == r'1 \cdot 1 \cdot 1'
96.     assert latex(Mul(1, 2, evaluate=False)) == r'1 \cdot 2'
97.     assert latex(Mul(1, S.Half, evaluate=False)) == r'1 \frac{1}{2}'
98.     assert latex(Mul(1, 1, S.Half, evaluate=False)) == \
99.         r'1 \cdot 1 \frac{1}{2}'
100.     assert latex(Mul(1, 1, 2, 3, x, evaluate=False)) == \
101.         r'1 \cdot 1 \cdot 2 \cdot 3 x'
102.     assert latex(Mul(1, -1, evaluate=False)) == r'1 \left(-1\right)'
103.     assert latex(Mul(4, 3, 2, 1, 0, y, x, evaluate=False)) == \
104.         r'4 \cdot 3 \cdot 2 \cdot 1 \cdot 0 y x'
105.     assert latex(Mul(4, 3, 2, 1+z, 0, y, x, evaluate=False)) == \
106.         r'4 \cdot 3 \cdot 2 \left(z + 1\right) 0 y x'
107.     assert latex(Mul(Rational(2, 3), Rational(5, 7), evaluate=False)) == \
108.         r'\frac{2}{3} \frac{5}{7}'
109. 
110.     assert latex(1/x) == r"\frac{1}{x}"
111.     assert latex(1/x, fold_short_frac=True) == r"1 / x"
112.     assert latex(-S(3)/2) == r"- \frac{3}{2}"
113.     assert latex(-S(3)/2, fold_short_frac=True) == r"- 3 / 2"
114.     assert latex(1/x**2) == r"\frac{1}{x^{2}}"
115.     assert latex(1/(x + y)/2) == r"\frac{1}{2 \left(x + y\right)}"
116.     assert latex(x/2) == r"\frac{x}{2}"
117.     assert latex(x/2, fold_short_frac=True) == r"x / 2"
118.     assert latex((x + y)/(2*x)) == r"\frac{x + y}{2 x}"
119.     assert latex((x + y)/(2*x), fold_short_frac=True) == \
120.         r"\left(x + y\right) / 2 x"
121.     assert latex((x + y)/(2*x), long_frac_ratio=0) == \
122.         r"\frac{1}{2 x} \left(x + y\right)"
123.     assert latex((x + y)/x) == r"\frac{x + y}{x}"
124.     assert latex((x + y)/x, long_frac_ratio=3) == r"\frac{x + y}{x}"
125.     assert latex((2*sqrt(2)*x)/3) == r"\frac{2 \sqrt{2} x}{3}"
126.     assert latex((2*sqrt(2)*x)/3, long_frac_ratio=2) == \
127.         r"\frac{2 x}{3} \sqrt{2}"
128.     assert latex(binomial(x, y)) == r"{\binom{x}{y}}"
129. 
130.     x_star = Symbol('x^*')
131.     f = Function('f')
132.     assert latex(x_star**2) == r"\left(x^{*}\right)^{2}"
133.     assert latex(x_star**2, parenthesize_super=False) == r"{x^{*}}^{2}"
134.     assert latex(Derivative(f(x_star), x_star,2)) == r"\frac{d^{2}}{d \left(x^{*}\right)^{2}} f{\left(x^{*} \right)}"
135.     assert latex(Derivative(f(x_star), x_star,2), parenthesize_super=False) == r"\frac{d^{2}}{d {x^{*}}^{2}} f{\left(x^{*} \right)}"
136. 
137.     assert latex(2*Integral(x, x)/3) == r"\frac{2 \int x\, dx}{3}"
138.     assert latex(2*Integral(x, x)/3, fold_short_frac=True) == \
139.         r"\left(2 \int x\, dx\right) / 3"
140. 
141.     assert latex(sqrt(x)) == r"\sqrt{x}"
142.     assert latex(x**Rational(1, 3)) == r"\sqrt[3]{x}"
143.     assert latex(x**Rational(1, 3), root_notation=False) == r"x^{\frac{1}{3}}"
144.     assert latex(sqrt(x)**3) == r"x^{\frac{3}{2}}"
145.     assert latex(sqrt(x), itex=True) == r"\sqrt{x}"
146.     assert latex(x**Rational(1, 3), itex=True) == r"\root{3}{x}"
147.     assert latex(sqrt(x)**3, itex=True) == r"x^{\frac{3}{2}}"
148.     assert latex(x**Rational(3, 4)) == r"x^{\frac{3}{4}}"
149.     assert latex(x**Rational(3, 4), fold_frac_powers=True) == r"x^{3/4}"
150.     assert latex((x + 1)**Rational(3, 4)) == \
151.         r"\left(x + 1\right)^{\frac{3}{4}}"
152.     assert latex((x + 1)**Rational(3, 4), fold_frac_powers=True) == \
153.         r"\left(x + 1\right)^{3/4}"
154. 
155.     assert latex(1.5e20*x) == r"1.5 \cdot 10^{20} x"
156.     assert latex(1.5e20*x, mul_symbol='dot') == r"1.5 \cdot 10^{20} \cdot x"
157.     assert latex(1.5e20*x, mul_symbol='times') == \
158.         r"1.5 \times 10^{20} \times x"
159. 
160.     assert latex(1/sin(x)) == r"\frac{1}{\sin{\left(x \right)}}"
161.     assert latex(sin(x)**-1) == r"\frac{1}{\sin{\left(x \right)}}"
162.     assert latex(sin(x)**Rational(3, 2)) == \
163.         r"\sin^{\frac{3}{2}}{\left(x \right)}"
164.     assert latex(sin(x)**Rational(3, 2), fold_frac_powers=True) == \
165.         r"\sin^{3/2}{\left(x \right)}"
166. 
167.     assert latex(~x) == r"\neg x"
168.     assert latex(x & y) == r"x \wedge y"
169.     assert latex(x & y & z) == r"x \wedge y \wedge z"
170.     assert latex(x | y) == r"x \vee y"
171.     assert latex(x | y | z) == r"x \vee y \vee z"
172.     assert latex((x & y) | z) == r"z \vee \left(x \wedge y\right)"
173.     assert latex(Implies(x, y)) == r"x \Rightarrow y"
174.     assert latex(~(x >> ~y)) == r"x \not\Rightarrow \neg y"
175.     assert latex(Implies(Or(x,y), z)) == r"\left(x \vee y\right) \Rightarrow z"
176.     assert latex(Implies(z, Or(x,y))) == r"z \Rightarrow \left(x \vee y\right)"
177.     assert latex(~(x & y)) == r"\neg \left(x \wedge y\right)"
178. 
179.     assert latex(~x, symbol_names={x: "x_i"}) == r"\neg x_i"
180.     assert latex(x & y, symbol_names={x: "x_i", y: "y_i"}) == \
181.         r"x_i \wedge y_i"
182.     assert latex(x & y & z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
183.         r"x_i \wedge y_i \wedge z_i"
184.     assert latex(x | y, symbol_names={x: "x_i", y: "y_i"}) == r"x_i \vee y_i"
185.     assert latex(x | y | z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
186.         r"x_i \vee y_i \vee z_i"
187.     assert latex((x & y) | z, symbol_names={x: "x_i", y: "y_i", z: "z_i"}) == \
188.         r"z_i \vee \left(x_i \wedge y_i\right)"
189.     assert latex(Implies(x, y), symbol_names={x: "x_i", y: "y_i"}) == \
190.         r"x_i \Rightarrow y_i"
191.     assert latex(Pow(Rational(1, 3), -1, evaluate=False)) == r"\frac{1}{\frac{1}{3}}"
192.     assert latex(Pow(Rational(1, 3), -2, evaluate=False)) == r"\frac{1}{(\frac{1}{3})^{2}}"
193.     assert latex(Pow(Integer(1)/100, -1, evaluate=False)) == r"\frac{1}{\frac{1}{100}}"
194. 
195. 
196.     p = Symbol('p', positive=True)
197.     assert latex(exp(-p)*log(p)) == r"e^{- p} \log{\left(p \right)}"
198. 
199. 
200. def test_latex_builtins():
201.     assert latex(True) == r"\text{True}"
202.     assert latex(False) == r"\text{False}"
203.     assert latex(None) == r"\text{None}"
204.     assert latex(true) == r"\text{True}"
205.     assert latex(false) == r'\text{False}'
206. 
207. 
208. def test_latex_SingularityFunction():
209.     assert latex(SingularityFunction(x, 4, 5)) == \
210.         r"{\left\langle x - 4 \right\rangle}^{5}"
211.     assert latex(SingularityFunction(x, -3, 4)) == \
212.         r"{\left\langle x + 3 \right\rangle}^{4}"
213.     assert latex(SingularityFunction(x, 0, 4)) == \
214.         r"{\left\langle x \right\rangle}^{4}"
215.     assert latex(SingularityFunction(x, a, n)) == \
216.         r"{\left\langle - a + x \right\rangle}^{n}"
217.     assert latex(SingularityFunction(x, 4, -2)) == \
218.         r"{\left\langle x - 4 \right\rangle}^{-2}"
219.     assert latex(SingularityFunction(x, 4, -1)) == \
220.         r"{\left\langle x - 4 \right\rangle}^{-1}"
221. 
222.     assert latex(SingularityFunction(x, 4, 5)**3) == \
223.         r"{\left({\langle x - 4 \rangle}^{5}\right)}^{3}"
224.     assert latex(SingularityFunction(x, -3, 4)**3) == \
225.         r"{\left({\langle x + 3 \rangle}^{4}\right)}^{3}"
226.     assert latex(SingularityFunction(x, 0, 4)**3) == \
227.         r"{\left({\langle x \rangle}^{4}\right)}^{3}"
228.     assert latex(SingularityFunction(x, a, n)**3) == \
229.         r"{\left({\langle - a + x \rangle}^{n}\right)}^{3}"
230.     assert latex(SingularityFunction(x, 4, -2)**3) == \
231.         r"{\left({\langle x - 4 \rangle}^{-2}\right)}^{3}"
232.     assert latex((SingularityFunction(x, 4, -1)**3)**3) == \
233.         r"{\left({\langle x - 4 \rangle}^{-1}\right)}^{9}"
234. 
235. 
236. def test_latex_cycle():
237.     assert latex(Cycle(1, 2, 4)) == r"\left( 1\; 2\; 4\right)"
238.     assert latex(Cycle(1, 2)(4, 5, 6)) == \
239.         r"\left( 1\; 2\right)\left( 4\; 5\; 6\right)"
240.     assert latex(Cycle()) == r"\left( \right)"
241. 
242. 
243. def test_latex_permutation():
244.     assert latex(Permutation(1, 2, 4)) == r"\left( 1\; 2\; 4\right)"
245.     assert latex(Permutation(1, 2)(4, 5, 6)) == \
246.         r"\left( 1\; 2\right)\left( 4\; 5\; 6\right)"
247.     assert latex(Permutation()) == r"\left( \right)"
248.     assert latex(Permutation(2, 4)*Permutation(5)) == \
249.         r"\left( 2\; 4\right)\left( 5\right)"
250.     assert latex(Permutation(5)) == r"\left( 5\right)"
251. 
252.     assert latex(Permutation(0, 1), perm_cyclic=False) == \
253.         r"\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}"
254.     assert latex(Permutation(0, 1)(2, 3), perm_cyclic=False) == \
255.         r"\begin{pmatrix} 0 & 1 & 2 & 3 \\ 1 & 0 & 3 & 2 \end{pmatrix}"
256.     assert latex(Permutation(), perm_cyclic=False) == \
257.         r"\left( \right)"
258. 
259. 
260. def test_latex_Float():
261.     assert latex(Float(1.0e100)) == r"1.0 \cdot 10^{100}"
262.     assert latex(Float(1.0e-100)) == r"1.0 \cdot 10^{-100}"
263.     assert latex(Float(1.0e-100), mul_symbol="times") == \
264.         r"1.0 \times 10^{-100}"
265.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=2) == \
266.         r"1.0 \cdot 10^{4}"
267.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=4) == \
268.         r"1.0 \cdot 10^{4}"
269.     assert latex(Float('10000.0'), full_prec=False, min=-2, max=5) == \
270.         r"10000.0"
271.     assert latex(Float('0.099999'), full_prec=True,  min=-2, max=5) == \
272.         r"9.99990000000000 \cdot 10^{-2}"
273. 
274. 
275. def test_latex_vector_expressions():
276.     A = CoordSys3D('A')
277. 
278.     assert latex(Cross(A.i, A.j*A.x*3+A.k)) == \
279.         r"\mathbf{\hat{i}_{A}} \times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}} + \mathbf{\hat{k}_{A}}\right)"
280.     assert latex(Cross(A.i, A.j)) == \
281.         r"\mathbf{\hat{i}_{A}} \times \mathbf{\hat{j}_{A}}"
282.     assert latex(x*Cross(A.i, A.j)) == \
283.         r"x \left(\mathbf{\hat{i}_{A}} \times \mathbf{\hat{j}_{A}}\right)"
284.     assert latex(Cross(x*A.i, A.j)) == \
285.         r'- \mathbf{\hat{j}_{A}} \times \left((x)\mathbf{\hat{i}_{A}}\right)'
286. 
287.     assert latex(Curl(3*A.x*A.j)) == \
288.         r"\nabla\times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
289.     assert latex(Curl(3*A.x*A.j+A.i)) == \
290.         r"\nabla\times \left(\mathbf{\hat{i}_{A}} + (3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
291.     assert latex(Curl(3*x*A.x*A.j)) == \
292.         r"\nabla\times \left((3 \mathbf{{x}_{A}} x)\mathbf{\hat{j}_{A}}\right)"
293.     assert latex(x*Curl(3*A.x*A.j)) == \
294.         r"x \left(\nabla\times \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)\right)"
295. 
296.     assert latex(Divergence(3*A.x*A.j+A.i)) == \
297.         r"\nabla\cdot \left(\mathbf{\hat{i}_{A}} + (3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
298.     assert latex(Divergence(3*A.x*A.j)) == \
299.         r"\nabla\cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)"
300.     assert latex(x*Divergence(3*A.x*A.j)) == \
301.         r"x \left(\nabla\cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}}\right)\right)"
302. 
303.     assert latex(Dot(A.i, A.j*A.x*3+A.k)) == \
304.         r"\mathbf{\hat{i}_{A}} \cdot \left((3 \mathbf{{x}_{A}})\mathbf{\hat{j}_{A}} + \mathbf{\hat{k}_{A}}\right)"
305.     assert latex(Dot(A.i, A.j)) == \
306.         r"\mathbf{\hat{i}_{A}} \cdot \mathbf{\hat{j}_{A}}"
307.     assert latex(Dot(x*A.i, A.j)) == \
308.         r"\mathbf{\hat{j}_{A}} \cdot \left((x)\mathbf{\hat{i}_{A}}\right)"
309.     assert latex(x*Dot(A.i, A.j)) == \
310.         r"x \left(\mathbf{\hat{i}_{A}} \cdot \mathbf{\hat{j}_{A}}\right)"
311. 
312.     assert latex(Gradient(A.x)) == r"\nabla \mathbf{{x}_{A}}"
313.     assert latex(Gradient(A.x + 3*A.y)) == \
314.         r"\nabla \left(\mathbf{{x}_{A}} + 3 \mathbf{{y}_{A}}\right)"
315.     assert latex(x*Gradient(A.x)) == r"x \left(\nabla \mathbf{{x}_{A}}\right)"
316.     assert latex(Gradient(x*A.x)) == r"\nabla \left(\mathbf{{x}_{A}} x\right)"
317. 
318.     assert latex(Laplacian(A.x)) == r"\triangle \mathbf{{x}_{A}}"
319.     assert latex(Laplacian(A.x + 3*A.y)) == \
320.         r"\triangle \left(\mathbf{{x}_{A}} + 3 \mathbf{{y}_{A}}\right)"
321.     assert latex(x*Laplacian(A.x)) == r"x \left(\triangle \mathbf{{x}_{A}}\right)"
322.     assert latex(Laplacian(x*A.x)) == r"\triangle \left(\mathbf{{x}_{A}} x\right)"
323. 
324. def test_latex_symbols():
325.     Gamma, lmbda, rho = symbols('Gamma, lambda, rho')
326.     tau, Tau, TAU, taU = symbols('tau, Tau, TAU, taU')
327.     assert latex(tau) == r"\tau"
328.     assert latex(Tau) == r"T"
329.     assert latex(TAU) == r"\tau"
330.     assert latex(taU) == r"\tau"
331.     # Check that all capitalized greek letters are handled explicitly
332.     capitalized_letters = {l.capitalize() for l in greek_letters_set}
333.     assert len(capitalized_letters - set(tex_greek_dictionary.keys())) == 0
334.     assert latex(Gamma + lmbda) == r"\Gamma + \lambda"
335.     assert latex(Gamma * lmbda) == r"\Gamma \lambda"
336.     assert latex(Symbol('q1')) == r"q_{1}"
337.     assert latex(Symbol('q21')) == r"q_{21}"
338.     assert latex(Symbol('epsilon0')) == r"\epsilon_{0}"
339.     assert latex(Symbol('omega1')) == r"\omega_{1}"
340.     assert latex(Symbol('91')) == r"91"
341.     assert latex(Symbol('alpha_new')) == r"\alpha_{new}"
342.     assert latex(Symbol('C^orig')) == r"C^{orig}"
343.     assert latex(Symbol('x^alpha')) == r"x^{\alpha}"
344.     assert latex(Symbol('beta^alpha')) == r"\beta^{\alpha}"
345.     assert latex(Symbol('e^Alpha')) == r"e^{A}"
346.     assert latex(Symbol('omega_alpha^beta')) == r"\omega^{\beta}_{\alpha}"
347.     assert latex(Symbol('omega') ** Symbol('beta')) == r"\omega^{\beta}"
348. 
349. 
350. @XFAIL
351. def test_latex_symbols_failing():
352.     rho, mass, volume = symbols('rho, mass, volume')
353.     assert latex(
354.         volume * rho == mass) == r"\rho \mathrm{volume} = \mathrm{mass}"
355.     assert latex(volume / mass * rho == 1) == \
356.         r"\rho \mathrm{volume} {\mathrm{mass}}^{(-1)} = 1"
357.     assert latex(mass**3 * volume**3) == \
358.         r"{\mathrm{mass}}^{3} \cdot {\mathrm{volume}}^{3}"
359. 
360. 
361. @_both_exp_pow
362. def test_latex_functions():
363.     assert latex(exp(x)) == r"e^{x}"
364.     assert latex(exp(1) + exp(2)) == r"e + e^{2}"
365. 
366.     f = Function('f')
367.     assert latex(f(x)) == r'f{\left(x \right)}'
368.     assert latex(f) == r'f'
369. 
370.     g = Function('g')
371.     assert latex(g(x, y)) == r'g{\left(x,y \right)}'
372.     assert latex(g) == r'g'
373. 
374.     h = Function('h')
375.     assert latex(h(x, y, z)) == r'h{\left(x,y,z \right)}'
376.     assert latex(h) == r'h'
377. 
378.     Li = Function('Li')
379.     assert latex(Li) == r'\operatorname{Li}'
380.     assert latex(Li(x)) == r'\operatorname{Li}{\left(x \right)}'
381. 
382.     mybeta = Function('beta')
383.     # not to be confused with the beta function
384.     assert latex(mybeta(x, y, z)) == r"\beta{\left(x,y,z \right)}"
385.     assert latex(beta(x, y)) == r'\operatorname{B}\left(x, y\right)'
386.     assert latex(beta(x, y)**2) == r'\operatorname{B}^{2}\left(x, y\right)'
387.     assert latex(mybeta(x)) == r"\beta{\left(x \right)}"
388.     assert latex(mybeta) == r"\beta"
389. 
390.     g = Function('gamma')
391.     # not to be confused with the gamma function
392.     assert latex(g(x, y, z)) == r"\gamma{\left(x,y,z \right)}"
393.     assert latex(g(x)) == r"\gamma{\left(x \right)}"
394.     assert latex(g) == r"\gamma"
395. 
396.     a1 = Function('a_1')
397. 
398.     assert latex(a1) == r"\operatorname{a_{1}}"
399.     assert latex(a1(x)) == r"\operatorname{a_{1}}{\left(x \right)}"
400. 
401.     # issue 5868
402.     omega1 = Function('omega1')
403.     assert latex(omega1) == r"\omega_{1}"
404.     assert latex(omega1(x)) == r"\omega_{1}{\left(x \right)}"
405. 
406.     assert latex(sin(x)) == r"\sin{\left(x \right)}"
407.     assert latex(sin(x), fold_func_brackets=True) == r"\sin {x}"
408.     assert latex(sin(2*x**2), fold_func_brackets=True) == \
409.         r"\sin {2 x^{2}}"
410.     assert latex(sin(x**2), fold_func_brackets=True) == \
411.         r"\sin {x^{2}}"
412. 
413.     assert latex(asin(x)**2) == r"\operatorname{asin}^{2}{\left(x \right)}"
414.     assert latex(asin(x)**2, inv_trig_style="full") == \
415.         r"\arcsin^{2}{\left(x \right)}"
416.     assert latex(asin(x)**2, inv_trig_style="power") == \
417.         r"\sin^{-1}{\left(x \right)}^{2}"
418.     assert latex(asin(x**2), inv_trig_style="power",
419.                  fold_func_brackets=True) == \
420.         r"\sin^{-1} {x^{2}}"
421.     assert latex(acsc(x), inv_trig_style="full") == \
422.         r"\operatorname{arccsc}{\left(x \right)}"
423.     assert latex(asinh(x), inv_trig_style="full") == \
424.         r"\operatorname{arcsinh}{\left(x \right)}"
425. 
426.     assert latex(factorial(k)) == r"k!"
427.     assert latex(factorial(-k)) == r"\left(- k\right)!"
428.     assert latex(factorial(k)**2) == r"k!^{2}"
429. 
430.     assert latex(subfactorial(k)) == r"!k"
431.     assert latex(subfactorial(-k)) == r"!\left(- k\right)"
432.     assert latex(subfactorial(k)**2) == r"\left(!k\right)^{2}"
433. 
434.     assert latex(factorial2(k)) == r"k!!"
435.     assert latex(factorial2(-k)) == r"\left(- k\right)!!"
436.     assert latex(factorial2(k)**2) == r"k!!^{2}"
437. 
438.     assert latex(binomial(2, k)) == r"{\binom{2}{k}}"
439.     assert latex(binomial(2, k)**2) == r"{\binom{2}{k}}^{2}"
440. 
441.     assert latex(FallingFactorial(3, k)) == r"{\left(3\right)}_{k}"
442.     assert latex(RisingFactorial(3, k)) == r"{3}^{\left(k\right)}"
443. 
444.     assert latex(floor(x)) == r"\left\lfloor{x}\right\rfloor"
445.     assert latex(ceiling(x)) == r"\left\lceil{x}\right\rceil"
446.     assert latex(frac(x)) == r"\operatorname{frac}{\left(x\right)}"
447.     assert latex(floor(x)**2) == r"\left\lfloor{x}\right\rfloor^{2}"
448.     assert latex(ceiling(x)**2) == r"\left\lceil{x}\right\rceil^{2}"
449.     assert latex(frac(x)**2) == r"\operatorname{frac}{\left(x\right)}^{2}"
450. 
451.     assert latex(Min(x, 2, x**3)) == r"\min\left(2, x, x^{3}\right)"
452.     assert latex(Min(x, y)**2) == r"\min\left(x, y\right)^{2}"
453.     assert latex(Max(x, 2, x**3)) == r"\max\left(2, x, x^{3}\right)"
454.     assert latex(Max(x, y)**2) == r"\max\left(x, y\right)^{2}"
455.     assert latex(Abs(x)) == r"\left|{x}\right|"
456.     assert latex(Abs(x)**2) == r"\left|{x}\right|^{2}"
457.     assert latex(re(x)) == r"\operatorname{re}{\left(x\right)}"
458.     assert latex(re(x + y)) == \
459.         r"\operatorname{re}{\left(x\right)} + \operatorname{re}{\left(y\right)}"
460.     assert latex(im(x)) == r"\operatorname{im}{\left(x\right)}"
461.     assert latex(conjugate(x)) == r"\overline{x}"
462.     assert latex(conjugate(x)**2) == r"\overline{x}^{2}"
463.     assert latex(conjugate(x**2)) == r"\overline{x}^{2}"
464.     assert latex(gamma(x)) == r"\Gamma\left(x\right)"
465.     w = Wild('w')
466.     assert latex(gamma(w)) == r"\Gamma\left(w\right)"
467.     assert latex(Order(x)) == r"O\left(x\right)"
468.     assert latex(Order(x, x)) == r"O\left(x\right)"
469.     assert latex(Order(x, (x, 0))) == r"O\left(x\right)"
470.     assert latex(Order(x, (x, oo))) == r"O\left(x; x\rightarrow \infty\right)"
471.     assert latex(Order(x - y, (x, y))) == \
472.         r"O\left(x - y; x\rightarrow y\right)"
473.     assert latex(Order(x, x, y)) == \
474.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( 0, \  0\right)\right)"
475.     assert latex(Order(x, x, y)) == \
476.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( 0, \  0\right)\right)"
477.     assert latex(Order(x, (x, oo), (y, oo))) == \
478.         r"O\left(x; \left( x, \  y\right)\rightarrow \left( \infty, \  \infty\right)\right)"
479.     assert latex(lowergamma(x, y)) == r'\gamma\left(x, y\right)'
480.     assert latex(lowergamma(x, y)**2) == r'\gamma^{2}\left(x, y\right)'
481.     assert latex(uppergamma(x, y)) == r'\Gamma\left(x, y\right)'
482.     assert latex(uppergamma(x, y)**2) == r'\Gamma^{2}\left(x, y\right)'
483. 
484.     assert latex(cot(x)) == r'\cot{\left(x \right)}'
485.     assert latex(coth(x)) == r'\coth{\left(x \right)}'
486.     assert latex(re(x)) == r'\operatorname{re}{\left(x\right)}'
487.     assert latex(im(x)) == r'\operatorname{im}{\left(x\right)}'
488.     assert latex(root(x, y)) == r'x^{\frac{1}{y}}'
489.     assert latex(arg(x)) == r'\arg{\left(x \right)}'
490. 
491.     assert latex(zeta(x)) == r"\zeta\left(x\right)"
492.     assert latex(zeta(x)**2) == r"\zeta^{2}\left(x\right)"
493.     assert latex(zeta(x, y)) == r"\zeta\left(x, y\right)"
494.     assert latex(zeta(x, y)**2) == r"\zeta^{2}\left(x, y\right)"
495.     assert latex(dirichlet_eta(x)) == r"\eta\left(x\right)"
496.     assert latex(dirichlet_eta(x)**2) == r"\eta^{2}\left(x\right)"
497.     assert latex(polylog(x, y)) == r"\operatorname{Li}_{x}\left(y\right)"
498.     assert latex(
499.         polylog(x, y)**2) == r"\operatorname{Li}_{x}^{2}\left(y\right)"
500.     assert latex(lerchphi(x, y, n)) == r"\Phi\left(x, y, n\right)"

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 03:02:36,208 - thread-125894574212800.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have analyzed the user's query, the provided patch, and the available context. The user wants 3 relevant test cases for a LaTeX printing issue with double superscripts. The provided context from `sympy/printing/tests/test_latex.py` and `sympy/physics/tests/test_secondquant.py` is sufficient. `sympy/printing/tests/test_latex.py` contains highly relevant test cases for printing powers of expressions, including those with existing superscripts or other decorations. I have identified tests for powers of symbols with superscripts (`x_star**2`), powers of functions rendering with superscripts (`SingularityFunction`), and powers of functions with overlines (`conjugate(x)**2`). These are sufficient to understand the current behavior and verify the patch. The `test_secondquant.py` file, while relevant to the module in question, lacks specific tests for the LaTeX printing of powers of its objects. Therefore, no additional context is needed." query='' extra_requirements='' purpose=''
2025-12-21 03:02:36,209 - thread-125894574212800.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
