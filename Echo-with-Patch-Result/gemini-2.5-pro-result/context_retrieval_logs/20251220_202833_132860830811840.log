2025-12-20 20:28:33,952 - thread-132860830811840.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-20 20:28:34,023 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19214-DS.rst
|   |   |   |   ├── 19368-DS.rst
|   |   |   |   ├── 20426-JK.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   ├── 21026-DS.rst
|   |   |   |   ├── 21042-AL.rst
|   |   |   |   ├── 21238-AL.rst
|   |   |   |   ├── 21983-AL.rst
|   |   |   |   ├── 22013-AL.rst
|   |   |   |   ├── 22063-SR.rst
|   |   |   |   ├── 22204-AL.rst
|   |   |   |   ├── 22229-TAC.rst
|   |   |   |   ├── 22485-TH.rst
|   |   |   |   ├── 22567-IT.rst
|   |   |   |   ├── 22639-RA.rst
|   |   |   |   ├── 22691-JMK.rst
|   |   |   |   ├── 22745-JMK.rst
|   |   |   |   ├── 23031-AL.rst
|   |   |   |   ├── 23170-JMK.rst
|   |   |   |   ├── 23188-JMK.rst
|   |   |   |   └── 23270-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20071-AL.rst
|   |   |   |   ├── 20839-EP.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   ├── 21425-AL.rst
|   |   |   |   ├── 21584-AL.rst
|   |   |   |   ├── 21962-AL.rst
|   |   |   |   ├── 21965-AL.rst
|   |   |   |   ├── 21981-AL.rst
|   |   |   |   ├── 21982-AL.rst
|   |   |   |   ├── 21992-AL.rst
|   |   |   |   ├── 21995-AL.rst
|   |   |   |   ├── 22021-AL.rst
|   |   |   |   ├── 22025-AL.rst
|   |   |   |   ├── 22050-AL.rst
|   |   |   |   ├── 22051-AL.rst
|   |   |   |   ├── 22084-SS.rst
|   |   |   |   ├── 22097-AL.rst
|   |   |   |   ├── 22098-AL.rst
|   |   |   |   ├── 22123-TH.rst
|   |   |   |   ├── 22133-OG.rst
|   |   |   |   ├── 22134-OG.rst
|   |   |   |   ├── 22148-OG.rst
|   |   |   |   ├── 22167-EP.rst
|   |   |   |   ├── 22245-AL.rst
|   |   |   |   ├── 22268-OG.rst
|   |   |   |   ├── 22298-GL.rst
|   |   |   |   ├── 22317-AL.rst
|   |   |   |   ├── 22323-GL.rst
|   |   |   |   ├── 22345-JK.rst
|   |   |   |   ├── 22415-AL.rst
|   |   |   |   ├── 22418-AL.rst
|   |   |   |   ├── 22421-AL.rst
|   |   |   |   ├── 22422-AL.rst
|   |   |   |   ├── 22490-AL.rst
|   |   |   |   ├── 22503-AL.rst
|   |   |   |   ├── 22509-AL.rst
|   |   |   |   ├── 22539-AL.rst
|   |   |   |   ├── 22547-AL.rst
|   |   |   |   ├── 22554-AL.rst
|   |   |   |   ├── 22697-OG.rst
|   |   |   |   ├── 22725-AL.rst
|   |   |   |   ├── 22797-OG.rst
|   |   |   |   ├── 22813-GL.rst
|   |   |   |   ├── 22883-AL.rst
|   |   |   |   ├── 22885-AL.rst
|   |   |   |   ├── 23014-OG.rst
|   |   |   |   ├── 23045-OG.rst
|   |   |   |   ├── 23081-OG.rst
|   |   |   |   ├── 23166-ES.rst
|   |   |   |   ├── 23190-OG.rst
|   |   |   |   ├── 23232-TH.rst
|   |   |   |   ├── 23289-AL.rst
|   |   |   |   ├── 23302-TH.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 21415-AL.rst
|   |   |   |   ├── 22205-ES.rst
|   |   |   |   └── 22550-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 00001-DS.rst
|   |   |       ├── 20990-AL.rst
|   |   |       ├── 21395-AL.rst
|   |   |       ├── 21591-AL.rst
|   |   |       ├── 21980-CC.rst
|   |   |       ├── 22081-AL.rst
|   |   |       ├── 22107-OG.rst
|   |   |       ├── 22365-OG.rst
|   |   |       ├── 22465-AL.rst
|   |   |       ├── 22486-OG.rst
|   |   |       ├── 22514-OG.rst
|   |   |       ├── 22516-OG.rst
|   |   |       ├── 22738-JL.rst
|   |   |       ├── 22886-OG.rst
|   |   |       ├── 22952-TH.rst
|   |   |       ├── 23076-GL.rst
|   |   |       ├── 23077-GL.rst
|   |   |       ├── 23078-GL.rst
|   |   |       ├── 23079-GL.rst
|   |   |       ├── 23093-GL.rst
|   |   |       └── 23237-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   └── api_changes_3.5.2.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plot_focal_length.rst
|       |   ├── 3d_plot_roll_angle.rst
|       |   ├── README.rst
|       |   ├── asinh_scale.rst
|       |   ├── color_support_for_math_to_image.rst
|       |   ├── custom_cap_widths.rst
|       |   ├── double_quotes_matplolibrc.rst
|       |   ├── extending_MarkerStyle.rst
|       |   ├── inset_axes_improvements.rst
|       |   ├── layout_engine.rst
|       |   ├── list_font_names.rst
|       |   ├── marker_none.rst
|       |   ├── min_macos_version.rst
|       |   ├── modify_stairs_fill_edge_behaviour.rst
|       |   ├── no_broken_streamlines.rst
|       |   ├── polygon_selector_box.rst
|       |   ├── polygon_vert_setter.rst
|       |   ├── rectangle_patch_rotation.rst
|       |   ├── rename_ncol_keyword_in_legend.rst
|       |   ├── selector_improvement.rst
|       |   ├── snap_selector.rst
|       |   ├── striped_lines.rst
|       |   ├── url_active_areas_rotate.rst
|       |   ├── use_contourpy.rst
|       |   └── windows_arm64.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   └── whats_new_3.5.2.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 20:28:50,951 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user is reporting a bug related to `rc_context` and `get_backend` affecting figure management in `pyplot`. To find relevant test cases, I need to examine tests for `rcParams` and `pyplot`. `lib/matplotlib/tests/test_rcparams.py` is the most likely place to find tests for `rc_context`, and `lib/matplotlib/tests/test_pyplot.py` will contain tests for figure management via `pyplot`. Access to both files is necessary to find test cases that cover the interaction between these components, which is where the bug occurs.' query='Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.' extra_requirements='' purpose='I need to find 3 relevant test cases that demonstrate the reported bug, and these files are the most likely to contain them.'
2025-12-20 20:28:50,953 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.
2025-12-20 20:28:50,953 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 20:28:50,953 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 20:28:50,954 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 20:28:50,954 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.
Purpose: I need to find 3 relevant test cases that demonstrate the reported bug, and these files are the most likely to contain them.
2025-12-20 20:28:53,181 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the contents of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py` to help you find relevant test cases for the bug you're investigating." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_pyplot.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2145, 'candidates_token_count': 100, 'total_token_count': 2323, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2145}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 100}], 'thoughts_token_count': 78, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.06042980194091797, 'model_name': 'gemini-2.5-pro'} id='run--de11bcc8-c5fd-4a48-be89-ae5094d884be-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_rcparams.py'}, 'id': 'cc5c0e10-af13-42f1-ae78-4da8e499dd12', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_pyplot.py'}, 'id': '1d471383-9ddc-4463-8ef3-e589efcb97b3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2145, 'output_tokens': 100, 'total_tokens': 2323, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 78}}
2025-12-20 20:28:57,801 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py` for you. You can now examine these files to find the relevant test cases for the bug you are investigating.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16249, 'candidates_token_count': 56, 'total_token_count': 16667, 'cached_content_token_count': 1876, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16249}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1876}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 56}], 'thoughts_token_count': 362}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5570088795253209, 'model_name': 'gemini-2.5-pro'} id='run--c865c1d9-81c9-42bd-8f3b-b217c085813f-0' usage_metadata={'input_tokens': 16249, 'output_tokens': 56, 'total_tokens': 16667, 'input_token_details': {'cache_read': 1876}, 'output_token_details': {'reasoning': 362}}
2025-12-20 20:28:57,803 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find 3 relevant test cases that demonstrate the reported bug, and these files are the most likely to contain them.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_pyplot.py
Line number range: 1 - 385
Content:
1. import difflib
2. import re
3. 
4. import numpy as np
5. import subprocess
6. import sys
7. from pathlib import Path
8. 
9. import pytest
10. 
11. import matplotlib as mpl
12. from matplotlib import pyplot as plt
13. from matplotlib._api import MatplotlibDeprecationWarning
14. 
15. 
16. def test_pyplot_up_to_date(tmpdir):
17.     gen_script = Path(mpl.__file__).parents[2] / "tools/boilerplate.py"
18.     if not gen_script.exists():
19.         pytest.skip("boilerplate.py not found")
20.     orig_contents = Path(plt.__file__).read_text()
21.     plt_file = tmpdir.join('pyplot.py')
22.     plt_file.write_text(orig_contents, 'utf-8')
23. 
24.     subprocess.run([sys.executable, str(gen_script), str(plt_file)],
25.                    check=True)
26.     new_contents = plt_file.read_text('utf-8')
27. 
28.     if orig_contents != new_contents:
29.         diff_msg = '\n'.join(
30.             difflib.unified_diff(
31.                 orig_contents.split('\n'), new_contents.split('\n'),
32.                 fromfile='found pyplot.py',
33.                 tofile='expected pyplot.py',
34.                 n=0, lineterm=''))
35.         pytest.fail(
36.             "pyplot.py is not up-to-date. Please run "
37.             "'python tools/boilerplate.py' to update pyplot.py. "
38.             "This needs to be done from an environment where your "
39.             "current working copy is installed (e.g. 'pip install -e'd). "
40.             "Here is a diff of unexpected differences:\n%s" % diff_msg
41.         )
42. 
43. 
44. def test_copy_docstring_and_deprecators(recwarn):
45.     @mpl._api.rename_parameter("(version)", "old", "new")
46.     @mpl._api.make_keyword_only("(version)", "kwo")
47.     def func(new, kwo=None):
48.         pass
49. 
50.     @plt._copy_docstring_and_deprecators(func)
51.     def wrapper_func(new, kwo=None):
52.         pass
53. 
54.     wrapper_func(None)
55.     wrapper_func(new=None)
56.     wrapper_func(None, kwo=None)
57.     wrapper_func(new=None, kwo=None)
58.     assert not recwarn
59.     with pytest.warns(MatplotlibDeprecationWarning):
60.         wrapper_func(old=None)
61.     with pytest.warns(MatplotlibDeprecationWarning):
62.         wrapper_func(None, None)
63. 
64. 
65. def test_pyplot_box():
66.     fig, ax = plt.subplots()
67.     plt.box(False)
68.     assert not ax.get_frame_on()
69.     plt.box(True)
70.     assert ax.get_frame_on()
71.     plt.box()
72.     assert not ax.get_frame_on()
73.     plt.box()
74.     assert ax.get_frame_on()
75. 
76. 
77. def test_stackplot_smoke():
78.     # Small smoke test for stackplot (see #12405)
79.     plt.stackplot([1, 2, 3], [1, 2, 3])
80. 
81. 
82. def test_nrows_error():
83.     with pytest.raises(TypeError):
84.         plt.subplot(nrows=1)
85.     with pytest.raises(TypeError):
86.         plt.subplot(ncols=1)
87. 
88. 
89. def test_ioff():
90.     plt.ion()
91.     assert mpl.is_interactive()
92.     with plt.ioff():
93.         assert not mpl.is_interactive()
94.     assert mpl.is_interactive()
95. 
96.     plt.ioff()
97.     assert not mpl.is_interactive()
98.     with plt.ioff():
99.         assert not mpl.is_interactive()
100.     assert not mpl.is_interactive()
101. 
102. 
103. def test_ion():
104.     plt.ioff()
105.     assert not mpl.is_interactive()
106.     with plt.ion():
107.         assert mpl.is_interactive()
108.     assert not mpl.is_interactive()
109. 
110.     plt.ion()
111.     assert mpl.is_interactive()
112.     with plt.ion():
113.         assert mpl.is_interactive()
114.     assert mpl.is_interactive()
115. 
116. 
117. def test_nested_ion_ioff():
118.     # initial state is interactive
119.     plt.ion()
120. 
121.     # mixed ioff/ion
122.     with plt.ioff():
123.         assert not mpl.is_interactive()
124.         with plt.ion():
125.             assert mpl.is_interactive()
126.         assert not mpl.is_interactive()
127.     assert mpl.is_interactive()
128. 
129.     # redundant contexts
130.     with plt.ioff():
131.         with plt.ioff():
132.             assert not mpl.is_interactive()
133.     assert mpl.is_interactive()
134. 
135.     with plt.ion():
136.         plt.ioff()
137.     assert mpl.is_interactive()
138. 
139.     # initial state is not interactive
140.     plt.ioff()
141. 
142.     # mixed ioff/ion
143.     with plt.ion():
144.         assert mpl.is_interactive()
145.         with plt.ioff():
146.             assert not mpl.is_interactive()
147.         assert mpl.is_interactive()
148.     assert not mpl.is_interactive()
149. 
150.     # redundant contexts
151.     with plt.ion():
152.         with plt.ion():
153.             assert mpl.is_interactive()
154.     assert not mpl.is_interactive()
155. 
156.     with plt.ioff():
157.         plt.ion()
158.     assert not mpl.is_interactive()
159. 
160. 
161. def test_close():
162.     try:
163.         plt.close(1.1)
164.     except TypeError as e:
165.         assert str(e) == "close() argument must be a Figure, an int, " \
166.                          "a string, or None, not <class 'float'>"
167. 
168. 
169. def test_subplot_reuse():
170.     ax1 = plt.subplot(121)
171.     assert ax1 is plt.gca()
172.     ax2 = plt.subplot(122)
173.     assert ax2 is plt.gca()
174.     ax3 = plt.subplot(121)
175.     assert ax1 is plt.gca()
176.     assert ax1 is ax3
177. 
178. 
179. def test_axes_kwargs():
180.     # plt.axes() always creates new axes, even if axes kwargs differ.
181.     plt.figure()
182.     ax = plt.axes()
183.     ax1 = plt.axes()
184.     assert ax is not None
185.     assert ax1 is not ax
186.     plt.close()
187. 
188.     plt.figure()
189.     ax = plt.axes(projection='polar')
190.     ax1 = plt.axes(projection='polar')
191.     assert ax is not None
192.     assert ax1 is not ax
193.     plt.close()
194. 
195.     plt.figure()
196.     ax = plt.axes(projection='polar')
197.     ax1 = plt.axes()
198.     assert ax is not None
199.     assert ax1.name == 'rectilinear'
200.     assert ax1 is not ax
201.     plt.close()
202. 
203. 
204. def test_subplot_replace_projection():
205.     # plt.subplot() searches for axes with the same subplot spec, and if one
206.     # exists, and the kwargs match returns it, create a new one if they do not
207.     fig = plt.figure()
208.     ax = plt.subplot(1, 2, 1)
209.     ax1 = plt.subplot(1, 2, 1)
210.     ax2 = plt.subplot(1, 2, 2)
211.     with pytest.warns(MatplotlibDeprecationWarning):
212.         ax3 = plt.subplot(1, 2, 1, projection='polar')
213.     ax4 = plt.subplot(1, 2, 1, projection='polar')
214.     assert ax is not None
215.     assert ax1 is ax
216.     assert ax2 is not ax
217.     assert ax3 is not ax
218.     assert ax3 is ax4
219. 
220.     assert ax not in fig.axes
221.     assert ax2 in fig.axes
222.     assert ax3 in fig.axes
223. 
224.     assert ax.name == 'rectilinear'
225.     assert ax2.name == 'rectilinear'
226.     assert ax3.name == 'polar'
227. 
228. 
229. def test_subplot_kwarg_collision():
230.     ax1 = plt.subplot(projection='polar', theta_offset=0)
231.     ax2 = plt.subplot(projection='polar', theta_offset=0)
232.     assert ax1 is ax2
233.     ax1.remove()
234.     ax3 = plt.subplot(projection='polar', theta_offset=1)
235.     assert ax1 is not ax3
236.     assert ax1 not in plt.gcf().axes
237. 
238. 
239. def test_gca():
240.     # plt.gca() returns an existing axes, unless there were no axes.
241.     plt.figure()
242.     ax = plt.gca()
243.     ax1 = plt.gca()
244.     assert ax is not None
245.     assert ax1 is ax
246.     plt.close()
247. 
248. 
249. def test_subplot_projection_reuse():
250.     # create an Axes
251.     ax1 = plt.subplot(111)
252.     # check that it is current
253.     assert ax1 is plt.gca()
254.     # make sure we get it back if we ask again
255.     assert ax1 is plt.subplot(111)
256.     # remove it
257.     ax1.remove()
258.     # create a polar plot
259.     ax2 = plt.subplot(111, projection='polar')
260.     assert ax2 is plt.gca()
261.     # this should have deleted the first axes
262.     assert ax1 not in plt.gcf().axes
263.     # assert we get it back if no extra parameters passed
264.     assert ax2 is plt.subplot(111)
265.     ax2.remove()
266.     # now check explicitly setting the projection to rectilinear
267.     # makes a new axes
268.     ax3 = plt.subplot(111, projection='rectilinear')
269.     assert ax3 is plt.gca()
270.     assert ax3 is not ax2
271.     assert ax2 not in plt.gcf().axes
272. 
273. 
274. def test_subplot_polar_normalization():
275.     ax1 = plt.subplot(111, projection='polar')
276.     ax2 = plt.subplot(111, polar=True)
277.     ax3 = plt.subplot(111, polar=True, projection='polar')
278.     assert ax1 is ax2
279.     assert ax1 is ax3
280. 
281.     with pytest.raises(ValueError,
282.                        match="polar=True, yet projection='3d'"):
283.         ax2 = plt.subplot(111, polar=True, projection='3d')
284. 
285. 
286. def test_subplot_change_projection():
287.     created_axes = set()
288.     ax = plt.subplot()
289.     created_axes.add(ax)
290.     projections = ('aitoff', 'hammer', 'lambert', 'mollweide',
291.                    'polar', 'rectilinear', '3d')
292.     for proj in projections:
293.         ax.remove()
294.         ax = plt.subplot(projection=proj)
295.         assert ax is plt.subplot()
296.         assert ax.name == proj
297.         created_axes.add(ax)
298.     # Check that each call created a new Axes.
299.     assert len(created_axes) == 1 + len(projections)
300. 
301. 
302. def test_polar_second_call():
303.     # the first call creates the axes with polar projection
304.     ln1, = plt.polar(0., 1., 'ro')
305.     assert isinstance(ln1, mpl.lines.Line2D)
306.     # the second call should reuse the existing axes
307.     ln2, = plt.polar(1.57, .5, 'bo')
308.     assert isinstance(ln2, mpl.lines.Line2D)
309.     assert ln1.axes is ln2.axes
310. 
311. 
312. def test_fallback_position():
313.     # check that position kwarg works if rect not supplied
314.     axref = plt.axes([0.2, 0.2, 0.5, 0.5])
315.     axtest = plt.axes(position=[0.2, 0.2, 0.5, 0.5])
316.     np.testing.assert_allclose(axtest.bbox.get_points(),
317.                                axref.bbox.get_points())
318. 
319.     # check that position kwarg ignored if rect is supplied
320.     axref = plt.axes([0.2, 0.2, 0.5, 0.5])
321.     axtest = plt.axes([0.2, 0.2, 0.5, 0.5], position=[0.1, 0.1, 0.8, 0.8])
322.     np.testing.assert_allclose(axtest.bbox.get_points(),
323.                                axref.bbox.get_points())
324. 
325. 
326. def test_set_current_figure_via_subfigure():
327.     fig1 = plt.figure()
328.     subfigs = fig1.subfigures(2)
329. 
330.     plt.figure()
331.     assert plt.gcf() != fig1
332. 
333.     current = plt.figure(subfigs[1])
334.     assert plt.gcf() == fig1
335.     assert current == fig1
336. 
337. 
338. def test_set_current_axes_on_subfigure():
339.     fig = plt.figure()
340.     subfigs = fig.subfigures(2)
341. 
342.     ax = subfigs[0].subplots(1, squeeze=True)
343.     subfigs[1].subplots(1, squeeze=True)
344. 
345.     assert plt.gca() != ax
346.     plt.sca(ax)
347.     assert plt.gca() == ax
348. 
349. 
350. def test_pylab_integration():
351.     IPython = pytest.importorskip("IPython")
352.     mpl.testing.subprocess_run_helper(
353.         IPython.start_ipython,
354.         "--pylab",
355.         "-c",
356.         ";".join((
357.             "import matplotlib.pyplot as plt",
358.             "assert plt._REPL_DISPLAYHOOK == plt._ReplDisplayHook.IPYTHON",
359.         )),
360.         timeout=60,
361.     )
362. 
363. 
364. def test_doc_pyplot_summary():
365.     """Test that pyplot_summary lists all the plot functions."""
366.     pyplot_docs = Path(__file__).parent / '../../../doc/api/pyplot_summary.rst'
367.     if not pyplot_docs.exists():
368.         pytest.skip("Documentation sources not available")
369. 
370.     lines = pyplot_docs.read_text()
371.     m = re.search(r':nosignatures:\n\n(.*?)\n\n', lines, re.DOTALL)
372.     doc_functions = set(line.strip() for line in m.group(1).split('\n'))
373.     plot_commands = set(plt.get_plot_commands())
374.     missing = plot_commands.difference(doc_functions)
375.     if missing:
376.         raise AssertionError(
377.             f"The following pyplot functions are not listed in the "
378.             f"documentation. Please add them to doc/api/pyplot_summary.rst: "
379.             f"{missing!r}")
380.     extra = doc_functions.difference(plot_commands)
381.     if extra:
382.         raise AssertionError(
383.             f"The following functions are listed in the pyplot documentation, "
384.             f"but they do not exist in pyplot. "
385.             f"Please remove them from doc/api/pyplot_summary.rst: {extra!r}")


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 1 - 500
Content:
1. import copy
2. import os
3. from pathlib import Path
4. import subprocess
5. import sys
6. from unittest import mock
7. 
8. from cycler import cycler, Cycler
9. import pytest
10. 
11. import matplotlib as mpl
12. from matplotlib import _api, _c_internal_utils
13. import matplotlib.pyplot as plt
14. import matplotlib.colors as mcolors
15. import numpy as np
16. from matplotlib.rcsetup import (
17.     validate_bool,
18.     validate_color,
19.     validate_colorlist,
20.     _validate_color_or_linecolor,
21.     validate_cycler,
22.     validate_float,
23.     validate_fontstretch,
24.     validate_fontweight,
25.     validate_hatch,
26.     validate_hist_bins,
27.     validate_int,
28.     validate_markevery,
29.     validate_stringlist,
30.     _validate_linestyle,
31.     _listify_validator)
32. 
33. 
34. def test_rcparams(tmpdir):
35.     mpl.rc('text', usetex=False)
36.     mpl.rc('lines', linewidth=22)
37. 
38.     usetex = mpl.rcParams['text.usetex']
39.     linewidth = mpl.rcParams['lines.linewidth']
40. 
41.     rcpath = Path(tmpdir) / 'test_rcparams.rc'
42.     rcpath.write_text('lines.linewidth: 33', encoding='utf-8')
43. 
44.     # test context given dictionary
45.     with mpl.rc_context(rc={'text.usetex': not usetex}):
46.         assert mpl.rcParams['text.usetex'] == (not usetex)
47.     assert mpl.rcParams['text.usetex'] == usetex
48. 
49.     # test context given filename (mpl.rc sets linewidth to 33)
50.     with mpl.rc_context(fname=rcpath):
51.         assert mpl.rcParams['lines.linewidth'] == 33
52.     assert mpl.rcParams['lines.linewidth'] == linewidth
53. 
54.     # test context given filename and dictionary
55.     with mpl.rc_context(fname=rcpath, rc={'lines.linewidth': 44}):
56.         assert mpl.rcParams['lines.linewidth'] == 44
57.     assert mpl.rcParams['lines.linewidth'] == linewidth
58. 
59.     # test context as decorator (and test reusability, by calling func twice)
60.     @mpl.rc_context({'lines.linewidth': 44})
61.     def func():
62.         assert mpl.rcParams['lines.linewidth'] == 44
63. 
64.     func()
65.     func()
66. 
67.     # test rc_file
68.     mpl.rc_file(rcpath)
69.     assert mpl.rcParams['lines.linewidth'] == 33
70. 
71. 
72. def test_RcParams_class():
73.     rc = mpl.RcParams({'font.cursive': ['Apple Chancery',
74.                                         'Textile',
75.                                         'Zapf Chancery',
76.                                         'cursive'],
77.                        'font.family': 'sans-serif',
78.                        'font.weight': 'normal',
79.                        'font.size': 12})
80. 
81.     expected_repr = """
82. RcParams({'font.cursive': ['Apple Chancery',
83.                            'Textile',
84.                            'Zapf Chancery',
85.                            'cursive'],
86.           'font.family': ['sans-serif'],
87.           'font.size': 12.0,
88.           'font.weight': 'normal'})""".lstrip()
89. 
90.     assert expected_repr == repr(rc)
91. 
92.     expected_str = """
93. font.cursive: ['Apple Chancery', 'Textile', 'Zapf Chancery', 'cursive']
94. font.family: ['sans-serif']
95. font.size: 12.0
96. font.weight: normal""".lstrip()
97. 
98.     assert expected_str == str(rc)
99. 
100.     # test the find_all functionality
101.     assert ['font.cursive', 'font.size'] == sorted(rc.find_all('i[vz]'))
102.     assert ['font.family'] == list(rc.find_all('family'))
103. 
104. 
105. def test_rcparams_update():
106.     rc = mpl.RcParams({'figure.figsize': (3.5, 42)})
107.     bad_dict = {'figure.figsize': (3.5, 42, 1)}
108.     # make sure validation happens on input
109.     with pytest.raises(ValueError), \
110.          pytest.warns(UserWarning, match="validate"):
111.         rc.update(bad_dict)
112. 
113. 
114. def test_rcparams_init():
115.     with pytest.raises(ValueError), \
116.          pytest.warns(UserWarning, match="validate"):
117.         mpl.RcParams({'figure.figsize': (3.5, 42, 1)})
118. 
119. 
120. def test_Bug_2543():
121.     # Test that it possible to add all values to itself / deepcopy
122.     # https://github.com/matplotlib/matplotlib/issues/2543
123.     # We filter warnings at this stage since a number of them are raised
124.     # for deprecated rcparams as they should. We don't want these in the
125.     # printed in the test suite.
126.     with _api.suppress_matplotlib_deprecation_warning():
127.         with mpl.rc_context():
128.             _copy = mpl.rcParams.copy()
129.             for key in _copy:
130.                 mpl.rcParams[key] = _copy[key]
131.         with mpl.rc_context():
132.             copy.deepcopy(mpl.rcParams)
133.     with pytest.raises(ValueError):
134.         validate_bool(None)
135.     with pytest.raises(ValueError):
136.         with mpl.rc_context():
137.             mpl.rcParams['svg.fonttype'] = True
138. 
139. 
140. legend_color_tests = [
141.     ('face', {'color': 'r'}, mcolors.to_rgba('r')),
142.     ('face', {'color': 'inherit', 'axes.facecolor': 'r'},
143.      mcolors.to_rgba('r')),
144.     ('face', {'color': 'g', 'axes.facecolor': 'r'}, mcolors.to_rgba('g')),
145.     ('edge', {'color': 'r'}, mcolors.to_rgba('r')),
146.     ('edge', {'color': 'inherit', 'axes.edgecolor': 'r'},
147.      mcolors.to_rgba('r')),
148.     ('edge', {'color': 'g', 'axes.facecolor': 'r'}, mcolors.to_rgba('g'))
149. ]
150. legend_color_test_ids = [
151.     'same facecolor',
152.     'inherited facecolor',
153.     'different facecolor',
154.     'same edgecolor',
155.     'inherited edgecolor',
156.     'different facecolor',
157. ]
158. 
159. 
160. @pytest.mark.parametrize('color_type, param_dict, target', legend_color_tests,
161.                          ids=legend_color_test_ids)
162. def test_legend_colors(color_type, param_dict, target):
163.     param_dict[f'legend.{color_type}color'] = param_dict.pop('color')
164.     get_func = f'get_{color_type}color'
165. 
166.     with mpl.rc_context(param_dict):
167.         _, ax = plt.subplots()
168.         ax.plot(range(3), label='test')
169.         leg = ax.legend()
170.         assert getattr(leg.legendPatch, get_func)() == target
171. 
172. 
173. def test_mfc_rcparams():
174.     mpl.rcParams['lines.markerfacecolor'] = 'r'
175.     ln = mpl.lines.Line2D([1, 2], [1, 2])
176.     assert ln.get_markerfacecolor() == 'r'
177. 
178. 
179. def test_mec_rcparams():
180.     mpl.rcParams['lines.markeredgecolor'] = 'r'
181.     ln = mpl.lines.Line2D([1, 2], [1, 2])
182.     assert ln.get_markeredgecolor() == 'r'
183. 
184. 
185. def test_axes_titlecolor_rcparams():
186.     mpl.rcParams['axes.titlecolor'] = 'r'
187.     _, ax = plt.subplots()
188.     title = ax.set_title("Title")
189.     assert title.get_color() == 'r'
190. 
191. 
192. def test_Issue_1713(tmpdir):
193.     rcpath = Path(tmpdir) / 'test_rcparams.rc'
194.     rcpath.write_text('timezone: UTC', encoding='utf-8')
195.     with mock.patch('locale.getpreferredencoding', return_value='UTF-32-BE'):
196.         rc = mpl.rc_params_from_file(rcpath, True, False)
197.     assert rc.get('timezone') == 'UTC'
198. 
199. 
200. def test_animation_frame_formats():
201.     # Animation frame_format should allow any of the following
202.     # if any of these are not allowed, an exception will be raised
203.     # test for gh issue #17908
204.     for fmt in ['png', 'jpeg', 'tiff', 'raw', 'rgba', 'ppm',
205.                 'sgi', 'bmp', 'pbm', 'svg']:
206.         mpl.rcParams['animation.frame_format'] = fmt
207. 
208. 
209. def generate_validator_testcases(valid):
210.     validation_tests = (
211.         {'validator': validate_bool,
212.          'success': (*((_, True) for _ in
213.                        ('t', 'y', 'yes', 'on', 'true', '1', 1, True)),
214.                      *((_, False) for _ in
215.                        ('f', 'n', 'no', 'off', 'false', '0', 0, False))),
216.          'fail': ((_, ValueError)
217.                   for _ in ('aardvark', 2, -1, [], ))
218.          },
219.         {'validator': validate_stringlist,
220.          'success': (('', []),
221.                      ('a,b', ['a', 'b']),
222.                      ('aardvark', ['aardvark']),
223.                      ('aardvark, ', ['aardvark']),
224.                      ('aardvark, ,', ['aardvark']),
225.                      (['a', 'b'], ['a', 'b']),
226.                      (('a', 'b'), ['a', 'b']),
227.                      (iter(['a', 'b']), ['a', 'b']),
228.                      (np.array(['a', 'b']), ['a', 'b']),
229.                      ),
230.          'fail': ((set(), ValueError),
231.                   (1, ValueError),
232.                   ((1, 2), _api.MatplotlibDeprecationWarning),
233.                   (np.array([1, 2]), _api.MatplotlibDeprecationWarning),
234.                   )
235.          },
236.         {'validator': _listify_validator(validate_int, n=2),
237.          'success': ((_, [1, 2])
238.                      for _ in ('1, 2', [1.5, 2.5], [1, 2],
239.                                (1, 2), np.array((1, 2)))),
240.          'fail': ((_, ValueError)
241.                   for _ in ('aardvark', ('a', 1),
242.                             (1, 2, 3)
243.                             ))
244.          },
245.         {'validator': _listify_validator(validate_float, n=2),
246.          'success': ((_, [1.5, 2.5])
247.                      for _ in ('1.5, 2.5', [1.5, 2.5], [1.5, 2.5],
248.                                (1.5, 2.5), np.array((1.5, 2.5)))),
249.          'fail': ((_, ValueError)
250.                   for _ in ('aardvark', ('a', 1), (1, 2, 3), (None, ), None))
251.          },
252.         {'validator': validate_cycler,
253.          'success': (('cycler("color", "rgb")',
254.                       cycler("color", 'rgb')),
255.                      (cycler('linestyle', ['-', '--']),
256.                       cycler('linestyle', ['-', '--'])),
257.                      ("""(cycler("color", ["r", "g", "b"]) +
258.                           cycler("mew", [2, 3, 5]))""",
259.                       (cycler("color", 'rgb') +
260.                        cycler("markeredgewidth", [2, 3, 5]))),
261.                      ("cycler(c='rgb', lw=[1, 2, 3])",
262.                       cycler('color', 'rgb') + cycler('linewidth', [1, 2, 3])),
263.                      ("cycler('c', 'rgb') * cycler('linestyle', ['-', '--'])",
264.                       (cycler('color', 'rgb') *
265.                        cycler('linestyle', ['-', '--']))),
266.                      (cycler('ls', ['-', '--']),
267.                       cycler('linestyle', ['-', '--'])),
268.                      (cycler(mew=[2, 5]),
269.                       cycler('markeredgewidth', [2, 5])),
270.                      ),
271.          # This is *so* incredibly important: validate_cycler() eval's
272.          # an arbitrary string! I think I have it locked down enough,
273.          # and that is what this is testing.
274.          # TODO: Note that these tests are actually insufficient, as it may
275.          # be that they raised errors, but still did an action prior to
276.          # raising the exception. We should devise some additional tests
277.          # for that...
278.          'fail': ((4, ValueError),  # Gotta be a string or Cycler object
279.                   ('cycler("bleh, [])', ValueError),  # syntax error
280.                   ('Cycler("linewidth", [1, 2, 3])',
281.                    ValueError),  # only 'cycler()' function is allowed
282.                   # do not allow dunder in string literals
283.                   ("cycler('c', [j.__class__(j) for j in ['r', 'b']])",
284.                    ValueError),
285.                   ("cycler('c', [j. __class__(j) for j in ['r', 'b']])",
286.                    ValueError),
287.                   ("cycler('c', [j.\t__class__(j) for j in ['r', 'b']])",
288.                    ValueError),
289.                   ("cycler('c', [j.\u000c__class__(j) for j in ['r', 'b']])",
290.                    ValueError),
291.                   ("cycler('c', [j.__class__(j).lower() for j in ['r', 'b']])",
292.                    ValueError),
293.                   ('1 + 2', ValueError),  # doesn't produce a Cycler object
294.                   ('os.system("echo Gotcha")', ValueError),  # os not available
295.                   ('import os', ValueError),  # should not be able to import
296.                   ('def badjuju(a): return a; badjuju(cycler("color", "rgb"))',
297.                    ValueError),  # Should not be able to define anything
298.                   # even if it does return a cycler
299.                   ('cycler("waka", [1, 2, 3])', ValueError),  # not a property
300.                   ('cycler(c=[1, 2, 3])', ValueError),  # invalid values
301.                   ("cycler(lw=['a', 'b', 'c'])", ValueError),  # invalid values
302.                   (cycler('waka', [1, 3, 5]), ValueError),  # not a property
303.                   (cycler('color', ['C1', 'r', 'g']), ValueError)  # no CN
304.                   )
305.          },
306.         {'validator': validate_hatch,
307.          'success': (('--|', '--|'), ('\\oO', '\\oO'),
308.                      ('/+*/.x', '/+*/.x'), ('', '')),
309.          'fail': (('--_', ValueError),
310.                   (8, ValueError),
311.                   ('X', ValueError)),
312.          },
313.         {'validator': validate_colorlist,
314.          'success': (('r,g,b', ['r', 'g', 'b']),
315.                      (['r', 'g', 'b'], ['r', 'g', 'b']),
316.                      ('r, ,', ['r']),
317.                      (['', 'g', 'blue'], ['g', 'blue']),
318.                      ([np.array([1, 0, 0]), np.array([0, 1, 0])],
319.                      np.array([[1, 0, 0], [0, 1, 0]])),
320.                      (np.array([[1, 0, 0], [0, 1, 0]]),
321.                      np.array([[1, 0, 0], [0, 1, 0]])),
322.                      ),
323.          'fail': (('fish', ValueError),
324.                   ),
325.          },
326.         {'validator': validate_color,
327.          'success': (('None', 'none'),
328.                      ('none', 'none'),
329.                      ('AABBCC', '#AABBCC'),  # RGB hex code
330.                      ('AABBCC00', '#AABBCC00'),  # RGBA hex code
331.                      ('tab:blue', 'tab:blue'),  # named color
332.                      ('C12', 'C12'),  # color from cycle
333.                      ('(0, 1, 0)', (0.0, 1.0, 0.0)),  # RGB tuple
334.                      ((0, 1, 0), (0, 1, 0)),  # non-string version
335.                      ('(0, 1, 0, 1)', (0.0, 1.0, 0.0, 1.0)),  # RGBA tuple
336.                      ((0, 1, 0, 1), (0, 1, 0, 1)),  # non-string version
337.                      ),
338.          'fail': (('tab:veryblue', ValueError),  # invalid name
339.                   ('(0, 1)', ValueError),  # tuple with length < 3
340.                   ('(0, 1, 0, 1, 0)', ValueError),  # tuple with length > 4
341.                   ('(0, 1, none)', ValueError),  # cannot cast none to float
342.                   ('(0, 1, "0.5")', ValueError),  # last one not a float
343.                   ),
344.          },
345.         {'validator': _validate_color_or_linecolor,
346.          'success': (('linecolor', 'linecolor'),
347.                      ('markerfacecolor', 'markerfacecolor'),
348.                      ('mfc', 'markerfacecolor'),
349.                      ('markeredgecolor', 'markeredgecolor'),
350.                      ('mec', 'markeredgecolor')
351.                      ),
352.          'fail': (('line', ValueError),
353.                   ('marker', ValueError)
354.                   )
355.          },
356.         {'validator': validate_hist_bins,
357.          'success': (('auto', 'auto'),
358.                      ('fd', 'fd'),
359.                      ('10', 10),
360.                      ('1, 2, 3', [1, 2, 3]),
361.                      ([1, 2, 3], [1, 2, 3]),
362.                      (np.arange(15), np.arange(15))
363.                      ),
364.          'fail': (('aardvark', ValueError),
365.                   )
366.          },
367.         {'validator': validate_markevery,
368.          'success': ((None, None),
369.                      (1, 1),
370.                      (0.1, 0.1),
371.                      ((1, 1), (1, 1)),
372.                      ((0.1, 0.1), (0.1, 0.1)),
373.                      ([1, 2, 3], [1, 2, 3]),
374.                      (slice(2), slice(None, 2, None)),
375.                      (slice(1, 2, 3), slice(1, 2, 3))
376.                      ),
377.          'fail': (((1, 2, 3), TypeError),
378.                   ([1, 2, 0.3], TypeError),
379.                   (['a', 2, 3], TypeError),
380.                   ([1, 2, 'a'], TypeError),
381.                   ((0.1, 0.2, 0.3), TypeError),
382.                   ((0.1, 2, 3), TypeError),
383.                   ((1, 0.2, 0.3), TypeError),
384.                   ((1, 0.1), TypeError),
385.                   ((0.1, 1), TypeError),
386.                   (('abc'), TypeError),
387.                   ((1, 'a'), TypeError),
388.                   ((0.1, 'b'), TypeError),
389.                   (('a', 1), TypeError),
390.                   (('a', 0.1), TypeError),
391.                   ('abc', TypeError),
392.                   ('a', TypeError),
393.                   (object(), TypeError)
394.                   )
395.          },
396.         {'validator': _validate_linestyle,
397.          'success': (('-', '-'), ('solid', 'solid'),
398.                      ('--', '--'), ('dashed', 'dashed'),
399.                      ('-.', '-.'), ('dashdot', 'dashdot'),
400.                      (':', ':'), ('dotted', 'dotted'),
401.                      ('', ''), (' ', ' '),
402.                      ('None', 'none'), ('none', 'none'),
403.                      ('DoTtEd', 'dotted'),  # case-insensitive
404.                      ('1, 3', (0, (1, 3))),
405.                      ([1.23, 456], (0, [1.23, 456.0])),
406.                      ([1, 2, 3, 4], (0, [1.0, 2.0, 3.0, 4.0])),
407.                      ((0, [1, 2]), (0, [1, 2])),
408.                      ((-1, [1, 2]), (-1, [1, 2])),
409.                      ),
410.          'fail': (('aardvark', ValueError),  # not a valid string
411.                   (b'dotted', ValueError),
412.                   ('dotted'.encode('utf-16'), ValueError),
413.                   ([1, 2, 3], ValueError),  # sequence with odd length
414.                   (1.23, ValueError),  # not a sequence
415.                   (("a", [1, 2]), ValueError),  # wrong explicit offset
416.                   ((None, [1, 2]), ValueError),  # wrong explicit offset
417.                   ((1, [1, 2, 3]), ValueError),  # odd length sequence
418.                   (([1, 2], 1), ValueError),  # inverted offset/onoff
419.                   )
420.          },
421.     )
422. 
423.     for validator_dict in validation_tests:
424.         validator = validator_dict['validator']
425.         if valid:
426.             for arg, target in validator_dict['success']:
427.                 yield validator, arg, target
428.         else:
429.             for arg, error_type in validator_dict['fail']:
430.                 yield validator, arg, error_type
431. 
432. 
433. @pytest.mark.parametrize('validator, arg, target',
434.                          generate_validator_testcases(True))
435. def test_validator_valid(validator, arg, target):
436.     res = validator(arg)
437.     if isinstance(target, np.ndarray):
438.         np.testing.assert_equal(res, target)
439.     elif not isinstance(target, Cycler):
440.         assert res == target
441.     else:
442.         # Cyclers can't simply be asserted equal. They don't implement __eq__
443.         assert list(res) == list(target)
444. 
445. 
446. @pytest.mark.parametrize('validator, arg, exception_type',
447.                          generate_validator_testcases(False))
448. def test_validator_invalid(validator, arg, exception_type):
449.     with pytest.raises(exception_type):
450.         validator(arg)
451. 
452. 
453. @pytest.mark.parametrize('weight, parsed_weight', [
454.     ('bold', 'bold'),
455.     ('BOLD', ValueError),  # weight is case-sensitive
456.     (100, 100),
457.     ('100', 100),
458.     (np.array(100), 100),
459.     # fractional fontweights are not defined. This should actually raise a
460.     # ValueError, but historically did not.
461.     (20.6, 20),
462.     ('20.6', ValueError),
463.     ([100], ValueError),
464. ])
465. def test_validate_fontweight(weight, parsed_weight):
466.     if parsed_weight is ValueError:
467.         with pytest.raises(ValueError):
468.             validate_fontweight(weight)
469.     else:
470.         assert validate_fontweight(weight) == parsed_weight
471. 
472. 
473. @pytest.mark.parametrize('stretch, parsed_stretch', [
474.     ('expanded', 'expanded'),
475.     ('EXPANDED', ValueError),  # stretch is case-sensitive
476.     (100, 100),
477.     ('100', 100),
478.     (np.array(100), 100),
479.     # fractional fontweights are not defined. This should actually raise a
480.     # ValueError, but historically did not.
481.     (20.6, 20),
482.     ('20.6', ValueError),
483.     ([100], ValueError),
484. ])
485. def test_validate_fontstretch(stretch, parsed_stretch):
486.     if parsed_stretch is ValueError:
487.         with pytest.raises(ValueError):
488.             validate_fontstretch(stretch)
489.     else:
490.         assert validate_fontstretch(stretch) == parsed_stretch
491. 
492. 
493. def test_keymaps():
494.     key_list = [k for k in mpl.rcParams if 'keymap' in k]
495.     for k in key_list:
496.         assert isinstance(mpl.rcParams[k], list)
497. 
498. 
499. def test_rcparams_reset_after_fail():
500.     # There was previously a bug that meant that if rc_context failed and

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 20:29:02,736 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user explicitly asked for the full content of this file.', relative_path='lib/matplotlib/tests/test_rcparams.py', start_line=1, end_line=500), ContextOutput(reasoning='The user explicitly asked for the full content of this file.', relative_path='lib/matplotlib/tests/test_pyplot.py', start_line=1, end_line=385)]
2025-12-20 20:29:02,846 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.
2025-12-20 20:29:02,846 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 20:29:02,846 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 20:29:02,847 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 0 existing contexts
2025-12-20 20:29:02,881 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-20 20:29:02,887 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19214-DS.rst
|   |   |   |   ├── 19368-DS.rst
|   |   |   |   ├── 20426-JK.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   ├── 21026-DS.rst
|   |   |   |   ├── 21042-AL.rst
|   |   |   |   ├── 21238-AL.rst
|   |   |   |   ├── 21983-AL.rst
|   |   |   |   ├── 22013-AL.rst
|   |   |   |   ├── 22063-SR.rst
|   |   |   |   ├── 22204-AL.rst
|   |   |   |   ├── 22229-TAC.rst
|   |   |   |   ├── 22485-TH.rst
|   |   |   |   ├── 22567-IT.rst
|   |   |   |   ├── 22639-RA.rst
|   |   |   |   ├── 22691-JMK.rst
|   |   |   |   ├── 22745-JMK.rst
|   |   |   |   ├── 23031-AL.rst
|   |   |   |   ├── 23170-JMK.rst
|   |   |   |   ├── 23188-JMK.rst
|   |   |   |   └── 23270-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20071-AL.rst
|   |   |   |   ├── 20839-EP.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   ├── 21425-AL.rst
|   |   |   |   ├── 21584-AL.rst
|   |   |   |   ├── 21962-AL.rst
|   |   |   |   ├── 21965-AL.rst
|   |   |   |   ├── 21981-AL.rst
|   |   |   |   ├── 21982-AL.rst
|   |   |   |   ├── 21992-AL.rst
|   |   |   |   ├── 21995-AL.rst
|   |   |   |   ├── 22021-AL.rst
|   |   |   |   ├── 22025-AL.rst
|   |   |   |   ├── 22050-AL.rst
|   |   |   |   ├── 22051-AL.rst
|   |   |   |   ├── 22084-SS.rst
|   |   |   |   ├── 22097-AL.rst
|   |   |   |   ├── 22098-AL.rst
|   |   |   |   ├── 22123-TH.rst
|   |   |   |   ├── 22133-OG.rst
|   |   |   |   ├── 22134-OG.rst
|   |   |   |   ├── 22148-OG.rst
|   |   |   |   ├── 22167-EP.rst
|   |   |   |   ├── 22245-AL.rst
|   |   |   |   ├── 22268-OG.rst
|   |   |   |   ├── 22298-GL.rst
|   |   |   |   ├── 22317-AL.rst
|   |   |   |   ├── 22323-GL.rst
|   |   |   |   ├── 22345-JK.rst
|   |   |   |   ├── 22415-AL.rst
|   |   |   |   ├── 22418-AL.rst
|   |   |   |   ├── 22421-AL.rst
|   |   |   |   ├── 22422-AL.rst
|   |   |   |   ├── 22490-AL.rst
|   |   |   |   ├── 22503-AL.rst
|   |   |   |   ├── 22509-AL.rst
|   |   |   |   ├── 22539-AL.rst
|   |   |   |   ├── 22547-AL.rst
|   |   |   |   ├── 22554-AL.rst
|   |   |   |   ├── 22697-OG.rst
|   |   |   |   ├── 22725-AL.rst
|   |   |   |   ├── 22797-OG.rst
|   |   |   |   ├── 22813-GL.rst
|   |   |   |   ├── 22883-AL.rst
|   |   |   |   ├── 22885-AL.rst
|   |   |   |   ├── 23014-OG.rst
|   |   |   |   ├── 23045-OG.rst
|   |   |   |   ├── 23081-OG.rst
|   |   |   |   ├── 23166-ES.rst
|   |   |   |   ├── 23190-OG.rst
|   |   |   |   ├── 23232-TH.rst
|   |   |   |   ├── 23289-AL.rst
|   |   |   |   ├── 23302-TH.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 21415-AL.rst
|   |   |   |   ├── 22205-ES.rst
|   |   |   |   └── 22550-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 00001-DS.rst
|   |   |       ├── 20990-AL.rst
|   |   |       ├── 21395-AL.rst
|   |   |       ├── 21591-AL.rst
|   |   |       ├── 21980-CC.rst
|   |   |       ├── 22081-AL.rst
|   |   |       ├── 22107-OG.rst
|   |   |       ├── 22365-OG.rst
|   |   |       ├── 22465-AL.rst
|   |   |       ├── 22486-OG.rst
|   |   |       ├── 22514-OG.rst
|   |   |       ├── 22516-OG.rst
|   |   |       ├── 22738-JL.rst
|   |   |       ├── 22886-OG.rst
|   |   |       ├── 22952-TH.rst
|   |   |       ├── 23076-GL.rst
|   |   |       ├── 23077-GL.rst
|   |   |       ├── 23078-GL.rst
|   |   |       ├── 23079-GL.rst
|   |   |       ├── 23093-GL.rst
|   |   |       └── 23237-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   └── api_changes_3.5.2.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plot_focal_length.rst
|       |   ├── 3d_plot_roll_angle.rst
|       |   ├── README.rst
|       |   ├── asinh_scale.rst
|       |   ├── color_support_for_math_to_image.rst
|       |   ├── custom_cap_widths.rst
|       |   ├── double_quotes_matplolibrc.rst
|       |   ├── extending_MarkerStyle.rst
|       |   ├── inset_axes_improvements.rst
|       |   ├── layout_engine.rst
|       |   ├── list_font_names.rst
|       |   ├── marker_none.rst
|       |   ├── min_macos_version.rst
|       |   ├── modify_stairs_fill_edge_behaviour.rst
|       |   ├── no_broken_streamlines.rst
|       |   ├── polygon_selector_box.rst
|       |   ├── polygon_vert_setter.rst
|       |   ├── rectangle_patch_rotation.rst
|       |   ├── rename_ncol_keyword_in_legend.rst
|       |   ├── selector_improvement.rst
|       |   ├── snap_selector.rst
|       |   ├── striped_lines.rst
|       |   ├── url_active_areas_rotate.rst
|       |   ├── use_contourpy.rst
|       |   └── windows_arm64.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   └── whats_new_3.5.2.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.
Extra Requirements: 
Purpose: I need to find 3 relevant test cases that demonstrate the reported bug, and these files are the most likely to contain them.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_pyplot.py
Line number range: 1 - 385
Content:
1. import difflib
2. import re
3. 
4. import numpy as np
5. import subprocess
6. import sys
7. from pathlib import Path
8. 
9. import pytest
10. 
11. import matplotlib as mpl
12. from matplotlib import pyplot as plt
13. from matplotlib._api import MatplotlibDeprecationWarning
14. 
15. 
16. def test_pyplot_up_to_date(tmpdir):
17.     gen_script = Path(mpl.__file__).parents[2] / "tools/boilerplate.py"
18.     if not gen_script.exists():
19.         pytest.skip("boilerplate.py not found")
20.     orig_contents = Path(plt.__file__).read_text()
21.     plt_file = tmpdir.join('pyplot.py')
22.     plt_file.write_text(orig_contents, 'utf-8')
23. 
24.     subprocess.run([sys.executable, str(gen_script), str(plt_file)],
25.                    check=True)
26.     new_contents = plt_file.read_text('utf-8')
27. 
28.     if orig_contents != new_contents:
29.         diff_msg = '\n'.join(
30.             difflib.unified_diff(
31.                 orig_contents.split('\n'), new_contents.split('\n'),
32.                 fromfile='found pyplot.py',
33.                 tofile='expected pyplot.py',
34.                 n=0, lineterm=''))
35.         pytest.fail(
36.             "pyplot.py is not up-to-date. Please run "
37.             "'python tools/boilerplate.py' to update pyplot.py. "
38.             "This needs to be done from an environment where your "
39.             "current working copy is installed (e.g. 'pip install -e'd). "
40.             "Here is a diff of unexpected differences:\n%s" % diff_msg
41.         )
42. 
43. 
44. def test_copy_docstring_and_deprecators(recwarn):
45.     @mpl._api.rename_parameter("(version)", "old", "new")
46.     @mpl._api.make_keyword_only("(version)", "kwo")
47.     def func(new, kwo=None):
48.         pass
49. 
50.     @plt._copy_docstring_and_deprecators(func)
51.     def wrapper_func(new, kwo=None):
52.         pass
53. 
54.     wrapper_func(None)
55.     wrapper_func(new=None)
56.     wrapper_func(None, kwo=None)
57.     wrapper_func(new=None, kwo=None)
58.     assert not recwarn
59.     with pytest.warns(MatplotlibDeprecationWarning):
60.         wrapper_func(old=None)
61.     with pytest.warns(MatplotlibDeprecationWarning):
62.         wrapper_func(None, None)
63. 
64. 
65. def test_pyplot_box():
66.     fig, ax = plt.subplots()
67.     plt.box(False)
68.     assert not ax.get_frame_on()
69.     plt.box(True)
70.     assert ax.get_frame_on()
71.     plt.box()
72.     assert not ax.get_frame_on()
73.     plt.box()
74.     assert ax.get_frame_on()
75. 
76. 
77. def test_stackplot_smoke():
78.     # Small smoke test for stackplot (see #12405)
79.     plt.stackplot([1, 2, 3], [1, 2, 3])
80. 
81. 
82. def test_nrows_error():
83.     with pytest.raises(TypeError):
84.         plt.subplot(nrows=1)
85.     with pytest.raises(TypeError):
86.         plt.subplot(ncols=1)
87. 
88. 
89. def test_ioff():
90.     plt.ion()
91.     assert mpl.is_interactive()
92.     with plt.ioff():
93.         assert not mpl.is_interactive()
94.     assert mpl.is_interactive()
95. 
96.     plt.ioff()
97.     assert not mpl.is_interactive()
98.     with plt.ioff():
99.         assert not mpl.is_interactive()
100.     assert not mpl.is_interactive()
101. 
102. 
103. def test_ion():
104.     plt.ioff()
105.     assert not mpl.is_interactive()
106.     with plt.ion():
107.         assert mpl.is_interactive()
108.     assert not mpl.is_interactive()
109. 
110.     plt.ion()
111.     assert mpl.is_interactive()
112.     with plt.ion():
113.         assert mpl.is_interactive()
114.     assert mpl.is_interactive()
115. 
116. 
117. def test_nested_ion_ioff():
118.     # initial state is interactive
119.     plt.ion()
120. 
121.     # mixed ioff/ion
122.     with plt.ioff():
123.         assert not mpl.is_interactive()
124.         with plt.ion():
125.             assert mpl.is_interactive()
126.         assert not mpl.is_interactive()
127.     assert mpl.is_interactive()
128. 
129.     # redundant contexts
130.     with plt.ioff():
131.         with plt.ioff():
132.             assert not mpl.is_interactive()
133.     assert mpl.is_interactive()
134. 
135.     with plt.ion():
136.         plt.ioff()
137.     assert mpl.is_interactive()
138. 
139.     # initial state is not interactive
140.     plt.ioff()
141. 
142.     # mixed ioff/ion
143.     with plt.ion():
144.         assert mpl.is_interactive()
145.         with plt.ioff():
146.             assert not mpl.is_interactive()
147.         assert mpl.is_interactive()
148.     assert not mpl.is_interactive()
149. 
150.     # redundant contexts
151.     with plt.ion():
152.         with plt.ion():
153.             assert mpl.is_interactive()
154.     assert not mpl.is_interactive()
155. 
156.     with plt.ioff():
157.         plt.ion()
158.     assert not mpl.is_interactive()
159. 
160. 
161. def test_close():
162.     try:
163.         plt.close(1.1)
164.     except TypeError as e:
165.         assert str(e) == "close() argument must be a Figure, an int, " \
166.                          "a string, or None, not <class 'float'>"
167. 
168. 
169. def test_subplot_reuse():
170.     ax1 = plt.subplot(121)
171.     assert ax1 is plt.gca()
172.     ax2 = plt.subplot(122)
173.     assert ax2 is plt.gca()
174.     ax3 = plt.subplot(121)
175.     assert ax1 is plt.gca()
176.     assert ax1 is ax3
177. 
178. 
179. def test_axes_kwargs():
180.     # plt.axes() always creates new axes, even if axes kwargs differ.
181.     plt.figure()
182.     ax = plt.axes()
183.     ax1 = plt.axes()
184.     assert ax is not None
185.     assert ax1 is not ax
186.     plt.close()
187. 
188.     plt.figure()
189.     ax = plt.axes(projection='polar')
190.     ax1 = plt.axes(projection='polar')
191.     assert ax is not None
192.     assert ax1 is not ax
193.     plt.close()
194. 
195.     plt.figure()
196.     ax = plt.axes(projection='polar')
197.     ax1 = plt.axes()
198.     assert ax is not None
199.     assert ax1.name == 'rectilinear'
200.     assert ax1 is not ax
201.     plt.close()
202. 
203. 
204. def test_subplot_replace_projection():
205.     # plt.subplot() searches for axes with the same subplot spec, and if one
206.     # exists, and the kwargs match returns it, create a new one if they do not
207.     fig = plt.figure()
208.     ax = plt.subplot(1, 2, 1)
209.     ax1 = plt.subplot(1, 2, 1)
210.     ax2 = plt.subplot(1, 2, 2)
211.     with pytest.warns(MatplotlibDeprecationWarning):
212.         ax3 = plt.subplot(1, 2, 1, projection='polar')
213.     ax4 = plt.subplot(1, 2, 1, projection='polar')
214.     assert ax is not None
215.     assert ax1 is ax
216.     assert ax2 is not ax
217.     assert ax3 is not ax
218.     assert ax3 is ax4
219. 
220.     assert ax not in fig.axes
221.     assert ax2 in fig.axes
222.     assert ax3 in fig.axes
223. 
224.     assert ax.name == 'rectilinear'
225.     assert ax2.name == 'rectilinear'
226.     assert ax3.name == 'polar'
227. 
228. 
229. def test_subplot_kwarg_collision():
230.     ax1 = plt.subplot(projection='polar', theta_offset=0)
231.     ax2 = plt.subplot(projection='polar', theta_offset=0)
232.     assert ax1 is ax2
233.     ax1.remove()
234.     ax3 = plt.subplot(projection='polar', theta_offset=1)
235.     assert ax1 is not ax3
236.     assert ax1 not in plt.gcf().axes
237. 
238. 
239. def test_gca():
240.     # plt.gca() returns an existing axes, unless there were no axes.
241.     plt.figure()
242.     ax = plt.gca()
243.     ax1 = plt.gca()
244.     assert ax is not None
245.     assert ax1 is ax
246.     plt.close()
247. 
248. 
249. def test_subplot_projection_reuse():
250.     # create an Axes
251.     ax1 = plt.subplot(111)
252.     # check that it is current
253.     assert ax1 is plt.gca()
254.     # make sure we get it back if we ask again
255.     assert ax1 is plt.subplot(111)
256.     # remove it
257.     ax1.remove()
258.     # create a polar plot
259.     ax2 = plt.subplot(111, projection='polar')
260.     assert ax2 is plt.gca()
261.     # this should have deleted the first axes
262.     assert ax1 not in plt.gcf().axes
263.     # assert we get it back if no extra parameters passed
264.     assert ax2 is plt.subplot(111)
265.     ax2.remove()
266.     # now check explicitly setting the projection to rectilinear
267.     # makes a new axes
268.     ax3 = plt.subplot(111, projection='rectilinear')
269.     assert ax3 is plt.gca()
270.     assert ax3 is not ax2
271.     assert ax2 not in plt.gcf().axes
272. 
273. 
274. def test_subplot_polar_normalization():
275.     ax1 = plt.subplot(111, projection='polar')
276.     ax2 = plt.subplot(111, polar=True)
277.     ax3 = plt.subplot(111, polar=True, projection='polar')
278.     assert ax1 is ax2
279.     assert ax1 is ax3
280. 
281.     with pytest.raises(ValueError,
282.                        match="polar=True, yet projection='3d'"):
283.         ax2 = plt.subplot(111, polar=True, projection='3d')
284. 
285. 
286. def test_subplot_change_projection():
287.     created_axes = set()
288.     ax = plt.subplot()
289.     created_axes.add(ax)
290.     projections = ('aitoff', 'hammer', 'lambert', 'mollweide',
291.                    'polar', 'rectilinear', '3d')
292.     for proj in projections:
293.         ax.remove()
294.         ax = plt.subplot(projection=proj)
295.         assert ax is plt.subplot()
296.         assert ax.name == proj
297.         created_axes.add(ax)
298.     # Check that each call created a new Axes.
299.     assert len(created_axes) == 1 + len(projections)
300. 
301. 
302. def test_polar_second_call():
303.     # the first call creates the axes with polar projection
304.     ln1, = plt.polar(0., 1., 'ro')
305.     assert isinstance(ln1, mpl.lines.Line2D)
306.     # the second call should reuse the existing axes
307.     ln2, = plt.polar(1.57, .5, 'bo')
308.     assert isinstance(ln2, mpl.lines.Line2D)
309.     assert ln1.axes is ln2.axes
310. 
311. 
312. def test_fallback_position():
313.     # check that position kwarg works if rect not supplied
314.     axref = plt.axes([0.2, 0.2, 0.5, 0.5])
315.     axtest = plt.axes(position=[0.2, 0.2, 0.5, 0.5])
316.     np.testing.assert_allclose(axtest.bbox.get_points(),
317.                                axref.bbox.get_points())
318. 
319.     # check that position kwarg ignored if rect is supplied
320.     axref = plt.axes([0.2, 0.2, 0.5, 0.5])
321.     axtest = plt.axes([0.2, 0.2, 0.5, 0.5], position=[0.1, 0.1, 0.8, 0.8])
322.     np.testing.assert_allclose(axtest.bbox.get_points(),
323.                                axref.bbox.get_points())
324. 
325. 
326. def test_set_current_figure_via_subfigure():
327.     fig1 = plt.figure()
328.     subfigs = fig1.subfigures(2)
329. 
330.     plt.figure()
331.     assert plt.gcf() != fig1
332. 
333.     current = plt.figure(subfigs[1])
334.     assert plt.gcf() == fig1
335.     assert current == fig1
336. 
337. 
338. def test_set_current_axes_on_subfigure():
339.     fig = plt.figure()
340.     subfigs = fig.subfigures(2)
341. 
342.     ax = subfigs[0].subplots(1, squeeze=True)
343.     subfigs[1].subplots(1, squeeze=True)
344. 
345.     assert plt.gca() != ax
346.     plt.sca(ax)
347.     assert plt.gca() == ax
348. 
349. 
350. def test_pylab_integration():
351.     IPython = pytest.importorskip("IPython")
352.     mpl.testing.subprocess_run_helper(
353.         IPython.start_ipython,
354.         "--pylab",
355.         "-c",
356.         ";".join((
357.             "import matplotlib.pyplot as plt",
358.             "assert plt._REPL_DISPLAYHOOK == plt._ReplDisplayHook.IPYTHON",
359.         )),
360.         timeout=60,
361.     )
362. 
363. 
364. def test_doc_pyplot_summary():
365.     """Test that pyplot_summary lists all the plot functions."""
366.     pyplot_docs = Path(__file__).parent / '../../../doc/api/pyplot_summary.rst'
367.     if not pyplot_docs.exists():
368.         pytest.skip("Documentation sources not available")
369. 
370.     lines = pyplot_docs.read_text()
371.     m = re.search(r':nosignatures:\n\n(.*?)\n\n', lines, re.DOTALL)
372.     doc_functions = set(line.strip() for line in m.group(1).split('\n'))
373.     plot_commands = set(plt.get_plot_commands())
374.     missing = plot_commands.difference(doc_functions)
375.     if missing:
376.         raise AssertionError(
377.             f"The following pyplot functions are not listed in the "
378.             f"documentation. Please add them to doc/api/pyplot_summary.rst: "
379.             f"{missing!r}")
380.     extra = doc_functions.difference(plot_commands)
381.     if extra:
382.         raise AssertionError(
383.             f"The following functions are listed in the pyplot documentation, "
384.             f"but they do not exist in pyplot. "
385.             f"Please remove them from doc/api/pyplot_summary.rst: {extra!r}")


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 1 - 500
Content:
1. import copy
2. import os
3. from pathlib import Path
4. import subprocess
5. import sys
6. from unittest import mock
7. 
8. from cycler import cycler, Cycler
9. import pytest
10. 
11. import matplotlib as mpl
12. from matplotlib import _api, _c_internal_utils
13. import matplotlib.pyplot as plt
14. import matplotlib.colors as mcolors
15. import numpy as np
16. from matplotlib.rcsetup import (
17.     validate_bool,
18.     validate_color,
19.     validate_colorlist,
20.     _validate_color_or_linecolor,
21.     validate_cycler,
22.     validate_float,
23.     validate_fontstretch,
24.     validate_fontweight,
25.     validate_hatch,
26.     validate_hist_bins,
27.     validate_int,
28.     validate_markevery,
29.     validate_stringlist,
30.     _validate_linestyle,
31.     _listify_validator)
32. 
33. 
34. def test_rcparams(tmpdir):
35.     mpl.rc('text', usetex=False)
36.     mpl.rc('lines', linewidth=22)
37. 
38.     usetex = mpl.rcParams['text.usetex']
39.     linewidth = mpl.rcParams['lines.linewidth']
40. 
41.     rcpath = Path(tmpdir) / 'test_rcparams.rc'
42.     rcpath.write_text('lines.linewidth: 33', encoding='utf-8')
43. 
44.     # test context given dictionary
45.     with mpl.rc_context(rc={'text.usetex': not usetex}):
46.         assert mpl.rcParams['text.usetex'] == (not usetex)
47.     assert mpl.rcParams['text.usetex'] == usetex
48. 
49.     # test context given filename (mpl.rc sets linewidth to 33)
50.     with mpl.rc_context(fname=rcpath):
51.         assert mpl.rcParams['lines.linewidth'] == 33
52.     assert mpl.rcParams['lines.linewidth'] == linewidth
53. 
54.     # test context given filename and dictionary
55.     with mpl.rc_context(fname=rcpath, rc={'lines.linewidth': 44}):
56.         assert mpl.rcParams['lines.linewidth'] == 44
57.     assert mpl.rcParams['lines.linewidth'] == linewidth
58. 
59.     # test context as decorator (and test reusability, by calling func twice)
60.     @mpl.rc_context({'lines.linewidth': 44})
61.     def func():
62.         assert mpl.rcParams['lines.linewidth'] == 44
63. 
64.     func()
65.     func()
66. 
67.     # test rc_file
68.     mpl.rc_file(rcpath)
69.     assert mpl.rcParams['lines.linewidth'] == 33
70. 
71. 
72. def test_RcParams_class():
73.     rc = mpl.RcParams({'font.cursive': ['Apple Chancery',
74.                                         'Textile',
75.                                         'Zapf Chancery',
76.                                         'cursive'],
77.                        'font.family': 'sans-serif',
78.                        'font.weight': 'normal',
79.                        'font.size': 12})
80. 
81.     expected_repr = """
82. RcParams({'font.cursive': ['Apple Chancery',
83.                            'Textile',
84.                            'Zapf Chancery',
85.                            'cursive'],
86.           'font.family': ['sans-serif'],
87.           'font.size': 12.0,
88.           'font.weight': 'normal'})""".lstrip()
89. 
90.     assert expected_repr == repr(rc)
91. 
92.     expected_str = """
93. font.cursive: ['Apple Chancery', 'Textile', 'Zapf Chancery', 'cursive']
94. font.family: ['sans-serif']
95. font.size: 12.0
96. font.weight: normal""".lstrip()
97. 
98.     assert expected_str == str(rc)
99. 
100.     # test the find_all functionality
101.     assert ['font.cursive', 'font.size'] == sorted(rc.find_all('i[vz]'))
102.     assert ['font.family'] == list(rc.find_all('family'))
103. 
104. 
105. def test_rcparams_update():
106.     rc = mpl.RcParams({'figure.figsize': (3.5, 42)})
107.     bad_dict = {'figure.figsize': (3.5, 42, 1)}
108.     # make sure validation happens on input
109.     with pytest.raises(ValueError), \
110.          pytest.warns(UserWarning, match="validate"):
111.         rc.update(bad_dict)
112. 
113. 
114. def test_rcparams_init():
115.     with pytest.raises(ValueError), \
116.          pytest.warns(UserWarning, match="validate"):
117.         mpl.RcParams({'figure.figsize': (3.5, 42, 1)})
118. 
119. 
120. def test_Bug_2543():
121.     # Test that it possible to add all values to itself / deepcopy
122.     # https://github.com/matplotlib/matplotlib/issues/2543
123.     # We filter warnings at this stage since a number of them are raised
124.     # for deprecated rcparams as they should. We don't want these in the
125.     # printed in the test suite.
126.     with _api.suppress_matplotlib_deprecation_warning():
127.         with mpl.rc_context():
128.             _copy = mpl.rcParams.copy()
129.             for key in _copy:
130.                 mpl.rcParams[key] = _copy[key]
131.         with mpl.rc_context():
132.             copy.deepcopy(mpl.rcParams)
133.     with pytest.raises(ValueError):
134.         validate_bool(None)
135.     with pytest.raises(ValueError):
136.         with mpl.rc_context():
137.             mpl.rcParams['svg.fonttype'] = True
138. 
139. 
140. legend_color_tests = [
141.     ('face', {'color': 'r'}, mcolors.to_rgba('r')),
142.     ('face', {'color': 'inherit', 'axes.facecolor': 'r'},
143.      mcolors.to_rgba('r')),
144.     ('face', {'color': 'g', 'axes.facecolor': 'r'}, mcolors.to_rgba('g')),
145.     ('edge', {'color': 'r'}, mcolors.to_rgba('r')),
146.     ('edge', {'color': 'inherit', 'axes.edgecolor': 'r'},
147.      mcolors.to_rgba('r')),
148.     ('edge', {'color': 'g', 'axes.facecolor': 'r'}, mcolors.to_rgba('g'))
149. ]
150. legend_color_test_ids = [
151.     'same facecolor',
152.     'inherited facecolor',
153.     'different facecolor',
154.     'same edgecolor',
155.     'inherited edgecolor',
156.     'different facecolor',
157. ]
158. 
159. 
160. @pytest.mark.parametrize('color_type, param_dict, target', legend_color_tests,
161.                          ids=legend_color_test_ids)
162. def test_legend_colors(color_type, param_dict, target):
163.     param_dict[f'legend.{color_type}color'] = param_dict.pop('color')
164.     get_func = f'get_{color_type}color'
165. 
166.     with mpl.rc_context(param_dict):
167.         _, ax = plt.subplots()
168.         ax.plot(range(3), label='test')
169.         leg = ax.legend()
170.         assert getattr(leg.legendPatch, get_func)() == target
171. 
172. 
173. def test_mfc_rcparams():
174.     mpl.rcParams['lines.markerfacecolor'] = 'r'
175.     ln = mpl.lines.Line2D([1, 2], [1, 2])
176.     assert ln.get_markerfacecolor() == 'r'
177. 
178. 
179. def test_mec_rcparams():
180.     mpl.rcParams['lines.markeredgecolor'] = 'r'
181.     ln = mpl.lines.Line2D([1, 2], [1, 2])
182.     assert ln.get_markeredgecolor() == 'r'
183. 
184. 
185. def test_axes_titlecolor_rcparams():
186.     mpl.rcParams['axes.titlecolor'] = 'r'
187.     _, ax = plt.subplots()
188.     title = ax.set_title("Title")
189.     assert title.get_color() == 'r'
190. 
191. 
192. def test_Issue_1713(tmpdir):
193.     rcpath = Path(tmpdir) / 'test_rcparams.rc'
194.     rcpath.write_text('timezone: UTC', encoding='utf-8')
195.     with mock.patch('locale.getpreferredencoding', return_value='UTF-32-BE'):
196.         rc = mpl.rc_params_from_file(rcpath, True, False)
197.     assert rc.get('timezone') == 'UTC'
198. 
199. 
200. def test_animation_frame_formats():
201.     # Animation frame_format should allow any of the following
202.     # if any of these are not allowed, an exception will be raised
203.     # test for gh issue #17908
204.     for fmt in ['png', 'jpeg', 'tiff', 'raw', 'rgba', 'ppm',
205.                 'sgi', 'bmp', 'pbm', 'svg']:
206.         mpl.rcParams['animation.frame_format'] = fmt
207. 
208. 
209. def generate_validator_testcases(valid):
210.     validation_tests = (
211.         {'validator': validate_bool,
212.          'success': (*((_, True) for _ in
213.                        ('t', 'y', 'yes', 'on', 'true', '1', 1, True)),
214.                      *((_, False) for _ in
215.                        ('f', 'n', 'no', 'off', 'false', '0', 0, False))),
216.          'fail': ((_, ValueError)
217.                   for _ in ('aardvark', 2, -1, [], ))
218.          },
219.         {'validator': validate_stringlist,
220.          'success': (('', []),
221.                      ('a,b', ['a', 'b']),
222.                      ('aardvark', ['aardvark']),
223.                      ('aardvark, ', ['aardvark']),
224.                      ('aardvark, ,', ['aardvark']),
225.                      (['a', 'b'], ['a', 'b']),
226.                      (('a', 'b'), ['a', 'b']),
227.                      (iter(['a', 'b']), ['a', 'b']),
228.                      (np.array(['a', 'b']), ['a', 'b']),
229.                      ),
230.          'fail': ((set(), ValueError),
231.                   (1, ValueError),
232.                   ((1, 2), _api.MatplotlibDeprecationWarning),
233.                   (np.array([1, 2]), _api.MatplotlibDeprecationWarning),
234.                   )
235.          },
236.         {'validator': _listify_validator(validate_int, n=2),
237.          'success': ((_, [1, 2])
238.                      for _ in ('1, 2', [1.5, 2.5], [1, 2],
239.                                (1, 2), np.array((1, 2)))),
240.          'fail': ((_, ValueError)
241.                   for _ in ('aardvark', ('a', 1),
242.                             (1, 2, 3)
243.                             ))
244.          },
245.         {'validator': _listify_validator(validate_float, n=2),
246.          'success': ((_, [1.5, 2.5])
247.                      for _ in ('1.5, 2.5', [1.5, 2.5], [1.5, 2.5],
248.                                (1.5, 2.5), np.array((1.5, 2.5)))),
249.          'fail': ((_, ValueError)
250.                   for _ in ('aardvark', ('a', 1), (1, 2, 3), (None, ), None))
251.          },
252.         {'validator': validate_cycler,
253.          'success': (('cycler("color", "rgb")',
254.                       cycler("color", 'rgb')),
255.                      (cycler('linestyle', ['-', '--']),
256.                       cycler('linestyle', ['-', '--'])),
257.                      ("""(cycler("color", ["r", "g", "b"]) +
258.                           cycler("mew", [2, 3, 5]))""",
259.                       (cycler("color", 'rgb') +
260.                        cycler("markeredgewidth", [2, 3, 5]))),
261.                      ("cycler(c='rgb', lw=[1, 2, 3])",
262.                       cycler('color', 'rgb') + cycler('linewidth', [1, 2, 3])),
263.                      ("cycler('c', 'rgb') * cycler('linestyle', ['-', '--'])",
264.                       (cycler('color', 'rgb') *
265.                        cycler('linestyle', ['-', '--']))),
266.                      (cycler('ls', ['-', '--']),
267.                       cycler('linestyle', ['-', '--'])),
268.                      (cycler(mew=[2, 5]),
269.                       cycler('markeredgewidth', [2, 5])),
270.                      ),
271.          # This is *so* incredibly important: validate_cycler() eval's
272.          # an arbitrary string! I think I have it locked down enough,
273.          # and that is what this is testing.
274.          # TODO: Note that these tests are actually insufficient, as it may
275.          # be that they raised errors, but still did an action prior to
276.          # raising the exception. We should devise some additional tests
277.          # for that...
278.          'fail': ((4, ValueError),  # Gotta be a string or Cycler object
279.                   ('cycler("bleh, [])', ValueError),  # syntax error
280.                   ('Cycler("linewidth", [1, 2, 3])',
281.                    ValueError),  # only 'cycler()' function is allowed
282.                   # do not allow dunder in string literals
283.                   ("cycler('c', [j.__class__(j) for j in ['r', 'b']])",
284.                    ValueError),
285.                   ("cycler('c', [j. __class__(j) for j in ['r', 'b']])",
286.                    ValueError),
287.                   ("cycler('c', [j.\t__class__(j) for j in ['r', 'b']])",
288.                    ValueError),
289.                   ("cycler('c', [j.\u000c__class__(j) for j in ['r', 'b']])",
290.                    ValueError),
291.                   ("cycler('c', [j.__class__(j).lower() for j in ['r', 'b']])",
292.                    ValueError),
293.                   ('1 + 2', ValueError),  # doesn't produce a Cycler object
294.                   ('os.system("echo Gotcha")', ValueError),  # os not available
295.                   ('import os', ValueError),  # should not be able to import
296.                   ('def badjuju(a): return a; badjuju(cycler("color", "rgb"))',
297.                    ValueError),  # Should not be able to define anything
298.                   # even if it does return a cycler
299.                   ('cycler("waka", [1, 2, 3])', ValueError),  # not a property
300.                   ('cycler(c=[1, 2, 3])', ValueError),  # invalid values
301.                   ("cycler(lw=['a', 'b', 'c'])", ValueError),  # invalid values
302.                   (cycler('waka', [1, 3, 5]), ValueError),  # not a property
303.                   (cycler('color', ['C1', 'r', 'g']), ValueError)  # no CN
304.                   )
305.          },
306.         {'validator': validate_hatch,
307.          'success': (('--|', '--|'), ('\\oO', '\\oO'),
308.                      ('/+*/.x', '/+*/.x'), ('', '')),
309.          'fail': (('--_', ValueError),
310.                   (8, ValueError),
311.                   ('X', ValueError)),
312.          },
313.         {'validator': validate_colorlist,
314.          'success': (('r,g,b', ['r', 'g', 'b']),
315.                      (['r', 'g', 'b'], ['r', 'g', 'b']),
316.                      ('r, ,', ['r']),
317.                      (['', 'g', 'blue'], ['g', 'blue']),
318.                      ([np.array([1, 0, 0]), np.array([0, 1, 0])],
319.                      np.array([[1, 0, 0], [0, 1, 0]])),
320.                      (np.array([[1, 0, 0], [0, 1, 0]]),
321.                      np.array([[1, 0, 0], [0, 1, 0]])),
322.                      ),
323.          'fail': (('fish', ValueError),
324.                   ),
325.          },
326.         {'validator': validate_color,
327.          'success': (('None', 'none'),
328.                      ('none', 'none'),
329.                      ('AABBCC', '#AABBCC'),  # RGB hex code
330.                      ('AABBCC00', '#AABBCC00'),  # RGBA hex code
331.                      ('tab:blue', 'tab:blue'),  # named color
332.                      ('C12', 'C12'),  # color from cycle
333.                      ('(0, 1, 0)', (0.0, 1.0, 0.0)),  # RGB tuple
334.                      ((0, 1, 0), (0, 1, 0)),  # non-string version
335.                      ('(0, 1, 0, 1)', (0.0, 1.0, 0.0, 1.0)),  # RGBA tuple
336.                      ((0, 1, 0, 1), (0, 1, 0, 1)),  # non-string version
337.                      ),
338.          'fail': (('tab:veryblue', ValueError),  # invalid name
339.                   ('(0, 1)', ValueError),  # tuple with length < 3
340.                   ('(0, 1, 0, 1, 0)', ValueError),  # tuple with length > 4
341.                   ('(0, 1, none)', ValueError),  # cannot cast none to float
342.                   ('(0, 1, "0.5")', ValueError),  # last one not a float
343.                   ),
344.          },
345.         {'validator': _validate_color_or_linecolor,
346.          'success': (('linecolor', 'linecolor'),
347.                      ('markerfacecolor', 'markerfacecolor'),
348.                      ('mfc', 'markerfacecolor'),
349.                      ('markeredgecolor', 'markeredgecolor'),
350.                      ('mec', 'markeredgecolor')
351.                      ),
352.          'fail': (('line', ValueError),
353.                   ('marker', ValueError)
354.                   )
355.          },
356.         {'validator': validate_hist_bins,
357.          'success': (('auto', 'auto'),
358.                      ('fd', 'fd'),
359.                      ('10', 10),
360.                      ('1, 2, 3', [1, 2, 3]),
361.                      ([1, 2, 3], [1, 2, 3]),
362.                      (np.arange(15), np.arange(15))
363.                      ),
364.          'fail': (('aardvark', ValueError),
365.                   )
366.          },
367.         {'validator': validate_markevery,
368.          'success': ((None, None),
369.                      (1, 1),
370.                      (0.1, 0.1),
371.                      ((1, 1), (1, 1)),
372.                      ((0.1, 0.1), (0.1, 0.1)),
373.                      ([1, 2, 3], [1, 2, 3]),
374.                      (slice(2), slice(None, 2, None)),
375.                      (slice(1, 2, 3), slice(1, 2, 3))
376.                      ),
377.          'fail': (((1, 2, 3), TypeError),
378.                   ([1, 2, 0.3], TypeError),
379.                   (['a', 2, 3], TypeError),
380.                   ([1, 2, 'a'], TypeError),
381.                   ((0.1, 0.2, 0.3), TypeError),
382.                   ((0.1, 2, 3), TypeError),
383.                   ((1, 0.2, 0.3), TypeError),
384.                   ((1, 0.1), TypeError),
385.                   ((0.1, 1), TypeError),
386.                   (('abc'), TypeError),
387.                   ((1, 'a'), TypeError),
388.                   ((0.1, 'b'), TypeError),
389.                   (('a', 1), TypeError),
390.                   (('a', 0.1), TypeError),
391.                   ('abc', TypeError),
392.                   ('a', TypeError),
393.                   (object(), TypeError)
394.                   )
395.          },
396.         {'validator': _validate_linestyle,
397.          'success': (('-', '-'), ('solid', 'solid'),
398.                      ('--', '--'), ('dashed', 'dashed'),
399.                      ('-.', '-.'), ('dashdot', 'dashdot'),
400.                      (':', ':'), ('dotted', 'dotted'),
401.                      ('', ''), (' ', ' '),
402.                      ('None', 'none'), ('none', 'none'),
403.                      ('DoTtEd', 'dotted'),  # case-insensitive
404.                      ('1, 3', (0, (1, 3))),
405.                      ([1.23, 456], (0, [1.23, 456.0])),
406.                      ([1, 2, 3, 4], (0, [1.0, 2.0, 3.0, 4.0])),
407.                      ((0, [1, 2]), (0, [1, 2])),
408.                      ((-1, [1, 2]), (-1, [1, 2])),
409.                      ),
410.          'fail': (('aardvark', ValueError),  # not a valid string
411.                   (b'dotted', ValueError),
412.                   ('dotted'.encode('utf-16'), ValueError),
413.                   ([1, 2, 3], ValueError),  # sequence with odd length
414.                   (1.23, ValueError),  # not a sequence
415.                   (("a", [1, 2]), ValueError),  # wrong explicit offset
416.                   ((None, [1, 2]), ValueError),  # wrong explicit offset
417.                   ((1, [1, 2, 3]), ValueError),  # odd length sequence
418.                   (([1, 2], 1), ValueError),  # inverted offset/onoff
419.                   )
420.          },
421.     )
422. 
423.     for validator_dict in validation_tests:
424.         validator = validator_dict['validator']
425.         if valid:
426.             for arg, target in validator_dict['success']:
427.                 yield validator, arg, target
428.         else:
429.             for arg, error_type in validator_dict['fail']:
430.                 yield validator, arg, error_type
431. 
432. 
433. @pytest.mark.parametrize('validator, arg, target',
434.                          generate_validator_testcases(True))
435. def test_validator_valid(validator, arg, target):
436.     res = validator(arg)
437.     if isinstance(target, np.ndarray):
438.         np.testing.assert_equal(res, target)
439.     elif not isinstance(target, Cycler):
440.         assert res == target
441.     else:
442.         # Cyclers can't simply be asserted equal. They don't implement __eq__
443.         assert list(res) == list(target)
444. 
445. 
446. @pytest.mark.parametrize('validator, arg, exception_type',
447.                          generate_validator_testcases(False))
448. def test_validator_invalid(validator, arg, exception_type):
449.     with pytest.raises(exception_type):
450.         validator(arg)
451. 
452. 
453. @pytest.mark.parametrize('weight, parsed_weight', [
454.     ('bold', 'bold'),
455.     ('BOLD', ValueError),  # weight is case-sensitive
456.     (100, 100),
457.     ('100', 100),
458.     (np.array(100), 100),
459.     # fractional fontweights are not defined. This should actually raise a
460.     # ValueError, but historically did not.
461.     (20.6, 20),
462.     ('20.6', ValueError),
463.     ([100], ValueError),
464. ])
465. def test_validate_fontweight(weight, parsed_weight):
466.     if parsed_weight is ValueError:
467.         with pytest.raises(ValueError):
468.             validate_fontweight(weight)
469.     else:
470.         assert validate_fontweight(weight) == parsed_weight
471. 
472. 
473. @pytest.mark.parametrize('stretch, parsed_stretch', [
474.     ('expanded', 'expanded'),
475.     ('EXPANDED', ValueError),  # stretch is case-sensitive
476.     (100, 100),
477.     ('100', 100),
478.     (np.array(100), 100),
479.     # fractional fontweights are not defined. This should actually raise a
480.     # ValueError, but historically did not.
481.     (20.6, 20),
482.     ('20.6', ValueError),
483.     ([100], ValueError),
484. ])
485. def test_validate_fontstretch(stretch, parsed_stretch):
486.     if parsed_stretch is ValueError:
487.         with pytest.raises(ValueError):
488.             validate_fontstretch(stretch)
489.     else:
490.         assert validate_fontstretch(stretch) == parsed_stretch
491. 
492. 
493. def test_keymaps():
494.     key_list = [k for k in mpl.rcParams if 'keymap' in k]
495.     for k in key_list:
496.         assert isinstance(mpl.rcParams[k], list)
497. 
498. 
499. def test_rcparams_reset_after_fail():
500.     # There was previously a bug that meant that if rc_context failed and

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 20:29:29,881 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to a bug involving `rc_context` and `get_backend`. The provided context for `lib/matplotlib/tests/test_rcparams.py` is incomplete, missing what could be a relevant test case. Furthermore, tests for `get_backend()` are likely located in `lib/matplotlib/tests/test_matplotlib.py`, which has not been provided yet and is essential for finding relevant tests for the reported bug.' query='Please provide the full content of `lib/matplotlib/tests/test_matplotlib.py` and the complete content of `lib/matplotlib/tests/test_rcparams.py`.' extra_requirements='If sending the full `test_rcparams.py` file is not possible, please at least provide the content from line 500 to the end of the file.' purpose='This information is needed to find test cases that cover the interaction between `rc_context`, backend initialization via `get_backend`, and figure management, which is at the core of the reported bug.'
2025-12-20 20:29:29,882 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `lib/matplotlib/tests/test_matplotlib.py` and the complete content of `lib/matplotlib/tests/test_rcparams.py`.
2025-12-20 20:29:29,882 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 20:29:29,882 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 20:29:29,883 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 20:29:29,883 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `lib/matplotlib/tests/test_matplotlib.py` and the complete content of `lib/matplotlib/tests/test_rcparams.py`.
Extra requirements: If sending the full `test_rcparams.py` file is not possible, please at least provide the content from line 500 to the end of the file.
Purpose: This information is needed to find test cases that cover the interaction between `rc_context`, backend initialization via `get_backend`, and figure management, which is at the core of the reported bug.
2025-12-20 20:29:53,279 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the full content of `lib/matplotlib/tests/test_matplotlib.py` to understand its test cases. I have also retrieved the complete content of `lib/matplotlib/tests/test_rcparams.py` to examine how it handles `rc_context` and backend interactions. This will help in finding relevant test cases for the reported bug.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1000.0, "start_line": 500.0, "relative_path": "lib/matplotlib/tests/test_rcparams.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2203, 'candidates_token_count': 132, 'total_token_count': 5019, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2203}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 132}], 'thoughts_token_count': 2684, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.2960556492660986, 'model_name': 'gemini-2.5-pro'} id='run--9975abdd-d761-4a0c-b473-4d1a195d035d-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_matplotlib.py'}, 'id': 'ad0ff23b-3c44-44d2-b23a-5d52e6cdfc3e', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 1000.0, 'start_line': 500.0, 'relative_path': 'lib/matplotlib/tests/test_rcparams.py'}, 'id': '35de21d1-8157-4fd9-b7b9-b23f0fde52b6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2203, 'output_tokens': 132, 'total_tokens': 5019, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2684}}
2025-12-20 20:29:59,632 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the full content of `lib/matplotlib/tests/test_matplotlib.py` and the latter portion of `lib/matplotlib/tests/test_rcparams.py`, starting from line 500. This provides crucial context for understanding the existing test coverage surrounding `rc_context`, backend initialization, and figure management, which will be instrumental in pinpointing the source of the reported bug.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "plt.figure", "relative_path": "lib/matplotlib/tests/test_rcparams.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5132, 'candidates_token_count': 123, 'total_token_count': 5786, 'cached_content_token_count': 1703, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5132}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1703}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 123}], 'thoughts_token_count': 531}, 'finish_reason': 'STOP', 'avg_logprobs': -0.49815232191628556, 'model_name': 'gemini-2.5-pro'} id='run--2624f4ad-1865-4fab-bc7e-978495b9fc1a-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'plt.figure', 'relative_path': 'lib/matplotlib/tests/test_rcparams.py'}, 'id': 'c9382015-95de-4ac3-8365-96005a163f65', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5132, 'output_tokens': 123, 'total_tokens': 5786, 'input_token_details': {'cache_read': 1703}, 'output_token_details': {'reasoning': 531}}
2025-12-20 20:30:02,607 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the contents of both `lib/matplotlib/tests/test_matplotlib.py` and `lib/matplotlib/tests/test_rcparams.py`. I then searched for instances of `plt.figure` within `test_rcparams.py` to locate relevant test cases, but no occurrences were found. I will now broaden my search to get a better understanding of the code.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "rc_context", "relative_path": "lib/matplotlib/tests/test_rcparams.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5287, 'candidates_token_count': 120, 'total_token_count': 5563, 'cached_content_token_count': 5108, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5287}], 'cache_tokens_details': [{'modality': 1, 'token_count': 5108}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 120}], 'thoughts_token_count': 156}, 'finish_reason': 'STOP', 'avg_logprobs': -0.16767921447753906, 'model_name': 'gemini-2.5-pro'} id='run--d8356f46-abdd-4df4-ade6-6ecf6123f54a-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'rc_context', 'relative_path': 'lib/matplotlib/tests/test_rcparams.py'}, 'id': 'aba63448-a81b-4787-93ba-e8996ec51ecd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5287, 'output_tokens': 120, 'total_tokens': 5563, 'input_token_details': {'cache_read': 5108}, 'output_token_details': {'reasoning': 156}}
2025-12-20 20:30:07,721 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed the provided test files, focusing on the usage of `rc_context`. My initial search for `plt.figure` within `test_rcparams.py` was unsuccessful, but a broader search for `rc_context` located four relevant code blocks. These findings illustrate the basic functionality of `rc_context` but do not seem to cover the specific interaction with `get_backend` and figure management that is central to the reported bug. I will now investigate how `get_backend` is tested to better understand its interaction with other components.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "get_backend", "relative_path": "lib/matplotlib/tests/test_rcparams.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6775, 'candidates_token_count': 152, 'total_token_count': 7246, 'cached_content_token_count': 5191, 'prompt_tokens_details': [{'modality': 1, 'token_count': 6775}], 'cache_tokens_details': [{'modality': 1, 'token_count': 5191}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 152}], 'thoughts_token_count': 319}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3005429569043611, 'model_name': 'gemini-2.5-pro'} id='run--01a3fd36-e97a-468b-9ff1-eb33084d5f06-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'get_backend', 'relative_path': 'lib/matplotlib/tests/test_rcparams.py'}, 'id': 'c1a989be-6f2a-4783-8bb2-3adb6b1aa998', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6775, 'output_tokens': 152, 'total_tokens': 7246, 'input_token_details': {'cache_read': 5191}, 'output_token_details': {'reasoning': 319}}
2025-12-20 20:30:13,099 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have reviewed the test files and their usage of `rc_context` and `get_backend`. My investigation reveals that while there are tests for each of these functions individually, there are no test cases that specifically cover their interaction. The existing tests in `test_rcparams.py` either focus on `rc_context` for parameter validation or test `get_backend` in isolated subprocesses. To properly address the reported bug, a new test is required to validate the interplay between `rc_context`, backend switching, and figure creation. I will now examine `lib/matplotlib/backends/__init__.py` to better understand the backend management implementation.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/backends/__init__.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7320, 'candidates_token_count': 157, 'total_token_count': 7798, 'cached_content_token_count': 5213, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7320}], 'cache_tokens_details': [{'modality': 1, 'token_count': 5213}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 157}], 'thoughts_token_count': 321}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2901395323929513, 'model_name': 'gemini-2.5-pro'} id='run--acde2ace-26ca-4d3f-a862-284276bb2c95-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/backends/__init__.py'}, 'id': 'c4c8705c-c5b5-460a-a845-e141366f12ef', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7320, 'output_tokens': 157, 'total_tokens': 7798, 'input_token_details': {'cache_read': 5213}, 'output_token_details': {'reasoning': 321}}
2025-12-20 20:30:17,659 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now examined the contents of `lib/matplotlib/tests/test_matplotlib.py`, `lib/matplotlib/tests/test_rcparams.py`, and `lib/matplotlib/backends/__init__.py`. My analysis indicates that while there are tests for `rc_context` and `get_backend` individually, there are no test cases that specifically address the interaction between them, which is the core of the reported bug. I am now prepared to provide a more detailed analysis and suggest a new test case.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7606, 'candidates_token_count': 107, 'total_token_count': 8027, 'cached_content_token_count': 6955, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7606}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6955}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 107}], 'thoughts_token_count': 314}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4987066750214479, 'model_name': 'gemini-2.5-pro'} id='run--81ee6495-c708-4be8-83e4-0907d9650f64-0' usage_metadata={'input_tokens': 7606, 'output_tokens': 107, 'total_tokens': 8027, 'input_token_details': {'cache_read': 6955}, 'output_token_details': {'reasoning': 314}}
2025-12-20 20:30:17,662 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `lib/matplotlib/tests/test_matplotlib.py` and the complete content of `lib/matplotlib/tests/test_rcparams.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If sending the full `test_rcparams.py` file is not possible, please at least provide the content from line 500 to the end of the file.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
This information is needed to find test cases that cover the interaction between `rc_context`, backend initialization via `get_backend`, and figure management, which is at the core of the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/backends/__init__.py
Line number range: 1 - 3
Content:
1. # NOTE: plt.switch_backend() (called at import time) will add a "backend"
2. # attribute here for backcompat.
3. _QT_FORCE_QT5_BINDING = False


File: lib/matplotlib/tests/test_matplotlib.py
Line number range: 1 - 77
Content:
1. import os
2. import subprocess
3. import sys
4. 
5. import pytest
6. 
7. import matplotlib
8. 
9. 
10. @pytest.mark.parametrize('version_str, version_tuple', [
11.     ('3.5.0', (3, 5, 0, 'final', 0)),
12.     ('3.5.0rc2', (3, 5, 0, 'candidate', 2)),
13.     ('3.5.0.dev820+g6768ef8c4c', (3, 5, 0, 'alpha', 820)),
14.     ('3.5.0.post820+g6768ef8c4c', (3, 5, 1, 'alpha', 820)),
15. ])
16. def test_parse_to_version_info(version_str, version_tuple):
17.     assert matplotlib._parse_to_version_info(version_str) == version_tuple
18. 
19. 
20. @pytest.mark.skipif(
21.     os.name == "nt", reason="chmod() doesn't work as is on Windows")
22. @pytest.mark.skipif(os.name != "nt" and os.geteuid() == 0,
23.                     reason="chmod() doesn't work as root")
24. def test_tmpconfigdir_warning(tmpdir):
25.     """Test that a warning is emitted if a temporary configdir must be used."""
26.     mode = os.stat(tmpdir).st_mode
27.     try:
28.         os.chmod(tmpdir, 0)
29.         proc = subprocess.run(
30.             [sys.executable, "-c", "import matplotlib"],
31.             env={**os.environ, "MPLCONFIGDIR": str(tmpdir)},
32.             stderr=subprocess.PIPE, universal_newlines=True, check=True)
33.         assert "set the MPLCONFIGDIR" in proc.stderr
34.     finally:
35.         os.chmod(tmpdir, mode)
36. 
37. 
38. def test_importable_with_no_home(tmpdir):
39.     subprocess.run(
40.         [sys.executable, "-c",
41.          "import pathlib; pathlib.Path.home = lambda *args: 1/0; "
42.          "import matplotlib.pyplot"],
43.         env={**os.environ, "MPLCONFIGDIR": str(tmpdir)}, check=True)
44. 
45. 
46. def test_use_doc_standard_backends():
47.     """
48.     Test that the standard backends mentioned in the docstring of
49.     matplotlib.use() are the same as in matplotlib.rcsetup.
50.     """
51.     def parse(key):
52.         backends = []
53.         for line in matplotlib.use.__doc__.split(key)[1].split('\n'):
54.             if not line.strip():
55.                 break
56.             backends += [e.strip() for e in line.split(',') if e]
57.         return backends
58. 
59.     assert (set(parse('- interactive backends:\n')) ==
60.             set(matplotlib.rcsetup.interactive_bk))
61.     assert (set(parse('- non-interactive backends:\n')) ==
62.             set(matplotlib.rcsetup.non_interactive_bk))
63. 
64. 
65. def test_importable_with__OO():
66.     """
67.     When using -OO or export PYTHONOPTIMIZE=2, docstrings are discarded,
68.     this simple test may prevent something like issue #17970.
69.     """
70.     program = (
71.         "import matplotlib as mpl; "
72.         "import matplotlib.pyplot as plt; "
73.         "import matplotlib.cbook as cbook; "
74.         "import matplotlib.patches as mpatches"
75.     )
76.     cmd = [sys.executable, "-OO", "-c", program]
77.     assert subprocess.call(cmd, env={**os.environ, "MPLBACKEND": ""}) == 0


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 34 - 69
Content:
def test_rcparams(tmpdir):
    mpl.rc('text', usetex=False)
    mpl.rc('lines', linewidth=22)

    usetex = mpl.rcParams['text.usetex']
    linewidth = mpl.rcParams['lines.linewidth']

    rcpath = Path(tmpdir) / 'test_rcparams.rc'
    rcpath.write_text('lines.linewidth: 33', encoding='utf-8')

    # test context given dictionary
    with mpl.rc_context(rc={'text.usetex': not usetex}):
        assert mpl.rcParams['text.usetex'] == (not usetex)
    assert mpl.rcParams['text.usetex'] == usetex

    # test context given filename (mpl.rc sets linewidth to 33)
    with mpl.rc_context(fname=rcpath):
        assert mpl.rcParams['lines.linewidth'] == 33
    assert mpl.rcParams['lines.linewidth'] == linewidth

    # test context given filename and dictionary
    with mpl.rc_context(fname=rcpath, rc={'lines.linewidth': 44}):
        assert mpl.rcParams['lines.linewidth'] == 44
    assert mpl.rcParams['lines.linewidth'] == linewidth

    # test context as decorator (and test reusability, by calling func twice)
    @mpl.rc_context({'lines.linewidth': 44})
    def func():
        assert mpl.rcParams['lines.linewidth'] == 44

    func()
    func()

    # test rc_file
    mpl.rc_file(rcpath)
    assert mpl.rcParams['lines.linewidth'] == 33


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 120 - 137
Content:
def test_Bug_2543():
    # Test that it possible to add all values to itself / deepcopy
    # https://github.com/matplotlib/matplotlib/issues/2543
    # We filter warnings at this stage since a number of them are raised
    # for deprecated rcparams as they should. We don't want these in the
    # printed in the test suite.
    with _api.suppress_matplotlib_deprecation_warning():
        with mpl.rc_context():
            _copy = mpl.rcParams.copy()
            for key in _copy:
                mpl.rcParams[key] = _copy[key]
        with mpl.rc_context():
            copy.deepcopy(mpl.rcParams)
    with pytest.raises(ValueError):
        validate_bool(None)
    with pytest.raises(ValueError):
        with mpl.rc_context():
            mpl.rcParams['svg.fonttype'] = True


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 160 - 170
Content:
@pytest.mark.parametrize('color_type, param_dict, target', legend_color_tests,
                         ids=legend_color_test_ids)
def test_legend_colors(color_type, param_dict, target):
    param_dict[f'legend.{color_type}color'] = param_dict.pop('color')
    get_func = f'get_{color_type}color'

    with mpl.rc_context(param_dict):
        _, ax = plt.subplots()
        ax.plot(range(3), label='test')
        leg = ax.legend()
        assert getattr(leg.legendPatch, get_func)() == target


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 499 - 508
Content:
def test_rcparams_reset_after_fail():
    # There was previously a bug that meant that if rc_context failed and
    # raised an exception due to issues in the supplied rc parameters, the
    # global rc parameters were left in a modified state.
    with mpl.rc_context(rc={'text.usetex': False}):
        assert mpl.rcParams['text.usetex'] is False
        with pytest.raises(KeyError):
            with mpl.rc_context(rc={'text.usetex': True, 'test.blah': True}):
                pass
        assert mpl.rcParams['text.usetex'] is False


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 500 - 1000
Content:
500.     # There was previously a bug that meant that if rc_context failed and
501.     # raised an exception due to issues in the supplied rc parameters, the
502.     # global rc parameters were left in a modified state.
503.     with mpl.rc_context(rc={'text.usetex': False}):
504.         assert mpl.rcParams['text.usetex'] is False
505.         with pytest.raises(KeyError):
506.             with mpl.rc_context(rc={'text.usetex': True, 'test.blah': True}):
507.                 pass
508.         assert mpl.rcParams['text.usetex'] is False
509. 
510. 
511. @pytest.mark.skipif(sys.platform != "linux", reason="Linux only")
512. def test_backend_fallback_headless(tmpdir):
513.     env = {**os.environ,
514.            "DISPLAY": "", "WAYLAND_DISPLAY": "",
515.            "MPLBACKEND": "", "MPLCONFIGDIR": str(tmpdir)}
516.     with pytest.raises(subprocess.CalledProcessError):
517.         subprocess.run(
518.             [sys.executable, "-c",
519.              "import matplotlib;"
520.              "matplotlib.use('tkagg');"
521.              "import matplotlib.pyplot;"
522.              "matplotlib.pyplot.plot(42);"
523.              ],
524.             env=env, check=True, stderr=subprocess.DEVNULL)
525. 
526. 
527. @pytest.mark.skipif(
528.     sys.platform == "linux" and not _c_internal_utils.display_is_valid(),
529.     reason="headless")
530. def test_backend_fallback_headful(tmpdir):
531.     pytest.importorskip("tkinter")
532.     env = {**os.environ, "MPLBACKEND": "", "MPLCONFIGDIR": str(tmpdir)}
533.     backend = subprocess.check_output(
534.         [sys.executable, "-c",
535.          "import matplotlib as mpl; "
536.          "sentinel = mpl.rcsetup._auto_backend_sentinel; "
537.          # Check that access on another instance does not resolve the sentinel.
538.          "assert mpl.RcParams({'backend': sentinel})['backend'] == sentinel; "
539.          "assert dict.__getitem__(mpl.rcParams, 'backend') == sentinel; "
540.          "import matplotlib.pyplot; "
541.          "print(matplotlib.get_backend())"],
542.         env=env, universal_newlines=True)
543.     # The actual backend will depend on what's installed, but at least tkagg is
544.     # present.
545.     assert backend.strip().lower() != "agg"
546. 
547. 
548. def test_deprecation(monkeypatch):
549.     monkeypatch.setitem(
550.         mpl._deprecated_map, "patch.linewidth",
551.         ("0.0", "axes.linewidth", lambda old: 2 * old, lambda new: new / 2))
552.     with pytest.warns(_api.MatplotlibDeprecationWarning):
553.         assert mpl.rcParams["patch.linewidth"] \
554.             == mpl.rcParams["axes.linewidth"] / 2
555.     with pytest.warns(_api.MatplotlibDeprecationWarning):
556.         mpl.rcParams["patch.linewidth"] = 1
557.     assert mpl.rcParams["axes.linewidth"] == 2
558. 
559.     monkeypatch.setitem(
560.         mpl._deprecated_ignore_map, "patch.edgecolor",
561.         ("0.0", "axes.edgecolor"))
562.     with pytest.warns(_api.MatplotlibDeprecationWarning):
563.         assert mpl.rcParams["patch.edgecolor"] \
564.             == mpl.rcParams["axes.edgecolor"]
565.     with pytest.warns(_api.MatplotlibDeprecationWarning):
566.         mpl.rcParams["patch.edgecolor"] = "#abcd"
567.     assert mpl.rcParams["axes.edgecolor"] != "#abcd"
568. 
569.     monkeypatch.setitem(
570.         mpl._deprecated_ignore_map, "patch.force_edgecolor",
571.         ("0.0", None))
572.     with pytest.warns(_api.MatplotlibDeprecationWarning):
573.         assert mpl.rcParams["patch.force_edgecolor"] is None
574. 
575.     monkeypatch.setitem(
576.         mpl._deprecated_remain_as_none, "svg.hashsalt",
577.         ("0.0",))
578.     with pytest.warns(_api.MatplotlibDeprecationWarning):
579.         mpl.rcParams["svg.hashsalt"] = "foobar"
580.     assert mpl.rcParams["svg.hashsalt"] == "foobar"  # Doesn't warn.
581.     mpl.rcParams["svg.hashsalt"] = None  # Doesn't warn.
582. 
583.     mpl.rcParams.update(mpl.rcParams.copy())  # Doesn't warn.
584.     # Note that the warning suppression actually arises from the
585.     # iteration over the updater rcParams being protected by
586.     # suppress_matplotlib_deprecation_warning, rather than any explicit check.

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 20:30:54,041 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the full content of `lib/matplotlib/tests/test_matplotlib.py`.\n\n2. Extended relevance:\n   - This context provides the entire available portion of the requested file, directly addressing the user's query.", relative_path='lib/matplotlib/tests/test_matplotlib.py', start_line=1, end_line=77), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the complete content of `lib/matplotlib/tests/test_rcparams.py`.\n\n2. Extended relevance:\n   - This context provides a relevant section of the requested file that tests `rc_context`, which is explicitly mentioned in the user's purpose.", relative_path='lib/matplotlib/tests/test_rcparams.py', start_line=34, end_line=69), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the complete content of `lib/matplotlib/tests/test_rcparams.py`.\n\n2. Extended relevance:\n   - This context provides a relevant section of the requested file that tests `rc_context`, which is explicitly mentioned in the user's purpose.", relative_path='lib/matplotlib/tests/test_rcparams.py', start_line=120, end_line=137), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the complete content of `lib/matplotlib/tests/test_rcparams.py`.\n\n2. Extended relevance:\n   - This context provides a relevant section of the requested file that tests `rc_context`, which is explicitly mentioned in the user's purpose.", relative_path='lib/matplotlib/tests/test_rcparams.py', start_line=160, end_line=170), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the content of `lib/matplotlib/tests/test_rcparams.py` from line 500 to the end of the file.\n\n2. Extended relevance:\n   - This context directly fulfills the user's specific request for the content from line 500 onwards.\n   - It contains tests covering `rc_context` and `get_backend`, which are at the core of the user's investigation as stated in the purpose.", relative_path='lib/matplotlib/tests/test_rcparams.py', start_line=500, end_line=1000)]
2025-12-20 20:30:54,043 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 5 contexts to memory for query: Please provide the full content of `lib/matplotlib/tests/test_matplotlib.py` and the complete content of `lib/matplotlib/tests/test_rcparams.py`.
2025-12-20 20:30:54,043 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 20:30:54,043 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 20:30:54,043 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 5 new contexts to 2 existing contexts
2025-12-20 20:30:54,043 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 4 total contexts (removed 3 duplicates)
2025-12-20 20:30:54,044 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19214-DS.rst
|   |   |   |   ├── 19368-DS.rst
|   |   |   |   ├── 20426-JK.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   ├── 21026-DS.rst
|   |   |   |   ├── 21042-AL.rst
|   |   |   |   ├── 21238-AL.rst
|   |   |   |   ├── 21983-AL.rst
|   |   |   |   ├── 22013-AL.rst
|   |   |   |   ├── 22063-SR.rst
|   |   |   |   ├── 22204-AL.rst
|   |   |   |   ├── 22229-TAC.rst
|   |   |   |   ├── 22485-TH.rst
|   |   |   |   ├── 22567-IT.rst
|   |   |   |   ├── 22639-RA.rst
|   |   |   |   ├── 22691-JMK.rst
|   |   |   |   ├── 22745-JMK.rst
|   |   |   |   ├── 23031-AL.rst
|   |   |   |   ├── 23170-JMK.rst
|   |   |   |   ├── 23188-JMK.rst
|   |   |   |   └── 23270-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20071-AL.rst
|   |   |   |   ├── 20839-EP.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   ├── 21425-AL.rst
|   |   |   |   ├── 21584-AL.rst
|   |   |   |   ├── 21962-AL.rst
|   |   |   |   ├── 21965-AL.rst
|   |   |   |   ├── 21981-AL.rst
|   |   |   |   ├── 21982-AL.rst
|   |   |   |   ├── 21992-AL.rst
|   |   |   |   ├── 21995-AL.rst
|   |   |   |   ├── 22021-AL.rst
|   |   |   |   ├── 22025-AL.rst
|   |   |   |   ├── 22050-AL.rst
|   |   |   |   ├── 22051-AL.rst
|   |   |   |   ├── 22084-SS.rst
|   |   |   |   ├── 22097-AL.rst
|   |   |   |   ├── 22098-AL.rst
|   |   |   |   ├── 22123-TH.rst
|   |   |   |   ├── 22133-OG.rst
|   |   |   |   ├── 22134-OG.rst
|   |   |   |   ├── 22148-OG.rst
|   |   |   |   ├── 22167-EP.rst
|   |   |   |   ├── 22245-AL.rst
|   |   |   |   ├── 22268-OG.rst
|   |   |   |   ├── 22298-GL.rst
|   |   |   |   ├── 22317-AL.rst
|   |   |   |   ├── 22323-GL.rst
|   |   |   |   ├── 22345-JK.rst
|   |   |   |   ├── 22415-AL.rst
|   |   |   |   ├── 22418-AL.rst
|   |   |   |   ├── 22421-AL.rst
|   |   |   |   ├── 22422-AL.rst
|   |   |   |   ├── 22490-AL.rst
|   |   |   |   ├── 22503-AL.rst
|   |   |   |   ├── 22509-AL.rst
|   |   |   |   ├── 22539-AL.rst
|   |   |   |   ├── 22547-AL.rst
|   |   |   |   ├── 22554-AL.rst
|   |   |   |   ├── 22697-OG.rst
|   |   |   |   ├── 22725-AL.rst
|   |   |   |   ├── 22797-OG.rst
|   |   |   |   ├── 22813-GL.rst
|   |   |   |   ├── 22883-AL.rst
|   |   |   |   ├── 22885-AL.rst
|   |   |   |   ├── 23014-OG.rst
|   |   |   |   ├── 23045-OG.rst
|   |   |   |   ├── 23081-OG.rst
|   |   |   |   ├── 23166-ES.rst
|   |   |   |   ├── 23190-OG.rst
|   |   |   |   ├── 23232-TH.rst
|   |   |   |   ├── 23289-AL.rst
|   |   |   |   ├── 23302-TH.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 21415-AL.rst
|   |   |   |   ├── 22205-ES.rst
|   |   |   |   └── 22550-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 00001-DS.rst
|   |   |       ├── 20990-AL.rst
|   |   |       ├── 21395-AL.rst
|   |   |       ├── 21591-AL.rst
|   |   |       ├── 21980-CC.rst
|   |   |       ├── 22081-AL.rst
|   |   |       ├── 22107-OG.rst
|   |   |       ├── 22365-OG.rst
|   |   |       ├── 22465-AL.rst
|   |   |       ├── 22486-OG.rst
|   |   |       ├── 22514-OG.rst
|   |   |       ├── 22516-OG.rst
|   |   |       ├── 22738-JL.rst
|   |   |       ├── 22886-OG.rst
|   |   |       ├── 22952-TH.rst
|   |   |       ├── 23076-GL.rst
|   |   |       ├── 23077-GL.rst
|   |   |       ├── 23078-GL.rst
|   |   |       ├── 23079-GL.rst
|   |   |       ├── 23093-GL.rst
|   |   |       └── 23237-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   └── api_changes_3.5.2.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plot_focal_length.rst
|       |   ├── 3d_plot_roll_angle.rst
|       |   ├── README.rst
|       |   ├── asinh_scale.rst
|       |   ├── color_support_for_math_to_image.rst
|       |   ├── custom_cap_widths.rst
|       |   ├── double_quotes_matplolibrc.rst
|       |   ├── extending_MarkerStyle.rst
|       |   ├── inset_axes_improvements.rst
|       |   ├── layout_engine.rst
|       |   ├── list_font_names.rst
|       |   ├── marker_none.rst
|       |   ├── min_macos_version.rst
|       |   ├── modify_stairs_fill_edge_behaviour.rst
|       |   ├── no_broken_streamlines.rst
|       |   ├── polygon_selector_box.rst
|       |   ├── polygon_vert_setter.rst
|       |   ├── rectangle_patch_rotation.rst
|       |   ├── rename_ncol_keyword_in_legend.rst
|       |   ├── selector_improvement.rst
|       |   ├── snap_selector.rst
|       |   ├── striped_lines.rst
|       |   ├── url_active_areas_rotate.rst
|       |   ├── use_contourpy.rst
|       |   └── windows_arm64.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   └── whats_new_3.5.2.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `lib/matplotlib/tests/test_rcparams.py` and `lib/matplotlib/tests/test_pyplot.py`.
Extra Requirements: 
Purpose: I need to find 3 relevant test cases that demonstrate the reported bug, and these files are the most likely to contain them.

Previous refined query 2:
Essential Query: Please provide the full content of `lib/matplotlib/tests/test_matplotlib.py` and the complete content of `lib/matplotlib/tests/test_rcparams.py`.
Extra Requirements: If sending the full `test_rcparams.py` file is not possible, please at least provide the content from line 500 to the end of the file.
Purpose: This information is needed to find test cases that cover the interaction between `rc_context`, backend initialization via `get_backend`, and figure management, which is at the core of the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_matplotlib.py
Line number range: 1 - 77
Content:
1. import os
2. import subprocess
3. import sys
4. 
5. import pytest
6. 
7. import matplotlib
8. 
9. 
10. @pytest.mark.parametrize('version_str, version_tuple', [
11.     ('3.5.0', (3, 5, 0, 'final', 0)),
12.     ('3.5.0rc2', (3, 5, 0, 'candidate', 2)),
13.     ('3.5.0.dev820+g6768ef8c4c', (3, 5, 0, 'alpha', 820)),
14.     ('3.5.0.post820+g6768ef8c4c', (3, 5, 1, 'alpha', 820)),
15. ])
16. def test_parse_to_version_info(version_str, version_tuple):
17.     assert matplotlib._parse_to_version_info(version_str) == version_tuple
18. 
19. 
20. @pytest.mark.skipif(
21.     os.name == "nt", reason="chmod() doesn't work as is on Windows")
22. @pytest.mark.skipif(os.name != "nt" and os.geteuid() == 0,
23.                     reason="chmod() doesn't work as root")
24. def test_tmpconfigdir_warning(tmpdir):
25.     """Test that a warning is emitted if a temporary configdir must be used."""
26.     mode = os.stat(tmpdir).st_mode
27.     try:
28.         os.chmod(tmpdir, 0)
29.         proc = subprocess.run(
30.             [sys.executable, "-c", "import matplotlib"],
31.             env={**os.environ, "MPLCONFIGDIR": str(tmpdir)},
32.             stderr=subprocess.PIPE, universal_newlines=True, check=True)
33.         assert "set the MPLCONFIGDIR" in proc.stderr
34.     finally:
35.         os.chmod(tmpdir, mode)
36. 
37. 
38. def test_importable_with_no_home(tmpdir):
39.     subprocess.run(
40.         [sys.executable, "-c",
41.          "import pathlib; pathlib.Path.home = lambda *args: 1/0; "
42.          "import matplotlib.pyplot"],
43.         env={**os.environ, "MPLCONFIGDIR": str(tmpdir)}, check=True)
44. 
45. 
46. def test_use_doc_standard_backends():
47.     """
48.     Test that the standard backends mentioned in the docstring of
49.     matplotlib.use() are the same as in matplotlib.rcsetup.
50.     """
51.     def parse(key):
52.         backends = []
53.         for line in matplotlib.use.__doc__.split(key)[1].split('\n'):
54.             if not line.strip():
55.                 break
56.             backends += [e.strip() for e in line.split(',') if e]
57.         return backends
58. 
59.     assert (set(parse('- interactive backends:\n')) ==
60.             set(matplotlib.rcsetup.interactive_bk))
61.     assert (set(parse('- non-interactive backends:\n')) ==
62.             set(matplotlib.rcsetup.non_interactive_bk))
63. 
64. 
65. def test_importable_with__OO():
66.     """
67.     When using -OO or export PYTHONOPTIMIZE=2, docstrings are discarded,
68.     this simple test may prevent something like issue #17970.
69.     """
70.     program = (
71.         "import matplotlib as mpl; "
72.         "import matplotlib.pyplot as plt; "
73.         "import matplotlib.cbook as cbook; "
74.         "import matplotlib.patches as mpatches"
75.     )
76.     cmd = [sys.executable, "-OO", "-c", program]
77.     assert subprocess.call(cmd, env={**os.environ, "MPLBACKEND": ""}) == 0


File: lib/matplotlib/tests/test_pyplot.py
Line number range: 1 - 385
Content:
1. import difflib
2. import re
3. 
4. import numpy as np
5. import subprocess
6. import sys
7. from pathlib import Path
8. 
9. import pytest
10. 
11. import matplotlib as mpl
12. from matplotlib import pyplot as plt
13. from matplotlib._api import MatplotlibDeprecationWarning
14. 
15. 
16. def test_pyplot_up_to_date(tmpdir):
17.     gen_script = Path(mpl.__file__).parents[2] / "tools/boilerplate.py"
18.     if not gen_script.exists():
19.         pytest.skip("boilerplate.py not found")
20.     orig_contents = Path(plt.__file__).read_text()
21.     plt_file = tmpdir.join('pyplot.py')
22.     plt_file.write_text(orig_contents, 'utf-8')
23. 
24.     subprocess.run([sys.executable, str(gen_script), str(plt_file)],
25.                    check=True)
26.     new_contents = plt_file.read_text('utf-8')
27. 
28.     if orig_contents != new_contents:
29.         diff_msg = '\n'.join(
30.             difflib.unified_diff(
31.                 orig_contents.split('\n'), new_contents.split('\n'),
32.                 fromfile='found pyplot.py',
33.                 tofile='expected pyplot.py',
34.                 n=0, lineterm=''))
35.         pytest.fail(
36.             "pyplot.py is not up-to-date. Please run "
37.             "'python tools/boilerplate.py' to update pyplot.py. "
38.             "This needs to be done from an environment where your "
39.             "current working copy is installed (e.g. 'pip install -e'd). "
40.             "Here is a diff of unexpected differences:\n%s" % diff_msg
41.         )
42. 
43. 
44. def test_copy_docstring_and_deprecators(recwarn):
45.     @mpl._api.rename_parameter("(version)", "old", "new")
46.     @mpl._api.make_keyword_only("(version)", "kwo")
47.     def func(new, kwo=None):
48.         pass
49. 
50.     @plt._copy_docstring_and_deprecators(func)
51.     def wrapper_func(new, kwo=None):
52.         pass
53. 
54.     wrapper_func(None)
55.     wrapper_func(new=None)
56.     wrapper_func(None, kwo=None)
57.     wrapper_func(new=None, kwo=None)
58.     assert not recwarn
59.     with pytest.warns(MatplotlibDeprecationWarning):
60.         wrapper_func(old=None)
61.     with pytest.warns(MatplotlibDeprecationWarning):
62.         wrapper_func(None, None)
63. 
64. 
65. def test_pyplot_box():
66.     fig, ax = plt.subplots()
67.     plt.box(False)
68.     assert not ax.get_frame_on()
69.     plt.box(True)
70.     assert ax.get_frame_on()
71.     plt.box()
72.     assert not ax.get_frame_on()
73.     plt.box()
74.     assert ax.get_frame_on()
75. 
76. 
77. def test_stackplot_smoke():
78.     # Small smoke test for stackplot (see #12405)
79.     plt.stackplot([1, 2, 3], [1, 2, 3])
80. 
81. 
82. def test_nrows_error():
83.     with pytest.raises(TypeError):
84.         plt.subplot(nrows=1)
85.     with pytest.raises(TypeError):
86.         plt.subplot(ncols=1)
87. 
88. 
89. def test_ioff():
90.     plt.ion()
91.     assert mpl.is_interactive()
92.     with plt.ioff():
93.         assert not mpl.is_interactive()
94.     assert mpl.is_interactive()
95. 
96.     plt.ioff()
97.     assert not mpl.is_interactive()
98.     with plt.ioff():
99.         assert not mpl.is_interactive()
100.     assert not mpl.is_interactive()
101. 
102. 
103. def test_ion():
104.     plt.ioff()
105.     assert not mpl.is_interactive()
106.     with plt.ion():
107.         assert mpl.is_interactive()
108.     assert not mpl.is_interactive()
109. 
110.     plt.ion()
111.     assert mpl.is_interactive()
112.     with plt.ion():
113.         assert mpl.is_interactive()
114.     assert mpl.is_interactive()
115. 
116. 
117. def test_nested_ion_ioff():
118.     # initial state is interactive
119.     plt.ion()
120. 
121.     # mixed ioff/ion
122.     with plt.ioff():
123.         assert not mpl.is_interactive()
124.         with plt.ion():
125.             assert mpl.is_interactive()
126.         assert not mpl.is_interactive()
127.     assert mpl.is_interactive()
128. 
129.     # redundant contexts
130.     with plt.ioff():
131.         with plt.ioff():
132.             assert not mpl.is_interactive()
133.     assert mpl.is_interactive()
134. 
135.     with plt.ion():
136.         plt.ioff()
137.     assert mpl.is_interactive()
138. 
139.     # initial state is not interactive
140.     plt.ioff()
141. 
142.     # mixed ioff/ion
143.     with plt.ion():
144.         assert mpl.is_interactive()
145.         with plt.ioff():
146.             assert not mpl.is_interactive()
147.         assert mpl.is_interactive()
148.     assert not mpl.is_interactive()
149. 
150.     # redundant contexts
151.     with plt.ion():
152.         with plt.ion():
153.             assert mpl.is_interactive()
154.     assert not mpl.is_interactive()
155. 
156.     with plt.ioff():
157.         plt.ion()
158.     assert not mpl.is_interactive()
159. 
160. 
161. def test_close():
162.     try:
163.         plt.close(1.1)
164.     except TypeError as e:
165.         assert str(e) == "close() argument must be a Figure, an int, " \
166.                          "a string, or None, not <class 'float'>"
167. 
168. 
169. def test_subplot_reuse():
170.     ax1 = plt.subplot(121)
171.     assert ax1 is plt.gca()
172.     ax2 = plt.subplot(122)
173.     assert ax2 is plt.gca()
174.     ax3 = plt.subplot(121)
175.     assert ax1 is plt.gca()
176.     assert ax1 is ax3
177. 
178. 
179. def test_axes_kwargs():
180.     # plt.axes() always creates new axes, even if axes kwargs differ.
181.     plt.figure()
182.     ax = plt.axes()
183.     ax1 = plt.axes()
184.     assert ax is not None
185.     assert ax1 is not ax
186.     plt.close()
187. 
188.     plt.figure()
189.     ax = plt.axes(projection='polar')
190.     ax1 = plt.axes(projection='polar')
191.     assert ax is not None
192.     assert ax1 is not ax
193.     plt.close()
194. 
195.     plt.figure()
196.     ax = plt.axes(projection='polar')
197.     ax1 = plt.axes()
198.     assert ax is not None
199.     assert ax1.name == 'rectilinear'
200.     assert ax1 is not ax
201.     plt.close()
202. 
203. 
204. def test_subplot_replace_projection():
205.     # plt.subplot() searches for axes with the same subplot spec, and if one
206.     # exists, and the kwargs match returns it, create a new one if they do not
207.     fig = plt.figure()
208.     ax = plt.subplot(1, 2, 1)
209.     ax1 = plt.subplot(1, 2, 1)
210.     ax2 = plt.subplot(1, 2, 2)
211.     with pytest.warns(MatplotlibDeprecationWarning):
212.         ax3 = plt.subplot(1, 2, 1, projection='polar')
213.     ax4 = plt.subplot(1, 2, 1, projection='polar')
214.     assert ax is not None
215.     assert ax1 is ax
216.     assert ax2 is not ax
217.     assert ax3 is not ax
218.     assert ax3 is ax4
219. 
220.     assert ax not in fig.axes
221.     assert ax2 in fig.axes
222.     assert ax3 in fig.axes
223. 
224.     assert ax.name == 'rectilinear'
225.     assert ax2.name == 'rectilinear'
226.     assert ax3.name == 'polar'
227. 
228. 
229. def test_subplot_kwarg_collision():
230.     ax1 = plt.subplot(projection='polar', theta_offset=0)
231.     ax2 = plt.subplot(projection='polar', theta_offset=0)
232.     assert ax1 is ax2
233.     ax1.remove()
234.     ax3 = plt.subplot(projection='polar', theta_offset=1)
235.     assert ax1 is not ax3
236.     assert ax1 not in plt.gcf().axes
237. 
238. 
239. def test_gca():
240.     # plt.gca() returns an existing axes, unless there were no axes.
241.     plt.figure()
242.     ax = plt.gca()
243.     ax1 = plt.gca()
244.     assert ax is not None
245.     assert ax1 is ax
246.     plt.close()
247. 
248. 
249. def test_subplot_projection_reuse():
250.     # create an Axes
251.     ax1 = plt.subplot(111)
252.     # check that it is current
253.     assert ax1 is plt.gca()
254.     # make sure we get it back if we ask again
255.     assert ax1 is plt.subplot(111)
256.     # remove it
257.     ax1.remove()
258.     # create a polar plot
259.     ax2 = plt.subplot(111, projection='polar')
260.     assert ax2 is plt.gca()
261.     # this should have deleted the first axes
262.     assert ax1 not in plt.gcf().axes
263.     # assert we get it back if no extra parameters passed
264.     assert ax2 is plt.subplot(111)
265.     ax2.remove()
266.     # now check explicitly setting the projection to rectilinear
267.     # makes a new axes
268.     ax3 = plt.subplot(111, projection='rectilinear')
269.     assert ax3 is plt.gca()
270.     assert ax3 is not ax2
271.     assert ax2 not in plt.gcf().axes
272. 
273. 
274. def test_subplot_polar_normalization():
275.     ax1 = plt.subplot(111, projection='polar')
276.     ax2 = plt.subplot(111, polar=True)
277.     ax3 = plt.subplot(111, polar=True, projection='polar')
278.     assert ax1 is ax2
279.     assert ax1 is ax3
280. 
281.     with pytest.raises(ValueError,
282.                        match="polar=True, yet projection='3d'"):
283.         ax2 = plt.subplot(111, polar=True, projection='3d')
284. 
285. 
286. def test_subplot_change_projection():
287.     created_axes = set()
288.     ax = plt.subplot()
289.     created_axes.add(ax)
290.     projections = ('aitoff', 'hammer', 'lambert', 'mollweide',
291.                    'polar', 'rectilinear', '3d')
292.     for proj in projections:
293.         ax.remove()
294.         ax = plt.subplot(projection=proj)
295.         assert ax is plt.subplot()
296.         assert ax.name == proj
297.         created_axes.add(ax)
298.     # Check that each call created a new Axes.
299.     assert len(created_axes) == 1 + len(projections)
300. 
301. 
302. def test_polar_second_call():
303.     # the first call creates the axes with polar projection
304.     ln1, = plt.polar(0., 1., 'ro')
305.     assert isinstance(ln1, mpl.lines.Line2D)
306.     # the second call should reuse the existing axes
307.     ln2, = plt.polar(1.57, .5, 'bo')
308.     assert isinstance(ln2, mpl.lines.Line2D)
309.     assert ln1.axes is ln2.axes
310. 
311. 
312. def test_fallback_position():
313.     # check that position kwarg works if rect not supplied
314.     axref = plt.axes([0.2, 0.2, 0.5, 0.5])
315.     axtest = plt.axes(position=[0.2, 0.2, 0.5, 0.5])
316.     np.testing.assert_allclose(axtest.bbox.get_points(),
317.                                axref.bbox.get_points())
318. 
319.     # check that position kwarg ignored if rect is supplied
320.     axref = plt.axes([0.2, 0.2, 0.5, 0.5])
321.     axtest = plt.axes([0.2, 0.2, 0.5, 0.5], position=[0.1, 0.1, 0.8, 0.8])
322.     np.testing.assert_allclose(axtest.bbox.get_points(),
323.                                axref.bbox.get_points())
324. 
325. 
326. def test_set_current_figure_via_subfigure():
327.     fig1 = plt.figure()
328.     subfigs = fig1.subfigures(2)
329. 
330.     plt.figure()
331.     assert plt.gcf() != fig1
332. 
333.     current = plt.figure(subfigs[1])
334.     assert plt.gcf() == fig1
335.     assert current == fig1
336. 
337. 
338. def test_set_current_axes_on_subfigure():
339.     fig = plt.figure()
340.     subfigs = fig.subfigures(2)
341. 
342.     ax = subfigs[0].subplots(1, squeeze=True)
343.     subfigs[1].subplots(1, squeeze=True)
344. 
345.     assert plt.gca() != ax
346.     plt.sca(ax)
347.     assert plt.gca() == ax
348. 
349. 
350. def test_pylab_integration():
351.     IPython = pytest.importorskip("IPython")
352.     mpl.testing.subprocess_run_helper(
353.         IPython.start_ipython,
354.         "--pylab",
355.         "-c",
356.         ";".join((
357.             "import matplotlib.pyplot as plt",
358.             "assert plt._REPL_DISPLAYHOOK == plt._ReplDisplayHook.IPYTHON",
359.         )),
360.         timeout=60,
361.     )
362. 
363. 
364. def test_doc_pyplot_summary():
365.     """Test that pyplot_summary lists all the plot functions."""
366.     pyplot_docs = Path(__file__).parent / '../../../doc/api/pyplot_summary.rst'
367.     if not pyplot_docs.exists():
368.         pytest.skip("Documentation sources not available")
369. 
370.     lines = pyplot_docs.read_text()
371.     m = re.search(r':nosignatures:\n\n(.*?)\n\n', lines, re.DOTALL)
372.     doc_functions = set(line.strip() for line in m.group(1).split('\n'))
373.     plot_commands = set(plt.get_plot_commands())
374.     missing = plot_commands.difference(doc_functions)
375.     if missing:
376.         raise AssertionError(
377.             f"The following pyplot functions are not listed in the "
378.             f"documentation. Please add them to doc/api/pyplot_summary.rst: "
379.             f"{missing!r}")
380.     extra = doc_functions.difference(plot_commands)
381.     if extra:
382.         raise AssertionError(
383.             f"The following functions are listed in the pyplot documentation, "
384.             f"but they do not exist in pyplot. "
385.             f"Please remove them from doc/api/pyplot_summary.rst: {extra!r}")


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 1 - 500
Content:
1. import copy
2. import os
3. from pathlib import Path
4. import subprocess
5. import sys
6. from unittest import mock
7. 
8. from cycler import cycler, Cycler
9. import pytest
10. 
11. import matplotlib as mpl
12. from matplotlib import _api, _c_internal_utils
13. import matplotlib.pyplot as plt
14. import matplotlib.colors as mcolors
15. import numpy as np
16. from matplotlib.rcsetup import (
17.     validate_bool,
18.     validate_color,
19.     validate_colorlist,
20.     _validate_color_or_linecolor,
21.     validate_cycler,
22.     validate_float,
23.     validate_fontstretch,
24.     validate_fontweight,
25.     validate_hatch,
26.     validate_hist_bins,
27.     validate_int,
28.     validate_markevery,
29.     validate_stringlist,
30.     _validate_linestyle,
31.     _listify_validator)
32. 
33. 
34. def test_rcparams(tmpdir):
35.     mpl.rc('text', usetex=False)
36.     mpl.rc('lines', linewidth=22)
37. 
38.     usetex = mpl.rcParams['text.usetex']
39.     linewidth = mpl.rcParams['lines.linewidth']
40. 
41.     rcpath = Path(tmpdir) / 'test_rcparams.rc'
42.     rcpath.write_text('lines.linewidth: 33', encoding='utf-8')
43. 
44.     # test context given dictionary
45.     with mpl.rc_context(rc={'text.usetex': not usetex}):
46.         assert mpl.rcParams['text.usetex'] == (not usetex)
47.     assert mpl.rcParams['text.usetex'] == usetex
48. 
49.     # test context given filename (mpl.rc sets linewidth to 33)
50.     with mpl.rc_context(fname=rcpath):
51.         assert mpl.rcParams['lines.linewidth'] == 33
52.     assert mpl.rcParams['lines.linewidth'] == linewidth
53. 
54.     # test context given filename and dictionary
55.     with mpl.rc_context(fname=rcpath, rc={'lines.linewidth': 44}):
56.         assert mpl.rcParams['lines.linewidth'] == 44
57.     assert mpl.rcParams['lines.linewidth'] == linewidth
58. 
59.     # test context as decorator (and test reusability, by calling func twice)
60.     @mpl.rc_context({'lines.linewidth': 44})
61.     def func():
62.         assert mpl.rcParams['lines.linewidth'] == 44
63. 
64.     func()
65.     func()
66. 
67.     # test rc_file
68.     mpl.rc_file(rcpath)
69.     assert mpl.rcParams['lines.linewidth'] == 33
70. 
71. 
72. def test_RcParams_class():
73.     rc = mpl.RcParams({'font.cursive': ['Apple Chancery',
74.                                         'Textile',
75.                                         'Zapf Chancery',
76.                                         'cursive'],
77.                        'font.family': 'sans-serif',
78.                        'font.weight': 'normal',
79.                        'font.size': 12})
80. 
81.     expected_repr = """
82. RcParams({'font.cursive': ['Apple Chancery',
83.                            'Textile',
84.                            'Zapf Chancery',
85.                            'cursive'],
86.           'font.family': ['sans-serif'],
87.           'font.size': 12.0,
88.           'font.weight': 'normal'})""".lstrip()
89. 
90.     assert expected_repr == repr(rc)
91. 
92.     expected_str = """
93. font.cursive: ['Apple Chancery', 'Textile', 'Zapf Chancery', 'cursive']
94. font.family: ['sans-serif']
95. font.size: 12.0
96. font.weight: normal""".lstrip()
97. 
98.     assert expected_str == str(rc)
99. 
100.     # test the find_all functionality
101.     assert ['font.cursive', 'font.size'] == sorted(rc.find_all('i[vz]'))
102.     assert ['font.family'] == list(rc.find_all('family'))
103. 
104. 
105. def test_rcparams_update():
106.     rc = mpl.RcParams({'figure.figsize': (3.5, 42)})
107.     bad_dict = {'figure.figsize': (3.5, 42, 1)}
108.     # make sure validation happens on input
109.     with pytest.raises(ValueError), \
110.          pytest.warns(UserWarning, match="validate"):
111.         rc.update(bad_dict)
112. 
113. 
114. def test_rcparams_init():
115.     with pytest.raises(ValueError), \
116.          pytest.warns(UserWarning, match="validate"):
117.         mpl.RcParams({'figure.figsize': (3.5, 42, 1)})
118. 
119. 
120. def test_Bug_2543():
121.     # Test that it possible to add all values to itself / deepcopy
122.     # https://github.com/matplotlib/matplotlib/issues/2543
123.     # We filter warnings at this stage since a number of them are raised
124.     # for deprecated rcparams as they should. We don't want these in the
125.     # printed in the test suite.
126.     with _api.suppress_matplotlib_deprecation_warning():
127.         with mpl.rc_context():
128.             _copy = mpl.rcParams.copy()
129.             for key in _copy:
130.                 mpl.rcParams[key] = _copy[key]
131.         with mpl.rc_context():
132.             copy.deepcopy(mpl.rcParams)
133.     with pytest.raises(ValueError):
134.         validate_bool(None)
135.     with pytest.raises(ValueError):
136.         with mpl.rc_context():
137.             mpl.rcParams['svg.fonttype'] = True
138. 
139. 
140. legend_color_tests = [
141.     ('face', {'color': 'r'}, mcolors.to_rgba('r')),
142.     ('face', {'color': 'inherit', 'axes.facecolor': 'r'},
143.      mcolors.to_rgba('r')),
144.     ('face', {'color': 'g', 'axes.facecolor': 'r'}, mcolors.to_rgba('g')),
145.     ('edge', {'color': 'r'}, mcolors.to_rgba('r')),
146.     ('edge', {'color': 'inherit', 'axes.edgecolor': 'r'},
147.      mcolors.to_rgba('r')),
148.     ('edge', {'color': 'g', 'axes.facecolor': 'r'}, mcolors.to_rgba('g'))
149. ]
150. legend_color_test_ids = [
151.     'same facecolor',
152.     'inherited facecolor',
153.     'different facecolor',
154.     'same edgecolor',
155.     'inherited edgecolor',
156.     'different facecolor',
157. ]
158. 
159. 
160. @pytest.mark.parametrize('color_type, param_dict, target', legend_color_tests,
161.                          ids=legend_color_test_ids)
162. def test_legend_colors(color_type, param_dict, target):
163.     param_dict[f'legend.{color_type}color'] = param_dict.pop('color')
164.     get_func = f'get_{color_type}color'
165. 
166.     with mpl.rc_context(param_dict):
167.         _, ax = plt.subplots()
168.         ax.plot(range(3), label='test')
169.         leg = ax.legend()
170.         assert getattr(leg.legendPatch, get_func)() == target
171. 
172. 
173. def test_mfc_rcparams():
174.     mpl.rcParams['lines.markerfacecolor'] = 'r'
175.     ln = mpl.lines.Line2D([1, 2], [1, 2])
176.     assert ln.get_markerfacecolor() == 'r'
177. 
178. 
179. def test_mec_rcparams():
180.     mpl.rcParams['lines.markeredgecolor'] = 'r'
181.     ln = mpl.lines.Line2D([1, 2], [1, 2])
182.     assert ln.get_markeredgecolor() == 'r'
183. 
184. 
185. def test_axes_titlecolor_rcparams():
186.     mpl.rcParams['axes.titlecolor'] = 'r'
187.     _, ax = plt.subplots()
188.     title = ax.set_title("Title")
189.     assert title.get_color() == 'r'
190. 
191. 
192. def test_Issue_1713(tmpdir):
193.     rcpath = Path(tmpdir) / 'test_rcparams.rc'
194.     rcpath.write_text('timezone: UTC', encoding='utf-8')
195.     with mock.patch('locale.getpreferredencoding', return_value='UTF-32-BE'):
196.         rc = mpl.rc_params_from_file(rcpath, True, False)
197.     assert rc.get('timezone') == 'UTC'
198. 
199. 
200. def test_animation_frame_formats():
201.     # Animation frame_format should allow any of the following
202.     # if any of these are not allowed, an exception will be raised
203.     # test for gh issue #17908
204.     for fmt in ['png', 'jpeg', 'tiff', 'raw', 'rgba', 'ppm',
205.                 'sgi', 'bmp', 'pbm', 'svg']:
206.         mpl.rcParams['animation.frame_format'] = fmt
207. 
208. 
209. def generate_validator_testcases(valid):
210.     validation_tests = (
211.         {'validator': validate_bool,
212.          'success': (*((_, True) for _ in
213.                        ('t', 'y', 'yes', 'on', 'true', '1', 1, True)),
214.                      *((_, False) for _ in
215.                        ('f', 'n', 'no', 'off', 'false', '0', 0, False))),
216.          'fail': ((_, ValueError)
217.                   for _ in ('aardvark', 2, -1, [], ))
218.          },
219.         {'validator': validate_stringlist,
220.          'success': (('', []),
221.                      ('a,b', ['a', 'b']),
222.                      ('aardvark', ['aardvark']),
223.                      ('aardvark, ', ['aardvark']),
224.                      ('aardvark, ,', ['aardvark']),
225.                      (['a', 'b'], ['a', 'b']),
226.                      (('a', 'b'), ['a', 'b']),
227.                      (iter(['a', 'b']), ['a', 'b']),
228.                      (np.array(['a', 'b']), ['a', 'b']),
229.                      ),
230.          'fail': ((set(), ValueError),
231.                   (1, ValueError),
232.                   ((1, 2), _api.MatplotlibDeprecationWarning),
233.                   (np.array([1, 2]), _api.MatplotlibDeprecationWarning),
234.                   )
235.          },
236.         {'validator': _listify_validator(validate_int, n=2),
237.          'success': ((_, [1, 2])
238.                      for _ in ('1, 2', [1.5, 2.5], [1, 2],
239.                                (1, 2), np.array((1, 2)))),
240.          'fail': ((_, ValueError)
241.                   for _ in ('aardvark', ('a', 1),
242.                             (1, 2, 3)
243.                             ))
244.          },
245.         {'validator': _listify_validator(validate_float, n=2),
246.          'success': ((_, [1.5, 2.5])
247.                      for _ in ('1.5, 2.5', [1.5, 2.5], [1.5, 2.5],
248.                                (1.5, 2.5), np.array((1.5, 2.5)))),
249.          'fail': ((_, ValueError)
250.                   for _ in ('aardvark', ('a', 1), (1, 2, 3), (None, ), None))
251.          },
252.         {'validator': validate_cycler,
253.          'success': (('cycler("color", "rgb")',
254.                       cycler("color", 'rgb')),
255.                      (cycler('linestyle', ['-', '--']),
256.                       cycler('linestyle', ['-', '--'])),
257.                      ("""(cycler("color", ["r", "g", "b"]) +
258.                           cycler("mew", [2, 3, 5]))""",
259.                       (cycler("color", 'rgb') +
260.                        cycler("markeredgewidth", [2, 3, 5]))),
261.                      ("cycler(c='rgb', lw=[1, 2, 3])",
262.                       cycler('color', 'rgb') + cycler('linewidth', [1, 2, 3])),
263.                      ("cycler('c', 'rgb') * cycler('linestyle', ['-', '--'])",
264.                       (cycler('color', 'rgb') *
265.                        cycler('linestyle', ['-', '--']))),
266.                      (cycler('ls', ['-', '--']),
267.                       cycler('linestyle', ['-', '--'])),
268.                      (cycler(mew=[2, 5]),
269.                       cycler('markeredgewidth', [2, 5])),
270.                      ),
271.          # This is *so* incredibly important: validate_cycler() eval's
272.          # an arbitrary string! I think I have it locked down enough,
273.          # and that is what this is testing.
274.          # TODO: Note that these tests are actually insufficient, as it may
275.          # be that they raised errors, but still did an action prior to
276.          # raising the exception. We should devise some additional tests
277.          # for that...
278.          'fail': ((4, ValueError),  # Gotta be a string or Cycler object
279.                   ('cycler("bleh, [])', ValueError),  # syntax error
280.                   ('Cycler("linewidth", [1, 2, 3])',
281.                    ValueError),  # only 'cycler()' function is allowed
282.                   # do not allow dunder in string literals
283.                   ("cycler('c', [j.__class__(j) for j in ['r', 'b']])",
284.                    ValueError),
285.                   ("cycler('c', [j. __class__(j) for j in ['r', 'b']])",
286.                    ValueError),
287.                   ("cycler('c', [j.\t__class__(j) for j in ['r', 'b']])",
288.                    ValueError),
289.                   ("cycler('c', [j.\u000c__class__(j) for j in ['r', 'b']])",
290.                    ValueError),
291.                   ("cycler('c', [j.__class__(j).lower() for j in ['r', 'b']])",
292.                    ValueError),
293.                   ('1 + 2', ValueError),  # doesn't produce a Cycler object
294.                   ('os.system("echo Gotcha")', ValueError),  # os not available
295.                   ('import os', ValueError),  # should not be able to import
296.                   ('def badjuju(a): return a; badjuju(cycler("color", "rgb"))',
297.                    ValueError),  # Should not be able to define anything
298.                   # even if it does return a cycler
299.                   ('cycler("waka", [1, 2, 3])', ValueError),  # not a property
300.                   ('cycler(c=[1, 2, 3])', ValueError),  # invalid values
301.                   ("cycler(lw=['a', 'b', 'c'])", ValueError),  # invalid values
302.                   (cycler('waka', [1, 3, 5]), ValueError),  # not a property
303.                   (cycler('color', ['C1', 'r', 'g']), ValueError)  # no CN
304.                   )
305.          },
306.         {'validator': validate_hatch,
307.          'success': (('--|', '--|'), ('\\oO', '\\oO'),
308.                      ('/+*/.x', '/+*/.x'), ('', '')),
309.          'fail': (('--_', ValueError),
310.                   (8, ValueError),
311.                   ('X', ValueError)),
312.          },
313.         {'validator': validate_colorlist,
314.          'success': (('r,g,b', ['r', 'g', 'b']),
315.                      (['r', 'g', 'b'], ['r', 'g', 'b']),
316.                      ('r, ,', ['r']),
317.                      (['', 'g', 'blue'], ['g', 'blue']),
318.                      ([np.array([1, 0, 0]), np.array([0, 1, 0])],
319.                      np.array([[1, 0, 0], [0, 1, 0]])),
320.                      (np.array([[1, 0, 0], [0, 1, 0]]),
321.                      np.array([[1, 0, 0], [0, 1, 0]])),
322.                      ),
323.          'fail': (('fish', ValueError),
324.                   ),
325.          },
326.         {'validator': validate_color,
327.          'success': (('None', 'none'),
328.                      ('none', 'none'),
329.                      ('AABBCC', '#AABBCC'),  # RGB hex code
330.                      ('AABBCC00', '#AABBCC00'),  # RGBA hex code
331.                      ('tab:blue', 'tab:blue'),  # named color
332.                      ('C12', 'C12'),  # color from cycle
333.                      ('(0, 1, 0)', (0.0, 1.0, 0.0)),  # RGB tuple
334.                      ((0, 1, 0), (0, 1, 0)),  # non-string version
335.                      ('(0, 1, 0, 1)', (0.0, 1.0, 0.0, 1.0)),  # RGBA tuple
336.                      ((0, 1, 0, 1), (0, 1, 0, 1)),  # non-string version
337.                      ),
338.          'fail': (('tab:veryblue', ValueError),  # invalid name
339.                   ('(0, 1)', ValueError),  # tuple with length < 3
340.                   ('(0, 1, 0, 1, 0)', ValueError),  # tuple with length > 4
341.                   ('(0, 1, none)', ValueError),  # cannot cast none to float
342.                   ('(0, 1, "0.5")', ValueError),  # last one not a float
343.                   ),
344.          },
345.         {'validator': _validate_color_or_linecolor,
346.          'success': (('linecolor', 'linecolor'),
347.                      ('markerfacecolor', 'markerfacecolor'),
348.                      ('mfc', 'markerfacecolor'),
349.                      ('markeredgecolor', 'markeredgecolor'),
350.                      ('mec', 'markeredgecolor')
351.                      ),
352.          'fail': (('line', ValueError),
353.                   ('marker', ValueError)
354.                   )
355.          },
356.         {'validator': validate_hist_bins,
357.          'success': (('auto', 'auto'),
358.                      ('fd', 'fd'),
359.                      ('10', 10),
360.                      ('1, 2, 3', [1, 2, 3]),
361.                      ([1, 2, 3], [1, 2, 3]),
362.                      (np.arange(15), np.arange(15))
363.                      ),
364.          'fail': (('aardvark', ValueError),
365.                   )
366.          },
367.         {'validator': validate_markevery,
368.          'success': ((None, None),
369.                      (1, 1),
370.                      (0.1, 0.1),
371.                      ((1, 1), (1, 1)),
372.                      ((0.1, 0.1), (0.1, 0.1)),
373.                      ([1, 2, 3], [1, 2, 3]),
374.                      (slice(2), slice(None, 2, None)),
375.                      (slice(1, 2, 3), slice(1, 2, 3))
376.                      ),
377.          'fail': (((1, 2, 3), TypeError),
378.                   ([1, 2, 0.3], TypeError),
379.                   (['a', 2, 3], TypeError),
380.                   ([1, 2, 'a'], TypeError),
381.                   ((0.1, 0.2, 0.3), TypeError),
382.                   ((0.1, 2, 3), TypeError),
383.                   ((1, 0.2, 0.3), TypeError),
384.                   ((1, 0.1), TypeError),
385.                   ((0.1, 1), TypeError),
386.                   (('abc'), TypeError),
387.                   ((1, 'a'), TypeError),
388.                   ((0.1, 'b'), TypeError),
389.                   (('a', 1), TypeError),
390.                   (('a', 0.1), TypeError),
391.                   ('abc', TypeError),
392.                   ('a', TypeError),
393.                   (object(), TypeError)
394.                   )
395.          },
396.         {'validator': _validate_linestyle,
397.          'success': (('-', '-'), ('solid', 'solid'),
398.                      ('--', '--'), ('dashed', 'dashed'),
399.                      ('-.', '-.'), ('dashdot', 'dashdot'),
400.                      (':', ':'), ('dotted', 'dotted'),
401.                      ('', ''), (' ', ' '),
402.                      ('None', 'none'), ('none', 'none'),
403.                      ('DoTtEd', 'dotted'),  # case-insensitive
404.                      ('1, 3', (0, (1, 3))),
405.                      ([1.23, 456], (0, [1.23, 456.0])),
406.                      ([1, 2, 3, 4], (0, [1.0, 2.0, 3.0, 4.0])),
407.                      ((0, [1, 2]), (0, [1, 2])),
408.                      ((-1, [1, 2]), (-1, [1, 2])),
409.                      ),
410.          'fail': (('aardvark', ValueError),  # not a valid string
411.                   (b'dotted', ValueError),
412.                   ('dotted'.encode('utf-16'), ValueError),
413.                   ([1, 2, 3], ValueError),  # sequence with odd length
414.                   (1.23, ValueError),  # not a sequence
415.                   (("a", [1, 2]), ValueError),  # wrong explicit offset
416.                   ((None, [1, 2]), ValueError),  # wrong explicit offset
417.                   ((1, [1, 2, 3]), ValueError),  # odd length sequence
418.                   (([1, 2], 1), ValueError),  # inverted offset/onoff
419.                   )
420.          },
421.     )
422. 
423.     for validator_dict in validation_tests:
424.         validator = validator_dict['validator']
425.         if valid:
426.             for arg, target in validator_dict['success']:
427.                 yield validator, arg, target
428.         else:
429.             for arg, error_type in validator_dict['fail']:
430.                 yield validator, arg, error_type
431. 
432. 
433. @pytest.mark.parametrize('validator, arg, target',
434.                          generate_validator_testcases(True))
435. def test_validator_valid(validator, arg, target):
436.     res = validator(arg)
437.     if isinstance(target, np.ndarray):
438.         np.testing.assert_equal(res, target)
439.     elif not isinstance(target, Cycler):
440.         assert res == target
441.     else:
442.         # Cyclers can't simply be asserted equal. They don't implement __eq__
443.         assert list(res) == list(target)
444. 
445. 
446. @pytest.mark.parametrize('validator, arg, exception_type',
447.                          generate_validator_testcases(False))
448. def test_validator_invalid(validator, arg, exception_type):
449.     with pytest.raises(exception_type):
450.         validator(arg)
451. 
452. 
453. @pytest.mark.parametrize('weight, parsed_weight', [
454.     ('bold', 'bold'),
455.     ('BOLD', ValueError),  # weight is case-sensitive
456.     (100, 100),
457.     ('100', 100),
458.     (np.array(100), 100),
459.     # fractional fontweights are not defined. This should actually raise a
460.     # ValueError, but historically did not.
461.     (20.6, 20),
462.     ('20.6', ValueError),
463.     ([100], ValueError),
464. ])
465. def test_validate_fontweight(weight, parsed_weight):
466.     if parsed_weight is ValueError:
467.         with pytest.raises(ValueError):
468.             validate_fontweight(weight)
469.     else:
470.         assert validate_fontweight(weight) == parsed_weight
471. 
472. 
473. @pytest.mark.parametrize('stretch, parsed_stretch', [
474.     ('expanded', 'expanded'),
475.     ('EXPANDED', ValueError),  # stretch is case-sensitive
476.     (100, 100),
477.     ('100', 100),
478.     (np.array(100), 100),
479.     # fractional fontweights are not defined. This should actually raise a
480.     # ValueError, but historically did not.
481.     (20.6, 20),
482.     ('20.6', ValueError),
483.     ([100], ValueError),
484. ])
485. def test_validate_fontstretch(stretch, parsed_stretch):
486.     if parsed_stretch is ValueError:
487.         with pytest.raises(ValueError):
488.             validate_fontstretch(stretch)
489.     else:
490.         assert validate_fontstretch(stretch) == parsed_stretch
491. 
492. 
493. def test_keymaps():
494.     key_list = [k for k in mpl.rcParams if 'keymap' in k]
495.     for k in key_list:
496.         assert isinstance(mpl.rcParams[k], list)
497. 
498. 
499. def test_rcparams_reset_after_fail():
500.     # There was previously a bug that meant that if rc_context failed and


File: lib/matplotlib/tests/test_rcparams.py
Line number range: 500 - 1000
Content:
500.     # There was previously a bug that meant that if rc_context failed and
501.     # raised an exception due to issues in the supplied rc parameters, the
502.     # global rc parameters were left in a modified state.
503.     with mpl.rc_context(rc={'text.usetex': False}):
504.         assert mpl.rcParams['text.usetex'] is False
505.         with pytest.raises(KeyError):
506.             with mpl.rc_context(rc={'text.usetex': True, 'test.blah': True}):
507.                 pass
508.         assert mpl.rcParams['text.usetex'] is False
509. 
510. 
511. @pytest.mark.skipif(sys.platform != "linux", reason="Linux only")
512. def test_backend_fallback_headless(tmpdir):
513.     env = {**os.environ,
514.            "DISPLAY": "", "WAYLAND_DISPLAY": "",
515.            "MPLBACKEND": "", "MPLCONFIGDIR": str(tmpdir)}
516.     with pytest.raises(subprocess.CalledProcessError):
517.         subprocess.run(
518.             [sys.executable, "-c",
519.              "import matplotlib;"
520.              "matplotlib.use('tkagg');"
521.              "import matplotlib.pyplot;"
522.              "matplotlib.pyplot.plot(42);"
523.              ],
524.             env=env, check=True, stderr=subprocess.DEVNULL)
525. 
526. 
527. @pytest.mark.skipif(
528.     sys.platform == "linux" and not _c_internal_utils.display_is_valid(),
529.     reason="headless")
530. def test_backend_fallback_headful(tmpdir):
531.     pytest.importorskip("tkinter")
532.     env = {**os.environ, "MPLBACKEND": "", "MPLCONFIGDIR": str(tmpdir)}
533.     backend = subprocess.check_output(
534.         [sys.executable, "-c",
535.          "import matplotlib as mpl; "
536.          "sentinel = mpl.rcsetup._auto_backend_sentinel; "
537.          # Check that access on another instance does not resolve the sentinel.
538.          "assert mpl.RcParams({'backend': sentinel})['backend'] == sentinel; "
539.          "assert dict.__getitem__(mpl.rcParams, 'backend') == sentinel; "
540.          "import matplotlib.pyplot; "
541.          "print(matplotlib.get_backend())"],
542.         env=env, universal_newlines=True)
543.     # The actual backend will depend on what's installed, but at least tkagg is
544.     # present.
545.     assert backend.strip().lower() != "agg"
546. 
547. 
548. def test_deprecation(monkeypatch):
549.     monkeypatch.setitem(
550.         mpl._deprecated_map, "patch.linewidth",
551.         ("0.0", "axes.linewidth", lambda old: 2 * old, lambda new: new / 2))
552.     with pytest.warns(_api.MatplotlibDeprecationWarning):
553.         assert mpl.rcParams["patch.linewidth"] \
554.             == mpl.rcParams["axes.linewidth"] / 2
555.     with pytest.warns(_api.MatplotlibDeprecationWarning):
556.         mpl.rcParams["patch.linewidth"] = 1
557.     assert mpl.rcParams["axes.linewidth"] == 2
558. 
559.     monkeypatch.setitem(
560.         mpl._deprecated_ignore_map, "patch.edgecolor",
561.         ("0.0", "axes.edgecolor"))
562.     with pytest.warns(_api.MatplotlibDeprecationWarning):
563.         assert mpl.rcParams["patch.edgecolor"] \
564.             == mpl.rcParams["axes.edgecolor"]
565.     with pytest.warns(_api.MatplotlibDeprecationWarning):
566.         mpl.rcParams["patch.edgecolor"] = "#abcd"
567.     assert mpl.rcParams["axes.edgecolor"] != "#abcd"
568. 
569.     monkeypatch.setitem(
570.         mpl._deprecated_ignore_map, "patch.force_edgecolor",
571.         ("0.0", None))
572.     with pytest.warns(_api.MatplotlibDeprecationWarning):
573.         assert mpl.rcParams["patch.force_edgecolor"] is None
574. 
575.     monkeypatch.setitem(
576.         mpl._deprecated_remain_as_none, "svg.hashsalt",
577.         ("0.0",))
578.     with pytest.warns(_api.MatplotlibDeprecationWarning):
579.         mpl.rcParams["svg.hashsalt"] = "foobar"
580.     assert mpl.rcParams["svg.hashsalt"] == "foobar"  # Doesn't warn.
581.     mpl.rcParams["svg.hashsalt"] = None  # Doesn't warn.
582. 
583.     mpl.rcParams.update(mpl.rcParams.copy())  # Doesn't warn.
584.     # Note that the warning suppression actually arises from the
585.     # iteration over the updater rcParams being protected by
586.     # suppress_matplotlib_deprecation_warning, rather than any explicit check.

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 20:32:06,155 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find 3 test cases that are relevant to a bug where figures are cleared from `Gcf.figs` when `get_backend()` is called after a figure is created in an `rc_context`. The provided context from `test_pyplot.py` and `test_rcparams.py` has tests for `rc_context` and figure management, but not their specific interaction leading to this bug. The bug's core issue is the lifecycle of `FigureManager` objects within the `Gcf` (Global Figure Manager). The base class for figure managers, `FigureManagerBase`, is defined in `lib/matplotlib/backend_bases.py`. Therefore, its corresponding test file, `lib/matplotlib/tests/test_backend_bases.py`, is the most likely place to find tests related to the lifecycle and management of figure managers, which is central to diagnosing and demonstrating the reported bug. This file has not been previously requested." query='Please provide the full content of `lib/matplotlib/tests/test_backend_bases.py`.' extra_requirements='' purpose='I need this file to find tests that cover the creation, registration, and destruction of figure managers, which will help identify test cases that are most similar to the reported bug concerning the global figure manager `Gcf`.'
2025-12-20 20:32:06,156 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `lib/matplotlib/tests/test_backend_bases.py`.
2025-12-20 20:32:06,156 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 20:32:06,157 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 20:32:06,157 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 20:32:06,157 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `lib/matplotlib/tests/test_backend_bases.py`.
Purpose: I need this file to find tests that cover the creation, registration, and destruction of figure managers, which will help identify test cases that are most similar to the reported bug concerning the global figure manager `Gcf`.
2025-12-20 20:32:08,602 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `lib/matplotlib/tests/test_backend_bases.py` to help you find test cases related to figure manager creation, registration, and destruction. This will assist in identifying tests relevant to the reported bug concerning the global figure manager, `Gcf`.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_backend_bases.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2149, 'candidates_token_count': 87, 'total_token_count': 2366, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2149}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 130, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09350348067009585, 'model_name': 'gemini-2.5-pro'} id='run--9795a769-506c-472f-87bd-7d45b93c9035-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_backend_bases.py'}, 'id': 'a36bc6ab-f21c-4cc7-8e18-9f6e3a304c39', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2149, 'output_tokens': 87, 'total_tokens': 2366, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 130}}
2025-12-20 20:32:11,694 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of `lib/matplotlib/tests/test_backend_bases.py` as you requested. This file's contents will be instrumental in finding test cases that cover the creation, registration, and destruction of figure managers. You can now use this code to identify tests analogous to the bug involving the global figure manager, `Gcf`." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8410, 'candidates_token_count': 74, 'total_token_count': 8669, 'cached_content_token_count': 1831, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8410}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1831}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 74}], 'thoughts_token_count': 185}, 'finish_reason': 'STOP', 'avg_logprobs': -0.31903522079055374, 'model_name': 'gemini-2.5-pro'} id='run--39c3de41-d900-451b-be0d-bc2fcca9f4a1-0' usage_metadata={'input_tokens': 8410, 'output_tokens': 74, 'total_tokens': 8669, 'input_token_details': {'cache_read': 1831}, 'output_token_details': {'reasoning': 185}}
2025-12-20 20:32:11,696 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `lib/matplotlib/tests/test_backend_bases.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need this file to find tests that cover the creation, registration, and destruction of figure managers, which will help identify test cases that are most similar to the reported bug concerning the global figure manager `Gcf`.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_backend_bases.py
Line number range: 1 - 341
Content:
1. import re
2. 
3. from matplotlib import path, transforms
4. from matplotlib.backend_bases import (
5.     FigureCanvasBase, LocationEvent, MouseButton, MouseEvent,
6.     NavigationToolbar2, RendererBase)
7. from matplotlib.figure import Figure
8. from matplotlib.testing._markers import needs_pgf_xelatex
9. import matplotlib.pyplot as plt
10. 
11. import numpy as np
12. import pytest
13. 
14. 
15. def test_uses_per_path():
16.     id = transforms.Affine2D()
17.     paths = [path.Path.unit_regular_polygon(i) for i in range(3, 7)]
18.     tforms_matrices = [id.rotate(i).get_matrix().copy() for i in range(1, 5)]
19.     offsets = np.arange(20).reshape((10, 2))
20.     facecolors = ['red', 'green']
21.     edgecolors = ['red', 'green']
22. 
23.     def check(master_transform, paths, all_transforms,
24.               offsets, facecolors, edgecolors):
25.         rb = RendererBase()
26.         raw_paths = list(rb._iter_collection_raw_paths(
27.             master_transform, paths, all_transforms))
28.         gc = rb.new_gc()
29.         ids = [path_id for xo, yo, path_id, gc0, rgbFace in
30.                rb._iter_collection(
31.                    gc, master_transform, all_transforms,
32.                    range(len(raw_paths)), offsets,
33.                    transforms.AffineDeltaTransform(master_transform),
34.                    facecolors, edgecolors, [], [], [False],
35.                    [], 'screen')]
36.         uses = rb._iter_collection_uses_per_path(
37.             paths, all_transforms, offsets, facecolors, edgecolors)
38.         if raw_paths:
39.             seen = np.bincount(ids, minlength=len(raw_paths))
40.             assert set(seen).issubset([uses - 1, uses])
41. 
42.     check(id, paths, tforms_matrices, offsets, facecolors, edgecolors)
43.     check(id, paths[0:1], tforms_matrices, offsets, facecolors, edgecolors)
44.     check(id, [], tforms_matrices, offsets, facecolors, edgecolors)
45.     check(id, paths, tforms_matrices[0:1], offsets, facecolors, edgecolors)
46.     check(id, paths, [], offsets, facecolors, edgecolors)
47.     for n in range(0, offsets.shape[0]):
48.         check(id, paths, tforms_matrices, offsets[0:n, :],
49.               facecolors, edgecolors)
50.     check(id, paths, tforms_matrices, offsets, [], edgecolors)
51.     check(id, paths, tforms_matrices, offsets, facecolors, [])
52.     check(id, paths, tforms_matrices, offsets, [], [])
53.     check(id, paths, tforms_matrices, offsets, facecolors[0:1], edgecolors)
54. 
55. 
56. def test_canvas_ctor():
57.     assert isinstance(FigureCanvasBase().figure, Figure)
58. 
59. 
60. def test_get_default_filename():
61.     assert plt.figure().canvas.get_default_filename() == 'image.png'
62. 
63. 
64. def test_canvas_change():
65.     fig = plt.figure()
66.     # Replaces fig.canvas
67.     canvas = FigureCanvasBase(fig)
68.     # Should still work.
69.     plt.close(fig)
70.     assert not plt.fignum_exists(fig.number)
71. 
72. 
73. @pytest.mark.backend('pdf')
74. def test_non_gui_warning(monkeypatch):
75.     plt.subplots()
76. 
77.     monkeypatch.setenv("DISPLAY", ":999")
78. 
79.     with pytest.warns(UserWarning) as rec:
80.         plt.show()
81.         assert len(rec) == 1
82.         assert ('Matplotlib is currently using pdf, which is a non-GUI backend'
83.                 in str(rec[0].message))
84. 
85.     with pytest.warns(UserWarning) as rec:
86.         plt.gcf().show()
87.         assert len(rec) == 1
88.         assert ('Matplotlib is currently using pdf, which is a non-GUI backend'
89.                 in str(rec[0].message))
90. 
91. 
92. @pytest.mark.parametrize(
93.     "x, y", [(42, 24), (None, 42), (None, None), (200, 100.01), (205.75, 2.0)])
94. def test_location_event_position(x, y):
95.     # LocationEvent should cast its x and y arguments to int unless it is None.
96.     fig, ax = plt.subplots()
97.     canvas = FigureCanvasBase(fig)
98.     event = LocationEvent("test_event", canvas, x, y)
99.     if x is None:
100.         assert event.x is None
101.     else:
102.         assert event.x == int(x)
103.         assert isinstance(event.x, int)
104.     if y is None:
105.         assert event.y is None
106.     else:
107.         assert event.y == int(y)
108.         assert isinstance(event.y, int)
109.     if x is not None and y is not None:
110.         assert re.match(
111.             "x={} +y={}".format(ax.format_xdata(x), ax.format_ydata(y)),
112.             ax.format_coord(x, y))
113.         ax.fmt_xdata = ax.fmt_ydata = lambda x: "foo"
114.         assert re.match("x=foo +y=foo", ax.format_coord(x, y))
115. 
116. 
117. def test_pick():
118.     fig = plt.figure()
119.     fig.text(.5, .5, "hello", ha="center", va="center", picker=True)
120.     fig.canvas.draw()
121.     picks = []
122.     fig.canvas.mpl_connect("pick_event", lambda event: picks.append(event))
123.     start_event = MouseEvent(
124.         "button_press_event", fig.canvas, *fig.transFigure.transform((.5, .5)),
125.         MouseButton.LEFT)
126.     fig.canvas.callbacks.process(start_event.name, start_event)
127.     assert len(picks) == 1
128. 
129. 
130. def test_interactive_zoom():
131.     fig, ax = plt.subplots()
132.     ax.set(xscale="logit")
133.     assert ax.get_navigate_mode() is None
134. 
135.     tb = NavigationToolbar2(fig.canvas)
136.     tb.zoom()
137.     assert ax.get_navigate_mode() == 'ZOOM'
138. 
139.     xlim0 = ax.get_xlim()
140.     ylim0 = ax.get_ylim()
141. 
142.     # Zoom from x=1e-6, y=0.1 to x=1-1e-5, 0.8 (data coordinates, "d").
143.     d0 = (1e-6, 0.1)
144.     d1 = (1-1e-5, 0.8)
145.     # Convert to screen coordinates ("s").  Events are defined only with pixel
146.     # precision, so round the pixel values, and below, check against the
147.     # corresponding xdata/ydata, which are close but not equal to d0/d1.
148.     s0 = ax.transData.transform(d0).astype(int)
149.     s1 = ax.transData.transform(d1).astype(int)
150. 
151.     # Zoom in.
152.     start_event = MouseEvent(
153.         "button_press_event", fig.canvas, *s0, MouseButton.LEFT)
154.     fig.canvas.callbacks.process(start_event.name, start_event)
155.     stop_event = MouseEvent(
156.         "button_release_event", fig.canvas, *s1, MouseButton.LEFT)
157.     fig.canvas.callbacks.process(stop_event.name, stop_event)
158.     assert ax.get_xlim() == (start_event.xdata, stop_event.xdata)
159.     assert ax.get_ylim() == (start_event.ydata, stop_event.ydata)
160. 
161.     # Zoom out.
162.     start_event = MouseEvent(
163.         "button_press_event", fig.canvas, *s1, MouseButton.RIGHT)
164.     fig.canvas.callbacks.process(start_event.name, start_event)
165.     stop_event = MouseEvent(
166.         "button_release_event", fig.canvas, *s0, MouseButton.RIGHT)
167.     fig.canvas.callbacks.process(stop_event.name, stop_event)
168.     # Absolute tolerance much less than original xmin (1e-7).
169.     assert ax.get_xlim() == pytest.approx(xlim0, rel=0, abs=1e-10)
170.     assert ax.get_ylim() == pytest.approx(ylim0, rel=0, abs=1e-10)
171. 
172.     tb.zoom()
173.     assert ax.get_navigate_mode() is None
174. 
175.     assert not ax.get_autoscalex_on() and not ax.get_autoscaley_on()
176. 
177. 
178. @pytest.mark.parametrize("plot_func", ["imshow", "contourf"])
179. @pytest.mark.parametrize("orientation", ["vertical", "horizontal"])
180. @pytest.mark.parametrize("tool,button,expected",
181.                          [("zoom", MouseButton.LEFT, (4, 6)),  # zoom in
182.                           ("zoom", MouseButton.RIGHT, (-20, 30)),  # zoom out
183.                           ("pan", MouseButton.LEFT, (-2, 8)),
184.                           ("pan", MouseButton.RIGHT, (1.47, 7.78))])  # zoom
185. def test_interactive_colorbar(plot_func, orientation, tool, button, expected):
186.     fig, ax = plt.subplots()
187.     data = np.arange(12).reshape((4, 3))
188.     vmin0, vmax0 = 0, 10
189.     coll = getattr(ax, plot_func)(data, vmin=vmin0, vmax=vmax0)
190. 
191.     cb = fig.colorbar(coll, ax=ax, orientation=orientation)
192.     if plot_func == "contourf":
193.         # Just determine we can't navigate and exit out of the test
194.         assert not cb.ax.get_navigate()
195.         return
196. 
197.     assert cb.ax.get_navigate()
198. 
199.     # Mouse from 4 to 6 (data coordinates, "d").
200.     vmin, vmax = 4, 6
201.     # The y coordinate doesn't matter, it just needs to be between 0 and 1
202.     # However, we will set d0/d1 to the same y coordinate to test that small
203.     # pixel changes in that coordinate doesn't cancel the zoom like a normal
204.     # axes would.
205.     d0 = (vmin, 0.5)
206.     d1 = (vmax, 0.5)
207.     # Swap them if the orientation is vertical
208.     if orientation == "vertical":
209.         d0 = d0[::-1]
210.         d1 = d1[::-1]
211.     # Convert to screen coordinates ("s").  Events are defined only with pixel
212.     # precision, so round the pixel values, and below, check against the
213.     # corresponding xdata/ydata, which are close but not equal to d0/d1.
214.     s0 = cb.ax.transData.transform(d0).astype(int)
215.     s1 = cb.ax.transData.transform(d1).astype(int)
216. 
217.     # Set up the mouse movements
218.     start_event = MouseEvent(
219.         "button_press_event", fig.canvas, *s0, button)
220.     stop_event = MouseEvent(
221.         "button_release_event", fig.canvas, *s1, button)
222. 
223.     tb = NavigationToolbar2(fig.canvas)
224.     if tool == "zoom":
225.         tb.zoom()
226.         tb.press_zoom(start_event)
227.         tb.drag_zoom(stop_event)
228.         tb.release_zoom(stop_event)
229.     else:
230.         tb.pan()
231.         tb.press_pan(start_event)
232.         tb.drag_pan(stop_event)
233.         tb.release_pan(stop_event)
234. 
235.     # Should be close, but won't be exact due to screen integer resolution
236.     assert (cb.vmin, cb.vmax) == pytest.approx(expected, abs=0.15)
237. 
238. 
239. def test_toolbar_zoompan():
240.     expected_warning_regex = (
241.         r"Treat the new Tool classes introduced in "
242.         r"v[0-9]*.[0-9]* as experimental for now; "
243.         "the API and rcParam may change in future versions.")
244.     with pytest.warns(UserWarning, match=expected_warning_regex):
245.         plt.rcParams['toolbar'] = 'toolmanager'
246.     ax = plt.gca()
247.     assert ax.get_navigate_mode() is None
248.     ax.figure.canvas.manager.toolmanager.trigger_tool('zoom')
249.     assert ax.get_navigate_mode() == "ZOOM"
250.     ax.figure.canvas.manager.toolmanager.trigger_tool('pan')
251.     assert ax.get_navigate_mode() == "PAN"
252. 
253. 
254. @pytest.mark.parametrize(
255.     "backend", ['svg', 'ps', 'pdf',
256.                 pytest.param('pgf', marks=needs_pgf_xelatex)]
257. )
258. def test_draw(backend):
259.     from matplotlib.figure import Figure
260.     from matplotlib.backends.backend_agg import FigureCanvas
261.     test_backend = pytest.importorskip(
262.         f'matplotlib.backends.backend_{backend}'
263.     )
264.     TestCanvas = test_backend.FigureCanvas
265.     fig_test = Figure(constrained_layout=True)
266.     TestCanvas(fig_test)
267.     axes_test = fig_test.subplots(2, 2)
268. 
269.     # defaults to FigureCanvasBase
270.     fig_agg = Figure(constrained_layout=True)
271.     # put a backends.backend_agg.FigureCanvas on it
272.     FigureCanvas(fig_agg)
273.     axes_agg = fig_agg.subplots(2, 2)
274. 
275.     init_pos = [ax.get_position() for ax in axes_test.ravel()]
276. 
277.     fig_test.canvas.draw()
278.     fig_agg.canvas.draw()
279. 
280.     layed_out_pos_test = [ax.get_position() for ax in axes_test.ravel()]
281.     layed_out_pos_agg = [ax.get_position() for ax in axes_agg.ravel()]
282. 
283.     for init, placed in zip(init_pos, layed_out_pos_test):
284.         assert not np.allclose(init, placed, atol=0.005)
285. 
286.     for ref, test in zip(layed_out_pos_agg, layed_out_pos_test):
287.         np.testing.assert_allclose(ref, test, atol=0.005)
288. 
289. 
290. @pytest.mark.parametrize(
291.     "key,mouseend,expectedxlim,expectedylim",
292.     [(None, (0.2, 0.2), (3.49, 12.49), (2.7, 11.7)),
293.      (None, (0.2, 0.5), (3.49, 12.49), (0, 9)),
294.      (None, (0.5, 0.2), (0, 9), (2.7, 11.7)),
295.      (None, (0.5, 0.5), (0, 9), (0, 9)),  # No move
296.      (None, (0.8, 0.25), (-3.47, 5.53), (2.25, 11.25)),
297.      (None, (0.2, 0.25), (3.49, 12.49), (2.25, 11.25)),
298.      (None, (0.8, 0.85), (-3.47, 5.53), (-3.14, 5.86)),
299.      (None, (0.2, 0.85), (3.49, 12.49), (-3.14, 5.86)),
300.      ("shift", (0.2, 0.4), (3.49, 12.49), (0, 9)),  # snap to x
301.      ("shift", (0.4, 0.2), (0, 9), (2.7, 11.7)),  # snap to y
302.      ("shift", (0.2, 0.25), (3.49, 12.49), (3.49, 12.49)),  # snap to diagonal
303.      ("shift", (0.8, 0.25), (-3.47, 5.53), (3.47, 12.47)),  # snap to diagonal
304.      ("shift", (0.8, 0.9), (-3.58, 5.41), (-3.58, 5.41)),  # snap to diagonal
305.      ("shift", (0.2, 0.85), (3.49, 12.49), (-3.49, 5.51)),  # snap to diagonal
306.      ("x", (0.2, 0.1), (3.49, 12.49), (0, 9)),  # only x
307.      ("y", (0.1, 0.2), (0, 9), (2.7, 11.7)),  # only y
308.      ("control", (0.2, 0.2), (3.49, 12.49), (3.49, 12.49)),  # diagonal
309.      ("control", (0.4, 0.2), (2.72, 11.72), (2.72, 11.72)),  # diagonal
310.      ])
311. def test_interactive_pan(key, mouseend, expectedxlim, expectedylim):
312.     fig, ax = plt.subplots()
313.     ax.plot(np.arange(10))
314.     assert ax.get_navigate()
315.     # Set equal aspect ratio to easier see diagonal snap
316.     ax.set_aspect('equal')
317. 
318.     # Mouse move starts from 0.5, 0.5
319.     mousestart = (0.5, 0.5)
320.     # Convert to screen coordinates ("s").  Events are defined only with pixel
321.     # precision, so round the pixel values, and below, check against the
322.     # corresponding xdata/ydata, which are close but not equal to d0/d1.
323.     sstart = ax.transData.transform(mousestart).astype(int)
324.     send = ax.transData.transform(mouseend).astype(int)
325. 
326.     # Set up the mouse movements
327.     start_event = MouseEvent(
328.         "button_press_event", fig.canvas, *sstart, button=MouseButton.LEFT,
329.         key=key)
330.     stop_event = MouseEvent(
331.         "button_release_event", fig.canvas, *send, button=MouseButton.LEFT,
332.         key=key)
333. 
334.     tb = NavigationToolbar2(fig.canvas)
335.     tb.pan()
336.     tb.press_pan(start_event)
337.     tb.drag_pan(stop_event)
338.     tb.release_pan(stop_event)
339.     # Should be close, but won't be exact due to screen integer resolution
340.     assert tuple(ax.get_xlim()) == pytest.approx(expectedxlim, abs=0.02)
341.     assert tuple(ax.get_ylim()) == pytest.approx(expectedylim, abs=0.02)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 20:32:15,821 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file `lib/matplotlib/tests/test_backend_bases.py`.\n\n2. Extended relevance:\n   - The provided context contains the entire content of the requested file, from line 1 to line 341. To fulfill the user's request, the entire file must be returned.", relative_path='lib/matplotlib/tests/test_backend_bases.py', start_line=1, end_line=341)]
2025-12-20 20:32:15,822 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `lib/matplotlib/tests/test_backend_bases.py`.
2025-12-20 20:32:15,822 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 20:32:15,822 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 20:32:15,823 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 4 existing contexts
2025-12-20 20:32:15,823 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 5 total contexts (removed 0 duplicates)
2025-12-20 20:32:15,823 - thread-132860830811840.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-20 20:32:15,824 - thread-132860830811840.prometheus_context_collector - INFO - Successfully retrieved 5 context snippets
