2025-12-24 01:49:30,095 - thread-125239516182208.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: diophantine: incomplete results depending on syms order with permute=True

Description: ```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```

diophantine: incomplete results depending on syms order with permute=True
```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```


Patch information:
diff --git a/sympy/solvers/diophantine.py b/sympy/solvers/diophantine.py
index 6092e35dab..17b7af56ce 100644
--- a/sympy/solvers/diophantine.py
+++ b/sympy/solvers/diophantine.py
@@ -180,9 +180,11 @@ def diophantine(eq, param=symbols("t", integer=True), syms=None,
                     'syms should be given as a sequence, e.g. a list')
             syms = [i for i in syms if i in var]
             if syms != var:
-                dict_sym_index = dict(zip(syms, range(len(syms))))
-                return {tuple([t[dict_sym_index[i]] for i in var])
-                            for t in diophantine(eq, param)}
+                # build mapping from var symbol to its index in the base solution
+                dict_var_index = dict(zip(var, range(len(var))))
+                # compute solutions with the requested permute setting and reorder to match syms
+                return {tuple([t[dict_var_index[s]] for s in syms])
+                            for t in diophantine(eq, param, permute=permute)}
         n, d = eq.as_numer_denom()
         if n.is_number:
             return set()


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-24 01:49:30,169 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── documentation-style-guide.rst
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_pyutils.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: diophantine: incomplete results depending on syms order with permute=True

Description: ```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```

diophantine: incomplete results depending on syms order with permute=True
```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```


Patch information:
diff --git a/sympy/solvers/diophantine.py b/sympy/solvers/diophantine.py
index 6092e35dab..17b7af56ce 100644
--- a/sympy/solvers/diophantine.py
+++ b/sympy/solvers/diophantine.py
@@ -180,9 +180,11 @@ def diophantine(eq, param=symbols("t", integer=True), syms=None,
                     'syms should be given as a sequence, e.g. a list')
             syms = [i for i in syms if i in var]
             if syms != var:
-                dict_sym_index = dict(zip(syms, range(len(syms))))
-                return {tuple([t[dict_sym_index[i]] for i in var])
-                            for t in diophantine(eq, param)}
+                # build mapping from var symbol to its index in the base solution
+                dict_var_index = dict(zip(var, range(len(var))))
+                # compute solutions with the requested permute setting and reorder to match syms
+                return {tuple([t[dict_var_index[s]] for s in syms])
+                            for t in diophantine(eq, param, permute=permute)}
         n, d = eq.as_numer_denom()
         if n.is_number:
             return set()


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 01:49:37,853 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user is asking for test cases related to a bug in the `diophantine` function. The bug report indicates an issue with the `syms` and `permute` parameters. The most relevant information to find suitable test cases would be the test file for the `diophantine` solver itself, which, based on the file structure, is `sympy/solvers/tests/test_diophantine.py`. I need the content of this file to analyze existing tests and find the ones that are most relevant to the described bug.' query='Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.' extra_requirements='' purpose='I need to find 3 relevant existing test cases that demonstrate similar functionality to the reported bug in the diophantine function.'
2025-12-24 01:49:37,854 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.
2025-12-24 01:49:37,855 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 01:49:37,855 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 01:49:37,856 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 01:49:37,856 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.
Purpose: I need to find 3 relevant existing test cases that demonstrate similar functionality to the reported bug in the diophantine function.
2025-12-24 01:49:40,924 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will read the full content of the file `sympy/solvers/tests/test_diophantine.py` to help you find relevant test cases.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/solvers/tests/test_diophantine.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2110, 'candidates_token_count': 61, 'total_token_count': 2380, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2110}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 61}], 'thoughts_token_count': 209, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1291405333847296, 'model_name': 'gemini-2.5-pro'} id='run--671540ed-b633-4f2b-84f5-3586aab5df12-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/solvers/tests/test_diophantine.py'}, 'id': 'f34aca26-d61d-4225-b677-6157f9f36c42', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2110, 'output_tokens': 61, 'total_tokens': 2380, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 209}}
2025-12-24 01:49:52,280 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the `test_diophantine.py` file. After reviewing the test cases, I have identified three relevant examples that demonstrate the functionality related to the reported bug in the `diophantine` function. These test cases include specific issue regressions and a test for a problematic parametric representation, which will be helpful for your investigation.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1738, 'end_index': 2919, 'uri': 'https://github.com/MaeZhao/GBS-Subgraph-Simulation', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 14668, 'candidates_token_count': 74, 'total_token_count': 15926, 'cached_content_token_count': 1924, 'prompt_tokens_details': [{'modality': 1, 'token_count': 14668}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1924}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 74}], 'thoughts_token_count': 1184}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9623779090675147, 'model_name': 'gemini-2.5-pro'} id='run--323ce76b-3920-4969-9d5a-f5bd3785341f-0' usage_metadata={'input_tokens': 14668, 'output_tokens': 74, 'total_tokens': 15926, 'input_token_details': {'cache_read': 1924}, 'output_token_details': {'reasoning': 1184}}
2025-12-24 01:49:52,282 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find 3 relevant existing test cases that demonstrate similar functionality to the reported bug in the diophantine function.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/solvers/tests/test_diophantine.py
Line number range: 1 - 500
Content:
1. from sympy import (Add, Matrix, Mul, S, symbols, Eq, pi, factorint, oo,
2.                    powsimp, Rational)
3. from sympy.core.function import _mexpand
4. from sympy.core.compatibility import range, ordered
5. from sympy.functions.elementary.trigonometric import sin
6. from sympy.solvers.diophantine import (descent, diop_bf_DN, diop_DN,
7.     diop_solve, diophantine, divisible, equivalent, find_DN, ldescent, length,
8.     reconstruct, partition, power_representation,
9.     prime_as_sum_of_two_squares, square_factor, sum_of_four_squares,
10.     sum_of_three_squares, transformation_to_DN, transformation_to_normal,
11.     classify_diop, base_solution_linear, cornacchia, sqf_normal,
12.     diop_ternary_quadratic_normal, _diop_ternary_quadratic_normal,
13.     gaussian_reduce, holzer,diop_general_pythagorean,
14.     _diop_general_sum_of_squares, _nint_or_floor, _odd, _even,
15.     _remove_gcd, check_param, parametrize_ternary_quadratic,
16.     diop_ternary_quadratic, diop_linear, diop_quadratic,
17.     diop_general_sum_of_squares, sum_of_powers, sum_of_squares,
18.     diop_general_sum_of_even_powers, _can_do_sum_of_squares)
19. from sympy.utilities import default_sort_key
20. 
21. from sympy.utilities.pytest import slow, raises, XFAIL
22. from sympy.utilities.iterables import (
23.         signed_permutations)
24. 
25. a, b, c, d, p, q, x, y, z, w, t, u, v, X, Y, Z = symbols(
26.     "a, b, c, d, p, q, x, y, z, w, t, u, v, X, Y, Z", integer=True)
27. t_0, t_1, t_2, t_3, t_4, t_5, t_6 = symbols("t_:7", integer=True)
28. m1, m2, m3 = symbols('m1:4', integer=True)
29. n1 = symbols('n1', integer=True)
30. 
31. 
32. def diop_simplify(eq):
33.     return _mexpand(powsimp(_mexpand(eq)))
34. 
35. 
36. def test_input_format():
37.     raises(TypeError, lambda: diophantine(sin(x)))
38.     raises(TypeError, lambda: diophantine(3))
39.     raises(TypeError, lambda: diophantine(x/pi - 3))
40. 
41. 
42. def test_univariate():
43.     assert diop_solve((x - 1)*(x - 2)**2) == set([(1,), (2,)])
44.     assert diop_solve((x - 1)*(x - 2)) == set([(1,), (2,)])
45. 
46. 
47. def test_classify_diop():
48.     raises(TypeError, lambda: classify_diop(x**2/3 - 1))
49.     raises(ValueError, lambda: classify_diop(1))
50.     raises(NotImplementedError, lambda: classify_diop(w*x*y*z - 1))
51.     raises(NotImplementedError, lambda: classify_diop(x**3 + y**3 + z**4 - 90))
52.     assert classify_diop(14*x**2 + 15*x - 42) == (
53.         [x], {1: -42, x: 15, x**2: 14}, 'univariate')
54.     assert classify_diop(x*y + z) == (
55.         [x, y, z], {x*y: 1, z: 1}, 'inhomogeneous_ternary_quadratic')
56.     assert classify_diop(x*y + z + w + x**2) == (
57.         [w, x, y, z], {x*y: 1, w: 1, x**2: 1, z: 1}, 'inhomogeneous_general_quadratic')
58.     assert classify_diop(x*y + x*z + x**2 + 1) == (
59.         [x, y, z], {x*y: 1, x*z: 1, x**2: 1, 1: 1}, 'inhomogeneous_general_quadratic')
60.     assert classify_diop(x*y + z + w + 42) == (
61.         [w, x, y, z], {x*y: 1, w: 1, 1: 42, z: 1}, 'inhomogeneous_general_quadratic')
62.     assert classify_diop(x*y + z*w) == (
63.         [w, x, y, z], {x*y: 1, w*z: 1}, 'homogeneous_general_quadratic')
64.     assert classify_diop(x*y**2 + 1) == (
65.         [x, y], {x*y**2: 1, 1: 1}, 'cubic_thue')
66.     assert classify_diop(x**4 + y**4 + z**4 - (1 + 16 + 81)) == (
67.         [x, y, z], {1: -98, x**4: 1, z**4: 1, y**4: 1}, 'general_sum_of_even_powers')
68. 
69. 
70. def test_linear():
71.     assert diop_solve(x) == (0,)
72.     assert diop_solve(1*x) == (0,)
73.     assert diop_solve(3*x) == (0,)
74.     assert diop_solve(x + 1) == (-1,)
75.     assert diop_solve(2*x + 1) == (None,)
76.     assert diop_solve(2*x + 4) == (-2,)
77.     assert diop_solve(y + x) == (t_0, -t_0)
78.     assert diop_solve(y + x + 0) == (t_0, -t_0)
79.     assert diop_solve(y + x - 0) == (t_0, -t_0)
80.     assert diop_solve(0*x - y - 5) == (-5,)
81.     assert diop_solve(3*y + 2*x - 5) == (3*t_0 - 5, -2*t_0 + 5)
82.     assert diop_solve(2*x - 3*y - 5) == (3*t_0 - 5, 2*t_0 - 5)
83.     assert diop_solve(-2*x - 3*y - 5) == (3*t_0 + 5, -2*t_0 - 5)
84.     assert diop_solve(7*x + 5*y) == (5*t_0, -7*t_0)
85.     assert diop_solve(2*x + 4*y) == (2*t_0, -t_0)
86.     assert diop_solve(4*x + 6*y - 4) == (3*t_0 - 2, -2*t_0 + 2)
87.     assert diop_solve(4*x + 6*y - 3) == (None, None)
88.     assert diop_solve(0*x + 3*y - 4*z + 5) == (4*t_0 + 5, 3*t_0 + 5)
89.     assert diop_solve(4*x + 3*y - 4*z + 5) == (t_0, 8*t_0 + 4*t_1 + 5, 7*t_0 + 3*t_1 + 5)
90.     assert diop_solve(4*x + 3*y - 4*z + 5, None) == (0, 5, 5)
91.     assert diop_solve(4*x + 2*y + 8*z - 5) == (None, None, None)
92.     assert diop_solve(5*x + 7*y - 2*z - 6) == (t_0, -3*t_0 + 2*t_1 + 6, -8*t_0 + 7*t_1 + 18)
93.     assert diop_solve(3*x - 6*y + 12*z - 9) == (2*t_0 + 3, t_0 + 2*t_1, t_1)
94.     assert diop_solve(6*w + 9*x + 20*y - z) == (t_0, t_1, t_1 + t_2, 6*t_0 + 29*t_1 + 20*t_2)
95. 
96.     # to ignore constant factors, use diophantine
97.     raises(TypeError, lambda: diop_solve(x/2))
98. 
99. 
100. def test_quadratic_simple_hyperbolic_case():
101.     # Simple Hyperbolic case: A = C = 0 and B != 0
102.     assert diop_solve(3*x*y + 34*x - 12*y + 1) == \
103.         set([(-133, -11), (5, -57)])
104.     assert diop_solve(6*x*y + 2*x + 3*y + 1) == set([])
105.     assert diop_solve(-13*x*y + 2*x - 4*y - 54) == set([(27, 0)])
106.     assert diop_solve(-27*x*y - 30*x - 12*y - 54) == set([(-14, -1)])
107.     assert diop_solve(2*x*y + 5*x + 56*y + 7) == set([(-161, -3),\
108.         (-47,-6), (-35, -12), (-29, -69),\
109.         (-27, 64), (-21, 7),(-9, 1),\
110.         (105, -2)])
111.     assert diop_solve(6*x*y + 9*x + 2*y + 3) == set([])
112.     assert diop_solve(x*y + x + y + 1) == set([(-1, t), (t, -1)])
113.     assert diophantine(48*x*y)
114. 
115. 
116. def test_quadratic_elliptical_case():
117.     # Elliptical case: B**2 - 4AC < 0
118.     # Two test cases highlighted require lot of memory due to quadratic_congruence() method.
119.     # This above method should be replaced by Pernici's square_mod() method when his PR gets merged.
120. 
121.     #assert diop_solve(42*x**2 + 8*x*y + 15*y**2 + 23*x + 17*y - 4915) == set([(-11, -1)])
122.     assert diop_solve(4*x**2 + 3*y**2 + 5*x - 11*y + 12) == set([])
123.     assert diop_solve(x**2 + y**2 + 2*x + 2*y + 2) == set([(-1, -1)])
124.     #assert diop_solve(15*x**2 - 9*x*y + 14*y**2 - 23*x - 14*y - 4950) == set([(-15, 6)])
125.     assert diop_solve(10*x**2 + 12*x*y + 12*y**2 - 34) == \
126.         set([(-1, -1), (-1, 2), (1, -2), (1, 1)])
127. 
128. 
129. def test_quadratic_parabolic_case():
130.     # Parabolic case: B**2 - 4AC = 0
131.     assert check_solutions(8*x**2 - 24*x*y + 18*y**2 + 5*x + 7*y + 16)
132.     assert check_solutions(8*x**2 - 24*x*y + 18*y**2 + 6*x + 12*y - 6)
133.     assert check_solutions(8*x**2 + 24*x*y + 18*y**2 + 4*x + 6*y - 7)
134.     assert check_solutions(-4*x**2 + 4*x*y - y**2 + 2*x - 3)
135.     assert check_solutions(x**2 + 2*x*y + y**2 + 2*x + 2*y + 1)
136.     assert check_solutions(x**2 - 2*x*y + y**2 + 2*x + 2*y + 1)
137.     assert check_solutions(y**2 - 41*x + 40)
138. 
139. 
140. def test_quadratic_perfect_square():
141.     # B**2 - 4*A*C > 0
142.     # B**2 - 4*A*C is a perfect square
143.     assert check_solutions(48*x*y)
144.     assert check_solutions(4*x**2 - 5*x*y + y**2 + 2)
145.     assert check_solutions(-2*x**2 - 3*x*y + 2*y**2 -2*x - 17*y + 25)
146.     assert check_solutions(12*x**2 + 13*x*y + 3*y**2 - 2*x + 3*y - 12)
147.     assert check_solutions(8*x**2 + 10*x*y + 2*y**2 - 32*x - 13*y - 23)
148.     assert check_solutions(4*x**2 - 4*x*y - 3*y- 8*x - 3)
149.     assert check_solutions(- 4*x*y - 4*y**2 - 3*y- 5*x - 10)
150.     assert check_solutions(x**2 - y**2 - 2*x - 2*y)
151.     assert check_solutions(x**2 - 9*y**2 - 2*x - 6*y)
152.     assert check_solutions(4*x**2 - 9*y**2 - 4*x - 12*y - 3)
153. 
154. 
155. def test_quadratic_non_perfect_square():
156.     # B**2 - 4*A*C is not a perfect square
157.     # Used check_solutions() since the solutions are complex expressions involving
158.     # square roots and exponents
159.     assert check_solutions(x**2 - 2*x - 5*y**2)
160.     assert check_solutions(3*x**2 - 2*y**2 - 2*x - 2*y)
161.     assert check_solutions(x**2 - x*y - y**2 - 3*y)
162.     assert check_solutions(x**2 - 9*y**2 - 2*x - 6*y)
163. 
164. 
165. def test_issue_9106():
166.     eq = -48 - 2*x*(3*x - 1) + y*(3*y - 1)
167.     v = (x, y)
168.     for sol in diophantine(eq):
169.         assert not diop_simplify(eq.xreplace(dict(zip(v, sol))))
170. 
171. 
172. def test_issue_18138():
173.     eq = x**2 - x - y**2
174.     v = (x, y)
175.     for sol in diophantine(eq):
176.         assert not diop_simplify(eq.xreplace(dict(zip(v, sol))))
177. 
178. 
179. @slow
180. def test_quadratic_non_perfect_slow():
181.     assert check_solutions(8*x**2 + 10*x*y - 2*y**2 - 32*x - 13*y - 23)
182.     # This leads to very large numbers.
183.     # assert check_solutions(5*x**2 - 13*x*y + y**2 - 4*x - 4*y - 15)
184.     assert check_solutions(-3*x**2 - 2*x*y + 7*y**2 - 5*x - 7)
185.     assert check_solutions(-4 - x + 4*x**2 - y - 3*x*y - 4*y**2)
186.     assert check_solutions(1 + 2*x + 2*x**2 + 2*y + x*y - 2*y**2)
187. 
188. 
189. def test_DN():
190.     # Most of the test cases were adapted from,
191.     # Solving the generalized Pell equation x**2 - D*y**2 = N, John P. Robertson, July 31, 2004.
192.     # http://www.jpr2718.org/pell.pdf
193.     # others are verified using Wolfram Alpha.
194. 
195.     # Covers cases where D <= 0 or D > 0 and D is a square or N = 0
196.     # Solutions are straightforward in these cases.
197.     assert diop_DN(3, 0) == [(0, 0)]
198.     assert diop_DN(-17, -5) == []
199.     assert diop_DN(-19, 23) == [(2, 1)]
200.     assert diop_DN(-13, 17) == [(2, 1)]
201.     assert diop_DN(-15, 13) == []
202.     assert diop_DN(0, 5) == []
203.     assert diop_DN(0, 9) == [(3, t)]
204.     assert diop_DN(9, 0) == [(3*t, t)]
205.     assert diop_DN(16, 24) == []
206.     assert diop_DN(9, 180) == [(18, 4)]
207.     assert diop_DN(9, -180) == [(12, 6)]
208.     assert diop_DN(7, 0) == [(0, 0)]
209. 
210.     # When equation is x**2 + y**2 = N
211.     # Solutions are interchangeable
212.     assert diop_DN(-1, 5) == [(2, 1), (1, 2)]
213.     assert diop_DN(-1, 169) == [(12, 5), (5, 12), (13, 0), (0, 13)]
214. 
215.     # D > 0 and D is not a square
216. 
217.     # N = 1
218.     assert diop_DN(13, 1) == [(649, 180)]
219.     assert diop_DN(980, 1) == [(51841, 1656)]
220.     assert diop_DN(981, 1) == [(158070671986249, 5046808151700)]
221.     assert diop_DN(986, 1) == [(49299, 1570)]
222.     assert diop_DN(991, 1) == [(379516400906811930638014896080, 12055735790331359447442538767)]
223.     assert diop_DN(17, 1) == [(33, 8)]
224.     assert diop_DN(19, 1) == [(170, 39)]
225. 
226.     # N = -1
227.     assert diop_DN(13, -1) == [(18, 5)]
228.     assert diop_DN(991, -1) == []
229.     assert diop_DN(41, -1) == [(32, 5)]
230.     assert diop_DN(290, -1) == [(17, 1)]
231.     assert diop_DN(21257, -1) == [(13913102721304, 95427381109)]
232.     assert diop_DN(32, -1) == []
233. 
234.     # |N| > 1
235.     # Some tests were created using calculator at
236.     # http://www.numbertheory.org/php/patz.html
237. 
238.     assert diop_DN(13, -4) == [(3, 1), (393, 109), (36, 10)]
239.     # Source I referred returned (3, 1), (393, 109) and (-3, 1) as fundamental solutions
240.     # So (-3, 1) and (393, 109) should be in the same equivalent class
241.     assert equivalent(-3, 1, 393, 109, 13, -4) == True
242. 
243.     assert diop_DN(13, 27) == [(220, 61), (40, 11), (768, 213), (12, 3)]
244.     assert set(diop_DN(157, 12)) == \
245.     set([(13, 1), (10663, 851), (579160, 46222), \
246.         (483790960,38610722), (26277068347, 2097138361), (21950079635497, 1751807067011)])
247.     assert diop_DN(13, 25) == [(3245, 900)]
248.     assert diop_DN(192, 18) == []
249.     assert diop_DN(23, 13) == [(-6, 1), (6, 1)]
250.     assert diop_DN(167, 2) == [(13, 1)]
251.     assert diop_DN(167, -2) == []
252. 
253.     assert diop_DN(123, -2) == [(11, 1)]
254.     # One calculator returned [(11, 1), (-11, 1)] but both of these are in
255.     # the same equivalence class
256.     assert equivalent(11, 1, -11, 1, 123, -2)
257. 
258.     assert diop_DN(123, -23) == [(-10, 1), (10, 1)]
259. 
260.     assert diop_DN(0, 0, t) == [(0, t)]
261.     assert diop_DN(0, -1, t) == []
262. 
263. 
264. def test_bf_pell():
265.     assert diop_bf_DN(13, -4) == [(3, 1), (-3, 1), (36, 10)]
266.     assert diop_bf_DN(13, 27) == [(12, 3), (-12, 3), (40, 11), (-40, 11)]
267.     assert diop_bf_DN(167, -2) == []
268.     assert diop_bf_DN(1729, 1) == [(44611924489705, 1072885712316)]
269.     assert diop_bf_DN(89, -8) == [(9, 1), (-9, 1)]
270.     assert diop_bf_DN(21257, -1) == [(13913102721304, 95427381109)]
271.     assert diop_bf_DN(340, -4) == [(756, 41)]
272.     assert diop_bf_DN(-1, 0, t) == [(0, 0)]
273.     assert diop_bf_DN(0, 0, t) == [(0, t)]
274.     assert diop_bf_DN(4, 0, t) == [(2*t, t), (-2*t, t)]
275.     assert diop_bf_DN(3, 0, t) == [(0, 0)]
276.     assert diop_bf_DN(1, -2, t) == []
277. 
278. 
279. def test_length():
280.     assert length(2, 1, 0) == 1
281.     assert length(-2, 4, 5) == 3
282.     assert length(-5, 4, 17) == 4
283.     assert length(0, 4, 13) == 6
284.     assert length(7, 13, 11) == 23
285.     assert length(1, 6, 4) == 2
286. 
287. 
288. def is_pell_transformation_ok(eq):
289.     """
290.     Test whether X*Y, X, or Y terms are present in the equation
291.     after transforming the equation using the transformation returned
292.     by transformation_to_pell(). If they are not present we are good.
293.     Moreover, coefficient of X**2 should be a divisor of coefficient of
294.     Y**2 and the constant term.
295.     """
296.     A, B = transformation_to_DN(eq)
297.     u = (A*Matrix([X, Y]) + B)[0]
298.     v = (A*Matrix([X, Y]) + B)[1]
299.     simplified = diop_simplify(eq.subs(zip((x, y), (u, v))))
300. 
301.     coeff = dict([reversed(t.as_independent(*[X, Y])) for t in simplified.args])
302. 
303.     for term in [X*Y, X, Y]:
304.         if term in coeff.keys():
305.             return False
306. 
307.     for term in [X**2, Y**2, 1]:
308.         if term not in coeff.keys():
309.             coeff[term] = 0
310. 
311.     if coeff[X**2] != 0:
312.         return divisible(coeff[Y**2], coeff[X**2]) and \
313.         divisible(coeff[1], coeff[X**2])
314. 
315.     return True
316. 
317. 
318. def test_transformation_to_pell():
319.     assert is_pell_transformation_ok(-13*x**2 - 7*x*y + y**2 + 2*x - 2*y - 14)
320.     assert is_pell_transformation_ok(-17*x**2 + 19*x*y - 7*y**2 - 5*x - 13*y - 23)
321.     assert is_pell_transformation_ok(x**2 - y**2 + 17)
322.     assert is_pell_transformation_ok(-x**2 + 7*y**2 - 23)
323.     assert is_pell_transformation_ok(25*x**2 - 45*x*y + 5*y**2 - 5*x - 10*y + 5)
324.     assert is_pell_transformation_ok(190*x**2 + 30*x*y + y**2 - 3*y - 170*x - 130)
325.     assert is_pell_transformation_ok(x**2 - 2*x*y -190*y**2 - 7*y - 23*x - 89)
326.     assert is_pell_transformation_ok(15*x**2 - 9*x*y + 14*y**2 - 23*x - 14*y - 4950)
327. 
328. 
329. def test_find_DN():
330.     assert find_DN(x**2 - 2*x - y**2) == (1, 1)
331.     assert find_DN(x**2 - 3*y**2 - 5) == (3, 5)
332.     assert find_DN(x**2 - 2*x*y - 4*y**2 - 7) == (5, 7)
333.     assert find_DN(4*x**2 - 8*x*y - y**2 - 9) == (20, 36)
334.     assert find_DN(7*x**2 - 2*x*y - y**2 - 12) == (8, 84)
335.     assert find_DN(-3*x**2 + 4*x*y -y**2) == (1, 0)
336.     assert find_DN(-13*x**2 - 7*x*y + y**2 + 2*x - 2*y -14) == (101, -7825480)
337. 
338. 
339. def test_ldescent():
340.     # Equations which have solutions
341.     u = ([(13, 23), (3, -11), (41, -113), (4, -7), (-7, 4), (91, -3), (1, 1), (1, -1),
342.         (4, 32), (17, 13), (123689, 1), (19, -570)])
343.     for a, b in u:
344.         w, x, y = ldescent(a, b)
345.         assert a*x**2 + b*y**2 == w**2
346.     assert ldescent(-1, -1) is None
347. 
348. 
349. def test_diop_ternary_quadratic_normal():
350.     assert check_solutions(234*x**2 - 65601*y**2 - z**2)
351.     assert check_solutions(23*x**2 + 616*y**2 - z**2)
352.     assert check_solutions(5*x**2 + 4*y**2 - z**2)
353.     assert check_solutions(3*x**2 + 6*y**2 - 3*z**2)
354.     assert check_solutions(x**2 + 3*y**2 - z**2)
355.     assert check_solutions(4*x**2 + 5*y**2 - z**2)
356.     assert check_solutions(x**2 + y**2 - z**2)
357.     assert check_solutions(16*x**2 + y**2 - 25*z**2)
358.     assert check_solutions(6*x**2 - y**2 + 10*z**2)
359.     assert check_solutions(213*x**2 + 12*y**2 - 9*z**2)
360.     assert check_solutions(34*x**2 - 3*y**2 - 301*z**2)
361.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
362. 
363. 
364. def is_normal_transformation_ok(eq):
365.     A = transformation_to_normal(eq)
366.     X, Y, Z = A*Matrix([x, y, z])
367.     simplified = diop_simplify(eq.subs(zip((x, y, z), (X, Y, Z))))
368. 
369.     coeff = dict([reversed(t.as_independent(*[X, Y, Z])) for t in simplified.args])
370.     for term in [X*Y, Y*Z, X*Z]:
371.         if term in coeff.keys():
372.             return False
373. 
374.     return True
375. 
376. 
377. def test_transformation_to_normal():
378.     assert is_normal_transformation_ok(x**2 + 3*y**2 + z**2 - 13*x*y - 16*y*z + 12*x*z)
379.     assert is_normal_transformation_ok(x**2 + 3*y**2 - 100*z**2)
380.     assert is_normal_transformation_ok(x**2 + 23*y*z)
381.     assert is_normal_transformation_ok(3*y**2 - 100*z**2 - 12*x*y)
382.     assert is_normal_transformation_ok(x**2 + 23*x*y - 34*y*z + 12*x*z)
383.     assert is_normal_transformation_ok(z**2 + 34*x*y - 23*y*z + x*z)
384.     assert is_normal_transformation_ok(x**2 + y**2 + z**2 - x*y - y*z - x*z)
385.     assert is_normal_transformation_ok(x**2 + 2*y*z + 3*z**2)
386.     assert is_normal_transformation_ok(x*y + 2*x*z + 3*y*z)
387.     assert is_normal_transformation_ok(2*x*z + 3*y*z)
388. 
389. 
390. def test_diop_ternary_quadratic():
391.     assert check_solutions(2*x**2 + z**2 + y**2 - 4*x*y)
392.     assert check_solutions(x**2 - y**2 - z**2 - x*y - y*z)
393.     assert check_solutions(3*x**2 - x*y - y*z - x*z)
394.     assert check_solutions(x**2 - y*z - x*z)
395.     assert check_solutions(5*x**2 - 3*x*y - x*z)
396.     assert check_solutions(4*x**2 - 5*y**2 - x*z)
397.     assert check_solutions(3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z)
398.     assert check_solutions(8*x**2 - 12*y*z)
399.     assert check_solutions(45*x**2 - 7*y**2 - 8*x*y - z**2)
400.     assert check_solutions(x**2 - 49*y**2 - z**2 + 13*z*y -8*x*y)
401.     assert check_solutions(90*x**2 + 3*y**2 + 5*x*y + 2*z*y + 5*x*z)
402.     assert check_solutions(x**2 + 3*y**2 + z**2 - x*y - 17*y*z)
403.     assert check_solutions(x**2 + 3*y**2 + z**2 - x*y - 16*y*z + 12*x*z)
404.     assert check_solutions(x**2 + 3*y**2 + z**2 - 13*x*y - 16*y*z + 12*x*z)
405.     assert check_solutions(x*y - 7*y*z + 13*x*z)
406. 
407.     assert diop_ternary_quadratic_normal(x**2 + y**2 + z**2) == (None, None, None)
408.     assert diop_ternary_quadratic_normal(x**2 + y**2) is None
409.     raises(ValueError, lambda:
410.         _diop_ternary_quadratic_normal((x, y, z),
411.         {x*y: 1, x**2: 2, y**2: 3, z**2: 0}))
412.     eq = -2*x*y - 6*x*z + 7*y**2 - 3*y*z + 4*z**2
413.     assert diop_ternary_quadratic(eq) == (7, 2, 0)
414.     assert diop_ternary_quadratic_normal(4*x**2 + 5*y**2 - z**2) == \
415.         (1, 0, 2)
416.     assert diop_ternary_quadratic(x*y + 2*y*z) == \
417.         (-2, 0, n1)
418.     eq = -5*x*y - 8*x*z - 3*y*z + 8*z**2
419.     assert parametrize_ternary_quadratic(eq) == \
420.         (8*p**2 - 3*p*q, -8*p*q + 8*q**2, 5*p*q)
421.     # this cannot be tested with diophantine because it will
422.     # factor into a product
423.     assert diop_solve(x*y + 2*y*z) == (-2*p*q, -n1*p**2 + p**2, p*q)
424. 
425. 
426. def test_square_factor():
427.     assert square_factor(1) == square_factor(-1) == 1
428.     assert square_factor(0) == 1
429.     assert square_factor(5) == square_factor(-5) == 1
430.     assert square_factor(4) == square_factor(-4) == 2
431.     assert square_factor(12) == square_factor(-12) == 2
432.     assert square_factor(6) == 1
433.     assert square_factor(18) == 3
434.     assert square_factor(52) == 2
435.     assert square_factor(49) == 7
436.     assert square_factor(392) == 14
437.     assert square_factor(factorint(-12)) == 2
438. 
439. 
440. def test_parametrize_ternary_quadratic():
441.     assert check_solutions(x**2 + y**2 - z**2)
442.     assert check_solutions(x**2 + 2*x*y + z**2)
443.     assert check_solutions(234*x**2 - 65601*y**2 - z**2)
444.     assert check_solutions(3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z)
445.     assert check_solutions(x**2 - y**2 - z**2)
446.     assert check_solutions(x**2 - 49*y**2 - z**2 + 13*z*y - 8*x*y)
447.     assert check_solutions(8*x*y + z**2)
448.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
449.     assert check_solutions(236*x**2 - 225*y**2 - 11*x*y - 13*y*z - 17*x*z)
450.     assert check_solutions(90*x**2 + 3*y**2 + 5*x*y + 2*z*y + 5*x*z)
451.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
452. 
453. 
454. def test_no_square_ternary_quadratic():
455.     assert check_solutions(2*x*y + y*z - 3*x*z)
456.     assert check_solutions(189*x*y - 345*y*z - 12*x*z)
457.     assert check_solutions(23*x*y + 34*y*z)
458.     assert check_solutions(x*y + y*z + z*x)
459.     assert check_solutions(23*x*y + 23*y*z + 23*x*z)
460. 
461. 
462. def test_descent():
463. 
464.     u = ([(13, 23), (3, -11), (41, -113), (91, -3), (1, 1), (1, -1), (17, 13), (123689, 1), (19, -570)])
465.     for a, b in u:
466.         w, x, y = descent(a, b)
467.         assert a*x**2 + b*y**2 == w**2
468.     # the docstring warns against bad input, so these are expected results
469.     # - can't both be negative
470.     raises(TypeError, lambda: descent(-1, -3))
471.     # A can't be zero unless B != 1
472.     raises(ZeroDivisionError, lambda: descent(0, 3))
473.     # supposed to be square-free
474.     raises(TypeError, lambda: descent(4, 3))
475. 
476. 
477. def test_diophantine():
478.     assert check_solutions((x - y)*(y - z)*(z - x))
479.     assert check_solutions((x - y)*(x**2 + y**2 - z**2))
480.     assert check_solutions((x - 3*y + 7*z)*(x**2 + y**2 - z**2))
481.     assert check_solutions((x**2 - 3*y**2 - 1))
482.     assert check_solutions(y**2 + 7*x*y)
483.     assert check_solutions(x**2 - 3*x*y + y**2)
484.     assert check_solutions(z*(x**2 - y**2 - 15))
485.     assert check_solutions(x*(2*y - 2*z + 5))
486.     assert check_solutions((x**2 - 3*y**2 - 1)*(x**2 - y**2 - 15))
487.     assert check_solutions((x**2 - 3*y**2 - 1)*(y - 7*z))
488.     assert check_solutions((x**2 + y**2 - z**2)*(x - 7*y - 3*z + 4*w))
489.     # Following test case caused problems in parametric representation
490.     # But this can be solved by factroing out y.
491.     # No need to use methods for ternary quadratic equations.
492.     assert check_solutions(y**2 - 7*x*y + 4*y*z)
493.     assert check_solutions(x**2 - 2*x + 1)
494. 
495.     assert diophantine(x - y) == diophantine(Eq(x, y))
496.     assert diophantine(3*x*pi - 2*y*pi) == set([(2*t_0, 3*t_0)])
497.     eq = x**2 + y**2 + z**2 - 14
498.     base_sol = set([(1, 2, 3)])
499.     assert diophantine(eq) == base_sol
500.     complete_soln = set(signed_permutations(base_sol.pop()))

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 01:49:56,036 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file 'sympy/solvers/tests/test_diophantine.py'. The provided context contains lines 1 to 500 of this file, which appears to be the complete file. Therefore, I will select the entire content to satisfy the user's request.", relative_path='sympy/solvers/tests/test_diophantine.py', start_line=1, end_line=500)]
2025-12-24 01:49:56,038 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.
2025-12-24 01:49:56,038 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 01:49:56,038 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 01:49:56,038 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-24 01:49:56,039 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-24 01:49:56,039 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── documentation-style-guide.rst
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_pyutils.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: diophantine: incomplete results depending on syms order with permute=True

Description: ```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```

diophantine: incomplete results depending on syms order with permute=True
```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```


Patch information:
diff --git a/sympy/solvers/diophantine.py b/sympy/solvers/diophantine.py
index 6092e35dab..17b7af56ce 100644
--- a/sympy/solvers/diophantine.py
+++ b/sympy/solvers/diophantine.py
@@ -180,9 +180,11 @@ def diophantine(eq, param=symbols("t", integer=True), syms=None,
                     'syms should be given as a sequence, e.g. a list')
             syms = [i for i in syms if i in var]
             if syms != var:
-                dict_sym_index = dict(zip(syms, range(len(syms))))
-                return {tuple([t[dict_sym_index[i]] for i in var])
-                            for t in diophantine(eq, param)}
+                # build mapping from var symbol to its index in the base solution
+                dict_var_index = dict(zip(var, range(len(var))))
+                # compute solutions with the requested permute setting and reorder to match syms
+                return {tuple([t[dict_var_index[s]] for s in syms])
+                            for t in diophantine(eq, param, permute=permute)}
         n, d = eq.as_numer_denom()
         if n.is_number:
             return set()


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.
Extra Requirements: 
Purpose: I need to find 3 relevant existing test cases that demonstrate similar functionality to the reported bug in the diophantine function.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/solvers/tests/test_diophantine.py
Line number range: 1 - 500
Content:
1. from sympy import (Add, Matrix, Mul, S, symbols, Eq, pi, factorint, oo,
2.                    powsimp, Rational)
3. from sympy.core.function import _mexpand
4. from sympy.core.compatibility import range, ordered
5. from sympy.functions.elementary.trigonometric import sin
6. from sympy.solvers.diophantine import (descent, diop_bf_DN, diop_DN,
7.     diop_solve, diophantine, divisible, equivalent, find_DN, ldescent, length,
8.     reconstruct, partition, power_representation,
9.     prime_as_sum_of_two_squares, square_factor, sum_of_four_squares,
10.     sum_of_three_squares, transformation_to_DN, transformation_to_normal,
11.     classify_diop, base_solution_linear, cornacchia, sqf_normal,
12.     diop_ternary_quadratic_normal, _diop_ternary_quadratic_normal,
13.     gaussian_reduce, holzer,diop_general_pythagorean,
14.     _diop_general_sum_of_squares, _nint_or_floor, _odd, _even,
15.     _remove_gcd, check_param, parametrize_ternary_quadratic,
16.     diop_ternary_quadratic, diop_linear, diop_quadratic,
17.     diop_general_sum_of_squares, sum_of_powers, sum_of_squares,
18.     diop_general_sum_of_even_powers, _can_do_sum_of_squares)
19. from sympy.utilities import default_sort_key
20. 
21. from sympy.utilities.pytest import slow, raises, XFAIL
22. from sympy.utilities.iterables import (
23.         signed_permutations)
24. 
25. a, b, c, d, p, q, x, y, z, w, t, u, v, X, Y, Z = symbols(
26.     "a, b, c, d, p, q, x, y, z, w, t, u, v, X, Y, Z", integer=True)
27. t_0, t_1, t_2, t_3, t_4, t_5, t_6 = symbols("t_:7", integer=True)
28. m1, m2, m3 = symbols('m1:4', integer=True)
29. n1 = symbols('n1', integer=True)
30. 
31. 
32. def diop_simplify(eq):
33.     return _mexpand(powsimp(_mexpand(eq)))
34. 
35. 
36. def test_input_format():
37.     raises(TypeError, lambda: diophantine(sin(x)))
38.     raises(TypeError, lambda: diophantine(3))
39.     raises(TypeError, lambda: diophantine(x/pi - 3))
40. 
41. 
42. def test_univariate():
43.     assert diop_solve((x - 1)*(x - 2)**2) == set([(1,), (2,)])
44.     assert diop_solve((x - 1)*(x - 2)) == set([(1,), (2,)])
45. 
46. 
47. def test_classify_diop():
48.     raises(TypeError, lambda: classify_diop(x**2/3 - 1))
49.     raises(ValueError, lambda: classify_diop(1))
50.     raises(NotImplementedError, lambda: classify_diop(w*x*y*z - 1))
51.     raises(NotImplementedError, lambda: classify_diop(x**3 + y**3 + z**4 - 90))
52.     assert classify_diop(14*x**2 + 15*x - 42) == (
53.         [x], {1: -42, x: 15, x**2: 14}, 'univariate')
54.     assert classify_diop(x*y + z) == (
55.         [x, y, z], {x*y: 1, z: 1}, 'inhomogeneous_ternary_quadratic')
56.     assert classify_diop(x*y + z + w + x**2) == (
57.         [w, x, y, z], {x*y: 1, w: 1, x**2: 1, z: 1}, 'inhomogeneous_general_quadratic')
58.     assert classify_diop(x*y + x*z + x**2 + 1) == (
59.         [x, y, z], {x*y: 1, x*z: 1, x**2: 1, 1: 1}, 'inhomogeneous_general_quadratic')
60.     assert classify_diop(x*y + z + w + 42) == (
61.         [w, x, y, z], {x*y: 1, w: 1, 1: 42, z: 1}, 'inhomogeneous_general_quadratic')
62.     assert classify_diop(x*y + z*w) == (
63.         [w, x, y, z], {x*y: 1, w*z: 1}, 'homogeneous_general_quadratic')
64.     assert classify_diop(x*y**2 + 1) == (
65.         [x, y], {x*y**2: 1, 1: 1}, 'cubic_thue')
66.     assert classify_diop(x**4 + y**4 + z**4 - (1 + 16 + 81)) == (
67.         [x, y, z], {1: -98, x**4: 1, z**4: 1, y**4: 1}, 'general_sum_of_even_powers')
68. 
69. 
70. def test_linear():
71.     assert diop_solve(x) == (0,)
72.     assert diop_solve(1*x) == (0,)
73.     assert diop_solve(3*x) == (0,)
74.     assert diop_solve(x + 1) == (-1,)
75.     assert diop_solve(2*x + 1) == (None,)
76.     assert diop_solve(2*x + 4) == (-2,)
77.     assert diop_solve(y + x) == (t_0, -t_0)
78.     assert diop_solve(y + x + 0) == (t_0, -t_0)
79.     assert diop_solve(y + x - 0) == (t_0, -t_0)
80.     assert diop_solve(0*x - y - 5) == (-5,)
81.     assert diop_solve(3*y + 2*x - 5) == (3*t_0 - 5, -2*t_0 + 5)
82.     assert diop_solve(2*x - 3*y - 5) == (3*t_0 - 5, 2*t_0 - 5)
83.     assert diop_solve(-2*x - 3*y - 5) == (3*t_0 + 5, -2*t_0 - 5)
84.     assert diop_solve(7*x + 5*y) == (5*t_0, -7*t_0)
85.     assert diop_solve(2*x + 4*y) == (2*t_0, -t_0)
86.     assert diop_solve(4*x + 6*y - 4) == (3*t_0 - 2, -2*t_0 + 2)
87.     assert diop_solve(4*x + 6*y - 3) == (None, None)
88.     assert diop_solve(0*x + 3*y - 4*z + 5) == (4*t_0 + 5, 3*t_0 + 5)
89.     assert diop_solve(4*x + 3*y - 4*z + 5) == (t_0, 8*t_0 + 4*t_1 + 5, 7*t_0 + 3*t_1 + 5)
90.     assert diop_solve(4*x + 3*y - 4*z + 5, None) == (0, 5, 5)
91.     assert diop_solve(4*x + 2*y + 8*z - 5) == (None, None, None)
92.     assert diop_solve(5*x + 7*y - 2*z - 6) == (t_0, -3*t_0 + 2*t_1 + 6, -8*t_0 + 7*t_1 + 18)
93.     assert diop_solve(3*x - 6*y + 12*z - 9) == (2*t_0 + 3, t_0 + 2*t_1, t_1)
94.     assert diop_solve(6*w + 9*x + 20*y - z) == (t_0, t_1, t_1 + t_2, 6*t_0 + 29*t_1 + 20*t_2)
95. 
96.     # to ignore constant factors, use diophantine
97.     raises(TypeError, lambda: diop_solve(x/2))
98. 
99. 
100. def test_quadratic_simple_hyperbolic_case():
101.     # Simple Hyperbolic case: A = C = 0 and B != 0
102.     assert diop_solve(3*x*y + 34*x - 12*y + 1) == \
103.         set([(-133, -11), (5, -57)])
104.     assert diop_solve(6*x*y + 2*x + 3*y + 1) == set([])
105.     assert diop_solve(-13*x*y + 2*x - 4*y - 54) == set([(27, 0)])
106.     assert diop_solve(-27*x*y - 30*x - 12*y - 54) == set([(-14, -1)])
107.     assert diop_solve(2*x*y + 5*x + 56*y + 7) == set([(-161, -3),\
108.         (-47,-6), (-35, -12), (-29, -69),\
109.         (-27, 64), (-21, 7),(-9, 1),\
110.         (105, -2)])
111.     assert diop_solve(6*x*y + 9*x + 2*y + 3) == set([])
112.     assert diop_solve(x*y + x + y + 1) == set([(-1, t), (t, -1)])
113.     assert diophantine(48*x*y)
114. 
115. 
116. def test_quadratic_elliptical_case():
117.     # Elliptical case: B**2 - 4AC < 0
118.     # Two test cases highlighted require lot of memory due to quadratic_congruence() method.
119.     # This above method should be replaced by Pernici's square_mod() method when his PR gets merged.
120. 
121.     #assert diop_solve(42*x**2 + 8*x*y + 15*y**2 + 23*x + 17*y - 4915) == set([(-11, -1)])
122.     assert diop_solve(4*x**2 + 3*y**2 + 5*x - 11*y + 12) == set([])
123.     assert diop_solve(x**2 + y**2 + 2*x + 2*y + 2) == set([(-1, -1)])
124.     #assert diop_solve(15*x**2 - 9*x*y + 14*y**2 - 23*x - 14*y - 4950) == set([(-15, 6)])
125.     assert diop_solve(10*x**2 + 12*x*y + 12*y**2 - 34) == \
126.         set([(-1, -1), (-1, 2), (1, -2), (1, 1)])
127. 
128. 
129. def test_quadratic_parabolic_case():
130.     # Parabolic case: B**2 - 4AC = 0
131.     assert check_solutions(8*x**2 - 24*x*y + 18*y**2 + 5*x + 7*y + 16)
132.     assert check_solutions(8*x**2 - 24*x*y + 18*y**2 + 6*x + 12*y - 6)
133.     assert check_solutions(8*x**2 + 24*x*y + 18*y**2 + 4*x + 6*y - 7)
134.     assert check_solutions(-4*x**2 + 4*x*y - y**2 + 2*x - 3)
135.     assert check_solutions(x**2 + 2*x*y + y**2 + 2*x + 2*y + 1)
136.     assert check_solutions(x**2 - 2*x*y + y**2 + 2*x + 2*y + 1)
137.     assert check_solutions(y**2 - 41*x + 40)
138. 
139. 
140. def test_quadratic_perfect_square():
141.     # B**2 - 4*A*C > 0
142.     # B**2 - 4*A*C is a perfect square
143.     assert check_solutions(48*x*y)
144.     assert check_solutions(4*x**2 - 5*x*y + y**2 + 2)
145.     assert check_solutions(-2*x**2 - 3*x*y + 2*y**2 -2*x - 17*y + 25)
146.     assert check_solutions(12*x**2 + 13*x*y + 3*y**2 - 2*x + 3*y - 12)
147.     assert check_solutions(8*x**2 + 10*x*y + 2*y**2 - 32*x - 13*y - 23)
148.     assert check_solutions(4*x**2 - 4*x*y - 3*y- 8*x - 3)
149.     assert check_solutions(- 4*x*y - 4*y**2 - 3*y- 5*x - 10)
150.     assert check_solutions(x**2 - y**2 - 2*x - 2*y)
151.     assert check_solutions(x**2 - 9*y**2 - 2*x - 6*y)
152.     assert check_solutions(4*x**2 - 9*y**2 - 4*x - 12*y - 3)
153. 
154. 
155. def test_quadratic_non_perfect_square():
156.     # B**2 - 4*A*C is not a perfect square
157.     # Used check_solutions() since the solutions are complex expressions involving
158.     # square roots and exponents
159.     assert check_solutions(x**2 - 2*x - 5*y**2)
160.     assert check_solutions(3*x**2 - 2*y**2 - 2*x - 2*y)
161.     assert check_solutions(x**2 - x*y - y**2 - 3*y)
162.     assert check_solutions(x**2 - 9*y**2 - 2*x - 6*y)
163. 
164. 
165. def test_issue_9106():
166.     eq = -48 - 2*x*(3*x - 1) + y*(3*y - 1)
167.     v = (x, y)
168.     for sol in diophantine(eq):
169.         assert not diop_simplify(eq.xreplace(dict(zip(v, sol))))
170. 
171. 
172. def test_issue_18138():
173.     eq = x**2 - x - y**2
174.     v = (x, y)
175.     for sol in diophantine(eq):
176.         assert not diop_simplify(eq.xreplace(dict(zip(v, sol))))
177. 
178. 
179. @slow
180. def test_quadratic_non_perfect_slow():
181.     assert check_solutions(8*x**2 + 10*x*y - 2*y**2 - 32*x - 13*y - 23)
182.     # This leads to very large numbers.
183.     # assert check_solutions(5*x**2 - 13*x*y + y**2 - 4*x - 4*y - 15)
184.     assert check_solutions(-3*x**2 - 2*x*y + 7*y**2 - 5*x - 7)
185.     assert check_solutions(-4 - x + 4*x**2 - y - 3*x*y - 4*y**2)
186.     assert check_solutions(1 + 2*x + 2*x**2 + 2*y + x*y - 2*y**2)
187. 
188. 
189. def test_DN():
190.     # Most of the test cases were adapted from,
191.     # Solving the generalized Pell equation x**2 - D*y**2 = N, John P. Robertson, July 31, 2004.
192.     # http://www.jpr2718.org/pell.pdf
193.     # others are verified using Wolfram Alpha.
194. 
195.     # Covers cases where D <= 0 or D > 0 and D is a square or N = 0
196.     # Solutions are straightforward in these cases.
197.     assert diop_DN(3, 0) == [(0, 0)]
198.     assert diop_DN(-17, -5) == []
199.     assert diop_DN(-19, 23) == [(2, 1)]
200.     assert diop_DN(-13, 17) == [(2, 1)]
201.     assert diop_DN(-15, 13) == []
202.     assert diop_DN(0, 5) == []
203.     assert diop_DN(0, 9) == [(3, t)]
204.     assert diop_DN(9, 0) == [(3*t, t)]
205.     assert diop_DN(16, 24) == []
206.     assert diop_DN(9, 180) == [(18, 4)]
207.     assert diop_DN(9, -180) == [(12, 6)]
208.     assert diop_DN(7, 0) == [(0, 0)]
209. 
210.     # When equation is x**2 + y**2 = N
211.     # Solutions are interchangeable
212.     assert diop_DN(-1, 5) == [(2, 1), (1, 2)]
213.     assert diop_DN(-1, 169) == [(12, 5), (5, 12), (13, 0), (0, 13)]
214. 
215.     # D > 0 and D is not a square
216. 
217.     # N = 1
218.     assert diop_DN(13, 1) == [(649, 180)]
219.     assert diop_DN(980, 1) == [(51841, 1656)]
220.     assert diop_DN(981, 1) == [(158070671986249, 5046808151700)]
221.     assert diop_DN(986, 1) == [(49299, 1570)]
222.     assert diop_DN(991, 1) == [(379516400906811930638014896080, 12055735790331359447442538767)]
223.     assert diop_DN(17, 1) == [(33, 8)]
224.     assert diop_DN(19, 1) == [(170, 39)]
225. 
226.     # N = -1
227.     assert diop_DN(13, -1) == [(18, 5)]
228.     assert diop_DN(991, -1) == []
229.     assert diop_DN(41, -1) == [(32, 5)]
230.     assert diop_DN(290, -1) == [(17, 1)]
231.     assert diop_DN(21257, -1) == [(13913102721304, 95427381109)]
232.     assert diop_DN(32, -1) == []
233. 
234.     # |N| > 1
235.     # Some tests were created using calculator at
236.     # http://www.numbertheory.org/php/patz.html
237. 
238.     assert diop_DN(13, -4) == [(3, 1), (393, 109), (36, 10)]
239.     # Source I referred returned (3, 1), (393, 109) and (-3, 1) as fundamental solutions
240.     # So (-3, 1) and (393, 109) should be in the same equivalent class
241.     assert equivalent(-3, 1, 393, 109, 13, -4) == True
242. 
243.     assert diop_DN(13, 27) == [(220, 61), (40, 11), (768, 213), (12, 3)]
244.     assert set(diop_DN(157, 12)) == \
245.     set([(13, 1), (10663, 851), (579160, 46222), \
246.         (483790960,38610722), (26277068347, 2097138361), (21950079635497, 1751807067011)])
247.     assert diop_DN(13, 25) == [(3245, 900)]
248.     assert diop_DN(192, 18) == []
249.     assert diop_DN(23, 13) == [(-6, 1), (6, 1)]
250.     assert diop_DN(167, 2) == [(13, 1)]
251.     assert diop_DN(167, -2) == []
252. 
253.     assert diop_DN(123, -2) == [(11, 1)]
254.     # One calculator returned [(11, 1), (-11, 1)] but both of these are in
255.     # the same equivalence class
256.     assert equivalent(11, 1, -11, 1, 123, -2)
257. 
258.     assert diop_DN(123, -23) == [(-10, 1), (10, 1)]
259. 
260.     assert diop_DN(0, 0, t) == [(0, t)]
261.     assert diop_DN(0, -1, t) == []
262. 
263. 
264. def test_bf_pell():
265.     assert diop_bf_DN(13, -4) == [(3, 1), (-3, 1), (36, 10)]
266.     assert diop_bf_DN(13, 27) == [(12, 3), (-12, 3), (40, 11), (-40, 11)]
267.     assert diop_bf_DN(167, -2) == []
268.     assert diop_bf_DN(1729, 1) == [(44611924489705, 1072885712316)]
269.     assert diop_bf_DN(89, -8) == [(9, 1), (-9, 1)]
270.     assert diop_bf_DN(21257, -1) == [(13913102721304, 95427381109)]
271.     assert diop_bf_DN(340, -4) == [(756, 41)]
272.     assert diop_bf_DN(-1, 0, t) == [(0, 0)]
273.     assert diop_bf_DN(0, 0, t) == [(0, t)]
274.     assert diop_bf_DN(4, 0, t) == [(2*t, t), (-2*t, t)]
275.     assert diop_bf_DN(3, 0, t) == [(0, 0)]
276.     assert diop_bf_DN(1, -2, t) == []
277. 
278. 
279. def test_length():
280.     assert length(2, 1, 0) == 1
281.     assert length(-2, 4, 5) == 3
282.     assert length(-5, 4, 17) == 4
283.     assert length(0, 4, 13) == 6
284.     assert length(7, 13, 11) == 23
285.     assert length(1, 6, 4) == 2
286. 
287. 
288. def is_pell_transformation_ok(eq):
289.     """
290.     Test whether X*Y, X, or Y terms are present in the equation
291.     after transforming the equation using the transformation returned
292.     by transformation_to_pell(). If they are not present we are good.
293.     Moreover, coefficient of X**2 should be a divisor of coefficient of
294.     Y**2 and the constant term.
295.     """
296.     A, B = transformation_to_DN(eq)
297.     u = (A*Matrix([X, Y]) + B)[0]
298.     v = (A*Matrix([X, Y]) + B)[1]
299.     simplified = diop_simplify(eq.subs(zip((x, y), (u, v))))
300. 
301.     coeff = dict([reversed(t.as_independent(*[X, Y])) for t in simplified.args])
302. 
303.     for term in [X*Y, X, Y]:
304.         if term in coeff.keys():
305.             return False
306. 
307.     for term in [X**2, Y**2, 1]:
308.         if term not in coeff.keys():
309.             coeff[term] = 0
310. 
311.     if coeff[X**2] != 0:
312.         return divisible(coeff[Y**2], coeff[X**2]) and \
313.         divisible(coeff[1], coeff[X**2])
314. 
315.     return True
316. 
317. 
318. def test_transformation_to_pell():
319.     assert is_pell_transformation_ok(-13*x**2 - 7*x*y + y**2 + 2*x - 2*y - 14)
320.     assert is_pell_transformation_ok(-17*x**2 + 19*x*y - 7*y**2 - 5*x - 13*y - 23)
321.     assert is_pell_transformation_ok(x**2 - y**2 + 17)
322.     assert is_pell_transformation_ok(-x**2 + 7*y**2 - 23)
323.     assert is_pell_transformation_ok(25*x**2 - 45*x*y + 5*y**2 - 5*x - 10*y + 5)
324.     assert is_pell_transformation_ok(190*x**2 + 30*x*y + y**2 - 3*y - 170*x - 130)
325.     assert is_pell_transformation_ok(x**2 - 2*x*y -190*y**2 - 7*y - 23*x - 89)
326.     assert is_pell_transformation_ok(15*x**2 - 9*x*y + 14*y**2 - 23*x - 14*y - 4950)
327. 
328. 
329. def test_find_DN():
330.     assert find_DN(x**2 - 2*x - y**2) == (1, 1)
331.     assert find_DN(x**2 - 3*y**2 - 5) == (3, 5)
332.     assert find_DN(x**2 - 2*x*y - 4*y**2 - 7) == (5, 7)
333.     assert find_DN(4*x**2 - 8*x*y - y**2 - 9) == (20, 36)
334.     assert find_DN(7*x**2 - 2*x*y - y**2 - 12) == (8, 84)
335.     assert find_DN(-3*x**2 + 4*x*y -y**2) == (1, 0)
336.     assert find_DN(-13*x**2 - 7*x*y + y**2 + 2*x - 2*y -14) == (101, -7825480)
337. 
338. 
339. def test_ldescent():
340.     # Equations which have solutions
341.     u = ([(13, 23), (3, -11), (41, -113), (4, -7), (-7, 4), (91, -3), (1, 1), (1, -1),
342.         (4, 32), (17, 13), (123689, 1), (19, -570)])
343.     for a, b in u:
344.         w, x, y = ldescent(a, b)
345.         assert a*x**2 + b*y**2 == w**2
346.     assert ldescent(-1, -1) is None
347. 
348. 
349. def test_diop_ternary_quadratic_normal():
350.     assert check_solutions(234*x**2 - 65601*y**2 - z**2)
351.     assert check_solutions(23*x**2 + 616*y**2 - z**2)
352.     assert check_solutions(5*x**2 + 4*y**2 - z**2)
353.     assert check_solutions(3*x**2 + 6*y**2 - 3*z**2)
354.     assert check_solutions(x**2 + 3*y**2 - z**2)
355.     assert check_solutions(4*x**2 + 5*y**2 - z**2)
356.     assert check_solutions(x**2 + y**2 - z**2)
357.     assert check_solutions(16*x**2 + y**2 - 25*z**2)
358.     assert check_solutions(6*x**2 - y**2 + 10*z**2)
359.     assert check_solutions(213*x**2 + 12*y**2 - 9*z**2)
360.     assert check_solutions(34*x**2 - 3*y**2 - 301*z**2)
361.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
362. 
363. 
364. def is_normal_transformation_ok(eq):
365.     A = transformation_to_normal(eq)
366.     X, Y, Z = A*Matrix([x, y, z])
367.     simplified = diop_simplify(eq.subs(zip((x, y, z), (X, Y, Z))))
368. 
369.     coeff = dict([reversed(t.as_independent(*[X, Y, Z])) for t in simplified.args])
370.     for term in [X*Y, Y*Z, X*Z]:
371.         if term in coeff.keys():
372.             return False
373. 
374.     return True
375. 
376. 
377. def test_transformation_to_normal():
378.     assert is_normal_transformation_ok(x**2 + 3*y**2 + z**2 - 13*x*y - 16*y*z + 12*x*z)
379.     assert is_normal_transformation_ok(x**2 + 3*y**2 - 100*z**2)
380.     assert is_normal_transformation_ok(x**2 + 23*y*z)
381.     assert is_normal_transformation_ok(3*y**2 - 100*z**2 - 12*x*y)
382.     assert is_normal_transformation_ok(x**2 + 23*x*y - 34*y*z + 12*x*z)
383.     assert is_normal_transformation_ok(z**2 + 34*x*y - 23*y*z + x*z)
384.     assert is_normal_transformation_ok(x**2 + y**2 + z**2 - x*y - y*z - x*z)
385.     assert is_normal_transformation_ok(x**2 + 2*y*z + 3*z**2)
386.     assert is_normal_transformation_ok(x*y + 2*x*z + 3*y*z)
387.     assert is_normal_transformation_ok(2*x*z + 3*y*z)
388. 
389. 
390. def test_diop_ternary_quadratic():
391.     assert check_solutions(2*x**2 + z**2 + y**2 - 4*x*y)
392.     assert check_solutions(x**2 - y**2 - z**2 - x*y - y*z)
393.     assert check_solutions(3*x**2 - x*y - y*z - x*z)
394.     assert check_solutions(x**2 - y*z - x*z)
395.     assert check_solutions(5*x**2 - 3*x*y - x*z)
396.     assert check_solutions(4*x**2 - 5*y**2 - x*z)
397.     assert check_solutions(3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z)
398.     assert check_solutions(8*x**2 - 12*y*z)
399.     assert check_solutions(45*x**2 - 7*y**2 - 8*x*y - z**2)
400.     assert check_solutions(x**2 - 49*y**2 - z**2 + 13*z*y -8*x*y)
401.     assert check_solutions(90*x**2 + 3*y**2 + 5*x*y + 2*z*y + 5*x*z)
402.     assert check_solutions(x**2 + 3*y**2 + z**2 - x*y - 17*y*z)
403.     assert check_solutions(x**2 + 3*y**2 + z**2 - x*y - 16*y*z + 12*x*z)
404.     assert check_solutions(x**2 + 3*y**2 + z**2 - 13*x*y - 16*y*z + 12*x*z)
405.     assert check_solutions(x*y - 7*y*z + 13*x*z)
406. 
407.     assert diop_ternary_quadratic_normal(x**2 + y**2 + z**2) == (None, None, None)
408.     assert diop_ternary_quadratic_normal(x**2 + y**2) is None
409.     raises(ValueError, lambda:
410.         _diop_ternary_quadratic_normal((x, y, z),
411.         {x*y: 1, x**2: 2, y**2: 3, z**2: 0}))
412.     eq = -2*x*y - 6*x*z + 7*y**2 - 3*y*z + 4*z**2
413.     assert diop_ternary_quadratic(eq) == (7, 2, 0)
414.     assert diop_ternary_quadratic_normal(4*x**2 + 5*y**2 - z**2) == \
415.         (1, 0, 2)
416.     assert diop_ternary_quadratic(x*y + 2*y*z) == \
417.         (-2, 0, n1)
418.     eq = -5*x*y - 8*x*z - 3*y*z + 8*z**2
419.     assert parametrize_ternary_quadratic(eq) == \
420.         (8*p**2 - 3*p*q, -8*p*q + 8*q**2, 5*p*q)
421.     # this cannot be tested with diophantine because it will
422.     # factor into a product
423.     assert diop_solve(x*y + 2*y*z) == (-2*p*q, -n1*p**2 + p**2, p*q)
424. 
425. 
426. def test_square_factor():
427.     assert square_factor(1) == square_factor(-1) == 1
428.     assert square_factor(0) == 1
429.     assert square_factor(5) == square_factor(-5) == 1
430.     assert square_factor(4) == square_factor(-4) == 2
431.     assert square_factor(12) == square_factor(-12) == 2
432.     assert square_factor(6) == 1
433.     assert square_factor(18) == 3
434.     assert square_factor(52) == 2
435.     assert square_factor(49) == 7
436.     assert square_factor(392) == 14
437.     assert square_factor(factorint(-12)) == 2
438. 
439. 
440. def test_parametrize_ternary_quadratic():
441.     assert check_solutions(x**2 + y**2 - z**2)
442.     assert check_solutions(x**2 + 2*x*y + z**2)
443.     assert check_solutions(234*x**2 - 65601*y**2 - z**2)
444.     assert check_solutions(3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z)
445.     assert check_solutions(x**2 - y**2 - z**2)
446.     assert check_solutions(x**2 - 49*y**2 - z**2 + 13*z*y - 8*x*y)
447.     assert check_solutions(8*x*y + z**2)
448.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
449.     assert check_solutions(236*x**2 - 225*y**2 - 11*x*y - 13*y*z - 17*x*z)
450.     assert check_solutions(90*x**2 + 3*y**2 + 5*x*y + 2*z*y + 5*x*z)
451.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
452. 
453. 
454. def test_no_square_ternary_quadratic():
455.     assert check_solutions(2*x*y + y*z - 3*x*z)
456.     assert check_solutions(189*x*y - 345*y*z - 12*x*z)
457.     assert check_solutions(23*x*y + 34*y*z)
458.     assert check_solutions(x*y + y*z + z*x)
459.     assert check_solutions(23*x*y + 23*y*z + 23*x*z)
460. 
461. 
462. def test_descent():
463. 
464.     u = ([(13, 23), (3, -11), (41, -113), (91, -3), (1, 1), (1, -1), (17, 13), (123689, 1), (19, -570)])
465.     for a, b in u:
466.         w, x, y = descent(a, b)
467.         assert a*x**2 + b*y**2 == w**2
468.     # the docstring warns against bad input, so these are expected results
469.     # - can't both be negative
470.     raises(TypeError, lambda: descent(-1, -3))
471.     # A can't be zero unless B != 1
472.     raises(ZeroDivisionError, lambda: descent(0, 3))
473.     # supposed to be square-free
474.     raises(TypeError, lambda: descent(4, 3))
475. 
476. 
477. def test_diophantine():
478.     assert check_solutions((x - y)*(y - z)*(z - x))
479.     assert check_solutions((x - y)*(x**2 + y**2 - z**2))
480.     assert check_solutions((x - 3*y + 7*z)*(x**2 + y**2 - z**2))
481.     assert check_solutions((x**2 - 3*y**2 - 1))
482.     assert check_solutions(y**2 + 7*x*y)
483.     assert check_solutions(x**2 - 3*x*y + y**2)
484.     assert check_solutions(z*(x**2 - y**2 - 15))
485.     assert check_solutions(x*(2*y - 2*z + 5))
486.     assert check_solutions((x**2 - 3*y**2 - 1)*(x**2 - y**2 - 15))
487.     assert check_solutions((x**2 - 3*y**2 - 1)*(y - 7*z))
488.     assert check_solutions((x**2 + y**2 - z**2)*(x - 7*y - 3*z + 4*w))
489.     # Following test case caused problems in parametric representation
490.     # But this can be solved by factroing out y.
491.     # No need to use methods for ternary quadratic equations.
492.     assert check_solutions(y**2 - 7*x*y + 4*y*z)
493.     assert check_solutions(x**2 - 2*x + 1)
494. 
495.     assert diophantine(x - y) == diophantine(Eq(x, y))
496.     assert diophantine(3*x*pi - 2*y*pi) == set([(2*t_0, 3*t_0)])
497.     eq = x**2 + y**2 + z**2 - 14
498.     base_sol = set([(1, 2, 3)])
499.     assert diophantine(eq) == base_sol
500.     complete_soln = set(signed_permutations(base_sol.pop()))

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 01:50:14,643 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find 3 test cases for a bug in the `diophantine` function related to the `syms` and `permute` parameters. I have analyzed the first 500 lines of `sympy/solvers/tests/test_diophantine.py` and found no tests that use these parameters. The relevant tests are likely in the remainder of the file.' query='Please provide the content of the file sympy/solvers/tests/test_diophantine.py from line 501 to the end.' extra_requirements='' purpose='I need the rest of the file to find test cases that use the `syms` and `permute` arguments in the `diophantine` function, which are central to the bug report.'
2025-12-24 01:50:14,644 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the content of the file sympy/solvers/tests/test_diophantine.py from line 501 to the end.
2025-12-24 01:50:14,644 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 01:50:14,644 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 01:50:14,645 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 01:50:14,645 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the content of the file sympy/solvers/tests/test_diophantine.py from line 501 to the end.
Purpose: I need the rest of the file to find test cases that use the `syms` and `permute` arguments in the `diophantine` function, which are central to the bug report.
2025-12-24 01:50:19,367 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will read the content of the specified file from line 501 to the end. This will allow me to examine the test cases that use the `syms` and `permute` arguments in the `diophantine` function, which should help in addressing the bug report.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 501.0, "relative_path": "sympy/solvers/tests/test_diophantine.py", "end_line": 2000.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2134, 'candidates_token_count': 93, 'total_token_count': 2561, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2134}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 93}], 'thoughts_token_count': 334, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2870914705338017, 'model_name': 'gemini-2.5-pro'} id='run--71209410-ad34-498f-9e92-0b2238d84f40-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 501.0, 'relative_path': 'sympy/solvers/tests/test_diophantine.py', 'end_line': 2000.0}, 'id': 'ed52c956-bf8e-4f99-bbc3-90d63b80b012', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2134, 'output_tokens': 93, 'total_tokens': 2561, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 334}}
2025-12-24 01:50:26,025 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the content of the file `sympy/solvers/tests/test_diophantine.py` from line 501 to the end. This allows me to examine the test cases that utilize the `syms` and `permute` arguments within the `diophantine` function, which is crucial for understanding and addressing the bug report. I can now proceed to analyze these specific tests to identify the root cause of the issue.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12708, 'candidates_token_count': 94, 'total_token_count': 13285, 'cached_content_token_count': 1903, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12708}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1903}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 94}], 'thoughts_token_count': 483}, 'finish_reason': 'STOP', 'avg_logprobs': -0.44539346086218, 'model_name': 'gemini-2.5-pro'} id='run--608f985d-3471-48a2-88bd-de0a4406bf6f-0' usage_metadata={'input_tokens': 12708, 'output_tokens': 94, 'total_tokens': 13285, 'input_token_details': {'cache_read': 1903}, 'output_token_details': {'reasoning': 483}}
2025-12-24 01:50:26,027 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the content of the file sympy/solvers/tests/test_diophantine.py from line 501 to the end.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need the rest of the file to find test cases that use the `syms` and `permute` arguments in the `diophantine` function, which are central to the bug report.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/solvers/tests/test_diophantine.py
Line number range: 501 - 2000
Content:
501.     assert diophantine(eq, permute=True) == complete_soln
502. 
503.     assert diophantine(x**2 + x*Rational(15, 14) - 3) == set()
504.     # test issue 11049
505.     eq = 92*x**2 - 99*y**2 - z**2
506.     coeff = eq.as_coefficients_dict()
507.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
508.         (9, 7, 51)
509.     assert diophantine(eq) == set([(
510.         891*p**2 + 9*q**2, -693*p**2 - 102*p*q + 7*q**2,
511.         5049*p**2 - 1386*p*q - 51*q**2)])
512.     eq = 2*x**2 + 2*y**2 - z**2
513.     coeff = eq.as_coefficients_dict()
514.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
515.         (1, 1, 2)
516.     assert diophantine(eq) == set([(
517.         2*p**2 - q**2, -2*p**2 + 4*p*q - q**2,
518.         4*p**2 - 4*p*q + 2*q**2)])
519.     eq = 411*x**2+57*y**2-221*z**2
520.     coeff = eq.as_coefficients_dict()
521.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
522.         (2021, 2645, 3066)
523.     assert diophantine(eq) == \
524.         set([(115197*p**2 - 446641*q**2, -150765*p**2 + 1355172*p*q -
525.         584545*q**2, 174762*p**2 - 301530*p*q + 677586*q**2)])
526.     eq = 573*x**2+267*y**2-984*z**2
527.     coeff = eq.as_coefficients_dict()
528.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
529.         (49, 233, 127)
530.     assert diophantine(eq) == \
531.         set([(4361*p**2 - 16072*q**2, -20737*p**2 + 83312*p*q - 76424*q**2,
532.         11303*p**2 - 41474*p*q + 41656*q**2)])
533.     # this produces factors during reconstruction
534.     eq = x**2 + 3*y**2 - 12*z**2
535.     coeff = eq.as_coefficients_dict()
536.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
537.         (0, 2, 1)
538.     assert diophantine(eq) == \
539.         set([(24*p*q, 2*p**2 - 24*q**2, p**2 + 12*q**2)])
540.     # solvers have not been written for every type
541.     raises(NotImplementedError, lambda: diophantine(x*y**2 + 1))
542. 
543.     # rational expressions
544.     assert diophantine(1/x) == set()
545.     assert diophantine(1/x + 1/y - S.Half)
546.     set([(6, 3), (-2, 1), (4, 4), (1, -2), (3, 6)])
547.     assert diophantine(x**2 + y**2 +3*x- 5, permute=True) == \
548.         set([(-1, 1), (-4, -1), (1, -1), (1, 1), (-4, 1), (-1, -1), (4, 1), (4, -1)])
549. 
550.     # issue 18122
551.     assert check_solutions(x**2-y)
552.     assert check_solutions(y**2-x)
553.     assert diophantine((x**2-y), t) == set([(t, t**2)])
554.     assert diophantine((y**2-x), t) == set([(t**2, -t)])
555. 
556. 
557. def test_general_pythagorean():
558.     from sympy.abc import a, b, c, d, e
559. 
560.     assert check_solutions(a**2 + b**2 + c**2 - d**2)
561.     assert check_solutions(a**2 + 4*b**2 + 4*c**2 - d**2)
562.     assert check_solutions(9*a**2 + 4*b**2 + 4*c**2 - d**2)
563.     assert check_solutions(9*a**2 + 4*b**2 - 25*d**2 + 4*c**2 )
564.     assert check_solutions(9*a**2 - 16*d**2 + 4*b**2 + 4*c**2)
565.     assert check_solutions(-e**2 + 9*a**2 + 4*b**2 + 4*c**2 + 25*d**2)
566.     assert check_solutions(16*a**2 - b**2 + 9*c**2 + d**2 + 25*e**2)
567. 
568. 
569. def test_diop_general_sum_of_squares_quick():
570.     for i in range(3, 10):
571.         assert check_solutions(sum(i**2 for i in symbols(':%i' % i)) - i)
572.     raises(ValueError, lambda: _diop_general_sum_of_squares((x, y), 2))
573.     assert _diop_general_sum_of_squares((x, y, z), -2) == set()
574.     eq = x**2 + y**2 + z**2 - (1 + 4 + 9)
575.     assert diop_general_sum_of_squares(eq) == \
576.         set([(1, 2, 3)])
577.     eq = u**2 + v**2 + x**2 + y**2 + z**2 - 1313
578.     assert len(diop_general_sum_of_squares(eq, 3)) == 3
579.     # issue 11016
580.     var = symbols(':5') + (symbols('6', negative=True),)
581.     eq = Add(*[i**2 for i in var]) - 112
582. 
583.     base_soln = set(
584.         [(0, 1, 1, 5, 6, -7), (1, 1, 1, 3, 6, -8), (2, 3, 3, 4, 5, -7),
585.             (0, 1, 1, 1, 3, -10), (0, 0, 4, 4, 4, -8), (1, 2, 3, 3, 5, -8),
586.             (0, 1, 2, 3, 7, -7), (2, 2, 4, 4, 6, -6), (1, 1, 3, 4, 6, -7),
587.             (0, 2, 3, 3, 3, -9), (0, 0, 2, 2, 2, -10), (1, 1, 2, 3, 4, -9),
588.             (0, 1, 1, 2, 5, -9), (0, 0, 2, 6, 6, -6), (1, 3, 4, 5, 5, -6),
589.             (0, 2, 2, 2, 6, -8), (0, 3, 3, 3, 6, -7), (0, 2, 3, 5, 5, -7),
590.             (0, 1, 5, 5, 5, -6)])
591.     assert diophantine(eq) == base_soln
592.     assert len(diophantine(eq, permute=True)) == 196800
593. 
594.     # handle negated squares with signsimp
595.     assert diophantine(12 - x**2 - y**2 - z**2) == set([(2, 2, 2)])
596.     # diophantine handles simplification, so classify_diop should
597.     # not have to look for additional patterns that are removed
598.     # by diophantine
599.     eq = a**2 + b**2 + c**2 + d**2 - 4
600.     raises(NotImplementedError, lambda: classify_diop(-eq))
601. 
602. 
603. def test_diop_partition():
604.     for n in [8, 10]:
605.         for k in range(1, 8):
606.             for p in partition(n, k):
607.                 assert len(p) == k
608.     assert [p for p in partition(3, 5)] == []
609.     assert [list(p) for p in partition(3, 5, 1)] == [
610.         [0, 0, 0, 0, 3], [0, 0, 0, 1, 2], [0, 0, 1, 1, 1]]
611.     assert list(partition(0)) == [()]
612.     assert list(partition(1, 0)) == [()]
613.     assert [list(i) for i in partition(3)] == [[1, 1, 1], [1, 2], [3]]
614. 
615. 
616. def test_prime_as_sum_of_two_squares():
617.     for i in [5, 13, 17, 29, 37, 41, 2341, 3557, 34841, 64601]:
618.         a, b = prime_as_sum_of_two_squares(i)
619.         assert a**2 + b**2 == i
620.     assert prime_as_sum_of_two_squares(7) is None
621.     ans = prime_as_sum_of_two_squares(800029)
622.     assert ans == (450, 773) and type(ans[0]) is int
623. 
624. 
625. def test_sum_of_three_squares():
626.     for i in [0, 1, 2, 34, 123, 34304595905, 34304595905394941, 343045959052344,
627.               800, 801, 802, 803, 804, 805, 806]:
628.         a, b, c = sum_of_three_squares(i)
629.         assert a**2 + b**2 + c**2 == i
630. 
631.     assert sum_of_three_squares(7) is None
632.     assert sum_of_three_squares((4**5)*15) is None
633.     assert sum_of_three_squares(25) == (5, 0, 0)
634.     assert sum_of_three_squares(4) == (0, 0, 2)
635. 
636. 
637. def test_sum_of_four_squares():
638.     from random import randint
639. 
640.     # this should never fail
641.     n = randint(1, 100000000000000)
642.     assert sum(i**2 for i in sum_of_four_squares(n)) == n
643. 
644.     assert sum_of_four_squares(0) == (0, 0, 0, 0)
645.     assert sum_of_four_squares(14) == (0, 1, 2, 3)
646.     assert sum_of_four_squares(15) == (1, 1, 2, 3)
647.     assert sum_of_four_squares(18) == (1, 2, 2, 3)
648.     assert sum_of_four_squares(19) == (0, 1, 3, 3)
649.     assert sum_of_four_squares(48) == (0, 4, 4, 4)
650. 
651. 
652. def test_power_representation():
653.     tests = [(1729, 3, 2), (234, 2, 4), (2, 1, 2), (3, 1, 3), (5, 2, 2), (12352, 2, 4),
654.              (32760, 2, 3)]
655. 
656.     for test in tests:
657.         n, p, k = test
658.         f = power_representation(n, p, k)
659. 
660.         while True:
661.             try:
662.                 l = next(f)
663.                 assert len(l) == k
664. 
665.                 chk_sum = 0
666.                 for l_i in l:
667.                     chk_sum = chk_sum + l_i**p
668.                 assert chk_sum == n
669. 
670.             except StopIteration:
671.                 break
672. 
673.     assert list(power_representation(20, 2, 4, True)) == \
674.         [(1, 1, 3, 3), (0, 0, 2, 4)]
675.     raises(ValueError, lambda: list(power_representation(1.2, 2, 2)))
676.     raises(ValueError, lambda: list(power_representation(2, 0, 2)))
677.     raises(ValueError, lambda: list(power_representation(2, 2, 0)))
678.     assert list(power_representation(-1, 2, 2)) == []
679.     assert list(power_representation(1, 1, 1)) == [(1,)]
680.     assert list(power_representation(3, 2, 1)) == []
681.     assert list(power_representation(4, 2, 1)) == [(2,)]
682.     assert list(power_representation(3**4, 4, 6, zeros=True)) == \
683.         [(1, 2, 2, 2, 2, 2), (0, 0, 0, 0, 0, 3)]
684.     assert list(power_representation(3**4, 4, 5, zeros=False)) == []
685.     assert list(power_representation(-2, 3, 2)) == [(-1, -1)]
686.     assert list(power_representation(-2, 4, 2)) == []
687.     assert list(power_representation(0, 3, 2, True)) == [(0, 0)]
688.     assert list(power_representation(0, 3, 2, False)) == []
689.     # when we are dealing with squares, do feasibility checks
690.     assert len(list(power_representation(4**10*(8*10 + 7), 2, 3))) == 0
691.     # there will be a recursion error if these aren't recognized
692.     big = 2**30
693.     for i in [13, 10, 7, 5, 4, 2, 1]:
694.         assert list(sum_of_powers(big, 2, big - i)) == []
695. 
696. 
697. def test_assumptions():
698.     """
699.     Test whether diophantine respects the assumptions.
700.     """
701.     #Test case taken from the below so question regarding assumptions in diophantine module
702.     #https://stackoverflow.com/questions/23301941/how-can-i-declare-natural-symbols-with-sympy
703.     m, n = symbols('m n', integer=True, positive=True)
704.     diof = diophantine(n ** 2 + m * n - 500)
705.     assert diof == set([(5, 20), (40, 10), (95, 5), (121, 4), (248, 2), (499, 1)])
706. 
707.     a, b = symbols('a b', integer=True, positive=False)
708.     diof = diophantine(a*b + 2*a + 3*b - 6)
709.     assert diof == set([(-15, -3), (-9, -4), (-7, -5), (-6, -6), (-5, -8), (-4, -14)])
710. 
711. 
712. def check_solutions(eq):
713.     """
714.     Determines whether solutions returned by diophantine() satisfy the original
715.     equation. Hope to generalize this so we can remove functions like check_ternay_quadratic,
716.     check_solutions_normal, check_solutions()
717.     """
718.     s = diophantine(eq)
719. 
720.     factors = Mul.make_args(eq)
721. 
722.     var = list(eq.free_symbols)
723.     var.sort(key=default_sort_key)
724. 
725.     while s:
726.         solution = s.pop()
727.         for f in factors:
728.             if diop_simplify(f.subs(zip(var, solution))) == 0:
729.                 break
730.         else:
731.             return False
732.     return True
733. 
734. 
735. def test_diopcoverage():
736.     eq = (2*x + y + 1)**2
737.     assert diop_solve(eq) == set([(t_0, -2*t_0 - 1)])
738.     eq = 2*x**2 + 6*x*y + 12*x + 4*y**2 + 18*y + 18
739.     assert diop_solve(eq) == set([(t_0, -t_0 - 3), (2*t_0 - 3, -t_0)])
740.     assert diop_quadratic(x + y**2 - 3) == set([(-t**2 + 3, -t)])
741. 
742.     assert diop_linear(x + y - 3) == (t_0, 3 - t_0)
743. 
744.     assert base_solution_linear(0, 1, 2, t=None) == (0, 0)
745.     ans = (3*t - 1, -2*t + 1)
746.     assert base_solution_linear(4, 8, 12, t) == ans
747.     assert base_solution_linear(4, 8, 12, t=None) == tuple(_.subs(t, 0) for _ in ans)
748. 
749.     assert cornacchia(1, 1, 20) is None
750.     assert cornacchia(1, 1, 5) == set([(2, 1)])
751.     assert cornacchia(1, 2, 17) == set([(3, 2)])
752. 
753.     raises(ValueError, lambda: reconstruct(4, 20, 1))
754. 
755.     assert gaussian_reduce(4, 1, 3) == (1, 1)
756.     eq = -w**2 - x**2 - y**2 + z**2
757. 
758.     assert diop_general_pythagorean(eq) == \
759.         diop_general_pythagorean(-eq) == \
760.             (m1**2 + m2**2 - m3**2, 2*m1*m3,
761.             2*m2*m3, m1**2 + m2**2 + m3**2)
762. 
763.     assert check_param(S(3) + x/3, S(4) + x/2, S(2), x) == (None, None)
764.     assert check_param(Rational(3, 2), S(4) + x, S(2), x) == (None, None)
765.     assert check_param(S(4) + x, Rational(3, 2), S(2), x) == (None, None)
766. 
767.     assert _nint_or_floor(16, 10) == 2
768.     assert _odd(1) == (not _even(1)) == True
769.     assert _odd(0) == (not _even(0)) == False
770.     assert _remove_gcd(2, 4, 6) == (1, 2, 3)
771.     raises(TypeError, lambda: _remove_gcd((2, 4, 6)))
772.     assert sqf_normal(2 * 3**2 * 5, 2 * 5 * 11, 2 * 7**2 * 11)  == \
773.         (11, 1, 5)
774. 
775.     # it's ok if these pass some day when the solvers are implemented
776.     raises(NotImplementedError, lambda: diophantine(x**2 + y**2 + x*y + 2*y*z - 12))
777.     raises(NotImplementedError, lambda: diophantine(x**3 + y**2))
778.     assert diop_quadratic(x**2 + y**2 - 1**2 - 3**4) == \
779.         set([(-9, -1), (-9, 1), (-1, -9), (-1, 9), (1, -9), (1, 9), (9, -1), (9, 1)])
780. 
781. 
782. def test_holzer():
783.     # if the input is good, don't let it diverge in holzer()
784.     # (but see test_fail_holzer below)
785.     assert holzer(2, 7, 13, 4, 79, 23) == (2, 7, 13)
786. 
787.     # None in uv condition met; solution is not Holzer reduced
788.     # so this will hopefully change but is here for coverage
789.     assert holzer(2, 6, 2, 1, 1, 10) == (2, 6, 2)
790. 
791.     raises(ValueError, lambda: holzer(2, 7, 14, 4, 79, 23))
792. 
793. 
794. @XFAIL
795. def test_fail_holzer():
796.     eq = lambda x, y, z: a*x**2 + b*y**2 - c*z**2
797.     a, b, c = 4, 79, 23
798.     x, y, z = xyz = 26, 1, 11
799.     X, Y, Z = ans = 2, 7, 13
800.     assert eq(*xyz) == 0
801.     assert eq(*ans) == 0
802.     assert max(a*x**2, b*y**2, c*z**2) <= a*b*c
803.     assert max(a*X**2, b*Y**2, c*Z**2) <= a*b*c
804.     h = holzer(x, y, z, a, b, c)
805.     assert h == ans  # it would be nice to get the smaller soln
806. 
807. 
808. def test_issue_9539():
809.     assert diophantine(6*w + 9*y + 20*x - z) == \
810.         set([(t_0, t_1, t_1 + t_2, 6*t_0 + 29*t_1 + 9*t_2)])
811. 
812. 
813. def test_issue_8943():
814.     assert diophantine(
815.         (3*(x**2 + y**2 + z**2) - 14*(x*y + y*z + z*x))) == \
816.         set([(0, 0, 0)])
817. 
818. 
819. def test_diop_sum_of_even_powers():
820.     eq = x**4 + y**4 + z**4 - 2673
821.     assert diop_solve(eq) == set([(3, 6, 6), (2, 4, 7)])
822.     assert diop_general_sum_of_even_powers(eq, 2) == set(
823.         [(3, 6, 6), (2, 4, 7)])
824.     raises(NotImplementedError, lambda: diop_general_sum_of_even_powers(-eq, 2))
825.     neg = symbols('neg', negative=True)
826.     eq = x**4 + y**4 + neg**4 - 2673
827.     assert diop_general_sum_of_even_powers(eq) == set([(-3, 6, 6)])
828.     assert diophantine(x**4 + y**4 + 2) == set()
829.     assert diop_general_sum_of_even_powers(x**4 + y**4 - 2, limit=0) == set()
830. 
831. 
832. def test_sum_of_squares_powers():
833.     tru = set([
834.     (0, 0, 1, 1, 11), (0, 0, 5, 7, 7), (0, 1, 3, 7, 8), (0, 1, 4, 5, 9),
835.     (0, 3, 4, 7, 7), (0, 3, 5, 5, 8), (1, 1, 2, 6, 9), (1, 1, 6, 6, 7),
836.     (1, 2, 3, 3, 10), (1, 3, 4, 4, 9), (1, 5, 5, 6, 6), (2, 2, 3, 5, 9),
837.     (2, 3, 5, 6, 7), (3, 3, 4, 5, 8)])
838.     eq = u**2 + v**2 + x**2 + y**2 + z**2 - 123
839.     ans = diop_general_sum_of_squares(eq, oo)  # allow oo to be used
840.     assert len(ans) == 14
841.     assert ans == tru
842. 
843.     raises(ValueError, lambda: list(sum_of_squares(10, -1)))
844.     assert list(sum_of_squares(-10, 2)) == []
845.     assert list(sum_of_squares(2, 3)) == []
846.     assert list(sum_of_squares(0, 3, True)) == [(0, 0, 0)]
847.     assert list(sum_of_squares(0, 3)) == []
848.     assert list(sum_of_squares(4, 1)) == [(2,)]
849.     assert list(sum_of_squares(5, 1)) == []
850.     assert list(sum_of_squares(50, 2)) == [(5, 5), (1, 7)]
851.     assert list(sum_of_squares(11, 5, True)) == [
852.         (1, 1, 1, 2, 2), (0, 0, 1, 1, 3)]
853.     assert list(sum_of_squares(8, 8)) == [(1, 1, 1, 1, 1, 1, 1, 1)]
854. 
855.     assert [len(list(sum_of_squares(i, 5, True))) for i in range(30)] == [
856.         1, 1, 1, 1, 2,
857.         2, 1, 1, 2, 2,
858.         2, 2, 2, 3, 2,
859.         1, 3, 3, 3, 3,
860.         4, 3, 3, 2, 2,
861.         4, 4, 4, 4, 5]
862.     assert [len(list(sum_of_squares(i, 5))) for i in range(30)] == [
863.         0, 0, 0, 0, 0,
864.         1, 0, 0, 1, 0,
865.         0, 1, 0, 1, 1,
866.         0, 1, 1, 0, 1,
867.         2, 1, 1, 1, 1,
868.         1, 1, 1, 1, 3]
869.     for i in range(30):
870.         s1 = set(sum_of_squares(i, 5, True))
871.         assert not s1 or all(sum(j**2 for j in t) == i for t in s1)
872.         s2 = set(sum_of_squares(i, 5))
873.         assert all(sum(j**2 for j in t) == i for t in s2)
874. 
875.     raises(ValueError, lambda: list(sum_of_powers(2, -1, 1)))
876.     raises(ValueError, lambda: list(sum_of_powers(2, 1, -1)))
877.     assert list(sum_of_powers(-2, 3, 2)) == [(-1, -1)]
878.     assert list(sum_of_powers(-2, 4, 2)) == []
879.     assert list(sum_of_powers(2, 1, 1)) == [(2,)]
880.     assert list(sum_of_powers(2, 1, 3, True)) == [(0, 0, 2), (0, 1, 1)]
881.     assert list(sum_of_powers(5, 1, 2, True)) == [(0, 5), (1, 4), (2, 3)]
882.     assert list(sum_of_powers(6, 2, 2)) == []
883.     assert list(sum_of_powers(3**5, 3, 1)) == []
884.     assert list(sum_of_powers(3**6, 3, 1)) == [(9,)] and (9**3 == 3**6)
885.     assert list(sum_of_powers(2**1000, 5, 2)) == []
886. 
887. 
888. def test__can_do_sum_of_squares():
889.     assert _can_do_sum_of_squares(3, -1) is False
890.     assert _can_do_sum_of_squares(-3, 1) is False
891.     assert _can_do_sum_of_squares(0, 1)
892.     assert _can_do_sum_of_squares(4, 1)
893.     assert _can_do_sum_of_squares(1, 2)
894.     assert _can_do_sum_of_squares(2, 2)
895.     assert _can_do_sum_of_squares(3, 2) is False
896. 
897. 
898. def test_diophantine_permute_sign():
899.     from sympy.abc import a, b, c, d, e
900.     eq = a**4 + b**4 - (2**4 + 3**4)
901.     base_sol = set([(2, 3)])
902.     assert diophantine(eq) == base_sol
903.     complete_soln = set(signed_permutations(base_sol.pop()))
904.     assert diophantine(eq, permute=True) == complete_soln
905. 
906.     eq = a**2 + b**2 + c**2 + d**2 + e**2 - 234
907.     assert len(diophantine(eq)) == 35
908.     assert len(diophantine(eq, permute=True)) == 62000
909.     soln = set([(-1, -1), (-1, 2), (1, -2), (1, 1)])
910.     assert diophantine(10*x**2 + 12*x*y + 12*y**2 - 34, permute=True) == soln
911. 
912. 
913. @XFAIL
914. def test_not_implemented():
915.     eq = x**2 + y**4 - 1**2 - 3**4
916.     assert diophantine(eq, syms=[x, y]) == set([(9, 1), (1, 3)])
917. 
918. 
919. def test_issue_9538():
920.     eq = x - 3*y + 2
921.     assert diophantine(eq, syms=[y,x]) == set([(t_0, 3*t_0 - 2)])
922.     raises(TypeError, lambda: diophantine(eq, syms=set([y,x])))
923. 
924. 
925. def test_ternary_quadratic():
926.     # solution with 3 parameters
927.     s = diophantine(2*x**2 + y**2 - 2*z**2)
928.     p, q, r = ordered(S(s).free_symbols)
929.     assert s == {(
930.         p**2 - 2*q**2,
931.         -2*p**2 + 4*p*q - 4*p*r - 4*q**2,
932.         p**2 - 4*p*q + 2*q**2 - 4*q*r)}
933.     # solution with Mul in solution
934.     s = diophantine(x**2 + 2*y**2 - 2*z**2)
935.     assert s == {(4*p*q, p**2 - 2*q**2, p**2 + 2*q**2)}
936.     # solution with no Mul in solution
937.     s = diophantine(2*x**2 + 2*y**2 - z**2)
938.     assert s == {(2*p**2 - q**2, -2*p**2 + 4*p*q - q**2,
939.         4*p**2 - 4*p*q + 2*q**2)}
940.     # reduced form when parametrized
941.     s = diophantine(3*x**2 + 72*y**2 - 27*z**2)
942.     assert s == {(24*p**2 - 9*q**2, 6*p*q, 8*p**2 + 3*q**2)}
943.     assert parametrize_ternary_quadratic(
944.         3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z) == (
945.         2*p**2 - 2*p*q - q**2, 2*p**2 + 2*p*q - q**2, 2*p**2 -
946.         2*p*q + 3*q**2)
947.     assert parametrize_ternary_quadratic(
948.         124*x**2 - 30*y**2 - 7729*z**2) == (
949.         -1410*p**2 - 363263*q**2, 2700*p**2 + 30916*p*q -
950.         695610*q**2, -60*p**2 + 5400*p*q + 15458*q**2)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 01:50:32,745 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user wants the content of the file `sympy/solvers/tests/test_diophantine.py` from line 501 to the end.\n   - The provided context starts at line 501 and goes to line 950.\n\n2. Extended relevance:\n   - This entire block of code is exactly what the user requested. It contains various test cases for the `diophantine` function, including those that use the `permute` and `syms` arguments as mentioned in the user's purpose.", relative_path='sympy/solvers/tests/test_diophantine.py', start_line=501, end_line=950)]
2025-12-24 01:50:32,747 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the content of the file sympy/solvers/tests/test_diophantine.py from line 501 to the end.
2025-12-24 01:50:32,747 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 01:50:32,747 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 01:50:32,747 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-24 01:50:32,747 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-24 01:50:32,748 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── documentation-style-guide.rst
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_pyutils.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: diophantine: incomplete results depending on syms order with permute=True

Description: ```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```

diophantine: incomplete results depending on syms order with permute=True
```
In [10]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(m,n), permute=True)
Out[10]: {(-3, -2), (-3, 2), (-2, -3), (-2, 3), (2, -3), (2, 3), (3, -2), (3, 2)}

In [11]: diophantine(n**4 + m**4 - 2**4 - 3**4, syms=(n,m), permute=True)
Out[11]: {(3, 2)}
```


Patch information:
diff --git a/sympy/solvers/diophantine.py b/sympy/solvers/diophantine.py
index 6092e35dab..17b7af56ce 100644
--- a/sympy/solvers/diophantine.py
+++ b/sympy/solvers/diophantine.py
@@ -180,9 +180,11 @@ def diophantine(eq, param=symbols("t", integer=True), syms=None,
                     'syms should be given as a sequence, e.g. a list')
             syms = [i for i in syms if i in var]
             if syms != var:
-                dict_sym_index = dict(zip(syms, range(len(syms))))
-                return {tuple([t[dict_sym_index[i]] for i in var])
-                            for t in diophantine(eq, param)}
+                # build mapping from var symbol to its index in the base solution
+                dict_var_index = dict(zip(var, range(len(var))))
+                # compute solutions with the requested permute setting and reorder to match syms
+                return {tuple([t[dict_var_index[s]] for s in syms])
+                            for t in diophantine(eq, param, permute=permute)}
         n, d = eq.as_numer_denom()
         if n.is_number:
             return set()


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file sympy/solvers/tests/test_diophantine.py.
Extra Requirements: 
Purpose: I need to find 3 relevant existing test cases that demonstrate similar functionality to the reported bug in the diophantine function.

Previous refined query 2:
Essential Query: Please provide the content of the file sympy/solvers/tests/test_diophantine.py from line 501 to the end.
Extra Requirements: 
Purpose: I need the rest of the file to find test cases that use the `syms` and `permute` arguments in the `diophantine` function, which are central to the bug report.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/solvers/tests/test_diophantine.py
Line number range: 1 - 500
Content:
1. from sympy import (Add, Matrix, Mul, S, symbols, Eq, pi, factorint, oo,
2.                    powsimp, Rational)
3. from sympy.core.function import _mexpand
4. from sympy.core.compatibility import range, ordered
5. from sympy.functions.elementary.trigonometric import sin
6. from sympy.solvers.diophantine import (descent, diop_bf_DN, diop_DN,
7.     diop_solve, diophantine, divisible, equivalent, find_DN, ldescent, length,
8.     reconstruct, partition, power_representation,
9.     prime_as_sum_of_two_squares, square_factor, sum_of_four_squares,
10.     sum_of_three_squares, transformation_to_DN, transformation_to_normal,
11.     classify_diop, base_solution_linear, cornacchia, sqf_normal,
12.     diop_ternary_quadratic_normal, _diop_ternary_quadratic_normal,
13.     gaussian_reduce, holzer,diop_general_pythagorean,
14.     _diop_general_sum_of_squares, _nint_or_floor, _odd, _even,
15.     _remove_gcd, check_param, parametrize_ternary_quadratic,
16.     diop_ternary_quadratic, diop_linear, diop_quadratic,
17.     diop_general_sum_of_squares, sum_of_powers, sum_of_squares,
18.     diop_general_sum_of_even_powers, _can_do_sum_of_squares)
19. from sympy.utilities import default_sort_key
20. 
21. from sympy.utilities.pytest import slow, raises, XFAIL
22. from sympy.utilities.iterables import (
23.         signed_permutations)
24. 
25. a, b, c, d, p, q, x, y, z, w, t, u, v, X, Y, Z = symbols(
26.     "a, b, c, d, p, q, x, y, z, w, t, u, v, X, Y, Z", integer=True)
27. t_0, t_1, t_2, t_3, t_4, t_5, t_6 = symbols("t_:7", integer=True)
28. m1, m2, m3 = symbols('m1:4', integer=True)
29. n1 = symbols('n1', integer=True)
30. 
31. 
32. def diop_simplify(eq):
33.     return _mexpand(powsimp(_mexpand(eq)))
34. 
35. 
36. def test_input_format():
37.     raises(TypeError, lambda: diophantine(sin(x)))
38.     raises(TypeError, lambda: diophantine(3))
39.     raises(TypeError, lambda: diophantine(x/pi - 3))
40. 
41. 
42. def test_univariate():
43.     assert diop_solve((x - 1)*(x - 2)**2) == set([(1,), (2,)])
44.     assert diop_solve((x - 1)*(x - 2)) == set([(1,), (2,)])
45. 
46. 
47. def test_classify_diop():
48.     raises(TypeError, lambda: classify_diop(x**2/3 - 1))
49.     raises(ValueError, lambda: classify_diop(1))
50.     raises(NotImplementedError, lambda: classify_diop(w*x*y*z - 1))
51.     raises(NotImplementedError, lambda: classify_diop(x**3 + y**3 + z**4 - 90))
52.     assert classify_diop(14*x**2 + 15*x - 42) == (
53.         [x], {1: -42, x: 15, x**2: 14}, 'univariate')
54.     assert classify_diop(x*y + z) == (
55.         [x, y, z], {x*y: 1, z: 1}, 'inhomogeneous_ternary_quadratic')
56.     assert classify_diop(x*y + z + w + x**2) == (
57.         [w, x, y, z], {x*y: 1, w: 1, x**2: 1, z: 1}, 'inhomogeneous_general_quadratic')
58.     assert classify_diop(x*y + x*z + x**2 + 1) == (
59.         [x, y, z], {x*y: 1, x*z: 1, x**2: 1, 1: 1}, 'inhomogeneous_general_quadratic')
60.     assert classify_diop(x*y + z + w + 42) == (
61.         [w, x, y, z], {x*y: 1, w: 1, 1: 42, z: 1}, 'inhomogeneous_general_quadratic')
62.     assert classify_diop(x*y + z*w) == (
63.         [w, x, y, z], {x*y: 1, w*z: 1}, 'homogeneous_general_quadratic')
64.     assert classify_diop(x*y**2 + 1) == (
65.         [x, y], {x*y**2: 1, 1: 1}, 'cubic_thue')
66.     assert classify_diop(x**4 + y**4 + z**4 - (1 + 16 + 81)) == (
67.         [x, y, z], {1: -98, x**4: 1, z**4: 1, y**4: 1}, 'general_sum_of_even_powers')
68. 
69. 
70. def test_linear():
71.     assert diop_solve(x) == (0,)
72.     assert diop_solve(1*x) == (0,)
73.     assert diop_solve(3*x) == (0,)
74.     assert diop_solve(x + 1) == (-1,)
75.     assert diop_solve(2*x + 1) == (None,)
76.     assert diop_solve(2*x + 4) == (-2,)
77.     assert diop_solve(y + x) == (t_0, -t_0)
78.     assert diop_solve(y + x + 0) == (t_0, -t_0)
79.     assert diop_solve(y + x - 0) == (t_0, -t_0)
80.     assert diop_solve(0*x - y - 5) == (-5,)
81.     assert diop_solve(3*y + 2*x - 5) == (3*t_0 - 5, -2*t_0 + 5)
82.     assert diop_solve(2*x - 3*y - 5) == (3*t_0 - 5, 2*t_0 - 5)
83.     assert diop_solve(-2*x - 3*y - 5) == (3*t_0 + 5, -2*t_0 - 5)
84.     assert diop_solve(7*x + 5*y) == (5*t_0, -7*t_0)
85.     assert diop_solve(2*x + 4*y) == (2*t_0, -t_0)
86.     assert diop_solve(4*x + 6*y - 4) == (3*t_0 - 2, -2*t_0 + 2)
87.     assert diop_solve(4*x + 6*y - 3) == (None, None)
88.     assert diop_solve(0*x + 3*y - 4*z + 5) == (4*t_0 + 5, 3*t_0 + 5)
89.     assert diop_solve(4*x + 3*y - 4*z + 5) == (t_0, 8*t_0 + 4*t_1 + 5, 7*t_0 + 3*t_1 + 5)
90.     assert diop_solve(4*x + 3*y - 4*z + 5, None) == (0, 5, 5)
91.     assert diop_solve(4*x + 2*y + 8*z - 5) == (None, None, None)
92.     assert diop_solve(5*x + 7*y - 2*z - 6) == (t_0, -3*t_0 + 2*t_1 + 6, -8*t_0 + 7*t_1 + 18)
93.     assert diop_solve(3*x - 6*y + 12*z - 9) == (2*t_0 + 3, t_0 + 2*t_1, t_1)
94.     assert diop_solve(6*w + 9*x + 20*y - z) == (t_0, t_1, t_1 + t_2, 6*t_0 + 29*t_1 + 20*t_2)
95. 
96.     # to ignore constant factors, use diophantine
97.     raises(TypeError, lambda: diop_solve(x/2))
98. 
99. 
100. def test_quadratic_simple_hyperbolic_case():
101.     # Simple Hyperbolic case: A = C = 0 and B != 0
102.     assert diop_solve(3*x*y + 34*x - 12*y + 1) == \
103.         set([(-133, -11), (5, -57)])
104.     assert diop_solve(6*x*y + 2*x + 3*y + 1) == set([])
105.     assert diop_solve(-13*x*y + 2*x - 4*y - 54) == set([(27, 0)])
106.     assert diop_solve(-27*x*y - 30*x - 12*y - 54) == set([(-14, -1)])
107.     assert diop_solve(2*x*y + 5*x + 56*y + 7) == set([(-161, -3),\
108.         (-47,-6), (-35, -12), (-29, -69),\
109.         (-27, 64), (-21, 7),(-9, 1),\
110.         (105, -2)])
111.     assert diop_solve(6*x*y + 9*x + 2*y + 3) == set([])
112.     assert diop_solve(x*y + x + y + 1) == set([(-1, t), (t, -1)])
113.     assert diophantine(48*x*y)
114. 
115. 
116. def test_quadratic_elliptical_case():
117.     # Elliptical case: B**2 - 4AC < 0
118.     # Two test cases highlighted require lot of memory due to quadratic_congruence() method.
119.     # This above method should be replaced by Pernici's square_mod() method when his PR gets merged.
120. 
121.     #assert diop_solve(42*x**2 + 8*x*y + 15*y**2 + 23*x + 17*y - 4915) == set([(-11, -1)])
122.     assert diop_solve(4*x**2 + 3*y**2 + 5*x - 11*y + 12) == set([])
123.     assert diop_solve(x**2 + y**2 + 2*x + 2*y + 2) == set([(-1, -1)])
124.     #assert diop_solve(15*x**2 - 9*x*y + 14*y**2 - 23*x - 14*y - 4950) == set([(-15, 6)])
125.     assert diop_solve(10*x**2 + 12*x*y + 12*y**2 - 34) == \
126.         set([(-1, -1), (-1, 2), (1, -2), (1, 1)])
127. 
128. 
129. def test_quadratic_parabolic_case():
130.     # Parabolic case: B**2 - 4AC = 0
131.     assert check_solutions(8*x**2 - 24*x*y + 18*y**2 + 5*x + 7*y + 16)
132.     assert check_solutions(8*x**2 - 24*x*y + 18*y**2 + 6*x + 12*y - 6)
133.     assert check_solutions(8*x**2 + 24*x*y + 18*y**2 + 4*x + 6*y - 7)
134.     assert check_solutions(-4*x**2 + 4*x*y - y**2 + 2*x - 3)
135.     assert check_solutions(x**2 + 2*x*y + y**2 + 2*x + 2*y + 1)
136.     assert check_solutions(x**2 - 2*x*y + y**2 + 2*x + 2*y + 1)
137.     assert check_solutions(y**2 - 41*x + 40)
138. 
139. 
140. def test_quadratic_perfect_square():
141.     # B**2 - 4*A*C > 0
142.     # B**2 - 4*A*C is a perfect square
143.     assert check_solutions(48*x*y)
144.     assert check_solutions(4*x**2 - 5*x*y + y**2 + 2)
145.     assert check_solutions(-2*x**2 - 3*x*y + 2*y**2 -2*x - 17*y + 25)
146.     assert check_solutions(12*x**2 + 13*x*y + 3*y**2 - 2*x + 3*y - 12)
147.     assert check_solutions(8*x**2 + 10*x*y + 2*y**2 - 32*x - 13*y - 23)
148.     assert check_solutions(4*x**2 - 4*x*y - 3*y- 8*x - 3)
149.     assert check_solutions(- 4*x*y - 4*y**2 - 3*y- 5*x - 10)
150.     assert check_solutions(x**2 - y**2 - 2*x - 2*y)
151.     assert check_solutions(x**2 - 9*y**2 - 2*x - 6*y)
152.     assert check_solutions(4*x**2 - 9*y**2 - 4*x - 12*y - 3)
153. 
154. 
155. def test_quadratic_non_perfect_square():
156.     # B**2 - 4*A*C is not a perfect square
157.     # Used check_solutions() since the solutions are complex expressions involving
158.     # square roots and exponents
159.     assert check_solutions(x**2 - 2*x - 5*y**2)
160.     assert check_solutions(3*x**2 - 2*y**2 - 2*x - 2*y)
161.     assert check_solutions(x**2 - x*y - y**2 - 3*y)
162.     assert check_solutions(x**2 - 9*y**2 - 2*x - 6*y)
163. 
164. 
165. def test_issue_9106():
166.     eq = -48 - 2*x*(3*x - 1) + y*(3*y - 1)
167.     v = (x, y)
168.     for sol in diophantine(eq):
169.         assert not diop_simplify(eq.xreplace(dict(zip(v, sol))))
170. 
171. 
172. def test_issue_18138():
173.     eq = x**2 - x - y**2
174.     v = (x, y)
175.     for sol in diophantine(eq):
176.         assert not diop_simplify(eq.xreplace(dict(zip(v, sol))))
177. 
178. 
179. @slow
180. def test_quadratic_non_perfect_slow():
181.     assert check_solutions(8*x**2 + 10*x*y - 2*y**2 - 32*x - 13*y - 23)
182.     # This leads to very large numbers.
183.     # assert check_solutions(5*x**2 - 13*x*y + y**2 - 4*x - 4*y - 15)
184.     assert check_solutions(-3*x**2 - 2*x*y + 7*y**2 - 5*x - 7)
185.     assert check_solutions(-4 - x + 4*x**2 - y - 3*x*y - 4*y**2)
186.     assert check_solutions(1 + 2*x + 2*x**2 + 2*y + x*y - 2*y**2)
187. 
188. 
189. def test_DN():
190.     # Most of the test cases were adapted from,
191.     # Solving the generalized Pell equation x**2 - D*y**2 = N, John P. Robertson, July 31, 2004.
192.     # http://www.jpr2718.org/pell.pdf
193.     # others are verified using Wolfram Alpha.
194. 
195.     # Covers cases where D <= 0 or D > 0 and D is a square or N = 0
196.     # Solutions are straightforward in these cases.
197.     assert diop_DN(3, 0) == [(0, 0)]
198.     assert diop_DN(-17, -5) == []
199.     assert diop_DN(-19, 23) == [(2, 1)]
200.     assert diop_DN(-13, 17) == [(2, 1)]
201.     assert diop_DN(-15, 13) == []
202.     assert diop_DN(0, 5) == []
203.     assert diop_DN(0, 9) == [(3, t)]
204.     assert diop_DN(9, 0) == [(3*t, t)]
205.     assert diop_DN(16, 24) == []
206.     assert diop_DN(9, 180) == [(18, 4)]
207.     assert diop_DN(9, -180) == [(12, 6)]
208.     assert diop_DN(7, 0) == [(0, 0)]
209. 
210.     # When equation is x**2 + y**2 = N
211.     # Solutions are interchangeable
212.     assert diop_DN(-1, 5) == [(2, 1), (1, 2)]
213.     assert diop_DN(-1, 169) == [(12, 5), (5, 12), (13, 0), (0, 13)]
214. 
215.     # D > 0 and D is not a square
216. 
217.     # N = 1
218.     assert diop_DN(13, 1) == [(649, 180)]
219.     assert diop_DN(980, 1) == [(51841, 1656)]
220.     assert diop_DN(981, 1) == [(158070671986249, 5046808151700)]
221.     assert diop_DN(986, 1) == [(49299, 1570)]
222.     assert diop_DN(991, 1) == [(379516400906811930638014896080, 12055735790331359447442538767)]
223.     assert diop_DN(17, 1) == [(33, 8)]
224.     assert diop_DN(19, 1) == [(170, 39)]
225. 
226.     # N = -1
227.     assert diop_DN(13, -1) == [(18, 5)]
228.     assert diop_DN(991, -1) == []
229.     assert diop_DN(41, -1) == [(32, 5)]
230.     assert diop_DN(290, -1) == [(17, 1)]
231.     assert diop_DN(21257, -1) == [(13913102721304, 95427381109)]
232.     assert diop_DN(32, -1) == []
233. 
234.     # |N| > 1
235.     # Some tests were created using calculator at
236.     # http://www.numbertheory.org/php/patz.html
237. 
238.     assert diop_DN(13, -4) == [(3, 1), (393, 109), (36, 10)]
239.     # Source I referred returned (3, 1), (393, 109) and (-3, 1) as fundamental solutions
240.     # So (-3, 1) and (393, 109) should be in the same equivalent class
241.     assert equivalent(-3, 1, 393, 109, 13, -4) == True
242. 
243.     assert diop_DN(13, 27) == [(220, 61), (40, 11), (768, 213), (12, 3)]
244.     assert set(diop_DN(157, 12)) == \
245.     set([(13, 1), (10663, 851), (579160, 46222), \
246.         (483790960,38610722), (26277068347, 2097138361), (21950079635497, 1751807067011)])
247.     assert diop_DN(13, 25) == [(3245, 900)]
248.     assert diop_DN(192, 18) == []
249.     assert diop_DN(23, 13) == [(-6, 1), (6, 1)]
250.     assert diop_DN(167, 2) == [(13, 1)]
251.     assert diop_DN(167, -2) == []
252. 
253.     assert diop_DN(123, -2) == [(11, 1)]
254.     # One calculator returned [(11, 1), (-11, 1)] but both of these are in
255.     # the same equivalence class
256.     assert equivalent(11, 1, -11, 1, 123, -2)
257. 
258.     assert diop_DN(123, -23) == [(-10, 1), (10, 1)]
259. 
260.     assert diop_DN(0, 0, t) == [(0, t)]
261.     assert diop_DN(0, -1, t) == []
262. 
263. 
264. def test_bf_pell():
265.     assert diop_bf_DN(13, -4) == [(3, 1), (-3, 1), (36, 10)]
266.     assert diop_bf_DN(13, 27) == [(12, 3), (-12, 3), (40, 11), (-40, 11)]
267.     assert diop_bf_DN(167, -2) == []
268.     assert diop_bf_DN(1729, 1) == [(44611924489705, 1072885712316)]
269.     assert diop_bf_DN(89, -8) == [(9, 1), (-9, 1)]
270.     assert diop_bf_DN(21257, -1) == [(13913102721304, 95427381109)]
271.     assert diop_bf_DN(340, -4) == [(756, 41)]
272.     assert diop_bf_DN(-1, 0, t) == [(0, 0)]
273.     assert diop_bf_DN(0, 0, t) == [(0, t)]
274.     assert diop_bf_DN(4, 0, t) == [(2*t, t), (-2*t, t)]
275.     assert diop_bf_DN(3, 0, t) == [(0, 0)]
276.     assert diop_bf_DN(1, -2, t) == []
277. 
278. 
279. def test_length():
280.     assert length(2, 1, 0) == 1
281.     assert length(-2, 4, 5) == 3
282.     assert length(-5, 4, 17) == 4
283.     assert length(0, 4, 13) == 6
284.     assert length(7, 13, 11) == 23
285.     assert length(1, 6, 4) == 2
286. 
287. 
288. def is_pell_transformation_ok(eq):
289.     """
290.     Test whether X*Y, X, or Y terms are present in the equation
291.     after transforming the equation using the transformation returned
292.     by transformation_to_pell(). If they are not present we are good.
293.     Moreover, coefficient of X**2 should be a divisor of coefficient of
294.     Y**2 and the constant term.
295.     """
296.     A, B = transformation_to_DN(eq)
297.     u = (A*Matrix([X, Y]) + B)[0]
298.     v = (A*Matrix([X, Y]) + B)[1]
299.     simplified = diop_simplify(eq.subs(zip((x, y), (u, v))))
300. 
301.     coeff = dict([reversed(t.as_independent(*[X, Y])) for t in simplified.args])
302. 
303.     for term in [X*Y, X, Y]:
304.         if term in coeff.keys():
305.             return False
306. 
307.     for term in [X**2, Y**2, 1]:
308.         if term not in coeff.keys():
309.             coeff[term] = 0
310. 
311.     if coeff[X**2] != 0:
312.         return divisible(coeff[Y**2], coeff[X**2]) and \
313.         divisible(coeff[1], coeff[X**2])
314. 
315.     return True
316. 
317. 
318. def test_transformation_to_pell():
319.     assert is_pell_transformation_ok(-13*x**2 - 7*x*y + y**2 + 2*x - 2*y - 14)
320.     assert is_pell_transformation_ok(-17*x**2 + 19*x*y - 7*y**2 - 5*x - 13*y - 23)
321.     assert is_pell_transformation_ok(x**2 - y**2 + 17)
322.     assert is_pell_transformation_ok(-x**2 + 7*y**2 - 23)
323.     assert is_pell_transformation_ok(25*x**2 - 45*x*y + 5*y**2 - 5*x - 10*y + 5)
324.     assert is_pell_transformation_ok(190*x**2 + 30*x*y + y**2 - 3*y - 170*x - 130)
325.     assert is_pell_transformation_ok(x**2 - 2*x*y -190*y**2 - 7*y - 23*x - 89)
326.     assert is_pell_transformation_ok(15*x**2 - 9*x*y + 14*y**2 - 23*x - 14*y - 4950)
327. 
328. 
329. def test_find_DN():
330.     assert find_DN(x**2 - 2*x - y**2) == (1, 1)
331.     assert find_DN(x**2 - 3*y**2 - 5) == (3, 5)
332.     assert find_DN(x**2 - 2*x*y - 4*y**2 - 7) == (5, 7)
333.     assert find_DN(4*x**2 - 8*x*y - y**2 - 9) == (20, 36)
334.     assert find_DN(7*x**2 - 2*x*y - y**2 - 12) == (8, 84)
335.     assert find_DN(-3*x**2 + 4*x*y -y**2) == (1, 0)
336.     assert find_DN(-13*x**2 - 7*x*y + y**2 + 2*x - 2*y -14) == (101, -7825480)
337. 
338. 
339. def test_ldescent():
340.     # Equations which have solutions
341.     u = ([(13, 23), (3, -11), (41, -113), (4, -7), (-7, 4), (91, -3), (1, 1), (1, -1),
342.         (4, 32), (17, 13), (123689, 1), (19, -570)])
343.     for a, b in u:
344.         w, x, y = ldescent(a, b)
345.         assert a*x**2 + b*y**2 == w**2
346.     assert ldescent(-1, -1) is None
347. 
348. 
349. def test_diop_ternary_quadratic_normal():
350.     assert check_solutions(234*x**2 - 65601*y**2 - z**2)
351.     assert check_solutions(23*x**2 + 616*y**2 - z**2)
352.     assert check_solutions(5*x**2 + 4*y**2 - z**2)
353.     assert check_solutions(3*x**2 + 6*y**2 - 3*z**2)
354.     assert check_solutions(x**2 + 3*y**2 - z**2)
355.     assert check_solutions(4*x**2 + 5*y**2 - z**2)
356.     assert check_solutions(x**2 + y**2 - z**2)
357.     assert check_solutions(16*x**2 + y**2 - 25*z**2)
358.     assert check_solutions(6*x**2 - y**2 + 10*z**2)
359.     assert check_solutions(213*x**2 + 12*y**2 - 9*z**2)
360.     assert check_solutions(34*x**2 - 3*y**2 - 301*z**2)
361.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
362. 
363. 
364. def is_normal_transformation_ok(eq):
365.     A = transformation_to_normal(eq)
366.     X, Y, Z = A*Matrix([x, y, z])
367.     simplified = diop_simplify(eq.subs(zip((x, y, z), (X, Y, Z))))
368. 
369.     coeff = dict([reversed(t.as_independent(*[X, Y, Z])) for t in simplified.args])
370.     for term in [X*Y, Y*Z, X*Z]:
371.         if term in coeff.keys():
372.             return False
373. 
374.     return True
375. 
376. 
377. def test_transformation_to_normal():
378.     assert is_normal_transformation_ok(x**2 + 3*y**2 + z**2 - 13*x*y - 16*y*z + 12*x*z)
379.     assert is_normal_transformation_ok(x**2 + 3*y**2 - 100*z**2)
380.     assert is_normal_transformation_ok(x**2 + 23*y*z)
381.     assert is_normal_transformation_ok(3*y**2 - 100*z**2 - 12*x*y)
382.     assert is_normal_transformation_ok(x**2 + 23*x*y - 34*y*z + 12*x*z)
383.     assert is_normal_transformation_ok(z**2 + 34*x*y - 23*y*z + x*z)
384.     assert is_normal_transformation_ok(x**2 + y**2 + z**2 - x*y - y*z - x*z)
385.     assert is_normal_transformation_ok(x**2 + 2*y*z + 3*z**2)
386.     assert is_normal_transformation_ok(x*y + 2*x*z + 3*y*z)
387.     assert is_normal_transformation_ok(2*x*z + 3*y*z)
388. 
389. 
390. def test_diop_ternary_quadratic():
391.     assert check_solutions(2*x**2 + z**2 + y**2 - 4*x*y)
392.     assert check_solutions(x**2 - y**2 - z**2 - x*y - y*z)
393.     assert check_solutions(3*x**2 - x*y - y*z - x*z)
394.     assert check_solutions(x**2 - y*z - x*z)
395.     assert check_solutions(5*x**2 - 3*x*y - x*z)
396.     assert check_solutions(4*x**2 - 5*y**2 - x*z)
397.     assert check_solutions(3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z)
398.     assert check_solutions(8*x**2 - 12*y*z)
399.     assert check_solutions(45*x**2 - 7*y**2 - 8*x*y - z**2)
400.     assert check_solutions(x**2 - 49*y**2 - z**2 + 13*z*y -8*x*y)
401.     assert check_solutions(90*x**2 + 3*y**2 + 5*x*y + 2*z*y + 5*x*z)
402.     assert check_solutions(x**2 + 3*y**2 + z**2 - x*y - 17*y*z)
403.     assert check_solutions(x**2 + 3*y**2 + z**2 - x*y - 16*y*z + 12*x*z)
404.     assert check_solutions(x**2 + 3*y**2 + z**2 - 13*x*y - 16*y*z + 12*x*z)
405.     assert check_solutions(x*y - 7*y*z + 13*x*z)
406. 
407.     assert diop_ternary_quadratic_normal(x**2 + y**2 + z**2) == (None, None, None)
408.     assert diop_ternary_quadratic_normal(x**2 + y**2) is None
409.     raises(ValueError, lambda:
410.         _diop_ternary_quadratic_normal((x, y, z),
411.         {x*y: 1, x**2: 2, y**2: 3, z**2: 0}))
412.     eq = -2*x*y - 6*x*z + 7*y**2 - 3*y*z + 4*z**2
413.     assert diop_ternary_quadratic(eq) == (7, 2, 0)
414.     assert diop_ternary_quadratic_normal(4*x**2 + 5*y**2 - z**2) == \
415.         (1, 0, 2)
416.     assert diop_ternary_quadratic(x*y + 2*y*z) == \
417.         (-2, 0, n1)
418.     eq = -5*x*y - 8*x*z - 3*y*z + 8*z**2
419.     assert parametrize_ternary_quadratic(eq) == \
420.         (8*p**2 - 3*p*q, -8*p*q + 8*q**2, 5*p*q)
421.     # this cannot be tested with diophantine because it will
422.     # factor into a product
423.     assert diop_solve(x*y + 2*y*z) == (-2*p*q, -n1*p**2 + p**2, p*q)
424. 
425. 
426. def test_square_factor():
427.     assert square_factor(1) == square_factor(-1) == 1
428.     assert square_factor(0) == 1
429.     assert square_factor(5) == square_factor(-5) == 1
430.     assert square_factor(4) == square_factor(-4) == 2
431.     assert square_factor(12) == square_factor(-12) == 2
432.     assert square_factor(6) == 1
433.     assert square_factor(18) == 3
434.     assert square_factor(52) == 2
435.     assert square_factor(49) == 7
436.     assert square_factor(392) == 14
437.     assert square_factor(factorint(-12)) == 2
438. 
439. 
440. def test_parametrize_ternary_quadratic():
441.     assert check_solutions(x**2 + y**2 - z**2)
442.     assert check_solutions(x**2 + 2*x*y + z**2)
443.     assert check_solutions(234*x**2 - 65601*y**2 - z**2)
444.     assert check_solutions(3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z)
445.     assert check_solutions(x**2 - y**2 - z**2)
446.     assert check_solutions(x**2 - 49*y**2 - z**2 + 13*z*y - 8*x*y)
447.     assert check_solutions(8*x*y + z**2)
448.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
449.     assert check_solutions(236*x**2 - 225*y**2 - 11*x*y - 13*y*z - 17*x*z)
450.     assert check_solutions(90*x**2 + 3*y**2 + 5*x*y + 2*z*y + 5*x*z)
451.     assert check_solutions(124*x**2 - 30*y**2 - 7729*z**2)
452. 
453. 
454. def test_no_square_ternary_quadratic():
455.     assert check_solutions(2*x*y + y*z - 3*x*z)
456.     assert check_solutions(189*x*y - 345*y*z - 12*x*z)
457.     assert check_solutions(23*x*y + 34*y*z)
458.     assert check_solutions(x*y + y*z + z*x)
459.     assert check_solutions(23*x*y + 23*y*z + 23*x*z)
460. 
461. 
462. def test_descent():
463. 
464.     u = ([(13, 23), (3, -11), (41, -113), (91, -3), (1, 1), (1, -1), (17, 13), (123689, 1), (19, -570)])
465.     for a, b in u:
466.         w, x, y = descent(a, b)
467.         assert a*x**2 + b*y**2 == w**2
468.     # the docstring warns against bad input, so these are expected results
469.     # - can't both be negative
470.     raises(TypeError, lambda: descent(-1, -3))
471.     # A can't be zero unless B != 1
472.     raises(ZeroDivisionError, lambda: descent(0, 3))
473.     # supposed to be square-free
474.     raises(TypeError, lambda: descent(4, 3))
475. 
476. 
477. def test_diophantine():
478.     assert check_solutions((x - y)*(y - z)*(z - x))
479.     assert check_solutions((x - y)*(x**2 + y**2 - z**2))
480.     assert check_solutions((x - 3*y + 7*z)*(x**2 + y**2 - z**2))
481.     assert check_solutions((x**2 - 3*y**2 - 1))
482.     assert check_solutions(y**2 + 7*x*y)
483.     assert check_solutions(x**2 - 3*x*y + y**2)
484.     assert check_solutions(z*(x**2 - y**2 - 15))
485.     assert check_solutions(x*(2*y - 2*z + 5))
486.     assert check_solutions((x**2 - 3*y**2 - 1)*(x**2 - y**2 - 15))
487.     assert check_solutions((x**2 - 3*y**2 - 1)*(y - 7*z))
488.     assert check_solutions((x**2 + y**2 - z**2)*(x - 7*y - 3*z + 4*w))
489.     # Following test case caused problems in parametric representation
490.     # But this can be solved by factroing out y.
491.     # No need to use methods for ternary quadratic equations.
492.     assert check_solutions(y**2 - 7*x*y + 4*y*z)
493.     assert check_solutions(x**2 - 2*x + 1)
494. 
495.     assert diophantine(x - y) == diophantine(Eq(x, y))
496.     assert diophantine(3*x*pi - 2*y*pi) == set([(2*t_0, 3*t_0)])
497.     eq = x**2 + y**2 + z**2 - 14
498.     base_sol = set([(1, 2, 3)])
499.     assert diophantine(eq) == base_sol
500.     complete_soln = set(signed_permutations(base_sol.pop()))


File: sympy/solvers/tests/test_diophantine.py
Line number range: 501 - 950
Content:
501.     assert diophantine(eq, permute=True) == complete_soln
502. 
503.     assert diophantine(x**2 + x*Rational(15, 14) - 3) == set()
504.     # test issue 11049
505.     eq = 92*x**2 - 99*y**2 - z**2
506.     coeff = eq.as_coefficients_dict()
507.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
508.         (9, 7, 51)
509.     assert diophantine(eq) == set([(
510.         891*p**2 + 9*q**2, -693*p**2 - 102*p*q + 7*q**2,
511.         5049*p**2 - 1386*p*q - 51*q**2)])
512.     eq = 2*x**2 + 2*y**2 - z**2
513.     coeff = eq.as_coefficients_dict()
514.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
515.         (1, 1, 2)
516.     assert diophantine(eq) == set([(
517.         2*p**2 - q**2, -2*p**2 + 4*p*q - q**2,
518.         4*p**2 - 4*p*q + 2*q**2)])
519.     eq = 411*x**2+57*y**2-221*z**2
520.     coeff = eq.as_coefficients_dict()
521.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
522.         (2021, 2645, 3066)
523.     assert diophantine(eq) == \
524.         set([(115197*p**2 - 446641*q**2, -150765*p**2 + 1355172*p*q -
525.         584545*q**2, 174762*p**2 - 301530*p*q + 677586*q**2)])
526.     eq = 573*x**2+267*y**2-984*z**2
527.     coeff = eq.as_coefficients_dict()
528.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
529.         (49, 233, 127)
530.     assert diophantine(eq) == \
531.         set([(4361*p**2 - 16072*q**2, -20737*p**2 + 83312*p*q - 76424*q**2,
532.         11303*p**2 - 41474*p*q + 41656*q**2)])
533.     # this produces factors during reconstruction
534.     eq = x**2 + 3*y**2 - 12*z**2
535.     coeff = eq.as_coefficients_dict()
536.     assert _diop_ternary_quadratic_normal((x, y, z), coeff) == \
537.         (0, 2, 1)
538.     assert diophantine(eq) == \
539.         set([(24*p*q, 2*p**2 - 24*q**2, p**2 + 12*q**2)])
540.     # solvers have not been written for every type
541.     raises(NotImplementedError, lambda: diophantine(x*y**2 + 1))
542. 
543.     # rational expressions
544.     assert diophantine(1/x) == set()
545.     assert diophantine(1/x + 1/y - S.Half)
546.     set([(6, 3), (-2, 1), (4, 4), (1, -2), (3, 6)])
547.     assert diophantine(x**2 + y**2 +3*x- 5, permute=True) == \
548.         set([(-1, 1), (-4, -1), (1, -1), (1, 1), (-4, 1), (-1, -1), (4, 1), (4, -1)])
549. 
550.     # issue 18122
551.     assert check_solutions(x**2-y)
552.     assert check_solutions(y**2-x)
553.     assert diophantine((x**2-y), t) == set([(t, t**2)])
554.     assert diophantine((y**2-x), t) == set([(t**2, -t)])
555. 
556. 
557. def test_general_pythagorean():
558.     from sympy.abc import a, b, c, d, e
559. 
560.     assert check_solutions(a**2 + b**2 + c**2 - d**2)
561.     assert check_solutions(a**2 + 4*b**2 + 4*c**2 - d**2)
562.     assert check_solutions(9*a**2 + 4*b**2 + 4*c**2 - d**2)
563.     assert check_solutions(9*a**2 + 4*b**2 - 25*d**2 + 4*c**2 )
564.     assert check_solutions(9*a**2 - 16*d**2 + 4*b**2 + 4*c**2)
565.     assert check_solutions(-e**2 + 9*a**2 + 4*b**2 + 4*c**2 + 25*d**2)
566.     assert check_solutions(16*a**2 - b**2 + 9*c**2 + d**2 + 25*e**2)
567. 
568. 
569. def test_diop_general_sum_of_squares_quick():
570.     for i in range(3, 10):
571.         assert check_solutions(sum(i**2 for i in symbols(':%i' % i)) - i)
572.     raises(ValueError, lambda: _diop_general_sum_of_squares((x, y), 2))
573.     assert _diop_general_sum_of_squares((x, y, z), -2) == set()
574.     eq = x**2 + y**2 + z**2 - (1 + 4 + 9)
575.     assert diop_general_sum_of_squares(eq) == \
576.         set([(1, 2, 3)])
577.     eq = u**2 + v**2 + x**2 + y**2 + z**2 - 1313
578.     assert len(diop_general_sum_of_squares(eq, 3)) == 3
579.     # issue 11016
580.     var = symbols(':5') + (symbols('6', negative=True),)
581.     eq = Add(*[i**2 for i in var]) - 112
582. 
583.     base_soln = set(
584.         [(0, 1, 1, 5, 6, -7), (1, 1, 1, 3, 6, -8), (2, 3, 3, 4, 5, -7),
585.             (0, 1, 1, 1, 3, -10), (0, 0, 4, 4, 4, -8), (1, 2, 3, 3, 5, -8),
586.             (0, 1, 2, 3, 7, -7), (2, 2, 4, 4, 6, -6), (1, 1, 3, 4, 6, -7),
587.             (0, 2, 3, 3, 3, -9), (0, 0, 2, 2, 2, -10), (1, 1, 2, 3, 4, -9),
588.             (0, 1, 1, 2, 5, -9), (0, 0, 2, 6, 6, -6), (1, 3, 4, 5, 5, -6),
589.             (0, 2, 2, 2, 6, -8), (0, 3, 3, 3, 6, -7), (0, 2, 3, 5, 5, -7),
590.             (0, 1, 5, 5, 5, -6)])
591.     assert diophantine(eq) == base_soln
592.     assert len(diophantine(eq, permute=True)) == 196800
593. 
594.     # handle negated squares with signsimp
595.     assert diophantine(12 - x**2 - y**2 - z**2) == set([(2, 2, 2)])
596.     # diophantine handles simplification, so classify_diop should
597.     # not have to look for additional patterns that are removed
598.     # by diophantine
599.     eq = a**2 + b**2 + c**2 + d**2 - 4
600.     raises(NotImplementedError, lambda: classify_diop(-eq))
601. 
602. 
603. def test_diop_partition():
604.     for n in [8, 10]:
605.         for k in range(1, 8):
606.             for p in partition(n, k):
607.                 assert len(p) == k
608.     assert [p for p in partition(3, 5)] == []
609.     assert [list(p) for p in partition(3, 5, 1)] == [
610.         [0, 0, 0, 0, 3], [0, 0, 0, 1, 2], [0, 0, 1, 1, 1]]
611.     assert list(partition(0)) == [()]
612.     assert list(partition(1, 0)) == [()]
613.     assert [list(i) for i in partition(3)] == [[1, 1, 1], [1, 2], [3]]
614. 
615. 
616. def test_prime_as_sum_of_two_squares():
617.     for i in [5, 13, 17, 29, 37, 41, 2341, 3557, 34841, 64601]:
618.         a, b = prime_as_sum_of_two_squares(i)
619.         assert a**2 + b**2 == i
620.     assert prime_as_sum_of_two_squares(7) is None
621.     ans = prime_as_sum_of_two_squares(800029)
622.     assert ans == (450, 773) and type(ans[0]) is int
623. 
624. 
625. def test_sum_of_three_squares():
626.     for i in [0, 1, 2, 34, 123, 34304595905, 34304595905394941, 343045959052344,
627.               800, 801, 802, 803, 804, 805, 806]:
628.         a, b, c = sum_of_three_squares(i)
629.         assert a**2 + b**2 + c**2 == i
630. 
631.     assert sum_of_three_squares(7) is None
632.     assert sum_of_three_squares((4**5)*15) is None
633.     assert sum_of_three_squares(25) == (5, 0, 0)
634.     assert sum_of_three_squares(4) == (0, 0, 2)
635. 
636. 
637. def test_sum_of_four_squares():
638.     from random import randint
639. 
640.     # this should never fail
641.     n = randint(1, 100000000000000)
642.     assert sum(i**2 for i in sum_of_four_squares(n)) == n
643. 
644.     assert sum_of_four_squares(0) == (0, 0, 0, 0)
645.     assert sum_of_four_squares(14) == (0, 1, 2, 3)
646.     assert sum_of_four_squares(15) == (1, 1, 2, 3)
647.     assert sum_of_four_squares(18) == (1, 2, 2, 3)
648.     assert sum_of_four_squares(19) == (0, 1, 3, 3)
649.     assert sum_of_four_squares(48) == (0, 4, 4, 4)
650. 
651. 
652. def test_power_representation():
653.     tests = [(1729, 3, 2), (234, 2, 4), (2, 1, 2), (3, 1, 3), (5, 2, 2), (12352, 2, 4),
654.              (32760, 2, 3)]
655. 
656.     for test in tests:
657.         n, p, k = test
658.         f = power_representation(n, p, k)
659. 
660.         while True:
661.             try:
662.                 l = next(f)
663.                 assert len(l) == k
664. 
665.                 chk_sum = 0
666.                 for l_i in l:
667.                     chk_sum = chk_sum + l_i**p
668.                 assert chk_sum == n
669. 
670.             except StopIteration:
671.                 break
672. 
673.     assert list(power_representation(20, 2, 4, True)) == \
674.         [(1, 1, 3, 3), (0, 0, 2, 4)]
675.     raises(ValueError, lambda: list(power_representation(1.2, 2, 2)))
676.     raises(ValueError, lambda: list(power_representation(2, 0, 2)))
677.     raises(ValueError, lambda: list(power_representation(2, 2, 0)))
678.     assert list(power_representation(-1, 2, 2)) == []
679.     assert list(power_representation(1, 1, 1)) == [(1,)]
680.     assert list(power_representation(3, 2, 1)) == []
681.     assert list(power_representation(4, 2, 1)) == [(2,)]
682.     assert list(power_representation(3**4, 4, 6, zeros=True)) == \
683.         [(1, 2, 2, 2, 2, 2), (0, 0, 0, 0, 0, 3)]
684.     assert list(power_representation(3**4, 4, 5, zeros=False)) == []
685.     assert list(power_representation(-2, 3, 2)) == [(-1, -1)]
686.     assert list(power_representation(-2, 4, 2)) == []
687.     assert list(power_representation(0, 3, 2, True)) == [(0, 0)]
688.     assert list(power_representation(0, 3, 2, False)) == []
689.     # when we are dealing with squares, do feasibility checks
690.     assert len(list(power_representation(4**10*(8*10 + 7), 2, 3))) == 0
691.     # there will be a recursion error if these aren't recognized
692.     big = 2**30
693.     for i in [13, 10, 7, 5, 4, 2, 1]:
694.         assert list(sum_of_powers(big, 2, big - i)) == []
695. 
696. 
697. def test_assumptions():
698.     """
699.     Test whether diophantine respects the assumptions.
700.     """
701.     #Test case taken from the below so question regarding assumptions in diophantine module
702.     #https://stackoverflow.com/questions/23301941/how-can-i-declare-natural-symbols-with-sympy
703.     m, n = symbols('m n', integer=True, positive=True)
704.     diof = diophantine(n ** 2 + m * n - 500)
705.     assert diof == set([(5, 20), (40, 10), (95, 5), (121, 4), (248, 2), (499, 1)])
706. 
707.     a, b = symbols('a b', integer=True, positive=False)
708.     diof = diophantine(a*b + 2*a + 3*b - 6)
709.     assert diof == set([(-15, -3), (-9, -4), (-7, -5), (-6, -6), (-5, -8), (-4, -14)])
710. 
711. 
712. def check_solutions(eq):
713.     """
714.     Determines whether solutions returned by diophantine() satisfy the original
715.     equation. Hope to generalize this so we can remove functions like check_ternay_quadratic,
716.     check_solutions_normal, check_solutions()
717.     """
718.     s = diophantine(eq)
719. 
720.     factors = Mul.make_args(eq)
721. 
722.     var = list(eq.free_symbols)
723.     var.sort(key=default_sort_key)
724. 
725.     while s:
726.         solution = s.pop()
727.         for f in factors:
728.             if diop_simplify(f.subs(zip(var, solution))) == 0:
729.                 break
730.         else:
731.             return False
732.     return True
733. 
734. 
735. def test_diopcoverage():
736.     eq = (2*x + y + 1)**2
737.     assert diop_solve(eq) == set([(t_0, -2*t_0 - 1)])
738.     eq = 2*x**2 + 6*x*y + 12*x + 4*y**2 + 18*y + 18
739.     assert diop_solve(eq) == set([(t_0, -t_0 - 3), (2*t_0 - 3, -t_0)])
740.     assert diop_quadratic(x + y**2 - 3) == set([(-t**2 + 3, -t)])
741. 
742.     assert diop_linear(x + y - 3) == (t_0, 3 - t_0)
743. 
744.     assert base_solution_linear(0, 1, 2, t=None) == (0, 0)
745.     ans = (3*t - 1, -2*t + 1)
746.     assert base_solution_linear(4, 8, 12, t) == ans
747.     assert base_solution_linear(4, 8, 12, t=None) == tuple(_.subs(t, 0) for _ in ans)
748. 
749.     assert cornacchia(1, 1, 20) is None
750.     assert cornacchia(1, 1, 5) == set([(2, 1)])
751.     assert cornacchia(1, 2, 17) == set([(3, 2)])
752. 
753.     raises(ValueError, lambda: reconstruct(4, 20, 1))
754. 
755.     assert gaussian_reduce(4, 1, 3) == (1, 1)
756.     eq = -w**2 - x**2 - y**2 + z**2
757. 
758.     assert diop_general_pythagorean(eq) == \
759.         diop_general_pythagorean(-eq) == \
760.             (m1**2 + m2**2 - m3**2, 2*m1*m3,
761.             2*m2*m3, m1**2 + m2**2 + m3**2)
762. 
763.     assert check_param(S(3) + x/3, S(4) + x/2, S(2), x) == (None, None)
764.     assert check_param(Rational(3, 2), S(4) + x, S(2), x) == (None, None)
765.     assert check_param(S(4) + x, Rational(3, 2), S(2), x) == (None, None)
766. 
767.     assert _nint_or_floor(16, 10) == 2
768.     assert _odd(1) == (not _even(1)) == True
769.     assert _odd(0) == (not _even(0)) == False
770.     assert _remove_gcd(2, 4, 6) == (1, 2, 3)
771.     raises(TypeError, lambda: _remove_gcd((2, 4, 6)))
772.     assert sqf_normal(2 * 3**2 * 5, 2 * 5 * 11, 2 * 7**2 * 11)  == \
773.         (11, 1, 5)
774. 
775.     # it's ok if these pass some day when the solvers are implemented
776.     raises(NotImplementedError, lambda: diophantine(x**2 + y**2 + x*y + 2*y*z - 12))
777.     raises(NotImplementedError, lambda: diophantine(x**3 + y**2))
778.     assert diop_quadratic(x**2 + y**2 - 1**2 - 3**4) == \
779.         set([(-9, -1), (-9, 1), (-1, -9), (-1, 9), (1, -9), (1, 9), (9, -1), (9, 1)])
780. 
781. 
782. def test_holzer():
783.     # if the input is good, don't let it diverge in holzer()
784.     # (but see test_fail_holzer below)
785.     assert holzer(2, 7, 13, 4, 79, 23) == (2, 7, 13)
786. 
787.     # None in uv condition met; solution is not Holzer reduced
788.     # so this will hopefully change but is here for coverage
789.     assert holzer(2, 6, 2, 1, 1, 10) == (2, 6, 2)
790. 
791.     raises(ValueError, lambda: holzer(2, 7, 14, 4, 79, 23))
792. 
793. 
794. @XFAIL
795. def test_fail_holzer():
796.     eq = lambda x, y, z: a*x**2 + b*y**2 - c*z**2
797.     a, b, c = 4, 79, 23
798.     x, y, z = xyz = 26, 1, 11
799.     X, Y, Z = ans = 2, 7, 13
800.     assert eq(*xyz) == 0
801.     assert eq(*ans) == 0
802.     assert max(a*x**2, b*y**2, c*z**2) <= a*b*c
803.     assert max(a*X**2, b*Y**2, c*Z**2) <= a*b*c
804.     h = holzer(x, y, z, a, b, c)
805.     assert h == ans  # it would be nice to get the smaller soln
806. 
807. 
808. def test_issue_9539():
809.     assert diophantine(6*w + 9*y + 20*x - z) == \
810.         set([(t_0, t_1, t_1 + t_2, 6*t_0 + 29*t_1 + 9*t_2)])
811. 
812. 
813. def test_issue_8943():
814.     assert diophantine(
815.         (3*(x**2 + y**2 + z**2) - 14*(x*y + y*z + z*x))) == \
816.         set([(0, 0, 0)])
817. 
818. 
819. def test_diop_sum_of_even_powers():
820.     eq = x**4 + y**4 + z**4 - 2673
821.     assert diop_solve(eq) == set([(3, 6, 6), (2, 4, 7)])
822.     assert diop_general_sum_of_even_powers(eq, 2) == set(
823.         [(3, 6, 6), (2, 4, 7)])
824.     raises(NotImplementedError, lambda: diop_general_sum_of_even_powers(-eq, 2))
825.     neg = symbols('neg', negative=True)
826.     eq = x**4 + y**4 + neg**4 - 2673
827.     assert diop_general_sum_of_even_powers(eq) == set([(-3, 6, 6)])
828.     assert diophantine(x**4 + y**4 + 2) == set()
829.     assert diop_general_sum_of_even_powers(x**4 + y**4 - 2, limit=0) == set()
830. 
831. 
832. def test_sum_of_squares_powers():
833.     tru = set([
834.     (0, 0, 1, 1, 11), (0, 0, 5, 7, 7), (0, 1, 3, 7, 8), (0, 1, 4, 5, 9),
835.     (0, 3, 4, 7, 7), (0, 3, 5, 5, 8), (1, 1, 2, 6, 9), (1, 1, 6, 6, 7),
836.     (1, 2, 3, 3, 10), (1, 3, 4, 4, 9), (1, 5, 5, 6, 6), (2, 2, 3, 5, 9),
837.     (2, 3, 5, 6, 7), (3, 3, 4, 5, 8)])
838.     eq = u**2 + v**2 + x**2 + y**2 + z**2 - 123
839.     ans = diop_general_sum_of_squares(eq, oo)  # allow oo to be used
840.     assert len(ans) == 14
841.     assert ans == tru
842. 
843.     raises(ValueError, lambda: list(sum_of_squares(10, -1)))
844.     assert list(sum_of_squares(-10, 2)) == []
845.     assert list(sum_of_squares(2, 3)) == []
846.     assert list(sum_of_squares(0, 3, True)) == [(0, 0, 0)]
847.     assert list(sum_of_squares(0, 3)) == []
848.     assert list(sum_of_squares(4, 1)) == [(2,)]
849.     assert list(sum_of_squares(5, 1)) == []
850.     assert list(sum_of_squares(50, 2)) == [(5, 5), (1, 7)]
851.     assert list(sum_of_squares(11, 5, True)) == [
852.         (1, 1, 1, 2, 2), (0, 0, 1, 1, 3)]
853.     assert list(sum_of_squares(8, 8)) == [(1, 1, 1, 1, 1, 1, 1, 1)]
854. 
855.     assert [len(list(sum_of_squares(i, 5, True))) for i in range(30)] == [
856.         1, 1, 1, 1, 2,
857.         2, 1, 1, 2, 2,
858.         2, 2, 2, 3, 2,
859.         1, 3, 3, 3, 3,
860.         4, 3, 3, 2, 2,
861.         4, 4, 4, 4, 5]
862.     assert [len(list(sum_of_squares(i, 5))) for i in range(30)] == [
863.         0, 0, 0, 0, 0,
864.         1, 0, 0, 1, 0,
865.         0, 1, 0, 1, 1,
866.         0, 1, 1, 0, 1,
867.         2, 1, 1, 1, 1,
868.         1, 1, 1, 1, 3]
869.     for i in range(30):
870.         s1 = set(sum_of_squares(i, 5, True))
871.         assert not s1 or all(sum(j**2 for j in t) == i for t in s1)
872.         s2 = set(sum_of_squares(i, 5))
873.         assert all(sum(j**2 for j in t) == i for t in s2)
874. 
875.     raises(ValueError, lambda: list(sum_of_powers(2, -1, 1)))
876.     raises(ValueError, lambda: list(sum_of_powers(2, 1, -1)))
877.     assert list(sum_of_powers(-2, 3, 2)) == [(-1, -1)]
878.     assert list(sum_of_powers(-2, 4, 2)) == []
879.     assert list(sum_of_powers(2, 1, 1)) == [(2,)]
880.     assert list(sum_of_powers(2, 1, 3, True)) == [(0, 0, 2), (0, 1, 1)]
881.     assert list(sum_of_powers(5, 1, 2, True)) == [(0, 5), (1, 4), (2, 3)]
882.     assert list(sum_of_powers(6, 2, 2)) == []
883.     assert list(sum_of_powers(3**5, 3, 1)) == []
884.     assert list(sum_of_powers(3**6, 3, 1)) == [(9,)] and (9**3 == 3**6)
885.     assert list(sum_of_powers(2**1000, 5, 2)) == []
886. 
887. 
888. def test__can_do_sum_of_squares():
889.     assert _can_do_sum_of_squares(3, -1) is False
890.     assert _can_do_sum_of_squares(-3, 1) is False
891.     assert _can_do_sum_of_squares(0, 1)
892.     assert _can_do_sum_of_squares(4, 1)
893.     assert _can_do_sum_of_squares(1, 2)
894.     assert _can_do_sum_of_squares(2, 2)
895.     assert _can_do_sum_of_squares(3, 2) is False
896. 
897. 
898. def test_diophantine_permute_sign():
899.     from sympy.abc import a, b, c, d, e
900.     eq = a**4 + b**4 - (2**4 + 3**4)
901.     base_sol = set([(2, 3)])
902.     assert diophantine(eq) == base_sol
903.     complete_soln = set(signed_permutations(base_sol.pop()))
904.     assert diophantine(eq, permute=True) == complete_soln
905. 
906.     eq = a**2 + b**2 + c**2 + d**2 + e**2 - 234
907.     assert len(diophantine(eq)) == 35
908.     assert len(diophantine(eq, permute=True)) == 62000
909.     soln = set([(-1, -1), (-1, 2), (1, -2), (1, 1)])
910.     assert diophantine(10*x**2 + 12*x*y + 12*y**2 - 34, permute=True) == soln
911. 
912. 
913. @XFAIL
914. def test_not_implemented():
915.     eq = x**2 + y**4 - 1**2 - 3**4
916.     assert diophantine(eq, syms=[x, y]) == set([(9, 1), (1, 3)])
917. 
918. 
919. def test_issue_9538():
920.     eq = x - 3*y + 2
921.     assert diophantine(eq, syms=[y,x]) == set([(t_0, 3*t_0 - 2)])
922.     raises(TypeError, lambda: diophantine(eq, syms=set([y,x])))
923. 
924. 
925. def test_ternary_quadratic():
926.     # solution with 3 parameters
927.     s = diophantine(2*x**2 + y**2 - 2*z**2)
928.     p, q, r = ordered(S(s).free_symbols)
929.     assert s == {(
930.         p**2 - 2*q**2,
931.         -2*p**2 + 4*p*q - 4*p*r - 4*q**2,
932.         p**2 - 4*p*q + 2*q**2 - 4*q*r)}
933.     # solution with Mul in solution
934.     s = diophantine(x**2 + 2*y**2 - 2*z**2)
935.     assert s == {(4*p*q, p**2 - 2*q**2, p**2 + 2*q**2)}
936.     # solution with no Mul in solution
937.     s = diophantine(2*x**2 + 2*y**2 - z**2)
938.     assert s == {(2*p**2 - q**2, -2*p**2 + 4*p*q - q**2,
939.         4*p**2 - 4*p*q + 2*q**2)}
940.     # reduced form when parametrized
941.     s = diophantine(3*x**2 + 72*y**2 - 27*z**2)
942.     assert s == {(24*p**2 - 9*q**2, 6*p*q, 8*p**2 + 3*q**2)}
943.     assert parametrize_ternary_quadratic(
944.         3*x**2 + 2*y**2 - z**2 - 2*x*y + 5*y*z - 7*y*z) == (
945.         2*p**2 - 2*p*q - q**2, 2*p**2 + 2*p*q - q**2, 2*p**2 -
946.         2*p*q + 3*q**2)
947.     assert parametrize_ternary_quadratic(
948.         124*x**2 - 30*y**2 - 7729*z**2) == (
949.         -1410*p**2 - 363263*q**2, 2700*p**2 + 30916*p*q -
950.         695610*q**2, -60*p**2 + 5400*p*q + 15458*q**2)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 01:51:32,860 - thread-125239516182208.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants to find 3 relevant test cases for a bug in the `diophantine` function related to the `syms` and `permute` parameters.\n2. I have been provided with the complete source code of `sympy/solvers/tests/test_diophantine.py`.\n3. I have analyzed the bug report and the provided patch. The bug occurs when `syms` and `permute=True` are used together, causing incorrect results depending on the order of symbols in `syms`.\n4. I have searched the test file for usages of `diophantine` with `syms` and `permute`.\n5. While there are no tests that use both `syms` and `permute=True` together, I have found tests that exercise each feature separately and are highly relevant to the bug.\n    - `test_diophantine_permute_sign` tests `permute=True` on an equation that is very similar to the one in the bug report.\n    - `test_issue_9538` tests the `syms` parameter and the ordering of variables in the solution.\n    - `test_diophantine` contains a simple, clear example of using `permute=True`.\n6. The provided file contains all necessary code, including imports and helper functions, to understand and extract these test cases.\n7. Therefore, I have sufficient context and do not need to request additional information.' query='' extra_requirements='' purpose=''
2025-12-24 01:51:32,861 - thread-125239516182208.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
