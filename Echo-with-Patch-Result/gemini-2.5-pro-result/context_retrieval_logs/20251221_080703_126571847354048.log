2025-12-21 08:07:03,377 - thread-126571847354048.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Query.resolve_lookup_value coerces value of type list to tuple

Description: Description
	
Changes introduced in #30687 cause an input value list to be coerced to tuple breaking exact value queries. This affects ORM field types that are dependent on matching input types such as PickledField.
The expected iterable return type should match input iterable type.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index ea51912e8b..6724f401f1 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1073,7 +1073,12 @@ class Query(BaseExpression):
                         ))
                 else:
                     resolved_values.append(sub_value)
-            value = tuple(resolved_values)
+            # Preserve the input iterable type (list vs tuple) to avoid altering
+            # exact comparisons for type-sensitive fields (e.g., pickled values).
+            if isinstance(value, list):
+                value = resolved_values
+            else:
+                value = tuple(resolved_values)
         return value
 
     def solve_lookup_type(self, lookup):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

2025-12-21 08:07:03,476 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── FUNDING.yml
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Query.resolve_lookup_value coerces value of type list to tuple

Description: Description
	
Changes introduced in #30687 cause an input value list to be coerced to tuple breaking exact value queries. This affects ORM field types that are dependent on matching input types such as PickledField.
The expected iterable return type should match input iterable type.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index ea51912e8b..6724f401f1 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1073,7 +1073,12 @@ class Query(BaseExpression):
                         ))
                 else:
                     resolved_values.append(sub_value)
-            value = tuple(resolved_values)
+            # Preserve the input iterable type (list vs tuple) to avoid altering
+            # exact comparisons for type-sensitive fields (e.g., pickled values).
+            if isinstance(value, list):
+                value = resolved_values
+            else:
+                value = tuple(resolved_values)
         return value
 
     def solve_lookup_type(self, lookup):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:07:29,488 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to understand a patch that fixes an issue with `list` to `tuple` coercion in Django's ORM. The patch is in the `resolve_lookup_value` method of the `Query` class, located in `django/db/models/sql/query.py`. To understand the impact of this change, I need to see the full implementation of the `Query` class, including the `resolve_lookup_value` method and any methods that call it. Therefore, the content of `django/db/models/sql/query.py` is essential." query='Please provide the full content of django/db/models/sql/query.py.' extra_requirements='If the file is too large, please at least provide the complete implementation of the `Query` class from that file.' purpose='The `Query` class and its `resolve_lookup_value` method are central to the issue, and this file is needed to understand the context of the provided patch.'
2025-12-21 08:07:29,490 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of django/db/models/sql/query.py.
2025-12-21 08:07:29,490 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:07:29,490 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:07:29,491 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:07:29,491 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of django/db/models/sql/query.py.
Extra requirements: If the file is too large, please at least provide the complete implementation of the `Query` class from that file.
Purpose: The `Query` class and its `resolve_lookup_value` method are central to the issue, and this file is needed to understand the context of the provided patch.
2025-12-21 08:07:34,973 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have started by searching for the file `django/db/models/sql/query.py` to inspect its contents. My initial attempt to read the file revealed that it is quite large. Therefore, I will now proceed to specifically locate the `Query` class within this file to provide you with its complete implementation.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/sql/query.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2137, 'candidates_token_count': 90, 'total_token_count': 2672, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2137}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 90}], 'thoughts_token_count': 445, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4548225402832031, 'model_name': 'gemini-2.5-pro'} id='run--80943fca-8ee5-4d8f-a382-e0b5e02113a1-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/sql/query.py'}, 'id': 'fe82bca9-df0a-43e2-8bf7-946b213f750b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2137, 'output_tokens': 90, 'total_tokens': 2672, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 445}}
2025-12-21 08:07:41,577 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located the `Query` class within the file `django/db/models/sql/query.py`. To provide you with the complete implementation of this class, I will now read the content of the file starting from line 146, where the class definition begins, and I will ensure to include all of its methods by reading a large portion of the file from that point.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"relative_path": "django/db/models/sql/query.py", "type": "class_definition"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9632, 'candidates_token_count': 118, 'total_token_count': 10136, 'cached_content_token_count': 1846, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9632}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1846}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 118}], 'thoughts_token_count': 386}, 'finish_reason': 'STOP', 'avg_logprobs': -0.33021529246184783, 'model_name': 'gemini-2.5-pro'} id='run--946f9c6f-f191-40d2-b286-88a0d3d59e24-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'relative_path': 'django/db/models/sql/query.py', 'type': 'class_definition'}, 'id': '199cb4b8-be77-4437-b767-59b973010733', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9632, 'output_tokens': 118, 'total_tokens': 10136, 'input_token_details': {'cache_read': 1846}, 'output_token_details': {'reasoning': 386}}
2025-12-21 08:07:44,069 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have found the `Query` class in `django/db/models/sql/query.py`. I will now read the file starting from line 146 to retrieve the complete implementation of the class, as initially requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 146.0, "end_line": 2245.0, "relative_path": "django/db/models/sql/query.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 36908, 'candidates_token_count': 79, 'total_token_count': 36987, 'cached_content_token_count': 9714, 'prompt_tokens_details': [{'modality': 1, 'token_count': 36908}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9714}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 79}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.109071260766138, 'model_name': 'gemini-2.5-pro'} id='run--fc7dde44-05f5-4937-937f-f0e347977cdd-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 146.0, 'end_line': 2245.0, 'relative_path': 'django/db/models/sql/query.py'}, 'id': '226e2289-4950-4be1-81cc-f3e2841d63bd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 36908, 'output_tokens': 79, 'total_tokens': 36987, 'input_token_details': {'cache_read': 9714}}
2025-12-21 08:07:47,606 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the full content of the `Query` class from the file `django/db/models/sql/query.py`. The file was initially too large to read in its entirety, so I located the `Query` class definition and then extracted its complete implementation as requested. This should provide the necessary context for understanding the provided patch, particularly in relation to the `Query` class and its `resolve_lookup_value` method.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 71733, 'candidates_token_count': 91, 'total_token_count': 71875, 'prompt_tokens_details': [{'modality': 1, 'token_count': 71733}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 91}], 'thoughts_token_count': 51, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09974884200882125, 'model_name': 'gemini-2.5-pro'} id='run--d2f63916-80d4-4411-8d5e-e7208830d244-0' usage_metadata={'input_tokens': 71733, 'output_tokens': 91, 'total_tokens': 71875, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 51}}
2025-12-21 08:07:47,609 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of django/db/models/sql/query.py.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please at least provide the complete implementation of the `Query` class from that file.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
The `Query` class and its `resolve_lookup_value` method are central to the issue, and this file is needed to understand the context of the provided patch.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: django/db/models/sql/query.py
Line number range: 1 - 500
Content:
1. """
2. Create SQL statements for QuerySets.
3. 
4. The code in here encapsulates all of the SQL construction so that QuerySets
5. themselves do not have to (and could be backed by things other than SQL
6. databases). The abstraction barrier only works one way: this module has to know
7. all about the internals of models in order to get the information it needs.
8. """
9. import copy
10. import difflib
11. import functools
12. import inspect
13. import sys
14. import warnings
15. from collections import Counter, namedtuple
16. from collections.abc import Iterator, Mapping
17. from itertools import chain, count, product
18. from string import ascii_uppercase
19. 
20. from django.core.exceptions import (
21.     EmptyResultSet, FieldDoesNotExist, FieldError,
22. )
23. from django.db import DEFAULT_DB_ALIAS, NotSupportedError, connections
24. from django.db.models.aggregates import Count
25. from django.db.models.constants import LOOKUP_SEP
26. from django.db.models.expressions import (
27.     BaseExpression, Col, F, OuterRef, Ref, SimpleCol,
28. )
29. from django.db.models.fields import Field
30. from django.db.models.fields.related_lookups import MultiColSource
31. from django.db.models.lookups import Lookup
32. from django.db.models.query_utils import (
33.     Q, check_rel_lookup_compatibility, refs_expression,
34. )
35. from django.db.models.sql.constants import (
36.     INNER, LOUTER, ORDER_DIR, ORDER_PATTERN, SINGLE,
37. )
38. from django.db.models.sql.datastructures import (
39.     BaseTable, Empty, Join, MultiJoin,
40. )
41. from django.db.models.sql.where import (
42.     AND, OR, ExtraWhere, NothingNode, WhereNode,
43. )
44. from django.utils.deprecation import RemovedInDjango40Warning
45. from django.utils.functional import cached_property
46. from django.utils.tree import Node
47. 
48. __all__ = ['Query', 'RawQuery']
49. 
50. 
51. def get_field_names_from_opts(opts):
52.     return set(chain.from_iterable(
53.         (f.name, f.attname) if f.concrete else (f.name,)
54.         for f in opts.get_fields()
55.     ))
56. 
57. 
58. def get_children_from_q(q):
59.     for child in q.children:
60.         if isinstance(child, Node):
61.             yield from get_children_from_q(child)
62.         else:
63.             yield child
64. 
65. 
66. JoinInfo = namedtuple(
67.     'JoinInfo',
68.     ('final_field', 'targets', 'opts', 'joins', 'path', 'transform_function')
69. )
70. 
71. 
72. def _get_col(target, field, alias, simple_col):
73.     if simple_col:
74.         return SimpleCol(target, field)
75.     return target.get_col(alias, field)
76. 
77. 
78. class RawQuery:
79.     """A single raw SQL query."""
80. 
81.     def __init__(self, sql, using, params=None):
82.         self.params = params or ()
83.         self.sql = sql
84.         self.using = using
85.         self.cursor = None
86. 
87.         # Mirror some properties of a normal query so that
88.         # the compiler can be used to process results.
89.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
90.         self.extra_select = {}
91.         self.annotation_select = {}
92. 
93.     def chain(self, using):
94.         return self.clone(using)
95. 
96.     def clone(self, using):
97.         return RawQuery(self.sql, using, params=self.params)
98. 
99.     def get_columns(self):
100.         if self.cursor is None:
101.             self._execute_query()
102.         converter = connections[self.using].introspection.identifier_converter
103.         return [converter(column_meta[0])
104.                 for column_meta in self.cursor.description]
105. 
106.     def __iter__(self):
107.         # Always execute a new query for a new iterator.
108.         # This could be optimized with a cache at the expense of RAM.
109.         self._execute_query()
110.         if not connections[self.using].features.can_use_chunked_reads:
111.             # If the database can't use chunked reads we need to make sure we
112.             # evaluate the entire query up front.
113.             result = list(self.cursor)
114.         else:
115.             result = self.cursor
116.         return iter(result)
117. 
118.     def __repr__(self):
119.         return "<%s: %s>" % (self.__class__.__name__, self)
120. 
121.     @property
122.     def params_type(self):
123.         return dict if isinstance(self.params, Mapping) else tuple
124. 
125.     def __str__(self):
126.         return self.sql % self.params_type(self.params)
127. 
128.     def _execute_query(self):
129.         connection = connections[self.using]
130. 
131.         # Adapt parameters to the database, as much as possible considering
132.         # that the target type isn't known. See #17755.
133.         params_type = self.params_type
134.         adapter = connection.ops.adapt_unknown_value
135.         if params_type is tuple:
136.             params = tuple(adapter(val) for val in self.params)
137.         elif params_type is dict:
138.             params = {key: adapter(val) for key, val in self.params.items()}
139.         else:
140.             raise RuntimeError("Unexpected params type: %s" % params_type)
141. 
142.         self.cursor = connection.cursor()
143.         self.cursor.execute(self.sql, params)
144. 
145. 
146. class Query(BaseExpression):
147.     """A single SQL query."""
148. 
149.     alias_prefix = 'T'
150.     subq_aliases = frozenset([alias_prefix])
151. 
152.     compiler = 'SQLCompiler'
153. 
154.     def __init__(self, model, where=WhereNode):
155.         self.model = model
156.         self.alias_refcount = {}
157.         # alias_map is the most important data structure regarding joins.
158.         # It's used for recording which joins exist in the query and what
159.         # types they are. The key is the alias of the joined table (possibly
160.         # the table name) and the value is a Join-like object (see
161.         # sql.datastructures.Join for more information).
162.         self.alias_map = {}
163.         # Sometimes the query contains references to aliases in outer queries (as
164.         # a result of split_exclude). Correct alias quoting needs to know these
165.         # aliases too.
166.         self.external_aliases = set()
167.         self.table_map = {}     # Maps table names to list of aliases.
168.         self.default_cols = True
169.         self.default_ordering = True
170.         self.standard_ordering = True
171.         self.used_aliases = set()
172.         self.filter_is_sticky = False
173.         self.subquery = False
174. 
175.         # SQL-related attributes
176.         # Select and related select clauses are expressions to use in the
177.         # SELECT clause of the query.
178.         # The select is used for cases where we want to set up the select
179.         # clause to contain other than default fields (values(), subqueries...)
180.         # Note that annotations go to annotations dictionary.
181.         self.select = ()
182.         self.where = where()
183.         self.where_class = where
184.         # The group_by attribute can have one of the following forms:
185.         #  - None: no group by at all in the query
186.         #  - A tuple of expressions: group by (at least) those expressions.
187.         #    String refs are also allowed for now.
188.         #  - True: group by all select fields of the model
189.         # See compiler.get_group_by() for details.
190.         self.group_by = None
191.         self.order_by = ()
192.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
193.         self.distinct = False
194.         self.distinct_fields = ()
195.         self.select_for_update = False
196.         self.select_for_update_nowait = False
197.         self.select_for_update_skip_locked = False
198.         self.select_for_update_of = ()
199. 
200.         self.select_related = False
201.         # Arbitrary limit for select_related to prevents infinite recursion.
202.         self.max_depth = 5
203. 
204.         # Holds the selects defined by a call to values() or values_list()
205.         # excluding annotation_select and extra_select.
206.         self.values_select = ()
207. 
208.         # SQL annotation-related attributes
209.         self.annotations = {}  # Maps alias -> Annotation Expression
210.         self.annotation_select_mask = None
211.         self._annotation_select_cache = None
212. 
213.         # Set combination attributes
214.         self.combinator = None
215.         self.combinator_all = False
216.         self.combined_queries = ()
217. 
218.         # These are for extensions. The contents are more or less appended
219.         # verbatim to the appropriate clause.
220.         self.extra = {}  # Maps col_alias -> (col_sql, params).
221.         self.extra_select_mask = None
222.         self._extra_select_cache = None
223. 
224.         self.extra_tables = ()
225.         self.extra_order_by = ()
226. 
227.         # A tuple that is a set of model field names and either True, if these
228.         # are the fields to defer, or False if these are the only fields to
229.         # load.
230.         self.deferred_loading = (frozenset(), True)
231. 
232.         self._filtered_relations = {}
233. 
234.         self.explain_query = False
235.         self.explain_format = None
236.         self.explain_options = {}
237. 
238.     @property
239.     def output_field(self):
240.         if len(self.select) == 1:
241.             return self.select[0].field
242.         elif len(self.annotation_select) == 1:
243.             return next(iter(self.annotation_select.values())).output_field
244. 
245.     @property
246.     def has_select_fields(self):
247.         return bool(self.select or self.annotation_select_mask or self.extra_select_mask)
248. 
249.     @cached_property
250.     def base_table(self):
251.         for alias in self.alias_map:
252.             return alias
253. 
254.     def __str__(self):
255.         """
256.         Return the query as a string of SQL with the parameter values
257.         substituted in (use sql_with_params() to see the unsubstituted string).
258. 
259.         Parameter values won't necessarily be quoted correctly, since that is
260.         done by the database interface at execution time.
261.         """
262.         sql, params = self.sql_with_params()
263.         return sql % params
264. 
265.     def sql_with_params(self):
266.         """
267.         Return the query as an SQL string and the parameters that will be
268.         substituted into the query.
269.         """
270.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
271. 
272.     def __deepcopy__(self, memo):
273.         """Limit the amount of work when a Query is deepcopied."""
274.         result = self.clone()
275.         memo[id(self)] = result
276.         return result
277. 
278.     def get_compiler(self, using=None, connection=None):
279.         if using is None and connection is None:
280.             raise ValueError("Need either using or connection")
281.         if using:
282.             connection = connections[using]
283.         return connection.ops.compiler(self.compiler)(self, connection, using)
284. 
285.     def get_meta(self):
286.         """
287.         Return the Options instance (the model._meta) from which to start
288.         processing. Normally, this is self.model._meta, but it can be changed
289.         by subclasses.
290.         """
291.         return self.model._meta
292. 
293.     def clone(self):
294.         """
295.         Return a copy of the current Query. A lightweight alternative to
296.         to deepcopy().
297.         """
298.         obj = Empty()
299.         obj.__class__ = self.__class__
300.         # Copy references to everything.
301.         obj.__dict__ = self.__dict__.copy()
302.         # Clone attributes that can't use shallow copy.
303.         obj.alias_refcount = self.alias_refcount.copy()
304.         obj.alias_map = self.alias_map.copy()
305.         obj.external_aliases = self.external_aliases.copy()
306.         obj.table_map = self.table_map.copy()
307.         obj.where = self.where.clone()
308.         obj.annotations = self.annotations.copy()
309.         if self.annotation_select_mask is None:
310.             obj.annotation_select_mask = None
311.         else:
312.             obj.annotation_select_mask = self.annotation_select_mask.copy()
313.         # _annotation_select_cache cannot be copied, as doing so breaks the
314.         # (necessary) state in which both annotations and
315.         # _annotation_select_cache point to the same underlying objects.
316.         # It will get re-populated in the cloned queryset the next time it's
317.         # used.
318.         obj._annotation_select_cache = None
319.         obj.extra = self.extra.copy()
320.         if self.extra_select_mask is None:
321.             obj.extra_select_mask = None
322.         else:
323.             obj.extra_select_mask = self.extra_select_mask.copy()
324.         if self._extra_select_cache is None:
325.             obj._extra_select_cache = None
326.         else:
327.             obj._extra_select_cache = self._extra_select_cache.copy()
328.         if self.select_related is not False:
329.             # Use deepcopy because select_related stores fields in nested
330.             # dicts.
331.             obj.select_related = copy.deepcopy(obj.select_related)
332.         if 'subq_aliases' in self.__dict__:
333.             obj.subq_aliases = self.subq_aliases.copy()
334.         obj.used_aliases = self.used_aliases.copy()
335.         obj._filtered_relations = self._filtered_relations.copy()
336.         # Clear the cached_property
337.         try:
338.             del obj.base_table
339.         except AttributeError:
340.             pass
341.         return obj
342. 
343.     def chain(self, klass=None):
344.         """
345.         Return a copy of the current Query that's ready for another operation.
346.         The klass argument changes the type of the Query, e.g. UpdateQuery.
347.         """
348.         obj = self.clone()
349.         if klass and obj.__class__ != klass:
350.             obj.__class__ = klass
351.         if not obj.filter_is_sticky:
352.             obj.used_aliases = set()
353.         obj.filter_is_sticky = False
354.         if hasattr(obj, '_setup_query'):
355.             obj._setup_query()
356.         return obj
357. 
358.     def relabeled_clone(self, change_map):
359.         clone = self.clone()
360.         clone.change_aliases(change_map)
361.         return clone
362. 
363.     def rewrite_cols(self, annotation, col_cnt):
364.         # We must make sure the inner query has the referred columns in it.
365.         # If we are aggregating over an annotation, then Django uses Ref()
366.         # instances to note this. However, if we are annotating over a column
367.         # of a related model, then it might be that column isn't part of the
368.         # SELECT clause of the inner query, and we must manually make sure
369.         # the column is selected. An example case is:
370.         #    .aggregate(Sum('author__awards'))
371.         # Resolving this expression results in a join to author, but there
372.         # is no guarantee the awards column of author is in the select clause
373.         # of the query. Thus we must manually add the column to the inner
374.         # query.
375.         orig_exprs = annotation.get_source_expressions()
376.         new_exprs = []
377.         for expr in orig_exprs:
378.             # FIXME: These conditions are fairly arbitrary. Identify a better
379.             # method of having expressions decide which code path they should
380.             # take.
381.             if isinstance(expr, Ref):
382.                 # Its already a Ref to subquery (see resolve_ref() for
383.                 # details)
384.                 new_exprs.append(expr)
385.             elif isinstance(expr, (WhereNode, Lookup)):
386.                 # Decompose the subexpressions further. The code here is
387.                 # copied from the else clause, but this condition must appear
388.                 # before the contains_aggregate/is_summary condition below.
389.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
390.                 new_exprs.append(new_expr)
391.             else:
392.                 # Reuse aliases of expressions already selected in subquery.
393.                 for col_alias, selected_annotation in self.annotation_select.items():
394.                     if selected_annotation == expr:
395.                         new_expr = Ref(col_alias, expr)
396.                         break
397.                 else:
398.                     # An expression that is not selected the subquery.
399.                     if isinstance(expr, Col) or (expr.contains_aggregate and not expr.is_summary):
400.                         # Reference column or another aggregate. Select it
401.                         # under a non-conflicting alias.
402.                         col_cnt += 1
403.                         col_alias = '__col%d' % col_cnt
404.                         self.annotations[col_alias] = expr
405.                         self.append_annotation_mask([col_alias])
406.                         new_expr = Ref(col_alias, expr)
407.                     else:
408.                         # Some other expression not referencing database values
409.                         # directly. Its subexpression might contain Cols.
410.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
411.                 new_exprs.append(new_expr)
412.         annotation.set_source_expressions(new_exprs)
413.         return annotation, col_cnt
414. 
415.     def get_aggregation(self, using, added_aggregate_names):
416.         """
417.         Return the dictionary with the values of the existing aggregations.
418.         """
419.         if not self.annotation_select:
420.             return {}
421.         existing_annotations = [
422.             annotation for alias, annotation
423.             in self.annotations.items()
424.             if alias not in added_aggregate_names
425.         ]
426.         # Decide if we need to use a subquery.
427.         #
428.         # Existing annotations would cause incorrect results as get_aggregation()
429.         # must produce just one result and thus must not use GROUP BY. But we
430.         # aren't smart enough to remove the existing annotations from the
431.         # query, so those would force us to use GROUP BY.
432.         #
433.         # If the query has limit or distinct, or uses set operations, then
434.         # those operations must be done in a subquery so that the query
435.         # aggregates on the limit and/or distinct results instead of applying
436.         # the distinct and limit after the aggregation.
437.         if (isinstance(self.group_by, tuple) or self.is_sliced or existing_annotations or
438.                 self.distinct or self.combinator):
439.             from django.db.models.sql.subqueries import AggregateQuery
440.             outer_query = AggregateQuery(self.model)
441.             inner_query = self.clone()
442.             inner_query.select_for_update = False
443.             inner_query.select_related = False
444.             inner_query.set_annotation_mask(self.annotation_select)
445.             if not self.is_sliced and not self.distinct_fields:
446.                 # Queries with distinct_fields need ordering and when a limit
447.                 # is applied we must take the slice from the ordered query.
448.                 # Otherwise no need for ordering.
449.                 inner_query.clear_ordering(True)
450.             if not inner_query.distinct:
451.                 # If the inner query uses default select and it has some
452.                 # aggregate annotations, then we must make sure the inner
453.                 # query is grouped by the main model's primary key. However,
454.                 # clearing the select clause can alter results if distinct is
455.                 # used.
456.                 has_existing_aggregate_annotations = any(
457.                     annotation for annotation in existing_annotations
458.                     if getattr(annotation, 'contains_aggregate', True)
459.                 )
460.                 if inner_query.default_cols and has_existing_aggregate_annotations:
461.                     inner_query.group_by = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
462.                 inner_query.default_cols = False
463. 
464.             relabels = {t: 'subquery' for t in inner_query.alias_map}
465.             relabels[None] = 'subquery'
466.             # Remove any aggregates marked for reduction from the subquery
467.             # and move them to the outer AggregateQuery.
468.             col_cnt = 0
469.             for alias, expression in list(inner_query.annotation_select.items()):
470.                 annotation_select_mask = inner_query.annotation_select_mask
471.                 if expression.is_summary:
472.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
473.                     outer_query.annotations[alias] = expression.relabeled_clone(relabels)
474.                     del inner_query.annotations[alias]
475.                     annotation_select_mask.remove(alias)
476.                 # Make sure the annotation_select wont use cached results.
477.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
478.             if inner_query.select == () and not inner_query.default_cols and not inner_query.annotation_select_mask:
479.                 # In case of Model.objects[0:3].count(), there would be no
480.                 # field selected in the inner query, yet we must use a subquery.
481.                 # So, make sure at least one field is selected.
482.                 inner_query.select = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
483.             try:
484.                 outer_query.add_subquery(inner_query, using)
485.             except EmptyResultSet:
486.                 return {
487.                     alias: None
488.                     for alias in outer_query.annotation_select
489.                 }
490.         else:
491.             outer_query = self
492.             self.select = ()
493.             self.default_cols = False
494.             self.extra = {}
495. 
496.         outer_query.clear_ordering(True)
497.         outer_query.clear_limits()
498.         outer_query.select_for_update = False
499.         outer_query.select_related = False
500.         compiler = outer_query.get_compiler(using)


File: django/db/models/sql/query.py
Line number range: 146 - 2245
Content:
146. class Query(BaseExpression):
147.     """A single SQL query."""
148. 
149.     alias_prefix = 'T'
150.     subq_aliases = frozenset([alias_prefix])
151. 
152.     compiler = 'SQLCompiler'
153. 
154.     def __init__(self, model, where=WhereNode):
155.         self.model = model
156.         self.alias_refcount = {}
157.         # alias_map is the most important data structure regarding joins.
158.         # It's used for recording which joins exist in the query and what
159.         # types they are. The key is the alias of the joined table (possibly
160.         # the table name) and the value is a Join-like object (see
161.         # sql.datastructures.Join for more information).
162.         self.alias_map = {}
163.         # Sometimes the query contains references to aliases in outer queries (as
164.         # a result of split_exclude). Correct alias quoting needs to know these
165.         # aliases too.
166.         self.external_aliases = set()
167.         self.table_map = {}     # Maps table names to list of aliases.
168.         self.default_cols = True
169.         self.default_ordering = True
170.         self.standard_ordering = True
171.         self.used_aliases = set()
172.         self.filter_is_sticky = False
173.         self.subquery = False
174. 
175.         # SQL-related attributes
176.         # Select and related select clauses are expressions to use in the
177.         # SELECT clause of the query.
178.         # The select is used for cases where we want to set up the select
179.         # clause to contain other than default fields (values(), subqueries...)
180.         # Note that annotations go to annotations dictionary.
181.         self.select = ()
182.         self.where = where()
183.         self.where_class = where
184.         # The group_by attribute can have one of the following forms:
185.         #  - None: no group by at all in the query
186.         #  - A tuple of expressions: group by (at least) those expressions.
187.         #    String refs are also allowed for now.
188.         #  - True: group by all select fields of the model
189.         # See compiler.get_group_by() for details.
190.         self.group_by = None
191.         self.order_by = ()
192.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
193.         self.distinct = False
194.         self.distinct_fields = ()
195.         self.select_for_update = False
196.         self.select_for_update_nowait = False
197.         self.select_for_update_skip_locked = False
198.         self.select_for_update_of = ()
199. 
200.         self.select_related = False
201.         # Arbitrary limit for select_related to prevents infinite recursion.
202.         self.max_depth = 5
203. 
204.         # Holds the selects defined by a call to values() or values_list()
205.         # excluding annotation_select and extra_select.
206.         self.values_select = ()
207. 
208.         # SQL annotation-related attributes
209.         self.annotations = {}  # Maps alias -> Annotation Expression
210.         self.annotation_select_mask = None
211.         self._annotation_select_cache = None
212. 
213.         # Set combination attributes
214.         self.combinator = None
215.         self.combinator_all = False
216.         self.combined_queries = ()
217. 
218.         # These are for extensions. The contents are more or less appended
219.         # verbatim to the appropriate clause.
220.         self.extra = {}  # Maps col_alias -> (col_sql, params).
221.         self.extra_select_mask = None
222.         self._extra_select_cache = None
223. 
224.         self.extra_tables = ()
225.         self.extra_order_by = ()
226. 
227.         # A tuple that is a set of model field names and either True, if these
228.         # are the fields to defer, or False if these are the only fields to
229.         # load.
230.         self.deferred_loading = (frozenset(), True)
231. 
232.         self._filtered_relations = {}
233. 
234.         self.explain_query = False
235.         self.explain_format = None
236.         self.explain_options = {}
237. 
238.     @property
239.     def output_field(self):
240.         if len(self.select) == 1:
241.             return self.select[0].field
242.         elif len(self.annotation_select) == 1:
243.             return next(iter(self.annotation_select.values())).output_field
244. 
245.     @property
246.     def has_select_fields(self):
247.         return bool(self.select or self.annotation_select_mask or self.extra_select_mask)
248. 
249.     @cached_property
250.     def base_table(self):
251.         for alias in self.alias_map:
252.             return alias
253. 
254.     def __str__(self):
255.         """
256.         Return the query as a string of SQL with the parameter values
257.         substituted in (use sql_with_params() to see the unsubstituted string).
258. 
259.         Parameter values won't necessarily be quoted correctly, since that is
260.         done by the database interface at execution time.
261.         """
262.         sql, params = self.sql_with_params()
263.         return sql % params
264. 
265.     def sql_with_params(self):
266.         """
267.         Return the query as an SQL string and the parameters that will be
268.         substituted into the query.
269.         """
270.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
271. 
272.     def __deepcopy__(self, memo):
273.         """Limit the amount of work when a Query is deepcopied."""
274.         result = self.clone()
275.         memo[id(self)] = result
276.         return result
277. 
278.     def get_compiler(self, using=None, connection=None):
279.         if using is None and connection is None:
280.             raise ValueError("Need either using or connection")
281.         if using:
282.             connection = connections[using]
283.         return connection.ops.compiler(self.compiler)(self, connection, using)
284. 
285.     def get_meta(self):
286.         """
287.         Return the Options instance (the model._meta) from which to start
288.         processing. Normally, this is self.model._meta, but it can be changed
289.         by subclasses.
290.         """
291.         return self.model._meta
292. 
293.     def clone(self):
294.         """
295.         Return a copy of the current Query. A lightweight alternative to
296.         to deepcopy().
297.         """
298.         obj = Empty()
299.         obj.__class__ = self.__class__
300.         # Copy references to everything.
301.         obj.__dict__ = self.__dict__.copy()
302.         # Clone attributes that can't use shallow copy.
303.         obj.alias_refcount = self.alias_refcount.copy()
304.         obj.alias_map = self.alias_map.copy()
305.         obj.external_aliases = self.external_aliases.copy()
306.         obj.table_map = self.table_map.copy()
307.         obj.where = self.where.clone()
308.         obj.annotations = self.annotations.copy()
309.         if self.annotation_select_mask is None:
310.             obj.annotation_select_mask = None
311.         else:
312.             obj.annotation_select_mask = self.annotation_select_mask.copy()
313.         # _annotation_select_cache cannot be copied, as doing so breaks the
314.         # (necessary) state in which both annotations and
315.         # _annotation_select_cache point to the same underlying objects.
316.         # It will get re-populated in the cloned queryset the next time it's
317.         # used.
318.         obj._annotation_select_cache = None
319.         obj.extra = self.extra.copy()
320.         if self.extra_select_mask is None:
321.             obj.extra_select_mask = None
322.         else:
323.             obj.extra_select_mask = self.extra_select_mask.copy()
324.         if self._extra_select_cache is None:
325.             obj._extra_select_cache = None
326.         else:
327.             obj._extra_select_cache = self._extra_select_cache.copy()
328.         if self.select_related is not False:
329.             # Use deepcopy because select_related stores fields in nested
330.             # dicts.
331.             obj.select_related = copy.deepcopy(obj.select_related)
332.         if 'subq_aliases' in self.__dict__:
333.             obj.subq_aliases = self.subq_aliases.copy()
334.         obj.used_aliases = self.used_aliases.copy()
335.         obj._filtered_relations = self._filtered_relations.copy()
336.         # Clear the cached_property
337.         try:
338.             del obj.base_table
339.         except AttributeError:
340.             pass
341.         return obj
342. 
343.     def chain(self, klass=None):
344.         """
345.         Return a copy of the current Query that's ready for another operation.
346.         The klass argument changes the type of the Query, e.g. UpdateQuery.
347.         """
348.         obj = self.clone()
349.         if klass and obj.__class__ != klass:
350.             obj.__class__ = klass
351.         if not obj.filter_is_sticky:
352.             obj.used_aliases = set()
353.         obj.filter_is_sticky = False
354.         if hasattr(obj, '_setup_query'):
355.             obj._setup_query()
356.         return obj
357. 
358.     def relabeled_clone(self, change_map):
359.         clone = self.clone()
360.         clone.change_aliases(change_map)
361.         return clone
362. 
363.     def rewrite_cols(self, annotation, col_cnt):
364.         # We must make sure the inner query has the referred columns in it.
365.         # If we are aggregating over an annotation, then Django uses Ref()
366.         # instances to note this. However, if we are annotating over a column
367.         # of a related model, then it might be that column isn't part of the
368.         # SELECT clause of the inner query, and we must manually make sure
369.         # the column is selected. An example case is:
370.         #    .aggregate(Sum('author__awards'))
371.         # Resolving this expression results in a join to author, but there
372.         # is no guarantee the awards column of author is in the select clause
373.         # of the query. Thus we must manually add the column to the inner
374.         # query.
375.         orig_exprs = annotation.get_source_expressions()
376.         new_exprs = []
377.         for expr in orig_exprs:
378.             # FIXME: These conditions are fairly arbitrary. Identify a better
379.             # method of having expressions decide which code path they should
380.             # take.
381.             if isinstance(expr, Ref):
382.                 # Its already a Ref to subquery (see resolve_ref() for
383.                 # details)
384.                 new_exprs.append(expr)
385.             elif isinstance(expr, (WhereNode, Lookup)):
386.                 # Decompose the subexpressions further. The code here is
387.                 # copied from the else clause, but this condition must appear
388.                 # before the contains_aggregate/is_summary condition below.
389.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
390.                 new_exprs.append(new_expr)
391.             else:
392.                 # Reuse aliases of expressions already selected in subquery.
393.                 for col_alias, selected_annotation in self.annotation_select.items():
394.                     if selected_annotation == expr:
395.                         new_expr = Ref(col_alias, expr)
396.                         break
397.                 else:
398.                     # An expression that is not selected the subquery.
399.                     if isinstance(expr, Col) or (expr.contains_aggregate and not expr.is_summary):
400.                         # Reference column or another aggregate. Select it
401.                         # under a non-conflicting alias.
402.                         col_cnt += 1
403.                         col_alias = '__col%d' % col_cnt
404.                         self.annotations[col_alias] = expr
405.                         self.append_annotation_mask([col_alias])
406.                         new_expr = Ref(col_alias, expr)
407.                     else:
408.                         # Some other expression not referencing database values
409.                         # directly. Its subexpression might contain Cols.
410.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
411.                 new_exprs.append(new_expr)
412.         annotation.set_source_expressions(new_exprs)
413.         return annotation, col_cnt
414. 
415.     def get_aggregation(self, using, added_aggregate_names):
416.         """
417.         Return the dictionary with the values of the existing aggregations.
418.         """
419.         if not self.annotation_select:
420.             return {}
421.         existing_annotations = [
422.             annotation for alias, annotation
423.             in self.annotations.items()
424.             if alias not in added_aggregate_names
425.         ]
426.         # Decide if we need to use a subquery.
427.         #
428.         # Existing annotations would cause incorrect results as get_aggregation()
429.         # must produce just one result and thus must not use GROUP BY. But we
430.         # aren't smart enough to remove the existing annotations from the
431.         # query, so those would force us to use GROUP BY.
432.         #
433.         # If the query has limit or distinct, or uses set operations, then
434.         # those operations must be done in a subquery so that the query
435.         # aggregates on the limit and/or distinct results instead of applying
436.         # the distinct and limit after the aggregation.
437.         if (isinstance(self.group_by, tuple) or self.is_sliced or existing_annotations or
438.                 self.distinct or self.combinator):
439.             from django.db.models.sql.subqueries import AggregateQuery
440.             outer_query = AggregateQuery(self.model)
441.             inner_query = self.clone()
442.             inner_query.select_for_update = False
443.             inner_query.select_related = False
444.             inner_query.set_annotation_mask(self.annotation_select)
445.             if not self.is_sliced and not self.distinct_fields:
446.                 # Queries with distinct_fields need ordering and when a limit
447.                 # is applied we must take the slice from the ordered query.
448.                 # Otherwise no need for ordering.
449.                 inner_query.clear_ordering(True)
450.             if not inner_query.distinct:
451.                 # If the inner query uses default select and it has some
452.                 # aggregate annotations, then we must make sure the inner
453.                 # query is grouped by the main model's primary key. However,
454.                 # clearing the select clause can alter results if distinct is
455.                 # used.
456.                 has_existing_aggregate_annotations = any(
457.                     annotation for annotation in existing_annotations
458.                     if getattr(annotation, 'contains_aggregate', True)
459.                 )
460.                 if inner_query.default_cols and has_existing_aggregate_annotations:
461.                     inner_query.group_by = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
462.                 inner_query.default_cols = False
463. 
464.             relabels = {t: 'subquery' for t in inner_query.alias_map}
465.             relabels[None] = 'subquery'
466.             # Remove any aggregates marked for reduction from the subquery
467.             # and move them to the outer AggregateQuery.
468.             col_cnt = 0
469.             for alias, expression in list(inner_query.annotation_select.items()):
470.                 annotation_select_mask = inner_query.annotation_select_mask
471.                 if expression.is_summary:
472.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
473.                     outer_query.annotations[alias] = expression.relabeled_clone(relabels)
474.                     del inner_query.annotations[alias]
475.                     annotation_select_mask.remove(alias)
476.                 # Make sure the annotation_select wont use cached results.
477.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
478.             if inner_query.select == () and not inner_query.default_cols and not inner_query.annotation_select_mask:
479.                 # In case of Model.objects[0:3].count(), there would be no
480.                 # field selected in the inner query, yet we must use a subquery.
481.                 # So, make sure at least one field is selected.
482.                 inner_query.select = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
483.             try:
484.                 outer_query.add_subquery(inner_query, using)
485.             except EmptyResultSet:
486.                 return {
487.                     alias: None
488.                     for alias in outer_query.annotation_select
489.                 }
490.         else:
491.             outer_query = self
492.             self.select = ()
493.             self.default_cols = False
494.             self.extra = {}
495. 
496.         outer_query.clear_ordering(True)
497.         outer_query.clear_limits()
498.         outer_query.select_for_update = False
499.         outer_query.select_related = False
500.         compiler = outer_query.get_compiler(using)
501.         result = compiler.execute_sql(SINGLE)
502.         if result is None:
503.             result = [None] * len(outer_query.annotation_select)
504. 
505.         converters = compiler.get_converters(outer_query.annotation_select.values())
506.         result = next(compiler.apply_converters((result,), converters))
507. 
508.         return dict(zip(outer_query.annotation_select, result))
509. 
510.     def get_count(self, using):
511.         """
512.         Perform a COUNT() query using the current filter constraints.
513.         """
514.         obj = self.clone()
515.         obj.add_annotation(Count('*'), alias='__count', is_summary=True)
516.         number = obj.get_aggregation(using, ['__count'])['__count']
517.         if number is None:
518.             number = 0
519.         return number
520. 
521.     def has_filters(self):
522.         return self.where
523. 
524.     def has_results(self, using):
525.         q = self.clone()
526.         if not q.distinct:
527.             if q.group_by is True:
528.                 q.add_fields((f.attname for f in self.model._meta.concrete_fields), False)
529.                 q.set_group_by()
530.             q.clear_select_clause()
531.         q.clear_ordering(True)
532.         q.set_limits(high=1)
533.         compiler = q.get_compiler(using=using)
534.         return compiler.has_results()
535. 
536.     def explain(self, using, format=None, **options):
537.         q = self.clone()
538.         q.explain_query = True
539.         q.explain_format = format
540.         q.explain_options = options
541.         compiler = q.get_compiler(using=using)
542.         return '\n'.join(compiler.explain_query())
543. 
544.     def combine(self, rhs, connector):
545.         """
546.         Merge the 'rhs' query into the current one (with any 'rhs' effects
547.         being applied *after* (that is, "to the right of") anything in the
548.         current query. 'rhs' is not modified during a call to this function.
549. 
550.         The 'connector' parameter describes how to connect filters from the
551.         'rhs' query.
552.         """
553.         assert self.model == rhs.model, \
554.             "Cannot combine queries on two different base models."
555.         assert not self.is_sliced, \
556.             "Cannot combine queries once a slice has been taken."
557.         assert self.distinct == rhs.distinct, \
558.             "Cannot combine a unique query with a non-unique query."
559.         assert self.distinct_fields == rhs.distinct_fields, \
560.             "Cannot combine queries with different distinct fields."
561. 
562.         # Work out how to relabel the rhs aliases, if necessary.
563.         change_map = {}
564.         conjunction = (connector == AND)
565. 
566.         # Determine which existing joins can be reused. When combining the
567.         # query with AND we must recreate all joins for m2m filters. When
568.         # combining with OR we can reuse joins. The reason is that in AND
569.         # case a single row can't fulfill a condition like:
570.         #     revrel__col=1 & revrel__col=2
571.         # But, there might be two different related rows matching this
572.         # condition. In OR case a single True is enough, so single row is
573.         # enough, too.
574.         #
575.         # Note that we will be creating duplicate joins for non-m2m joins in
576.         # the AND case. The results will be correct but this creates too many
577.         # joins. This is something that could be fixed later on.
578.         reuse = set() if conjunction else set(self.alias_map)
579.         # Base table must be present in the query - this is the same
580.         # table on both sides.
581.         self.get_initial_alias()
582.         joinpromoter = JoinPromoter(connector, 2, False)
583.         joinpromoter.add_votes(
584.             j for j in self.alias_map if self.alias_map[j].join_type == INNER)
585.         rhs_votes = set()
586.         # Now, add the joins from rhs query into the new query (skipping base
587.         # table).
588.         rhs_tables = list(rhs.alias_map)[1:]
589.         for alias in rhs_tables:
590.             join = rhs.alias_map[alias]
591.             # If the left side of the join was already relabeled, use the
592.             # updated alias.
593.             join = join.relabeled_clone(change_map)
594.             new_alias = self.join(join, reuse=reuse)
595.             if join.join_type == INNER:
596.                 rhs_votes.add(new_alias)
597.             # We can't reuse the same join again in the query. If we have two
598.             # distinct joins for the same connection in rhs query, then the
599.             # combined query must have two joins, too.
600.             reuse.discard(new_alias)
601.             if alias != new_alias:
602.                 change_map[alias] = new_alias
603.             if not rhs.alias_refcount[alias]:
604.                 # The alias was unused in the rhs query. Unref it so that it
605.                 # will be unused in the new query, too. We have to add and
606.                 # unref the alias so that join promotion has information of
607.                 # the join type for the unused alias.
608.                 self.unref_alias(new_alias)
609.         joinpromoter.add_votes(rhs_votes)
610.         joinpromoter.update_join_types(self)
611. 
612.         # Now relabel a copy of the rhs where-clause and add it to the current
613.         # one.
614.         w = rhs.where.clone()
615.         w.relabel_aliases(change_map)
616.         self.where.add(w, connector)
617. 
618.         # Selection columns and extra extensions are those provided by 'rhs'.
619.         if rhs.select:
620.             self.set_select([col.relabeled_clone(change_map) for col in rhs.select])
621.         else:
622.             self.select = ()
623. 
624.         if connector == OR:
625.             # It would be nice to be able to handle this, but the queries don't
626.             # really make sense (or return consistent value sets). Not worth
627.             # the extra complexity when you can write a real query instead.
628.             if self.extra and rhs.extra:
629.                 raise ValueError("When merging querysets using 'or', you cannot have extra(select=...) on both sides.")
630.         self.extra.update(rhs.extra)
631.         extra_select_mask = set()
632.         if self.extra_select_mask is not None:
633.             extra_select_mask.update(self.extra_select_mask)
634.         if rhs.extra_select_mask is not None:
635.             extra_select_mask.update(rhs.extra_select_mask)
636.         if extra_select_mask:
637.             self.set_extra_mask(extra_select_mask)
638.         self.extra_tables += rhs.extra_tables
639. 
640.         # Ordering uses the 'rhs' ordering, unless it has none, in which case
641.         # the current ordering is used.
642.         self.order_by = rhs.order_by or self.order_by
643.         self.extra_order_by = rhs.extra_order_by or self.extra_order_by
644. 
645.     def deferred_to_data(self, target, callback):
646.         """
647.         Convert the self.deferred_loading data structure to an alternate data
648.         structure, describing the field that *will* be loaded. This is used to
649.         compute the columns to select from the database and also by the
650.         QuerySet class to work out which fields are being initialized on each
651.         model. Models that have all their fields included aren't mentioned in
652.         the result, only those that have field restrictions in place.
653. 
654.         The "target" parameter is the instance that is populated (in place).
655.         The "callback" is a function that is called whenever a (model, field)
656.         pair need to be added to "target". It accepts three parameters:
657.         "target", and the model and list of fields being added for that model.
658.         """
659.         field_names, defer = self.deferred_loading
660.         if not field_names:
661.             return
662.         orig_opts = self.get_meta()
663.         seen = {}
664.         must_include = {orig_opts.concrete_model: {orig_opts.pk}}
665.         for field_name in field_names:
666.             parts = field_name.split(LOOKUP_SEP)
667.             cur_model = self.model._meta.concrete_model
668.             opts = orig_opts
669.             for name in parts[:-1]:
670.                 old_model = cur_model
671.                 if name in self._filtered_relations:
672.                     name = self._filtered_relations[name].relation_name
673.                 source = opts.get_field(name)
674.                 if is_reverse_o2o(source):
675.                     cur_model = source.related_model
676.                 else:
677.                     cur_model = source.remote_field.model
678.                 opts = cur_model._meta
679.                 # Even if we're "just passing through" this model, we must add
680.                 # both the current model's pk and the related reference field
681.                 # (if it's not a reverse relation) to the things we select.
682.                 if not is_reverse_o2o(source):
683.                     must_include[old_model].add(source)
684.                 add_to_dict(must_include, cur_model, opts.pk)
685.             field = opts.get_field(parts[-1])
686.             is_reverse_object = field.auto_created and not field.concrete
687.             model = field.related_model if is_reverse_object else field.model
688.             model = model._meta.concrete_model
689.             if model == opts.model:
690.                 model = cur_model
691.             if not is_reverse_o2o(field):
692.                 add_to_dict(seen, model, field)
693. 
694.         if defer:
695.             # We need to load all fields for each model, except those that
696.             # appear in "seen" (for all models that appear in "seen"). The only
697.             # slight complexity here is handling fields that exist on parent
698.             # models.
699.             workset = {}
700.             for model, values in seen.items():
701.                 for field in model._meta.local_fields:
702.                     if field not in values:
703.                         m = field.model._meta.concrete_model
704.                         add_to_dict(workset, m, field)
705.             for model, values in must_include.items():
706.                 # If we haven't included a model in workset, we don't add the
707.                 # corresponding must_include fields for that model, since an
708.                 # empty set means "include all fields". That's why there's no
709.                 # "else" branch here.
710.                 if model in workset:
711.                     workset[model].update(values)
712.             for model, values in workset.items():
713.                 callback(target, model, values)
714.         else:
715.             for model, values in must_include.items():
716.                 if model in seen:
717.                     seen[model].update(values)
718.                 else:
719.                     # As we've passed through this model, but not explicitly
720.                     # included any fields, we have to make sure it's mentioned
721.                     # so that only the "must include" fields are pulled in.
722.                     seen[model] = values
723.             # Now ensure that every model in the inheritance chain is mentioned
724.             # in the parent list. Again, it must be mentioned to ensure that
725.             # only "must include" fields are pulled in.
726.             for model in orig_opts.get_parent_list():
727.                 seen.setdefault(model, set())
728.             for model, values in seen.items():
729.                 callback(target, model, values)
730. 
731.     def table_alias(self, table_name, create=False, filtered_relation=None):
732.         """
733.         Return a table alias for the given table_name and whether this is a
734.         new alias or not.
735. 
736.         If 'create' is true, a new alias is always created. Otherwise, the
737.         most recently created alias for the table (if one exists) is reused.
738.         """
739.         alias_list = self.table_map.get(table_name)
740.         if not create and alias_list:
741.             alias = alias_list[0]
742.             self.alias_refcount[alias] += 1
743.             return alias, False
744. 
745.         # Create a new alias for this table.
746.         if alias_list:
747.             alias = '%s%d' % (self.alias_prefix, len(self.alias_map) + 1)
748.             alias_list.append(alias)
749.         else:
750.             # The first occurrence of a table uses the table name directly.
751.             alias = filtered_relation.alias if filtered_relation is not None else table_name
752.             self.table_map[table_name] = [alias]
753.         self.alias_refcount[alias] = 1
754.         return alias, True
755. 
756.     def ref_alias(self, alias):
757.         """Increases the reference count for this alias."""
758.         self.alias_refcount[alias] += 1
759. 
760.     def unref_alias(self, alias, amount=1):
761.         """Decreases the reference count for this alias."""
762.         self.alias_refcount[alias] -= amount
763. 
764.     def promote_joins(self, aliases):
765.         """
766.         Promote recursively the join type of given aliases and its children to
767.         an outer join. If 'unconditional' is False, only promote the join if
768.         it is nullable or the parent join is an outer join.
769. 
770.         The children promotion is done to avoid join chains that contain a LOUTER
771.         b INNER c. So, if we have currently a INNER b INNER c and a->b is promoted,
772.         then we must also promote b->c automatically, or otherwise the promotion
773.         of a->b doesn't actually change anything in the query results.
774.         """
775.         aliases = list(aliases)
776.         while aliases:
777.             alias = aliases.pop(0)
778.             if self.alias_map[alias].join_type is None:
779.                 # This is the base table (first FROM entry) - this table
780.                 # isn't really joined at all in the query, so we should not
781.                 # alter its join type.
782.                 continue
783.             # Only the first alias (skipped above) should have None join_type
784.             assert self.alias_map[alias].join_type is not None
785.             parent_alias = self.alias_map[alias].parent_alias
786.             parent_louter = parent_alias and self.alias_map[parent_alias].join_type == LOUTER
787.             already_louter = self.alias_map[alias].join_type == LOUTER
788.             if ((self.alias_map[alias].nullable or parent_louter) and
789.                     not already_louter):
790.                 self.alias_map[alias] = self.alias_map[alias].promote()
791.                 # Join type of 'alias' changed, so re-examine all aliases that
792.                 # refer to this one.
793.                 aliases.extend(
794.                     join for join in self.alias_map
795.                     if self.alias_map[join].parent_alias == alias and join not in aliases
796.                 )
797. 
798.     def demote_joins(self, aliases):
799.         """
800.         Change join type from LOUTER to INNER for all joins in aliases.
801. 
802.         Similarly to promote_joins(), this method must ensure no join chains
803.         containing first an outer, then an inner join are generated. If we
804.         are demoting b->c join in chain a LOUTER b LOUTER c then we must
805.         demote a->b automatically, or otherwise the demotion of b->c doesn't
806.         actually change anything in the query results. .
807.         """
808.         aliases = list(aliases)
809.         while aliases:
810.             alias = aliases.pop(0)
811.             if self.alias_map[alias].join_type == LOUTER:
812.                 self.alias_map[alias] = self.alias_map[alias].demote()
813.                 parent_alias = self.alias_map[alias].parent_alias
814.                 if self.alias_map[parent_alias].join_type == INNER:
815.                     aliases.append(parent_alias)
816. 
817.     def reset_refcounts(self, to_counts):
818.         """
819.         Reset reference counts for aliases so that they match the value passed
820.         in `to_counts`.
821.         """
822.         for alias, cur_refcount in self.alias_refcount.copy().items():
823.             unref_amount = cur_refcount - to_counts.get(alias, 0)
824.             self.unref_alias(alias, unref_amount)
825. 
826.     def change_aliases(self, change_map):
827.         """
828.         Change the aliases in change_map (which maps old-alias -> new-alias),
829.         relabelling any references to them in select columns and the where
830.         clause.
831.         """
832.         assert set(change_map).isdisjoint(change_map.values())
833. 
834.         # 1. Update references in "select" (normal columns plus aliases),
835.         # "group by" and "where".
836.         self.where.relabel_aliases(change_map)
837.         if isinstance(self.group_by, tuple):
838.             self.group_by = tuple([col.relabeled_clone(change_map) for col in self.group_by])
839.         self.select = tuple([col.relabeled_clone(change_map) for col in self.select])
840.         self.annotations = self.annotations and {
841.             key: col.relabeled_clone(change_map) for key, col in self.annotations.items()
842.         }
843. 
844.         # 2. Rename the alias in the internal table/alias datastructures.
845.         for old_alias, new_alias in change_map.items():
846.             if old_alias not in self.alias_map:
847.                 continue
848.             alias_data = self.alias_map[old_alias].relabeled_clone(change_map)
849.             self.alias_map[new_alias] = alias_data
850.             self.alias_refcount[new_alias] = self.alias_refcount[old_alias]
851.             del self.alias_refcount[old_alias]
852.             del self.alias_map[old_alias]
853. 
854.             table_aliases = self.table_map[alias_data.table_name]
855.             for pos, alias in enumerate(table_aliases):
856.                 if alias == old_alias:
857.                     table_aliases[pos] = new_alias
858.                     break
859.         self.external_aliases = {change_map.get(alias, alias)
860.                                  for alias in self.external_aliases}
861. 
862.     def bump_prefix(self, outer_query):
863.         """
864.         Change the alias prefix to the next letter in the alphabet in a way
865.         that the outer query's aliases and this query's aliases will not
866.         conflict. Even tables that previously had no alias will get an alias
867.         after this call.
868.         """
869.         def prefix_gen():
870.             """
871.             Generate a sequence of characters in alphabetical order:
872.                 -> 'A', 'B', 'C', ...
873. 
874.             When the alphabet is finished, the sequence will continue with the
875.             Cartesian product:
876.                 -> 'AA', 'AB', 'AC', ...
877.             """
878.             alphabet = ascii_uppercase
879.             prefix = chr(ord(self.alias_prefix) + 1)
880.             yield prefix
881.             for n in count(1):
882.                 seq = alphabet[alphabet.index(prefix):] if prefix else alphabet
883.                 for s in product(seq, repeat=n):
884.                     yield ''.join(s)
885.                 prefix = None
886. 
887.         if self.alias_prefix != outer_query.alias_prefix:
888.             # No clashes between self and outer query should be possible.
889.             return
890. 
891.         # Explicitly avoid infinite loop. The constant divider is based on how
892.         # much depth recursive subquery references add to the stack. This value
893.         # might need to be adjusted when adding or removing function calls from
894.         # the code path in charge of performing these operations.
895.         local_recursion_limit = sys.getrecursionlimit() // 16
896.         for pos, prefix in enumerate(prefix_gen()):
897.             if prefix not in self.subq_aliases:
898.                 self.alias_prefix = prefix
899.                 break
900.             if pos > local_recursion_limit:
901.                 raise RecursionError(
902.                     'Maximum recursion depth exceeded: too many subqueries.'
903.                 )
904.         self.subq_aliases = self.subq_aliases.union([self.alias_prefix])
905.         outer_query.subq_aliases = outer_query.subq_aliases.union(self.subq_aliases)
906.         self.change_aliases({
907.             alias: '%s%d' % (self.alias_prefix, pos)
908.             for pos, alias in enumerate(self.alias_map)
909.         })
910. 
911.     def get_initial_alias(self):
912.         """
913.         Return the first alias for this query, after increasing its reference
914.         count.
915.         """
916.         if self.alias_map:
917.             alias = self.base_table
918.             self.ref_alias(alias)
919.         else:
920.             alias = self.join(BaseTable(self.get_meta().db_table, None))
921.         return alias
922. 
923.     def count_active_tables(self):
924.         """
925.         Return the number of tables in this query with a non-zero reference
926.         count. After execution, the reference counts are zeroed, so tables
927.         added in compiler will not be seen by this method.
928.         """
929.         return len([1 for count in self.alias_refcount.values() if count])
930. 
931.     def join(self, join, reuse=None, reuse_with_filtered_relation=False):
932.         """
933.         Return an alias for the 'join', either reusing an existing alias for
934.         that join or creating a new one. 'join' is either a
935.         sql.datastructures.BaseTable or Join.
936. 
937.         The 'reuse' parameter can be either None which means all joins are
938.         reusable, or it can be a set containing the aliases that can be reused.
939. 
940.         The 'reuse_with_filtered_relation' parameter is used when computing
941.         FilteredRelation instances.
942. 
943.         A join is always created as LOUTER if the lhs alias is LOUTER to make
944.         sure chains like t1 LOUTER t2 INNER t3 aren't generated. All new
945.         joins are created as LOUTER if the join is nullable.
946.         """
947.         if reuse_with_filtered_relation and reuse:
948.             reuse_aliases = [
949.                 a for a, j in self.alias_map.items()
950.                 if a in reuse and j.equals(join, with_filtered_relation=False)
951.             ]
952.         else:
953.             reuse_aliases = [
954.                 a for a, j in self.alias_map.items()
955.                 if (reuse is None or a in reuse) and j == join
956.             ]
957.         if reuse_aliases:
958.             if join.table_alias in reuse_aliases:
959.                 reuse_alias = join.table_alias
960.             else:
961.                 # Reuse the most recent alias of the joined table
962.                 # (a many-to-many relation may be joined multiple times).
963.                 reuse_alias = reuse_aliases[-1]
964.             self.ref_alias(reuse_alias)
965.             return reuse_alias
966. 
967.         # No reuse is possible, so we need a new alias.
968.         alias, _ = self.table_alias(join.table_name, create=True, filtered_relation=join.filtered_relation)
969.         if join.join_type:
970.             if self.alias_map[join.parent_alias].join_type == LOUTER or join.nullable:
971.                 join_type = LOUTER
972.             else:
973.                 join_type = INNER
974.             join.join_type = join_type
975.         join.table_alias = alias
976.         self.alias_map[alias] = join
977.         return alias
978. 
979.     def join_parent_model(self, opts, model, alias, seen):
980.         """
981.         Make sure the given 'model' is joined in the query. If 'model' isn't
982.         a parent of 'opts' or if it is None this method is a no-op.
983. 
984.         The 'alias' is the root alias for starting the join, 'seen' is a dict
985.         of model -> alias of existing joins. It must also contain a mapping
986.         of None -> some alias. This will be returned in the no-op case.
987.         """
988.         if model in seen:
989.             return seen[model]
990.         chain = opts.get_base_chain(model)
991.         if not chain:
992.             return alias
993.         curr_opts = opts
994.         for int_model in chain:
995.             if int_model in seen:
996.                 curr_opts = int_model._meta
997.                 alias = seen[int_model]
998.                 continue
999.             # Proxy model have elements in base chain
1000.             # with no parents, assign the new options
1001.             # object and skip to the next base in that
1002.             # case
1003.             if not curr_opts.parents[int_model]:
1004.                 curr_opts = int_model._meta
1005.                 continue
1006.             link_field = curr_opts.get_ancestor_link(int_model)
1007.             join_info = self.setup_joins([link_field.name], curr_opts, alias)
1008.             curr_opts = int_model._meta
1009.             alias = seen[int_model] = join_info.joins[-1]
1010.         return alias or seen[None]
1011. 
1012.     def add_annotation(self, annotation, alias, is_summary=False):
1013.         """Add a single annotation expression to the Query."""
1014.         annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None,
1015.                                                    summarize=is_summary)
1016.         self.append_annotation_mask([alias])
1017.         self.annotations[alias] = annotation
1018. 
1019.     def resolve_expression(self, query, *args, **kwargs):
1020.         clone = self.clone()
1021.         # Subqueries need to use a different set of aliases than the outer query.
1022.         clone.bump_prefix(query)
1023.         clone.subquery = True
1024.         # It's safe to drop ordering if the queryset isn't using slicing,
1025.         # distinct(*fields) or select_for_update().
1026.         if (self.low_mark == 0 and self.high_mark is None and
1027.                 not self.distinct_fields and
1028.                 not self.select_for_update):
1029.             clone.clear_ordering(True)
1030.         clone.where.resolve_expression(query, *args, **kwargs)
1031.         for key, value in clone.annotations.items():
1032.             resolved = value.resolve_expression(query, *args, **kwargs)
1033.             if hasattr(resolved, 'external_aliases'):
1034.                 resolved.external_aliases.update(clone.alias_map)
1035.             clone.annotations[key] = resolved
1036.         # Outer query's aliases are considered external.
1037.         clone.external_aliases.update(
1038.             alias for alias, table in query.alias_map.items()
1039.             if (
1040.                 isinstance(table, Join) and table.join_field.related_model._meta.db_table != alias
1041.             ) or (
1042.                 isinstance(table, BaseTable) and table.table_name != table.table_alias
1043.             )
1044.         )
1045.         return clone
1046. 
1047.     def as_sql(self, compiler, connection):
1048.         sql, params = self.get_compiler(connection=connection).as_sql()
1049.         if self.subquery:
1050.             sql = '(%s)' % sql
1051.         return sql, params
1052. 
1053.     def resolve_lookup_value(self, value, can_reuse, allow_joins, simple_col):
1054.         if hasattr(value, 'resolve_expression'):
1055.             kwargs = {'reuse': can_reuse, 'allow_joins': allow_joins}
1056.             if isinstance(value, F):
1057.                 kwargs['simple_col'] = simple_col
1058.             value = value.resolve_expression(self, **kwargs)
1059.         elif isinstance(value, (list, tuple)):
1060.             # The items of the iterable may be expressions and therefore need
1061.             # to be resolved independently.
1062.             resolved_values = []
1063.             for sub_value in value:
1064.                 if hasattr(sub_value, 'resolve_expression'):
1065.                     if isinstance(sub_value, F):
1066.                         resolved_values.append(sub_value.resolve_expression(
1067.                             self, reuse=can_reuse, allow_joins=allow_joins,
1068.                             simple_col=simple_col,
1069.                         ))
1070.                     else:
1071.                         resolved_values.append(sub_value.resolve_expression(
1072.                             self, reuse=can_reuse, allow_joins=allow_joins,
1073.                         ))
1074.                 else:
1075.                     resolved_values.append(sub_value)
1076.             value = tuple(resolved_values)
1077.         return value
1078. 
1079.     def solve_lookup_type(self, lookup):
1080.         """
1081.         Solve the lookup type from the lookup (e.g.: 'foobar__id__icontains').
1082.         """
1083.         lookup_splitted = lookup.split(LOOKUP_SEP)
1084.         if self.annotations:
1085.             expression, expression_lookups = refs_expression(lookup_splitted, self.annotations)
1086.             if expression:
1087.                 return expression_lookups, (), expression
1088.         _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
1089.         field_parts = lookup_splitted[0:len(lookup_splitted) - len(lookup_parts)]
1090.         if len(lookup_parts) > 1 and not field_parts:
1091.             raise FieldError(
1092.                 'Invalid lookup "%s" for model %s".' %
1093.                 (lookup, self.get_meta().model.__name__)
1094.             )
1095.         return lookup_parts, field_parts, False
1096. 
1097.     def check_query_object_type(self, value, opts, field):
1098.         """
1099.         Check whether the object passed while querying is of the correct type.
1100.         If not, raise a ValueError specifying the wrong object.
1101.         """
1102.         if hasattr(value, '_meta'):
1103.             if not check_rel_lookup_compatibility(value._meta.model, opts, field):
1104.                 raise ValueError(
1105.                     'Cannot query "%s": Must be "%s" instance.' %
1106.                     (value, opts.object_name))
1107. 
1108.     def check_related_objects(self, field, value, opts):
1109.         """Check the type of object passed to query relations."""
1110.         if field.is_relation:
1111.             # Check that the field and the queryset use the same model in a
1112.             # query like .filter(author=Author.objects.all()). For example, the
1113.             # opts would be Author's (from the author field) and value.model
1114.             # would be Author.objects.all() queryset's .model (Author also).
1115.             # The field is the related field on the lhs side.
1116.             if (isinstance(value, Query) and not value.has_select_fields and
1117.                     not check_rel_lookup_compatibility(value.model, opts, field)):
1118.                 raise ValueError(
1119.                     'Cannot use QuerySet for "%s": Use a QuerySet for "%s".' %
1120.                     (value.model._meta.object_name, opts.object_name)
1121.                 )
1122.             elif hasattr(value, '_meta'):
1123.                 self.check_query_object_type(value, opts, field)
1124.             elif hasattr(value, '__iter__'):
1125.                 for v in value:
1126.                     self.check_query_object_type(v, opts, field)
1127. 
1128.     def check_filterable(self, expression):
1129.         """Raise an error if expression cannot be used in a WHERE clause."""
1130.         if not getattr(expression, 'filterable', 'True'):
1131.             raise NotSupportedError(
1132.                 expression.__class__.__name__ + ' is disallowed in the filter '
1133.                 'clause.'
1134.             )
1135.         if hasattr(expression, 'get_source_expressions'):
1136.             for expr in expression.get_source_expressions():
1137.                 self.check_filterable(expr)
1138. 
1139.     def build_lookup(self, lookups, lhs, rhs):
1140.         """
1141.         Try to extract transforms and lookup from given lhs.
1142. 
1143.         The lhs value is something that works like SQLExpression.
1144.         The rhs value is what the lookup is going to compare against.
1145.         The lookups is a list of names to extract using get_lookup()
1146.         and get_transform().
1147.         """
1148.         # __exact is the default lookup if one isn't given.
1149.         *transforms, lookup_name = lookups or ['exact']
1150.         for name in transforms:
1151.             lhs = self.try_transform(lhs, name)
1152.         # First try get_lookup() so that the lookup takes precedence if the lhs
1153.         # supports both transform and lookup for the name.
1154.         lookup_class = lhs.get_lookup(lookup_name)
1155.         if not lookup_class:
1156.             if lhs.field.is_relation:
1157.                 raise FieldError('Related Field got invalid lookup: {}'.format(lookup_name))
1158.             # A lookup wasn't found. Try to interpret the name as a transform
1159.             # and do an Exact lookup against it.
1160.             lhs = self.try_transform(lhs, lookup_name)
1161.             lookup_name = 'exact'
1162.             lookup_class = lhs.get_lookup(lookup_name)
1163.             if not lookup_class:
1164.                 return
1165. 
1166.         lookup = lookup_class(lhs, rhs)
1167.         # Interpret '__exact=None' as the sql 'is NULL'; otherwise, reject all
1168.         # uses of None as a query value unless the lookup supports it.
1169.         if lookup.rhs is None and not lookup.can_use_none_as_rhs:
1170.             if lookup_name not in ('exact', 'iexact'):
1171.                 raise ValueError("Cannot use None as a query value")
1172.             return lhs.get_lookup('isnull')(lhs, True)
1173. 
1174.         # For Oracle '' is equivalent to null. The check must be done at this
1175.         # stage because join promotion can't be done in the compiler. Using
1176.         # DEFAULT_DB_ALIAS isn't nice but it's the best that can be done here.
1177.         # A similar thing is done in is_nullable(), too.
1178.         if (connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls and
1179.                 lookup_name == 'exact' and lookup.rhs == ''):
1180.             return lhs.get_lookup('isnull')(lhs, True)
1181. 
1182.         return lookup
1183. 
1184.     def try_transform(self, lhs, name):
1185.         """
1186.         Helper method for build_lookup(). Try to fetch and initialize
1187.         a transform for name parameter from lhs.
1188.         """
1189.         transform_class = lhs.get_transform(name)
1190.         if transform_class:
1191.             return transform_class(lhs)
1192.         else:
1193.             output_field = lhs.output_field.__class__
1194.             suggested_lookups = difflib.get_close_matches(name, output_field.get_lookups())
1195.             if suggested_lookups:
1196.                 suggestion = ', perhaps you meant %s?' % ' or '.join(suggested_lookups)
1197.             else:
1198.                 suggestion = '.'
1199.             raise FieldError(
1200.                 "Unsupported lookup '%s' for %s or join on the field not "
1201.                 "permitted%s" % (name, output_field.__name__, suggestion)
1202.             )
1203. 
1204.     def build_filter(self, filter_expr, branch_negated=False, current_negated=False,
1205.                      can_reuse=None, allow_joins=True, split_subq=True,
1206.                      reuse_with_filtered_relation=False, simple_col=False):
1207.         """
1208.         Build a WhereNode for a single filter clause but don't add it
1209.         to this Query. Query.add_q() will then add this filter to the where
1210.         Node.
1211. 
1212.         The 'branch_negated' tells us if the current branch contains any
1213.         negations. This will be used to determine if subqueries are needed.
1214. 
1215.         The 'current_negated' is used to determine if the current filter is
1216.         negated or not and this will be used to determine if IS NULL filtering
1217.         is needed.
1218. 
1219.         The difference between current_negated and branch_negated is that
1220.         branch_negated is set on first negation, but current_negated is
1221.         flipped for each negation.
1222. 
1223.         Note that add_filter will not do any negating itself, that is done
1224.         upper in the code by add_q().
1225. 
1226.         The 'can_reuse' is a set of reusable joins for multijoins.
1227. 
1228.         If 'reuse_with_filtered_relation' is True, then only joins in can_reuse
1229.         will be reused.
1230. 
1231.         The method will create a filter clause that can be added to the current
1232.         query. However, if the filter isn't added to the query then the caller
1233.         is responsible for unreffing the joins used.
1234.         """
1235.         if isinstance(filter_expr, dict):
1236.             raise FieldError("Cannot parse keyword query as dict")
1237.         if hasattr(filter_expr, 'resolve_expression') and getattr(filter_expr, 'conditional', False):
1238.             if connections[DEFAULT_DB_ALIAS].ops.conditional_expression_supported_in_where_clause(filter_expr):
1239.                 condition = filter_expr.resolve_expression(self)
1240.             else:
1241.                 # Expression is not supported in the WHERE clause, add
1242.                 # comparison with True.
1243.                 condition = self.build_lookup(['exact'], filter_expr.resolve_expression(self), True)
1244.             clause = self.where_class()
1245.             clause.add(condition, AND)
1246.             return clause, []
1247.         arg, value = filter_expr
1248.         if not arg:
1249.             raise FieldError("Cannot parse keyword query %r" % arg)
1250.         lookups, parts, reffed_expression = self.solve_lookup_type(arg)
1251. 
1252.         self.check_filterable(reffed_expression)
1253. 
1254.         if not allow_joins and len(parts) > 1:
1255.             raise FieldError("Joined field references are not permitted in this query")
1256. 
1257.         pre_joins = self.alias_refcount.copy()
1258.         value = self.resolve_lookup_value(value, can_reuse, allow_joins, simple_col)
1259.         used_joins = {k for k, v in self.alias_refcount.items() if v > pre_joins.get(k, 0)}
1260. 
1261.         self.check_filterable(value)
1262. 
1263.         clause = self.where_class()
1264.         if reffed_expression:
1265.             condition = self.build_lookup(lookups, reffed_expression, value)
1266.             clause.add(condition, AND)
1267.             return clause, []
1268. 
1269.         opts = self.get_meta()
1270.         alias = self.get_initial_alias()
1271.         allow_many = not branch_negated or not split_subq
1272. 
1273.         try:
1274.             join_info = self.setup_joins(
1275.                 parts, opts, alias, can_reuse=can_reuse, allow_many=allow_many,
1276.                 reuse_with_filtered_relation=reuse_with_filtered_relation,
1277.             )
1278. 
1279.             # Prevent iterator from being consumed by check_related_objects()
1280.             if isinstance(value, Iterator):
1281.                 value = list(value)
1282.             self.check_related_objects(join_info.final_field, value, join_info.opts)
1283. 
1284.             # split_exclude() needs to know which joins were generated for the
1285.             # lookup parts
1286.             self._lookup_joins = join_info.joins
1287.         except MultiJoin as e:
1288.             return self.split_exclude(filter_expr, can_reuse, e.names_with_path)
1289. 
1290.         # Update used_joins before trimming since they are reused to determine
1291.         # which joins could be later promoted to INNER.
1292.         used_joins.update(join_info.joins)
1293.         targets, alias, join_list = self.trim_joins(join_info.targets, join_info.joins, join_info.path)
1294.         if can_reuse is not None:
1295.             can_reuse.update(join_list)
1296. 
1297.         if join_info.final_field.is_relation:
1298.             # No support for transforms for relational fields
1299.             num_lookups = len(lookups)
1300.             if num_lookups > 1:
1301.                 raise FieldError('Related Field got invalid lookup: {}'.format(lookups[0]))
1302.             if len(targets) == 1:
1303.                 col = _get_col(targets[0], join_info.final_field, alias, simple_col)
1304.             else:
1305.                 col = MultiColSource(alias, targets, join_info.targets, join_info.final_field)
1306.         else:
1307.             col = _get_col(targets[0], join_info.final_field, alias, simple_col)
1308. 
1309.         condition = self.build_lookup(lookups, col, value)
1310.         lookup_type = condition.lookup_name
1311.         clause.add(condition, AND)
1312. 
1313.         require_outer = lookup_type == 'isnull' and condition.rhs is True and not current_negated
1314.         if current_negated and (lookup_type != 'isnull' or condition.rhs is False) and condition.rhs is not None:
1315.             require_outer = True
1316.             if (lookup_type != 'isnull' and (
1317.                     self.is_nullable(targets[0]) or
1318.                     self.alias_map[join_list[-1]].join_type == LOUTER)):
1319.                 # The condition added here will be SQL like this:
1320.                 # NOT (col IS NOT NULL), where the first NOT is added in
1321.                 # upper layers of code. The reason for addition is that if col
1322.                 # is null, then col != someval will result in SQL "unknown"
1323.                 # which isn't the same as in Python. The Python None handling
1324.                 # is wanted, and it can be gotten by
1325.                 # (col IS NULL OR col != someval)
1326.                 #   <=>
1327.                 # NOT (col IS NOT NULL AND col = someval).
1328.                 lookup_class = targets[0].get_lookup('isnull')
1329.                 col = _get_col(targets[0], join_info.targets[0], alias, simple_col)
1330.                 clause.add(lookup_class(col, False), AND)
1331.         return clause, used_joins if not require_outer else ()
1332. 
1333.     def add_filter(self, filter_clause):
1334.         self.add_q(Q(**{filter_clause[0]: filter_clause[1]}))
1335. 
1336.     def add_q(self, q_object):
1337.         """
1338.         A preprocessor for the internal _add_q(). Responsible for doing final
1339.         join promotion.
1340.         """
1341.         # For join promotion this case is doing an AND for the added q_object
1342.         # and existing conditions. So, any existing inner join forces the join
1343.         # type to remain inner. Existing outer joins can however be demoted.
1344.         # (Consider case where rel_a is LOUTER and rel_a__col=1 is added - if
1345.         # rel_a doesn't produce any rows, then the whole condition must fail.
1346.         # So, demotion is OK.
1347.         existing_inner = {a for a in self.alias_map if self.alias_map[a].join_type == INNER}
1348.         clause, _ = self._add_q(q_object, self.used_aliases)
1349.         if clause:
1350.             self.where.add(clause, AND)
1351.         self.demote_joins(existing_inner)
1352. 
1353.     def build_where(self, q_object):
1354.         return self._add_q(q_object, used_aliases=set(), allow_joins=False, simple_col=True)[0]
1355. 
1356.     def _add_q(self, q_object, used_aliases, branch_negated=False,
1357.                current_negated=False, allow_joins=True, split_subq=True,
1358.                simple_col=False):
1359.         """Add a Q-object to the current filter."""
1360.         connector = q_object.connector
1361.         current_negated = current_negated ^ q_object.negated
1362.         branch_negated = branch_negated or q_object.negated
1363.         target_clause = self.where_class(connector=connector,
1364.                                          negated=q_object.negated)
1365.         joinpromoter = JoinPromoter(q_object.connector, len(q_object.children), current_negated)
1366.         for child in q_object.children:
1367.             if isinstance(child, Node):
1368.                 child_clause, needed_inner = self._add_q(
1369.                     child, used_aliases, branch_negated,
1370.                     current_negated, allow_joins, split_subq, simple_col)
1371.                 joinpromoter.add_votes(needed_inner)
1372.             else:
1373.                 child_clause, needed_inner = self.build_filter(
1374.                     child, can_reuse=used_aliases, branch_negated=branch_negated,
1375.                     current_negated=current_negated, allow_joins=allow_joins,
1376.                     split_subq=split_subq, simple_col=simple_col,
1377.                 )
1378.                 joinpromoter.add_votes(needed_inner)
1379.             if child_clause:
1380.                 target_clause.add(child_clause, connector)
1381.         needed_inner = joinpromoter.update_join_types(self)
1382.         return target_clause, needed_inner
1383. 
1384.     def build_filtered_relation_q(self, q_object, reuse, branch_negated=False, current_negated=False):
1385.         """Add a FilteredRelation object to the current filter."""
1386.         connector = q_object.connector
1387.         current_negated ^= q_object.negated
1388.         branch_negated = branch_negated or q_object.negated
1389.         target_clause = self.where_class(connector=connector, negated=q_object.negated)
1390.         for child in q_object.children:
1391.             if isinstance(child, Node):
1392.                 child_clause = self.build_filtered_relation_q(
1393.                     child, reuse=reuse, branch_negated=branch_negated,
1394.                     current_negated=current_negated,
1395.                 )
1396.             else:
1397.                 child_clause, _ = self.build_filter(
1398.                     child, can_reuse=reuse, branch_negated=branch_negated,
1399.                     current_negated=current_negated,
1400.                     allow_joins=True, split_subq=False,
1401.                     reuse_with_filtered_relation=True,
1402.                 )
1403.             target_clause.add(child_clause, connector)
1404.         return target_clause
1405. 
1406.     def add_filtered_relation(self, filtered_relation, alias):
1407.         filtered_relation.alias = alias
1408.         lookups = dict(get_children_from_q(filtered_relation.condition))
1409.         for lookup in chain((filtered_relation.relation_name,), lookups):
1410.             lookup_parts, field_parts, _ = self.solve_lookup_type(lookup)
1411.             shift = 2 if not lookup_parts else 1
1412.             if len(field_parts) > (shift + len(lookup_parts)):
1413.                 raise ValueError(
1414.                     "FilteredRelation's condition doesn't support nested "
1415.                     "relations (got %r)." % lookup
1416.                 )
1417.         self._filtered_relations[filtered_relation.alias] = filtered_relation
1418. 
1419.     def names_to_path(self, names, opts, allow_many=True, fail_on_missing=False):
1420.         """
1421.         Walk the list of names and turns them into PathInfo tuples. A single
1422.         name in 'names' can generate multiple PathInfos (m2m, for example).
1423. 
1424.         'names' is the path of names to travel, 'opts' is the model Options we
1425.         start the name resolving from, 'allow_many' is as for setup_joins().
1426.         If fail_on_missing is set to True, then a name that can't be resolved
1427.         will generate a FieldError.
1428. 
1429.         Return a list of PathInfo tuples. In addition return the final field
1430.         (the last used join field) and target (which is a field guaranteed to
1431.         contain the same value as the final field). Finally, return those names
1432.         that weren't found (which are likely transforms and the final lookup).
1433.         """
1434.         path, names_with_path = [], []
1435.         for pos, name in enumerate(names):
1436.             cur_names_with_path = (name, [])
1437.             if name == 'pk':
1438.                 name = opts.pk.name
1439. 
1440.             field = None
1441.             filtered_relation = None
1442.             try:
1443.                 field = opts.get_field(name)
1444.             except FieldDoesNotExist:
1445.                 if name in self.annotation_select:
1446.                     field = self.annotation_select[name].output_field
1447.                 elif name in self._filtered_relations and pos == 0:
1448.                     filtered_relation = self._filtered_relations[name]
1449.                     field = opts.get_field(filtered_relation.relation_name)
1450.             if field is not None:
1451.                 # Fields that contain one-to-many relations with a generic
1452.                 # model (like a GenericForeignKey) cannot generate reverse
1453.                 # relations and therefore cannot be used for reverse querying.
1454.                 if field.is_relation and not field.related_model:
1455.                     raise FieldError(
1456.                         "Field %r does not generate an automatic reverse "
1457.                         "relation and therefore cannot be used for reverse "
1458.                         "querying. If it is a GenericForeignKey, consider "
1459.                         "adding a GenericRelation." % name
1460.                     )
1461.                 try:
1462.                     model = field.model._meta.concrete_model
1463.                 except AttributeError:
1464.                     # QuerySet.annotate() may introduce fields that aren't
1465.                     # attached to a model.
1466.                     model = None
1467.             else:
1468.                 # We didn't find the current field, so move position back
1469.                 # one step.
1470.                 pos -= 1
1471.                 if pos == -1 or fail_on_missing:
1472.                     available = sorted([
1473.                         *get_field_names_from_opts(opts),
1474.                         *self.annotation_select,
1475.                         *self._filtered_relations,
1476.                     ])
1477.                     raise FieldError("Cannot resolve keyword '%s' into field. "
1478.                                      "Choices are: %s" % (name, ", ".join(available)))
1479.                 break
1480.             # Check if we need any joins for concrete inheritance cases (the
1481.             # field lives in parent, but we are currently in one of its
1482.             # children)
1483.             if model is not opts.model:
1484.                 path_to_parent = opts.get_path_to_parent(model)
1485.                 if path_to_parent:
1486.                     path.extend(path_to_parent)
1487.                     cur_names_with_path[1].extend(path_to_parent)
1488.                     opts = path_to_parent[-1].to_opts
1489.             if hasattr(field, 'get_path_info'):
1490.                 pathinfos = field.get_path_info(filtered_relation)
1491.                 if not allow_many:
1492.                     for inner_pos, p in enumerate(pathinfos):
1493.                         if p.m2m:
1494.                             cur_names_with_path[1].extend(pathinfos[0:inner_pos + 1])
1495.                             names_with_path.append(cur_names_with_path)
1496.                             raise MultiJoin(pos + 1, names_with_path)
1497.                 last = pathinfos[-1]
1498.                 path.extend(pathinfos)
1499.                 final_field = last.join_field
1500.                 opts = last.to_opts
1501.                 targets = last.target_fields
1502.                 cur_names_with_path[1].extend(pathinfos)
1503.                 names_with_path.append(cur_names_with_path)
1504.             else:
1505.                 # Local non-relational field.
1506.                 final_field = field
1507.                 targets = (field,)
1508.                 if fail_on_missing and pos + 1 != len(names):
1509.                     raise FieldError(
1510.                         "Cannot resolve keyword %r into field. Join on '%s'"
1511.                         " not permitted." % (names[pos + 1], name))
1512.                 break
1513.         return path, final_field, targets, names[pos + 1:]
1514. 
1515.     def setup_joins(self, names, opts, alias, can_reuse=None, allow_many=True,
1516.                     reuse_with_filtered_relation=False):
1517.         """
1518.         Compute the necessary table joins for the passage through the fields
1519.         given in 'names'. 'opts' is the Options class for the current model
1520.         (which gives the table we are starting from), 'alias' is the alias for
1521.         the table to start the joining from.
1522. 
1523.         The 'can_reuse' defines the reverse foreign key joins we can reuse. It
1524.         can be None in which case all joins are reusable or a set of aliases
1525.         that can be reused. Note that non-reverse foreign keys are always
1526.         reusable when using setup_joins().
1527. 
1528.         The 'reuse_with_filtered_relation' can be used to force 'can_reuse'
1529.         parameter and force the relation on the given connections.
1530. 
1531.         If 'allow_many' is False, then any reverse foreign key seen will
1532.         generate a MultiJoin exception.
1533. 
1534.         Return the final field involved in the joins, the target field (used
1535.         for any 'where' constraint), the final 'opts' value, the joins, the
1536.         field path traveled to generate the joins, and a transform function
1537.         that takes a field and alias and is equivalent to `field.get_col(alias)`
1538.         in the simple case but wraps field transforms if they were included in
1539.         names.
1540. 
1541.         The target field is the field containing the concrete value. Final
1542.         field can be something different, for example foreign key pointing to
1543.         that value. Final field is needed for example in some value
1544.         conversions (convert 'obj' in fk__id=obj to pk val using the foreign
1545.         key field for example).
1546.         """
1547.         joins = [alias]
1548.         # The transform can't be applied yet, as joins must be trimmed later.
1549.         # To avoid making every caller of this method look up transforms
1550.         # directly, compute transforms here and create a partial that converts
1551.         # fields to the appropriate wrapped version.
1552. 
1553.         def final_transformer(field, alias):
1554.             return field.get_col(alias)
1555. 
1556.         # Try resolving all the names as fields first. If there's an error,
1557.         # treat trailing names as lookups until a field can be resolved.
1558.         last_field_exception = None
1559.         for pivot in range(len(names), 0, -1):
1560.             try:
1561.                 path, final_field, targets, rest = self.names_to_path(
1562.                     names[:pivot], opts, allow_many, fail_on_missing=True,
1563.                 )
1564.             except FieldError as exc:
1565.                 if pivot == 1:
1566.                     # The first item cannot be a lookup, so it's safe
1567.                     # to raise the field error here.
1568.                     raise
1569.                 else:
1570.                     last_field_exception = exc
1571.             else:
1572.                 # The transforms are the remaining items that couldn't be
1573.                 # resolved into fields.
1574.                 transforms = names[pivot:]
1575.                 break
1576.         for name in transforms:
1577.             def transform(field, alias, *, name, previous):
1578.                 try:
1579.                     wrapped = previous(field, alias)
1580.                     return self.try_transform(wrapped, name)
1581.                 except FieldError:
1582.                     # FieldError is raised if the transform doesn't exist.
1583.                     if isinstance(final_field, Field) and last_field_exception:
1584.                         raise last_field_exception
1585.                     else:
1586.                         raise
1587.             final_transformer = functools.partial(transform, name=name, previous=final_transformer)
1588.         # Then, add the path to the query's joins. Note that we can't trim
1589.         # joins at this stage - we will need the information about join type
1590.         # of the trimmed joins.
1591.         for join in path:
1592.             if join.filtered_relation:
1593.                 filtered_relation = join.filtered_relation.clone()
1594.                 table_alias = filtered_relation.alias
1595.             else:
1596.                 filtered_relation = None
1597.                 table_alias = None
1598.             opts = join.to_opts
1599.             if join.direct:
1600.                 nullable = self.is_nullable(join.join_field)
1601.             else:
1602.                 nullable = True
1603.             connection = Join(
1604.                 opts.db_table, alias, table_alias, INNER, join.join_field,
1605.                 nullable, filtered_relation=filtered_relation,
1606.             )
1607.             reuse = can_reuse if join.m2m or reuse_with_filtered_relation else None
1608.             alias = self.join(
1609.                 connection, reuse=reuse,
1610.                 reuse_with_filtered_relation=reuse_with_filtered_relation,
1611.             )
1612.             joins.append(alias)
1613.             if filtered_relation:
1614.                 filtered_relation.path = joins[:]
1615.         return JoinInfo(final_field, targets, opts, joins, path, final_transformer)
1616. 
1617.     def trim_joins(self, targets, joins, path):
1618.         """
1619.         The 'target' parameter is the final field being joined to, 'joins'
1620.         is the full list of join aliases. The 'path' contain the PathInfos
1621.         used to create the joins.
1622. 
1623.         Return the final target field and table alias and the new active
1624.         joins.
1625. 
1626.         Always trim any direct join if the target column is already in the
1627.         previous table. Can't trim reverse joins as it's unknown if there's
1628.         anything on the other side of the join.
1629.         """
1630.         joins = joins[:]
1631.         for pos, info in enumerate(reversed(path)):
1632.             if len(joins) == 1 or not info.direct:
1633.                 break
1634.             if info.filtered_relation:
1635.                 break
1636.             join_targets = {t.column for t in info.join_field.foreign_related_fields}
1637.             cur_targets = {t.column for t in targets}
1638.             if not cur_targets.issubset(join_targets):
1639.                 break
1640.             targets_dict = {r[1].column: r[0] for r in info.join_field.related_fields if r[1].column in cur_targets}
1641.             targets = tuple(targets_dict[t.column] for t in targets)
1642.             self.unref_alias(joins.pop())
1643.         return targets, joins[-1], joins
1644. 
1645.     @classmethod
1646.     def _gen_col_aliases(cls, exprs):
1647.         for expr in exprs:
1648.             if isinstance(expr, Col):
1649.                 yield expr.alias
1650.             else:
1651.                 yield from cls._gen_col_aliases(expr.get_source_expressions())
1652. 
1653.     def resolve_ref(self, name, allow_joins=True, reuse=None, summarize=False, simple_col=False):
1654.         if not allow_joins and LOOKUP_SEP in name:
1655.             raise FieldError("Joined field references are not permitted in this query")
1656.         annotation = self.annotations.get(name)
1657.         if annotation is not None:
1658.             if not allow_joins:
1659.                 for alias in self._gen_col_aliases([annotation]):
1660.                     if isinstance(self.alias_map[alias], Join):
1661.                         raise FieldError(
1662.                             'Joined field references are not permitted in '
1663.                             'this query'
1664.                         )
1665.             if summarize:
1666.                 # Summarize currently means we are doing an aggregate() query
1667.                 # which is executed as a wrapped subquery if any of the
1668.                 # aggregate() elements reference an existing annotation. In
1669.                 # that case we need to return a Ref to the subquery's annotation.
1670.                 return Ref(name, self.annotation_select[name])
1671.             else:
1672.                 return annotation
1673.         else:
1674.             field_list = name.split(LOOKUP_SEP)
1675.             join_info = self.setup_joins(field_list, self.get_meta(), self.get_initial_alias(), can_reuse=reuse)
1676.             targets, final_alias, join_list = self.trim_joins(join_info.targets, join_info.joins, join_info.path)
1677.             if not allow_joins and len(join_list) > 1:
1678.                 raise FieldError('Joined field references are not permitted in this query')
1679.             if len(targets) > 1:
1680.                 raise FieldError("Referencing multicolumn fields with F() objects "
1681.                                  "isn't supported")
1682.             # Verify that the last lookup in name is a field or a transform:
1683.             # transform_function() raises FieldError if not.
1684.             join_info.transform_function(targets[0], final_alias)
1685.             if reuse is not None:
1686.                 reuse.update(join_list)
1687.             col = _get_col(targets[0], join_info.targets[0], join_list[-1], simple_col)
1688.             return col
1689. 
1690.     def split_exclude(self, filter_expr, can_reuse, names_with_path):
1691.         """
1692.         When doing an exclude against any kind of N-to-many relation, we need
1693.         to use a subquery. This method constructs the nested query, given the
1694.         original exclude filter (filter_expr) and the portion up to the first
1695.         N-to-many relation field.
1696. 
1697.         For example, if the origin filter is ~Q(child__name='foo'), filter_expr
1698.         is ('child__name', 'foo') and can_reuse is a set of joins usable for
1699.         filters in the original query.
1700. 
1701.         We will turn this into equivalent of:
1702.             WHERE NOT (pk IN (SELECT parent_id FROM thetable
1703.                               WHERE name = 'foo' AND parent_id IS NOT NULL))
1704. 
1705.         It might be worth it to consider using WHERE NOT EXISTS as that has
1706.         saner null handling, and is easier for the backend's optimizer to
1707.         handle.
1708.         """
1709.         filter_lhs, filter_rhs = filter_expr
1710.         if isinstance(filter_rhs, OuterRef):
1711.             filter_expr = (filter_lhs, OuterRef(filter_rhs))
1712.         elif isinstance(filter_rhs, F):
1713.             filter_expr = (filter_lhs, OuterRef(filter_rhs.name))
1714.         # Generate the inner query.
1715.         query = Query(self.model)
1716.         query._filtered_relations = self._filtered_relations
1717.         query.add_filter(filter_expr)
1718.         query.clear_ordering(True)
1719.         # Try to have as simple as possible subquery -> trim leading joins from
1720.         # the subquery.
1721.         trimmed_prefix, contains_louter = query.trim_start(names_with_path)
1722. 
1723.         # Add extra check to make sure the selected field will not be null
1724.         # since we are adding an IN <subquery> clause. This prevents the
1725.         # database from tripping over IN (...,NULL,...) selects and returning
1726.         # nothing
1727.         col = query.select[0]
1728.         select_field = col.target
1729.         alias = col.alias
1730.         if self.is_nullable(select_field):
1731.             lookup_class = select_field.get_lookup('isnull')
1732.             lookup = lookup_class(select_field.get_col(alias), False)
1733.             query.where.add(lookup, AND)
1734.         if alias in can_reuse:
1735.             pk = select_field.model._meta.pk
1736.             # Need to add a restriction so that outer query's filters are in effect for
1737.             # the subquery, too.
1738.             query.bump_prefix(self)
1739.             lookup_class = select_field.get_lookup('exact')
1740.             # Note that the query.select[0].alias is different from alias
1741.             # due to bump_prefix above.
1742.             lookup = lookup_class(pk.get_col(query.select[0].alias),
1743.                                   pk.get_col(alias))
1744.             query.where.add(lookup, AND)
1745.             query.external_aliases.add(alias)
1746. 
1747.         condition, needed_inner = self.build_filter(
1748.             ('%s__in' % trimmed_prefix, query),
1749.             current_negated=True, branch_negated=True, can_reuse=can_reuse)
1750.         if contains_louter:
1751.             or_null_condition, _ = self.build_filter(
1752.                 ('%s__isnull' % trimmed_prefix, True),
1753.                 current_negated=True, branch_negated=True, can_reuse=can_reuse)
1754.             condition.add(or_null_condition, OR)
1755.             # Note that the end result will be:
1756.             # (outercol NOT IN innerq AND outercol IS NOT NULL) OR outercol IS NULL.
1757.             # This might look crazy but due to how IN works, this seems to be
1758.             # correct. If the IS NOT NULL check is removed then outercol NOT
1759.             # IN will return UNKNOWN. If the IS NULL check is removed, then if
1760.             # outercol IS NULL we will not match the row.
1761.         return condition, needed_inner
1762. 
1763.     def set_empty(self):
1764.         self.where.add(NothingNode(), AND)
1765. 
1766.     def is_empty(self):
1767.         return any(isinstance(c, NothingNode) for c in self.where.children)
1768. 
1769.     def set_limits(self, low=None, high=None):
1770.         """
1771.         Adjust the limits on the rows retrieved. Use low/high to set these,
1772.         as it makes it more Pythonic to read and write. When the SQL query is
1773.         created, convert them to the appropriate offset and limit values.
1774. 
1775.         Apply any limits passed in here to the existing constraints. Add low
1776.         to the current low value and clamp both to any existing high value.
1777.         """
1778.         if high is not None:
1779.             if self.high_mark is not None:
1780.                 self.high_mark = min(self.high_mark, self.low_mark + high)
1781.             else:
1782.                 self.high_mark = self.low_mark + high
1783.         if low is not None:
1784.             if self.high_mark is not None:
1785.                 self.low_mark = min(self.high_mark, self.low_mark + low)
1786.             else:
1787.                 self.low_mark = self.low_mark + low
1788. 
1789.         if self.low_mark == self.high_mark:
1790.             self.set_empty()
1791. 
1792.     def clear_limits(self):
1793.         """Clear any existing limits."""
1794.         self.low_mark, self.high_mark = 0, None
1795. 
1796.     @property
1797.     def is_sliced(self):
1798.         return self.low_mark != 0 or self.high_mark is not None
1799. 
1800.     def has_limit_one(self):
1801.         return self.high_mark is not None and (self.high_mark - self.low_mark) == 1
1802. 
1803.     def can_filter(self):
1804.         """
1805.         Return True if adding filters to this instance is still possible.
1806. 
1807.         Typically, this means no limits or offsets have been put on the results.
1808.         """
1809.         return not self.is_sliced
1810. 
1811.     def clear_select_clause(self):
1812.         """Remove all fields from SELECT clause."""
1813.         self.select = ()
1814.         self.default_cols = False
1815.         self.select_related = False
1816.         self.set_extra_mask(())
1817.         self.set_annotation_mask(())
1818. 
1819.     def clear_select_fields(self):
1820.         """
1821.         Clear the list of fields to select (but not extra_select columns).
1822.         Some queryset types completely replace any existing list of select
1823.         columns.
1824.         """
1825.         self.select = ()
1826.         self.values_select = ()
1827. 
1828.     def add_select_col(self, col):
1829.         self.select += col,
1830.         self.values_select += col.output_field.name,
1831. 
1832.     def set_select(self, cols):
1833.         self.default_cols = False
1834.         self.select = tuple(cols)
1835. 
1836.     def add_distinct_fields(self, *field_names):
1837.         """
1838.         Add and resolve the given fields to the query's "distinct on" clause.
1839.         """
1840.         self.distinct_fields = field_names
1841.         self.distinct = True
1842. 
1843.     def add_fields(self, field_names, allow_m2m=True):
1844.         """
1845.         Add the given (model) fields to the select set. Add the field names in
1846.         the order specified.
1847.         """
1848.         alias = self.get_initial_alias()
1849.         opts = self.get_meta()
1850. 
1851.         try:
1852.             cols = []
1853.             for name in field_names:
1854.                 # Join promotion note - we must not remove any rows here, so
1855.                 # if there is no existing joins, use outer join.
1856.                 join_info = self.setup_joins(name.split(LOOKUP_SEP), opts, alias, allow_many=allow_m2m)
1857.                 targets, final_alias, joins = self.trim_joins(
1858.                     join_info.targets,
1859.                     join_info.joins,
1860.                     join_info.path,
1861.                 )
1862.                 for target in targets:
1863.                     cols.append(join_info.transform_function(target, final_alias))
1864.             if cols:
1865.                 self.set_select(cols)
1866.         except MultiJoin:
1867.             raise FieldError("Invalid field name: '%s'" % name)
1868.         except FieldError:
1869.             if LOOKUP_SEP in name:
1870.                 # For lookups spanning over relationships, show the error
1871.                 # from the model on which the lookup failed.
1872.                 raise
1873.             else:
1874.                 names = sorted([
1875.                     *get_field_names_from_opts(opts), *self.extra,
1876.                     *self.annotation_select, *self._filtered_relations
1877.                 ])
1878.                 raise FieldError("Cannot resolve keyword %r into field. "
1879.                                  "Choices are: %s" % (name, ", ".join(names)))
1880. 
1881.     def add_ordering(self, *ordering):
1882.         """
1883.         Add items from the 'ordering' sequence to the query's "order by"
1884.         clause. These items are either field names (not column names) --
1885.         possibly with a direction prefix ('-' or '?') -- or OrderBy
1886.         expressions.
1887. 
1888.         If 'ordering' is empty, clear all ordering from the query.
1889.         """
1890.         errors = []
1891.         for item in ordering:
1892.             if not hasattr(item, 'resolve_expression') and not ORDER_PATTERN.match(item):
1893.                 errors.append(item)
1894.             if getattr(item, 'contains_aggregate', False):
1895.                 raise FieldError(
1896.                     'Using an aggregate in order_by() without also including '
1897.                     'it in annotate() is not allowed: %s' % item
1898.                 )
1899.         if errors:
1900.             raise FieldError('Invalid order_by arguments: %s' % errors)
1901.         if ordering:
1902.             self.order_by += ordering
1903.         else:
1904.             self.default_ordering = False
1905. 
1906.     def clear_ordering(self, force_empty):
1907.         """
1908.         Remove any ordering settings. If 'force_empty' is True, there will be
1909.         no ordering in the resulting query (not even the model's default).
1910.         """
1911.         self.order_by = ()
1912.         self.extra_order_by = ()
1913.         if force_empty:
1914.             self.default_ordering = False
1915. 
1916.     def set_group_by(self):
1917.         """
1918.         Expand the GROUP BY clause required by the query.
1919. 
1920.         This will usually be the set of all non-aggregate fields in the
1921.         return data. If the database backend supports grouping by the
1922.         primary key, and the query would be equivalent, the optimization
1923.         will be made automatically.
1924.         """
1925.         group_by = list(self.select)
1926.         if self.annotation_select:
1927.             for alias, annotation in self.annotation_select.items():
1928.                 try:
1929.                     inspect.getcallargs(annotation.get_group_by_cols, alias=alias)
1930.                 except TypeError:
1931.                     annotation_class = annotation.__class__
1932.                     msg = (
1933.                         '`alias=None` must be added to the signature of '
1934.                         '%s.%s.get_group_by_cols().'
1935.                     ) % (annotation_class.__module__, annotation_class.__qualname__)
1936.                     warnings.warn(msg, category=RemovedInDjango40Warning)
1937.                     group_by_cols = annotation.get_group_by_cols()
1938.                 else:
1939.                     group_by_cols = annotation.get_group_by_cols(alias=alias)
1940.                 group_by.extend(group_by_cols)
1941.         self.group_by = tuple(group_by)
1942. 
1943.     def add_select_related(self, fields):
1944.         """
1945.         Set up the select_related data structure so that we only select
1946.         certain related models (as opposed to all models, when
1947.         self.select_related=True).
1948.         """
1949.         if isinstance(self.select_related, bool):
1950.             field_dict = {}
1951.         else:
1952.             field_dict = self.select_related
1953.         for field in fields:
1954.             d = field_dict
1955.             for part in field.split(LOOKUP_SEP):
1956.                 d = d.setdefault(part, {})
1957.         self.select_related = field_dict
1958. 
1959.     def add_extra(self, select, select_params, where, params, tables, order_by):
1960.         """
1961.         Add data to the various extra_* attributes for user-created additions
1962.         to the query.
1963.         """
1964.         if select:
1965.             # We need to pair any placeholder markers in the 'select'
1966.             # dictionary with their parameters in 'select_params' so that
1967.             # subsequent updates to the select dictionary also adjust the
1968.             # parameters appropriately.
1969.             select_pairs = {}
1970.             if select_params:
1971.                 param_iter = iter(select_params)
1972.             else:
1973.                 param_iter = iter([])
1974.             for name, entry in select.items():
1975.                 entry = str(entry)
1976.                 entry_params = []
1977.                 pos = entry.find("%s")
1978.                 while pos != -1:
1979.                     if pos == 0 or entry[pos - 1] != '%':
1980.                         entry_params.append(next(param_iter))
1981.                     pos = entry.find("%s", pos + 2)
1982.                 select_pairs[name] = (entry, entry_params)
1983.             self.extra.update(select_pairs)
1984.         if where or params:
1985.             self.where.add(ExtraWhere(where, params), AND)
1986.         if tables:
1987.             self.extra_tables += tuple(tables)
1988.         if order_by:
1989.             self.extra_order_by = order_by
1990. 
1991.     def clear_deferred_loading(self):
1992.         """Remove any fields from the deferred loading set."""
1993.         self.deferred_loading = (frozenset(), True)
1994. 
1995.     def add_deferred_loading(self, field_names):
1996.         """
1997.         Add the given list of model field names to the set of fields to
1998.         exclude from loading from the database when automatic column selection
1999.         is done. Add the new field names to any existing field names that
2000.         are deferred (or removed from any existing field names that are marked
2001.         as the only ones for immediate loading).
2002.         """
2003.         # Fields on related models are stored in the literal double-underscore
2004.         # format, so that we can use a set datastructure. We do the foo__bar
2005.         # splitting and handling when computing the SQL column names (as part of
2006.         # get_columns()).
2007.         existing, defer = self.deferred_loading
2008.         if defer:
2009.             # Add to existing deferred names.
2010.             self.deferred_loading = existing.union(field_names), True
2011.         else:
2012.             # Remove names from the set of any existing "immediate load" names.
2013.             self.deferred_loading = existing.difference(field_names), False
2014. 
2015.     def add_immediate_loading(self, field_names):
2016.         """
2017.         Add the given list of model field names to the set of fields to
2018.         retrieve when the SQL is executed ("immediate loading" fields). The
2019.         field names replace any existing immediate loading field names. If
2020.         there are field names already specified for deferred loading, remove
2021.         those names from the new field_names before storing the new names
2022.         for immediate loading. (That is, immediate loading overrides any
2023.         existing immediate values, but respects existing deferrals.)
2024.         """
2025.         existing, defer = self.deferred_loading
2026.         field_names = set(field_names)
2027.         if 'pk' in field_names:
2028.             field_names.remove('pk')
2029.             field_names.add(self.get_meta().pk.name)
2030. 
2031.         if defer:
2032.             # Remove any existing deferred names from the current set before
2033.             # setting the new names.
2034.             self.deferred_loading = field_names.difference(existing), False
2035.         else:
2036.             # Replace any existing "immediate load" field names.
2037.             self.deferred_loading = frozenset(field_names), False
2038. 
2039.     def get_loaded_field_names(self):
2040.         """
2041.         If any fields are marked to be deferred, return a dictionary mapping
2042.         models to a set of names in those fields that will be loaded. If a
2043.         model is not in the returned dictionary, none of its fields are
2044.         deferred.
2045. 
2046.         If no fields are marked for deferral, return an empty dictionary.
2047.         """
2048.         # We cache this because we call this function multiple times
2049.         # (compiler.fill_related_selections, query.iterator)
2050.         try:
2051.             return self._loaded_field_names_cache
2052.         except AttributeError:
2053.             collection = {}
2054.             self.deferred_to_data(collection, self.get_loaded_field_names_cb)
2055.             self._loaded_field_names_cache = collection
2056.             return collection
2057. 
2058.     def get_loaded_field_names_cb(self, target, model, fields):
2059.         """Callback used by get_deferred_field_names()."""
2060.         target[model] = {f.attname for f in fields}
2061. 
2062.     def set_annotation_mask(self, names):
2063.         """Set the mask of annotations that will be returned by the SELECT."""
2064.         if names is None:
2065.             self.annotation_select_mask = None
2066.         else:
2067.             self.annotation_select_mask = set(names)
2068.         self._annotation_select_cache = None
2069. 
2070.     def append_annotation_mask(self, names):
2071.         if self.annotation_select_mask is not None:
2072.             self.set_annotation_mask(self.annotation_select_mask.union(names))
2073. 
2074.     def set_extra_mask(self, names):
2075.         """
2076.         Set the mask of extra select items that will be returned by SELECT.
2077.         Don't remove them from the Query since they might be used later.
2078.         """
2079.         if names is None:
2080.             self.extra_select_mask = None
2081.         else:
2082.             self.extra_select_mask = set(names)
2083.         self._extra_select_cache = None
2084. 
2085.     def set_values(self, fields):
2086.         self.select_related = False
2087.         self.clear_deferred_loading()
2088.         self.clear_select_fields()
2089. 
2090.         if self.group_by is True:
2091.             self.add_fields((f.attname for f in self.model._meta.concrete_fields), False)
2092.             self.set_group_by()
2093.             self.clear_select_fields()
2094. 
2095.         if fields:
2096.             field_names = []
2097.             extra_names = []
2098.             annotation_names = []
2099.             if not self.extra and not self.annotations:
2100.                 # Shortcut - if there are no extra or annotations, then
2101.                 # the values() clause must be just field names.
2102.                 field_names = list(fields)
2103.             else:
2104.                 self.default_cols = False
2105.                 for f in fields:
2106.                     if f in self.extra_select:
2107.                         extra_names.append(f)
2108.                     elif f in self.annotation_select:
2109.                         annotation_names.append(f)
2110.                     else:
2111.                         field_names.append(f)
2112.             self.set_extra_mask(extra_names)
2113.             self.set_annotation_mask(annotation_names)
2114.         else:
2115.             field_names = [f.attname for f in self.model._meta.concrete_fields]
2116. 
2117.         self.values_select = tuple(field_names)
2118.         self.add_fields(field_names, True)
2119. 
2120.     @property
2121.     def annotation_select(self):
2122.         """
2123.         Return the dictionary of aggregate columns that are not masked and
2124.         should be used in the SELECT clause. Cache this result for performance.
2125.         """
2126.         if self._annotation_select_cache is not None:
2127.             return self._annotation_select_cache
2128.         elif not self.annotations:
2129.             return {}
2130.         elif self.annotation_select_mask is not None:
2131.             self._annotation_select_cache = {
2132.                 k: v for k, v in self.annotations.items()
2133.                 if k in self.annotation_select_mask
2134.             }
2135.             return self._annotation_select_cache
2136.         else:
2137.             return self.annotations
2138. 
2139.     @property
2140.     def extra_select(self):
2141.         if self._extra_select_cache is not None:
2142.             return self._extra_select_cache
2143.         if not self.extra:
2144.             return {}
2145.         elif self.extra_select_mask is not None:
2146.             self._extra_select_cache = {
2147.                 k: v for k, v in self.extra.items()
2148.                 if k in self.extra_select_mask
2149.             }
2150.             return self._extra_select_cache
2151.         else:
2152.             return self.extra
2153. 
2154.     def trim_start(self, names_with_path):
2155.         """
2156.         Trim joins from the start of the join path. The candidates for trim
2157.         are the PathInfos in names_with_path structure that are m2m joins.
2158. 
2159.         Also set the select column so the start matches the join.
2160. 
2161.         This method is meant to be used for generating the subquery joins &
2162.         cols in split_exclude().
2163. 
2164.         Return a lookup usable for doing outerq.filter(lookup=self) and a
2165.         boolean indicating if the joins in the prefix contain a LEFT OUTER join.
2166.         _"""
2167.         all_paths = []
2168.         for _, paths in names_with_path:
2169.             all_paths.extend(paths)
2170.         contains_louter = False
2171.         # Trim and operate only on tables that were generated for
2172.         # the lookup part of the query. That is, avoid trimming
2173.         # joins generated for F() expressions.
2174.         lookup_tables = [
2175.             t for t in self.alias_map
2176.             if t in self._lookup_joins or t == self.base_table
2177.         ]
2178.         for trimmed_paths, path in enumerate(all_paths):
2179.             if path.m2m:
2180.                 break
2181.             if self.alias_map[lookup_tables[trimmed_paths + 1]].join_type == LOUTER:
2182.                 contains_louter = True
2183.             alias = lookup_tables[trimmed_paths]
2184.             self.unref_alias(alias)
2185.         # The path.join_field is a Rel, lets get the other side's field
2186.         join_field = path.join_field.field
2187.         # Build the filter prefix.
2188.         paths_in_prefix = trimmed_paths
2189.         trimmed_prefix = []
2190.         for name, path in names_with_path:
2191.             if paths_in_prefix - len(path) < 0:
2192.                 break
2193.             trimmed_prefix.append(name)
2194.             paths_in_prefix -= len(path)
2195.         trimmed_prefix.append(
2196.             join_field.foreign_related_fields[0].name)
2197.         trimmed_prefix = LOOKUP_SEP.join(trimmed_prefix)
2198.         # Lets still see if we can trim the first join from the inner query
2199.         # (that is, self). We can't do this for:
2200.         # - LEFT JOINs because we would miss those rows that have nothing on
2201.         #   the outer side,
2202.         # - INNER JOINs from filtered relations because we would miss their
2203.         #   filters.
2204.         first_join = self.alias_map[lookup_tables[trimmed_paths + 1]]
2205.         if first_join.join_type != LOUTER and not first_join.filtered_relation:
2206.             select_fields = [r[0] for r in join_field.related_fields]
2207.             select_alias = lookup_tables[trimmed_paths + 1]
2208.             self.unref_alias(lookup_tables[trimmed_paths])
2209.             extra_restriction = join_field.get_extra_restriction(
2210.                 self.where_class, None, lookup_tables[trimmed_paths + 1])
2211.             if extra_restriction:
2212.                 self.where.add(extra_restriction, AND)
2213.         else:
2214.             # TODO: It might be possible to trim more joins from the start of the
2215.             # inner query if it happens to have a longer join chain containing the
2216.             # values in select_fields. Lets punt this one for now.
2217.             select_fields = [r[1] for r in join_field.related_fields]
2218.             select_alias = lookup_tables[trimmed_paths]
2219.         # The found starting point is likely a Join instead of a BaseTable reference.
2220.         # But the first entry in the query's FROM clause must not be a JOIN.
2221.         for table in self.alias_map:
2222.             if self.alias_refcount[table] > 0:
2223.                 self.alias_map[table] = BaseTable(self.alias_map[table].table_name, table)
2224.                 break
2225.         self.set_select([f.get_col(select_alias) for f in select_fields])
2226.         return trimmed_prefix, contains_louter
2227. 
2228.     def is_nullable(self, field):
2229.         """
2230.         Check if the given field should be treated as nullable.
2231. 
2232.         Some backends treat '' as null and Django treats such fields as
2233.         nullable for those backends. In such situations field.null can be
2234.         False even if we should treat the field as nullable.
2235.         """
2236.         # We need to use DEFAULT_DB_ALIAS here, as QuerySet does not have
2237.         # (nor should it have) knowledge of which connection is going to be
2238.         # used. The proper fix would be to defer all decisions where
2239.         # is_nullable() is needed to the compiler stage, but that is not easy
2240.         # to do currently.
2241.         return (
2242.             connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls and
2243.             field.empty_strings_allowed
2244.         ) or field.null


File: django/db/models/sql/query.py
Line number range: 2280 - 2362
Content:
class JoinPromoter:
    """
    A class to abstract away join promotion problems for complex filter
    conditions.
    """

    def __init__(self, connector, num_children, negated):
        self.connector = connector
        self.negated = negated
        if self.negated:
            if connector == AND:
                self.effective_connector = OR
            else:
                self.effective_connector = AND
        else:
            self.effective_connector = self.connector
        self.num_children = num_children
        # Maps of table alias to how many times it is seen as required for
        # inner and/or outer joins.
        self.votes = Counter()

    def add_votes(self, votes):
        """
        Add single vote per item to self.votes. Parameter can be any
        iterable.
        """
        self.votes.update(votes)

    def update_join_types(self, query):
        """
        Change join types so that the generated query is as efficient as
        possible, but still correct. So, change as many joins as possible
        to INNER, but don't make OUTER joins INNER if that could remove
        results from the query.
        """
        to_promote = set()
        to_demote = set()
        # The effective_connector is used so that NOT (a AND b) is treated
        # similarly to (a OR b) for join promotion.
        for table, votes in self.votes.items():
            # We must use outer joins in OR case when the join isn't contained
            # in all of the joins. Otherwise the INNER JOIN itself could remove
            # valid results. Consider the case where a model with rel_a and
            # rel_b relations is queried with rel_a__col=1 | rel_b__col=2. Now,
            # if rel_a join doesn't produce any results is null (for example
            # reverse foreign key or null value in direct foreign key), and
            # there is a matching row in rel_b with col=2, then an INNER join
            # to rel_a would remove a valid match from the query. So, we need
            # to promote any existing INNER to LOUTER (it is possible this
            # promotion in turn will be demoted later on).
            if self.effective_connector == 'OR' and votes < self.num_children:
                to_promote.add(table)
            # If connector is AND and there is a filter that can match only
            # when there is a joinable row, then use INNER. For example, in
            # rel_a__col=1 & rel_b__col=2, if either of the rels produce NULL
            # as join output, then the col=1 or col=2 can't match (as
            # NULL=anything is always false).
            # For the OR case, if all children voted for a join to be inner,
            # then we can use INNER for the join. For example:
            #     (rel_a__col__icontains=Alex | rel_a__col__icontains=Russell)
            # then if rel_a doesn't produce any rows, the whole condition
            # can't match. Hence we can safely use INNER join.
            if self.effective_connector == 'AND' or (
                    self.effective_connector == 'OR' and votes == self.num_children):
                to_demote.add(table)
            # Finally, what happens in cases where we have:
            #    (rel_a__col=1|rel_b__col=2) & rel_a__col__gte=0
            # Now, we first generate the OR clause, and promote joins for it
            # in the first if branch above. Both rel_a and rel_b are promoted
            # to LOUTER joins. After that we do the AND case. The OR case
            # voted no inner joins but the rel_a__col__gte=0 votes inner join
            # for rel_a. We demote it back to INNER join (in AND case a single
            # vote is enough). The demotion is OK, if rel_a doesn't produce
            # rows, then the rel_a__col__gte=0 clause can't be true, and thus
            # the whole clause must be false. So, it is safe to use INNER
            # join.
            # Note that in this example we could just as well have the __gte
            # clause and the OR clause swapped. Or we could replace the __gte
            # clause with an OR clause containing rel_a__col=1|rel_a__col=2,
            # and again we could safely demote to INNER.
        query.promote_joins(to_promote)
        query.demote_joins(to_demote)
        return to_demote

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:08:12,807 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user requested the full content of `django/db/models/sql/query.py`.\n   - This context provides the beginning of the file (lines 1-500), including imports, module-level functions, and the `RawQuery` class.\n2. Extended relevance:\n   - This part is essential as it provides the initial setup, dependencies, and helper functions used by the `Query` class later in the file.', relative_path='django/db/models/sql/query.py', start_line=1, end_line=500), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's extra requirement is to provide the complete implementation of the `Query` class.\n   - The purpose explicitly states the `Query` class and its `resolve_lookup_value` method are central to the issue.\n   - This context contains the entire implementation of the `Query` class (lines 146-2245), including the `resolve_lookup_value` method.\n2. Extended relevance:\n   - This is the core component of the file and directly addresses the user's primary interest.", relative_path='django/db/models/sql/query.py', start_line=146, end_line=2245), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the full content of `django/db/models/sql/query.py`.\n   - This context provides a subsequent section of the file containing the `JoinPromoter` class.\n2. Extended relevance:\n   - The `JoinPromoter` class is a helper class utilized by the `Query` class (e.g., in the `_add_q` method). Including it provides a more complete understanding of the `Query` class's filtering logic.", relative_path='django/db/models/sql/query.py', start_line=2280, end_line=2362)]
2025-12-21 08:08:12,812 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the full content of django/db/models/sql/query.py.
2025-12-21 08:08:12,812 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:08:12,812 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:08:12,812 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 0 existing contexts
2025-12-21 08:08:12,813 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-21 08:08:12,814 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── FUNDING.yml
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Query.resolve_lookup_value coerces value of type list to tuple

Description: Description
	
Changes introduced in #30687 cause an input value list to be coerced to tuple breaking exact value queries. This affects ORM field types that are dependent on matching input types such as PickledField.
The expected iterable return type should match input iterable type.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index ea51912e8b..6724f401f1 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1073,7 +1073,12 @@ class Query(BaseExpression):
                         ))
                 else:
                     resolved_values.append(sub_value)
-            value = tuple(resolved_values)
+            # Preserve the input iterable type (list vs tuple) to avoid altering
+            # exact comparisons for type-sensitive fields (e.g., pickled values).
+            if isinstance(value, list):
+                value = resolved_values
+            else:
+                value = tuple(resolved_values)
         return value
 
     def solve_lookup_type(self, lookup):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of django/db/models/sql/query.py.
Extra Requirements: If the file is too large, please at least provide the complete implementation of the `Query` class from that file.
Purpose: The `Query` class and its `resolve_lookup_value` method are central to the issue, and this file is needed to understand the context of the provided patch.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: django/db/models/sql/query.py
Line number range: 1 - 500
Content:
1. """
2. Create SQL statements for QuerySets.
3. 
4. The code in here encapsulates all of the SQL construction so that QuerySets
5. themselves do not have to (and could be backed by things other than SQL
6. databases). The abstraction barrier only works one way: this module has to know
7. all about the internals of models in order to get the information it needs.
8. """
9. import copy
10. import difflib
11. import functools
12. import inspect
13. import sys
14. import warnings
15. from collections import Counter, namedtuple
16. from collections.abc import Iterator, Mapping
17. from itertools import chain, count, product
18. from string import ascii_uppercase
19. 
20. from django.core.exceptions import (
21.     EmptyResultSet, FieldDoesNotExist, FieldError,
22. )
23. from django.db import DEFAULT_DB_ALIAS, NotSupportedError, connections
24. from django.db.models.aggregates import Count
25. from django.db.models.constants import LOOKUP_SEP
26. from django.db.models.expressions import (
27.     BaseExpression, Col, F, OuterRef, Ref, SimpleCol,
28. )
29. from django.db.models.fields import Field
30. from django.db.models.fields.related_lookups import MultiColSource
31. from django.db.models.lookups import Lookup
32. from django.db.models.query_utils import (
33.     Q, check_rel_lookup_compatibility, refs_expression,
34. )
35. from django.db.models.sql.constants import (
36.     INNER, LOUTER, ORDER_DIR, ORDER_PATTERN, SINGLE,
37. )
38. from django.db.models.sql.datastructures import (
39.     BaseTable, Empty, Join, MultiJoin,
40. )
41. from django.db.models.sql.where import (
42.     AND, OR, ExtraWhere, NothingNode, WhereNode,
43. )
44. from django.utils.deprecation import RemovedInDjango40Warning
45. from django.utils.functional import cached_property
46. from django.utils.tree import Node
47. 
48. __all__ = ['Query', 'RawQuery']
49. 
50. 
51. def get_field_names_from_opts(opts):
52.     return set(chain.from_iterable(
53.         (f.name, f.attname) if f.concrete else (f.name,)
54.         for f in opts.get_fields()
55.     ))
56. 
57. 
58. def get_children_from_q(q):
59.     for child in q.children:
60.         if isinstance(child, Node):
61.             yield from get_children_from_q(child)
62.         else:
63.             yield child
64. 
65. 
66. JoinInfo = namedtuple(
67.     'JoinInfo',
68.     ('final_field', 'targets', 'opts', 'joins', 'path', 'transform_function')
69. )
70. 
71. 
72. def _get_col(target, field, alias, simple_col):
73.     if simple_col:
74.         return SimpleCol(target, field)
75.     return target.get_col(alias, field)
76. 
77. 
78. class RawQuery:
79.     """A single raw SQL query."""
80. 
81.     def __init__(self, sql, using, params=None):
82.         self.params = params or ()
83.         self.sql = sql
84.         self.using = using
85.         self.cursor = None
86. 
87.         # Mirror some properties of a normal query so that
88.         # the compiler can be used to process results.
89.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
90.         self.extra_select = {}
91.         self.annotation_select = {}
92. 
93.     def chain(self, using):
94.         return self.clone(using)
95. 
96.     def clone(self, using):
97.         return RawQuery(self.sql, using, params=self.params)
98. 
99.     def get_columns(self):
100.         if self.cursor is None:
101.             self._execute_query()
102.         converter = connections[self.using].introspection.identifier_converter
103.         return [converter(column_meta[0])
104.                 for column_meta in self.cursor.description]
105. 
106.     def __iter__(self):
107.         # Always execute a new query for a new iterator.
108.         # This could be optimized with a cache at the expense of RAM.
109.         self._execute_query()
110.         if not connections[self.using].features.can_use_chunked_reads:
111.             # If the database can't use chunked reads we need to make sure we
112.             # evaluate the entire query up front.
113.             result = list(self.cursor)
114.         else:
115.             result = self.cursor
116.         return iter(result)
117. 
118.     def __repr__(self):
119.         return "<%s: %s>" % (self.__class__.__name__, self)
120. 
121.     @property
122.     def params_type(self):
123.         return dict if isinstance(self.params, Mapping) else tuple
124. 
125.     def __str__(self):
126.         return self.sql % self.params_type(self.params)
127. 
128.     def _execute_query(self):
129.         connection = connections[self.using]
130. 
131.         # Adapt parameters to the database, as much as possible considering
132.         # that the target type isn't known. See #17755.
133.         params_type = self.params_type
134.         adapter = connection.ops.adapt_unknown_value
135.         if params_type is tuple:
136.             params = tuple(adapter(val) for val in self.params)
137.         elif params_type is dict:
138.             params = {key: adapter(val) for key, val in self.params.items()}
139.         else:
140.             raise RuntimeError("Unexpected params type: %s" % params_type)
141. 
142.         self.cursor = connection.cursor()
143.         self.cursor.execute(self.sql, params)
144. 
145. 
146. class Query(BaseExpression):
147.     """A single SQL query."""
148. 
149.     alias_prefix = 'T'
150.     subq_aliases = frozenset([alias_prefix])
151. 
152.     compiler = 'SQLCompiler'
153. 
154.     def __init__(self, model, where=WhereNode):
155.         self.model = model
156.         self.alias_refcount = {}
157.         # alias_map is the most important data structure regarding joins.
158.         # It's used for recording which joins exist in the query and what
159.         # types they are. The key is the alias of the joined table (possibly
160.         # the table name) and the value is a Join-like object (see
161.         # sql.datastructures.Join for more information).
162.         self.alias_map = {}
163.         # Sometimes the query contains references to aliases in outer queries (as
164.         # a result of split_exclude). Correct alias quoting needs to know these
165.         # aliases too.
166.         self.external_aliases = set()
167.         self.table_map = {}     # Maps table names to list of aliases.
168.         self.default_cols = True
169.         self.default_ordering = True
170.         self.standard_ordering = True
171.         self.used_aliases = set()
172.         self.filter_is_sticky = False
173.         self.subquery = False
174. 
175.         # SQL-related attributes
176.         # Select and related select clauses are expressions to use in the
177.         # SELECT clause of the query.
178.         # The select is used for cases where we want to set up the select
179.         # clause to contain other than default fields (values(), subqueries...)
180.         # Note that annotations go to annotations dictionary.
181.         self.select = ()
182.         self.where = where()
183.         self.where_class = where
184.         # The group_by attribute can have one of the following forms:
185.         #  - None: no group by at all in the query
186.         #  - A tuple of expressions: group by (at least) those expressions.
187.         #    String refs are also allowed for now.
188.         #  - True: group by all select fields of the model
189.         # See compiler.get_group_by() for details.
190.         self.group_by = None
191.         self.order_by = ()
192.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
193.         self.distinct = False
194.         self.distinct_fields = ()
195.         self.select_for_update = False
196.         self.select_for_update_nowait = False
197.         self.select_for_update_skip_locked = False
198.         self.select_for_update_of = ()
199. 
200.         self.select_related = False
201.         # Arbitrary limit for select_related to prevents infinite recursion.
202.         self.max_depth = 5
203. 
204.         # Holds the selects defined by a call to values() or values_list()
205.         # excluding annotation_select and extra_select.
206.         self.values_select = ()
207. 
208.         # SQL annotation-related attributes
209.         self.annotations = {}  # Maps alias -> Annotation Expression
210.         self.annotation_select_mask = None
211.         self._annotation_select_cache = None
212. 
213.         # Set combination attributes
214.         self.combinator = None
215.         self.combinator_all = False
216.         self.combined_queries = ()
217. 
218.         # These are for extensions. The contents are more or less appended
219.         # verbatim to the appropriate clause.
220.         self.extra = {}  # Maps col_alias -> (col_sql, params).
221.         self.extra_select_mask = None
222.         self._extra_select_cache = None
223. 
224.         self.extra_tables = ()
225.         self.extra_order_by = ()
226. 
227.         # A tuple that is a set of model field names and either True, if these
228.         # are the fields to defer, or False if these are the only fields to
229.         # load.
230.         self.deferred_loading = (frozenset(), True)
231. 
232.         self._filtered_relations = {}
233. 
234.         self.explain_query = False
235.         self.explain_format = None
236.         self.explain_options = {}
237. 
238.     @property
239.     def output_field(self):
240.         if len(self.select) == 1:
241.             return self.select[0].field
242.         elif len(self.annotation_select) == 1:
243.             return next(iter(self.annotation_select.values())).output_field
244. 
245.     @property
246.     def has_select_fields(self):
247.         return bool(self.select or self.annotation_select_mask or self.extra_select_mask)
248. 
249.     @cached_property
250.     def base_table(self):
251.         for alias in self.alias_map:
252.             return alias
253. 
254.     def __str__(self):
255.         """
256.         Return the query as a string of SQL with the parameter values
257.         substituted in (use sql_with_params() to see the unsubstituted string).
258. 
259.         Parameter values won't necessarily be quoted correctly, since that is
260.         done by the database interface at execution time.
261.         """
262.         sql, params = self.sql_with_params()
263.         return sql % params
264. 
265.     def sql_with_params(self):
266.         """
267.         Return the query as an SQL string and the parameters that will be
268.         substituted into the query.
269.         """
270.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
271. 
272.     def __deepcopy__(self, memo):
273.         """Limit the amount of work when a Query is deepcopied."""
274.         result = self.clone()
275.         memo[id(self)] = result
276.         return result
277. 
278.     def get_compiler(self, using=None, connection=None):
279.         if using is None and connection is None:
280.             raise ValueError("Need either using or connection")
281.         if using:
282.             connection = connections[using]
283.         return connection.ops.compiler(self.compiler)(self, connection, using)
284. 
285.     def get_meta(self):
286.         """
287.         Return the Options instance (the model._meta) from which to start
288.         processing. Normally, this is self.model._meta, but it can be changed
289.         by subclasses.
290.         """
291.         return self.model._meta
292. 
293.     def clone(self):
294.         """
295.         Return a copy of the current Query. A lightweight alternative to
296.         to deepcopy().
297.         """
298.         obj = Empty()
299.         obj.__class__ = self.__class__
300.         # Copy references to everything.
301.         obj.__dict__ = self.__dict__.copy()
302.         # Clone attributes that can't use shallow copy.
303.         obj.alias_refcount = self.alias_refcount.copy()
304.         obj.alias_map = self.alias_map.copy()
305.         obj.external_aliases = self.external_aliases.copy()
306.         obj.table_map = self.table_map.copy()
307.         obj.where = self.where.clone()
308.         obj.annotations = self.annotations.copy()
309.         if self.annotation_select_mask is None:
310.             obj.annotation_select_mask = None
311.         else:
312.             obj.annotation_select_mask = self.annotation_select_mask.copy()
313.         # _annotation_select_cache cannot be copied, as doing so breaks the
314.         # (necessary) state in which both annotations and
315.         # _annotation_select_cache point to the same underlying objects.
316.         # It will get re-populated in the cloned queryset the next time it's
317.         # used.
318.         obj._annotation_select_cache = None
319.         obj.extra = self.extra.copy()
320.         if self.extra_select_mask is None:
321.             obj.extra_select_mask = None
322.         else:
323.             obj.extra_select_mask = self.extra_select_mask.copy()
324.         if self._extra_select_cache is None:
325.             obj._extra_select_cache = None
326.         else:
327.             obj._extra_select_cache = self._extra_select_cache.copy()
328.         if self.select_related is not False:
329.             # Use deepcopy because select_related stores fields in nested
330.             # dicts.
331.             obj.select_related = copy.deepcopy(obj.select_related)
332.         if 'subq_aliases' in self.__dict__:
333.             obj.subq_aliases = self.subq_aliases.copy()
334.         obj.used_aliases = self.used_aliases.copy()
335.         obj._filtered_relations = self._filtered_relations.copy()
336.         # Clear the cached_property
337.         try:
338.             del obj.base_table
339.         except AttributeError:
340.             pass
341.         return obj
342. 
343.     def chain(self, klass=None):
344.         """
345.         Return a copy of the current Query that's ready for another operation.
346.         The klass argument changes the type of the Query, e.g. UpdateQuery.
347.         """
348.         obj = self.clone()
349.         if klass and obj.__class__ != klass:
350.             obj.__class__ = klass
351.         if not obj.filter_is_sticky:
352.             obj.used_aliases = set()
353.         obj.filter_is_sticky = False
354.         if hasattr(obj, '_setup_query'):
355.             obj._setup_query()
356.         return obj
357. 
358.     def relabeled_clone(self, change_map):
359.         clone = self.clone()
360.         clone.change_aliases(change_map)
361.         return clone
362. 
363.     def rewrite_cols(self, annotation, col_cnt):
364.         # We must make sure the inner query has the referred columns in it.
365.         # If we are aggregating over an annotation, then Django uses Ref()
366.         # instances to note this. However, if we are annotating over a column
367.         # of a related model, then it might be that column isn't part of the
368.         # SELECT clause of the inner query, and we must manually make sure
369.         # the column is selected. An example case is:
370.         #    .aggregate(Sum('author__awards'))
371.         # Resolving this expression results in a join to author, but there
372.         # is no guarantee the awards column of author is in the select clause
373.         # of the query. Thus we must manually add the column to the inner
374.         # query.
375.         orig_exprs = annotation.get_source_expressions()
376.         new_exprs = []
377.         for expr in orig_exprs:
378.             # FIXME: These conditions are fairly arbitrary. Identify a better
379.             # method of having expressions decide which code path they should
380.             # take.
381.             if isinstance(expr, Ref):
382.                 # Its already a Ref to subquery (see resolve_ref() for
383.                 # details)
384.                 new_exprs.append(expr)
385.             elif isinstance(expr, (WhereNode, Lookup)):
386.                 # Decompose the subexpressions further. The code here is
387.                 # copied from the else clause, but this condition must appear
388.                 # before the contains_aggregate/is_summary condition below.
389.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
390.                 new_exprs.append(new_expr)
391.             else:
392.                 # Reuse aliases of expressions already selected in subquery.
393.                 for col_alias, selected_annotation in self.annotation_select.items():
394.                     if selected_annotation == expr:
395.                         new_expr = Ref(col_alias, expr)
396.                         break
397.                 else:
398.                     # An expression that is not selected the subquery.
399.                     if isinstance(expr, Col) or (expr.contains_aggregate and not expr.is_summary):
400.                         # Reference column or another aggregate. Select it
401.                         # under a non-conflicting alias.
402.                         col_cnt += 1
403.                         col_alias = '__col%d' % col_cnt
404.                         self.annotations[col_alias] = expr
405.                         self.append_annotation_mask([col_alias])
406.                         new_expr = Ref(col_alias, expr)
407.                     else:
408.                         # Some other expression not referencing database values
409.                         # directly. Its subexpression might contain Cols.
410.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
411.                 new_exprs.append(new_expr)
412.         annotation.set_source_expressions(new_exprs)
413.         return annotation, col_cnt
414. 
415.     def get_aggregation(self, using, added_aggregate_names):
416.         """
417.         Return the dictionary with the values of the existing aggregations.
418.         """
419.         if not self.annotation_select:
420.             return {}
421.         existing_annotations = [
422.             annotation for alias, annotation
423.             in self.annotations.items()
424.             if alias not in added_aggregate_names
425.         ]
426.         # Decide if we need to use a subquery.
427.         #
428.         # Existing annotations would cause incorrect results as get_aggregation()
429.         # must produce just one result and thus must not use GROUP BY. But we
430.         # aren't smart enough to remove the existing annotations from the
431.         # query, so those would force us to use GROUP BY.
432.         #
433.         # If the query has limit or distinct, or uses set operations, then
434.         # those operations must be done in a subquery so that the query
435.         # aggregates on the limit and/or distinct results instead of applying
436.         # the distinct and limit after the aggregation.
437.         if (isinstance(self.group_by, tuple) or self.is_sliced or existing_annotations or
438.                 self.distinct or self.combinator):
439.             from django.db.models.sql.subqueries import AggregateQuery
440.             outer_query = AggregateQuery(self.model)
441.             inner_query = self.clone()
442.             inner_query.select_for_update = False
443.             inner_query.select_related = False
444.             inner_query.set_annotation_mask(self.annotation_select)
445.             if not self.is_sliced and not self.distinct_fields:
446.                 # Queries with distinct_fields need ordering and when a limit
447.                 # is applied we must take the slice from the ordered query.
448.                 # Otherwise no need for ordering.
449.                 inner_query.clear_ordering(True)
450.             if not inner_query.distinct:
451.                 # If the inner query uses default select and it has some
452.                 # aggregate annotations, then we must make sure the inner
453.                 # query is grouped by the main model's primary key. However,
454.                 # clearing the select clause can alter results if distinct is
455.                 # used.
456.                 has_existing_aggregate_annotations = any(
457.                     annotation for annotation in existing_annotations
458.                     if getattr(annotation, 'contains_aggregate', True)
459.                 )
460.                 if inner_query.default_cols and has_existing_aggregate_annotations:
461.                     inner_query.group_by = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
462.                 inner_query.default_cols = False
463. 
464.             relabels = {t: 'subquery' for t in inner_query.alias_map}
465.             relabels[None] = 'subquery'
466.             # Remove any aggregates marked for reduction from the subquery
467.             # and move them to the outer AggregateQuery.
468.             col_cnt = 0
469.             for alias, expression in list(inner_query.annotation_select.items()):
470.                 annotation_select_mask = inner_query.annotation_select_mask
471.                 if expression.is_summary:
472.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
473.                     outer_query.annotations[alias] = expression.relabeled_clone(relabels)
474.                     del inner_query.annotations[alias]
475.                     annotation_select_mask.remove(alias)
476.                 # Make sure the annotation_select wont use cached results.
477.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
478.             if inner_query.select == () and not inner_query.default_cols and not inner_query.annotation_select_mask:
479.                 # In case of Model.objects[0:3].count(), there would be no
480.                 # field selected in the inner query, yet we must use a subquery.
481.                 # So, make sure at least one field is selected.
482.                 inner_query.select = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
483.             try:
484.                 outer_query.add_subquery(inner_query, using)
485.             except EmptyResultSet:
486.                 return {
487.                     alias: None
488.                     for alias in outer_query.annotation_select
489.                 }
490.         else:
491.             outer_query = self
492.             self.select = ()
493.             self.default_cols = False
494.             self.extra = {}
495. 
496.         outer_query.clear_ordering(True)
497.         outer_query.clear_limits()
498.         outer_query.select_for_update = False
499.         outer_query.select_related = False
500.         compiler = outer_query.get_compiler(using)


File: django/db/models/sql/query.py
Line number range: 146 - 2245
Content:
146. class Query(BaseExpression):
147.     """A single SQL query."""
148. 
149.     alias_prefix = 'T'
150.     subq_aliases = frozenset([alias_prefix])
151. 
152.     compiler = 'SQLCompiler'
153. 
154.     def __init__(self, model, where=WhereNode):
155.         self.model = model
156.         self.alias_refcount = {}
157.         # alias_map is the most important data structure regarding joins.
158.         # It's used for recording which joins exist in the query and what
159.         # types they are. The key is the alias of the joined table (possibly
160.         # the table name) and the value is a Join-like object (see
161.         # sql.datastructures.Join for more information).
162.         self.alias_map = {}
163.         # Sometimes the query contains references to aliases in outer queries (as
164.         # a result of split_exclude). Correct alias quoting needs to know these
165.         # aliases too.
166.         self.external_aliases = set()
167.         self.table_map = {}     # Maps table names to list of aliases.
168.         self.default_cols = True
169.         self.default_ordering = True
170.         self.standard_ordering = True
171.         self.used_aliases = set()
172.         self.filter_is_sticky = False
173.         self.subquery = False
174. 
175.         # SQL-related attributes
176.         # Select and related select clauses are expressions to use in the
177.         # SELECT clause of the query.
178.         # The select is used for cases where we want to set up the select
179.         # clause to contain other than default fields (values(), subqueries...)
180.         # Note that annotations go to annotations dictionary.
181.         self.select = ()
182.         self.where = where()
183.         self.where_class = where
184.         # The group_by attribute can have one of the following forms:
185.         #  - None: no group by at all in the query
186.         #  - A tuple of expressions: group by (at least) those expressions.
187.         #    String refs are also allowed for now.
188.         #  - True: group by all select fields of the model
189.         # See compiler.get_group_by() for details.
190.         self.group_by = None
191.         self.order_by = ()
192.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
193.         self.distinct = False
194.         self.distinct_fields = ()
195.         self.select_for_update = False
196.         self.select_for_update_nowait = False
197.         self.select_for_update_skip_locked = False
198.         self.select_for_update_of = ()
199. 
200.         self.select_related = False
201.         # Arbitrary limit for select_related to prevents infinite recursion.
202.         self.max_depth = 5
203. 
204.         # Holds the selects defined by a call to values() or values_list()
205.         # excluding annotation_select and extra_select.
206.         self.values_select = ()
207. 
208.         # SQL annotation-related attributes
209.         self.annotations = {}  # Maps alias -> Annotation Expression
210.         self.annotation_select_mask = None
211.         self._annotation_select_cache = None
212. 
213.         # Set combination attributes
214.         self.combinator = None
215.         self.combinator_all = False
216.         self.combined_queries = ()
217. 
218.         # These are for extensions. The contents are more or less appended
219.         # verbatim to the appropriate clause.
220.         self.extra = {}  # Maps col_alias -> (col_sql, params).
221.         self.extra_select_mask = None
222.         self._extra_select_cache = None
223. 
224.         self.extra_tables = ()
225.         self.extra_order_by = ()
226. 
227.         # A tuple that is a set of model field names and either True, if these
228.         # are the fields to defer, or False if these are the only fields to
229.         # load.
230.         self.deferred_loading = (frozenset(), True)
231. 
232.         self._filtered_relations = {}
233. 
234.         self.explain_query = False
235.         self.explain_format = None
236.         self.explain_options = {}
237. 
238.     @property
239.     def output_field(self):
240.         if len(self.select) == 1:
241.             return self.select[0].field
242.         elif len(self.annotation_select) == 1:
243.             return next(iter(self.annotation_select.values())).output_field
244. 
245.     @property
246.     def has_select_fields(self):
247.         return bool(self.select or self.annotation_select_mask or self.extra_select_mask)
248. 
249.     @cached_property
250.     def base_table(self):
251.         for alias in self.alias_map:
252.             return alias
253. 
254.     def __str__(self):
255.         """
256.         Return the query as a string of SQL with the parameter values
257.         substituted in (use sql_with_params() to see the unsubstituted string).
258. 
259.         Parameter values won't necessarily be quoted correctly, since that is
260.         done by the database interface at execution time.
261.         """
262.         sql, params = self.sql_with_params()
263.         return sql % params
264. 
265.     def sql_with_params(self):
266.         """
267.         Return the query as an SQL string and the parameters that will be
268.         substituted into the query.
269.         """
270.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
271. 
272.     def __deepcopy__(self, memo):
273.         """Limit the amount of work when a Query is deepcopied."""
274.         result = self.clone()
275.         memo[id(self)] = result
276.         return result
277. 
278.     def get_compiler(self, using=None, connection=None):
279.         if using is None and connection is None:
280.             raise ValueError("Need either using or connection")
281.         if using:
282.             connection = connections[using]
283.         return connection.ops.compiler(self.compiler)(self, connection, using)
284. 
285.     def get_meta(self):
286.         """
287.         Return the Options instance (the model._meta) from which to start
288.         processing. Normally, this is self.model._meta, but it can be changed
289.         by subclasses.
290.         """
291.         return self.model._meta
292. 
293.     def clone(self):
294.         """
295.         Return a copy of the current Query. A lightweight alternative to
296.         to deepcopy().
297.         """
298.         obj = Empty()
299.         obj.__class__ = self.__class__
300.         # Copy references to everything.
301.         obj.__dict__ = self.__dict__.copy()
302.         # Clone attributes that can't use shallow copy.
303.         obj.alias_refcount = self.alias_refcount.copy()
304.         obj.alias_map = self.alias_map.copy()
305.         obj.external_aliases = self.external_aliases.copy()
306.         obj.table_map = self.table_map.copy()
307.         obj.where = self.where.clone()
308.         obj.annotations = self.annotations.copy()
309.         if self.annotation_select_mask is None:
310.             obj.annotation_select_mask = None
311.         else:
312.             obj.annotation_select_mask = self.annotation_select_mask.copy()
313.         # _annotation_select_cache cannot be copied, as doing so breaks the
314.         # (necessary) state in which both annotations and
315.         # _annotation_select_cache point to the same underlying objects.
316.         # It will get re-populated in the cloned queryset the next time it's
317.         # used.
318.         obj._annotation_select_cache = None
319.         obj.extra = self.extra.copy()
320.         if self.extra_select_mask is None:
321.             obj.extra_select_mask = None
322.         else:
323.             obj.extra_select_mask = self.extra_select_mask.copy()
324.         if self._extra_select_cache is None:
325.             obj._extra_select_cache = None
326.         else:
327.             obj._extra_select_cache = self._extra_select_cache.copy()
328.         if self.select_related is not False:
329.             # Use deepcopy because select_related stores fields in nested
330.             # dicts.
331.             obj.select_related = copy.deepcopy(obj.select_related)
332.         if 'subq_aliases' in self.__dict__:
333.             obj.subq_aliases = self.subq_aliases.copy()
334.         obj.used_aliases = self.used_aliases.copy()
335.         obj._filtered_relations = self._filtered_relations.copy()
336.         # Clear the cached_property
337.         try:
338.             del obj.base_table
339.         except AttributeError:
340.             pass
341.         return obj
342. 
343.     def chain(self, klass=None):
344.         """
345.         Return a copy of the current Query that's ready for another operation.
346.         The klass argument changes the type of the Query, e.g. UpdateQuery.
347.         """
348.         obj = self.clone()
349.         if klass and obj.__class__ != klass:
350.             obj.__class__ = klass
351.         if not obj.filter_is_sticky:
352.             obj.used_aliases = set()
353.         obj.filter_is_sticky = False
354.         if hasattr(obj, '_setup_query'):
355.             obj._setup_query()
356.         return obj
357. 
358.     def relabeled_clone(self, change_map):
359.         clone = self.clone()
360.         clone.change_aliases(change_map)
361.         return clone
362. 
363.     def rewrite_cols(self, annotation, col_cnt):
364.         # We must make sure the inner query has the referred columns in it.
365.         # If we are aggregating over an annotation, then Django uses Ref()
366.         # instances to note this. However, if we are annotating over a column
367.         # of a related model, then it might be that column isn't part of the
368.         # SELECT clause of the inner query, and we must manually make sure
369.         # the column is selected. An example case is:
370.         #    .aggregate(Sum('author__awards'))
371.         # Resolving this expression results in a join to author, but there
372.         # is no guarantee the awards column of author is in the select clause
373.         # of the query. Thus we must manually add the column to the inner
374.         # query.
375.         orig_exprs = annotation.get_source_expressions()
376.         new_exprs = []
377.         for expr in orig_exprs:
378.             # FIXME: These conditions are fairly arbitrary. Identify a better
379.             # method of having expressions decide which code path they should
380.             # take.
381.             if isinstance(expr, Ref):
382.                 # Its already a Ref to subquery (see resolve_ref() for
383.                 # details)
384.                 new_exprs.append(expr)
385.             elif isinstance(expr, (WhereNode, Lookup)):
386.                 # Decompose the subexpressions further. The code here is
387.                 # copied from the else clause, but this condition must appear
388.                 # before the contains_aggregate/is_summary condition below.
389.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
390.                 new_exprs.append(new_expr)
391.             else:
392.                 # Reuse aliases of expressions already selected in subquery.
393.                 for col_alias, selected_annotation in self.annotation_select.items():
394.                     if selected_annotation == expr:
395.                         new_expr = Ref(col_alias, expr)
396.                         break
397.                 else:
398.                     # An expression that is not selected the subquery.
399.                     if isinstance(expr, Col) or (expr.contains_aggregate and not expr.is_summary):
400.                         # Reference column or another aggregate. Select it
401.                         # under a non-conflicting alias.
402.                         col_cnt += 1
403.                         col_alias = '__col%d' % col_cnt
404.                         self.annotations[col_alias] = expr
405.                         self.append_annotation_mask([col_alias])
406.                         new_expr = Ref(col_alias, expr)
407.                     else:
408.                         # Some other expression not referencing database values
409.                         # directly. Its subexpression might contain Cols.
410.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
411.                 new_exprs.append(new_expr)
412.         annotation.set_source_expressions(new_exprs)
413.         return annotation, col_cnt
414. 
415.     def get_aggregation(self, using, added_aggregate_names):
416.         """
417.         Return the dictionary with the values of the existing aggregations.
418.         """
419.         if not self.annotation_select:
420.             return {}
421.         existing_annotations = [
422.             annotation for alias, annotation
423.             in self.annotations.items()
424.             if alias not in added_aggregate_names
425.         ]
426.         # Decide if we need to use a subquery.
427.         #
428.         # Existing annotations would cause incorrect results as get_aggregation()
429.         # must produce just one result and thus must not use GROUP BY. But we
430.         # aren't smart enough to remove the existing annotations from the
431.         # query, so those would force us to use GROUP BY.
432.         #
433.         # If the query has limit or distinct, or uses set operations, then
434.         # those operations must be done in a subquery so that the query
435.         # aggregates on the limit and/or distinct results instead of applying
436.         # the distinct and limit after the aggregation.
437.         if (isinstance(self.group_by, tuple) or self.is_sliced or existing_annotations or
438.                 self.distinct or self.combinator):
439.             from django.db.models.sql.subqueries import AggregateQuery
440.             outer_query = AggregateQuery(self.model)
441.             inner_query = self.clone()
442.             inner_query.select_for_update = False
443.             inner_query.select_related = False
444.             inner_query.set_annotation_mask(self.annotation_select)
445.             if not self.is_sliced and not self.distinct_fields:
446.                 # Queries with distinct_fields need ordering and when a limit
447.                 # is applied we must take the slice from the ordered query.
448.                 # Otherwise no need for ordering.
449.                 inner_query.clear_ordering(True)
450.             if not inner_query.distinct:
451.                 # If the inner query uses default select and it has some
452.                 # aggregate annotations, then we must make sure the inner
453.                 # query is grouped by the main model's primary key. However,
454.                 # clearing the select clause can alter results if distinct is
455.                 # used.
456.                 has_existing_aggregate_annotations = any(
457.                     annotation for annotation in existing_annotations
458.                     if getattr(annotation, 'contains_aggregate', True)
459.                 )
460.                 if inner_query.default_cols and has_existing_aggregate_annotations:
461.                     inner_query.group_by = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
462.                 inner_query.default_cols = False
463. 
464.             relabels = {t: 'subquery' for t in inner_query.alias_map}
465.             relabels[None] = 'subquery'
466.             # Remove any aggregates marked for reduction from the subquery
467.             # and move them to the outer AggregateQuery.
468.             col_cnt = 0
469.             for alias, expression in list(inner_query.annotation_select.items()):
470.                 annotation_select_mask = inner_query.annotation_select_mask
471.                 if expression.is_summary:
472.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
473.                     outer_query.annotations[alias] = expression.relabeled_clone(relabels)
474.                     del inner_query.annotations[alias]
475.                     annotation_select_mask.remove(alias)
476.                 # Make sure the annotation_select wont use cached results.
477.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
478.             if inner_query.select == () and not inner_query.default_cols and not inner_query.annotation_select_mask:
479.                 # In case of Model.objects[0:3].count(), there would be no
480.                 # field selected in the inner query, yet we must use a subquery.
481.                 # So, make sure at least one field is selected.
482.                 inner_query.select = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
483.             try:
484.                 outer_query.add_subquery(inner_query, using)
485.             except EmptyResultSet:
486.                 return {
487.                     alias: None
488.                     for alias in outer_query.annotation_select
489.                 }
490.         else:
491.             outer_query = self
492.             self.select = ()
493.             self.default_cols = False
494.             self.extra = {}
495. 
496.         outer_query.clear_ordering(True)
497.         outer_query.clear_limits()
498.         outer_query.select_for_update = False
499.         outer_query.select_related = False
500.         compiler = outer_query.get_compiler(using)
501.         result = compiler.execute_sql(SINGLE)
502.         if result is None:
503.             result = [None] * len(outer_query.annotation_select)
504. 
505.         converters = compiler.get_converters(outer_query.annotation_select.values())
506.         result = next(compiler.apply_converters((result,), converters))
507. 
508.         return dict(zip(outer_query.annotation_select, result))
509. 
510.     def get_count(self, using):
511.         """
512.         Perform a COUNT() query using the current filter constraints.
513.         """
514.         obj = self.clone()
515.         obj.add_annotation(Count('*'), alias='__count', is_summary=True)
516.         number = obj.get_aggregation(using, ['__count'])['__count']
517.         if number is None:
518.             number = 0
519.         return number
520. 
521.     def has_filters(self):
522.         return self.where
523. 
524.     def has_results(self, using):
525.         q = self.clone()
526.         if not q.distinct:
527.             if q.group_by is True:
528.                 q.add_fields((f.attname for f in self.model._meta.concrete_fields), False)
529.                 q.set_group_by()
530.             q.clear_select_clause()
531.         q.clear_ordering(True)
532.         q.set_limits(high=1)
533.         compiler = q.get_compiler(using=using)
534.         return compiler.has_results()
535. 
536.     def explain(self, using, format=None, **options):
537.         q = self.clone()
538.         q.explain_query = True
539.         q.explain_format = format
540.         q.explain_options = options
541.         compiler = q.get_compiler(using=using)
542.         return '\n'.join(compiler.explain_query())
543. 
544.     def combine(self, rhs, connector):
545.         """
546.         Merge the 'rhs' query into the current one (with any 'rhs' effects
547.         being applied *after* (that is, "to the right of") anything in the
548.         current query. 'rhs' is not modified during a call to this function.
549. 
550.         The 'connector' parameter describes how to connect filters from the
551.         'rhs' query.
552.         """
553.         assert self.model == rhs.model, \
554.             "Cannot combine queries on two different base models."
555.         assert not self.is_sliced, \
556.             "Cannot combine queries once a slice has been taken."
557.         assert self.distinct == rhs.distinct, \
558.             "Cannot combine a unique query with a non-unique query."
559.         assert self.distinct_fields == rhs.distinct_fields, \
560.             "Cannot combine queries with different distinct fields."
561. 
562.         # Work out how to relabel the rhs aliases, if necessary.
563.         change_map = {}
564.         conjunction = (connector == AND)
565. 
566.         # Determine which existing joins can be reused. When combining the
567.         # query with AND we must recreate all joins for m2m filters. When
568.         # combining with OR we can reuse joins. The reason is that in AND
569.         # case a single row can't fulfill a condition like:
570.         #     revrel__col=1 & revrel__col=2
571.         # But, there might be two different related rows matching this
572.         # condition. In OR case a single True is enough, so single row is
573.         # enough, too.
574.         #
575.         # Note that we will be creating duplicate joins for non-m2m joins in
576.         # the AND case. The results will be correct but this creates too many
577.         # joins. This is something that could be fixed later on.
578.         reuse = set() if conjunction else set(self.alias_map)
579.         # Base table must be present in the query - this is the same
580.         # table on both sides.
581.         self.get_initial_alias()
582.         joinpromoter = JoinPromoter(connector, 2, False)
583.         joinpromoter.add_votes(
584.             j for j in self.alias_map if self.alias_map[j].join_type == INNER)
585.         rhs_votes = set()
586.         # Now, add the joins from rhs query into the new query (skipping base
587.         # table).
588.         rhs_tables = list(rhs.alias_map)[1:]
589.         for alias in rhs_tables:
590.             join = rhs.alias_map[alias]
591.             # If the left side of the join was already relabeled, use the
592.             # updated alias.
593.             join = join.relabeled_clone(change_map)
594.             new_alias = self.join(join, reuse=reuse)
595.             if join.join_type == INNER:
596.                 rhs_votes.add(new_alias)
597.             # We can't reuse the same join again in the query. If we have two
598.             # distinct joins for the same connection in rhs query, then the
599.             # combined query must have two joins, too.
600.             reuse.discard(new_alias)
601.             if alias != new_alias:
602.                 change_map[alias] = new_alias
603.             if not rhs.alias_refcount[alias]:
604.                 # The alias was unused in the rhs query. Unref it so that it
605.                 # will be unused in the new query, too. We have to add and
606.                 # unref the alias so that join promotion has information of
607.                 # the join type for the unused alias.
608.                 self.unref_alias(new_alias)
609.         joinpromoter.add_votes(rhs_votes)
610.         joinpromoter.update_join_types(self)
611. 
612.         # Now relabel a copy of the rhs where-clause and add it to the current
613.         # one.
614.         w = rhs.where.clone()
615.         w.relabel_aliases(change_map)
616.         self.where.add(w, connector)
617. 
618.         # Selection columns and extra extensions are those provided by 'rhs'.
619.         if rhs.select:
620.             self.set_select([col.relabeled_clone(change_map) for col in rhs.select])
621.         else:
622.             self.select = ()
623. 
624.         if connector == OR:
625.             # It would be nice to be able to handle this, but the queries don't
626.             # really make sense (or return consistent value sets). Not worth
627.             # the extra complexity when you can write a real query instead.
628.             if self.extra and rhs.extra:
629.                 raise ValueError("When merging querysets using 'or', you cannot have extra(select=...) on both sides.")
630.         self.extra.update(rhs.extra)
631.         extra_select_mask = set()
632.         if self.extra_select_mask is not None:
633.             extra_select_mask.update(self.extra_select_mask)
634.         if rhs.extra_select_mask is not None:
635.             extra_select_mask.update(rhs.extra_select_mask)
636.         if extra_select_mask:
637.             self.set_extra_mask(extra_select_mask)
638.         self.extra_tables += rhs.extra_tables
639. 
640.         # Ordering uses the 'rhs' ordering, unless it has none, in which case
641.         # the current ordering is used.
642.         self.order_by = rhs.order_by or self.order_by
643.         self.extra_order_by = rhs.extra_order_by or self.extra_order_by
644. 
645.     def deferred_to_data(self, target, callback):
646.         """
647.         Convert the self.deferred_loading data structure to an alternate data
648.         structure, describing the field that *will* be loaded. This is used to
649.         compute the columns to select from the database and also by the
650.         QuerySet class to work out which fields are being initialized on each
651.         model. Models that have all their fields included aren't mentioned in
652.         the result, only those that have field restrictions in place.
653. 
654.         The "target" parameter is the instance that is populated (in place).
655.         The "callback" is a function that is called whenever a (model, field)
656.         pair need to be added to "target". It accepts three parameters:
657.         "target", and the model and list of fields being added for that model.
658.         """
659.         field_names, defer = self.deferred_loading
660.         if not field_names:
661.             return
662.         orig_opts = self.get_meta()
663.         seen = {}
664.         must_include = {orig_opts.concrete_model: {orig_opts.pk}}
665.         for field_name in field_names:
666.             parts = field_name.split(LOOKUP_SEP)
667.             cur_model = self.model._meta.concrete_model
668.             opts = orig_opts
669.             for name in parts[:-1]:
670.                 old_model = cur_model
671.                 if name in self._filtered_relations:
672.                     name = self._filtered_relations[name].relation_name
673.                 source = opts.get_field(name)
674.                 if is_reverse_o2o(source):
675.                     cur_model = source.related_model
676.                 else:
677.                     cur_model = source.remote_field.model
678.                 opts = cur_model._meta
679.                 # Even if we're "just passing through" this model, we must add
680.                 # both the current model's pk and the related reference field
681.                 # (if it's not a reverse relation) to the things we select.
682.                 if not is_reverse_o2o(source):
683.                     must_include[old_model].add(source)
684.                 add_to_dict(must_include, cur_model, opts.pk)
685.             field = opts.get_field(parts[-1])
686.             is_reverse_object = field.auto_created and not field.concrete
687.             model = field.related_model if is_reverse_object else field.model
688.             model = model._meta.concrete_model
689.             if model == opts.model:
690.                 model = cur_model
691.             if not is_reverse_o2o(field):
692.                 add_to_dict(seen, model, field)
693. 
694.         if defer:
695.             # We need to load all fields for each model, except those that
696.             # appear in "seen" (for all models that appear in "seen"). The only
697.             # slight complexity here is handling fields that exist on parent
698.             # models.
699.             workset = {}
700.             for model, values in seen.items():
701.                 for field in model._meta.local_fields:
702.                     if field not in values:
703.                         m = field.model._meta.concrete_model
704.                         add_to_dict(workset, m, field)
705.             for model, values in must_include.items():
706.                 # If we haven't included a model in workset, we don't add the
707.                 # corresponding must_include fields for that model, since an
708.                 # empty set means "include all fields". That's why there's no
709.                 # "else" branch here.
710.                 if model in workset:
711.                     workset[model].update(values)
712.             for model, values in workset.items():
713.                 callback(target, model, values)
714.         else:
715.             for model, values in must_include.items():
716.                 if model in seen:
717.                     seen[model].update(values)
718.                 else:
719.                     # As we've passed through this model, but not explicitly
720.                     # included any fields, we have to make sure it's mentioned
721.                     # so that only the "must include" fields are pulled in.
722.                     seen[model] = values
723.             # Now ensure that every model in the inheritance chain is mentioned
724.             # in the parent list. Again, it must be mentioned to ensure that
725.             # only "must include" fields are pulled in.
726.             for model in orig_opts.get_parent_list():
727.                 seen.setdefault(model, set())
728.             for model, values in seen.items():
729.                 callback(target, model, values)
730. 
731.     def table_alias(self, table_name, create=False, filtered_relation=None):
732.         """
733.         Return a table alias for the given table_name and whether this is a
734.         new alias or not.
735. 
736.         If 'create' is true, a new alias is always created. Otherwise, the
737.         most recently created alias for the table (if one exists) is reused.
738.         """
739.         alias_list = self.table_map.get(table_name)
740.         if not create and alias_list:
741.             alias = alias_list[0]
742.             self.alias_refcount[alias] += 1
743.             return alias, False
744. 
745.         # Create a new alias for this table.
746.         if alias_list:
747.             alias = '%s%d' % (self.alias_prefix, len(self.alias_map) + 1)
748.             alias_list.append(alias)
749.         else:
750.             # The first occurrence of a table uses the table name directly.
751.             alias = filtered_relation.alias if filtered_relation is not None else table_name
752.             self.table_map[table_name] = [alias]
753.         self.alias_refcount[alias] = 1
754.         return alias, True
755. 
756.     def ref_alias(self, alias):
757.         """Increases the reference count for this alias."""
758.         self.alias_refcount[alias] += 1
759. 
760.     def unref_alias(self, alias, amount=1):
761.         """Decreases the reference count for this alias."""
762.         self.alias_refcount[alias] -= amount
763. 
764.     def promote_joins(self, aliases):
765.         """
766.         Promote recursively the join type of given aliases and its children to
767.         an outer join. If 'unconditional' is False, only promote the join if
768.         it is nullable or the parent join is an outer join.
769. 
770.         The children promotion is done to avoid join chains that contain a LOUTER
771.         b INNER c. So, if we have currently a INNER b INNER c and a->b is promoted,
772.         then we must also promote b->c automatically, or otherwise the promotion
773.         of a->b doesn't actually change anything in the query results.
774.         """
775.         aliases = list(aliases)
776.         while aliases:
777.             alias = aliases.pop(0)
778.             if self.alias_map[alias].join_type is None:
779.                 # This is the base table (first FROM entry) - this table
780.                 # isn't really joined at all in the query, so we should not
781.                 # alter its join type.
782.                 continue
783.             # Only the first alias (skipped above) should have None join_type
784.             assert self.alias_map[alias].join_type is not None
785.             parent_alias = self.alias_map[alias].parent_alias
786.             parent_louter = parent_alias and self.alias_map[parent_alias].join_type == LOUTER
787.             already_louter = self.alias_map[alias].join_type == LOUTER
788.             if ((self.alias_map[alias].nullable or parent_louter) and
789.                     not already_louter):
790.                 self.alias_map[alias] = self.alias_map[alias].promote()
791.                 # Join type of 'alias' changed, so re-examine all aliases that
792.                 # refer to this one.
793.                 aliases.extend(
794.                     join for join in self.alias_map
795.                     if self.alias_map[join].parent_alias == alias and join not in aliases
796.                 )
797. 
798.     def demote_joins(self, aliases):
799.         """
800.         Change join type from LOUTER to INNER for all joins in aliases.
801. 
802.         Similarly to promote_joins(), this method must ensure no join chains
803.         containing first an outer, then an inner join are generated. If we
804.         are demoting b->c join in chain a LOUTER b LOUTER c then we must
805.         demote a->b automatically, or otherwise the demotion of b->c doesn't
806.         actually change anything in the query results. .
807.         """
808.         aliases = list(aliases)
809.         while aliases:
810.             alias = aliases.pop(0)
811.             if self.alias_map[alias].join_type == LOUTER:
812.                 self.alias_map[alias] = self.alias_map[alias].demote()
813.                 parent_alias = self.alias_map[alias].parent_alias
814.                 if self.alias_map[parent_alias].join_type == INNER:
815.                     aliases.append(parent_alias)
816. 
817.     def reset_refcounts(self, to_counts):
818.         """
819.         Reset reference counts for aliases so that they match the value passed
820.         in `to_counts`.
821.         """
822.         for alias, cur_refcount in self.alias_refcount.copy().items():
823.             unref_amount = cur_refcount - to_counts.get(alias, 0)
824.             self.unref_alias(alias, unref_amount)
825. 
826.     def change_aliases(self, change_map):
827.         """
828.         Change the aliases in change_map (which maps old-alias -> new-alias),
829.         relabelling any references to them in select columns and the where
830.         clause.
831.         """
832.         assert set(change_map).isdisjoint(change_map.values())
833. 
834.         # 1. Update references in "select" (normal columns plus aliases),
835.         # "group by" and "where".
836.         self.where.relabel_aliases(change_map)
837.         if isinstance(self.group_by, tuple):
838.             self.group_by = tuple([col.relabeled_clone(change_map) for col in self.group_by])
839.         self.select = tuple([col.relabeled_clone(change_map) for col in self.select])
840.         self.annotations = self.annotations and {
841.             key: col.relabeled_clone(change_map) for key, col in self.annotations.items()
842.         }
843. 
844.         # 2. Rename the alias in the internal table/alias datastructures.
845.         for old_alias, new_alias in change_map.items():
846.             if old_alias not in self.alias_map:
847.                 continue
848.             alias_data = self.alias_map[old_alias].relabeled_clone(change_map)
849.             self.alias_map[new_alias] = alias_data
850.             self.alias_refcount[new_alias] = self.alias_refcount[old_alias]
851.             del self.alias_refcount[old_alias]
852.             del self.alias_map[old_alias]
853. 
854.             table_aliases = self.table_map[alias_data.table_name]
855.             for pos, alias in enumerate(table_aliases):
856.                 if alias == old_alias:
857.                     table_aliases[pos] = new_alias
858.                     break
859.         self.external_aliases = {change_map.get(alias, alias)
860.                                  for alias in self.external_aliases}
861. 
862.     def bump_prefix(self, outer_query):
863.         """
864.         Change the alias prefix to the next letter in the alphabet in a way
865.         that the outer query's aliases and this query's aliases will not
866.         conflict. Even tables that previously had no alias will get an alias
867.         after this call.
868.         """
869.         def prefix_gen():
870.             """
871.             Generate a sequence of characters in alphabetical order:
872.                 -> 'A', 'B', 'C', ...
873. 
874.             When the alphabet is finished, the sequence will continue with the
875.             Cartesian product:
876.                 -> 'AA', 'AB', 'AC', ...
877.             """
878.             alphabet = ascii_uppercase
879.             prefix = chr(ord(self.alias_prefix) + 1)
880.             yield prefix
881.             for n in count(1):
882.                 seq = alphabet[alphabet.index(prefix):] if prefix else alphabet
883.                 for s in product(seq, repeat=n):
884.                     yield ''.join(s)
885.                 prefix = None
886. 
887.         if self.alias_prefix != outer_query.alias_prefix:
888.             # No clashes between self and outer query should be possible.
889.             return
890. 
891.         # Explicitly avoid infinite loop. The constant divider is based on how
892.         # much depth recursive subquery references add to the stack. This value
893.         # might need to be adjusted when adding or removing function calls from
894.         # the code path in charge of performing these operations.
895.         local_recursion_limit = sys.getrecursionlimit() // 16
896.         for pos, prefix in enumerate(prefix_gen()):
897.             if prefix not in self.subq_aliases:
898.                 self.alias_prefix = prefix
899.                 break
900.             if pos > local_recursion_limit:
901.                 raise RecursionError(
902.                     'Maximum recursion depth exceeded: too many subqueries.'
903.                 )
904.         self.subq_aliases = self.subq_aliases.union([self.alias_prefix])
905.         outer_query.subq_aliases = outer_query.subq_aliases.union(self.subq_aliases)
906.         self.change_aliases({
907.             alias: '%s%d' % (self.alias_prefix, pos)
908.             for pos, alias in enumerate(self.alias_map)
909.         })
910. 
911.     def get_initial_alias(self):
912.         """
913.         Return the first alias for this query, after increasing its reference
914.         count.
915.         """
916.         if self.alias_map:
917.             alias = self.base_table
918.             self.ref_alias(alias)
919.         else:
920.             alias = self.join(BaseTable(self.get_meta().db_table, None))
921.         return alias
922. 
923.     def count_active_tables(self):
924.         """
925.         Return the number of tables in this query with a non-zero reference
926.         count. After execution, the reference counts are zeroed, so tables
927.         added in compiler will not be seen by this method.
928.         """
929.         return len([1 for count in self.alias_refcount.values() if count])
930. 
931.     def join(self, join, reuse=None, reuse_with_filtered_relation=False):
932.         """
933.         Return an alias for the 'join', either reusing an existing alias for
934.         that join or creating a new one. 'join' is either a
935.         sql.datastructures.BaseTable or Join.
936. 
937.         The 'reuse' parameter can be either None which means all joins are
938.         reusable, or it can be a set containing the aliases that can be reused.
939. 
940.         The 'reuse_with_filtered_relation' parameter is used when computing
941.         FilteredRelation instances.
942. 
943.         A join is always created as LOUTER if the lhs alias is LOUTER to make
944.         sure chains like t1 LOUTER t2 INNER t3 aren't generated. All new
945.         joins are created as LOUTER if the join is nullable.
946.         """
947.         if reuse_with_filtered_relation and reuse:
948.             reuse_aliases = [
949.                 a for a, j in self.alias_map.items()
950.                 if a in reuse and j.equals(join, with_filtered_relation=False)
951.             ]
952.         else:
953.             reuse_aliases = [
954.                 a for a, j in self.alias_map.items()
955.                 if (reuse is None or a in reuse) and j == join
956.             ]
957.         if reuse_aliases:
958.             if join.table_alias in reuse_aliases:
959.                 reuse_alias = join.table_alias
960.             else:
961.                 # Reuse the most recent alias of the joined table
962.                 # (a many-to-many relation may be joined multiple times).
963.                 reuse_alias = reuse_aliases[-1]
964.             self.ref_alias(reuse_alias)
965.             return reuse_alias
966. 
967.         # No reuse is possible, so we need a new alias.
968.         alias, _ = self.table_alias(join.table_name, create=True, filtered_relation=join.filtered_relation)
969.         if join.join_type:
970.             if self.alias_map[join.parent_alias].join_type == LOUTER or join.nullable:
971.                 join_type = LOUTER
972.             else:
973.                 join_type = INNER
974.             join.join_type = join_type
975.         join.table_alias = alias
976.         self.alias_map[alias] = join
977.         return alias
978. 
979.     def join_parent_model(self, opts, model, alias, seen):
980.         """
981.         Make sure the given 'model' is joined in the query. If 'model' isn't
982.         a parent of 'opts' or if it is None this method is a no-op.
983. 
984.         The 'alias' is the root alias for starting the join, 'seen' is a dict
985.         of model -> alias of existing joins. It must also contain a mapping
986.         of None -> some alias. This will be returned in the no-op case.
987.         """
988.         if model in seen:
989.             return seen[model]
990.         chain = opts.get_base_chain(model)
991.         if not chain:
992.             return alias
993.         curr_opts = opts
994.         for int_model in chain:
995.             if int_model in seen:
996.                 curr_opts = int_model._meta
997.                 alias = seen[int_model]
998.                 continue
999.             # Proxy model have elements in base chain
1000.             # with no parents, assign the new options
1001.             # object and skip to the next base in that
1002.             # case
1003.             if not curr_opts.parents[int_model]:
1004.                 curr_opts = int_model._meta
1005.                 continue
1006.             link_field = curr_opts.get_ancestor_link(int_model)
1007.             join_info = self.setup_joins([link_field.name], curr_opts, alias)
1008.             curr_opts = int_model._meta
1009.             alias = seen[int_model] = join_info.joins[-1]
1010.         return alias or seen[None]
1011. 
1012.     def add_annotation(self, annotation, alias, is_summary=False):
1013.         """Add a single annotation expression to the Query."""
1014.         annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None,
1015.                                                    summarize=is_summary)
1016.         self.append_annotation_mask([alias])
1017.         self.annotations[alias] = annotation
1018. 
1019.     def resolve_expression(self, query, *args, **kwargs):
1020.         clone = self.clone()
1021.         # Subqueries need to use a different set of aliases than the outer query.
1022.         clone.bump_prefix(query)
1023.         clone.subquery = True
1024.         # It's safe to drop ordering if the queryset isn't using slicing,
1025.         # distinct(*fields) or select_for_update().
1026.         if (self.low_mark == 0 and self.high_mark is None and
1027.                 not self.distinct_fields and
1028.                 not self.select_for_update):
1029.             clone.clear_ordering(True)
1030.         clone.where.resolve_expression(query, *args, **kwargs)
1031.         for key, value in clone.annotations.items():
1032.             resolved = value.resolve_expression(query, *args, **kwargs)
1033.             if hasattr(resolved, 'external_aliases'):
1034.                 resolved.external_aliases.update(clone.alias_map)
1035.             clone.annotations[key] = resolved
1036.         # Outer query's aliases are considered external.
1037.         clone.external_aliases.update(
1038.             alias for alias, table in query.alias_map.items()
1039.             if (
1040.                 isinstance(table, Join) and table.join_field.related_model._meta.db_table != alias
1041.             ) or (
1042.                 isinstance(table, BaseTable) and table.table_name != table.table_alias
1043.             )
1044.         )
1045.         return clone
1046. 
1047.     def as_sql(self, compiler, connection):
1048.         sql, params = self.get_compiler(connection=connection).as_sql()
1049.         if self.subquery:
1050.             sql = '(%s)' % sql
1051.         return sql, params
1052. 
1053.     def resolve_lookup_value(self, value, can_reuse, allow_joins, simple_col):
1054.         if hasattr(value, 'resolve_expression'):
1055.             kwargs = {'reuse': can_reuse, 'allow_joins': allow_joins}
1056.             if isinstance(value, F):
1057.                 kwargs['simple_col'] = simple_col
1058.             value = value.resolve_expression(self, **kwargs)
1059.         elif isinstance(value, (list, tuple)):
1060.             # The items of the iterable may be expressions and therefore need
1061.             # to be resolved independently.
1062.             resolved_values = []
1063.             for sub_value in value:
1064.                 if hasattr(sub_value, 'resolve_expression'):
1065.                     if isinstance(sub_value, F):
1066.                         resolved_values.append(sub_value.resolve_expression(
1067.                             self, reuse=can_reuse, allow_joins=allow_joins,
1068.                             simple_col=simple_col,
1069.                         ))
1070.                     else:
1071.                         resolved_values.append(sub_value.resolve_expression(
1072.                             self, reuse=can_reuse, allow_joins=allow_joins,
1073.                         ))
1074.                 else:
1075.                     resolved_values.append(sub_value)
1076.             value = tuple(resolved_values)
1077.         return value
1078. 
1079.     def solve_lookup_type(self, lookup):
1080.         """
1081.         Solve the lookup type from the lookup (e.g.: 'foobar__id__icontains').
1082.         """
1083.         lookup_splitted = lookup.split(LOOKUP_SEP)
1084.         if self.annotations:
1085.             expression, expression_lookups = refs_expression(lookup_splitted, self.annotations)
1086.             if expression:
1087.                 return expression_lookups, (), expression
1088.         _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
1089.         field_parts = lookup_splitted[0:len(lookup_splitted) - len(lookup_parts)]
1090.         if len(lookup_parts) > 1 and not field_parts:
1091.             raise FieldError(
1092.                 'Invalid lookup "%s" for model %s".' %
1093.                 (lookup, self.get_meta().model.__name__)
1094.             )
1095.         return lookup_parts, field_parts, False
1096. 
1097.     def check_query_object_type(self, value, opts, field):
1098.         """
1099.         Check whether the object passed while querying is of the correct type.
1100.         If not, raise a ValueError specifying the wrong object.
1101.         """
1102.         if hasattr(value, '_meta'):
1103.             if not check_rel_lookup_compatibility(value._meta.model, opts, field):
1104.                 raise ValueError(
1105.                     'Cannot query "%s": Must be "%s" instance.' %
1106.                     (value, opts.object_name))
1107. 
1108.     def check_related_objects(self, field, value, opts):
1109.         """Check the type of object passed to query relations."""
1110.         if field.is_relation:
1111.             # Check that the field and the queryset use the same model in a
1112.             # query like .filter(author=Author.objects.all()). For example, the
1113.             # opts would be Author's (from the author field) and value.model
1114.             # would be Author.objects.all() queryset's .model (Author also).
1115.             # The field is the related field on the lhs side.
1116.             if (isinstance(value, Query) and not value.has_select_fields and
1117.                     not check_rel_lookup_compatibility(value.model, opts, field)):
1118.                 raise ValueError(
1119.                     'Cannot use QuerySet for "%s": Use a QuerySet for "%s".' %
1120.                     (value.model._meta.object_name, opts.object_name)
1121.                 )
1122.             elif hasattr(value, '_meta'):
1123.                 self.check_query_object_type(value, opts, field)
1124.             elif hasattr(value, '__iter__'):
1125.                 for v in value:
1126.                     self.check_query_object_type(v, opts, field)
1127. 
1128.     def check_filterable(self, expression):
1129.         """Raise an error if expression cannot be used in a WHERE clause."""
1130.         if not getattr(expression, 'filterable', 'True'):
1131.             raise NotSupportedError(
1132.                 expression.__class__.__name__ + ' is disallowed in the filter '
1133.                 'clause.'
1134.             )
1135.         if hasattr(expression, 'get_source_expressions'):
1136.             for expr in expression.get_source_expressions():
1137.                 self.check_filterable(expr)
1138. 
1139.     def build_lookup(self, lookups, lhs, rhs):
1140.         """
1141.         Try to extract transforms and lookup from given lhs.
1142. 
1143.         The lhs value is something that works like SQLExpression.
1144.         The rhs value is what the lookup is going to compare against.
1145.         The lookups is a list of names to extract using get_lookup()
1146.         and get_transform().
1147.         """
1148.         # __exact is the default lookup if one isn't given.
1149.         *transforms, lookup_name = lookups or ['exact']
1150.         for name in transforms:
1151.             lhs = self.try_transform(lhs, name)
1152.         # First try get_lookup() so that the lookup takes precedence if the lhs
1153.         # supports both transform and lookup for the name.
1154.         lookup_class = lhs.get_lookup(lookup_name)
1155.         if not lookup_class:
1156.             if lhs.field.is_relation:
1157.                 raise FieldError('Related Field got invalid lookup: {}'.format(lookup_name))
1158.             # A lookup wasn't found. Try to interpret the name as a transform
1159.             # and do an Exact lookup against it.
1160.             lhs = self.try_transform(lhs, lookup_name)
1161.             lookup_name = 'exact'
1162.             lookup_class = lhs.get_lookup(lookup_name)
1163.             if not lookup_class:
1164.                 return
1165. 
1166.         lookup = lookup_class(lhs, rhs)
1167.         # Interpret '__exact=None' as the sql 'is NULL'; otherwise, reject all
1168.         # uses of None as a query value unless the lookup supports it.
1169.         if lookup.rhs is None and not lookup.can_use_none_as_rhs:
1170.             if lookup_name not in ('exact', 'iexact'):
1171.                 raise ValueError("Cannot use None as a query value")
1172.             return lhs.get_lookup('isnull')(lhs, True)
1173. 
1174.         # For Oracle '' is equivalent to null. The check must be done at this
1175.         # stage because join promotion can't be done in the compiler. Using
1176.         # DEFAULT_DB_ALIAS isn't nice but it's the best that can be done here.
1177.         # A similar thing is done in is_nullable(), too.
1178.         if (connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls and
1179.                 lookup_name == 'exact' and lookup.rhs == ''):
1180.             return lhs.get_lookup('isnull')(lhs, True)
1181. 
1182.         return lookup
1183. 
1184.     def try_transform(self, lhs, name):
1185.         """
1186.         Helper method for build_lookup(). Try to fetch and initialize
1187.         a transform for name parameter from lhs.
1188.         """
1189.         transform_class = lhs.get_transform(name)
1190.         if transform_class:
1191.             return transform_class(lhs)
1192.         else:
1193.             output_field = lhs.output_field.__class__
1194.             suggested_lookups = difflib.get_close_matches(name, output_field.get_lookups())
1195.             if suggested_lookups:
1196.                 suggestion = ', perhaps you meant %s?' % ' or '.join(suggested_lookups)
1197.             else:
1198.                 suggestion = '.'
1199.             raise FieldError(
1200.                 "Unsupported lookup '%s' for %s or join on the field not "
1201.                 "permitted%s" % (name, output_field.__name__, suggestion)
1202.             )
1203. 
1204.     def build_filter(self, filter_expr, branch_negated=False, current_negated=False,
1205.                      can_reuse=None, allow_joins=True, split_subq=True,
1206.                      reuse_with_filtered_relation=False, simple_col=False):
1207.         """
1208.         Build a WhereNode for a single filter clause but don't add it
1209.         to this Query. Query.add_q() will then add this filter to the where
1210.         Node.
1211. 
1212.         The 'branch_negated' tells us if the current branch contains any
1213.         negations. This will be used to determine if subqueries are needed.
1214. 
1215.         The 'current_negated' is used to determine if the current filter is
1216.         negated or not and this will be used to determine if IS NULL filtering
1217.         is needed.
1218. 
1219.         The difference between current_negated and branch_negated is that
1220.         branch_negated is set on first negation, but current_negated is
1221.         flipped for each negation.
1222. 
1223.         Note that add_filter will not do any negating itself, that is done
1224.         upper in the code by add_q().
1225. 
1226.         The 'can_reuse' is a set of reusable joins for multijoins.
1227. 
1228.         If 'reuse_with_filtered_relation' is True, then only joins in can_reuse
1229.         will be reused.
1230. 
1231.         The method will create a filter clause that can be added to the current
1232.         query. However, if the filter isn't added to the query then the caller
1233.         is responsible for unreffing the joins used.
1234.         """
1235.         if isinstance(filter_expr, dict):
1236.             raise FieldError("Cannot parse keyword query as dict")
1237.         if hasattr(filter_expr, 'resolve_expression') and getattr(filter_expr, 'conditional', False):
1238.             if connections[DEFAULT_DB_ALIAS].ops.conditional_expression_supported_in_where_clause(filter_expr):
1239.                 condition = filter_expr.resolve_expression(self)
1240.             else:
1241.                 # Expression is not supported in the WHERE clause, add
1242.                 # comparison with True.
1243.                 condition = self.build_lookup(['exact'], filter_expr.resolve_expression(self), True)
1244.             clause = self.where_class()
1245.             clause.add(condition, AND)
1246.             return clause, []
1247.         arg, value = filter_expr
1248.         if not arg:
1249.             raise FieldError("Cannot parse keyword query %r" % arg)
1250.         lookups, parts, reffed_expression = self.solve_lookup_type(arg)
1251. 
1252.         self.check_filterable(reffed_expression)
1253. 
1254.         if not allow_joins and len(parts) > 1:
1255.             raise FieldError("Joined field references are not permitted in this query")
1256. 
1257.         pre_joins = self.alias_refcount.copy()
1258.         value = self.resolve_lookup_value(value, can_reuse, allow_joins, simple_col)
1259.         used_joins = {k for k, v in self.alias_refcount.items() if v > pre_joins.get(k, 0)}
1260. 
1261.         self.check_filterable(value)
1262. 
1263.         clause = self.where_class()
1264.         if reffed_expression:
1265.             condition = self.build_lookup(lookups, reffed_expression, value)
1266.             clause.add(condition, AND)
1267.             return clause, []
1268. 
1269.         opts = self.get_meta()
1270.         alias = self.get_initial_alias()
1271.         allow_many = not branch_negated or not split_subq
1272. 
1273.         try:
1274.             join_info = self.setup_joins(
1275.                 parts, opts, alias, can_reuse=can_reuse, allow_many=allow_many,
1276.                 reuse_with_filtered_relation=reuse_with_filtered_relation,
1277.             )
1278. 
1279.             # Prevent iterator from being consumed by check_related_objects()
1280.             if isinstance(value, Iterator):
1281.                 value = list(value)
1282.             self.check_related_objects(join_info.final_field, value, join_info.opts)
1283. 
1284.             # split_exclude() needs to know which joins were generated for the
1285.             # lookup parts
1286.             self._lookup_joins = join_info.joins
1287.         except MultiJoin as e:
1288.             return self.split_exclude(filter_expr, can_reuse, e.names_with_path)
1289. 
1290.         # Update used_joins before trimming since they are reused to determine
1291.         # which joins could be later promoted to INNER.
1292.         used_joins.update(join_info.joins)
1293.         targets, alias, join_list = self.trim_joins(join_info.targets, join_info.joins, join_info.path)
1294.         if can_reuse is not None:
1295.             can_reuse.update(join_list)
1296. 
1297.         if join_info.final_field.is_relation:
1298.             # No support for transforms for relational fields
1299.             num_lookups = len(lookups)
1300.             if num_lookups > 1:
1301.                 raise FieldError('Related Field got invalid lookup: {}'.format(lookups[0]))
1302.             if len(targets) == 1:
1303.                 col = _get_col(targets[0], join_info.final_field, alias, simple_col)
1304.             else:
1305.                 col = MultiColSource(alias, targets, join_info.targets, join_info.final_field)
1306.         else:
1307.             col = _get_col(targets[0], join_info.final_field, alias, simple_col)
1308. 
1309.         condition = self.build_lookup(lookups, col, value)
1310.         lookup_type = condition.lookup_name
1311.         clause.add(condition, AND)
1312. 
1313.         require_outer = lookup_type == 'isnull' and condition.rhs is True and not current_negated
1314.         if current_negated and (lookup_type != 'isnull' or condition.rhs is False) and condition.rhs is not None:
1315.             require_outer = True
1316.             if (lookup_type != 'isnull' and (
1317.                     self.is_nullable(targets[0]) or
1318.                     self.alias_map[join_list[-1]].join_type == LOUTER)):
1319.                 # The condition added here will be SQL like this:
1320.                 # NOT (col IS NOT NULL), where the first NOT is added in
1321.                 # upper layers of code. The reason for addition is that if col
1322.                 # is null, then col != someval will result in SQL "unknown"
1323.                 # which isn't the same as in Python. The Python None handling
1324.                 # is wanted, and it can be gotten by
1325.                 # (col IS NULL OR col != someval)
1326.                 #   <=>
1327.                 # NOT (col IS NOT NULL AND col = someval).
1328.                 lookup_class = targets[0].get_lookup('isnull')
1329.                 col = _get_col(targets[0], join_info.targets[0], alias, simple_col)
1330.                 clause.add(lookup_class(col, False), AND)
1331.         return clause, used_joins if not require_outer else ()
1332. 
1333.     def add_filter(self, filter_clause):
1334.         self.add_q(Q(**{filter_clause[0]: filter_clause[1]}))
1335. 
1336.     def add_q(self, q_object):
1337.         """
1338.         A preprocessor for the internal _add_q(). Responsible for doing final
1339.         join promotion.
1340.         """
1341.         # For join promotion this case is doing an AND for the added q_object
1342.         # and existing conditions. So, any existing inner join forces the join
1343.         # type to remain inner. Existing outer joins can however be demoted.
1344.         # (Consider case where rel_a is LOUTER and rel_a__col=1 is added - if
1345.         # rel_a doesn't produce any rows, then the whole condition must fail.
1346.         # So, demotion is OK.
1347.         existing_inner = {a for a in self.alias_map if self.alias_map[a].join_type == INNER}
1348.         clause, _ = self._add_q(q_object, self.used_aliases)
1349.         if clause:
1350.             self.where.add(clause, AND)
1351.         self.demote_joins(existing_inner)
1352. 
1353.     def build_where(self, q_object):
1354.         return self._add_q(q_object, used_aliases=set(), allow_joins=False, simple_col=True)[0]
1355. 
1356.     def _add_q(self, q_object, used_aliases, branch_negated=False,
1357.                current_negated=False, allow_joins=True, split_subq=True,
1358.                simple_col=False):
1359.         """Add a Q-object to the current filter."""
1360.         connector = q_object.connector
1361.         current_negated = current_negated ^ q_object.negated
1362.         branch_negated = branch_negated or q_object.negated
1363.         target_clause = self.where_class(connector=connector,
1364.                                          negated=q_object.negated)
1365.         joinpromoter = JoinPromoter(q_object.connector, len(q_object.children), current_negated)
1366.         for child in q_object.children:
1367.             if isinstance(child, Node):
1368.                 child_clause, needed_inner = self._add_q(
1369.                     child, used_aliases, branch_negated,
1370.                     current_negated, allow_joins, split_subq, simple_col)
1371.                 joinpromoter.add_votes(needed_inner)
1372.             else:
1373.                 child_clause, needed_inner = self.build_filter(
1374.                     child, can_reuse=used_aliases, branch_negated=branch_negated,
1375.                     current_negated=current_negated, allow_joins=allow_joins,
1376.                     split_subq=split_subq, simple_col=simple_col,
1377.                 )
1378.                 joinpromoter.add_votes(needed_inner)
1379.             if child_clause:
1380.                 target_clause.add(child_clause, connector)
1381.         needed_inner = joinpromoter.update_join_types(self)
1382.         return target_clause, needed_inner
1383. 
1384.     def build_filtered_relation_q(self, q_object, reuse, branch_negated=False, current_negated=False):
1385.         """Add a FilteredRelation object to the current filter."""
1386.         connector = q_object.connector
1387.         current_negated ^= q_object.negated
1388.         branch_negated = branch_negated or q_object.negated
1389.         target_clause = self.where_class(connector=connector, negated=q_object.negated)
1390.         for child in q_object.children:
1391.             if isinstance(child, Node):
1392.                 child_clause = self.build_filtered_relation_q(
1393.                     child, reuse=reuse, branch_negated=branch_negated,
1394.                     current_negated=current_negated,
1395.                 )
1396.             else:
1397.                 child_clause, _ = self.build_filter(
1398.                     child, can_reuse=reuse, branch_negated=branch_negated,
1399.                     current_negated=current_negated,
1400.                     allow_joins=True, split_subq=False,
1401.                     reuse_with_filtered_relation=True,
1402.                 )
1403.             target_clause.add(child_clause, connector)
1404.         return target_clause
1405. 
1406.     def add_filtered_relation(self, filtered_relation, alias):
1407.         filtered_relation.alias = alias
1408.         lookups = dict(get_children_from_q(filtered_relation.condition))
1409.         for lookup in chain((filtered_relation.relation_name,), lookups):
1410.             lookup_parts, field_parts, _ = self.solve_lookup_type(lookup)
1411.             shift = 2 if not lookup_parts else 1
1412.             if len(field_parts) > (shift + len(lookup_parts)):
1413.                 raise ValueError(
1414.                     "FilteredRelation's condition doesn't support nested "
1415.                     "relations (got %r)." % lookup
1416.                 )
1417.         self._filtered_relations[filtered_relation.alias] = filtered_relation
1418. 
1419.     def names_to_path(self, names, opts, allow_many=True, fail_on_missing=False):
1420.         """
1421.         Walk the list of names and turns them into PathInfo tuples. A single
1422.         name in 'names' can generate multiple PathInfos (m2m, for example).
1423. 
1424.         'names' is the path of names to travel, 'opts' is the model Options we
1425.         start the name resolving from, 'allow_many' is as for setup_joins().
1426.         If fail_on_missing is set to True, then a name that can't be resolved
1427.         will generate a FieldError.
1428. 
1429.         Return a list of PathInfo tuples. In addition return the final field
1430.         (the last used join field) and target (which is a field guaranteed to
1431.         contain the same value as the final field). Finally, return those names
1432.         that weren't found (which are likely transforms and the final lookup).
1433.         """
1434.         path, names_with_path = [], []
1435.         for pos, name in enumerate(names):
1436.             cur_names_with_path = (name, [])
1437.             if name == 'pk':
1438.                 name = opts.pk.name
1439. 
1440.             field = None
1441.             filtered_relation = None
1442.             try:
1443.                 field = opts.get_field(name)
1444.             except FieldDoesNotExist:
1445.                 if name in self.annotation_select:
1446.                     field = self.annotation_select[name].output_field
1447.                 elif name in self._filtered_relations and pos == 0:
1448.                     filtered_relation = self._filtered_relations[name]
1449.                     field = opts.get_field(filtered_relation.relation_name)
1450.             if field is not None:
1451.                 # Fields that contain one-to-many relations with a generic
1452.                 # model (like a GenericForeignKey) cannot generate reverse
1453.                 # relations and therefore cannot be used for reverse querying.
1454.                 if field.is_relation and not field.related_model:
1455.                     raise FieldError(
1456.                         "Field %r does not generate an automatic reverse "
1457.                         "relation and therefore cannot be used for reverse "
1458.                         "querying. If it is a GenericForeignKey, consider "
1459.                         "adding a GenericRelation." % name
1460.                     )
1461.                 try:
1462.                     model = field.model._meta.concrete_model
1463.                 except AttributeError:
1464.                     # QuerySet.annotate() may introduce fields that aren't
1465.                     # attached to a model.
1466.                     model = None
1467.             else:
1468.                 # We didn't find the current field, so move position back
1469.                 # one step.
1470.                 pos -= 1
1471.                 if pos == -1 or fail_on_missing:
1472.                     available = sorted([
1473.                         *get_field_names_from_opts(opts),
1474.                         *self.annotation_select,
1475.                         *self._filtered_relations,
1476.                     ])
1477.                     raise FieldError("Cannot resolve keyword '%s' into field. "
1478.                                      "Choices are: %s" % (name, ", ".join(available)))
1479.                 break
1480.             # Check if we need any joins for concrete inheritance cases (the
1481.             # field lives in parent, but we are currently in one of its
1482.             # children)
1483.             if model is not opts.model:
1484.                 path_to_parent = opts.get_path_to_parent(model)
1485.                 if path_to_parent:
1486.                     path.extend(path_to_parent)
1487.                     cur_names_with_path[1].extend(path_to_parent)
1488.                     opts = path_to_parent[-1].to_opts
1489.             if hasattr(field, 'get_path_info'):
1490.                 pathinfos = field.get_path_info(filtered_relation)
1491.                 if not allow_many:
1492.                     for inner_pos, p in enumerate(pathinfos):
1493.                         if p.m2m:
1494.                             cur_names_with_path[1].extend(pathinfos[0:inner_pos + 1])
1495.                             names_with_path.append(cur_names_with_path)
1496.                             raise MultiJoin(pos + 1, names_with_path)
1497.                 last = pathinfos[-1]
1498.                 path.extend(pathinfos)
1499.                 final_field = last.join_field
1500.                 opts = last.to_opts
1501.                 targets = last.target_fields
1502.                 cur_names_with_path[1].extend(pathinfos)
1503.                 names_with_path.append(cur_names_with_path)
1504.             else:
1505.                 # Local non-relational field.
1506.                 final_field = field
1507.                 targets = (field,)
1508.                 if fail_on_missing and pos + 1 != len(names):
1509.                     raise FieldError(
1510.                         "Cannot resolve keyword %r into field. Join on '%s'"
1511.                         " not permitted." % (names[pos + 1], name))
1512.                 break
1513.         return path, final_field, targets, names[pos + 1:]
1514. 
1515.     def setup_joins(self, names, opts, alias, can_reuse=None, allow_many=True,
1516.                     reuse_with_filtered_relation=False):
1517.         """
1518.         Compute the necessary table joins for the passage through the fields
1519.         given in 'names'. 'opts' is the Options class for the current model
1520.         (which gives the table we are starting from), 'alias' is the alias for
1521.         the table to start the joining from.
1522. 
1523.         The 'can_reuse' defines the reverse foreign key joins we can reuse. It
1524.         can be None in which case all joins are reusable or a set of aliases
1525.         that can be reused. Note that non-reverse foreign keys are always
1526.         reusable when using setup_joins().
1527. 
1528.         The 'reuse_with_filtered_relation' can be used to force 'can_reuse'
1529.         parameter and force the relation on the given connections.
1530. 
1531.         If 'allow_many' is False, then any reverse foreign key seen will
1532.         generate a MultiJoin exception.
1533. 
1534.         Return the final field involved in the joins, the target field (used
1535.         for any 'where' constraint), the final 'opts' value, the joins, the
1536.         field path traveled to generate the joins, and a transform function
1537.         that takes a field and alias and is equivalent to `field.get_col(alias)`
1538.         in the simple case but wraps field transforms if they were included in
1539.         names.
1540. 
1541.         The target field is the field containing the concrete value. Final
1542.         field can be something different, for example foreign key pointing to
1543.         that value. Final field is needed for example in some value
1544.         conversions (convert 'obj' in fk__id=obj to pk val using the foreign
1545.         key field for example).
1546.         """
1547.         joins = [alias]
1548.         # The transform can't be applied yet, as joins must be trimmed later.
1549.         # To avoid making every caller of this method look up transforms
1550.         # directly, compute transforms here and create a partial that converts
1551.         # fields to the appropriate wrapped version.
1552. 
1553.         def final_transformer(field, alias):
1554.             return field.get_col(alias)
1555. 
1556.         # Try resolving all the names as fields first. If there's an error,
1557.         # treat trailing names as lookups until a field can be resolved.
1558.         last_field_exception = None
1559.         for pivot in range(len(names), 0, -1):
1560.             try:
1561.                 path, final_field, targets, rest = self.names_to_path(
1562.                     names[:pivot], opts, allow_many, fail_on_missing=True,
1563.                 )
1564.             except FieldError as exc:
1565.                 if pivot == 1:
1566.                     # The first item cannot be a lookup, so it's safe
1567.                     # to raise the field error here.
1568.                     raise
1569.                 else:
1570.                     last_field_exception = exc
1571.             else:
1572.                 # The transforms are the remaining items that couldn't be
1573.                 # resolved into fields.
1574.                 transforms = names[pivot:]
1575.                 break
1576.         for name in transforms:
1577.             def transform(field, alias, *, name, previous):
1578.                 try:
1579.                     wrapped = previous(field, alias)
1580.                     return self.try_transform(wrapped, name)
1581.                 except FieldError:
1582.                     # FieldError is raised if the transform doesn't exist.
1583.                     if isinstance(final_field, Field) and last_field_exception:
1584.                         raise last_field_exception
1585.                     else:
1586.                         raise
1587.             final_transformer = functools.partial(transform, name=name, previous=final_transformer)
1588.         # Then, add the path to the query's joins. Note that we can't trim
1589.         # joins at this stage - we will need the information about join type
1590.         # of the trimmed joins.
1591.         for join in path:
1592.             if join.filtered_relation:
1593.                 filtered_relation = join.filtered_relation.clone()
1594.                 table_alias = filtered_relation.alias
1595.             else:
1596.                 filtered_relation = None
1597.                 table_alias = None
1598.             opts = join.to_opts
1599.             if join.direct:
1600.                 nullable = self.is_nullable(join.join_field)
1601.             else:
1602.                 nullable = True
1603.             connection = Join(
1604.                 opts.db_table, alias, table_alias, INNER, join.join_field,
1605.                 nullable, filtered_relation=filtered_relation,
1606.             )
1607.             reuse = can_reuse if join.m2m or reuse_with_filtered_relation else None
1608.             alias = self.join(
1609.                 connection, reuse=reuse,
1610.                 reuse_with_filtered_relation=reuse_with_filtered_relation,
1611.             )
1612.             joins.append(alias)
1613.             if filtered_relation:
1614.                 filtered_relation.path = joins[:]
1615.         return JoinInfo(final_field, targets, opts, joins, path, final_transformer)
1616. 
1617.     def trim_joins(self, targets, joins, path):
1618.         """
1619.         The 'target' parameter is the final field being joined to, 'joins'
1620.         is the full list of join aliases. The 'path' contain the PathInfos
1621.         used to create the joins.
1622. 
1623.         Return the final target field and table alias and the new active
1624.         joins.
1625. 
1626.         Always trim any direct join if the target column is already in the
1627.         previous table. Can't trim reverse joins as it's unknown if there's
1628.         anything on the other side of the join.
1629.         """
1630.         joins = joins[:]
1631.         for pos, info in enumerate(reversed(path)):
1632.             if len(joins) == 1 or not info.direct:
1633.                 break
1634.             if info.filtered_relation:
1635.                 break
1636.             join_targets = {t.column for t in info.join_field.foreign_related_fields}
1637.             cur_targets = {t.column for t in targets}
1638.             if not cur_targets.issubset(join_targets):
1639.                 break
1640.             targets_dict = {r[1].column: r[0] for r in info.join_field.related_fields if r[1].column in cur_targets}
1641.             targets = tuple(targets_dict[t.column] for t in targets)
1642.             self.unref_alias(joins.pop())
1643.         return targets, joins[-1], joins
1644. 
1645.     @classmethod
1646.     def _gen_col_aliases(cls, exprs):
1647.         for expr in exprs:
1648.             if isinstance(expr, Col):
1649.                 yield expr.alias
1650.             else:
1651.                 yield from cls._gen_col_aliases(expr.get_source_expressions())
1652. 
1653.     def resolve_ref(self, name, allow_joins=True, reuse=None, summarize=False, simple_col=False):
1654.         if not allow_joins and LOOKUP_SEP in name:
1655.             raise FieldError("Joined field references are not permitted in this query")
1656.         annotation = self.annotations.get(name)
1657.         if annotation is not None:
1658.             if not allow_joins:
1659.                 for alias in self._gen_col_aliases([annotation]):
1660.                     if isinstance(self.alias_map[alias], Join):
1661.                         raise FieldError(
1662.                             'Joined field references are not permitted in '
1663.                             'this query'
1664.                         )
1665.             if summarize:
1666.                 # Summarize currently means we are doing an aggregate() query
1667.                 # which is executed as a wrapped subquery if any of the
1668.                 # aggregate() elements reference an existing annotation. In
1669.                 # that case we need to return a Ref to the subquery's annotation.
1670.                 return Ref(name, self.annotation_select[name])
1671.             else:
1672.                 return annotation
1673.         else:
1674.             field_list = name.split(LOOKUP_SEP)
1675.             join_info = self.setup_joins(field_list, self.get_meta(), self.get_initial_alias(), can_reuse=reuse)
1676.             targets, final_alias, join_list = self.trim_joins(join_info.targets, join_info.joins, join_info.path)
1677.             if not allow_joins and len(join_list) > 1:
1678.                 raise FieldError('Joined field references are not permitted in this query')
1679.             if len(targets) > 1:
1680.                 raise FieldError("Referencing multicolumn fields with F() objects "
1681.                                  "isn't supported")
1682.             # Verify that the last lookup in name is a field or a transform:
1683.             # transform_function() raises FieldError if not.
1684.             join_info.transform_function(targets[0], final_alias)
1685.             if reuse is not None:
1686.                 reuse.update(join_list)
1687.             col = _get_col(targets[0], join_info.targets[0], join_list[-1], simple_col)
1688.             return col
1689. 
1690.     def split_exclude(self, filter_expr, can_reuse, names_with_path):
1691.         """
1692.         When doing an exclude against any kind of N-to-many relation, we need
1693.         to use a subquery. This method constructs the nested query, given the
1694.         original exclude filter (filter_expr) and the portion up to the first
1695.         N-to-many relation field.
1696. 
1697.         For example, if the origin filter is ~Q(child__name='foo'), filter_expr
1698.         is ('child__name', 'foo') and can_reuse is a set of joins usable for
1699.         filters in the original query.
1700. 
1701.         We will turn this into equivalent of:
1702.             WHERE NOT (pk IN (SELECT parent_id FROM thetable
1703.                               WHERE name = 'foo' AND parent_id IS NOT NULL))
1704. 
1705.         It might be worth it to consider using WHERE NOT EXISTS as that has
1706.         saner null handling, and is easier for the backend's optimizer to
1707.         handle.
1708.         """
1709.         filter_lhs, filter_rhs = filter_expr
1710.         if isinstance(filter_rhs, OuterRef):
1711.             filter_expr = (filter_lhs, OuterRef(filter_rhs))
1712.         elif isinstance(filter_rhs, F):
1713.             filter_expr = (filter_lhs, OuterRef(filter_rhs.name))
1714.         # Generate the inner query.
1715.         query = Query(self.model)
1716.         query._filtered_relations = self._filtered_relations
1717.         query.add_filter(filter_expr)
1718.         query.clear_ordering(True)
1719.         # Try to have as simple as possible subquery -> trim leading joins from
1720.         # the subquery.
1721.         trimmed_prefix, contains_louter = query.trim_start(names_with_path)
1722. 
1723.         # Add extra check to make sure the selected field will not be null
1724.         # since we are adding an IN <subquery> clause. This prevents the
1725.         # database from tripping over IN (...,NULL,...) selects and returning
1726.         # nothing
1727.         col = query.select[0]
1728.         select_field = col.target
1729.         alias = col.alias
1730.         if self.is_nullable(select_field):
1731.             lookup_class = select_field.get_lookup('isnull')
1732.             lookup = lookup_class(select_field.get_col(alias), False)
1733.             query.where.add(lookup, AND)
1734.         if alias in can_reuse:
1735.             pk = select_field.model._meta.pk
1736.             # Need to add a restriction so that outer query's filters are in effect for
1737.             # the subquery, too.
1738.             query.bump_prefix(self)
1739.             lookup_class = select_field.get_lookup('exact')
1740.             # Note that the query.select[0].alias is different from alias
1741.             # due to bump_prefix above.
1742.             lookup = lookup_class(pk.get_col(query.select[0].alias),
1743.                                   pk.get_col(alias))
1744.             query.where.add(lookup, AND)
1745.             query.external_aliases.add(alias)
1746. 
1747.         condition, needed_inner = self.build_filter(
1748.             ('%s__in' % trimmed_prefix, query),
1749.             current_negated=True, branch_negated=True, can_reuse=can_reuse)
1750.         if contains_louter:
1751.             or_null_condition, _ = self.build_filter(
1752.                 ('%s__isnull' % trimmed_prefix, True),
1753.                 current_negated=True, branch_negated=True, can_reuse=can_reuse)
1754.             condition.add(or_null_condition, OR)
1755.             # Note that the end result will be:
1756.             # (outercol NOT IN innerq AND outercol IS NOT NULL) OR outercol IS NULL.
1757.             # This might look crazy but due to how IN works, this seems to be
1758.             # correct. If the IS NOT NULL check is removed then outercol NOT
1759.             # IN will return UNKNOWN. If the IS NULL check is removed, then if
1760.             # outercol IS NULL we will not match the row.
1761.         return condition, needed_inner
1762. 
1763.     def set_empty(self):
1764.         self.where.add(NothingNode(), AND)
1765. 
1766.     def is_empty(self):
1767.         return any(isinstance(c, NothingNode) for c in self.where.children)
1768. 
1769.     def set_limits(self, low=None, high=None):
1770.         """
1771.         Adjust the limits on the rows retrieved. Use low/high to set these,
1772.         as it makes it more Pythonic to read and write. When the SQL query is
1773.         created, convert them to the appropriate offset and limit values.
1774. 
1775.         Apply any limits passed in here to the existing constraints. Add low
1776.         to the current low value and clamp both to any existing high value.
1777.         """
1778.         if high is not None:
1779.             if self.high_mark is not None:
1780.                 self.high_mark = min(self.high_mark, self.low_mark + high)
1781.             else:
1782.                 self.high_mark = self.low_mark + high
1783.         if low is not None:
1784.             if self.high_mark is not None:
1785.                 self.low_mark = min(self.high_mark, self.low_mark + low)
1786.             else:
1787.                 self.low_mark = self.low_mark + low
1788. 
1789.         if self.low_mark == self.high_mark:
1790.             self.set_empty()
1791. 
1792.     def clear_limits(self):
1793.         """Clear any existing limits."""
1794.         self.low_mark, self.high_mark = 0, None
1795. 
1796.     @property
1797.     def is_sliced(self):
1798.         return self.low_mark != 0 or self.high_mark is not None
1799. 
1800.     def has_limit_one(self):
1801.         return self.high_mark is not None and (self.high_mark - self.low_mark) == 1
1802. 
1803.     def can_filter(self):
1804.         """
1805.         Return True if adding filters to this instance is still possible.
1806. 
1807.         Typically, this means no limits or offsets have been put on the results.
1808.         """
1809.         return not self.is_sliced
1810. 
1811.     def clear_select_clause(self):
1812.         """Remove all fields from SELECT clause."""
1813.         self.select = ()
1814.         self.default_cols = False
1815.         self.select_related = False
1816.         self.set_extra_mask(())
1817.         self.set_annotation_mask(())
1818. 
1819.     def clear_select_fields(self):
1820.         """
1821.         Clear the list of fields to select (but not extra_select columns).
1822.         Some queryset types completely replace any existing list of select
1823.         columns.
1824.         """
1825.         self.select = ()
1826.         self.values_select = ()
1827. 
1828.     def add_select_col(self, col):
1829.         self.select += col,
1830.         self.values_select += col.output_field.name,
1831. 
1832.     def set_select(self, cols):
1833.         self.default_cols = False
1834.         self.select = tuple(cols)
1835. 
1836.     def add_distinct_fields(self, *field_names):
1837.         """
1838.         Add and resolve the given fields to the query's "distinct on" clause.
1839.         """
1840.         self.distinct_fields = field_names
1841.         self.distinct = True
1842. 
1843.     def add_fields(self, field_names, allow_m2m=True):
1844.         """
1845.         Add the given (model) fields to the select set. Add the field names in
1846.         the order specified.
1847.         """
1848.         alias = self.get_initial_alias()
1849.         opts = self.get_meta()
1850. 
1851.         try:
1852.             cols = []
1853.             for name in field_names:
1854.                 # Join promotion note - we must not remove any rows here, so
1855.                 # if there is no existing joins, use outer join.
1856.                 join_info = self.setup_joins(name.split(LOOKUP_SEP), opts, alias, allow_many=allow_m2m)
1857.                 targets, final_alias, joins = self.trim_joins(
1858.                     join_info.targets,
1859.                     join_info.joins,
1860.                     join_info.path,
1861.                 )
1862.                 for target in targets:
1863.                     cols.append(join_info.transform_function(target, final_alias))
1864.             if cols:
1865.                 self.set_select(cols)
1866.         except MultiJoin:
1867.             raise FieldError("Invalid field name: '%s'" % name)
1868.         except FieldError:
1869.             if LOOKUP_SEP in name:
1870.                 # For lookups spanning over relationships, show the error
1871.                 # from the model on which the lookup failed.
1872.                 raise
1873.             else:
1874.                 names = sorted([
1875.                     *get_field_names_from_opts(opts), *self.extra,
1876.                     *self.annotation_select, *self._filtered_relations
1877.                 ])
1878.                 raise FieldError("Cannot resolve keyword %r into field. "
1879.                                  "Choices are: %s" % (name, ", ".join(names)))
1880. 
1881.     def add_ordering(self, *ordering):
1882.         """
1883.         Add items from the 'ordering' sequence to the query's "order by"
1884.         clause. These items are either field names (not column names) --
1885.         possibly with a direction prefix ('-' or '?') -- or OrderBy
1886.         expressions.
1887. 
1888.         If 'ordering' is empty, clear all ordering from the query.
1889.         """
1890.         errors = []
1891.         for item in ordering:
1892.             if not hasattr(item, 'resolve_expression') and not ORDER_PATTERN.match(item):
1893.                 errors.append(item)
1894.             if getattr(item, 'contains_aggregate', False):
1895.                 raise FieldError(
1896.                     'Using an aggregate in order_by() without also including '
1897.                     'it in annotate() is not allowed: %s' % item
1898.                 )
1899.         if errors:
1900.             raise FieldError('Invalid order_by arguments: %s' % errors)
1901.         if ordering:
1902.             self.order_by += ordering
1903.         else:
1904.             self.default_ordering = False
1905. 
1906.     def clear_ordering(self, force_empty):
1907.         """
1908.         Remove any ordering settings. If 'force_empty' is True, there will be
1909.         no ordering in the resulting query (not even the model's default).
1910.         """
1911.         self.order_by = ()
1912.         self.extra_order_by = ()
1913.         if force_empty:
1914.             self.default_ordering = False
1915. 
1916.     def set_group_by(self):
1917.         """
1918.         Expand the GROUP BY clause required by the query.
1919. 
1920.         This will usually be the set of all non-aggregate fields in the
1921.         return data. If the database backend supports grouping by the
1922.         primary key, and the query would be equivalent, the optimization
1923.         will be made automatically.
1924.         """
1925.         group_by = list(self.select)
1926.         if self.annotation_select:
1927.             for alias, annotation in self.annotation_select.items():
1928.                 try:
1929.                     inspect.getcallargs(annotation.get_group_by_cols, alias=alias)
1930.                 except TypeError:
1931.                     annotation_class = annotation.__class__
1932.                     msg = (
1933.                         '`alias=None` must be added to the signature of '
1934.                         '%s.%s.get_group_by_cols().'
1935.                     ) % (annotation_class.__module__, annotation_class.__qualname__)
1936.                     warnings.warn(msg, category=RemovedInDjango40Warning)
1937.                     group_by_cols = annotation.get_group_by_cols()
1938.                 else:
1939.                     group_by_cols = annotation.get_group_by_cols(alias=alias)
1940.                 group_by.extend(group_by_cols)
1941.         self.group_by = tuple(group_by)
1942. 
1943.     def add_select_related(self, fields):
1944.         """
1945.         Set up the select_related data structure so that we only select
1946.         certain related models (as opposed to all models, when
1947.         self.select_related=True).
1948.         """
1949.         if isinstance(self.select_related, bool):
1950.             field_dict = {}
1951.         else:
1952.             field_dict = self.select_related
1953.         for field in fields:
1954.             d = field_dict
1955.             for part in field.split(LOOKUP_SEP):
1956.                 d = d.setdefault(part, {})
1957.         self.select_related = field_dict
1958. 
1959.     def add_extra(self, select, select_params, where, params, tables, order_by):
1960.         """
1961.         Add data to the various extra_* attributes for user-created additions
1962.         to the query.
1963.         """
1964.         if select:
1965.             # We need to pair any placeholder markers in the 'select'
1966.             # dictionary with their parameters in 'select_params' so that
1967.             # subsequent updates to the select dictionary also adjust the
1968.             # parameters appropriately.
1969.             select_pairs = {}
1970.             if select_params:
1971.                 param_iter = iter(select_params)
1972.             else:
1973.                 param_iter = iter([])
1974.             for name, entry in select.items():
1975.                 entry = str(entry)
1976.                 entry_params = []
1977.                 pos = entry.find("%s")
1978.                 while pos != -1:
1979.                     if pos == 0 or entry[pos - 1] != '%':
1980.                         entry_params.append(next(param_iter))
1981.                     pos = entry.find("%s", pos + 2)
1982.                 select_pairs[name] = (entry, entry_params)
1983.             self.extra.update(select_pairs)
1984.         if where or params:
1985.             self.where.add(ExtraWhere(where, params), AND)
1986.         if tables:
1987.             self.extra_tables += tuple(tables)
1988.         if order_by:
1989.             self.extra_order_by = order_by
1990. 
1991.     def clear_deferred_loading(self):
1992.         """Remove any fields from the deferred loading set."""
1993.         self.deferred_loading = (frozenset(), True)
1994. 
1995.     def add_deferred_loading(self, field_names):
1996.         """
1997.         Add the given list of model field names to the set of fields to
1998.         exclude from loading from the database when automatic column selection
1999.         is done. Add the new field names to any existing field names that
2000.         are deferred (or removed from any existing field names that are marked
2001.         as the only ones for immediate loading).
2002.         """
2003.         # Fields on related models are stored in the literal double-underscore
2004.         # format, so that we can use a set datastructure. We do the foo__bar
2005.         # splitting and handling when computing the SQL column names (as part of
2006.         # get_columns()).
2007.         existing, defer = self.deferred_loading
2008.         if defer:
2009.             # Add to existing deferred names.
2010.             self.deferred_loading = existing.union(field_names), True
2011.         else:
2012.             # Remove names from the set of any existing "immediate load" names.
2013.             self.deferred_loading = existing.difference(field_names), False
2014. 
2015.     def add_immediate_loading(self, field_names):
2016.         """
2017.         Add the given list of model field names to the set of fields to
2018.         retrieve when the SQL is executed ("immediate loading" fields). The
2019.         field names replace any existing immediate loading field names. If
2020.         there are field names already specified for deferred loading, remove
2021.         those names from the new field_names before storing the new names
2022.         for immediate loading. (That is, immediate loading overrides any
2023.         existing immediate values, but respects existing deferrals.)
2024.         """
2025.         existing, defer = self.deferred_loading
2026.         field_names = set(field_names)
2027.         if 'pk' in field_names:
2028.             field_names.remove('pk')
2029.             field_names.add(self.get_meta().pk.name)
2030. 
2031.         if defer:
2032.             # Remove any existing deferred names from the current set before
2033.             # setting the new names.
2034.             self.deferred_loading = field_names.difference(existing), False
2035.         else:
2036.             # Replace any existing "immediate load" field names.
2037.             self.deferred_loading = frozenset(field_names), False
2038. 
2039.     def get_loaded_field_names(self):
2040.         """
2041.         If any fields are marked to be deferred, return a dictionary mapping
2042.         models to a set of names in those fields that will be loaded. If a
2043.         model is not in the returned dictionary, none of its fields are
2044.         deferred.
2045. 
2046.         If no fields are marked for deferral, return an empty dictionary.
2047.         """
2048.         # We cache this because we call this function multiple times
2049.         # (compiler.fill_related_selections, query.iterator)
2050.         try:
2051.             return self._loaded_field_names_cache
2052.         except AttributeError:
2053.             collection = {}
2054.             self.deferred_to_data(collection, self.get_loaded_field_names_cb)
2055.             self._loaded_field_names_cache = collection
2056.             return collection
2057. 
2058.     def get_loaded_field_names_cb(self, target, model, fields):
2059.         """Callback used by get_deferred_field_names()."""
2060.         target[model] = {f.attname for f in fields}
2061. 
2062.     def set_annotation_mask(self, names):
2063.         """Set the mask of annotations that will be returned by the SELECT."""
2064.         if names is None:
2065.             self.annotation_select_mask = None
2066.         else:
2067.             self.annotation_select_mask = set(names)
2068.         self._annotation_select_cache = None
2069. 
2070.     def append_annotation_mask(self, names):
2071.         if self.annotation_select_mask is not None:
2072.             self.set_annotation_mask(self.annotation_select_mask.union(names))
2073. 
2074.     def set_extra_mask(self, names):
2075.         """
2076.         Set the mask of extra select items that will be returned by SELECT.
2077.         Don't remove them from the Query since they might be used later.
2078.         """
2079.         if names is None:
2080.             self.extra_select_mask = None
2081.         else:
2082.             self.extra_select_mask = set(names)
2083.         self._extra_select_cache = None
2084. 
2085.     def set_values(self, fields):
2086.         self.select_related = False
2087.         self.clear_deferred_loading()
2088.         self.clear_select_fields()
2089. 
2090.         if self.group_by is True:
2091.             self.add_fields((f.attname for f in self.model._meta.concrete_fields), False)
2092.             self.set_group_by()
2093.             self.clear_select_fields()
2094. 
2095.         if fields:
2096.             field_names = []
2097.             extra_names = []
2098.             annotation_names = []
2099.             if not self.extra and not self.annotations:
2100.                 # Shortcut - if there are no extra or annotations, then
2101.                 # the values() clause must be just field names.
2102.                 field_names = list(fields)
2103.             else:
2104.                 self.default_cols = False
2105.                 for f in fields:
2106.                     if f in self.extra_select:
2107.                         extra_names.append(f)
2108.                     elif f in self.annotation_select:
2109.                         annotation_names.append(f)
2110.                     else:
2111.                         field_names.append(f)
2112.             self.set_extra_mask(extra_names)
2113.             self.set_annotation_mask(annotation_names)
2114.         else:
2115.             field_names = [f.attname for f in self.model._meta.concrete_fields]
2116. 
2117.         self.values_select = tuple(field_names)
2118.         self.add_fields(field_names, True)
2119. 
2120.     @property
2121.     def annotation_select(self):
2122.         """
2123.         Return the dictionary of aggregate columns that are not masked and
2124.         should be used in the SELECT clause. Cache this result for performance.
2125.         """
2126.         if self._annotation_select_cache is not None:
2127.             return self._annotation_select_cache
2128.         elif not self.annotations:
2129.             return {}
2130.         elif self.annotation_select_mask is not None:
2131.             self._annotation_select_cache = {
2132.                 k: v for k, v in self.annotations.items()
2133.                 if k in self.annotation_select_mask
2134.             }
2135.             return self._annotation_select_cache
2136.         else:
2137.             return self.annotations
2138. 
2139.     @property
2140.     def extra_select(self):
2141.         if self._extra_select_cache is not None:
2142.             return self._extra_select_cache
2143.         if not self.extra:
2144.             return {}
2145.         elif self.extra_select_mask is not None:
2146.             self._extra_select_cache = {
2147.                 k: v for k, v in self.extra.items()
2148.                 if k in self.extra_select_mask
2149.             }
2150.             return self._extra_select_cache
2151.         else:
2152.             return self.extra
2153. 
2154.     def trim_start(self, names_with_path):
2155.         """
2156.         Trim joins from the start of the join path. The candidates for trim
2157.         are the PathInfos in names_with_path structure that are m2m joins.
2158. 
2159.         Also set the select column so the start matches the join.
2160. 
2161.         This method is meant to be used for generating the subquery joins &
2162.         cols in split_exclude().
2163. 
2164.         Return a lookup usable for doing outerq.filter(lookup=self) and a
2165.         boolean indicating if the joins in the prefix contain a LEFT OUTER join.
2166.         _"""
2167.         all_paths = []
2168.         for _, paths in names_with_path:
2169.             all_paths.extend(paths)
2170.         contains_louter = False
2171.         # Trim and operate only on tables that were generated for
2172.         # the lookup part of the query. That is, avoid trimming
2173.         # joins generated for F() expressions.
2174.         lookup_tables = [
2175.             t for t in self.alias_map
2176.             if t in self._lookup_joins or t == self.base_table
2177.         ]
2178.         for trimmed_paths, path in enumerate(all_paths):
2179.             if path.m2m:
2180.                 break
2181.             if self.alias_map[lookup_tables[trimmed_paths + 1]].join_type == LOUTER:
2182.                 contains_louter = True
2183.             alias = lookup_tables[trimmed_paths]
2184.             self.unref_alias(alias)
2185.         # The path.join_field is a Rel, lets get the other side's field
2186.         join_field = path.join_field.field
2187.         # Build the filter prefix.
2188.         paths_in_prefix = trimmed_paths
2189.         trimmed_prefix = []
2190.         for name, path in names_with_path:
2191.             if paths_in_prefix - len(path) < 0:
2192.                 break
2193.             trimmed_prefix.append(name)
2194.             paths_in_prefix -= len(path)
2195.         trimmed_prefix.append(
2196.             join_field.foreign_related_fields[0].name)
2197.         trimmed_prefix = LOOKUP_SEP.join(trimmed_prefix)
2198.         # Lets still see if we can trim the first join from the inner query
2199.         # (that is, self). We can't do this for:
2200.         # - LEFT JOINs because we would miss those rows that have nothing on
2201.         #   the outer side,
2202.         # - INNER JOINs from filtered relations because we would miss their
2203.         #   filters.
2204.         first_join = self.alias_map[lookup_tables[trimmed_paths + 1]]
2205.         if first_join.join_type != LOUTER and not first_join.filtered_relation:
2206.             select_fields = [r[0] for r in join_field.related_fields]
2207.             select_alias = lookup_tables[trimmed_paths + 1]
2208.             self.unref_alias(lookup_tables[trimmed_paths])
2209.             extra_restriction = join_field.get_extra_restriction(
2210.                 self.where_class, None, lookup_tables[trimmed_paths + 1])
2211.             if extra_restriction:
2212.                 self.where.add(extra_restriction, AND)
2213.         else:
2214.             # TODO: It might be possible to trim more joins from the start of the
2215.             # inner query if it happens to have a longer join chain containing the
2216.             # values in select_fields. Lets punt this one for now.
2217.             select_fields = [r[1] for r in join_field.related_fields]
2218.             select_alias = lookup_tables[trimmed_paths]
2219.         # The found starting point is likely a Join instead of a BaseTable reference.
2220.         # But the first entry in the query's FROM clause must not be a JOIN.
2221.         for table in self.alias_map:
2222.             if self.alias_refcount[table] > 0:
2223.                 self.alias_map[table] = BaseTable(self.alias_map[table].table_name, table)
2224.                 break
2225.         self.set_select([f.get_col(select_alias) for f in select_fields])
2226.         return trimmed_prefix, contains_louter
2227. 
2228.     def is_nullable(self, field):
2229.         """
2230.         Check if the given field should be treated as nullable.
2231. 
2232.         Some backends treat '' as null and Django treats such fields as
2233.         nullable for those backends. In such situations field.null can be
2234.         False even if we should treat the field as nullable.
2235.         """
2236.         # We need to use DEFAULT_DB_ALIAS here, as QuerySet does not have
2237.         # (nor should it have) knowledge of which connection is going to be
2238.         # used. The proper fix would be to defer all decisions where
2239.         # is_nullable() is needed to the compiler stage, but that is not easy
2240.         # to do currently.
2241.         return (
2242.             connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls and
2243.             field.empty_strings_allowed
2244.         ) or field.null
2245. 


File: django/db/models/sql/query.py
Line number range: 2280 - 2362
Content:
2280. class JoinPromoter:
2281.     """
2282.     A class to abstract away join promotion problems for complex filter
2283.     conditions.
2284.     """
2285. 
2286.     def __init__(self, connector, num_children, negated):
2287.         self.connector = connector
2288.         self.negated = negated
2289.         if self.negated:
2290.             if connector == AND:
2291.                 self.effective_connector = OR
2292.             else:
2293.                 self.effective_connector = AND
2294.         else:
2295.             self.effective_connector = self.connector
2296.         self.num_children = num_children
2297.         # Maps of table alias to how many times it is seen as required for
2298.         # inner and/or outer joins.
2299.         self.votes = Counter()
2300. 
2301.     def add_votes(self, votes):
2302.         """
2303.         Add single vote per item to self.votes. Parameter can be any
2304.         iterable.
2305.         """
2306.         self.votes.update(votes)
2307. 
2308.     def update_join_types(self, query):
2309.         """
2310.         Change join types so that the generated query is as efficient as
2311.         possible, but still correct. So, change as many joins as possible
2312.         to INNER, but don't make OUTER joins INNER if that could remove
2313.         results from the query.
2314.         """
2315.         to_promote = set()
2316.         to_demote = set()
2317.         # The effective_connector is used so that NOT (a AND b) is treated
2318.         # similarly to (a OR b) for join promotion.
2319.         for table, votes in self.votes.items():
2320.             # We must use outer joins in OR case when the join isn't contained
2321.             # in all of the joins. Otherwise the INNER JOIN itself could remove
2322.             # valid results. Consider the case where a model with rel_a and
2323.             # rel_b relations is queried with rel_a__col=1 | rel_b__col=2. Now,
2324.             # if rel_a join doesn't produce any results is null (for example
2325.             # reverse foreign key or null value in direct foreign key), and
2326.             # there is a matching row in rel_b with col=2, then an INNER join
2327.             # to rel_a would remove a valid match from the query. So, we need
2328.             # to promote any existing INNER to LOUTER (it is possible this
2329.             # promotion in turn will be demoted later on).
2330.             if self.effective_connector == 'OR' and votes < self.num_children:
2331.                 to_promote.add(table)
2332.             # If connector is AND and there is a filter that can match only
2333.             # when there is a joinable row, then use INNER. For example, in
2334.             # rel_a__col=1 & rel_b__col=2, if either of the rels produce NULL
2335.             # as join output, then the col=1 or col=2 can't match (as
2336.             # NULL=anything is always false).
2337.             # For the OR case, if all children voted for a join to be inner,
2338.             # then we can use INNER for the join. For example:
2339.             #     (rel_a__col__icontains=Alex | rel_a__col__icontains=Russell)
2340.             # then if rel_a doesn't produce any rows, the whole condition
2341.             # can't match. Hence we can safely use INNER join.
2342.             if self.effective_connector == 'AND' or (
2343.                     self.effective_connector == 'OR' and votes == self.num_children):
2344.                 to_demote.add(table)
2345.             # Finally, what happens in cases where we have:
2346.             #    (rel_a__col=1|rel_b__col=2) & rel_a__col__gte=0
2347.             # Now, we first generate the OR clause, and promote joins for it
2348.             # in the first if branch above. Both rel_a and rel_b are promoted
2349.             # to LOUTER joins. After that we do the AND case. The OR case
2350.             # voted no inner joins but the rel_a__col__gte=0 votes inner join
2351.             # for rel_a. We demote it back to INNER join (in AND case a single
2352.             # vote is enough). The demotion is OK, if rel_a doesn't produce
2353.             # rows, then the rel_a__col__gte=0 clause can't be true, and thus
2354.             # the whole clause must be false. So, it is safe to use INNER
2355.             # join.
2356.             # Note that in this example we could just as well have the __gte
2357.             # clause and the OR clause swapped. Or we could replace the __gte
2358.             # clause with an OR clause containing rel_a__col=1|rel_a__col=2,
2359.             # and again we could safely demote to INNER.
2360.         query.promote_joins(to_promote)
2361.         query.demote_joins(to_demote)
2362.         return to_demote

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:09:25,335 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's patch modifies `Query.resolve_lookup_value` to prevent the coercion of a list to a tuple. This method prepares the right-hand side value for a filter, which is then passed to a `Lookup` object. To understand why this type coercion is problematic, I need to examine how `Lookup` objects process this value. The `Lookup` classes are defined in `django/db/models/lookups.py`." query='Please provide the full content of django/db/models/lookups.py.' extra_requirements='' purpose="This file will explain how the value from `resolve_lookup_value` is used and why its type is important for certain lookups like 'exact'exact'."
2025-12-21 08:09:25,336 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of django/db/models/lookups.py.
2025-12-21 08:09:25,336 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:09:25,337 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:09:25,337 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:09:25,337 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of django/db/models/lookups.py.
Purpose: This file will explain how the value from `resolve_lookup_value` is used and why its type is important for certain lookups like 'exact'exact'.
2025-12-21 08:09:28,200 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I will read the full content of the file `django/db/models/lookups.py` to understand how the value from `resolve_lookup_value` is used. This will help clarify the importance of the value's type for specific lookups." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/lookups.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2106, 'candidates_token_count': 78, 'total_token_count': 2307, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2106}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 123, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10472402817163712, 'model_name': 'gemini-2.5-pro'} id='run--c9a8ff03-92da-4186-9824-624b1ff5d391-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/lookups.py'}, 'id': '7810ccc0-d759-403c-86dd-04029613d9f4', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2106, 'output_tokens': 78, 'total_tokens': 2307, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 123}}
2025-12-21 08:09:30,989 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the first 500 lines of `django/db/models/lookups.py`, but the file is longer. I will now fetch the remaining content to provide the complete file for your analysis.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 501.0, "end_line": 1000.0, "relative_path": "django/db/models/lookups.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9524, 'candidates_token_count': 75, 'total_token_count': 9652, 'cached_content_token_count': 1837, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9524}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1837}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 75}], 'thoughts_token_count': 53}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11436954498291016, 'model_name': 'gemini-2.5-pro'} id='run--b38fa4c9-74ad-4150-856a-f63700c7a75f-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 501.0, 'end_line': 1000.0, 'relative_path': 'django/db/models/lookups.py'}, 'id': '7b908041-0584-4856-a0eb-588a8b53ab54', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9524, 'output_tokens': 75, 'total_tokens': 9652, 'input_token_details': {'cache_read': 1837}, 'output_token_details': {'reasoning': 53}}
2025-12-21 08:09:36,597 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of `django/db/models/lookups.py`. The file was read in two parts to ensure the full content was captured. I can now provide the complete file, which will help in understanding the `resolve_lookup_value` and its interaction with different lookup types.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11163, 'candidates_token_count': 64, 'total_token_count': 11549, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11163}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 322, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7400902509689331, 'model_name': 'gemini-2.5-pro'} id='run--5122c429-881e-4e4c-8b83-e28060527a5a-0' usage_metadata={'input_tokens': 11163, 'output_tokens': 64, 'total_tokens': 11549, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 322}}
2025-12-21 08:09:36,599 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of django/db/models/lookups.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file will explain how the value from `resolve_lookup_value` is used and why its type is important for certain lookups like 'exact'exact'.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: django/db/models/lookups.py
Line number range: 1 - 500
Content:
1. import itertools
2. import math
3. import warnings
4. from copy import copy
5. 
6. from django.core.exceptions import EmptyResultSet
7. from django.db.models.expressions import Case, Exists, Func, Value, When
8. from django.db.models.fields import (
9.     BooleanField, CharField, DateTimeField, Field, IntegerField, UUIDField,
10. )
11. from django.db.models.query_utils import RegisterLookupMixin
12. from django.utils.datastructures import OrderedSet
13. from django.utils.deprecation import RemovedInDjango40Warning
14. from django.utils.functional import cached_property
15. 
16. 
17. class Lookup:
18.     lookup_name = None
19.     prepare_rhs = True
20.     can_use_none_as_rhs = False
21. 
22.     def __init__(self, lhs, rhs):
23.         self.lhs, self.rhs = lhs, rhs
24.         self.rhs = self.get_prep_lookup()
25.         if hasattr(self.lhs, 'get_bilateral_transforms'):
26.             bilateral_transforms = self.lhs.get_bilateral_transforms()
27.         else:
28.             bilateral_transforms = []
29.         if bilateral_transforms:
30.             # Warn the user as soon as possible if they are trying to apply
31.             # a bilateral transformation on a nested QuerySet: that won't work.
32.             from django.db.models.sql.query import Query  # avoid circular import
33.             if isinstance(rhs, Query):
34.                 raise NotImplementedError("Bilateral transformations on nested querysets are not implemented.")
35.         self.bilateral_transforms = bilateral_transforms
36. 
37.     def apply_bilateral_transforms(self, value):
38.         for transform in self.bilateral_transforms:
39.             value = transform(value)
40.         return value
41. 
42.     def batch_process_rhs(self, compiler, connection, rhs=None):
43.         if rhs is None:
44.             rhs = self.rhs
45.         if self.bilateral_transforms:
46.             sqls, sqls_params = [], []
47.             for p in rhs:
48.                 value = Value(p, output_field=self.lhs.output_field)
49.                 value = self.apply_bilateral_transforms(value)
50.                 value = value.resolve_expression(compiler.query)
51.                 sql, sql_params = compiler.compile(value)
52.                 sqls.append(sql)
53.                 sqls_params.extend(sql_params)
54.         else:
55.             _, params = self.get_db_prep_lookup(rhs, connection)
56.             sqls, sqls_params = ['%s'] * len(params), params
57.         return sqls, sqls_params
58. 
59.     def get_source_expressions(self):
60.         if self.rhs_is_direct_value():
61.             return [self.lhs]
62.         return [self.lhs, self.rhs]
63. 
64.     def set_source_expressions(self, new_exprs):
65.         if len(new_exprs) == 1:
66.             self.lhs = new_exprs[0]
67.         else:
68.             self.lhs, self.rhs = new_exprs
69. 
70.     def get_prep_lookup(self):
71.         if hasattr(self.rhs, 'resolve_expression'):
72.             return self.rhs
73.         if self.prepare_rhs and hasattr(self.lhs.output_field, 'get_prep_value'):
74.             return self.lhs.output_field.get_prep_value(self.rhs)
75.         return self.rhs
76. 
77.     def get_db_prep_lookup(self, value, connection):
78.         return ('%s', [value])
79. 
80.     def process_lhs(self, compiler, connection, lhs=None):
81.         lhs = lhs or self.lhs
82.         if hasattr(lhs, 'resolve_expression'):
83.             lhs = lhs.resolve_expression(compiler.query)
84.         return compiler.compile(lhs)
85. 
86.     def process_rhs(self, compiler, connection):
87.         value = self.rhs
88.         if self.bilateral_transforms:
89.             if self.rhs_is_direct_value():
90.                 # Do not call get_db_prep_lookup here as the value will be
91.                 # transformed before being used for lookup
92.                 value = Value(value, output_field=self.lhs.output_field)
93.             value = self.apply_bilateral_transforms(value)
94.             value = value.resolve_expression(compiler.query)
95.         if hasattr(value, 'as_sql'):
96.             return compiler.compile(value)
97.         else:
98.             return self.get_db_prep_lookup(value, connection)
99. 
100.     def rhs_is_direct_value(self):
101.         return not hasattr(self.rhs, 'as_sql')
102. 
103.     def relabeled_clone(self, relabels):
104.         new = copy(self)
105.         new.lhs = new.lhs.relabeled_clone(relabels)
106.         if hasattr(new.rhs, 'relabeled_clone'):
107.             new.rhs = new.rhs.relabeled_clone(relabels)
108.         return new
109. 
110.     def get_group_by_cols(self, alias=None):
111.         cols = self.lhs.get_group_by_cols()
112.         if hasattr(self.rhs, 'get_group_by_cols'):
113.             cols.extend(self.rhs.get_group_by_cols())
114.         return cols
115. 
116.     def as_sql(self, compiler, connection):
117.         raise NotImplementedError
118. 
119.     def as_oracle(self, compiler, connection):
120.         # Oracle doesn't allow EXISTS() to be compared to another expression
121.         # unless it's wrapped in a CASE WHEN.
122.         wrapped = False
123.         exprs = []
124.         for expr in (self.lhs, self.rhs):
125.             if isinstance(expr, Exists):
126.                 expr = Case(When(expr, then=True), default=False, output_field=BooleanField())
127.                 wrapped = True
128.             exprs.append(expr)
129.         lookup = type(self)(*exprs) if wrapped else self
130.         return lookup.as_sql(compiler, connection)
131. 
132.     @cached_property
133.     def contains_aggregate(self):
134.         return self.lhs.contains_aggregate or getattr(self.rhs, 'contains_aggregate', False)
135. 
136.     @cached_property
137.     def contains_over_clause(self):
138.         return self.lhs.contains_over_clause or getattr(self.rhs, 'contains_over_clause', False)
139. 
140.     @property
141.     def is_summary(self):
142.         return self.lhs.is_summary or getattr(self.rhs, 'is_summary', False)
143. 
144. 
145. class Transform(RegisterLookupMixin, Func):
146.     """
147.     RegisterLookupMixin() is first so that get_lookup() and get_transform()
148.     first examine self and then check output_field.
149.     """
150.     bilateral = False
151.     arity = 1
152. 
153.     @property
154.     def lhs(self):
155.         return self.get_source_expressions()[0]
156. 
157.     def get_bilateral_transforms(self):
158.         if hasattr(self.lhs, 'get_bilateral_transforms'):
159.             bilateral_transforms = self.lhs.get_bilateral_transforms()
160.         else:
161.             bilateral_transforms = []
162.         if self.bilateral:
163.             bilateral_transforms.append(self.__class__)
164.         return bilateral_transforms
165. 
166. 
167. class BuiltinLookup(Lookup):
168.     def process_lhs(self, compiler, connection, lhs=None):
169.         lhs_sql, params = super().process_lhs(compiler, connection, lhs)
170.         field_internal_type = self.lhs.output_field.get_internal_type()
171.         db_type = self.lhs.output_field.db_type(connection=connection)
172.         lhs_sql = connection.ops.field_cast_sql(
173.             db_type, field_internal_type) % lhs_sql
174.         lhs_sql = connection.ops.lookup_cast(self.lookup_name, field_internal_type) % lhs_sql
175.         return lhs_sql, list(params)
176. 
177.     def as_sql(self, compiler, connection):
178.         lhs_sql, params = self.process_lhs(compiler, connection)
179.         rhs_sql, rhs_params = self.process_rhs(compiler, connection)
180.         params.extend(rhs_params)
181.         rhs_sql = self.get_rhs_op(connection, rhs_sql)
182.         return '%s %s' % (lhs_sql, rhs_sql), params
183. 
184.     def get_rhs_op(self, connection, rhs):
185.         return connection.operators[self.lookup_name] % rhs
186. 
187. 
188. class FieldGetDbPrepValueMixin:
189.     """
190.     Some lookups require Field.get_db_prep_value() to be called on their
191.     inputs.
192.     """
193.     get_db_prep_lookup_value_is_iterable = False
194. 
195.     def get_db_prep_lookup(self, value, connection):
196.         # For relational fields, use the 'target_field' attribute of the
197.         # output_field.
198.         field = getattr(self.lhs.output_field, 'target_field', None)
199.         get_db_prep_value = getattr(field, 'get_db_prep_value', None) or self.lhs.output_field.get_db_prep_value
200.         return (
201.             '%s',
202.             [get_db_prep_value(v, connection, prepared=True) for v in value]
203.             if self.get_db_prep_lookup_value_is_iterable else
204.             [get_db_prep_value(value, connection, prepared=True)]
205.         )
206. 
207. 
208. class FieldGetDbPrepValueIterableMixin(FieldGetDbPrepValueMixin):
209.     """
210.     Some lookups require Field.get_db_prep_value() to be called on each value
211.     in an iterable.
212.     """
213.     get_db_prep_lookup_value_is_iterable = True
214. 
215.     def get_prep_lookup(self):
216.         if hasattr(self.rhs, 'resolve_expression'):
217.             return self.rhs
218.         prepared_values = []
219.         for rhs_value in self.rhs:
220.             if hasattr(rhs_value, 'resolve_expression'):
221.                 # An expression will be handled by the database but can coexist
222.                 # alongside real values.
223.                 pass
224.             elif self.prepare_rhs and hasattr(self.lhs.output_field, 'get_prep_value'):
225.                 rhs_value = self.lhs.output_field.get_prep_value(rhs_value)
226.             prepared_values.append(rhs_value)
227.         return prepared_values
228. 
229.     def process_rhs(self, compiler, connection):
230.         if self.rhs_is_direct_value():
231.             # rhs should be an iterable of values. Use batch_process_rhs()
232.             # to prepare/transform those values.
233.             return self.batch_process_rhs(compiler, connection)
234.         else:
235.             return super().process_rhs(compiler, connection)
236. 
237.     def resolve_expression_parameter(self, compiler, connection, sql, param):
238.         params = [param]
239.         if hasattr(param, 'resolve_expression'):
240.             param = param.resolve_expression(compiler.query)
241.         if hasattr(param, 'as_sql'):
242.             sql, params = param.as_sql(compiler, connection)
243.         return sql, params
244. 
245.     def batch_process_rhs(self, compiler, connection, rhs=None):
246.         pre_processed = super().batch_process_rhs(compiler, connection, rhs)
247.         # The params list may contain expressions which compile to a
248.         # sql/param pair. Zip them to get sql and param pairs that refer to the
249.         # same argument and attempt to replace them with the result of
250.         # compiling the param step.
251.         sql, params = zip(*(
252.             self.resolve_expression_parameter(compiler, connection, sql, param)
253.             for sql, param in zip(*pre_processed)
254.         ))
255.         params = itertools.chain.from_iterable(params)
256.         return sql, tuple(params)
257. 
258. 
259. @Field.register_lookup
260. class Exact(FieldGetDbPrepValueMixin, BuiltinLookup):
261.     lookup_name = 'exact'
262. 
263.     def process_rhs(self, compiler, connection):
264.         from django.db.models.sql.query import Query
265.         if isinstance(self.rhs, Query):
266.             if self.rhs.has_limit_one():
267.                 if not self.rhs.has_select_fields:
268.                     self.rhs.clear_select_clause()
269.                     self.rhs.add_fields(['pk'])
270.             else:
271.                 raise ValueError(
272.                     'The QuerySet value for an exact lookup must be limited to '
273.                     'one result using slicing.'
274.                 )
275.         return super().process_rhs(compiler, connection)
276. 
277. 
278. @Field.register_lookup
279. class IExact(BuiltinLookup):
280.     lookup_name = 'iexact'
281.     prepare_rhs = False
282. 
283.     def process_rhs(self, qn, connection):
284.         rhs, params = super().process_rhs(qn, connection)
285.         if params:
286.             params[0] = connection.ops.prep_for_iexact_query(params[0])
287.         return rhs, params
288. 
289. 
290. @Field.register_lookup
291. class GreaterThan(FieldGetDbPrepValueMixin, BuiltinLookup):
292.     lookup_name = 'gt'
293. 
294. 
295. @Field.register_lookup
296. class GreaterThanOrEqual(FieldGetDbPrepValueMixin, BuiltinLookup):
297.     lookup_name = 'gte'
298. 
299. 
300. @Field.register_lookup
301. class LessThan(FieldGetDbPrepValueMixin, BuiltinLookup):
302.     lookup_name = 'lt'
303. 
304. 
305. @Field.register_lookup
306. class LessThanOrEqual(FieldGetDbPrepValueMixin, BuiltinLookup):
307.     lookup_name = 'lte'
308. 
309. 
310. class IntegerFieldFloatRounding:
311.     """
312.     Allow floats to work as query values for IntegerField. Without this, the
313.     decimal portion of the float would always be discarded.
314.     """
315.     def get_prep_lookup(self):
316.         if isinstance(self.rhs, float):
317.             self.rhs = math.ceil(self.rhs)
318.         return super().get_prep_lookup()
319. 
320. 
321. @IntegerField.register_lookup
322. class IntegerGreaterThanOrEqual(IntegerFieldFloatRounding, GreaterThanOrEqual):
323.     pass
324. 
325. 
326. @IntegerField.register_lookup
327. class IntegerLessThan(IntegerFieldFloatRounding, LessThan):
328.     pass
329. 
330. 
331. @Field.register_lookup
332. class In(FieldGetDbPrepValueIterableMixin, BuiltinLookup):
333.     lookup_name = 'in'
334. 
335.     def process_rhs(self, compiler, connection):
336.         db_rhs = getattr(self.rhs, '_db', None)
337.         if db_rhs is not None and db_rhs != connection.alias:
338.             raise ValueError(
339.                 "Subqueries aren't allowed across different databases. Force "
340.                 "the inner query to be evaluated using `list(inner_query)`."
341.             )
342. 
343.         if self.rhs_is_direct_value():
344.             try:
345.                 rhs = OrderedSet(self.rhs)
346.             except TypeError:  # Unhashable items in self.rhs
347.                 rhs = self.rhs
348. 
349.             if not rhs:
350.                 raise EmptyResultSet
351. 
352.             # rhs should be an iterable; use batch_process_rhs() to
353.             # prepare/transform those values.
354.             sqls, sqls_params = self.batch_process_rhs(compiler, connection, rhs)
355.             placeholder = '(' + ', '.join(sqls) + ')'
356.             return (placeholder, sqls_params)
357.         else:
358.             if not getattr(self.rhs, 'has_select_fields', True):
359.                 self.rhs.clear_select_clause()
360.                 self.rhs.add_fields(['pk'])
361.             return super().process_rhs(compiler, connection)
362. 
363.     def get_rhs_op(self, connection, rhs):
364.         return 'IN %s' % rhs
365. 
366.     def as_sql(self, compiler, connection):
367.         max_in_list_size = connection.ops.max_in_list_size()
368.         if self.rhs_is_direct_value() and max_in_list_size and len(self.rhs) > max_in_list_size:
369.             return self.split_parameter_list_as_sql(compiler, connection)
370.         return super().as_sql(compiler, connection)
371. 
372.     def split_parameter_list_as_sql(self, compiler, connection):
373.         # This is a special case for databases which limit the number of
374.         # elements which can appear in an 'IN' clause.
375.         max_in_list_size = connection.ops.max_in_list_size()
376.         lhs, lhs_params = self.process_lhs(compiler, connection)
377.         rhs, rhs_params = self.batch_process_rhs(compiler, connection)
378.         in_clause_elements = ['(']
379.         params = []
380.         for offset in range(0, len(rhs_params), max_in_list_size):
381.             if offset > 0:
382.                 in_clause_elements.append(' OR ')
383.             in_clause_elements.append('%s IN (' % lhs)
384.             params.extend(lhs_params)
385.             sqls = rhs[offset: offset + max_in_list_size]
386.             sqls_params = rhs_params[offset: offset + max_in_list_size]
387.             param_group = ', '.join(sqls)
388.             in_clause_elements.append(param_group)
389.             in_clause_elements.append(')')
390.             params.extend(sqls_params)
391.         in_clause_elements.append(')')
392.         return ''.join(in_clause_elements), params
393. 
394. 
395. class PatternLookup(BuiltinLookup):
396.     param_pattern = '%%%s%%'
397.     prepare_rhs = False
398. 
399.     def get_rhs_op(self, connection, rhs):
400.         # Assume we are in startswith. We need to produce SQL like:
401.         #     col LIKE %s, ['thevalue%']
402.         # For python values we can (and should) do that directly in Python,
403.         # but if the value is for example reference to other column, then
404.         # we need to add the % pattern match to the lookup by something like
405.         #     col LIKE othercol || '%%'
406.         # So, for Python values we don't need any special pattern, but for
407.         # SQL reference values or SQL transformations we need the correct
408.         # pattern added.
409.         if hasattr(self.rhs, 'as_sql') or self.bilateral_transforms:
410.             pattern = connection.pattern_ops[self.lookup_name].format(connection.pattern_esc)
411.             return pattern.format(rhs)
412.         else:
413.             return super().get_rhs_op(connection, rhs)
414. 
415.     def process_rhs(self, qn, connection):
416.         rhs, params = super().process_rhs(qn, connection)
417.         if self.rhs_is_direct_value() and params and not self.bilateral_transforms:
418.             params[0] = self.param_pattern % connection.ops.prep_for_like_query(params[0])
419.         return rhs, params
420. 
421. 
422. @Field.register_lookup
423. class Contains(PatternLookup):
424.     lookup_name = 'contains'
425. 
426. 
427. @Field.register_lookup
428. class IContains(Contains):
429.     lookup_name = 'icontains'
430. 
431. 
432. @Field.register_lookup
433. class StartsWith(PatternLookup):
434.     lookup_name = 'startswith'
435.     param_pattern = '%s%%'
436. 
437. 
438. @Field.register_lookup
439. class IStartsWith(StartsWith):
440.     lookup_name = 'istartswith'
441. 
442. 
443. @Field.register_lookup
444. class EndsWith(PatternLookup):
445.     lookup_name = 'endswith'
446.     param_pattern = '%%%s'
447. 
448. 
449. @Field.register_lookup
450. class IEndsWith(EndsWith):
451.     lookup_name = 'iendswith'
452. 
453. 
454. @Field.register_lookup
455. class Range(FieldGetDbPrepValueIterableMixin, BuiltinLookup):
456.     lookup_name = 'range'
457. 
458.     def get_rhs_op(self, connection, rhs):
459.         return "BETWEEN %s AND %s" % (rhs[0], rhs[1])
460. 
461. 
462. @Field.register_lookup
463. class IsNull(BuiltinLookup):
464.     lookup_name = 'isnull'
465.     prepare_rhs = False
466. 
467.     def as_sql(self, compiler, connection):
468.         if not isinstance(self.rhs, bool):
469.             # When the deprecation ends, replace with:
470.             # raise ValueError(
471.             #     'The QuerySet value for an isnull lookup must be True or '
472.             #     'False.'
473.             # )
474.             warnings.warn(
475.                 'Using a non-boolean value for an isnull lookup is '
476.                 'deprecated, use True or False instead.',
477.                 RemovedInDjango40Warning,
478.             )
479.         sql, params = compiler.compile(self.lhs)
480.         if self.rhs:
481.             return "%s IS NULL" % sql, params
482.         else:
483.             return "%s IS NOT NULL" % sql, params
484. 
485. 
486. @Field.register_lookup
487. class Regex(BuiltinLookup):
488.     lookup_name = 'regex'
489.     prepare_rhs = False
490. 
491.     def as_sql(self, compiler, connection):
492.         if self.lookup_name in connection.operators:
493.             return super().as_sql(compiler, connection)
494.         else:
495.             lhs, lhs_params = self.process_lhs(compiler, connection)
496.             rhs, rhs_params = self.process_rhs(compiler, connection)
497.             sql_template = connection.ops.regex_lookup(self.lookup_name)
498.             return sql_template % (lhs, rhs), lhs_params + rhs_params
499. 
500.


File: django/db/models/lookups.py
Line number range: 501 - 1000
Content:
501. @Field.register_lookup
502. class IRegex(Regex):
503.     lookup_name = 'iregex'
504. 
505. 
506. class YearLookup(Lookup):
507.     def year_lookup_bounds(self, connection, year):
508.         output_field = self.lhs.lhs.output_field
509.         if isinstance(output_field, DateTimeField):
510.             bounds = connection.ops.year_lookup_bounds_for_datetime_field(year)
511.         else:
512.             bounds = connection.ops.year_lookup_bounds_for_date_field(year)
513.         return bounds
514. 
515.     def as_sql(self, compiler, connection):
516.         # Avoid the extract operation if the rhs is a direct value to allow
517.         # indexes to be used.
518.         if self.rhs_is_direct_value():
519.             # Skip the extract part by directly using the originating field,
520.             # that is self.lhs.lhs.
521.             lhs_sql, params = self.process_lhs(compiler, connection, self.lhs.lhs)
522.             rhs_sql, _ = self.process_rhs(compiler, connection)
523.             rhs_sql = self.get_direct_rhs_sql(connection, rhs_sql)
524.             start, finish = self.year_lookup_bounds(connection, self.rhs)
525.             params.extend(self.get_bound_params(start, finish))
526.             return '%s %s' % (lhs_sql, rhs_sql), params
527.         return super().as_sql(compiler, connection)
528. 
529.     def get_direct_rhs_sql(self, connection, rhs):
530.         return connection.operators[self.lookup_name] % rhs
531. 
532.     def get_bound_params(self, start, finish):
533.         raise NotImplementedError(
534.             'subclasses of YearLookup must provide a get_bound_params() method'
535.         )
536. 
537. 
538. class YearExact(YearLookup, Exact):
539.     def get_direct_rhs_sql(self, connection, rhs):
540.         return 'BETWEEN %s AND %s'
541. 
542.     def get_bound_params(self, start, finish):
543.         return (start, finish)
544. 
545. 
546. class YearGt(YearLookup, GreaterThan):
547.     def get_bound_params(self, start, finish):
548.         return (finish,)
549. 
550. 
551. class YearGte(YearLookup, GreaterThanOrEqual):
552.     def get_bound_params(self, start, finish):
553.         return (start,)
554. 
555. 
556. class YearLt(YearLookup, LessThan):
557.     def get_bound_params(self, start, finish):
558.         return (start,)
559. 
560. 
561. class YearLte(YearLookup, LessThanOrEqual):
562.     def get_bound_params(self, start, finish):
563.         return (finish,)
564. 
565. 
566. class UUIDTextMixin:
567.     """
568.     Strip hyphens from a value when filtering a UUIDField on backends without
569.     a native datatype for UUID.
570.     """
571.     def process_rhs(self, qn, connection):
572.         if not connection.features.has_native_uuid_field:
573.             from django.db.models.functions import Replace
574.             if self.rhs_is_direct_value():
575.                 self.rhs = Value(self.rhs)
576.             self.rhs = Replace(self.rhs, Value('-'), Value(''), output_field=CharField())
577.         rhs, params = super().process_rhs(qn, connection)
578.         return rhs, params
579. 
580. 
581. @UUIDField.register_lookup
582. class UUIDIExact(UUIDTextMixin, IExact):
583.     pass
584. 
585. 
586. @UUIDField.register_lookup
587. class UUIDContains(UUIDTextMixin, Contains):
588.     pass
589. 
590. 
591. @UUIDField.register_lookup
592. class UUIDIContains(UUIDTextMixin, IContains):
593.     pass
594. 
595. 
596. @UUIDField.register_lookup
597. class UUIDStartsWith(UUIDTextMixin, StartsWith):
598.     pass
599. 
600. 
601. @UUIDField.register_lookup
602. class UUIDIStartsWith(UUIDTextMixin, IStartsWith):
603.     pass
604. 
605. 
606. @UUIDField.register_lookup
607. class UUIDEndsWith(UUIDTextMixin, EndsWith):
608.     pass
609. 
610. 
611. @UUIDField.register_lookup
612. class UUIDIEndsWith(UUIDTextMixin, IEndsWith):
613.     pass

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:09:42,226 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file 'django/db/models/lookups.py'. The provided context contains the file's content from line 1 to 613, which appears to be the entire file. Therefore, I am selecting the entire range to fulfill the user's request.", relative_path='django/db/models/lookups.py', start_line=1, end_line=613)]
2025-12-21 08:09:42,228 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of django/db/models/lookups.py.
2025-12-21 08:09:42,228 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:09:42,228 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:09:42,228 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 3 existing contexts
2025-12-21 08:09:42,229 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 4 total contexts (removed 0 duplicates)
2025-12-21 08:09:42,229 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── FUNDING.yml
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Query.resolve_lookup_value coerces value of type list to tuple

Description: Description
	
Changes introduced in #30687 cause an input value list to be coerced to tuple breaking exact value queries. This affects ORM field types that are dependent on matching input types such as PickledField.
The expected iterable return type should match input iterable type.

Patch information:
diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py
index ea51912e8b..6724f401f1 100644
--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -1073,7 +1073,12 @@ class Query(BaseExpression):
                         ))
                 else:
                     resolved_values.append(sub_value)
-            value = tuple(resolved_values)
+            # Preserve the input iterable type (list vs tuple) to avoid altering
+            # exact comparisons for type-sensitive fields (e.g., pickled values).
+            if isinstance(value, list):
+                value = resolved_values
+            else:
+                value = tuple(resolved_values)
         return value
 
     def solve_lookup_type(self, lookup):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of django/db/models/sql/query.py.
Extra Requirements: If the file is too large, please at least provide the complete implementation of the `Query` class from that file.
Purpose: The `Query` class and its `resolve_lookup_value` method are central to the issue, and this file is needed to understand the context of the provided patch.

Previous refined query 2:
Essential Query: Please provide the full content of django/db/models/lookups.py.
Extra Requirements: 
Purpose: This file will explain how the value from `resolve_lookup_value` is used and why its type is important for certain lookups like 'exact'exact'.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: django/db/models/lookups.py
Line number range: 1 - 613
Content:
1. import itertools
2. import math
3. import warnings
4. from copy import copy
5. 
6. from django.core.exceptions import EmptyResultSet
7. from django.db.models.expressions import Case, Exists, Func, Value, When
8. from django.db.models.fields import (
9.     BooleanField, CharField, DateTimeField, Field, IntegerField, UUIDField,
10. )
11. from django.db.models.query_utils import RegisterLookupMixin
12. from django.utils.datastructures import OrderedSet
13. from django.utils.deprecation import RemovedInDjango40Warning
14. from django.utils.functional import cached_property
15. 
16. 
17. class Lookup:
18.     lookup_name = None
19.     prepare_rhs = True
20.     can_use_none_as_rhs = False
21. 
22.     def __init__(self, lhs, rhs):
23.         self.lhs, self.rhs = lhs, rhs
24.         self.rhs = self.get_prep_lookup()
25.         if hasattr(self.lhs, 'get_bilateral_transforms'):
26.             bilateral_transforms = self.lhs.get_bilateral_transforms()
27.         else:
28.             bilateral_transforms = []
29.         if bilateral_transforms:
30.             # Warn the user as soon as possible if they are trying to apply
31.             # a bilateral transformation on a nested QuerySet: that won't work.
32.             from django.db.models.sql.query import Query  # avoid circular import
33.             if isinstance(rhs, Query):
34.                 raise NotImplementedError("Bilateral transformations on nested querysets are not implemented.")
35.         self.bilateral_transforms = bilateral_transforms
36. 
37.     def apply_bilateral_transforms(self, value):
38.         for transform in self.bilateral_transforms:
39.             value = transform(value)
40.         return value
41. 
42.     def batch_process_rhs(self, compiler, connection, rhs=None):
43.         if rhs is None:
44.             rhs = self.rhs
45.         if self.bilateral_transforms:
46.             sqls, sqls_params = [], []
47.             for p in rhs:
48.                 value = Value(p, output_field=self.lhs.output_field)
49.                 value = self.apply_bilateral_transforms(value)
50.                 value = value.resolve_expression(compiler.query)
51.                 sql, sql_params = compiler.compile(value)
52.                 sqls.append(sql)
53.                 sqls_params.extend(sql_params)
54.         else:
55.             _, params = self.get_db_prep_lookup(rhs, connection)
56.             sqls, sqls_params = ['%s'] * len(params), params
57.         return sqls, sqls_params
58. 
59.     def get_source_expressions(self):
60.         if self.rhs_is_direct_value():
61.             return [self.lhs]
62.         return [self.lhs, self.rhs]
63. 
64.     def set_source_expressions(self, new_exprs):
65.         if len(new_exprs) == 1:
66.             self.lhs = new_exprs[0]
67.         else:
68.             self.lhs, self.rhs = new_exprs
69. 
70.     def get_prep_lookup(self):
71.         if hasattr(self.rhs, 'resolve_expression'):
72.             return self.rhs
73.         if self.prepare_rhs and hasattr(self.lhs.output_field, 'get_prep_value'):
74.             return self.lhs.output_field.get_prep_value(self.rhs)
75.         return self.rhs
76. 
77.     def get_db_prep_lookup(self, value, connection):
78.         return ('%s', [value])
79. 
80.     def process_lhs(self, compiler, connection, lhs=None):
81.         lhs = lhs or self.lhs
82.         if hasattr(lhs, 'resolve_expression'):
83.             lhs = lhs.resolve_expression(compiler.query)
84.         return compiler.compile(lhs)
85. 
86.     def process_rhs(self, compiler, connection):
87.         value = self.rhs
88.         if self.bilateral_transforms:
89.             if self.rhs_is_direct_value():
90.                 # Do not call get_db_prep_lookup here as the value will be
91.                 # transformed before being used for lookup
92.                 value = Value(value, output_field=self.lhs.output_field)
93.             value = self.apply_bilateral_transforms(value)
94.             value = value.resolve_expression(compiler.query)
95.         if hasattr(value, 'as_sql'):
96.             return compiler.compile(value)
97.         else:
98.             return self.get_db_prep_lookup(value, connection)
99. 
100.     def rhs_is_direct_value(self):
101.         return not hasattr(self.rhs, 'as_sql')
102. 
103.     def relabeled_clone(self, relabels):
104.         new = copy(self)
105.         new.lhs = new.lhs.relabeled_clone(relabels)
106.         if hasattr(new.rhs, 'relabeled_clone'):
107.             new.rhs = new.rhs.relabeled_clone(relabels)
108.         return new
109. 
110.     def get_group_by_cols(self, alias=None):
111.         cols = self.lhs.get_group_by_cols()
112.         if hasattr(self.rhs, 'get_group_by_cols'):
113.             cols.extend(self.rhs.get_group_by_cols())
114.         return cols
115. 
116.     def as_sql(self, compiler, connection):
117.         raise NotImplementedError
118. 
119.     def as_oracle(self, compiler, connection):
120.         # Oracle doesn't allow EXISTS() to be compared to another expression
121.         # unless it's wrapped in a CASE WHEN.
122.         wrapped = False
123.         exprs = []
124.         for expr in (self.lhs, self.rhs):
125.             if isinstance(expr, Exists):
126.                 expr = Case(When(expr, then=True), default=False, output_field=BooleanField())
127.                 wrapped = True
128.             exprs.append(expr)
129.         lookup = type(self)(*exprs) if wrapped else self
130.         return lookup.as_sql(compiler, connection)
131. 
132.     @cached_property
133.     def contains_aggregate(self):
134.         return self.lhs.contains_aggregate or getattr(self.rhs, 'contains_aggregate', False)
135. 
136.     @cached_property
137.     def contains_over_clause(self):
138.         return self.lhs.contains_over_clause or getattr(self.rhs, 'contains_over_clause', False)
139. 
140.     @property
141.     def is_summary(self):
142.         return self.lhs.is_summary or getattr(self.rhs, 'is_summary', False)
143. 
144. 
145. class Transform(RegisterLookupMixin, Func):
146.     """
147.     RegisterLookupMixin() is first so that get_lookup() and get_transform()
148.     first examine self and then check output_field.
149.     """
150.     bilateral = False
151.     arity = 1
152. 
153.     @property
154.     def lhs(self):
155.         return self.get_source_expressions()[0]
156. 
157.     def get_bilateral_transforms(self):
158.         if hasattr(self.lhs, 'get_bilateral_transforms'):
159.             bilateral_transforms = self.lhs.get_bilateral_transforms()
160.         else:
161.             bilateral_transforms = []
162.         if self.bilateral:
163.             bilateral_transforms.append(self.__class__)
164.         return bilateral_transforms
165. 
166. 
167. class BuiltinLookup(Lookup):
168.     def process_lhs(self, compiler, connection, lhs=None):
169.         lhs_sql, params = super().process_lhs(compiler, connection, lhs)
170.         field_internal_type = self.lhs.output_field.get_internal_type()
171.         db_type = self.lhs.output_field.db_type(connection=connection)
172.         lhs_sql = connection.ops.field_cast_sql(
173.             db_type, field_internal_type) % lhs_sql
174.         lhs_sql = connection.ops.lookup_cast(self.lookup_name, field_internal_type) % lhs_sql
175.         return lhs_sql, list(params)
176. 
177.     def as_sql(self, compiler, connection):
178.         lhs_sql, params = self.process_lhs(compiler, connection)
179.         rhs_sql, rhs_params = self.process_rhs(compiler, connection)
180.         params.extend(rhs_params)
181.         rhs_sql = self.get_rhs_op(connection, rhs_sql)
182.         return '%s %s' % (lhs_sql, rhs_sql), params
183. 
184.     def get_rhs_op(self, connection, rhs):
185.         return connection.operators[self.lookup_name] % rhs
186. 
187. 
188. class FieldGetDbPrepValueMixin:
189.     """
190.     Some lookups require Field.get_db_prep_value() to be called on their
191.     inputs.
192.     """
193.     get_db_prep_lookup_value_is_iterable = False
194. 
195.     def get_db_prep_lookup(self, value, connection):
196.         # For relational fields, use the 'target_field' attribute of the
197.         # output_field.
198.         field = getattr(self.lhs.output_field, 'target_field', None)
199.         get_db_prep_value = getattr(field, 'get_db_prep_value', None) or self.lhs.output_field.get_db_prep_value
200.         return (
201.             '%s',
202.             [get_db_prep_value(v, connection, prepared=True) for v in value]
203.             if self.get_db_prep_lookup_value_is_iterable else
204.             [get_db_prep_value(value, connection, prepared=True)]
205.         )
206. 
207. 
208. class FieldGetDbPrepValueIterableMixin(FieldGetDbPrepValueMixin):
209.     """
210.     Some lookups require Field.get_db_prep_value() to be called on each value
211.     in an iterable.
212.     """
213.     get_db_prep_lookup_value_is_iterable = True
214. 
215.     def get_prep_lookup(self):
216.         if hasattr(self.rhs, 'resolve_expression'):
217.             return self.rhs
218.         prepared_values = []
219.         for rhs_value in self.rhs:
220.             if hasattr(rhs_value, 'resolve_expression'):
221.                 # An expression will be handled by the database but can coexist
222.                 # alongside real values.
223.                 pass
224.             elif self.prepare_rhs and hasattr(self.lhs.output_field, 'get_prep_value'):
225.                 rhs_value = self.lhs.output_field.get_prep_value(rhs_value)
226.             prepared_values.append(rhs_value)
227.         return prepared_values
228. 
229.     def process_rhs(self, compiler, connection):
230.         if self.rhs_is_direct_value():
231.             # rhs should be an iterable of values. Use batch_process_rhs()
232.             # to prepare/transform those values.
233.             return self.batch_process_rhs(compiler, connection)
234.         else:
235.             return super().process_rhs(compiler, connection)
236. 
237.     def resolve_expression_parameter(self, compiler, connection, sql, param):
238.         params = [param]
239.         if hasattr(param, 'resolve_expression'):
240.             param = param.resolve_expression(compiler.query)
241.         if hasattr(param, 'as_sql'):
242.             sql, params = param.as_sql(compiler, connection)
243.         return sql, params
244. 
245.     def batch_process_rhs(self, compiler, connection, rhs=None):
246.         pre_processed = super().batch_process_rhs(compiler, connection, rhs)
247.         # The params list may contain expressions which compile to a
248.         # sql/param pair. Zip them to get sql and param pairs that refer to the
249.         # same argument and attempt to replace them with the result of
250.         # compiling the param step.
251.         sql, params = zip(*(
252.             self.resolve_expression_parameter(compiler, connection, sql, param)
253.             for sql, param in zip(*pre_processed)
254.         ))
255.         params = itertools.chain.from_iterable(params)
256.         return sql, tuple(params)
257. 
258. 
259. @Field.register_lookup
260. class Exact(FieldGetDbPrepValueMixin, BuiltinLookup):
261.     lookup_name = 'exact'
262. 
263.     def process_rhs(self, compiler, connection):
264.         from django.db.models.sql.query import Query
265.         if isinstance(self.rhs, Query):
266.             if self.rhs.has_limit_one():
267.                 if not self.rhs.has_select_fields:
268.                     self.rhs.clear_select_clause()
269.                     self.rhs.add_fields(['pk'])
270.             else:
271.                 raise ValueError(
272.                     'The QuerySet value for an exact lookup must be limited to '
273.                     'one result using slicing.'
274.                 )
275.         return super().process_rhs(compiler, connection)
276. 
277. 
278. @Field.register_lookup
279. class IExact(BuiltinLookup):
280.     lookup_name = 'iexact'
281.     prepare_rhs = False
282. 
283.     def process_rhs(self, qn, connection):
284.         rhs, params = super().process_rhs(qn, connection)
285.         if params:
286.             params[0] = connection.ops.prep_for_iexact_query(params[0])
287.         return rhs, params
288. 
289. 
290. @Field.register_lookup
291. class GreaterThan(FieldGetDbPrepValueMixin, BuiltinLookup):
292.     lookup_name = 'gt'
293. 
294. 
295. @Field.register_lookup
296. class GreaterThanOrEqual(FieldGetDbPrepValueMixin, BuiltinLookup):
297.     lookup_name = 'gte'
298. 
299. 
300. @Field.register_lookup
301. class LessThan(FieldGetDbPrepValueMixin, BuiltinLookup):
302.     lookup_name = 'lt'
303. 
304. 
305. @Field.register_lookup
306. class LessThanOrEqual(FieldGetDbPrepValueMixin, BuiltinLookup):
307.     lookup_name = 'lte'
308. 
309. 
310. class IntegerFieldFloatRounding:
311.     """
312.     Allow floats to work as query values for IntegerField. Without this, the
313.     decimal portion of the float would always be discarded.
314.     """
315.     def get_prep_lookup(self):
316.         if isinstance(self.rhs, float):
317.             self.rhs = math.ceil(self.rhs)
318.         return super().get_prep_lookup()
319. 
320. 
321. @IntegerField.register_lookup
322. class IntegerGreaterThanOrEqual(IntegerFieldFloatRounding, GreaterThanOrEqual):
323.     pass
324. 
325. 
326. @IntegerField.register_lookup
327. class IntegerLessThan(IntegerFieldFloatRounding, LessThan):
328.     pass
329. 
330. 
331. @Field.register_lookup
332. class In(FieldGetDbPrepValueIterableMixin, BuiltinLookup):
333.     lookup_name = 'in'
334. 
335.     def process_rhs(self, compiler, connection):
336.         db_rhs = getattr(self.rhs, '_db', None)
337.         if db_rhs is not None and db_rhs != connection.alias:
338.             raise ValueError(
339.                 "Subqueries aren't allowed across different databases. Force "
340.                 "the inner query to be evaluated using `list(inner_query)`."
341.             )
342. 
343.         if self.rhs_is_direct_value():
344.             try:
345.                 rhs = OrderedSet(self.rhs)
346.             except TypeError:  # Unhashable items in self.rhs
347.                 rhs = self.rhs
348. 
349.             if not rhs:
350.                 raise EmptyResultSet
351. 
352.             # rhs should be an iterable; use batch_process_rhs() to
353.             # prepare/transform those values.
354.             sqls, sqls_params = self.batch_process_rhs(compiler, connection, rhs)
355.             placeholder = '(' + ', '.join(sqls) + ')'
356.             return (placeholder, sqls_params)
357.         else:
358.             if not getattr(self.rhs, 'has_select_fields', True):
359.                 self.rhs.clear_select_clause()
360.                 self.rhs.add_fields(['pk'])
361.             return super().process_rhs(compiler, connection)
362. 
363.     def get_rhs_op(self, connection, rhs):
364.         return 'IN %s' % rhs
365. 
366.     def as_sql(self, compiler, connection):
367.         max_in_list_size = connection.ops.max_in_list_size()
368.         if self.rhs_is_direct_value() and max_in_list_size and len(self.rhs) > max_in_list_size:
369.             return self.split_parameter_list_as_sql(compiler, connection)
370.         return super().as_sql(compiler, connection)
371. 
372.     def split_parameter_list_as_sql(self, compiler, connection):
373.         # This is a special case for databases which limit the number of
374.         # elements which can appear in an 'IN' clause.
375.         max_in_list_size = connection.ops.max_in_list_size()
376.         lhs, lhs_params = self.process_lhs(compiler, connection)
377.         rhs, rhs_params = self.batch_process_rhs(compiler, connection)
378.         in_clause_elements = ['(']
379.         params = []
380.         for offset in range(0, len(rhs_params), max_in_list_size):
381.             if offset > 0:
382.                 in_clause_elements.append(' OR ')
383.             in_clause_elements.append('%s IN (' % lhs)
384.             params.extend(lhs_params)
385.             sqls = rhs[offset: offset + max_in_list_size]
386.             sqls_params = rhs_params[offset: offset + max_in_list_size]
387.             param_group = ', '.join(sqls)
388.             in_clause_elements.append(param_group)
389.             in_clause_elements.append(')')
390.             params.extend(sqls_params)
391.         in_clause_elements.append(')')
392.         return ''.join(in_clause_elements), params
393. 
394. 
395. class PatternLookup(BuiltinLookup):
396.     param_pattern = '%%%s%%'
397.     prepare_rhs = False
398. 
399.     def get_rhs_op(self, connection, rhs):
400.         # Assume we are in startswith. We need to produce SQL like:
401.         #     col LIKE %s, ['thevalue%']
402.         # For python values we can (and should) do that directly in Python,
403.         # but if the value is for example reference to other column, then
404.         # we need to add the % pattern match to the lookup by something like
405.         #     col LIKE othercol || '%%'
406.         # So, for Python values we don't need any special pattern, but for
407.         # SQL reference values or SQL transformations we need the correct
408.         # pattern added.
409.         if hasattr(self.rhs, 'as_sql') or self.bilateral_transforms:
410.             pattern = connection.pattern_ops[self.lookup_name].format(connection.pattern_esc)
411.             return pattern.format(rhs)
412.         else:
413.             return super().get_rhs_op(connection, rhs)
414. 
415.     def process_rhs(self, qn, connection):
416.         rhs, params = super().process_rhs(qn, connection)
417.         if self.rhs_is_direct_value() and params and not self.bilateral_transforms:
418.             params[0] = self.param_pattern % connection.ops.prep_for_like_query(params[0])
419.         return rhs, params
420. 
421. 
422. @Field.register_lookup
423. class Contains(PatternLookup):
424.     lookup_name = 'contains'
425. 
426. 
427. @Field.register_lookup
428. class IContains(Contains):
429.     lookup_name = 'icontains'
430. 
431. 
432. @Field.register_lookup
433. class StartsWith(PatternLookup):
434.     lookup_name = 'startswith'
435.     param_pattern = '%s%%'
436. 
437. 
438. @Field.register_lookup
439. class IStartsWith(StartsWith):
440.     lookup_name = 'istartswith'
441. 
442. 
443. @Field.register_lookup
444. class EndsWith(PatternLookup):
445.     lookup_name = 'endswith'
446.     param_pattern = '%%%s'
447. 
448. 
449. @Field.register_lookup
450. class IEndsWith(EndsWith):
451.     lookup_name = 'iendswith'
452. 
453. 
454. @Field.register_lookup
455. class Range(FieldGetDbPrepValueIterableMixin, BuiltinLookup):
456.     lookup_name = 'range'
457. 
458.     def get_rhs_op(self, connection, rhs):
459.         return "BETWEEN %s AND %s" % (rhs[0], rhs[1])
460. 
461. 
462. @Field.register_lookup
463. class IsNull(BuiltinLookup):
464.     lookup_name = 'isnull'
465.     prepare_rhs = False
466. 
467.     def as_sql(self, compiler, connection):
468.         if not isinstance(self.rhs, bool):
469.             # When the deprecation ends, replace with:
470.             # raise ValueError(
471.             #     'The QuerySet value for an isnull lookup must be True or '
472.             #     'False.'
473.             # )
474.             warnings.warn(
475.                 'Using a non-boolean value for an isnull lookup is '
476.                 'deprecated, use True or False instead.',
477.                 RemovedInDjango40Warning,
478.             )
479.         sql, params = compiler.compile(self.lhs)
480.         if self.rhs:
481.             return "%s IS NULL" % sql, params
482.         else:
483.             return "%s IS NOT NULL" % sql, params
484. 
485. 
486. @Field.register_lookup
487. class Regex(BuiltinLookup):
488.     lookup_name = 'regex'
489.     prepare_rhs = False
490. 
491.     def as_sql(self, compiler, connection):
492.         if self.lookup_name in connection.operators:
493.             return super().as_sql(compiler, connection)
494.         else:
495.             lhs, lhs_params = self.process_lhs(compiler, connection)
496.             rhs, rhs_params = self.process_rhs(compiler, connection)
497.             sql_template = connection.ops.regex_lookup(self.lookup_name)
498.             return sql_template % (lhs, rhs), lhs_params + rhs_params
499. 
500. 
501. @Field.register_lookup
502. class IRegex(Regex):
503.     lookup_name = 'iregex'
504. 
505. 
506. class YearLookup(Lookup):
507.     def year_lookup_bounds(self, connection, year):
508.         output_field = self.lhs.lhs.output_field
509.         if isinstance(output_field, DateTimeField):
510.             bounds = connection.ops.year_lookup_bounds_for_datetime_field(year)
511.         else:
512.             bounds = connection.ops.year_lookup_bounds_for_date_field(year)
513.         return bounds
514. 
515.     def as_sql(self, compiler, connection):
516.         # Avoid the extract operation if the rhs is a direct value to allow
517.         # indexes to be used.
518.         if self.rhs_is_direct_value():
519.             # Skip the extract part by directly using the originating field,
520.             # that is self.lhs.lhs.
521.             lhs_sql, params = self.process_lhs(compiler, connection, self.lhs.lhs)
522.             rhs_sql, _ = self.process_rhs(compiler, connection)
523.             rhs_sql = self.get_direct_rhs_sql(connection, rhs_sql)
524.             start, finish = self.year_lookup_bounds(connection, self.rhs)
525.             params.extend(self.get_bound_params(start, finish))
526.             return '%s %s' % (lhs_sql, rhs_sql), params
527.         return super().as_sql(compiler, connection)
528. 
529.     def get_direct_rhs_sql(self, connection, rhs):
530.         return connection.operators[self.lookup_name] % rhs
531. 
532.     def get_bound_params(self, start, finish):
533.         raise NotImplementedError(
534.             'subclasses of YearLookup must provide a get_bound_params() method'
535.         )
536. 
537. 
538. class YearExact(YearLookup, Exact):
539.     def get_direct_rhs_sql(self, connection, rhs):
540.         return 'BETWEEN %s AND %s'
541. 
542.     def get_bound_params(self, start, finish):
543.         return (start, finish)
544. 
545. 
546. class YearGt(YearLookup, GreaterThan):
547.     def get_bound_params(self, start, finish):
548.         return (finish,)
549. 
550. 
551. class YearGte(YearLookup, GreaterThanOrEqual):
552.     def get_bound_params(self, start, finish):
553.         return (start,)
554. 
555. 
556. class YearLt(YearLookup, LessThan):
557.     def get_bound_params(self, start, finish):
558.         return (start,)
559. 
560. 
561. class YearLte(YearLookup, LessThanOrEqual):
562.     def get_bound_params(self, start, finish):
563.         return (finish,)
564. 
565. 
566. class UUIDTextMixin:
567.     """
568.     Strip hyphens from a value when filtering a UUIDField on backends without
569.     a native datatype for UUID.
570.     """
571.     def process_rhs(self, qn, connection):
572.         if not connection.features.has_native_uuid_field:
573.             from django.db.models.functions import Replace
574.             if self.rhs_is_direct_value():
575.                 self.rhs = Value(self.rhs)
576.             self.rhs = Replace(self.rhs, Value('-'), Value(''), output_field=CharField())
577.         rhs, params = super().process_rhs(qn, connection)
578.         return rhs, params
579. 
580. 
581. @UUIDField.register_lookup
582. class UUIDIExact(UUIDTextMixin, IExact):
583.     pass
584. 
585. 
586. @UUIDField.register_lookup
587. class UUIDContains(UUIDTextMixin, Contains):
588.     pass
589. 
590. 
591. @UUIDField.register_lookup
592. class UUIDIContains(UUIDTextMixin, IContains):
593.     pass
594. 
595. 
596. @UUIDField.register_lookup
597. class UUIDStartsWith(UUIDTextMixin, StartsWith):
598.     pass
599. 
600. 
601. @UUIDField.register_lookup
602. class UUIDIStartsWith(UUIDTextMixin, IStartsWith):
603.     pass
604. 
605. 
606. @UUIDField.register_lookup
607. class UUIDEndsWith(UUIDTextMixin, EndsWith):
608.     pass
609. 
610. 
611. @UUIDField.register_lookup
612. class UUIDIEndsWith(UUIDTextMixin, IEndsWith):
613.     pass


File: django/db/models/sql/query.py
Line number range: 1 - 500
Content:
1. """
2. Create SQL statements for QuerySets.
3. 
4. The code in here encapsulates all of the SQL construction so that QuerySets
5. themselves do not have to (and could be backed by things other than SQL
6. databases). The abstraction barrier only works one way: this module has to know
7. all about the internals of models in order to get the information it needs.
8. """
9. import copy
10. import difflib
11. import functools
12. import inspect
13. import sys
14. import warnings
15. from collections import Counter, namedtuple
16. from collections.abc import Iterator, Mapping
17. from itertools import chain, count, product
18. from string import ascii_uppercase
19. 
20. from django.core.exceptions import (
21.     EmptyResultSet, FieldDoesNotExist, FieldError,
22. )
23. from django.db import DEFAULT_DB_ALIAS, NotSupportedError, connections
24. from django.db.models.aggregates import Count
25. from django.db.models.constants import LOOKUP_SEP
26. from django.db.models.expressions import (
27.     BaseExpression, Col, F, OuterRef, Ref, SimpleCol,
28. )
29. from django.db.models.fields import Field
30. from django.db.models.fields.related_lookups import MultiColSource
31. from django.db.models.lookups import Lookup
32. from django.db.models.query_utils import (
33.     Q, check_rel_lookup_compatibility, refs_expression,
34. )
35. from django.db.models.sql.constants import (
36.     INNER, LOUTER, ORDER_DIR, ORDER_PATTERN, SINGLE,
37. )
38. from django.db.models.sql.datastructures import (
39.     BaseTable, Empty, Join, MultiJoin,
40. )
41. from django.db.models.sql.where import (
42.     AND, OR, ExtraWhere, NothingNode, WhereNode,
43. )
44. from django.utils.deprecation import RemovedInDjango40Warning
45. from django.utils.functional import cached_property
46. from django.utils.tree import Node
47. 
48. __all__ = ['Query', 'RawQuery']
49. 
50. 
51. def get_field_names_from_opts(opts):
52.     return set(chain.from_iterable(
53.         (f.name, f.attname) if f.concrete else (f.name,)
54.         for f in opts.get_fields()
55.     ))
56. 
57. 
58. def get_children_from_q(q):
59.     for child in q.children:
60.         if isinstance(child, Node):
61.             yield from get_children_from_q(child)
62.         else:
63.             yield child
64. 
65. 
66. JoinInfo = namedtuple(
67.     'JoinInfo',
68.     ('final_field', 'targets', 'opts', 'joins', 'path', 'transform_function')
69. )
70. 
71. 
72. def _get_col(target, field, alias, simple_col):
73.     if simple_col:
74.         return SimpleCol(target, field)
75.     return target.get_col(alias, field)
76. 
77. 
78. class RawQuery:
79.     """A single raw SQL query."""
80. 
81.     def __init__(self, sql, using, params=None):
82.         self.params = params or ()
83.         self.sql = sql
84.         self.using = using
85.         self.cursor = None
86. 
87.         # Mirror some properties of a normal query so that
88.         # the compiler can be used to process results.
89.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
90.         self.extra_select = {}
91.         self.annotation_select = {}
92. 
93.     def chain(self, using):
94.         return self.clone(using)
95. 
96.     def clone(self, using):
97.         return RawQuery(self.sql, using, params=self.params)
98. 
99.     def get_columns(self):
100.         if self.cursor is None:
101.             self._execute_query()
102.         converter = connections[self.using].introspection.identifier_converter
103.         return [converter(column_meta[0])
104.                 for column_meta in self.cursor.description]
105. 
106.     def __iter__(self):
107.         # Always execute a new query for a new iterator.
108.         # This could be optimized with a cache at the expense of RAM.
109.         self._execute_query()
110.         if not connections[self.using].features.can_use_chunked_reads:
111.             # If the database can't use chunked reads we need to make sure we
112.             # evaluate the entire query up front.
113.             result = list(self.cursor)
114.         else:
115.             result = self.cursor
116.         return iter(result)
117. 
118.     def __repr__(self):
119.         return "<%s: %s>" % (self.__class__.__name__, self)
120. 
121.     @property
122.     def params_type(self):
123.         return dict if isinstance(self.params, Mapping) else tuple
124. 
125.     def __str__(self):
126.         return self.sql % self.params_type(self.params)
127. 
128.     def _execute_query(self):
129.         connection = connections[self.using]
130. 
131.         # Adapt parameters to the database, as much as possible considering
132.         # that the target type isn't known. See #17755.
133.         params_type = self.params_type
134.         adapter = connection.ops.adapt_unknown_value
135.         if params_type is tuple:
136.             params = tuple(adapter(val) for val in self.params)
137.         elif params_type is dict:
138.             params = {key: adapter(val) for key, val in self.params.items()}
139.         else:
140.             raise RuntimeError("Unexpected params type: %s" % params_type)
141. 
142.         self.cursor = connection.cursor()
143.         self.cursor.execute(self.sql, params)
144. 
145. 
146. class Query(BaseExpression):
147.     """A single SQL query."""
148. 
149.     alias_prefix = 'T'
150.     subq_aliases = frozenset([alias_prefix])
151. 
152.     compiler = 'SQLCompiler'
153. 
154.     def __init__(self, model, where=WhereNode):
155.         self.model = model
156.         self.alias_refcount = {}
157.         # alias_map is the most important data structure regarding joins.
158.         # It's used for recording which joins exist in the query and what
159.         # types they are. The key is the alias of the joined table (possibly
160.         # the table name) and the value is a Join-like object (see
161.         # sql.datastructures.Join for more information).
162.         self.alias_map = {}
163.         # Sometimes the query contains references to aliases in outer queries (as
164.         # a result of split_exclude). Correct alias quoting needs to know these
165.         # aliases too.
166.         self.external_aliases = set()
167.         self.table_map = {}     # Maps table names to list of aliases.
168.         self.default_cols = True
169.         self.default_ordering = True
170.         self.standard_ordering = True
171.         self.used_aliases = set()
172.         self.filter_is_sticky = False
173.         self.subquery = False
174. 
175.         # SQL-related attributes
176.         # Select and related select clauses are expressions to use in the
177.         # SELECT clause of the query.
178.         # The select is used for cases where we want to set up the select
179.         # clause to contain other than default fields (values(), subqueries...)
180.         # Note that annotations go to annotations dictionary.
181.         self.select = ()
182.         self.where = where()
183.         self.where_class = where
184.         # The group_by attribute can have one of the following forms:
185.         #  - None: no group by at all in the query
186.         #  - A tuple of expressions: group by (at least) those expressions.
187.         #    String refs are also allowed for now.
188.         #  - True: group by all select fields of the model
189.         # See compiler.get_group_by() for details.
190.         self.group_by = None
191.         self.order_by = ()
192.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
193.         self.distinct = False
194.         self.distinct_fields = ()
195.         self.select_for_update = False
196.         self.select_for_update_nowait = False
197.         self.select_for_update_skip_locked = False
198.         self.select_for_update_of = ()
199. 
200.         self.select_related = False
201.         # Arbitrary limit for select_related to prevents infinite recursion.
202.         self.max_depth = 5
203. 
204.         # Holds the selects defined by a call to values() or values_list()
205.         # excluding annotation_select and extra_select.
206.         self.values_select = ()
207. 
208.         # SQL annotation-related attributes
209.         self.annotations = {}  # Maps alias -> Annotation Expression
210.         self.annotation_select_mask = None
211.         self._annotation_select_cache = None
212. 
213.         # Set combination attributes
214.         self.combinator = None
215.         self.combinator_all = False
216.         self.combined_queries = ()
217. 
218.         # These are for extensions. The contents are more or less appended
219.         # verbatim to the appropriate clause.
220.         self.extra = {}  # Maps col_alias -> (col_sql, params).
221.         self.extra_select_mask = None
222.         self._extra_select_cache = None
223. 
224.         self.extra_tables = ()
225.         self.extra_order_by = ()
226. 
227.         # A tuple that is a set of model field names and either True, if these
228.         # are the fields to defer, or False if these are the only fields to
229.         # load.
230.         self.deferred_loading = (frozenset(), True)
231. 
232.         self._filtered_relations = {}
233. 
234.         self.explain_query = False
235.         self.explain_format = None
236.         self.explain_options = {}
237. 
238.     @property
239.     def output_field(self):
240.         if len(self.select) == 1:
241.             return self.select[0].field
242.         elif len(self.annotation_select) == 1:
243.             return next(iter(self.annotation_select.values())).output_field
244. 
245.     @property
246.     def has_select_fields(self):
247.         return bool(self.select or self.annotation_select_mask or self.extra_select_mask)
248. 
249.     @cached_property
250.     def base_table(self):
251.         for alias in self.alias_map:
252.             return alias
253. 
254.     def __str__(self):
255.         """
256.         Return the query as a string of SQL with the parameter values
257.         substituted in (use sql_with_params() to see the unsubstituted string).
258. 
259.         Parameter values won't necessarily be quoted correctly, since that is
260.         done by the database interface at execution time.
261.         """
262.         sql, params = self.sql_with_params()
263.         return sql % params
264. 
265.     def sql_with_params(self):
266.         """
267.         Return the query as an SQL string and the parameters that will be
268.         substituted into the query.
269.         """
270.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
271. 
272.     def __deepcopy__(self, memo):
273.         """Limit the amount of work when a Query is deepcopied."""
274.         result = self.clone()
275.         memo[id(self)] = result
276.         return result
277. 
278.     def get_compiler(self, using=None, connection=None):
279.         if using is None and connection is None:
280.             raise ValueError("Need either using or connection")
281.         if using:
282.             connection = connections[using]
283.         return connection.ops.compiler(self.compiler)(self, connection, using)
284. 
285.     def get_meta(self):
286.         """
287.         Return the Options instance (the model._meta) from which to start
288.         processing. Normally, this is self.model._meta, but it can be changed
289.         by subclasses.
290.         """
291.         return self.model._meta
292. 
293.     def clone(self):
294.         """
295.         Return a copy of the current Query. A lightweight alternative to
296.         to deepcopy().
297.         """
298.         obj = Empty()
299.         obj.__class__ = self.__class__
300.         # Copy references to everything.
301.         obj.__dict__ = self.__dict__.copy()
302.         # Clone attributes that can't use shallow copy.
303.         obj.alias_refcount = self.alias_refcount.copy()
304.         obj.alias_map = self.alias_map.copy()
305.         obj.external_aliases = self.external_aliases.copy()
306.         obj.table_map = self.table_map.copy()
307.         obj.where = self.where.clone()
308.         obj.annotations = self.annotations.copy()
309.         if self.annotation_select_mask is None:
310.             obj.annotation_select_mask = None
311.         else:
312.             obj.annotation_select_mask = self.annotation_select_mask.copy()
313.         # _annotation_select_cache cannot be copied, as doing so breaks the
314.         # (necessary) state in which both annotations and
315.         # _annotation_select_cache point to the same underlying objects.
316.         # It will get re-populated in the cloned queryset the next time it's
317.         # used.
318.         obj._annotation_select_cache = None
319.         obj.extra = self.extra.copy()
320.         if self.extra_select_mask is None:
321.             obj.extra_select_mask = None
322.         else:
323.             obj.extra_select_mask = self.extra_select_mask.copy()
324.         if self._extra_select_cache is None:
325.             obj._extra_select_cache = None
326.         else:
327.             obj._extra_select_cache = self._extra_select_cache.copy()
328.         if self.select_related is not False:
329.             # Use deepcopy because select_related stores fields in nested
330.             # dicts.
331.             obj.select_related = copy.deepcopy(obj.select_related)
332.         if 'subq_aliases' in self.__dict__:
333.             obj.subq_aliases = self.subq_aliases.copy()
334.         obj.used_aliases = self.used_aliases.copy()
335.         obj._filtered_relations = self._filtered_relations.copy()
336.         # Clear the cached_property
337.         try:
338.             del obj.base_table
339.         except AttributeError:
340.             pass
341.         return obj
342. 
343.     def chain(self, klass=None):
344.         """
345.         Return a copy of the current Query that's ready for another operation.
346.         The klass argument changes the type of the Query, e.g. UpdateQuery.
347.         """
348.         obj = self.clone()
349.         if klass and obj.__class__ != klass:
350.             obj.__class__ = klass
351.         if not obj.filter_is_sticky:
352.             obj.used_aliases = set()
353.         obj.filter_is_sticky = False
354.         if hasattr(obj, '_setup_query'):
355.             obj._setup_query()
356.         return obj
357. 
358.     def relabeled_clone(self, change_map):
359.         clone = self.clone()
360.         clone.change_aliases(change_map)
361.         return clone
362. 
363.     def rewrite_cols(self, annotation, col_cnt):
364.         # We must make sure the inner query has the referred columns in it.
365.         # If we are aggregating over an annotation, then Django uses Ref()
366.         # instances to note this. However, if we are annotating over a column
367.         # of a related model, then it might be that column isn't part of the
368.         # SELECT clause of the inner query, and we must manually make sure
369.         # the column is selected. An example case is:
370.         #    .aggregate(Sum('author__awards'))
371.         # Resolving this expression results in a join to author, but there
372.         # is no guarantee the awards column of author is in the select clause
373.         # of the query. Thus we must manually add the column to the inner
374.         # query.
375.         orig_exprs = annotation.get_source_expressions()
376.         new_exprs = []
377.         for expr in orig_exprs:
378.             # FIXME: These conditions are fairly arbitrary. Identify a better
379.             # method of having expressions decide which code path they should
380.             # take.
381.             if isinstance(expr, Ref):
382.                 # Its already a Ref to subquery (see resolve_ref() for
383.                 # details)
384.                 new_exprs.append(expr)
385.             elif isinstance(expr, (WhereNode, Lookup)):
386.                 # Decompose the subexpressions further. The code here is
387.                 # copied from the else clause, but this condition must appear
388.                 # before the contains_aggregate/is_summary condition below.
389.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
390.                 new_exprs.append(new_expr)
391.             else:
392.                 # Reuse aliases of expressions already selected in subquery.
393.                 for col_alias, selected_annotation in self.annotation_select.items():
394.                     if selected_annotation == expr:
395.                         new_expr = Ref(col_alias, expr)
396.                         break
397.                 else:
398.                     # An expression that is not selected the subquery.
399.                     if isinstance(expr, Col) or (expr.contains_aggregate and not expr.is_summary):
400.                         # Reference column or another aggregate. Select it
401.                         # under a non-conflicting alias.
402.                         col_cnt += 1
403.                         col_alias = '__col%d' % col_cnt
404.                         self.annotations[col_alias] = expr
405.                         self.append_annotation_mask([col_alias])
406.                         new_expr = Ref(col_alias, expr)
407.                     else:
408.                         # Some other expression not referencing database values
409.                         # directly. Its subexpression might contain Cols.
410.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
411.                 new_exprs.append(new_expr)
412.         annotation.set_source_expressions(new_exprs)
413.         return annotation, col_cnt
414. 
415.     def get_aggregation(self, using, added_aggregate_names):
416.         """
417.         Return the dictionary with the values of the existing aggregations.
418.         """
419.         if not self.annotation_select:
420.             return {}
421.         existing_annotations = [
422.             annotation for alias, annotation
423.             in self.annotations.items()
424.             if alias not in added_aggregate_names
425.         ]
426.         # Decide if we need to use a subquery.
427.         #
428.         # Existing annotations would cause incorrect results as get_aggregation()
429.         # must produce just one result and thus must not use GROUP BY. But we
430.         # aren't smart enough to remove the existing annotations from the
431.         # query, so those would force us to use GROUP BY.
432.         #
433.         # If the query has limit or distinct, or uses set operations, then
434.         # those operations must be done in a subquery so that the query
435.         # aggregates on the limit and/or distinct results instead of applying
436.         # the distinct and limit after the aggregation.
437.         if (isinstance(self.group_by, tuple) or self.is_sliced or existing_annotations or
438.                 self.distinct or self.combinator):
439.             from django.db.models.sql.subqueries import AggregateQuery
440.             outer_query = AggregateQuery(self.model)
441.             inner_query = self.clone()
442.             inner_query.select_for_update = False
443.             inner_query.select_related = False
444.             inner_query.set_annotation_mask(self.annotation_select)
445.             if not self.is_sliced and not self.distinct_fields:
446.                 # Queries with distinct_fields need ordering and when a limit
447.                 # is applied we must take the slice from the ordered query.
448.                 # Otherwise no need for ordering.
449.                 inner_query.clear_ordering(True)
450.             if not inner_query.distinct:
451.                 # If the inner query uses default select and it has some
452.                 # aggregate annotations, then we must make sure the inner
453.                 # query is grouped by the main model's primary key. However,
454.                 # clearing the select clause can alter results if distinct is
455.                 # used.
456.                 has_existing_aggregate_annotations = any(
457.                     annotation for annotation in existing_annotations
458.                     if getattr(annotation, 'contains_aggregate', True)
459.                 )
460.                 if inner_query.default_cols and has_existing_aggregate_annotations:
461.                     inner_query.group_by = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
462.                 inner_query.default_cols = False
463. 
464.             relabels = {t: 'subquery' for t in inner_query.alias_map}
465.             relabels[None] = 'subquery'
466.             # Remove any aggregates marked for reduction from the subquery
467.             # and move them to the outer AggregateQuery.
468.             col_cnt = 0
469.             for alias, expression in list(inner_query.annotation_select.items()):
470.                 annotation_select_mask = inner_query.annotation_select_mask
471.                 if expression.is_summary:
472.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
473.                     outer_query.annotations[alias] = expression.relabeled_clone(relabels)
474.                     del inner_query.annotations[alias]
475.                     annotation_select_mask.remove(alias)
476.                 # Make sure the annotation_select wont use cached results.
477.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
478.             if inner_query.select == () and not inner_query.default_cols and not inner_query.annotation_select_mask:
479.                 # In case of Model.objects[0:3].count(), there would be no
480.                 # field selected in the inner query, yet we must use a subquery.
481.                 # So, make sure at least one field is selected.
482.                 inner_query.select = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
483.             try:
484.                 outer_query.add_subquery(inner_query, using)
485.             except EmptyResultSet:
486.                 return {
487.                     alias: None
488.                     for alias in outer_query.annotation_select
489.                 }
490.         else:
491.             outer_query = self
492.             self.select = ()
493.             self.default_cols = False
494.             self.extra = {}
495. 
496.         outer_query.clear_ordering(True)
497.         outer_query.clear_limits()
498.         outer_query.select_for_update = False
499.         outer_query.select_related = False
500.         compiler = outer_query.get_compiler(using)


File: django/db/models/sql/query.py
Line number range: 146 - 2245
Content:
146. class Query(BaseExpression):
147.     """A single SQL query."""
148. 
149.     alias_prefix = 'T'
150.     subq_aliases = frozenset([alias_prefix])
151. 
152.     compiler = 'SQLCompiler'
153. 
154.     def __init__(self, model, where=WhereNode):
155.         self.model = model
156.         self.alias_refcount = {}
157.         # alias_map is the most important data structure regarding joins.
158.         # It's used for recording which joins exist in the query and what
159.         # types they are. The key is the alias of the joined table (possibly
160.         # the table name) and the value is a Join-like object (see
161.         # sql.datastructures.Join for more information).
162.         self.alias_map = {}
163.         # Sometimes the query contains references to aliases in outer queries (as
164.         # a result of split_exclude). Correct alias quoting needs to know these
165.         # aliases too.
166.         self.external_aliases = set()
167.         self.table_map = {}     # Maps table names to list of aliases.
168.         self.default_cols = True
169.         self.default_ordering = True
170.         self.standard_ordering = True
171.         self.used_aliases = set()
172.         self.filter_is_sticky = False
173.         self.subquery = False
174. 
175.         # SQL-related attributes
176.         # Select and related select clauses are expressions to use in the
177.         # SELECT clause of the query.
178.         # The select is used for cases where we want to set up the select
179.         # clause to contain other than default fields (values(), subqueries...)
180.         # Note that annotations go to annotations dictionary.
181.         self.select = ()
182.         self.where = where()
183.         self.where_class = where
184.         # The group_by attribute can have one of the following forms:
185.         #  - None: no group by at all in the query
186.         #  - A tuple of expressions: group by (at least) those expressions.
187.         #    String refs are also allowed for now.
188.         #  - True: group by all select fields of the model
189.         # See compiler.get_group_by() for details.
190.         self.group_by = None
191.         self.order_by = ()
192.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
193.         self.distinct = False
194.         self.distinct_fields = ()
195.         self.select_for_update = False
196.         self.select_for_update_nowait = False
197.         self.select_for_update_skip_locked = False
198.         self.select_for_update_of = ()
199. 
200.         self.select_related = False
201.         # Arbitrary limit for select_related to prevents infinite recursion.
202.         self.max_depth = 5
203. 
204.         # Holds the selects defined by a call to values() or values_list()
205.         # excluding annotation_select and extra_select.
206.         self.values_select = ()
207. 
208.         # SQL annotation-related attributes
209.         self.annotations = {}  # Maps alias -> Annotation Expression
210.         self.annotation_select_mask = None
211.         self._annotation_select_cache = None
212. 
213.         # Set combination attributes
214.         self.combinator = None
215.         self.combinator_all = False
216.         self.combined_queries = ()
217. 
218.         # These are for extensions. The contents are more or less appended
219.         # verbatim to the appropriate clause.
220.         self.extra = {}  # Maps col_alias -> (col_sql, params).
221.         self.extra_select_mask = None
222.         self._extra_select_cache = None
223. 
224.         self.extra_tables = ()
225.         self.extra_order_by = ()
226. 
227.         # A tuple that is a set of model field names and either True, if these
228.         # are the fields to defer, or False if these are the only fields to
229.         # load.
230.         self.deferred_loading = (frozenset(), True)
231. 
232.         self._filtered_relations = {}
233. 
234.         self.explain_query = False
235.         self.explain_format = None
236.         self.explain_options = {}
237. 
238.     @property
239.     def output_field(self):
240.         if len(self.select) == 1:
241.             return self.select[0].field
242.         elif len(self.annotation_select) == 1:
243.             return next(iter(self.annotation_select.values())).output_field
244. 
245.     @property
246.     def has_select_fields(self):
247.         return bool(self.select or self.annotation_select_mask or self.extra_select_mask)
248. 
249.     @cached_property
250.     def base_table(self):
251.         for alias in self.alias_map:
252.             return alias
253. 
254.     def __str__(self):
255.         """
256.         Return the query as a string of SQL with the parameter values
257.         substituted in (use sql_with_params() to see the unsubstituted string).
258. 
259.         Parameter values won't necessarily be quoted correctly, since that is
260.         done by the database interface at execution time.
261.         """
262.         sql, params = self.sql_with_params()
263.         return sql % params
264. 
265.     def sql_with_params(self):
266.         """
267.         Return the query as an SQL string and the parameters that will be
268.         substituted into the query.
269.         """
270.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
271. 
272.     def __deepcopy__(self, memo):
273.         """Limit the amount of work when a Query is deepcopied."""
274.         result = self.clone()
275.         memo[id(self)] = result
276.         return result
277. 
278.     def get_compiler(self, using=None, connection=None):
279.         if using is None and connection is None:
280.             raise ValueError("Need either using or connection")
281.         if using:
282.             connection = connections[using]
283.         return connection.ops.compiler(self.compiler)(self, connection, using)
284. 
285.     def get_meta(self):
286.         """
287.         Return the Options instance (the model._meta) from which to start
288.         processing. Normally, this is self.model._meta, but it can be changed
289.         by subclasses.
290.         """
291.         return self.model._meta
292. 
293.     def clone(self):
294.         """
295.         Return a copy of the current Query. A lightweight alternative to
296.         to deepcopy().
297.         """
298.         obj = Empty()
299.         obj.__class__ = self.__class__
300.         # Copy references to everything.
301.         obj.__dict__ = self.__dict__.copy()
302.         # Clone attributes that can't use shallow copy.
303.         obj.alias_refcount = self.alias_refcount.copy()
304.         obj.alias_map = self.alias_map.copy()
305.         obj.external_aliases = self.external_aliases.copy()
306.         obj.table_map = self.table_map.copy()
307.         obj.where = self.where.clone()
308.         obj.annotations = self.annotations.copy()
309.         if self.annotation_select_mask is None:
310.             obj.annotation_select_mask = None
311.         else:
312.             obj.annotation_select_mask = self.annotation_select_mask.copy()
313.         # _annotation_select_cache cannot be copied, as doing so breaks the
314.         # (necessary) state in which both annotations and
315.         # _annotation_select_cache point to the same underlying objects.
316.         # It will get re-populated in the cloned queryset the next time it's
317.         # used.
318.         obj._annotation_select_cache = None
319.         obj.extra = self.extra.copy()
320.         if self.extra_select_mask is None:
321.             obj.extra_select_mask = None
322.         else:
323.             obj.extra_select_mask = self.extra_select_mask.copy()
324.         if self._extra_select_cache is None:
325.             obj._extra_select_cache = None
326.         else:
327.             obj._extra_select_cache = self._extra_select_cache.copy()
328.         if self.select_related is not False:
329.             # Use deepcopy because select_related stores fields in nested
330.             # dicts.
331.             obj.select_related = copy.deepcopy(obj.select_related)
332.         if 'subq_aliases' in self.__dict__:
333.             obj.subq_aliases = self.subq_aliases.copy()
334.         obj.used_aliases = self.used_aliases.copy()
335.         obj._filtered_relations = self._filtered_relations.copy()
336.         # Clear the cached_property
337.         try:
338.             del obj.base_table
339.         except AttributeError:
340.             pass
341.         return obj
342. 
343.     def chain(self, klass=None):
344.         """
345.         Return a copy of the current Query that's ready for another operation.
346.         The klass argument changes the type of the Query, e.g. UpdateQuery.
347.         """
348.         obj = self.clone()
349.         if klass and obj.__class__ != klass:
350.             obj.__class__ = klass
351.         if not obj.filter_is_sticky:
352.             obj.used_aliases = set()
353.         obj.filter_is_sticky = False
354.         if hasattr(obj, '_setup_query'):
355.             obj._setup_query()
356.         return obj
357. 
358.     def relabeled_clone(self, change_map):
359.         clone = self.clone()
360.         clone.change_aliases(change_map)
361.         return clone
362. 
363.     def rewrite_cols(self, annotation, col_cnt):
364.         # We must make sure the inner query has the referred columns in it.
365.         # If we are aggregating over an annotation, then Django uses Ref()
366.         # instances to note this. However, if we are annotating over a column
367.         # of a related model, then it might be that column isn't part of the
368.         # SELECT clause of the inner query, and we must manually make sure
369.         # the column is selected. An example case is:
370.         #    .aggregate(Sum('author__awards'))
371.         # Resolving this expression results in a join to author, but there
372.         # is no guarantee the awards column of author is in the select clause
373.         # of the query. Thus we must manually add the column to the inner
374.         # query.
375.         orig_exprs = annotation.get_source_expressions()
376.         new_exprs = []
377.         for expr in orig_exprs:
378.             # FIXME: These conditions are fairly arbitrary. Identify a better
379.             # method of having expressions decide which code path they should
380.             # take.
381.             if isinstance(expr, Ref):
382.                 # Its already a Ref to subquery (see resolve_ref() for
383.                 # details)
384.                 new_exprs.append(expr)
385.             elif isinstance(expr, (WhereNode, Lookup)):
386.                 # Decompose the subexpressions further. The code here is
387.                 # copied from the else clause, but this condition must appear
388.                 # before the contains_aggregate/is_summary condition below.
389.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
390.                 new_exprs.append(new_expr)
391.             else:
392.                 # Reuse aliases of expressions already selected in subquery.
393.                 for col_alias, selected_annotation in self.annotation_select.items():
394.                     if selected_annotation == expr:
395.                         new_expr = Ref(col_alias, expr)
396.                         break
397.                 else:
398.                     # An expression that is not selected the subquery.
399.                     if isinstance(expr, Col) or (expr.contains_aggregate and not expr.is_summary):
400.                         # Reference column or another aggregate. Select it
401.                         # under a non-conflicting alias.
402.                         col_cnt += 1
403.                         col_alias = '__col%d' % col_cnt
404.                         self.annotations[col_alias] = expr
405.                         self.append_annotation_mask([col_alias])
406.                         new_expr = Ref(col_alias, expr)
407.                     else:
408.                         # Some other expression not referencing database values
409.                         # directly. Its subexpression might contain Cols.
410.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
411.                 new_exprs.append(new_expr)
412.         annotation.set_source_expressions(new_exprs)
413.         return annotation, col_cnt
414. 
415.     def get_aggregation(self, using, added_aggregate_names):
416.         """
417.         Return the dictionary with the values of the existing aggregations.
418.         """
419.         if not self.annotation_select:
420.             return {}
421.         existing_annotations = [
422.             annotation for alias, annotation
423.             in self.annotations.items()
424.             if alias not in added_aggregate_names
425.         ]
426.         # Decide if we need to use a subquery.
427.         #
428.         # Existing annotations would cause incorrect results as get_aggregation()
429.         # must produce just one result and thus must not use GROUP BY. But we
430.         # aren't smart enough to remove the existing annotations from the
431.         # query, so those would force us to use GROUP BY.
432.         #
433.         # If the query has limit or distinct, or uses set operations, then
434.         # those operations must be done in a subquery so that the query
435.         # aggregates on the limit and/or distinct results instead of applying
436.         # the distinct and limit after the aggregation.
437.         if (isinstance(self.group_by, tuple) or self.is_sliced or existing_annotations or
438.                 self.distinct or self.combinator):
439.             from django.db.models.sql.subqueries import AggregateQuery
440.             outer_query = AggregateQuery(self.model)
441.             inner_query = self.clone()
442.             inner_query.select_for_update = False
443.             inner_query.select_related = False
444.             inner_query.set_annotation_mask(self.annotation_select)
445.             if not self.is_sliced and not self.distinct_fields:
446.                 # Queries with distinct_fields need ordering and when a limit
447.                 # is applied we must take the slice from the ordered query.
448.                 # Otherwise no need for ordering.
449.                 inner_query.clear_ordering(True)
450.             if not inner_query.distinct:
451.                 # If the inner query uses default select and it has some
452.                 # aggregate annotations, then we must make sure the inner
453.                 # query is grouped by the main model's primary key. However,
454.                 # clearing the select clause can alter results if distinct is
455.                 # used.
456.                 has_existing_aggregate_annotations = any(
457.                     annotation for annotation in existing_annotations
458.                     if getattr(annotation, 'contains_aggregate', True)
459.                 )
460.                 if inner_query.default_cols and has_existing_aggregate_annotations:
461.                     inner_query.group_by = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
462.                 inner_query.default_cols = False
463. 
464.             relabels = {t: 'subquery' for t in inner_query.alias_map}
465.             relabels[None] = 'subquery'
466.             # Remove any aggregates marked for reduction from the subquery
467.             # and move them to the outer AggregateQuery.
468.             col_cnt = 0
469.             for alias, expression in list(inner_query.annotation_select.items()):
470.                 annotation_select_mask = inner_query.annotation_select_mask
471.                 if expression.is_summary:
472.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
473.                     outer_query.annotations[alias] = expression.relabeled_clone(relabels)
474.                     del inner_query.annotations[alias]
475.                     annotation_select_mask.remove(alias)
476.                 # Make sure the annotation_select wont use cached results.
477.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
478.             if inner_query.select == () and not inner_query.default_cols and not inner_query.annotation_select_mask:
479.                 # In case of Model.objects[0:3].count(), there would be no
480.                 # field selected in the inner query, yet we must use a subquery.
481.                 # So, make sure at least one field is selected.
482.                 inner_query.select = (self.model._meta.pk.get_col(inner_query.get_initial_alias()),)
483.             try:
484.                 outer_query.add_subquery(inner_query, using)
485.             except EmptyResultSet:
486.                 return {
487.                     alias: None
488.                     for alias in outer_query.annotation_select
489.                 }
490.         else:
491.             outer_query = self
492.             self.select = ()
493.             self.default_cols = False
494.             self.extra = {}
495. 
496.         outer_query.clear_ordering(True)
497.         outer_query.clear_limits()
498.         outer_query.select_for_update = False
499.         outer_query.select_related = False
500.         compiler = outer_query.get_compiler(using)
501.         result = compiler.execute_sql(SINGLE)
502.         if result is None:
503.             result = [None] * len(outer_query.annotation_select)
504. 
505.         converters = compiler.get_converters(outer_query.annotation_select.values())
506.         result = next(compiler.apply_converters((result,), converters))
507. 
508.         return dict(zip(outer_query.annotation_select, result))
509. 
510.     def get_count(self, using):
511.         """
512.         Perform a COUNT() query using the current filter constraints.
513.         """
514.         obj = self.clone()
515.         obj.add_annotation(Count('*'), alias='__count', is_summary=True)
516.         number = obj.get_aggregation(using, ['__count'])['__count']
517.         if number is None:
518.             number = 0
519.         return number
520. 
521.     def has_filters(self):
522.         return self.where
523. 
524.     def has_results(self, using):
525.         q = self.clone()
526.         if not q.distinct:
527.             if q.group_by is True:
528.                 q.add_fields((f.attname for f in self.model._meta.concrete_fields), False)
529.                 q.set_group_by()
530.             q.clear_select_clause()
531.         q.clear_ordering(True)
532.         q.set_limits(high=1)
533.         compiler = q.get_compiler(using=using)
534.         return compiler.has_results()
535. 
536.     def explain(self, using, format=None, **options):
537.         q = self.clone()
538.         q.explain_query = True
539.         q.explain_format = format
540.         q.explain_options = options
541.         compiler = q.get_compiler(using=using)
542.         return '\n'.join(compiler.explain_query())
543. 
544.     def combine(self, rhs, connector):
545.         """
546.         Merge the 'rhs' query into the current one (with any 'rhs' effects
547.         being applied *after* (that is, "to the right of") anything in the
548.         current query. 'rhs' is not modified during a call to this function.
549. 
550.         The 'connector' parameter describes how to connect filters from the
551.         'rhs' query.
552.         """
553.         assert self.model == rhs.model, \
554.             "Cannot combine queries on two different base models."
555.         assert not self.is_sliced, \
556.             "Cannot combine queries once a slice has been taken."
557.         assert self.distinct == rhs.distinct, \
558.             "Cannot combine a unique query with a non-unique query."
559.         assert self.distinct_fields == rhs.distinct_fields, \
560.             "Cannot combine queries with different distinct fields."
561. 
562.         # Work out how to relabel the rhs aliases, if necessary.
563.         change_map = {}
564.         conjunction = (connector == AND)
565. 
566.         # Determine which existing joins can be reused. When combining the
567.         # query with AND we must recreate all joins for m2m filters. When
568.         # combining with OR we can reuse joins. The reason is that in AND
569.         # case a single row can't fulfill a condition like:
570.         #     revrel__col=1 & revrel__col=2
571.         # But, there might be two different related rows matching this
572.         # condition. In OR case a single True is enough, so single row is
573.         # enough, too.
574.         #
575.         # Note that we will be creating duplicate joins for non-m2m joins in
576.         # the AND case. The results will be correct but this creates too many
577.         # joins. This is something that could be fixed later on.
578.         reuse = set() if conjunction else set(self.alias_map)
579.         # Base table must be present in the query - this is the same
580.         # table on both sides.
581.         self.get_initial_alias()
582.         joinpromoter = JoinPromoter(connector, 2, False)
583.         joinpromoter.add_votes(
584.             j for j in self.alias_map if self.alias_map[j].join_type == INNER)
585.         rhs_votes = set()
586.         # Now, add the joins from rhs query into the new query (skipping base
587.         # table).
588.         rhs_tables = list(rhs.alias_map)[1:]
589.         for alias in rhs_tables:
590.             join = rhs.alias_map[alias]
591.             # If the left side of the join was already relabeled, use the
592.             # updated alias.
593.             join = join.relabeled_clone(change_map)
594.             new_alias = self.join(join, reuse=reuse)
595.             if join.join_type == INNER:
596.                 rhs_votes.add(new_alias)
597.             # We can't reuse the same join again in the query. If we have two
598.             # distinct joins for the same connection in rhs query, then the
599.             # combined query must have two joins, too.
600.             reuse.discard(new_alias)
601.             if alias != new_alias:
602.                 change_map[alias] = new_alias
603.             if not rhs.alias_refcount[alias]:
604.                 # The alias was unused in the rhs query. Unref it so that it
605.                 # will be unused in the new query, too. We have to add and
606.                 # unref the alias so that join promotion has information of
607.                 # the join type for the unused alias.
608.                 self.unref_alias(new_alias)
609.         joinpromoter.add_votes(rhs_votes)
610.         joinpromoter.update_join_types(self)
611. 
612.         # Now relabel a copy of the rhs where-clause and add it to the current
613.         # one.
614.         w = rhs.where.clone()
615.         w.relabel_aliases(change_map)
616.         self.where.add(w, connector)
617. 
618.         # Selection columns and extra extensions are those provided by 'rhs'.
619.         if rhs.select:
620.             self.set_select([col.relabeled_clone(change_map) for col in rhs.select])
621.         else:
622.             self.select = ()
623. 
624.         if connector == OR:
625.             # It would be nice to be able to handle this, but the queries don't
626.             # really make sense (or return consistent value sets). Not worth
627.             # the extra complexity when you can write a real query instead.
628.             if self.extra and rhs.extra:
629.                 raise ValueError("When merging querysets using 'or', you cannot have extra(select=...) on both sides.")
630.         self.extra.update(rhs.extra)
631.         extra_select_mask = set()
632.         if self.extra_select_mask is not None:
633.             extra_select_mask.update(self.extra_select_mask)
634.         if rhs.extra_select_mask is not None:
635.             extra_select_mask.update(rhs.extra_select_mask)
636.         if extra_select_mask:
637.             self.set_extra_mask(extra_select_mask)
638.         self.extra_tables += rhs.extra_tables
639. 
640.         # Ordering uses the 'rhs' ordering, unless it has none, in which case
641.         # the current ordering is used.
642.         self.order_by = rhs.order_by or self.order_by
643.         self.extra_order_by = rhs.extra_order_by or self.extra_order_by
644. 
645.     def deferred_to_data(self, target, callback):
646.         """
647.         Convert the self.deferred_loading data structure to an alternate data
648.         structure, describing the field that *will* be loaded. This is used to
649.         compute the columns to select from the database and also by the
650.         QuerySet class to work out which fields are being initialized on each
651.         model. Models that have all their fields included aren't mentioned in
652.         the result, only those that have field restrictions in place.
653. 
654.         The "target" parameter is the instance that is populated (in place).
655.         The "callback" is a function that is called whenever a (model, field)
656.         pair need to be added to "target". It accepts three parameters:
657.         "target", and the model and list of fields being added for that model.
658.         """
659.         field_names, defer = self.deferred_loading
660.         if not field_names:
661.             return
662.         orig_opts = self.get_meta()
663.         seen = {}
664.         must_include = {orig_opts.concrete_model: {orig_opts.pk}}
665.         for field_name in field_names:
666.             parts = field_name.split(LOOKUP_SEP)
667.             cur_model = self.model._meta.concrete_model
668.             opts = orig_opts
669.             for name in parts[:-1]:
670.                 old_model = cur_model
671.                 if name in self._filtered_relations:
672.                     name = self._filtered_relations[name].relation_name
673.                 source = opts.get_field(name)
674.                 if is_reverse_o2o(source):
675.                     cur_model = source.related_model
676.                 else:
677.                     cur_model = source.remote_field.model
678.                 opts = cur_model._meta
679.                 # Even if we're "just passing through" this model, we must add
680.                 # both the current model's pk and the related reference field
681.                 # (if it's not a reverse relation) to the things we select.
682.                 if not is_reverse_o2o(source):
683.                     must_include[old_model].add(source)
684.                 add_to_dict(must_include, cur_model, opts.pk)
685.             field = opts.get_field(parts[-1])
686.             is_reverse_object = field.auto_created and not field.concrete
687.             model = field.related_model if is_reverse_object else field.model
688.             model = model._meta.concrete_model
689.             if model == opts.model:
690.                 model = cur_model
691.             if not is_reverse_o2o(field):
692.                 add_to_dict(seen, model, field)
693. 
694.         if defer:
695.             # We need to load all fields for each model, except those that
696.             # appear in "seen" (for all models that appear in "seen"). The only
697.             # slight complexity here is handling fields that exist on parent
698.             # models.
699.             workset = {}
700.             for model, values in seen.items():
701.                 for field in model._meta.local_fields:
702.                     if field not in values:
703.                         m = field.model._meta.concrete_model
704.                         add_to_dict(workset, m, field)
705.             for model, values in must_include.items():
706.                 # If we haven't included a model in workset, we don't add the
707.                 # corresponding must_include fields for that model, since an
708.                 # empty set means "include all fields". That's why there's no
709.                 # "else" branch here.
710.                 if model in workset:
711.                     workset[model].update(values)
712.             for model, values in workset.items():
713.                 callback(target, model, values)
714.         else:
715.             for model, values in must_include.items():
716.                 if model in seen:
717.                     seen[model].update(values)
718.                 else:
719.                     # As we've passed through this model, but not explicitly
720.                     # included any fields, we have to make sure it's mentioned
721.                     # so that only the "must include" fields are pulled in.
722.                     seen[model] = values
723.             # Now ensure that every model in the inheritance chain is mentioned
724.             # in the parent list. Again, it must be mentioned to ensure that
725.             # only "must include" fields are pulled in.
726.             for model in orig_opts.get_parent_list():
727.                 seen.setdefault(model, set())
728.             for model, values in seen.items():
729.                 callback(target, model, values)
730. 
731.     def table_alias(self, table_name, create=False, filtered_relation=None):
732.         """
733.         Return a table alias for the given table_name and whether this is a
734.         new alias or not.
735. 
736.         If 'create' is true, a new alias is always created. Otherwise, the
737.         most recently created alias for the table (if one exists) is reused.
738.         """
739.         alias_list = self.table_map.get(table_name)
740.         if not create and alias_list:
741.             alias = alias_list[0]
742.             self.alias_refcount[alias] += 1
743.             return alias, False
744. 
745.         # Create a new alias for this table.
746.         if alias_list:
747.             alias = '%s%d' % (self.alias_prefix, len(self.alias_map) + 1)
748.             alias_list.append(alias)
749.         else:
750.             # The first occurrence of a table uses the table name directly.
751.             alias = filtered_relation.alias if filtered_relation is not None else table_name
752.             self.table_map[table_name] = [alias]
753.         self.alias_refcount[alias] = 1
754.         return alias, True
755. 
756.     def ref_alias(self, alias):
757.         """Increases the reference count for this alias."""
758.         self.alias_refcount[alias] += 1
759. 
760.     def unref_alias(self, alias, amount=1):
761.         """Decreases the reference count for this alias."""
762.         self.alias_refcount[alias] -= amount
763. 
764.     def promote_joins(self, aliases):
765.         """
766.         Promote recursively the join type of given aliases and its children to
767.         an outer join. If 'unconditional' is False, only promote the join if
768.         it is nullable or the parent join is an outer join.
769. 
770.         The children promotion is done to avoid join chains that contain a LOUTER
771.         b INNER c. So, if we have currently a INNER b INNER c and a->b is promoted,
772.         then we must also promote b->c automatically, or otherwise the promotion
773.         of a->b doesn't actually change anything in the query results.
774.         """
775.         aliases = list(aliases)
776.         while aliases:
777.             alias = aliases.pop(0)
778.             if self.alias_map[alias].join_type is None:
779.                 # This is the base table (first FROM entry) - this table
780.                 # isn't really joined at all in the query, so we should not
781.                 # alter its join type.
782.                 continue
783.             # Only the first alias (skipped above) should have None join_type
784.             assert self.alias_map[alias].join_type is not None
785.             parent_alias = self.alias_map[alias].parent_alias
786.             parent_louter = parent_alias and self.alias_map[parent_alias].join_type == LOUTER
787.             already_louter = self.alias_map[alias].join_type == LOUTER
788.             if ((self.alias_map[alias].nullable or parent_louter) and
789.                     not already_louter):
790.                 self.alias_map[alias] = self.alias_map[alias].promote()
791.                 # Join type of 'alias' changed, so re-examine all aliases that
792.                 # refer to this one.
793.                 aliases.extend(
794.                     join for join in self.alias_map
795.                     if self.alias_map[join].parent_alias == alias and join not in aliases
796.                 )
797. 
798.     def demote_joins(self, aliases):
799.         """
800.         Change join type from LOUTER to INNER for all joins in aliases.
801. 
802.         Similarly to promote_joins(), this method must ensure no join chains
803.         containing first an outer, then an inner join are generated. If we
804.         are demoting b->c join in chain a LOUTER b LOUTER c then we must
805.         demote a->b automatically, or otherwise the demotion of b->c doesn't
806.         actually change anything in the query results. .
807.         """
808.         aliases = list(aliases)
809.         while aliases:
810.             alias = aliases.pop(0)
811.             if self.alias_map[alias].join_type == LOUTER:
812.                 self.alias_map[alias] = self.alias_map[alias].demote()
813.                 parent_alias = self.alias_map[alias].parent_alias
814.                 if self.alias_map[parent_alias].join_type == INNER:
815.                     aliases.append(parent_alias)
816. 
817.     def reset_refcounts(self, to_counts):
818.         """
819.         Reset reference counts for aliases so that they match the value passed
820.         in `to_counts`.
821.         """
822.         for alias, cur_refcount in self.alias_refcount.copy().items():
823.             unref_amount = cur_refcount - to_counts.get(alias, 0)
824.             self.unref_alias(alias, unref_amount)
825. 
826.     def change_aliases(self, change_map):
827.         """
828.         Change the aliases in change_map (which maps old-alias -> new-alias),
829.         relabelling any references to them in select columns and the where
830.         clause.
831.         """
832.         assert set(change_map).isdisjoint(change_map.values())
833. 
834.         # 1. Update references in "select" (normal columns plus aliases),
835.         # "group by" and "where".
836.         self.where.relabel_aliases(change_map)
837.         if isinstance(self.group_by, tuple):
838.             self.group_by = tuple([col.relabeled_clone(change_map) for col in self.group_by])
839.         self.select = tuple([col.relabeled_clone(change_map) for col in self.select])
840.         self.annotations = self.annotations and {
841.             key: col.relabeled_clone(change_map) for key, col in self.annotations.items()
842.         }
843. 
844.         # 2. Rename the alias in the internal table/alias datastructures.
845.         for old_alias, new_alias in change_map.items():
846.             if old_alias not in self.alias_map:
847.                 continue
848.             alias_data = self.alias_map[old_alias].relabeled_clone(change_map)
849.             self.alias_map[new_alias] = alias_data
850.             self.alias_refcount[new_alias] = self.alias_refcount[old_alias]
851.             del self.alias_refcount[old_alias]
852.             del self.alias_map[old_alias]
853. 
854.             table_aliases = self.table_map[alias_data.table_name]
855.             for pos, alias in enumerate(table_aliases):
856.                 if alias == old_alias:
857.                     table_aliases[pos] = new_alias
858.                     break
859.         self.external_aliases = {change_map.get(alias, alias)
860.                                  for alias in self.external_aliases}
861. 
862.     def bump_prefix(self, outer_query):
863.         """
864.         Change the alias prefix to the next letter in the alphabet in a way
865.         that the outer query's aliases and this query's aliases will not
866.         conflict. Even tables that previously had no alias will get an alias
867.         after this call.
868.         """
869.         def prefix_gen():
870.             """
871.             Generate a sequence of characters in alphabetical order:
872.                 -> 'A', 'B', 'C', ...
873. 
874.             When the alphabet is finished, the sequence will continue with the
875.             Cartesian product:
876.                 -> 'AA', 'AB', 'AC', ...
877.             """
878.             alphabet = ascii_uppercase
879.             prefix = chr(ord(self.alias_prefix) + 1)
880.             yield prefix
881.             for n in count(1):
882.                 seq = alphabet[alphabet.index(prefix):] if prefix else alphabet
883.                 for s in product(seq, repeat=n):
884.                     yield ''.join(s)
885.                 prefix = None
886. 
887.         if self.alias_prefix != outer_query.alias_prefix:
888.             # No clashes between self and outer query should be possible.
889.             return
890. 
891.         # Explicitly avoid infinite loop. The constant divider is based on how
892.         # much depth recursive subquery references add to the stack. This value
893.         # might need to be adjusted when adding or removing function calls from
894.         # the code path in charge of performing these operations.
895.         local_recursion_limit = sys.getrecursionlimit() // 16
896.         for pos, prefix in enumerate(prefix_gen()):
897.             if prefix not in self.subq_aliases:
898.                 self.alias_prefix = prefix
899.                 break
900.             if pos > local_recursion_limit:
901.                 raise RecursionError(
902.                     'Maximum recursion depth exceeded: too many subqueries.'
903.                 )
904.         self.subq_aliases = self.subq_aliases.union([self.alias_prefix])
905.         outer_query.subq_aliases = outer_query.subq_aliases.union(self.subq_aliases)
906.         self.change_aliases({
907.             alias: '%s%d' % (self.alias_prefix, pos)
908.             for pos, alias in enumerate(self.alias_map)
909.         })
910. 
911.     def get_initial_alias(self):
912.         """
913.         Return the first alias for this query, after increasing its reference
914.         count.
915.         """
916.         if self.alias_map:
917.             alias = self.base_table
918.             self.ref_alias(alias)
919.         else:
920.             alias = self.join(BaseTable(self.get_meta().db_table, None))
921.         return alias
922. 
923.     def count_active_tables(self):
924.         """
925.         Return the number of tables in this query with a non-zero reference
926.         count. After execution, the reference counts are zeroed, so tables
927.         added in compiler will not be seen by this method.
928.         """
929.         return len([1 for count in self.alias_refcount.values() if count])
930. 
931.     def join(self, join, reuse=None, reuse_with_filtered_relation=False):
932.         """
933.         Return an alias for the 'join', either reusing an existing alias for
934.         that join or creating a new one. 'join' is either a
935.         sql.datastructures.BaseTable or Join.
936. 
937.         The 'reuse' parameter can be either None which means all joins are
938.         reusable, or it can be a set containing the aliases that can be reused.
939. 
940.         The 'reuse_with_filtered_relation' parameter is used when computing
941.         FilteredRelation instances.
942. 
943.         A join is always created as LOUTER if the lhs alias is LOUTER to make
944.         sure chains like t1 LOUTER t2 INNER t3 aren't generated. All new
945.         joins are created as LOUTER if the join is nullable.
946.         """
947.         if reuse_with_filtered_relation and reuse:
948.             reuse_aliases = [
949.                 a for a, j in self.alias_map.items()
950.                 if a in reuse and j.equals(join, with_filtered_relation=False)
951.             ]
952.         else:
953.             reuse_aliases = [
954.                 a for a, j in self.alias_map.items()
955.                 if (reuse is None or a in reuse) and j == join
956.             ]
957.         if reuse_aliases:
958.             if join.table_alias in reuse_aliases:
959.                 reuse_alias = join.table_alias
960.             else:
961.                 # Reuse the most recent alias of the joined table
962.                 # (a many-to-many relation may be joined multiple times).
963.                 reuse_alias = reuse_aliases[-1]
964.             self.ref_alias(reuse_alias)
965.             return reuse_alias
966. 
967.         # No reuse is possible, so we need a new alias.
968.         alias, _ = self.table_alias(join.table_name, create=True, filtered_relation=join.filtered_relation)
969.         if join.join_type:
970.             if self.alias_map[join.parent_alias].join_type == LOUTER or join.nullable:
971.                 join_type = LOUTER
972.             else:
973.                 join_type = INNER
974.             join.join_type = join_type
975.         join.table_alias = alias
976.         self.alias_map[alias] = join
977.         return alias
978. 
979.     def join_parent_model(self, opts, model, alias, seen):
980.         """
981.         Make sure the given 'model' is joined in the query. If 'model' isn't
982.         a parent of 'opts' or if it is None this method is a no-op.
983. 
984.         The 'alias' is the root alias for starting the join, 'seen' is a dict
985.         of model -> alias of existing joins. It must also contain a mapping
986.         of None -> some alias. This will be returned in the no-op case.
987.         """
988.         if model in seen:
989.             return seen[model]
990.         chain = opts.get_base_chain(model)
991.         if not chain:
992.             return alias
993.         curr_opts = opts
994.         for int_model in chain:
995.             if int_model in seen:
996.                 curr_opts = int_model._meta
997.                 alias = seen[int_model]
998.                 continue
999.             # Proxy model have elements in base chain
1000.             # with no parents, assign the new options
1001.             # object and skip to the next base in that
1002.             # case
1003.             if not curr_opts.parents[int_model]:
1004.                 curr_opts = int_model._meta
1005.                 continue
1006.             link_field = curr_opts.get_ancestor_link(int_model)
1007.             join_info = self.setup_joins([link_field.name], curr_opts, alias)
1008.             curr_opts = int_model._meta
1009.             alias = seen[int_model] = join_info.joins[-1]
1010.         return alias or seen[None]
1011. 
1012.     def add_annotation(self, annotation, alias, is_summary=False):
1013.         """Add a single annotation expression to the Query."""
1014.         annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None,
1015.                                                    summarize=is_summary)
1016.         self.append_annotation_mask([alias])
1017.         self.annotations[alias] = annotation
1018. 
1019.     def resolve_expression(self, query, *args, **kwargs):
1020.         clone = self.clone()
1021.         # Subqueries need to use a different set of aliases than the outer query.
1022.         clone.bump_prefix(query)
1023.         clone.subquery = True
1024.         # It's safe to drop ordering if the queryset isn't using slicing,
1025.         # distinct(*fields) or select_for_update().
1026.         if (self.low_mark == 0 and self.high_mark is None and
1027.                 not self.distinct_fields and
1028.                 not self.select_for_update):
1029.             clone.clear_ordering(True)
1030.         clone.where.resolve_expression(query, *args, **kwargs)
1031.         for key, value in clone.annotations.items():
1032.             resolved = value.resolve_expression(query, *args, **kwargs)
1033.             if hasattr(resolved, 'external_aliases'):
1034.                 resolved.external_aliases.update(clone.alias_map)
1035.             clone.annotations[key] = resolved
1036.         # Outer query's aliases are considered external.
1037.         clone.external_aliases.update(
1038.             alias for alias, table in query.alias_map.items()
1039.             if (
1040.                 isinstance(table, Join) and table.join_field.related_model._meta.db_table != alias
1041.             ) or (
1042.                 isinstance(table, BaseTable) and table.table_name != table.table_alias
1043.             )
1044.         )
1045.         return clone
1046. 
1047.     def as_sql(self, compiler, connection):
1048.         sql, params = self.get_compiler(connection=connection).as_sql()
1049.         if self.subquery:
1050.             sql = '(%s)' % sql
1051.         return sql, params
1052. 
1053.     def resolve_lookup_value(self, value, can_reuse, allow_joins, simple_col):
1054.         if hasattr(value, 'resolve_expression'):
1055.             kwargs = {'reuse': can_reuse, 'allow_joins': allow_joins}
1056.             if isinstance(value, F):
1057.                 kwargs['simple_col'] = simple_col
1058.             value = value.resolve_expression(self, **kwargs)
1059.         elif isinstance(value, (list, tuple)):
1060.             # The items of the iterable may be expressions and therefore need
1061.             # to be resolved independently.
1062.             resolved_values = []
1063.             for sub_value in value:
1064.                 if hasattr(sub_value, 'resolve_expression'):
1065.                     if isinstance(sub_value, F):
1066.                         resolved_values.append(sub_value.resolve_expression(
1067.                             self, reuse=can_reuse, allow_joins=allow_joins,
1068.                             simple_col=simple_col,
1069.                         ))
1070.                     else:
1071.                         resolved_values.append(sub_value.resolve_expression(
1072.                             self, reuse=can_reuse, allow_joins=allow_joins,
1073.                         ))
1074.                 else:
1075.                     resolved_values.append(sub_value)
1076.             value = tuple(resolved_values)
1077.         return value
1078. 
1079.     def solve_lookup_type(self, lookup):
1080.         """
1081.         Solve the lookup type from the lookup (e.g.: 'foobar__id__icontains').
1082.         """
1083.         lookup_splitted = lookup.split(LOOKUP_SEP)
1084.         if self.annotations:
1085.             expression, expression_lookups = refs_expression(lookup_splitted, self.annotations)
1086.             if expression:
1087.                 return expression_lookups, (), expression
1088.         _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
1089.         field_parts = lookup_splitted[0:len(lookup_splitted) - len(lookup_parts)]
1090.         if len(lookup_parts) > 1 and not field_parts:
1091.             raise FieldError(
1092.                 'Invalid lookup "%s" for model %s".' %
1093.                 (lookup, self.get_meta().model.__name__)
1094.             )
1095.         return lookup_parts, field_parts, False
1096. 
1097.     def check_query_object_type(self, value, opts, field):
1098.         """
1099.         Check whether the object passed while querying is of the correct type.
1100.         If not, raise a ValueError specifying the wrong object.
1101.         """
1102.         if hasattr(value, '_meta'):
1103.             if not check_rel_lookup_compatibility(value._meta.model, opts, field):
1104.                 raise ValueError(
1105.                     'Cannot query "%s": Must be "%s" instance.' %
1106.                     (value, opts.object_name))
1107. 
1108.     def check_related_objects(self, field, value, opts):
1109.         """Check the type of object passed to query relations."""
1110.         if field.is_relation:
1111.             # Check that the field and the queryset use the same model in a
1112.             # query like .filter(author=Author.objects.all()). For example, the
1113.             # opts would be Author's (from the author field) and value.model
1114.             # would be Author.objects.all() queryset's .model (Author also).
1115.             # The field is the related field on the lhs side.
1116.             if (isinstance(value, Query) and not value.has_select_fields and
1117.                     not check_rel_lookup_compatibility(value.model, opts, field)):
1118.                 raise ValueError(
1119.                     'Cannot use QuerySet for "%s": Use a QuerySet for "%s".' %
1120.                     (value.model._meta.object_name, opts.object_name)
1121.                 )
1122.             elif hasattr(value, '_meta'):
1123.                 self.check_query_object_type(value, opts, field)
1124.             elif hasattr(value, '__iter__'):
1125.                 for v in value:
1126.                     self.check_query_object_type(v, opts, field)
1127. 
1128.     def check_filterable(self, expression):
1129.         """Raise an error if expression cannot be used in a WHERE clause."""
1130.         if not getattr(expression, 'filterable', 'True'):
1131.             raise NotSupportedError(
1132.                 expression.__class__.__name__ + ' is disallowed in the filter '
1133.                 'clause.'
1134.             )
1135.         if hasattr(expression, 'get_source_expressions'):
1136.             for expr in expression.get_source_expressions():
1137.                 self.check_filterable(expr)
1138. 
1139.     def build_lookup(self, lookups, lhs, rhs):
1140.         """
1141.         Try to extract transforms and lookup from given lhs.
1142. 
1143.         The lhs value is something that works like SQLExpression.
1144.         The rhs value is what the lookup is going to compare against.
1145.         The lookups is a list of names to extract using get_lookup()
1146.         and get_transform().
1147.         """
1148.         # __exact is the default lookup if one isn't given.
1149.         *transforms, lookup_name = lookups or ['exact']
1150.         for name in transforms:
1151.             lhs = self.try_transform(lhs, name)
1152.         # First try get_lookup() so that the lookup takes precedence if the lhs
1153.         # supports both transform and lookup for the name.
1154.         lookup_class = lhs.get_lookup(lookup_name)
1155.         if not lookup_class:
1156.             if lhs.field.is_relation:
1157.                 raise FieldError('Related Field got invalid lookup: {}'.format(lookup_name))
1158.             # A lookup wasn't found. Try to interpret the name as a transform
1159.             # and do an Exact lookup against it.
1160.             lhs = self.try_transform(lhs, lookup_name)
1161.             lookup_name = 'exact'
1162.             lookup_class = lhs.get_lookup(lookup_name)
1163.             if not lookup_class:
1164.                 return
1165. 
1166.         lookup = lookup_class(lhs, rhs)
1167.         # Interpret '__exact=None' as the sql 'is NULL'; otherwise, reject all
1168.         # uses of None as a query value unless the lookup supports it.
1169.         if lookup.rhs is None and not lookup.can_use_none_as_rhs:
1170.             if lookup_name not in ('exact', 'iexact'):
1171.                 raise ValueError("Cannot use None as a query value")
1172.             return lhs.get_lookup('isnull')(lhs, True)
1173. 
1174.         # For Oracle '' is equivalent to null. The check must be done at this
1175.         # stage because join promotion can't be done in the compiler. Using
1176.         # DEFAULT_DB_ALIAS isn't nice but it's the best that can be done here.
1177.         # A similar thing is done in is_nullable(), too.
1178.         if (connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls and
1179.                 lookup_name == 'exact' and lookup.rhs == ''):
1180.             return lhs.get_lookup('isnull')(lhs, True)
1181. 
1182.         return lookup
1183. 
1184.     def try_transform(self, lhs, name):
1185.         """
1186.         Helper method for build_lookup(). Try to fetch and initialize
1187.         a transform for name parameter from lhs.
1188.         """
1189.         transform_class = lhs.get_transform(name)
1190.         if transform_class:
1191.             return transform_class(lhs)
1192.         else:
1193.             output_field = lhs.output_field.__class__
1194.             suggested_lookups = difflib.get_close_matches(name, output_field.get_lookups())
1195.             if suggested_lookups:
1196.                 suggestion = ', perhaps you meant %s?' % ' or '.join(suggested_lookups)
1197.             else:
1198.                 suggestion = '.'
1199.             raise FieldError(
1200.                 "Unsupported lookup '%s' for %s or join on the field not "
1201.                 "permitted%s" % (name, output_field.__name__, suggestion)
1202.             )
1203. 
1204.     def build_filter(self, filter_expr, branch_negated=False, current_negated=False,
1205.                      can_reuse=None, allow_joins=True, split_subq=True,
1206.                      reuse_with_filtered_relation=False, simple_col=False):
1207.         """
1208.         Build a WhereNode for a single filter clause but don't add it
1209.         to this Query. Query.add_q() will then add this filter to the where
1210.         Node.
1211. 
1212.         The 'branch_negated' tells us if the current branch contains any
1213.         negations. This will be used to determine if subqueries are needed.
1214. 
1215.         The 'current_negated' is used to determine if the current filter is
1216.         negated or not and this will be used to determine if IS NULL filtering
1217.         is needed.
1218. 
1219.         The difference between current_negated and branch_negated is that
1220.         branch_negated is set on first negation, but current_negated is
1221.         flipped for each negation.
1222. 
1223.         Note that add_filter will not do any negating itself, that is done
1224.         upper in the code by add_q().
1225. 
1226.         The 'can_reuse' is a set of reusable joins for multijoins.
1227. 
1228.         If 'reuse_with_filtered_relation' is True, then only joins in can_reuse
1229.         will be reused.
1230. 
1231.         The method will create a filter clause that can be added to the current
1232.         query. However, if the filter isn't added to the query then the caller
1233.         is responsible for unreffing the joins used.
1234.         """
1235.         if isinstance(filter_expr, dict):
1236.             raise FieldError("Cannot parse keyword query as dict")
1237.         if hasattr(filter_expr, 'resolve_expression') and getattr(filter_expr, 'conditional', False):
1238.             if connections[DEFAULT_DB_ALIAS].ops.conditional_expression_supported_in_where_clause(filter_expr):
1239.                 condition = filter_expr.resolve_expression(self)
1240.             else:
1241.                 # Expression is not supported in the WHERE clause, add
1242.                 # comparison with True.
1243.                 condition = self.build_lookup(['exact'], filter_expr.resolve_expression(self), True)
1244.             clause = self.where_class()
1245.             clause.add(condition, AND)
1246.             return clause, []
1247.         arg, value = filter_expr
1248.         if not arg:
1249.             raise FieldError("Cannot parse keyword query %r" % arg)
1250.         lookups, parts, reffed_expression = self.solve_lookup_type(arg)
1251. 
1252.         self.check_filterable(reffed_expression)
1253. 
1254.         if not allow_joins and len(parts) > 1:
1255.             raise FieldError("Joined field references are not permitted in this query")
1256. 
1257.         pre_joins = self.alias_refcount.copy()
1258.         value = self.resolve_lookup_value(value, can_reuse, allow_joins, simple_col)
1259.         used_joins = {k for k, v in self.alias_refcount.items() if v > pre_joins.get(k, 0)}
1260. 
1261.         self.check_filterable(value)
1262. 
1263.         clause = self.where_class()
1264.         if reffed_expression:
1265.             condition = self.build_lookup(lookups, reffed_expression, value)
1266.             clause.add(condition, AND)
1267.             return clause, []
1268. 
1269.         opts = self.get_meta()
1270.         alias = self.get_initial_alias()
1271.         allow_many = not branch_negated or not split_subq
1272. 
1273.         try:
1274.             join_info = self.setup_joins(
1275.                 parts, opts, alias, can_reuse=can_reuse, allow_many=allow_many,
1276.                 reuse_with_filtered_relation=reuse_with_filtered_relation,
1277.             )
1278. 
1279.             # Prevent iterator from being consumed by check_related_objects()
1280.             if isinstance(value, Iterator):
1281.                 value = list(value)
1282.             self.check_related_objects(join_info.final_field, value, join_info.opts)
1283. 
1284.             # split_exclude() needs to know which joins were generated for the
1285.             # lookup parts
1286.             self._lookup_joins = join_info.joins
1287.         except MultiJoin as e:
1288.             return self.split_exclude(filter_expr, can_reuse, e.names_with_path)
1289. 
1290.         # Update used_joins before trimming since they are reused to determine
1291.         # which joins could be later promoted to INNER.
1292.         used_joins.update(join_info.joins)
1293.         targets, alias, join_list = self.trim_joins(join_info.targets, join_info.joins, join_info.path)
1294.         if can_reuse is not None:
1295.             can_reuse.update(join_list)
1296. 
1297.         if join_info.final_field.is_relation:
1298.             # No support for transforms for relational fields
1299.             num_lookups = len(lookups)
1300.             if num_lookups > 1:
1301.                 raise FieldError('Related Field got invalid lookup: {}'.format(lookups[0]))
1302.             if len(targets) == 1:
1303.                 col = _get_col(targets[0], join_info.final_field, alias, simple_col)
1304.             else:
1305.                 col = MultiColSource(alias, targets, join_info.targets, join_info.final_field)
1306.         else:
1307.             col = _get_col(targets[0], join_info.final_field, alias, simple_col)
1308. 
1309.         condition = self.build_lookup(lookups, col, value)
1310.         lookup_type = condition.lookup_name
1311.         clause.add(condition, AND)
1312. 
1313.         require_outer = lookup_type == 'isnull' and condition.rhs is True and not current_negated
1314.         if current_negated and (lookup_type != 'isnull' or condition.rhs is False) and condition.rhs is not None:
1315.             require_outer = True
1316.             if (lookup_type != 'isnull' and (
1317.                     self.is_nullable(targets[0]) or
1318.                     self.alias_map[join_list[-1]].join_type == LOUTER)):
1319.                 # The condition added here will be SQL like this:
1320.                 # NOT (col IS NOT NULL), where the first NOT is added in
1321.                 # upper layers of code. The reason for addition is that if col
1322.                 # is null, then col != someval will result in SQL "unknown"
1323.                 # which isn't the same as in Python. The Python None handling
1324.                 # is wanted, and it can be gotten by
1325.                 # (col IS NULL OR col != someval)
1326.                 #   <=>
1327.                 # NOT (col IS NOT NULL AND col = someval).
1328.                 lookup_class = targets[0].get_lookup('isnull')
1329.                 col = _get_col(targets[0], join_info.targets[0], alias, simple_col)
1330.                 clause.add(lookup_class(col, False), AND)
1331.         return clause, used_joins if not require_outer else ()
1332. 
1333.     def add_filter(self, filter_clause):
1334.         self.add_q(Q(**{filter_clause[0]: filter_clause[1]}))
1335. 
1336.     def add_q(self, q_object):
1337.         """
1338.         A preprocessor for the internal _add_q(). Responsible for doing final
1339.         join promotion.
1340.         """
1341.         # For join promotion this case is doing an AND for the added q_object
1342.         # and existing conditions. So, any existing inner join forces the join
1343.         # type to remain inner. Existing outer joins can however be demoted.
1344.         # (Consider case where rel_a is LOUTER and rel_a__col=1 is added - if
1345.         # rel_a doesn't produce any rows, then the whole condition must fail.
1346.         # So, demotion is OK.
1347.         existing_inner = {a for a in self.alias_map if self.alias_map[a].join_type == INNER}
1348.         clause, _ = self._add_q(q_object, self.used_aliases)
1349.         if clause:
1350.             self.where.add(clause, AND)
1351.         self.demote_joins(existing_inner)
1352. 
1353.     def build_where(self, q_object):
1354.         return self._add_q(q_object, used_aliases=set(), allow_joins=False, simple_col=True)[0]
1355. 
1356.     def _add_q(self, q_object, used_aliases, branch_negated=False,
1357.                current_negated=False, allow_joins=True, split_subq=True,
1358.                simple_col=False):
1359.         """Add a Q-object to the current filter."""
1360.         connector = q_object.connector
1361.         current_negated = current_negated ^ q_object.negated
1362.         branch_negated = branch_negated or q_object.negated
1363.         target_clause = self.where_class(connector=connector,
1364.                                          negated=q_object.negated)
1365.         joinpromoter = JoinPromoter(q_object.connector, len(q_object.children), current_negated)
1366.         for child in q_object.children:
1367.             if isinstance(child, Node):
1368.                 child_clause, needed_inner = self._add_q(
1369.                     child, used_aliases, branch_negated,
1370.                     current_negated, allow_joins, split_subq, simple_col)
1371.                 joinpromoter.add_votes(needed_inner)
1372.             else:
1373.                 child_clause, needed_inner = self.build_filter(
1374.                     child, can_reuse=used_aliases, branch_negated=branch_negated,
1375.                     current_negated=current_negated, allow_joins=allow_joins,
1376.                     split_subq=split_subq, simple_col=simple_col,
1377.                 )
1378.                 joinpromoter.add_votes(needed_inner)
1379.             if child_clause:
1380.                 target_clause.add(child_clause, connector)
1381.         needed_inner = joinpromoter.update_join_types(self)
1382.         return target_clause, needed_inner
1383. 
1384.     def build_filtered_relation_q(self, q_object, reuse, branch_negated=False, current_negated=False):
1385.         """Add a FilteredRelation object to the current filter."""
1386.         connector = q_object.connector
1387.         current_negated ^= q_object.negated
1388.         branch_negated = branch_negated or q_object.negated
1389.         target_clause = self.where_class(connector=connector, negated=q_object.negated)
1390.         for child in q_object.children:
1391.             if isinstance(child, Node):
1392.                 child_clause = self.build_filtered_relation_q(
1393.                     child, reuse=reuse, branch_negated=branch_negated,
1394.                     current_negated=current_negated,
1395.                 )
1396.             else:
1397.                 child_clause, _ = self.build_filter(
1398.                     child, can_reuse=reuse, branch_negated=branch_negated,
1399.                     current_negated=current_negated,
1400.                     allow_joins=True, split_subq=False,
1401.                     reuse_with_filtered_relation=True,
1402.                 )
1403.             target_clause.add(child_clause, connector)
1404.         return target_clause
1405. 
1406.     def add_filtered_relation(self, filtered_relation, alias):
1407.         filtered_relation.alias = alias
1408.         lookups = dict(get_children_from_q(filtered_relation.condition))
1409.         for lookup in chain((filtered_relation.relation_name,), lookups):
1410.             lookup_parts, field_parts, _ = self.solve_lookup_type(lookup)
1411.             shift = 2 if not lookup_parts else 1
1412.             if len(field_parts) > (shift + len(lookup_parts)):
1413.                 raise ValueError(
1414.                     "FilteredRelation's condition doesn't support nested "
1415.                     "relations (got %r)." % lookup
1416.                 )
1417.         self._filtered_relations[filtered_relation.alias] = filtered_relation
1418. 
1419.     def names_to_path(self, names, opts, allow_many=True, fail_on_missing=False):
1420.         """
1421.         Walk the list of names and turns them into PathInfo tuples. A single
1422.         name in 'names' can generate multiple PathInfos (m2m, for example).
1423. 
1424.         'names' is the path of names to travel, 'opts' is the model Options we
1425.         start the name resolving from, 'allow_many' is as for setup_joins().
1426.         If fail_on_missing is set to True, then a name that can't be resolved
1427.         will generate a FieldError.
1428. 
1429.         Return a list of PathInfo tuples. In addition return the final field
1430.         (the last used join field) and target (which is a field guaranteed to
1431.         contain the same value as the final field). Finally, return those names
1432.         that weren't found (which are likely transforms and the final lookup).
1433.         """
1434.         path, names_with_path = [], []
1435.         for pos, name in enumerate(names):
1436.             cur_names_with_path = (name, [])
1437.             if name == 'pk':
1438.                 name = opts.pk.name
1439. 
1440.             field = None
1441.             filtered_relation = None
1442.             try:
1443.                 field = opts.get_field(name)
1444.             except FieldDoesNotExist:
1445.                 if name in self.annotation_select:
1446.                     field = self.annotation_select[name].output_field
1447.                 elif name in self._filtered_relations and pos == 0:
1448.                     filtered_relation = self._filtered_relations[name]
1449.                     field = opts.get_field(filtered_relation.relation_name)
1450.             if field is not None:
1451.                 # Fields that contain one-to-many relations with a generic
1452.                 # model (like a GenericForeignKey) cannot generate reverse
1453.                 # relations and therefore cannot be used for reverse querying.
1454.                 if field.is_relation and not field.related_model:
1455.                     raise FieldError(
1456.                         "Field %r does not generate an automatic reverse "
1457.                         "relation and therefore cannot be used for reverse "
1458.                         "querying. If it is a GenericForeignKey, consider "
1459.                         "adding a GenericRelation." % name
1460.                     )
1461.                 try:
1462.                     model = field.model._meta.concrete_model
1463.                 except AttributeError:
1464.                     # QuerySet.annotate() may introduce fields that aren't
1465.                     # attached to a model.
1466.                     model = None
1467.             else:
1468.                 # We didn't find the current field, so move position back
1469.                 # one step.
1470.                 pos -= 1
1471.                 if pos == -1 or fail_on_missing:
1472.                     available = sorted([
1473.                         *get_field_names_from_opts(opts),
1474.                         *self.annotation_select,
1475.                         *self._filtered_relations,
1476.                     ])
1477.                     raise FieldError("Cannot resolve keyword '%s' into field. "
1478.                                      "Choices are: %s" % (name, ", ".join(available)))
1479.                 break
1480.             # Check if we need any joins for concrete inheritance cases (the
1481.             # field lives in parent, but we are currently in one of its
1482.             # children)
1483.             if model is not opts.model:
1484.                 path_to_parent = opts.get_path_to_parent(model)
1485.                 if path_to_parent:
1486.                     path.extend(path_to_parent)
1487.                     cur_names_with_path[1].extend(path_to_parent)
1488.                     opts = path_to_parent[-1].to_opts
1489.             if hasattr(field, 'get_path_info'):
1490.                 pathinfos = field.get_path_info(filtered_relation)
1491.                 if not allow_many:
1492.                     for inner_pos, p in enumerate(pathinfos):
1493.                         if p.m2m:
1494.                             cur_names_with_path[1].extend(pathinfos[0:inner_pos + 1])
1495.                             names_with_path.append(cur_names_with_path)
1496.                             raise MultiJoin(pos + 1, names_with_path)
1497.                 last = pathinfos[-1]
1498.                 path.extend(pathinfos)
1499.                 final_field = last.join_field
1500.                 opts = last.to_opts
1501.                 targets = last.target_fields
1502.                 cur_names_with_path[1].extend(pathinfos)
1503.                 names_with_path.append(cur_names_with_path)
1504.             else:
1505.                 # Local non-relational field.
1506.                 final_field = field
1507.                 targets = (field,)
1508.                 if fail_on_missing and pos + 1 != len(names):
1509.                     raise FieldError(
1510.                         "Cannot resolve keyword %r into field. Join on '%s'"
1511.                         " not permitted." % (names[pos + 1], name))
1512.                 break
1513.         return path, final_field, targets, names[pos + 1:]
1514. 
1515.     def setup_joins(self, names, opts, alias, can_reuse=None, allow_many=True,
1516.                     reuse_with_filtered_relation=False):
1517.         """
1518.         Compute the necessary table joins for the passage through the fields
1519.         given in 'names'. 'opts' is the Options class for the current model
1520.         (which gives the table we are starting from), 'alias' is the alias for
1521.         the table to start the joining from.
1522. 
1523.         The 'can_reuse' defines the reverse foreign key joins we can reuse. It
1524.         can be None in which case all joins are reusable or a set of aliases
1525.         that can be reused. Note that non-reverse foreign keys are always
1526.         reusable when using setup_joins().
1527. 
1528.         The 'reuse_with_filtered_relation' can be used to force 'can_reuse'
1529.         parameter and force the relation on the given connections.
1530. 
1531.         If 'allow_many' is False, then any reverse foreign key seen will
1532.         generate a MultiJoin exception.
1533. 
1534.         Return the final field involved in the joins, the target field (used
1535.         for any 'where' constraint), the final 'opts' value, the joins, the
1536.         field path traveled to generate the joins, and a transform function
1537.         that takes a field and alias and is equivalent to `field.get_col(alias)`
1538.         in the simple case but wraps field transforms if they were included in
1539.         names.
1540. 
1541.         The target field is the field containing the concrete value. Final
1542.         field can be something different, for example foreign key pointing to
1543.         that value. Final field is needed for example in some value
1544.         conversions (convert 'obj' in fk__id=obj to pk val using the foreign
1545.         key field for example).
1546.         """
1547.         joins = [alias]
1548.         # The transform can't be applied yet, as joins must be trimmed later.
1549.         # To avoid making every caller of this method look up transforms
1550.         # directly, compute transforms here and create a partial that converts
1551.         # fields to the appropriate wrapped version.
1552. 
1553.         def final_transformer(field, alias):
1554.             return field.get_col(alias)
1555. 
1556.         # Try resolving all the names as fields first. If there's an error,
1557.         # treat trailing names as lookups until a field can be resolved.
1558.         last_field_exception = None
1559.         for pivot in range(len(names), 0, -1):
1560.             try:
1561.                 path, final_field, targets, rest = self.names_to_path(
1562.                     names[:pivot], opts, allow_many, fail_on_missing=True,
1563.                 )
1564.             except FieldError as exc:
1565.                 if pivot == 1:
1566.                     # The first item cannot be a lookup, so it's safe
1567.                     # to raise the field error here.
1568.                     raise
1569.                 else:
1570.                     last_field_exception = exc
1571.             else:
1572.                 # The transforms are the remaining items that couldn't be
1573.                 # resolved into fields.
1574.                 transforms = names[pivot:]
1575.                 break
1576.         for name in transforms:
1577.             def transform(field, alias, *, name, previous):
1578.                 try:
1579.                     wrapped = previous(field, alias)
1580.                     return self.try_transform(wrapped, name)
1581.                 except FieldError:
1582.                     # FieldError is raised if the transform doesn't exist.
1583.                     if isinstance(final_field, Field) and last_field_exception:
1584.                         raise last_field_exception
1585.                     else:
1586.                         raise
1587.             final_transformer = functools.partial(transform, name=name, previous=final_transformer)
1588.         # Then, add the path to the query's joins. Note that we can't trim
1589.         # joins at this stage - we will need the information about join type
1590.         # of the trimmed joins.
1591.         for join in path:
1592.             if join.filtered_relation:
1593.                 filtered_relation = join.filtered_relation.clone()
1594.                 table_alias = filtered_relation.alias
1595.             else:
1596.                 filtered_relation = None
1597.                 table_alias = None
1598.             opts = join.to_opts
1599.             if join.direct:
1600.                 nullable = self.is_nullable(join.join_field)
1601.             else:
1602.                 nullable = True
1603.             connection = Join(
1604.                 opts.db_table, alias, table_alias, INNER, join.join_field,
1605.                 nullable, filtered_relation=filtered_relation,
1606.             )
1607.             reuse = can_reuse if join.m2m or reuse_with_filtered_relation else None
1608.             alias = self.join(
1609.                 connection, reuse=reuse,
1610.                 reuse_with_filtered_relation=reuse_with_filtered_relation,
1611.             )
1612.             joins.append(alias)
1613.             if filtered_relation:
1614.                 filtered_relation.path = joins[:]
1615.         return JoinInfo(final_field, targets, opts, joins, path, final_transformer)
1616. 
1617.     def trim_joins(self, targets, joins, path):
1618.         """
1619.         The 'target' parameter is the final field being joined to, 'joins'
1620.         is the full list of join aliases. The 'path' contain the PathInfos
1621.         used to create the joins.
1622. 
1623.         Return the final target field and table alias and the new active
1624.         joins.
1625. 
1626.         Always trim any direct join if the target column is already in the
1627.         previous table. Can't trim reverse joins as it's unknown if there's
1628.         anything on the other side of the join.
1629.         """
1630.         joins = joins[:]
1631.         for pos, info in enumerate(reversed(path)):
1632.             if len(joins) == 1 or not info.direct:
1633.                 break
1634.             if info.filtered_relation:
1635.                 break
1636.             join_targets = {t.column for t in info.join_field.foreign_related_fields}
1637.             cur_targets = {t.column for t in targets}
1638.             if not cur_targets.issubset(join_targets):
1639.                 break
1640.             targets_dict = {r[1].column: r[0] for r in info.join_field.related_fields if r[1].column in cur_targets}
1641.             targets = tuple(targets_dict[t.column] for t in targets)
1642.             self.unref_alias(joins.pop())
1643.         return targets, joins[-1], joins
1644. 
1645.     @classmethod
1646.     def _gen_col_aliases(cls, exprs):
1647.         for expr in exprs:
1648.             if isinstance(expr, Col):
1649.                 yield expr.alias
1650.             else:
1651.                 yield from cls._gen_col_aliases(expr.get_source_expressions())
1652. 
1653.     def resolve_ref(self, name, allow_joins=True, reuse=None, summarize=False, simple_col=False):
1654.         if not allow_joins and LOOKUP_SEP in name:
1655.             raise FieldError("Joined field references are not permitted in this query")
1656.         annotation = self.annotations.get(name)
1657.         if annotation is not None:
1658.             if not allow_joins:
1659.                 for alias in self._gen_col_aliases([annotation]):
1660.                     if isinstance(self.alias_map[alias], Join):
1661.                         raise FieldError(
1662.                             'Joined field references are not permitted in '
1663.                             'this query'
1664.                         )
1665.             if summarize:
1666.                 # Summarize currently means we are doing an aggregate() query
1667.                 # which is executed as a wrapped subquery if any of the
1668.                 # aggregate() elements reference an existing annotation. In
1669.                 # that case we need to return a Ref to the subquery's annotation.
1670.                 return Ref(name, self.annotation_select[name])
1671.             else:
1672.                 return annotation
1673.         else:
1674.             field_list = name.split(LOOKUP_SEP)
1675.             join_info = self.setup_joins(field_list, self.get_meta(), self.get_initial_alias(), can_reuse=reuse)
1676.             targets, final_alias, join_list = self.trim_joins(join_info.targets, join_info.joins, join_info.path)
1677.             if not allow_joins and len(join_list) > 1:
1678.                 raise FieldError('Joined field references are not permitted in this query')
1679.             if len(targets) > 1:
1680.                 raise FieldError("Referencing multicolumn fields with F() objects "
1681.                                  "isn't supported")
1682.             # Verify that the last lookup in name is a field or a transform:
1683.             # transform_function() raises FieldError if not.
1684.             join_info.transform_function(targets[0], final_alias)
1685.             if reuse is not None:
1686.                 reuse.update(join_list)
1687.             col = _get_col(targets[0], join_info.targets[0], join_list[-1], simple_col)
1688.             return col
1689. 
1690.     def split_exclude(self, filter_expr, can_reuse, names_with_path):
1691.         """
1692.         When doing an exclude against any kind of N-to-many relation, we need
1693.         to use a subquery. This method constructs the nested query, given the
1694.         original exclude filter (filter_expr) and the portion up to the first
1695.         N-to-many relation field.
1696. 
1697.         For example, if the origin filter is ~Q(child__name='foo'), filter_expr
1698.         is ('child__name', 'foo') and can_reuse is a set of joins usable for
1699.         filters in the original query.
1700. 
1701.         We will turn this into equivalent of:
1702.             WHERE NOT (pk IN (SELECT parent_id FROM thetable
1703.                               WHERE name = 'foo' AND parent_id IS NOT NULL))
1704. 
1705.         It might be worth it to consider using WHERE NOT EXISTS as that has
1706.         saner null handling, and is easier for the backend's optimizer to
1707.         handle.
1708.         """
1709.         filter_lhs, filter_rhs = filter_expr
1710.         if isinstance(filter_rhs, OuterRef):
1711.             filter_expr = (filter_lhs, OuterRef(filter_rhs))
1712.         elif isinstance(filter_rhs, F):
1713.             filter_expr = (filter_lhs, OuterRef(filter_rhs.name))
1714.         # Generate the inner query.
1715.         query = Query(self.model)
1716.         query._filtered_relations = self._filtered_relations
1717.         query.add_filter(filter_expr)
1718.         query.clear_ordering(True)
1719.         # Try to have as simple as possible subquery -> trim leading joins from
1720.         # the subquery.
1721.         trimmed_prefix, contains_louter = query.trim_start(names_with_path)
1722. 
1723.         # Add extra check to make sure the selected field will not be null
1724.         # since we are adding an IN <subquery> clause. This prevents the
1725.         # database from tripping over IN (...,NULL,...) selects and returning
1726.         # nothing
1727.         col = query.select[0]
1728.         select_field = col.target
1729.         alias = col.alias
1730.         if self.is_nullable(select_field):
1731.             lookup_class = select_field.get_lookup('isnull')
1732.             lookup = lookup_class(select_field.get_col(alias), False)
1733.             query.where.add(lookup, AND)
1734.         if alias in can_reuse:
1735.             pk = select_field.model._meta.pk
1736.             # Need to add a restriction so that outer query's filters are in effect for
1737.             # the subquery, too.
1738.             query.bump_prefix(self)
1739.             lookup_class = select_field.get_lookup('exact')
1740.             # Note that the query.select[0].alias is different from alias
1741.             # due to bump_prefix above.
1742.             lookup = lookup_class(pk.get_col(query.select[0].alias),
1743.                                   pk.get_col(alias))
1744.             query.where.add(lookup, AND)
1745.             query.external_aliases.add(alias)
1746. 
1747.         condition, needed_inner = self.build_filter(
1748.             ('%s__in' % trimmed_prefix, query),
1749.             current_negated=True, branch_negated=True, can_reuse=can_reuse)
1750.         if contains_louter:
1751.             or_null_condition, _ = self.build_filter(
1752.                 ('%s__isnull' % trimmed_prefix, True),
1753.                 current_negated=True, branch_negated=True, can_reuse=can_reuse)
1754.             condition.add(or_null_condition, OR)
1755.             # Note that the end result will be:
1756.             # (outercol NOT IN innerq AND outercol IS NOT NULL) OR outercol IS NULL.
1757.             # This might look crazy but due to how IN works, this seems to be
1758.             # correct. If the IS NOT NULL check is removed then outercol NOT
1759.             # IN will return UNKNOWN. If the IS NULL check is removed, then if
1760.             # outercol IS NULL we will not match the row.
1761.         return condition, needed_inner
1762. 
1763.     def set_empty(self):
1764.         self.where.add(NothingNode(), AND)
1765. 
1766.     def is_empty(self):
1767.         return any(isinstance(c, NothingNode) for c in self.where.children)
1768. 
1769.     def set_limits(self, low=None, high=None):
1770.         """
1771.         Adjust the limits on the rows retrieved. Use low/high to set these,
1772.         as it makes it more Pythonic to read and write. When the SQL query is
1773.         created, convert them to the appropriate offset and limit values.
1774. 
1775.         Apply any limits passed in here to the existing constraints. Add low
1776.         to the current low value and clamp both to any existing high value.
1777.         """
1778.         if high is not None:
1779.             if self.high_mark is not None:
1780.                 self.high_mark = min(self.high_mark, self.low_mark + high)
1781.             else:
1782.                 self.high_mark = self.low_mark + high
1783.         if low is not None:
1784.             if self.high_mark is not None:
1785.                 self.low_mark = min(self.high_mark, self.low_mark + low)
1786.             else:
1787.                 self.low_mark = self.low_mark + low
1788. 
1789.         if self.low_mark == self.high_mark:
1790.             self.set_empty()
1791. 
1792.     def clear_limits(self):
1793.         """Clear any existing limits."""
1794.         self.low_mark, self.high_mark = 0, None
1795. 
1796.     @property
1797.     def is_sliced(self):
1798.         return self.low_mark != 0 or self.high_mark is not None
1799. 
1800.     def has_limit_one(self):
1801.         return self.high_mark is not None and (self.high_mark - self.low_mark) == 1
1802. 
1803.     def can_filter(self):
1804.         """
1805.         Return True if adding filters to this instance is still possible.
1806. 
1807.         Typically, this means no limits or offsets have been put on the results.
1808.         """
1809.         return not self.is_sliced
1810. 
1811.     def clear_select_clause(self):
1812.         """Remove all fields from SELECT clause."""
1813.         self.select = ()
1814.         self.default_cols = False
1815.         self.select_related = False
1816.         self.set_extra_mask(())
1817.         self.set_annotation_mask(())
1818. 
1819.     def clear_select_fields(self):
1820.         """
1821.         Clear the list of fields to select (but not extra_select columns).
1822.         Some queryset types completely replace any existing list of select
1823.         columns.
1824.         """
1825.         self.select = ()
1826.         self.values_select = ()
1827. 
1828.     def add_select_col(self, col):
1829.         self.select += col,
1830.         self.values_select += col.output_field.name,
1831. 
1832.     def set_select(self, cols):
1833.         self.default_cols = False
1834.         self.select = tuple(cols)
1835. 
1836.     def add_distinct_fields(self, *field_names):
1837.         """
1838.         Add and resolve the given fields to the query's "distinct on" clause.
1839.         """
1840.         self.distinct_fields = field_names
1841.         self.distinct = True
1842. 
1843.     def add_fields(self, field_names, allow_m2m=True):
1844.         """
1845.         Add the given (model) fields to the select set. Add the field names in
1846.         the order specified.
1847.         """
1848.         alias = self.get_initial_alias()
1849.         opts = self.get_meta()
1850. 
1851.         try:
1852.             cols = []
1853.             for name in field_names:
1854.                 # Join promotion note - we must not remove any rows here, so
1855.                 # if there is no existing joins, use outer join.
1856.                 join_info = self.setup_joins(name.split(LOOKUP_SEP), opts, alias, allow_many=allow_m2m)
1857.                 targets, final_alias, joins = self.trim_joins(
1858.                     join_info.targets,
1859.                     join_info.joins,
1860.                     join_info.path,
1861.                 )
1862.                 for target in targets:
1863.                     cols.append(join_info.transform_function(target, final_alias))
1864.             if cols:
1865.                 self.set_select(cols)
1866.         except MultiJoin:
1867.             raise FieldError("Invalid field name: '%s'" % name)
1868.         except FieldError:
1869.             if LOOKUP_SEP in name:
1870.                 # For lookups spanning over relationships, show the error
1871.                 # from the model on which the lookup failed.
1872.                 raise
1873.             else:
1874.                 names = sorted([
1875.                     *get_field_names_from_opts(opts), *self.extra,
1876.                     *self.annotation_select, *self._filtered_relations
1877.                 ])
1878.                 raise FieldError("Cannot resolve keyword %r into field. "
1879.                                  "Choices are: %s" % (name, ", ".join(names)))
1880. 
1881.     def add_ordering(self, *ordering):
1882.         """
1883.         Add items from the 'ordering' sequence to the query's "order by"
1884.         clause. These items are either field names (not column names) --
1885.         possibly with a direction prefix ('-' or '?') -- or OrderBy
1886.         expressions.
1887. 
1888.         If 'ordering' is empty, clear all ordering from the query.
1889.         """
1890.         errors = []
1891.         for item in ordering:
1892.             if not hasattr(item, 'resolve_expression') and not ORDER_PATTERN.match(item):
1893.                 errors.append(item)
1894.             if getattr(item, 'contains_aggregate', False):
1895.                 raise FieldError(
1896.                     'Using an aggregate in order_by() without also including '
1897.                     'it in annotate() is not allowed: %s' % item
1898.                 )
1899.         if errors:
1900.             raise FieldError('Invalid order_by arguments: %s' % errors)
1901.         if ordering:
1902.             self.order_by += ordering
1903.         else:
1904.             self.default_ordering = False
1905. 
1906.     def clear_ordering(self, force_empty):
1907.         """
1908.         Remove any ordering settings. If 'force_empty' is True, there will be
1909.         no ordering in the resulting query (not even the model's default).
1910.         """
1911.         self.order_by = ()
1912.         self.extra_order_by = ()
1913.         if force_empty:
1914.             self.default_ordering = False
1915. 
1916.     def set_group_by(self):
1917.         """
1918.         Expand the GROUP BY clause required by the query.
1919. 
1920.         This will usually be the set of all non-aggregate fields in the
1921.         return data. If the database backend supports grouping by the
1922.         primary key, and the query would be equivalent, the optimization
1923.         will be made automatically.
1924.         """
1925.         group_by = list(self.select)
1926.         if self.annotation_select:
1927.             for alias, annotation in self.annotation_select.items():
1928.                 try:
1929.                     inspect.getcallargs(annotation.get_group_by_cols, alias=alias)
1930.                 except TypeError:
1931.                     annotation_class = annotation.__class__
1932.                     msg = (
1933.                         '`alias=None` must be added to the signature of '
1934.                         '%s.%s.get_group_by_cols().'
1935.                     ) % (annotation_class.__module__, annotation_class.__qualname__)
1936.                     warnings.warn(msg, category=RemovedInDjango40Warning)
1937.                     group_by_cols = annotation.get_group_by_cols()
1938.                 else:
1939.                     group_by_cols = annotation.get_group_by_cols(alias=alias)
1940.                 group_by.extend(group_by_cols)
1941.         self.group_by = tuple(group_by)
1942. 
1943.     def add_select_related(self, fields):
1944.         """
1945.         Set up the select_related data structure so that we only select
1946.         certain related models (as opposed to all models, when
1947.         self.select_related=True).
1948.         """
1949.         if isinstance(self.select_related, bool):
1950.             field_dict = {}
1951.         else:
1952.             field_dict = self.select_related
1953.         for field in fields:
1954.             d = field_dict
1955.             for part in field.split(LOOKUP_SEP):
1956.                 d = d.setdefault(part, {})
1957.         self.select_related = field_dict
1958. 
1959.     def add_extra(self, select, select_params, where, params, tables, order_by):
1960.         """
1961.         Add data to the various extra_* attributes for user-created additions
1962.         to the query.
1963.         """
1964.         if select:
1965.             # We need to pair any placeholder markers in the 'select'
1966.             # dictionary with their parameters in 'select_params' so that
1967.             # subsequent updates to the select dictionary also adjust the
1968.             # parameters appropriately.
1969.             select_pairs = {}
1970.             if select_params:
1971.                 param_iter = iter(select_params)
1972.             else:
1973.                 param_iter = iter([])
1974.             for name, entry in select.items():
1975.                 entry = str(entry)
1976.                 entry_params = []
1977.                 pos = entry.find("%s")
1978.                 while pos != -1:
1979.                     if pos == 0 or entry[pos - 1] != '%':
1980.                         entry_params.append(next(param_iter))
1981.                     pos = entry.find("%s", pos + 2)
1982.                 select_pairs[name] = (entry, entry_params)
1983.             self.extra.update(select_pairs)
1984.         if where or params:
1985.             self.where.add(ExtraWhere(where, params), AND)
1986.         if tables:
1987.             self.extra_tables += tuple(tables)
1988.         if order_by:
1989.             self.extra_order_by = order_by
1990. 
1991.     def clear_deferred_loading(self):
1992.         """Remove any fields from the deferred loading set."""
1993.         self.deferred_loading = (frozenset(), True)
1994. 
1995.     def add_deferred_loading(self, field_names):
1996.         """
1997.         Add the given list of model field names to the set of fields to
1998.         exclude from loading from the database when automatic column selection
1999.         is done. Add the new field names to any existing field names that
2000.         are deferred (or removed from any existing field names that are marked
2001.         as the only ones for immediate loading).
2002.         """
2003.         # Fields on related models are stored in the literal double-underscore
2004.         # format, so that we can use a set datastructure. We do the foo__bar
2005.         # splitting and handling when computing the SQL column names (as part of
2006.         # get_columns()).
2007.         existing, defer = self.deferred_loading
2008.         if defer:
2009.             # Add to existing deferred names.
2010.             self.deferred_loading = existing.union(field_names), True
2011.         else:
2012.             # Remove names from the set of any existing "immediate load" names.
2013.             self.deferred_loading = existing.difference(field_names), False
2014. 
2015.     def add_immediate_loading(self, field_names):
2016.         """
2017.         Add the given list of model field names to the set of fields to
2018.         retrieve when the SQL is executed ("immediate loading" fields). The
2019.         field names replace any existing immediate loading field names. If
2020.         there are field names already specified for deferred loading, remove
2021.         those names from the new field_names before storing the new names
2022.         for immediate loading. (That is, immediate loading overrides any
2023.         existing immediate values, but respects existing deferrals.)
2024.         """
2025.         existing, defer = self.deferred_loading
2026.         field_names = set(field_names)
2027.         if 'pk' in field_names:
2028.             field_names.remove('pk')
2029.             field_names.add(self.get_meta().pk.name)
2030. 
2031.         if defer:
2032.             # Remove any existing deferred names from the current set before
2033.             # setting the new names.
2034.             self.deferred_loading = field_names.difference(existing), False
2035.         else:
2036.             # Replace any existing "immediate load" field names.
2037.             self.deferred_loading = frozenset(field_names), False
2038. 
2039.     def get_loaded_field_names(self):
2040.         """
2041.         If any fields are marked to be deferred, return a dictionary mapping
2042.         models to a set of names in those fields that will be loaded. If a
2043.         model is not in the returned dictionary, none of its fields are
2044.         deferred.
2045. 
2046.         If no fields are marked for deferral, return an empty dictionary.
2047.         """
2048.         # We cache this because we call this function multiple times
2049.         # (compiler.fill_related_selections, query.iterator)
2050.         try:
2051.             return self._loaded_field_names_cache
2052.         except AttributeError:
2053.             collection = {}
2054.             self.deferred_to_data(collection, self.get_loaded_field_names_cb)
2055.             self._loaded_field_names_cache = collection
2056.             return collection
2057. 
2058.     def get_loaded_field_names_cb(self, target, model, fields):
2059.         """Callback used by get_deferred_field_names()."""
2060.         target[model] = {f.attname for f in fields}
2061. 
2062.     def set_annotation_mask(self, names):
2063.         """Set the mask of annotations that will be returned by the SELECT."""
2064.         if names is None:
2065.             self.annotation_select_mask = None
2066.         else:
2067.             self.annotation_select_mask = set(names)
2068.         self._annotation_select_cache = None
2069. 
2070.     def append_annotation_mask(self, names):
2071.         if self.annotation_select_mask is not None:
2072.             self.set_annotation_mask(self.annotation_select_mask.union(names))
2073. 
2074.     def set_extra_mask(self, names):
2075.         """
2076.         Set the mask of extra select items that will be returned by SELECT.
2077.         Don't remove them from the Query since they might be used later.
2078.         """
2079.         if names is None:
2080.             self.extra_select_mask = None
2081.         else:
2082.             self.extra_select_mask = set(names)
2083.         self._extra_select_cache = None
2084. 
2085.     def set_values(self, fields):
2086.         self.select_related = False
2087.         self.clear_deferred_loading()
2088.         self.clear_select_fields()
2089. 
2090.         if self.group_by is True:
2091.             self.add_fields((f.attname for f in self.model._meta.concrete_fields), False)
2092.             self.set_group_by()
2093.             self.clear_select_fields()
2094. 
2095.         if fields:
2096.             field_names = []
2097.             extra_names = []
2098.             annotation_names = []
2099.             if not self.extra and not self.annotations:
2100.                 # Shortcut - if there are no extra or annotations, then
2101.                 # the values() clause must be just field names.
2102.                 field_names = list(fields)
2103.             else:
2104.                 self.default_cols = False
2105.                 for f in fields:
2106.                     if f in self.extra_select:
2107.                         extra_names.append(f)
2108.                     elif f in self.annotation_select:
2109.                         annotation_names.append(f)
2110.                     else:
2111.                         field_names.append(f)
2112.             self.set_extra_mask(extra_names)
2113.             self.set_annotation_mask(annotation_names)
2114.         else:
2115.             field_names = [f.attname for f in self.model._meta.concrete_fields]
2116. 
2117.         self.values_select = tuple(field_names)
2118.         self.add_fields(field_names, True)
2119. 
2120.     @property
2121.     def annotation_select(self):
2122.         """
2123.         Return the dictionary of aggregate columns that are not masked and
2124.         should be used in the SELECT clause. Cache this result for performance.
2125.         """
2126.         if self._annotation_select_cache is not None:
2127.             return self._annotation_select_cache
2128.         elif not self.annotations:
2129.             return {}
2130.         elif self.annotation_select_mask is not None:
2131.             self._annotation_select_cache = {
2132.                 k: v for k, v in self.annotations.items()
2133.                 if k in self.annotation_select_mask
2134.             }
2135.             return self._annotation_select_cache
2136.         else:
2137.             return self.annotations
2138. 
2139.     @property
2140.     def extra_select(self):
2141.         if self._extra_select_cache is not None:
2142.             return self._extra_select_cache
2143.         if not self.extra:
2144.             return {}
2145.         elif self.extra_select_mask is not None:
2146.             self._extra_select_cache = {
2147.                 k: v for k, v in self.extra.items()
2148.                 if k in self.extra_select_mask
2149.             }
2150.             return self._extra_select_cache
2151.         else:
2152.             return self.extra
2153. 
2154.     def trim_start(self, names_with_path):
2155.         """
2156.         Trim joins from the start of the join path. The candidates for trim
2157.         are the PathInfos in names_with_path structure that are m2m joins.
2158. 
2159.         Also set the select column so the start matches the join.
2160. 
2161.         This method is meant to be used for generating the subquery joins &
2162.         cols in split_exclude().
2163. 
2164.         Return a lookup usable for doing outerq.filter(lookup=self) and a
2165.         boolean indicating if the joins in the prefix contain a LEFT OUTER join.
2166.         _"""
2167.         all_paths = []
2168.         for _, paths in names_with_path:
2169.             all_paths.extend(paths)
2170.         contains_louter = False
2171.         # Trim and operate only on tables that were generated for
2172.         # the lookup part of the query. That is, avoid trimming
2173.         # joins generated for F() expressions.
2174.         lookup_tables = [
2175.             t for t in self.alias_map
2176.             if t in self._lookup_joins or t == self.base_table
2177.         ]
2178.         for trimmed_paths, path in enumerate(all_paths):
2179.             if path.m2m:
2180.                 break
2181.             if self.alias_map[lookup_tables[trimmed_paths + 1]].join_type == LOUTER:
2182.                 contains_louter = True
2183.             alias = lookup_tables[trimmed_paths]
2184.             self.unref_alias(alias)
2185.         # The path.join_field is a Rel, lets get the other side's field
2186.         join_field = path.join_field.field
2187.         # Build the filter prefix.
2188.         paths_in_prefix = trimmed_paths
2189.         trimmed_prefix = []
2190.         for name, path in names_with_path:
2191.             if paths_in_prefix - len(path) < 0:
2192.                 break
2193.             trimmed_prefix.append(name)
2194.             paths_in_prefix -= len(path)
2195.         trimmed_prefix.append(
2196.             join_field.foreign_related_fields[0].name)
2197.         trimmed_prefix = LOOKUP_SEP.join(trimmed_prefix)
2198.         # Lets still see if we can trim the first join from the inner query
2199.         # (that is, self). We can't do this for:
2200.         # - LEFT JOINs because we would miss those rows that have nothing on
2201.         #   the outer side,
2202.         # - INNER JOINs from filtered relations because we would miss their
2203.         #   filters.
2204.         first_join = self.alias_map[lookup_tables[trimmed_paths + 1]]
2205.         if first_join.join_type != LOUTER and not first_join.filtered_relation:
2206.             select_fields = [r[0] for r in join_field.related_fields]
2207.             select_alias = lookup_tables[trimmed_paths + 1]
2208.             self.unref_alias(lookup_tables[trimmed_paths])
2209.             extra_restriction = join_field.get_extra_restriction(
2210.                 self.where_class, None, lookup_tables[trimmed_paths + 1])
2211.             if extra_restriction:
2212.                 self.where.add(extra_restriction, AND)
2213.         else:
2214.             # TODO: It might be possible to trim more joins from the start of the
2215.             # inner query if it happens to have a longer join chain containing the
2216.             # values in select_fields. Lets punt this one for now.
2217.             select_fields = [r[1] for r in join_field.related_fields]
2218.             select_alias = lookup_tables[trimmed_paths]
2219.         # The found starting point is likely a Join instead of a BaseTable reference.
2220.         # But the first entry in the query's FROM clause must not be a JOIN.
2221.         for table in self.alias_map:
2222.             if self.alias_refcount[table] > 0:
2223.                 self.alias_map[table] = BaseTable(self.alias_map[table].table_name, table)
2224.                 break
2225.         self.set_select([f.get_col(select_alias) for f in select_fields])
2226.         return trimmed_prefix, contains_louter
2227. 
2228.     def is_nullable(self, field):
2229.         """
2230.         Check if the given field should be treated as nullable.
2231. 
2232.         Some backends treat '' as null and Django treats such fields as
2233.         nullable for those backends. In such situations field.null can be
2234.         False even if we should treat the field as nullable.
2235.         """
2236.         # We need to use DEFAULT_DB_ALIAS here, as QuerySet does not have
2237.         # (nor should it have) knowledge of which connection is going to be
2238.         # used. The proper fix would be to defer all decisions where
2239.         # is_nullable() is needed to the compiler stage, but that is not easy
2240.         # to do currently.
2241.         return (
2242.             connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls and
2243.             field.empty_strings_allowed
2244.         ) or field.null
2245. 


File: django/db/models/sql/query.py
Line number range: 2280 - 2362
Content:
2280. class JoinPromoter:
2281.     """
2282.     A class to abstract away join promotion problems for complex filter
2283.     conditions.
2284.     """
2285. 
2286.     def __init__(self, connector, num_children, negated):
2287.         self.connector = connector
2288.         self.negated = negated
2289.         if self.negated:
2290.             if connector == AND:
2291.                 self.effective_connector = OR
2292.             else:
2293.                 self.effective_connector = AND
2294.         else:
2295.             self.effective_connector = self.connector
2296.         self.num_children = num_children
2297.         # Maps of table alias to how many times it is seen as required for
2298.         # inner and/or outer joins.
2299.         self.votes = Counter()
2300. 
2301.     def add_votes(self, votes):
2302.         """
2303.         Add single vote per item to self.votes. Parameter can be any
2304.         iterable.
2305.         """
2306.         self.votes.update(votes)
2307. 
2308.     def update_join_types(self, query):
2309.         """
2310.         Change join types so that the generated query is as efficient as
2311.         possible, but still correct. So, change as many joins as possible
2312.         to INNER, but don't make OUTER joins INNER if that could remove
2313.         results from the query.
2314.         """
2315.         to_promote = set()
2316.         to_demote = set()
2317.         # The effective_connector is used so that NOT (a AND b) is treated
2318.         # similarly to (a OR b) for join promotion.
2319.         for table, votes in self.votes.items():
2320.             # We must use outer joins in OR case when the join isn't contained
2321.             # in all of the joins. Otherwise the INNER JOIN itself could remove
2322.             # valid results. Consider the case where a model with rel_a and
2323.             # rel_b relations is queried with rel_a__col=1 | rel_b__col=2. Now,
2324.             # if rel_a join doesn't produce any results is null (for example
2325.             # reverse foreign key or null value in direct foreign key), and
2326.             # there is a matching row in rel_b with col=2, then an INNER join
2327.             # to rel_a would remove a valid match from the query. So, we need
2328.             # to promote any existing INNER to LOUTER (it is possible this
2329.             # promotion in turn will be demoted later on).
2330.             if self.effective_connector == 'OR' and votes < self.num_children:
2331.                 to_promote.add(table)
2332.             # If connector is AND and there is a filter that can match only
2333.             # when there is a joinable row, then use INNER. For example, in
2334.             # rel_a__col=1 & rel_b__col=2, if either of the rels produce NULL
2335.             # as join output, then the col=1 or col=2 can't match (as
2336.             # NULL=anything is always false).
2337.             # For the OR case, if all children voted for a join to be inner,
2338.             # then we can use INNER for the join. For example:
2339.             #     (rel_a__col__icontains=Alex | rel_a__col__icontains=Russell)
2340.             # then if rel_a doesn't produce any rows, the whole condition
2341.             # can't match. Hence we can safely use INNER join.
2342.             if self.effective_connector == 'AND' or (
2343.                     self.effective_connector == 'OR' and votes == self.num_children):
2344.                 to_demote.add(table)
2345.             # Finally, what happens in cases where we have:
2346.             #    (rel_a__col=1|rel_b__col=2) & rel_a__col__gte=0
2347.             # Now, we first generate the OR clause, and promote joins for it
2348.             # in the first if branch above. Both rel_a and rel_b are promoted
2349.             # to LOUTER joins. After that we do the AND case. The OR case
2350.             # voted no inner joins but the rel_a__col__gte=0 votes inner join
2351.             # for rel_a. We demote it back to INNER join (in AND case a single
2352.             # vote is enough). The demotion is OK, if rel_a doesn't produce
2353.             # rows, then the rel_a__col__gte=0 clause can't be true, and thus
2354.             # the whole clause must be false. So, it is safe to use INNER
2355.             # join.
2356.             # Note that in this example we could just as well have the __gte
2357.             # clause and the OR clause swapped. Or we could replace the __gte
2358.             # clause with an OR clause containing rel_a__col=1|rel_a__col=2,
2359.             # and again we could safely demote to INNER.
2360.         query.promote_joins(to_promote)
2361.         query.demote_joins(to_demote)
2362.         return to_demote

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:10:25,160 - thread-126571847354048.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user has provided a patch to fix an issue where a list value is coerced to a tuple in `Query.resolve_lookup_value`, which can break queries for type-sensitive fields. I have the content of `django/db/models/sql/query.py` which contains the method being changed, and `django/db/models/lookups.py` which shows how the value is consumed by lookups like `Exact`. The issue mentions `PickledField` as an example of a type-sensitive field, but its implementation is not necessary to understand that changing a list to a tuple can affect equality checks for serialized data. The provided context is sufficient to understand the problem and the proposed solution.' query='' extra_requirements='' purpose=''
2025-12-21 08:10:25,161 - thread-126571847354048.prometheus_context_collector - INFO - Successfully retrieved 4 context snippets
