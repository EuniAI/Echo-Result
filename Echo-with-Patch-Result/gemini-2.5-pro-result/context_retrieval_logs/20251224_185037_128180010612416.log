2025-12-24 18:50:37,473 - thread-128180010612416.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.

Description: Description
	
add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.
Currently, We can override the method get_inline_instances to do such a thing, but a for loop should be copied to my code. So I wished add a hook get_inlines(request, obj=None)

Patch information:
diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py
index 5e7b23f9a0..023d30c1fb 100644
--- a/django/contrib/admin/options.py
+++ b/django/contrib/admin/options.py
@@ -580,9 +580,16 @@ class ModelAdmin(BaseModelAdmin):
     def __str__(self):
         return "%s.%s" % (self.model._meta.app_label, self.__class__.__name__)
 
+    def get_inlines(self, request, obj=None):
+        """
+        Hook for specifying the InlineModelAdmin classes to use.
+        Return a list or tuple of InlineModelAdmin classes.
+        """
+        return self.inlines
+
     def get_inline_instances(self, request, obj=None):
         inline_instances = []
-        for inline_class in self.inlines:
+        for inline_class in self.get_inlines(request, obj):
             inline = inline_class(self.model, self.admin_site)
             if request:
                 if not (inline.has_view_or_change_permission(request, obj) or
diff --git a/docs/ref/contrib/admin/index.txt b/docs/ref/contrib/admin/index.txt
index 93679c46fd..a6f3e5d519 100644
--- a/docs/ref/contrib/admin/index.txt
+++ b/docs/ref/contrib/admin/index.txt
@@ -1608,24 +1608,35 @@ templates used by the :class:`ModelAdmin` views:
             def get_sortable_by(self, request):
                 return {*self.get_list_display(request)} - {'rank'}
 
-.. method:: ModelAdmin.get_inline_instances(request, obj=None)
+.. method:: ModelAdmin.get_inlines(request, obj=None)
 
-    The ``get_inline_instances`` method is given the ``HttpRequest`` and the
-    ``obj`` being edited (or ``None`` on an add form) and is expected to return
-    a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
-    objects, as described below in the :class:`~django.contrib.admin.InlineModelAdmin`
-    section. For example, the following would return inlines without the default
-    filtering based on add, change, delete, and view permissions::
+    Return a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
+    classes to use for the given ``request`` and the ``obj`` being edited (or
+    ``None`` on an add form). By default, this returns :attr:`inlines`. Override
+    this method to choose inlines based on the current request or object::
 
         class MyModelAdmin(admin.ModelAdmin):
-            inlines = (MyInline,)
+            inlines = (MyInline, OtherInline)
+
+            def get_inlines(self, request, obj=None):
+                if obj is None:
+                    return (MyInline,)
+                return (MyInline, OtherInline)
 
-            def get_inline_instances(self, request, obj=None):
-                return [inline(self.model, self.admin_site) for inline in self.inlines]
+    If you override this method, make sure that the returned classes are also
+    listed in :attr:`inlines` or you might encounter a "Bad Request" error when
+    adding related objects.
+
+.. method:: ModelAdmin.get_inline_instances(request, obj=None)
 
-    If you override this method, make sure that the returned inlines are
-    instances of the classes defined in :attr:`inlines` or you might encounter
-    a "Bad Request" error when adding related objects.
+    Given the ``HttpRequest`` and the ``obj`` being edited (or ``None`` on an
+    add form), return a ``list`` or ``tuple`` of instantiated
+    :class:`~django.contrib.admin.InlineModelAdmin` objects. The base
+    implementation instantiates the classes returned by
+    :meth:`get_inlines` and applies the default filtering based on add,
+    change, delete, and view permissions. To customize which inlines are
+    displayed for a given request or object, override :meth:`get_inlines`
+    rather than this method.
 
 .. method:: ModelAdmin.get_urls()
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-24 18:50:37,581 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   └── with_last_login_attr.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_remote_user_deprecation.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   ├── test_file_charset.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_deprecated_features.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   └── test_tree.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   ├── debug
    |   |   |   ├── template_error.html
    |   |   |   └── template_exception.html
    |   |   ├── jsi18n-multi-catalogs.html
    |   |   └── jsi18n.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.

Description: Description
	
add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.
Currently, We can override the method get_inline_instances to do such a thing, but a for loop should be copied to my code. So I wished add a hook get_inlines(request, obj=None)

Patch information:
diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py
index 5e7b23f9a0..023d30c1fb 100644
--- a/django/contrib/admin/options.py
+++ b/django/contrib/admin/options.py
@@ -580,9 +580,16 @@ class ModelAdmin(BaseModelAdmin):
     def __str__(self):
         return "%s.%s" % (self.model._meta.app_label, self.__class__.__name__)
 
+    def get_inlines(self, request, obj=None):
+        """
+        Hook for specifying the InlineModelAdmin classes to use.
+        Return a list or tuple of InlineModelAdmin classes.
+        """
+        return self.inlines
+
     def get_inline_instances(self, request, obj=None):
         inline_instances = []
-        for inline_class in self.inlines:
+        for inline_class in self.get_inlines(request, obj):
             inline = inline_class(self.model, self.admin_site)
             if request:
                 if not (inline.has_view_or_change_permission(request, obj) or
diff --git a/docs/ref/contrib/admin/index.txt b/docs/ref/contrib/admin/index.txt
index 93679c46fd..a6f3e5d519 100644
--- a/docs/ref/contrib/admin/index.txt
+++ b/docs/ref/contrib/admin/index.txt
@@ -1608,24 +1608,35 @@ templates used by the :class:`ModelAdmin` views:
             def get_sortable_by(self, request):
                 return {*self.get_list_display(request)} - {'rank'}
 
-.. method:: ModelAdmin.get_inline_instances(request, obj=None)
+.. method:: ModelAdmin.get_inlines(request, obj=None)
 
-    The ``get_inline_instances`` method is given the ``HttpRequest`` and the
-    ``obj`` being edited (or ``None`` on an add form) and is expected to return
-    a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
-    objects, as described below in the :class:`~django.contrib.admin.InlineModelAdmin`
-    section. For example, the following would return inlines without the default
-    filtering based on add, change, delete, and view permissions::
+    Return a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
+    classes to use for the given ``request`` and the ``obj`` being edited (or
+    ``None`` on an add form). By default, this returns :attr:`inlines`. Override
+    this method to choose inlines based on the current request or object::
 
         class MyModelAdmin(admin.ModelAdmin):
-            inlines = (MyInline,)
+            inlines = (MyInline, OtherInline)
+
+            def get_inlines(self, request, obj=None):
+                if obj is None:
+                    return (MyInline,)
+                return (MyInline, OtherInline)
 
-            def get_inline_instances(self, request, obj=None):
-                return [inline(self.model, self.admin_site) for inline in self.inlines]
+    If you override this method, make sure that the returned classes are also
+    listed in :attr:`inlines` or you might encounter a "Bad Request" error when
+    adding related objects.
+
+.. method:: ModelAdmin.get_inline_instances(request, obj=None)
 
-    If you override this method, make sure that the returned inlines are
-    instances of the classes defined in :attr:`inlines` or you might encounter
-    a "Bad Request" error when adding related objects.
+    Given the ``HttpRequest`` and the ``obj`` being edited (or ``None`` on an
+    add form), return a ``list`` or ``tuple`` of instantiated
+    :class:`~django.contrib.admin.InlineModelAdmin` objects. The base
+    implementation instantiates the classes returned by
+    :meth:`get_inlines` and applies the default filtering based on add,
+    change, delete, and view permissions. To customize which inlines are
+    displayed for a given request or object, override :meth:`get_inlines`
+    rather than this method.
 
 .. method:: ModelAdmin.get_urls()
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 18:51:00,384 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to a patch that adds a `get_inlines()` hook to `ModelAdmin`. This hook allows for dynamic customization of inlines. To find relevant examples, I need to examine tests for similar customizable hooks in `ModelAdmin`, particularly those related to inlines. The most logical starting point is the test file dedicated to admin inlines, as it will likely contain tests for `get_inline_instances` and other inline-related functionality.' query='Please provide the full content of tests/admin_inlines/tests.py.' extra_requirements='' purpose='I need to find existing test cases that demonstrate how to test customizable hooks on ModelAdmin, which will serve as a pattern for testing the new `get_inlines` method.'
2025-12-24 18:51:00,385 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of tests/admin_inlines/tests.py.
2025-12-24 18:51:00,386 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 18:51:00,386 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 18:51:00,387 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 18:51:00,387 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of tests/admin_inlines/tests.py.
Purpose: I need to find existing test cases that demonstrate how to test customizable hooks on ModelAdmin, which will serve as a pattern for testing the new `get_inlines` method.
2025-12-24 18:51:02,933 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `tests/admin_inlines/tests.py`. This will allow you to examine existing test cases for customizable hooks on `ModelAdmin`, which you can use as a pattern for testing the new `get_inlines` method.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_inlines/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2103, 'candidates_token_count': 78, 'total_token_count': 2303, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2103}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 122, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15765014061560997, 'model_name': 'gemini-2.5-pro'} id='run--244c5337-f229-4559-85e3-90894ca5aee5-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_inlines/tests.py'}, 'id': 'd578329c-5919-4b2c-9abf-465dc16dfdf9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2103, 'output_tokens': 78, 'total_tokens': 2303, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 122}}
2025-12-24 18:51:05,430 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the specified test file. Now, I will search within this file for occurrences of `get_inlines` to identify relevant test cases that demonstrate how to test customizable hooks on `ModelAdmin`. This will help you understand the existing patterns for testing such functionality.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "get_inlines", "relative_path": "tests/admin_inlines/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11161, 'candidates_token_count': 95, 'total_token_count': 11341, 'cached_content_token_count': 1843, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11161}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1843}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 95}], 'thoughts_token_count': 85}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12159285294382195, 'model_name': 'gemini-2.5-pro'} id='run--4fc3b154-901a-4a9a-9555-3a3cf30f5414-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'get_inlines', 'relative_path': 'tests/admin_inlines/tests.py'}, 'id': 'c778a176-df11-4c32-ba47-f2b4d10288e4', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11161, 'output_tokens': 95, 'total_tokens': 11341, 'input_token_details': {'cache_read': 1843}, 'output_token_details': {'reasoning': 85}}
2025-12-24 18:51:11,107 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the content of `tests/admin_inlines/tests.py` as you requested. My initial search for `get_inlines` within the file came up empty, so I am now looking for tests of similar customizable hooks to provide a suitable pattern. I've identified a test for `get_min_num`, which serves as a good example of testing a customizable method on an inline." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "get_min_num", "relative_path": "tests/admin_inlines/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11288, 'candidates_token_count': 123, 'total_token_count': 11797, 'cached_content_token_count': 11040, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11288}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11040}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 123}], 'thoughts_token_count': 386}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5234420280146405, 'model_name': 'gemini-2.5-pro'} id='run--ee05dd2d-8dca-4016-a2c1-1259fe920399-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'get_min_num', 'relative_path': 'tests/admin_inlines/tests.py'}, 'id': '792de288-d7a6-456e-9b39-65300cd34ef0', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11288, 'output_tokens': 123, 'total_tokens': 11797, 'input_token_details': {'cache_read': 11040}, 'output_token_details': {'reasoning': 386}}
2025-12-24 18:51:13,743 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located a relevant test case, `test_custom_min_num`, that demonstrates how to test a customizable method on an inline. I will now retrieve the code for this test case, which will serve as a useful pattern for testing the `get_inlines` method.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 338.0, "relative_path": "tests/admin_inlines/tests.py", "end_line": 372.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 17894, 'candidates_token_count': 88, 'total_token_count': 18025, 'cached_content_token_count': 11241, 'prompt_tokens_details': [{'modality': 1, 'token_count': 17894}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11241}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 88}], 'thoughts_token_count': 43}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1689889756116, 'model_name': 'gemini-2.5-pro'} id='run--8aade634-ca26-4cb9-969a-1bba12df08fe-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 338.0, 'relative_path': 'tests/admin_inlines/tests.py', 'end_line': 372.0}, 'id': '92c9a993-9398-48a4-aa65-8b0d067cc21a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 17894, 'output_tokens': 88, 'total_tokens': 18025, 'input_token_details': {'cache_read': 11241}, 'output_token_details': {'reasoning': 43}}
2025-12-24 18:51:19,658 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located the test file you requested and identified a relevant test case that demonstrates a pattern for testing customizable hooks on `ModelAdmin`. Although no tests for `get_inlines` exist in this file, the `test_custom_min_num` test case provides a clear example of how to test a similar customizable method. You can adapt the logic from this test to create a new test for your `get_inlines` method.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18693, 'candidates_token_count': 90, 'total_token_count': 19286, 'cached_content_token_count': 16867, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18693}], 'cache_tokens_details': [{'modality': 1, 'token_count': 16867}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 90}], 'thoughts_token_count': 503}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5449381510416667, 'model_name': 'gemini-2.5-pro'} id='run--91ad729d-0b64-467a-ba3d-d09f5dc474ed-0' usage_metadata={'input_tokens': 18693, 'output_tokens': 90, 'total_tokens': 19286, 'input_token_details': {'cache_read': 16867}, 'output_token_details': {'reasoning': 503}}
2025-12-24 18:51:19,660 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of tests/admin_inlines/tests.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find existing test cases that demonstrate how to test customizable hooks on ModelAdmin, which will serve as a pattern for testing the new `get_inlines` method.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/admin_inlines/tests.py
Line number range: 1 - 500
Content:
1. from django.contrib.admin import ModelAdmin, TabularInline
2. from django.contrib.admin.helpers import InlineAdminForm
3. from django.contrib.admin.tests import AdminSeleniumTestCase
4. from django.contrib.auth.models import Permission, User
5. from django.contrib.contenttypes.models import ContentType
6. from django.test import RequestFactory, TestCase, override_settings
7. from django.urls import reverse
8. 
9. from .admin import InnerInline, site as admin_site
10. from .models import (
11.     Author, BinaryTree, Book, Chapter, Child, ChildModel1, ChildModel2,
12.     Fashionista, FootNote, Holder, Holder2, Holder3, Holder4, Inner, Inner2,
13.     Inner3, Inner4Stacked, Inner4Tabular, Novel, OutfitItem, Parent,
14.     ParentModelWithCustomPk, Person, Poll, Profile, ProfileCollection,
15.     Question, Sighting, SomeChildModel, SomeParentModel, Teacher,
16. )
17. 
18. INLINE_CHANGELINK_HTML = 'class="inlinechangelink">Change</a>'
19. 
20. 
21. class TestDataMixin:
22. 
23.     @classmethod
24.     def setUpTestData(cls):
25.         cls.superuser = User.objects.create_superuser(username='super', email='super@example.com', password='secret')
26. 
27. 
28. @override_settings(ROOT_URLCONF='admin_inlines.urls')
29. class TestInline(TestDataMixin, TestCase):
30.     factory = RequestFactory()
31. 
32.     @classmethod
33.     def setUpTestData(cls):
34.         super().setUpTestData()
35.         cls.holder = Holder.objects.create(dummy=13)
36.         Inner.objects.create(dummy=42, holder=cls.holder)
37. 
38.     def setUp(self):
39.         self.client.force_login(self.superuser)
40. 
41.     def test_can_delete(self):
42.         """
43.         can_delete should be passed to inlineformset factory.
44.         """
45.         response = self.client.get(
46.             reverse('admin:admin_inlines_holder_change', args=(self.holder.id,))
47.         )
48.         inner_formset = response.context['inline_admin_formsets'][0].formset
49.         expected = InnerInline.can_delete
50.         actual = inner_formset.can_delete
51.         self.assertEqual(expected, actual, 'can_delete must be equal')
52. 
53.     def test_readonly_stacked_inline_label(self):
54.         """Bug #13174."""
55.         holder = Holder.objects.create(dummy=42)
56.         Inner.objects.create(holder=holder, dummy=42, readonly='')
57.         response = self.client.get(
58.             reverse('admin:admin_inlines_holder_change', args=(holder.id,))
59.         )
60.         self.assertContains(response, '<label>Inner readonly label:</label>')
61. 
62.     def test_many_to_many_inlines(self):
63.         "Autogenerated many-to-many inlines are displayed correctly (#13407)"
64.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
65.         # The heading for the m2m inline block uses the right text
66.         self.assertContains(response, '<h2>Author-book relationships</h2>')
67.         # The "add another" label is correct
68.         self.assertContains(response, 'Add another Author-book relationship')
69.         # The '+' is dropped from the autogenerated form prefix (Author_books+)
70.         self.assertContains(response, 'id="id_Author_books-TOTAL_FORMS"')
71. 
72.     def test_inline_primary(self):
73.         person = Person.objects.create(firstname='Imelda')
74.         item = OutfitItem.objects.create(name='Shoes')
75.         # Imelda likes shoes, but can't carry her own bags.
76.         data = {
77.             'shoppingweakness_set-TOTAL_FORMS': 1,
78.             'shoppingweakness_set-INITIAL_FORMS': 0,
79.             'shoppingweakness_set-MAX_NUM_FORMS': 0,
80.             '_save': 'Save',
81.             'person': person.id,
82.             'max_weight': 0,
83.             'shoppingweakness_set-0-item': item.id,
84.         }
85.         response = self.client.post(reverse('admin:admin_inlines_fashionista_add'), data)
86.         self.assertEqual(response.status_code, 302)
87.         self.assertEqual(len(Fashionista.objects.filter(person__firstname='Imelda')), 1)
88. 
89.     def test_tabular_inline_column_css_class(self):
90.         """
91.         Field names are included in the context to output a field-specific
92.         CSS class name in the column headers.
93.         """
94.         response = self.client.get(reverse('admin:admin_inlines_poll_add'))
95.         text_field, call_me_field = list(response.context['inline_admin_formset'].fields())
96.         # Editable field.
97.         self.assertEqual(text_field['name'], 'text')
98.         self.assertContains(response, '<th class="column-text required">')
99.         # Read-only field.
100.         self.assertEqual(call_me_field['name'], 'call_me')
101.         self.assertContains(response, '<th class="column-call_me">')
102. 
103.     def test_custom_form_tabular_inline_label(self):
104.         """
105.         A model form with a form field specified (TitleForm.title1) should have
106.         its label rendered in the tabular inline.
107.         """
108.         response = self.client.get(reverse('admin:admin_inlines_titlecollection_add'))
109.         self.assertContains(response, '<th class="column-title1 required">Title1</th>', html=True)
110. 
111.     def test_custom_form_tabular_inline_overridden_label(self):
112.         """
113.         SomeChildModelForm.__init__() overrides the label of a form field.
114.         That label is displayed in the TabularInline.
115.         """
116.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_add'))
117.         field = list(response.context['inline_admin_formset'].fields())[0]
118.         self.assertEqual(field['label'], 'new label')
119.         self.assertContains(response, '<th class="column-name required">New label</th>', html=True)
120. 
121.     def test_tabular_non_field_errors(self):
122.         """
123.         non_field_errors are displayed correctly, including the correct value
124.         for colspan.
125.         """
126.         data = {
127.             'title_set-TOTAL_FORMS': 1,
128.             'title_set-INITIAL_FORMS': 0,
129.             'title_set-MAX_NUM_FORMS': 0,
130.             '_save': 'Save',
131.             'title_set-0-title1': 'a title',
132.             'title_set-0-title2': 'a different title',
133.         }
134.         response = self.client.post(reverse('admin:admin_inlines_titlecollection_add'), data)
135.         # Here colspan is "4": two fields (title1 and title2), one hidden field and the delete checkbox.
136.         self.assertContains(
137.             response,
138.             '<tr><td colspan="4"><ul class="errorlist nonfield">'
139.             '<li>The two titles must be the same</li></ul></td></tr>'
140.         )
141. 
142.     def test_no_parent_callable_lookup(self):
143.         """Admin inline `readonly_field` shouldn't invoke parent ModelAdmin callable"""
144.         # Identically named callable isn't present in the parent ModelAdmin,
145.         # rendering of the add view shouldn't explode
146.         response = self.client.get(reverse('admin:admin_inlines_novel_add'))
147.         self.assertEqual(response.status_code, 200)
148.         # View should have the child inlines section
149.         self.assertContains(
150.             response,
151.             '<div class="js-inline-admin-formset inline-group" id="chapter_set-group"'
152.         )
153. 
154.     def test_callable_lookup(self):
155.         """Admin inline should invoke local callable when its name is listed in readonly_fields"""
156.         response = self.client.get(reverse('admin:admin_inlines_poll_add'))
157.         self.assertEqual(response.status_code, 200)
158.         # Add parent object view should have the child inlines section
159.         self.assertContains(
160.             response,
161.             '<div class="js-inline-admin-formset inline-group" id="question_set-group"'
162.         )
163.         # The right callable should be used for the inline readonly_fields
164.         # column cells
165.         self.assertContains(response, '<p>Callable in QuestionInline</p>')
166. 
167.     def test_help_text(self):
168.         """
169.         The inlines' model field help texts are displayed when using both the
170.         stacked and tabular layouts.
171.         """
172.         response = self.client.get(reverse('admin:admin_inlines_holder4_add'))
173.         self.assertContains(response, '<div class="help">Awesome stacked help text is awesome.</div>', 4)
174.         self.assertContains(
175.             response,
176.             '<img src="/static/admin/img/icon-unknown.svg" '
177.             'class="help help-tooltip" width="10" height="10" '
178.             'alt="(Awesome tabular help text is awesome.)" '
179.             'title="Awesome tabular help text is awesome.">',
180.             1
181.         )
182.         # ReadOnly fields
183.         response = self.client.get(reverse('admin:admin_inlines_capofamiglia_add'))
184.         self.assertContains(
185.             response,
186.             '<img src="/static/admin/img/icon-unknown.svg" '
187.             'class="help help-tooltip" width="10" height="10" '
188.             'alt="(Help text for ReadOnlyInline)" '
189.             'title="Help text for ReadOnlyInline">',
190.             1
191.         )
192. 
193.     def test_tabular_model_form_meta_readonly_field(self):
194.         """
195.         Tabular inlines use ModelForm.Meta.help_texts and labels for read-only
196.         fields.
197.         """
198.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_add'))
199.         self.assertContains(
200.             response,
201.             '<img src="/static/admin/img/icon-unknown.svg" '
202.             'class="help help-tooltip" width="10" height="10" '
203.             'alt="(Help text from ModelForm.Meta)" '
204.             'title="Help text from ModelForm.Meta">'
205.         )
206.         self.assertContains(response, 'Label from ModelForm.Meta')
207. 
208.     def test_inline_hidden_field_no_column(self):
209.         """#18263 -- Make sure hidden fields don't get a column in tabular inlines"""
210.         parent = SomeParentModel.objects.create(name='a')
211.         SomeChildModel.objects.create(name='b', position='0', parent=parent)
212.         SomeChildModel.objects.create(name='c', position='1', parent=parent)
213.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_change', args=(parent.pk,)))
214.         self.assertNotContains(response, '<td class="field-position">')
215.         self.assertInHTML(
216.             '<input id="id_somechildmodel_set-1-position" '
217.             'name="somechildmodel_set-1-position" type="hidden" value="1">',
218.             response.rendered_content,
219.         )
220. 
221.     def test_non_related_name_inline(self):
222.         """
223.         Multiple inlines with related_name='+' have correct form prefixes.
224.         """
225.         response = self.client.get(reverse('admin:admin_inlines_capofamiglia_add'))
226.         self.assertContains(response, '<input type="hidden" name="-1-0-id" id="id_-1-0-id">', html=True)
227.         self.assertContains(
228.             response,
229.             '<input type="hidden" name="-1-0-capo_famiglia" id="id_-1-0-capo_famiglia">',
230.             html=True
231.         )
232.         self.assertContains(
233.             response,
234.             '<input id="id_-1-0-name" type="text" class="vTextField" name="-1-0-name" maxlength="100">',
235.             html=True
236.         )
237.         self.assertContains(response, '<input type="hidden" name="-2-0-id" id="id_-2-0-id">', html=True)
238.         self.assertContains(
239.             response,
240.             '<input type="hidden" name="-2-0-capo_famiglia" id="id_-2-0-capo_famiglia">',
241.             html=True
242.         )
243.         self.assertContains(
244.             response,
245.             '<input id="id_-2-0-name" type="text" class="vTextField" name="-2-0-name" maxlength="100">',
246.             html=True
247.         )
248. 
249.     @override_settings(USE_L10N=True, USE_THOUSAND_SEPARATOR=True)
250.     def test_localize_pk_shortcut(self):
251.         """
252.         The "View on Site" link is correct for locales that use thousand
253.         separators.
254.         """
255.         holder = Holder.objects.create(pk=123456789, dummy=42)
256.         inner = Inner.objects.create(pk=987654321, holder=holder, dummy=42, readonly='')
257.         response = self.client.get(reverse('admin:admin_inlines_holder_change', args=(holder.id,)))
258.         inner_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(inner).pk, inner.pk)
259.         self.assertContains(response, inner_shortcut)
260. 
261.     def test_custom_pk_shortcut(self):
262.         """
263.         The "View on Site" link is correct for models with a custom primary key
264.         field.
265.         """
266.         parent = ParentModelWithCustomPk.objects.create(my_own_pk="foo", name="Foo")
267.         child1 = ChildModel1.objects.create(my_own_pk="bar", name="Bar", parent=parent)
268.         child2 = ChildModel2.objects.create(my_own_pk="baz", name="Baz", parent=parent)
269.         response = self.client.get(reverse('admin:admin_inlines_parentmodelwithcustompk_change', args=('foo',)))
270.         child1_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(child1).pk, child1.pk)
271.         child2_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(child2).pk, child2.pk)
272.         self.assertContains(response, child1_shortcut)
273.         self.assertContains(response, child2_shortcut)
274. 
275.     def test_create_inlines_on_inherited_model(self):
276.         """
277.         An object can be created with inlines when it inherits another class.
278.         """
279.         data = {
280.             'name': 'Martian',
281.             'sighting_set-TOTAL_FORMS': 1,
282.             'sighting_set-INITIAL_FORMS': 0,
283.             'sighting_set-MAX_NUM_FORMS': 0,
284.             'sighting_set-0-place': 'Zone 51',
285.             '_save': 'Save',
286.         }
287.         response = self.client.post(reverse('admin:admin_inlines_extraterrestrial_add'), data)
288.         self.assertEqual(response.status_code, 302)
289.         self.assertEqual(Sighting.objects.filter(et__name='Martian').count(), 1)
290. 
291.     def test_custom_get_extra_form(self):
292.         bt_head = BinaryTree.objects.create(name="Tree Head")
293.         BinaryTree.objects.create(name="First Child", parent=bt_head)
294.         # The maximum number of forms should respect 'get_max_num' on the
295.         # ModelAdmin
296.         max_forms_input = (
297.             '<input id="id_binarytree_set-MAX_NUM_FORMS" '
298.             'name="binarytree_set-MAX_NUM_FORMS" type="hidden" value="%d">'
299.         )
300.         # The total number of forms will remain the same in either case
301.         total_forms_hidden = (
302.             '<input id="id_binarytree_set-TOTAL_FORMS" '
303.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="2">'
304.         )
305.         response = self.client.get(reverse('admin:admin_inlines_binarytree_add'))
306.         self.assertInHTML(max_forms_input % 3, response.rendered_content)
307.         self.assertInHTML(total_forms_hidden, response.rendered_content)
308. 
309.         response = self.client.get(reverse('admin:admin_inlines_binarytree_change', args=(bt_head.id,)))
310.         self.assertInHTML(max_forms_input % 2, response.rendered_content)
311.         self.assertInHTML(total_forms_hidden, response.rendered_content)
312. 
313.     def test_min_num(self):
314.         """
315.         min_num and extra determine number of forms.
316.         """
317.         class MinNumInline(TabularInline):
318.             model = BinaryTree
319.             min_num = 2
320.             extra = 3
321. 
322.         modeladmin = ModelAdmin(BinaryTree, admin_site)
323.         modeladmin.inlines = [MinNumInline]
324.         min_forms = (
325.             '<input id="id_binarytree_set-MIN_NUM_FORMS" '
326.             'name="binarytree_set-MIN_NUM_FORMS" type="hidden" value="2">'
327.         )
328.         total_forms = (
329.             '<input id="id_binarytree_set-TOTAL_FORMS" '
330.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="5">'
331.         )
332.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_add'))
333.         request.user = User(username='super', is_superuser=True)
334.         response = modeladmin.changeform_view(request)
335.         self.assertInHTML(min_forms, response.rendered_content)
336.         self.assertInHTML(total_forms, response.rendered_content)
337. 
338.     def test_custom_min_num(self):
339.         bt_head = BinaryTree.objects.create(name="Tree Head")
340.         BinaryTree.objects.create(name="First Child", parent=bt_head)
341. 
342.         class MinNumInline(TabularInline):
343.             model = BinaryTree
344.             extra = 3
345. 
346.             def get_min_num(self, request, obj=None, **kwargs):
347.                 if obj:
348.                     return 5
349.                 return 2
350. 
351.         modeladmin = ModelAdmin(BinaryTree, admin_site)
352.         modeladmin.inlines = [MinNumInline]
353.         min_forms = (
354.             '<input id="id_binarytree_set-MIN_NUM_FORMS" '
355.             'name="binarytree_set-MIN_NUM_FORMS" type="hidden" value="%d">'
356.         )
357.         total_forms = (
358.             '<input id="id_binarytree_set-TOTAL_FORMS" '
359.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="%d">'
360.         )
361.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_add'))
362.         request.user = User(username='super', is_superuser=True)
363.         response = modeladmin.changeform_view(request)
364.         self.assertInHTML(min_forms % 2, response.rendered_content)
365.         self.assertInHTML(total_forms % 5, response.rendered_content)
366. 
367.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_change', args=(bt_head.id,)))
368.         request.user = User(username='super', is_superuser=True)
369.         response = modeladmin.changeform_view(request, object_id=str(bt_head.id))
370.         self.assertInHTML(min_forms % 5, response.rendered_content)
371.         self.assertInHTML(total_forms % 8, response.rendered_content)
372. 
373.     def test_inline_nonauto_noneditable_pk(self):
374.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
375.         self.assertContains(
376.             response,
377.             '<input id="id_nonautopkbook_set-0-rand_pk" '
378.             'name="nonautopkbook_set-0-rand_pk" type="hidden">',
379.             html=True
380.         )
381.         self.assertContains(
382.             response,
383.             '<input id="id_nonautopkbook_set-2-0-rand_pk" '
384.             'name="nonautopkbook_set-2-0-rand_pk" type="hidden">',
385.             html=True
386.         )
387. 
388.     def test_inline_nonauto_noneditable_inherited_pk(self):
389.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
390.         self.assertContains(
391.             response,
392.             '<input id="id_nonautopkbookchild_set-0-nonautopkbook_ptr" '
393.             'name="nonautopkbookchild_set-0-nonautopkbook_ptr" type="hidden">',
394.             html=True
395.         )
396.         self.assertContains(
397.             response,
398.             '<input id="id_nonautopkbookchild_set-2-nonautopkbook_ptr" '
399.             'name="nonautopkbookchild_set-2-nonautopkbook_ptr" type="hidden">',
400.             html=True
401.         )
402. 
403.     def test_inline_editable_pk(self):
404.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
405.         self.assertContains(
406.             response,
407.             '<input class="vIntegerField" id="id_editablepkbook_set-0-manual_pk" '
408.             'name="editablepkbook_set-0-manual_pk" type="number">',
409.             html=True, count=1
410.         )
411.         self.assertContains(
412.             response,
413.             '<input class="vIntegerField" id="id_editablepkbook_set-2-0-manual_pk" '
414.             'name="editablepkbook_set-2-0-manual_pk" type="number">',
415.             html=True, count=1
416.         )
417. 
418.     def test_stacked_inline_edit_form_contains_has_original_class(self):
419.         holder = Holder.objects.create(dummy=1)
420.         holder.inner_set.create(dummy=1)
421.         response = self.client.get(reverse('admin:admin_inlines_holder_change', args=(holder.pk,)))
422.         self.assertContains(
423.             response,
424.             '<div class="inline-related has_original" id="inner_set-0">',
425.             count=1
426.         )
427.         self.assertContains(
428.             response,
429.             '<div class="inline-related" id="inner_set-1">',
430.             count=1
431.         )
432. 
433.     def test_inlines_show_change_link_registered(self):
434.         "Inlines `show_change_link` for registered models when enabled."
435.         holder = Holder4.objects.create(dummy=1)
436.         item1 = Inner4Stacked.objects.create(dummy=1, holder=holder)
437.         item2 = Inner4Tabular.objects.create(dummy=1, holder=holder)
438.         items = (
439.             ('inner4stacked', item1.pk),
440.             ('inner4tabular', item2.pk),
441.         )
442.         response = self.client.get(reverse('admin:admin_inlines_holder4_change', args=(holder.pk,)))
443.         self.assertTrue(response.context['inline_admin_formset'].opts.has_registered_model)
444.         for model, pk in items:
445.             url = reverse('admin:admin_inlines_%s_change' % model, args=(pk,))
446.             self.assertContains(response, '<a href="%s" %s' % (url, INLINE_CHANGELINK_HTML))
447. 
448.     def test_inlines_show_change_link_unregistered(self):
449.         "Inlines `show_change_link` disabled for unregistered models."
450.         parent = ParentModelWithCustomPk.objects.create(my_own_pk="foo", name="Foo")
451.         ChildModel1.objects.create(my_own_pk="bar", name="Bar", parent=parent)
452.         ChildModel2.objects.create(my_own_pk="baz", name="Baz", parent=parent)
453.         response = self.client.get(reverse('admin:admin_inlines_parentmodelwithcustompk_change', args=('foo',)))
454.         self.assertFalse(response.context['inline_admin_formset'].opts.has_registered_model)
455.         self.assertNotContains(response, INLINE_CHANGELINK_HTML)
456. 
457.     def test_tabular_inline_show_change_link_false_registered(self):
458.         "Inlines `show_change_link` disabled by default."
459.         poll = Poll.objects.create(name="New poll")
460.         Question.objects.create(poll=poll)
461.         response = self.client.get(reverse('admin:admin_inlines_poll_change', args=(poll.pk,)))
462.         self.assertTrue(response.context['inline_admin_formset'].opts.has_registered_model)
463.         self.assertNotContains(response, INLINE_CHANGELINK_HTML)
464. 
465.     def test_noneditable_inline_has_field_inputs(self):
466.         """Inlines without change permission shows field inputs on add form."""
467.         response = self.client.get(reverse('admin:admin_inlines_novelreadonlychapter_add'))
468.         self.assertContains(
469.             response,
470.             '<input type="text" name="chapter_set-0-name" '
471.             'class="vTextField" maxlength="40" id="id_chapter_set-0-name">',
472.             html=True
473.         )
474. 
475. 
476. @override_settings(ROOT_URLCONF='admin_inlines.urls')
477. class TestInlineMedia(TestDataMixin, TestCase):
478. 
479.     def setUp(self):
480.         self.client.force_login(self.superuser)
481. 
482.     def test_inline_media_only_base(self):
483.         holder = Holder(dummy=13)
484.         holder.save()
485.         Inner(dummy=42, holder=holder).save()
486.         change_url = reverse('admin:admin_inlines_holder_change', args=(holder.id,))
487.         response = self.client.get(change_url)
488.         self.assertContains(response, 'my_awesome_admin_scripts.js')
489. 
490.     def test_inline_media_only_inline(self):
491.         holder = Holder3(dummy=13)
492.         holder.save()
493.         Inner3(dummy=42, holder=holder).save()
494.         change_url = reverse('admin:admin_inlines_holder3_change', args=(holder.id,))
495.         response = self.client.get(change_url)
496.         self.assertEqual(
497.             response.context['inline_admin_formsets'][0].media._js,
498.             [
499.                 'admin/js/vendor/jquery/jquery.min.js',
500.                 'my_awesome_inline_scripts.js',

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 18:51:26,401 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user requested the full content of the file 'tests/admin_inlines/tests.py'. The provided context contains the entire content of this file.", relative_path='tests/admin_inlines/tests.py', start_line=1, end_line=500)]
2025-12-24 18:51:26,431 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of tests/admin_inlines/tests.py.
2025-12-24 18:51:26,431 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 18:51:26,431 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 18:51:26,432 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-24 18:51:26,432 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-24 18:51:26,433 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   └── with_last_login_attr.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_remote_user_deprecation.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   ├── test_file_charset.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_deprecated_features.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   └── test_tree.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   ├── debug
    |   |   |   ├── template_error.html
    |   |   |   └── template_exception.html
    |   |   ├── jsi18n-multi-catalogs.html
    |   |   └── jsi18n.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.

Description: Description
	
add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.
Currently, We can override the method get_inline_instances to do such a thing, but a for loop should be copied to my code. So I wished add a hook get_inlines(request, obj=None)

Patch information:
diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py
index 5e7b23f9a0..023d30c1fb 100644
--- a/django/contrib/admin/options.py
+++ b/django/contrib/admin/options.py
@@ -580,9 +580,16 @@ class ModelAdmin(BaseModelAdmin):
     def __str__(self):
         return "%s.%s" % (self.model._meta.app_label, self.__class__.__name__)
 
+    def get_inlines(self, request, obj=None):
+        """
+        Hook for specifying the InlineModelAdmin classes to use.
+        Return a list or tuple of InlineModelAdmin classes.
+        """
+        return self.inlines
+
     def get_inline_instances(self, request, obj=None):
         inline_instances = []
-        for inline_class in self.inlines:
+        for inline_class in self.get_inlines(request, obj):
             inline = inline_class(self.model, self.admin_site)
             if request:
                 if not (inline.has_view_or_change_permission(request, obj) or
diff --git a/docs/ref/contrib/admin/index.txt b/docs/ref/contrib/admin/index.txt
index 93679c46fd..a6f3e5d519 100644
--- a/docs/ref/contrib/admin/index.txt
+++ b/docs/ref/contrib/admin/index.txt
@@ -1608,24 +1608,35 @@ templates used by the :class:`ModelAdmin` views:
             def get_sortable_by(self, request):
                 return {*self.get_list_display(request)} - {'rank'}
 
-.. method:: ModelAdmin.get_inline_instances(request, obj=None)
+.. method:: ModelAdmin.get_inlines(request, obj=None)
 
-    The ``get_inline_instances`` method is given the ``HttpRequest`` and the
-    ``obj`` being edited (or ``None`` on an add form) and is expected to return
-    a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
-    objects, as described below in the :class:`~django.contrib.admin.InlineModelAdmin`
-    section. For example, the following would return inlines without the default
-    filtering based on add, change, delete, and view permissions::
+    Return a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
+    classes to use for the given ``request`` and the ``obj`` being edited (or
+    ``None`` on an add form). By default, this returns :attr:`inlines`. Override
+    this method to choose inlines based on the current request or object::
 
         class MyModelAdmin(admin.ModelAdmin):
-            inlines = (MyInline,)
+            inlines = (MyInline, OtherInline)
+
+            def get_inlines(self, request, obj=None):
+                if obj is None:
+                    return (MyInline,)
+                return (MyInline, OtherInline)
 
-            def get_inline_instances(self, request, obj=None):
-                return [inline(self.model, self.admin_site) for inline in self.inlines]
+    If you override this method, make sure that the returned classes are also
+    listed in :attr:`inlines` or you might encounter a "Bad Request" error when
+    adding related objects.
+
+.. method:: ModelAdmin.get_inline_instances(request, obj=None)
 
-    If you override this method, make sure that the returned inlines are
-    instances of the classes defined in :attr:`inlines` or you might encounter
-    a "Bad Request" error when adding related objects.
+    Given the ``HttpRequest`` and the ``obj`` being edited (or ``None`` on an
+    add form), return a ``list`` or ``tuple`` of instantiated
+    :class:`~django.contrib.admin.InlineModelAdmin` objects. The base
+    implementation instantiates the classes returned by
+    :meth:`get_inlines` and applies the default filtering based on add,
+    change, delete, and view permissions. To customize which inlines are
+    displayed for a given request or object, override :meth:`get_inlines`
+    rather than this method.
 
 .. method:: ModelAdmin.get_urls()
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of tests/admin_inlines/tests.py.
Extra Requirements: 
Purpose: I need to find existing test cases that demonstrate how to test customizable hooks on ModelAdmin, which will serve as a pattern for testing the new `get_inlines` method.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/admin_inlines/tests.py
Line number range: 1 - 500
Content:
1. from django.contrib.admin import ModelAdmin, TabularInline
2. from django.contrib.admin.helpers import InlineAdminForm
3. from django.contrib.admin.tests import AdminSeleniumTestCase
4. from django.contrib.auth.models import Permission, User
5. from django.contrib.contenttypes.models import ContentType
6. from django.test import RequestFactory, TestCase, override_settings
7. from django.urls import reverse
8. 
9. from .admin import InnerInline, site as admin_site
10. from .models import (
11.     Author, BinaryTree, Book, Chapter, Child, ChildModel1, ChildModel2,
12.     Fashionista, FootNote, Holder, Holder2, Holder3, Holder4, Inner, Inner2,
13.     Inner3, Inner4Stacked, Inner4Tabular, Novel, OutfitItem, Parent,
14.     ParentModelWithCustomPk, Person, Poll, Profile, ProfileCollection,
15.     Question, Sighting, SomeChildModel, SomeParentModel, Teacher,
16. )
17. 
18. INLINE_CHANGELINK_HTML = 'class="inlinechangelink">Change</a>'
19. 
20. 
21. class TestDataMixin:
22. 
23.     @classmethod
24.     def setUpTestData(cls):
25.         cls.superuser = User.objects.create_superuser(username='super', email='super@example.com', password='secret')
26. 
27. 
28. @override_settings(ROOT_URLCONF='admin_inlines.urls')
29. class TestInline(TestDataMixin, TestCase):
30.     factory = RequestFactory()
31. 
32.     @classmethod
33.     def setUpTestData(cls):
34.         super().setUpTestData()
35.         cls.holder = Holder.objects.create(dummy=13)
36.         Inner.objects.create(dummy=42, holder=cls.holder)
37. 
38.     def setUp(self):
39.         self.client.force_login(self.superuser)
40. 
41.     def test_can_delete(self):
42.         """
43.         can_delete should be passed to inlineformset factory.
44.         """
45.         response = self.client.get(
46.             reverse('admin:admin_inlines_holder_change', args=(self.holder.id,))
47.         )
48.         inner_formset = response.context['inline_admin_formsets'][0].formset
49.         expected = InnerInline.can_delete
50.         actual = inner_formset.can_delete
51.         self.assertEqual(expected, actual, 'can_delete must be equal')
52. 
53.     def test_readonly_stacked_inline_label(self):
54.         """Bug #13174."""
55.         holder = Holder.objects.create(dummy=42)
56.         Inner.objects.create(holder=holder, dummy=42, readonly='')
57.         response = self.client.get(
58.             reverse('admin:admin_inlines_holder_change', args=(holder.id,))
59.         )
60.         self.assertContains(response, '<label>Inner readonly label:</label>')
61. 
62.     def test_many_to_many_inlines(self):
63.         "Autogenerated many-to-many inlines are displayed correctly (#13407)"
64.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
65.         # The heading for the m2m inline block uses the right text
66.         self.assertContains(response, '<h2>Author-book relationships</h2>')
67.         # The "add another" label is correct
68.         self.assertContains(response, 'Add another Author-book relationship')
69.         # The '+' is dropped from the autogenerated form prefix (Author_books+)
70.         self.assertContains(response, 'id="id_Author_books-TOTAL_FORMS"')
71. 
72.     def test_inline_primary(self):
73.         person = Person.objects.create(firstname='Imelda')
74.         item = OutfitItem.objects.create(name='Shoes')
75.         # Imelda likes shoes, but can't carry her own bags.
76.         data = {
77.             'shoppingweakness_set-TOTAL_FORMS': 1,
78.             'shoppingweakness_set-INITIAL_FORMS': 0,
79.             'shoppingweakness_set-MAX_NUM_FORMS': 0,
80.             '_save': 'Save',
81.             'person': person.id,
82.             'max_weight': 0,
83.             'shoppingweakness_set-0-item': item.id,
84.         }
85.         response = self.client.post(reverse('admin:admin_inlines_fashionista_add'), data)
86.         self.assertEqual(response.status_code, 302)
87.         self.assertEqual(len(Fashionista.objects.filter(person__firstname='Imelda')), 1)
88. 
89.     def test_tabular_inline_column_css_class(self):
90.         """
91.         Field names are included in the context to output a field-specific
92.         CSS class name in the column headers.
93.         """
94.         response = self.client.get(reverse('admin:admin_inlines_poll_add'))
95.         text_field, call_me_field = list(response.context['inline_admin_formset'].fields())
96.         # Editable field.
97.         self.assertEqual(text_field['name'], 'text')
98.         self.assertContains(response, '<th class="column-text required">')
99.         # Read-only field.
100.         self.assertEqual(call_me_field['name'], 'call_me')
101.         self.assertContains(response, '<th class="column-call_me">')
102. 
103.     def test_custom_form_tabular_inline_label(self):
104.         """
105.         A model form with a form field specified (TitleForm.title1) should have
106.         its label rendered in the tabular inline.
107.         """
108.         response = self.client.get(reverse('admin:admin_inlines_titlecollection_add'))
109.         self.assertContains(response, '<th class="column-title1 required">Title1</th>', html=True)
110. 
111.     def test_custom_form_tabular_inline_overridden_label(self):
112.         """
113.         SomeChildModelForm.__init__() overrides the label of a form field.
114.         That label is displayed in the TabularInline.
115.         """
116.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_add'))
117.         field = list(response.context['inline_admin_formset'].fields())[0]
118.         self.assertEqual(field['label'], 'new label')
119.         self.assertContains(response, '<th class="column-name required">New label</th>', html=True)
120. 
121.     def test_tabular_non_field_errors(self):
122.         """
123.         non_field_errors are displayed correctly, including the correct value
124.         for colspan.
125.         """
126.         data = {
127.             'title_set-TOTAL_FORMS': 1,
128.             'title_set-INITIAL_FORMS': 0,
129.             'title_set-MAX_NUM_FORMS': 0,
130.             '_save': 'Save',
131.             'title_set-0-title1': 'a title',
132.             'title_set-0-title2': 'a different title',
133.         }
134.         response = self.client.post(reverse('admin:admin_inlines_titlecollection_add'), data)
135.         # Here colspan is "4": two fields (title1 and title2), one hidden field and the delete checkbox.
136.         self.assertContains(
137.             response,
138.             '<tr><td colspan="4"><ul class="errorlist nonfield">'
139.             '<li>The two titles must be the same</li></ul></td></tr>'
140.         )
141. 
142.     def test_no_parent_callable_lookup(self):
143.         """Admin inline `readonly_field` shouldn't invoke parent ModelAdmin callable"""
144.         # Identically named callable isn't present in the parent ModelAdmin,
145.         # rendering of the add view shouldn't explode
146.         response = self.client.get(reverse('admin:admin_inlines_novel_add'))
147.         self.assertEqual(response.status_code, 200)
148.         # View should have the child inlines section
149.         self.assertContains(
150.             response,
151.             '<div class="js-inline-admin-formset inline-group" id="chapter_set-group"'
152.         )
153. 
154.     def test_callable_lookup(self):
155.         """Admin inline should invoke local callable when its name is listed in readonly_fields"""
156.         response = self.client.get(reverse('admin:admin_inlines_poll_add'))
157.         self.assertEqual(response.status_code, 200)
158.         # Add parent object view should have the child inlines section
159.         self.assertContains(
160.             response,
161.             '<div class="js-inline-admin-formset inline-group" id="question_set-group"'
162.         )
163.         # The right callable should be used for the inline readonly_fields
164.         # column cells
165.         self.assertContains(response, '<p>Callable in QuestionInline</p>')
166. 
167.     def test_help_text(self):
168.         """
169.         The inlines' model field help texts are displayed when using both the
170.         stacked and tabular layouts.
171.         """
172.         response = self.client.get(reverse('admin:admin_inlines_holder4_add'))
173.         self.assertContains(response, '<div class="help">Awesome stacked help text is awesome.</div>', 4)
174.         self.assertContains(
175.             response,
176.             '<img src="/static/admin/img/icon-unknown.svg" '
177.             'class="help help-tooltip" width="10" height="10" '
178.             'alt="(Awesome tabular help text is awesome.)" '
179.             'title="Awesome tabular help text is awesome.">',
180.             1
181.         )
182.         # ReadOnly fields
183.         response = self.client.get(reverse('admin:admin_inlines_capofamiglia_add'))
184.         self.assertContains(
185.             response,
186.             '<img src="/static/admin/img/icon-unknown.svg" '
187.             'class="help help-tooltip" width="10" height="10" '
188.             'alt="(Help text for ReadOnlyInline)" '
189.             'title="Help text for ReadOnlyInline">',
190.             1
191.         )
192. 
193.     def test_tabular_model_form_meta_readonly_field(self):
194.         """
195.         Tabular inlines use ModelForm.Meta.help_texts and labels for read-only
196.         fields.
197.         """
198.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_add'))
199.         self.assertContains(
200.             response,
201.             '<img src="/static/admin/img/icon-unknown.svg" '
202.             'class="help help-tooltip" width="10" height="10" '
203.             'alt="(Help text from ModelForm.Meta)" '
204.             'title="Help text from ModelForm.Meta">'
205.         )
206.         self.assertContains(response, 'Label from ModelForm.Meta')
207. 
208.     def test_inline_hidden_field_no_column(self):
209.         """#18263 -- Make sure hidden fields don't get a column in tabular inlines"""
210.         parent = SomeParentModel.objects.create(name='a')
211.         SomeChildModel.objects.create(name='b', position='0', parent=parent)
212.         SomeChildModel.objects.create(name='c', position='1', parent=parent)
213.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_change', args=(parent.pk,)))
214.         self.assertNotContains(response, '<td class="field-position">')
215.         self.assertInHTML(
216.             '<input id="id_somechildmodel_set-1-position" '
217.             'name="somechildmodel_set-1-position" type="hidden" value="1">',
218.             response.rendered_content,
219.         )
220. 
221.     def test_non_related_name_inline(self):
222.         """
223.         Multiple inlines with related_name='+' have correct form prefixes.
224.         """
225.         response = self.client.get(reverse('admin:admin_inlines_capofamiglia_add'))
226.         self.assertContains(response, '<input type="hidden" name="-1-0-id" id="id_-1-0-id">', html=True)
227.         self.assertContains(
228.             response,
229.             '<input type="hidden" name="-1-0-capo_famiglia" id="id_-1-0-capo_famiglia">',
230.             html=True
231.         )
232.         self.assertContains(
233.             response,
234.             '<input id="id_-1-0-name" type="text" class="vTextField" name="-1-0-name" maxlength="100">',
235.             html=True
236.         )
237.         self.assertContains(response, '<input type="hidden" name="-2-0-id" id="id_-2-0-id">', html=True)
238.         self.assertContains(
239.             response,
240.             '<input type="hidden" name="-2-0-capo_famiglia" id="id_-2-0-capo_famiglia">',
241.             html=True
242.         )
243.         self.assertContains(
244.             response,
245.             '<input id="id_-2-0-name" type="text" class="vTextField" name="-2-0-name" maxlength="100">',
246.             html=True
247.         )
248. 
249.     @override_settings(USE_L10N=True, USE_THOUSAND_SEPARATOR=True)
250.     def test_localize_pk_shortcut(self):
251.         """
252.         The "View on Site" link is correct for locales that use thousand
253.         separators.
254.         """
255.         holder = Holder.objects.create(pk=123456789, dummy=42)
256.         inner = Inner.objects.create(pk=987654321, holder=holder, dummy=42, readonly='')
257.         response = self.client.get(reverse('admin:admin_inlines_holder_change', args=(holder.id,)))
258.         inner_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(inner).pk, inner.pk)
259.         self.assertContains(response, inner_shortcut)
260. 
261.     def test_custom_pk_shortcut(self):
262.         """
263.         The "View on Site" link is correct for models with a custom primary key
264.         field.
265.         """
266.         parent = ParentModelWithCustomPk.objects.create(my_own_pk="foo", name="Foo")
267.         child1 = ChildModel1.objects.create(my_own_pk="bar", name="Bar", parent=parent)
268.         child2 = ChildModel2.objects.create(my_own_pk="baz", name="Baz", parent=parent)
269.         response = self.client.get(reverse('admin:admin_inlines_parentmodelwithcustompk_change', args=('foo',)))
270.         child1_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(child1).pk, child1.pk)
271.         child2_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(child2).pk, child2.pk)
272.         self.assertContains(response, child1_shortcut)
273.         self.assertContains(response, child2_shortcut)
274. 
275.     def test_create_inlines_on_inherited_model(self):
276.         """
277.         An object can be created with inlines when it inherits another class.
278.         """
279.         data = {
280.             'name': 'Martian',
281.             'sighting_set-TOTAL_FORMS': 1,
282.             'sighting_set-INITIAL_FORMS': 0,
283.             'sighting_set-MAX_NUM_FORMS': 0,
284.             'sighting_set-0-place': 'Zone 51',
285.             '_save': 'Save',
286.         }
287.         response = self.client.post(reverse('admin:admin_inlines_extraterrestrial_add'), data)
288.         self.assertEqual(response.status_code, 302)
289.         self.assertEqual(Sighting.objects.filter(et__name='Martian').count(), 1)
290. 
291.     def test_custom_get_extra_form(self):
292.         bt_head = BinaryTree.objects.create(name="Tree Head")
293.         BinaryTree.objects.create(name="First Child", parent=bt_head)
294.         # The maximum number of forms should respect 'get_max_num' on the
295.         # ModelAdmin
296.         max_forms_input = (
297.             '<input id="id_binarytree_set-MAX_NUM_FORMS" '
298.             'name="binarytree_set-MAX_NUM_FORMS" type="hidden" value="%d">'
299.         )
300.         # The total number of forms will remain the same in either case
301.         total_forms_hidden = (
302.             '<input id="id_binarytree_set-TOTAL_FORMS" '
303.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="2">'
304.         )
305.         response = self.client.get(reverse('admin:admin_inlines_binarytree_add'))
306.         self.assertInHTML(max_forms_input % 3, response.rendered_content)
307.         self.assertInHTML(total_forms_hidden, response.rendered_content)
308. 
309.         response = self.client.get(reverse('admin:admin_inlines_binarytree_change', args=(bt_head.id,)))
310.         self.assertInHTML(max_forms_input % 2, response.rendered_content)
311.         self.assertInHTML(total_forms_hidden, response.rendered_content)
312. 
313.     def test_min_num(self):
314.         """
315.         min_num and extra determine number of forms.
316.         """
317.         class MinNumInline(TabularInline):
318.             model = BinaryTree
319.             min_num = 2
320.             extra = 3
321. 
322.         modeladmin = ModelAdmin(BinaryTree, admin_site)
323.         modeladmin.inlines = [MinNumInline]
324.         min_forms = (
325.             '<input id="id_binarytree_set-MIN_NUM_FORMS" '
326.             'name="binarytree_set-MIN_NUM_FORMS" type="hidden" value="2">'
327.         )
328.         total_forms = (
329.             '<input id="id_binarytree_set-TOTAL_FORMS" '
330.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="5">'
331.         )
332.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_add'))
333.         request.user = User(username='super', is_superuser=True)
334.         response = modeladmin.changeform_view(request)
335.         self.assertInHTML(min_forms, response.rendered_content)
336.         self.assertInHTML(total_forms, response.rendered_content)
337. 
338.     def test_custom_min_num(self):
339.         bt_head = BinaryTree.objects.create(name="Tree Head")
340.         BinaryTree.objects.create(name="First Child", parent=bt_head)
341. 
342.         class MinNumInline(TabularInline):
343.             model = BinaryTree
344.             extra = 3
345. 
346.             def get_min_num(self, request, obj=None, **kwargs):
347.                 if obj:
348.                     return 5
349.                 return 2
350. 
351.         modeladmin = ModelAdmin(BinaryTree, admin_site)
352.         modeladmin.inlines = [MinNumInline]
353.         min_forms = (
354.             '<input id="id_binarytree_set-MIN_NUM_FORMS" '
355.             'name="binarytree_set-MIN_NUM_FORMS" type="hidden" value="%d">'
356.         )
357.         total_forms = (
358.             '<input id="id_binarytree_set-TOTAL_FORMS" '
359.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="%d">'
360.         )
361.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_add'))
362.         request.user = User(username='super', is_superuser=True)
363.         response = modeladmin.changeform_view(request)
364.         self.assertInHTML(min_forms % 2, response.rendered_content)
365.         self.assertInHTML(total_forms % 5, response.rendered_content)
366. 
367.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_change', args=(bt_head.id,)))
368.         request.user = User(username='super', is_superuser=True)
369.         response = modeladmin.changeform_view(request, object_id=str(bt_head.id))
370.         self.assertInHTML(min_forms % 5, response.rendered_content)
371.         self.assertInHTML(total_forms % 8, response.rendered_content)
372. 
373.     def test_inline_nonauto_noneditable_pk(self):
374.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
375.         self.assertContains(
376.             response,
377.             '<input id="id_nonautopkbook_set-0-rand_pk" '
378.             'name="nonautopkbook_set-0-rand_pk" type="hidden">',
379.             html=True
380.         )
381.         self.assertContains(
382.             response,
383.             '<input id="id_nonautopkbook_set-2-0-rand_pk" '
384.             'name="nonautopkbook_set-2-0-rand_pk" type="hidden">',
385.             html=True
386.         )
387. 
388.     def test_inline_nonauto_noneditable_inherited_pk(self):
389.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
390.         self.assertContains(
391.             response,
392.             '<input id="id_nonautopkbookchild_set-0-nonautopkbook_ptr" '
393.             'name="nonautopkbookchild_set-0-nonautopkbook_ptr" type="hidden">',
394.             html=True
395.         )
396.         self.assertContains(
397.             response,
398.             '<input id="id_nonautopkbookchild_set-2-nonautopkbook_ptr" '
399.             'name="nonautopkbookchild_set-2-nonautopkbook_ptr" type="hidden">',
400.             html=True
401.         )
402. 
403.     def test_inline_editable_pk(self):
404.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
405.         self.assertContains(
406.             response,
407.             '<input class="vIntegerField" id="id_editablepkbook_set-0-manual_pk" '
408.             'name="editablepkbook_set-0-manual_pk" type="number">',
409.             html=True, count=1
410.         )
411.         self.assertContains(
412.             response,
413.             '<input class="vIntegerField" id="id_editablepkbook_set-2-0-manual_pk" '
414.             'name="editablepkbook_set-2-0-manual_pk" type="number">',
415.             html=True, count=1
416.         )
417. 
418.     def test_stacked_inline_edit_form_contains_has_original_class(self):
419.         holder = Holder.objects.create(dummy=1)
420.         holder.inner_set.create(dummy=1)
421.         response = self.client.get(reverse('admin:admin_inlines_holder_change', args=(holder.pk,)))
422.         self.assertContains(
423.             response,
424.             '<div class="inline-related has_original" id="inner_set-0">',
425.             count=1
426.         )
427.         self.assertContains(
428.             response,
429.             '<div class="inline-related" id="inner_set-1">',
430.             count=1
431.         )
432. 
433.     def test_inlines_show_change_link_registered(self):
434.         "Inlines `show_change_link` for registered models when enabled."
435.         holder = Holder4.objects.create(dummy=1)
436.         item1 = Inner4Stacked.objects.create(dummy=1, holder=holder)
437.         item2 = Inner4Tabular.objects.create(dummy=1, holder=holder)
438.         items = (
439.             ('inner4stacked', item1.pk),
440.             ('inner4tabular', item2.pk),
441.         )
442.         response = self.client.get(reverse('admin:admin_inlines_holder4_change', args=(holder.pk,)))
443.         self.assertTrue(response.context['inline_admin_formset'].opts.has_registered_model)
444.         for model, pk in items:
445.             url = reverse('admin:admin_inlines_%s_change' % model, args=(pk,))
446.             self.assertContains(response, '<a href="%s" %s' % (url, INLINE_CHANGELINK_HTML))
447. 
448.     def test_inlines_show_change_link_unregistered(self):
449.         "Inlines `show_change_link` disabled for unregistered models."
450.         parent = ParentModelWithCustomPk.objects.create(my_own_pk="foo", name="Foo")
451.         ChildModel1.objects.create(my_own_pk="bar", name="Bar", parent=parent)
452.         ChildModel2.objects.create(my_own_pk="baz", name="Baz", parent=parent)
453.         response = self.client.get(reverse('admin:admin_inlines_parentmodelwithcustompk_change', args=('foo',)))
454.         self.assertFalse(response.context['inline_admin_formset'].opts.has_registered_model)
455.         self.assertNotContains(response, INLINE_CHANGELINK_HTML)
456. 
457.     def test_tabular_inline_show_change_link_false_registered(self):
458.         "Inlines `show_change_link` disabled by default."
459.         poll = Poll.objects.create(name="New poll")
460.         Question.objects.create(poll=poll)
461.         response = self.client.get(reverse('admin:admin_inlines_poll_change', args=(poll.pk,)))
462.         self.assertTrue(response.context['inline_admin_formset'].opts.has_registered_model)
463.         self.assertNotContains(response, INLINE_CHANGELINK_HTML)
464. 
465.     def test_noneditable_inline_has_field_inputs(self):
466.         """Inlines without change permission shows field inputs on add form."""
467.         response = self.client.get(reverse('admin:admin_inlines_novelreadonlychapter_add'))
468.         self.assertContains(
469.             response,
470.             '<input type="text" name="chapter_set-0-name" '
471.             'class="vTextField" maxlength="40" id="id_chapter_set-0-name">',
472.             html=True
473.         )
474. 
475. 
476. @override_settings(ROOT_URLCONF='admin_inlines.urls')
477. class TestInlineMedia(TestDataMixin, TestCase):
478. 
479.     def setUp(self):
480.         self.client.force_login(self.superuser)
481. 
482.     def test_inline_media_only_base(self):
483.         holder = Holder(dummy=13)
484.         holder.save()
485.         Inner(dummy=42, holder=holder).save()
486.         change_url = reverse('admin:admin_inlines_holder_change', args=(holder.id,))
487.         response = self.client.get(change_url)
488.         self.assertContains(response, 'my_awesome_admin_scripts.js')
489. 
490.     def test_inline_media_only_inline(self):
491.         holder = Holder3(dummy=13)
492.         holder.save()
493.         Inner3(dummy=42, holder=holder).save()
494.         change_url = reverse('admin:admin_inlines_holder3_change', args=(holder.id,))
495.         response = self.client.get(change_url)
496.         self.assertEqual(
497.             response.context['inline_admin_formsets'][0].media._js,
498.             [
499.                 'admin/js/vendor/jquery/jquery.min.js',
500.                 'my_awesome_inline_scripts.js',

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 18:52:06,588 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The current context provides tests for `get_...` hooks on `InlineModelAdmin`, but the user's patch adds a hook to `ModelAdmin`. To write relevant tests, I need to see how existing `ModelAdmin` hooks that depend on the request (like `get_list_display` or `get_readonly_fields`) are tested. The file `tests/admin_views/tests.py` is likely to contain such tests, as it deals with admin views which handle requests." query='Please provide the full content of tests/admin_views/tests.py.' extra_requirements='If the file is too large, please include at least tests for `get_list_display`, `get_readonly_fields`, and `get_queryset`.' purpose='I need to find test cases for `ModelAdmin` hooks that are dependent on the HTTP request, which will serve as a template for testing the new `get_inlines` method.'
2025-12-24 18:52:06,589 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of tests/admin_views/tests.py.
2025-12-24 18:52:06,589 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 18:52:06,590 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 18:52:06,591 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 18:52:06,591 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of tests/admin_views/tests.py.
Extra requirements: If the file is too large, please include at least tests for `get_list_display`, `get_readonly_fields`, and `get_queryset`.
Purpose: I need to find test cases for `ModelAdmin` hooks that are dependent on the HTTP request, which will serve as a template for testing the new `get_inlines` method.
2025-12-24 18:52:11,564 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will first read the full content of the file `tests/admin_views/tests.py` to provide you with the test cases you need. If the file is too large, I will then specifically look for tests related to `get_list_display`, `get_readonly_fields`, and `get_queryset` as you requested. This will give you the necessary context to create test cases for the new `get_inlines` method.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2140, 'candidates_token_count': 116, 'total_token_count': 2598, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2140}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 116}], 'thoughts_token_count': 342, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2983420470665241, 'model_name': 'gemini-2.5-pro'} id='run--be504a2e-17da-4ada-a087-60c34f1d7c42-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_views/tests.py'}, 'id': '095656c8-cb6e-49d9-bfbd-bb0eae67d533', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2140, 'output_tokens': 116, 'total_tokens': 2598, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 342}}
2025-12-24 18:52:14,390 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the initial 500 lines of `tests/admin_views/tests.py`. Since the file is large and the full content was not displayed, I will now proceed to search for the specific tests you requested to find the relevant test cases for `ModelAdmin` hooks. I will start by searching for tests related to `get_list_display`.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "get_list_display", "relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11232, 'candidates_token_count': 113, 'total_token_count': 11419, 'cached_content_token_count': 1846, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11232}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1846}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 113}], 'thoughts_token_count': 74}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15124120121508572, 'model_name': 'gemini-2.5-pro'} id='run--11072790-a919-4c58-b106-1f634afbf927-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'get_list_display', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '37a5fda7-3b21-4985-94a9-355c722f9034', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11232, 'output_tokens': 113, 'total_tokens': 11419, 'input_token_details': {'cache_read': 1846}, 'output_token_details': {'reasoning': 74}}
2025-12-24 18:52:18,596 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I was unable to find any tests with "get_list_display" in their names. I will now broaden my search to see how `get_list_display` is used within the file, which may still help locate the relevant test cases you need. After that, I will proceed to search for tests related to `get_readonly_fields` and `get_queryset`.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "def get_list_display", "relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11377, 'candidates_token_count': 116, 'total_token_count': 11721, 'cached_content_token_count': 11064, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11377}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11064}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 116}], 'thoughts_token_count': 228}, 'finish_reason': 'STOP', 'avg_logprobs': -0.28069466557996026, 'model_name': 'gemini-2.5-pro'} id='run--fddb0b38-1099-44f6-b469-f9be62bc259c-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def get_list_display', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '3dd29c4f-62c0-46e2-81f1-e2acc2aaae6d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11377, 'output_tokens': 116, 'total_tokens': 11721, 'input_token_details': {'cache_read': 11064}, 'output_token_details': {'reasoning': 228}}
2025-12-24 18:52:22,565 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I couldn't find any method definitions for `get_list_display` within the file. It's possible that this method is being tested implicitly or through a different naming convention. I will now move on to search for tests related to `get_readonly_fields` to find the relevant examples you're looking for." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "get_readonly_fields", "relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11525, 'candidates_token_count': 104, 'total_token_count': 11848, 'cached_content_token_count': 11048, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11525}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11048}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 104}], 'thoughts_token_count': 219}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3911314377417931, 'model_name': 'gemini-2.5-pro'} id='run--b704d936-f790-4a50-973c-ca8fa2f52d6c-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'get_readonly_fields', 'relative_path': 'tests/admin_views/tests.py'}, 'id': 'cfc2ed04-4c5c-421c-8d46-d69830534bc9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11525, 'output_tokens': 104, 'total_tokens': 11848, 'input_token_details': {'cache_read': 11048}, 'output_token_details': {'reasoning': 219}}
2025-12-24 18:52:24,656 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='The search for "get_readonly_fields" also returned no results. It seems my initial approach of searching for the exact method names in the test file is not working. I will now try to find the `ModelAdmin` classes within the test file, and then inspect their methods to see how the request-dependent hooks are being tested. This should give us the context needed to test the new `get_inlines` method. I\'ll start by looking for `ModelAdmin` class definitions.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"type": "class_definition", "relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11661, 'candidates_token_count': 135, 'total_token_count': 11796, 'cached_content_token_count': 11031, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11661}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11031}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 135}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.14004946108217592, 'model_name': 'gemini-2.5-pro'} id='run--19431308-1cd0-4043-aa0c-caa3b99eef09-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'type': 'class_definition', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '1c474d36-5922-4d2e-9c6b-d5061f44bc50', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11661, 'output_tokens': 135, 'total_tokens': 11796, 'input_token_details': {'cache_read': 11031}}
2025-12-24 18:52:27,755 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have found the class definitions in the test file and identified `AdminViewBasicTest` as the most relevant one. I will now examine this class to find tests related to `get_list_display`, `get_readonly_fields`, and `get_queryset`, starting with a search for "queryset" within the class.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "test_change_list_sorting_preserve_queryset_ordering", "relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 24772, 'candidates_token_count': 112, 'total_token_count': 24996, 'cached_content_token_count': 11312, 'prompt_tokens_details': [{'modality': 1, 'token_count': 24772}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11312}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 112}], 'thoughts_token_count': 112}, 'finish_reason': 'STOP', 'avg_logprobs': -0.17977084432329452, 'model_name': 'gemini-2.5-pro'} id='run--85a41a8c-4dfc-4cda-a1df-a93007564cd2-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'test_change_list_sorting_preserve_queryset_ordering', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '7aa8204d-d7fd-4cf4-ae23-6932e151b26e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 24772, 'output_tokens': 112, 'total_tokens': 24996, 'input_token_details': {'cache_read': 11312}, 'output_token_details': {'reasoning': 112}}
2025-12-24 18:52:34,340 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the `test_change_list_sorting_preserve_queryset_ordering` test within the `AdminViewBasicTest` class, which provides a solid example of how to test `get_queryset`. To find similar tests for `get_list_display` and `get_readonly_fields`, I will now examine the file for usages of `get_admin_readonly_fields` and then read the full content of all relevant tests. This will provide you with a comprehensive set of templates for testing the new `get_inlines` method.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1.0, "relative_path": "tests/admin_views/tests.py", "end_line": 6050.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 37373, 'candidates_token_count': 144, 'total_token_count': 37988, 'cached_content_token_count': 24714, 'prompt_tokens_details': [{'modality': 1, 'token_count': 37373}], 'cache_tokens_details': [{'modality': 1, 'token_count': 24714}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 144}], 'thoughts_token_count': 471}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6415065129597982, 'model_name': 'gemini-2.5-pro'} id='run--e2c652a8-8378-44ee-bbe8-a5c866bc36c5-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1.0, 'relative_path': 'tests/admin_views/tests.py', 'end_line': 6050.0}, 'id': '610483f2-ef58-437e-84ef-638d7f5428ef', 'type': 'tool_call'}] usage_metadata={'input_tokens': 37373, 'output_tokens': 144, 'total_tokens': 37988, 'input_token_details': {'cache_read': 24714}, 'output_token_details': {'reasoning': 471}}
2025-12-24 18:52:41,727 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now read the entire content of `tests/admin_views/tests.py`. I found several relevant tests, including `test_change_list_sorting_preserve_queryset_ordering` which directly addresses `get_queryset`. I also located `AdminFieldExtractionMixin` and the `ReadonlyTest` class, which contain tests for `get_readonly_fields`. However, I was unable to find explicit tests for `get_list_display`. It is likely that this functionality is tested implicitly within other tests. I will now provide the full content of the file as you requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 323.0, "end_line": 4814.0, "relative_path": "tests/admin_views/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 157138, 'candidates_token_count': 151, 'total_token_count': 157505, 'prompt_tokens_details': [{'modality': 1, 'token_count': 157138}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 151}], 'thoughts_token_count': 216, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4752557009261176, 'model_name': 'gemini-2.5-pro'} id='run--d2604993-5350-4cf7-8463-d63e449c5c0e-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 323.0, 'end_line': 4814.0, 'relative_path': 'tests/admin_views/tests.py'}, 'id': '866ee1a7-e612-434a-8537-b0b642765e20', 'type': 'tool_call'}] usage_metadata={'input_tokens': 157138, 'output_tokens': 151, 'total_tokens': 157505, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 216}}
2025-12-24 18:52:48,139 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have provided the full content of the `tests/admin_views/tests.py` file as you requested. I found relevant tests for `get_queryset` and `get_readonly_fields`, which will serve as excellent templates for testing your new `get_inlines` method. Although there were no explicit tests for `get_list_display`, the provided code contains numerous examples of how `list_display` is used and tested indirectly, which should still be helpful.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 248121, 'candidates_token_count': 99, 'total_token_count': 248483, 'cached_content_token_count': 157779, 'prompt_tokens_details': [{'modality': 1, 'token_count': 248121}], 'cache_tokens_details': [{'modality': 1, 'token_count': 157779}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 99}], 'thoughts_token_count': 263}, 'finish_reason': 'STOP', 'avg_logprobs': -0.42453322747741085, 'model_name': 'gemini-2.5-pro'} id='run--3488ce92-ccf3-4ce1-bd0d-bc75061cc973-0' usage_metadata={'input_tokens': 248121, 'output_tokens': 99, 'total_tokens': 248483, 'input_token_details': {'cache_read': 157779}, 'output_token_details': {'reasoning': 263}}
2025-12-24 18:52:48,146 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of tests/admin_views/tests.py.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please include at least tests for `get_list_display`, `get_readonly_fields`, and `get_queryset`.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find test cases for `ModelAdmin` hooks that are dependent on the HTTP request, which will serve as a template for testing the new `get_inlines` method.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/admin_views/tests.py
Line number range: 1 - 6050
Content:
1. import datetime
2. import os
3. import re
4. import unittest
5. from unittest import mock
6. from urllib.parse import parse_qsl, urljoin, urlparse
7. 
8. import pytz
9. 
10. from django.contrib.admin import AdminSite, ModelAdmin
11. from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
12. from django.contrib.admin.models import ADDITION, DELETION, LogEntry
13. from django.contrib.admin.options import TO_FIELD_VAR
14. from django.contrib.admin.templatetags.admin_urls import add_preserved_filters
15. from django.contrib.admin.tests import AdminSeleniumTestCase
16. from django.contrib.admin.utils import quote
17. from django.contrib.admin.views.main import IS_POPUP_VAR
18. from django.contrib.auth import REDIRECT_FIELD_NAME, get_permission_codename
19. from django.contrib.auth.models import Group, Permission, User
20. from django.contrib.contenttypes.models import ContentType
21. from django.core import mail
22. from django.core.checks import Error
23. from django.core.files import temp as tempfile
24. from django.forms.utils import ErrorList
25. from django.template.response import TemplateResponse
26. from django.test import (
27.     TestCase, modify_settings, override_settings, skipUnlessDBFeature,
28. )
29. from django.test.utils import override_script_prefix
30. from django.urls import NoReverseMatch, resolve, reverse
31. from django.utils import formats, translation
32. from django.utils.cache import get_max_age
33. from django.utils.encoding import iri_to_uri
34. from django.utils.html import escape
35. from django.utils.http import urlencode
36. 
37. from . import customadmin
38. from .admin import CityAdmin, site, site2
39. from .models import (
40.     Actor, AdminOrderedAdminMethod, AdminOrderedCallable, AdminOrderedField,
41.     AdminOrderedModelMethod, Answer, Answer2, Article, BarAccount, Book,
42.     Bookmark, Category, Chapter, ChapterXtra1, ChapterXtra2, Character, Child,
43.     Choice, City, Collector, Color, ComplexSortedPerson, CoverLetter,
44.     CustomArticle, CyclicOne, CyclicTwo, DooHickey, Employee, EmptyModel,
45.     Fabric, FancyDoodad, FieldOverridePost, FilteredManager, FooAccount,
46.     FoodDelivery, FunkyTag, Gallery, Grommet, Inquisition, Language, Link,
47.     MainPrepopulated, Media, ModelWithStringPrimaryKey, OtherStory, Paper,
48.     Parent, ParentWithDependentChildren, ParentWithUUIDPK, Person, Persona,
49.     Picture, Pizza, Plot, PlotDetails, PluggableSearchPerson, Podcast, Post,
50.     PrePopulatedPost, Promo, Question, ReadablePizza, ReadOnlyPizza,
51.     Recommendation, Recommender, RelatedPrepopulated, RelatedWithUUIDPKModel,
52.     Report, Restaurant, RowLevelChangePermissionModel, SecretHideout, Section,
53.     ShortMessage, Simple, State, Story, SuperSecretHideout, SuperVillain,
54.     Telegram, TitleTranslation, Topping, UnchangeableObject, UndeletableObject,
55.     UnorderedObject, UserProxy, Villain, Vodcast, Whatsit, Widget, Worker,
56.     WorkHour,
57. )
58. 
59. ERROR_MESSAGE = "Please enter the correct username and password \
60. for a staff account. Note that both fields may be case-sensitive."
61. 
62. MULTIPART_ENCTYPE = 'enctype="multipart/form-data"'
63. 
64. 
65. class AdminFieldExtractionMixin:
66.     """
67.     Helper methods for extracting data from AdminForm.
68.     """
69.     def get_admin_form_fields(self, response):
70.         """
71.         Return a list of AdminFields for the AdminForm in the response.
72.         """
73.         fields = []
74.         for fieldset in response.context['adminform']:
75.             for field_line in fieldset:
76.                 fields.extend(field_line)
77.         return fields
78. 
79.     def get_admin_readonly_fields(self, response):
80.         """
81.         Return the readonly fields for the response's AdminForm.
82.         """
83.         return [f for f in self.get_admin_form_fields(response) if f.is_readonly]
84. 
85.     def get_admin_readonly_field(self, response, field_name):
86.         """
87.         Return the readonly field for the given field_name.
88.         """
89.         admin_readonly_fields = self.get_admin_readonly_fields(response)
90.         for field in admin_readonly_fields:
91.             if field.field['name'] == field_name:
92.                 return field
93. 
94. 
95. @override_settings(ROOT_URLCONF='admin_views.urls', USE_I18N=True, USE_L10N=False, LANGUAGE_CODE='en')
96. class AdminViewBasicTestCase(TestCase):
97. 
98.     @classmethod
99.     def setUpTestData(cls):
100.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
101.         cls.s1 = Section.objects.create(name='Test section')
102.         cls.a1 = Article.objects.create(
103.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
104.         )
105.         cls.a2 = Article.objects.create(
106.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
107.         )
108.         cls.a3 = Article.objects.create(
109.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
110.         )
111.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
112.         cls.color1 = Color.objects.create(value='Red', warm=True)
113.         cls.color2 = Color.objects.create(value='Orange', warm=True)
114.         cls.color3 = Color.objects.create(value='Blue', warm=False)
115.         cls.color4 = Color.objects.create(value='Green', warm=False)
116.         cls.fab1 = Fabric.objects.create(surface='x')
117.         cls.fab2 = Fabric.objects.create(surface='y')
118.         cls.fab3 = Fabric.objects.create(surface='plain')
119.         cls.b1 = Book.objects.create(name='Book 1')
120.         cls.b2 = Book.objects.create(name='Book 2')
121.         cls.pro1 = Promo.objects.create(name='Promo 1', book=cls.b1)
122.         cls.pro1 = Promo.objects.create(name='Promo 2', book=cls.b2)
123.         cls.chap1 = Chapter.objects.create(title='Chapter 1', content='[ insert contents here ]', book=cls.b1)
124.         cls.chap2 = Chapter.objects.create(title='Chapter 2', content='[ insert contents here ]', book=cls.b1)
125.         cls.chap3 = Chapter.objects.create(title='Chapter 1', content='[ insert contents here ]', book=cls.b2)
126.         cls.chap4 = Chapter.objects.create(title='Chapter 2', content='[ insert contents here ]', book=cls.b2)
127.         cls.cx1 = ChapterXtra1.objects.create(chap=cls.chap1, xtra='ChapterXtra1 1')
128.         cls.cx2 = ChapterXtra1.objects.create(chap=cls.chap3, xtra='ChapterXtra1 2')
129.         Actor.objects.create(name='Palin', age=27)
130. 
131.         # Post data for edit inline
132.         cls.inline_post_data = {
133.             "name": "Test section",
134.             # inline data
135.             "article_set-TOTAL_FORMS": "6",
136.             "article_set-INITIAL_FORMS": "3",
137.             "article_set-MAX_NUM_FORMS": "0",
138.             "article_set-0-id": cls.a1.pk,
139.             # there is no title in database, give one here or formset will fail.
140.             "article_set-0-title": "Norske bostaver æøå skaper problemer",
141.             "article_set-0-content": "&lt;p&gt;Middle content&lt;/p&gt;",
142.             "article_set-0-date_0": "2008-03-18",
143.             "article_set-0-date_1": "11:54:58",
144.             "article_set-0-section": cls.s1.pk,
145.             "article_set-1-id": cls.a2.pk,
146.             "article_set-1-title": "Need a title.",
147.             "article_set-1-content": "&lt;p&gt;Oldest content&lt;/p&gt;",
148.             "article_set-1-date_0": "2000-03-18",
149.             "article_set-1-date_1": "11:54:58",
150.             "article_set-2-id": cls.a3.pk,
151.             "article_set-2-title": "Need a title.",
152.             "article_set-2-content": "&lt;p&gt;Newest content&lt;/p&gt;",
153.             "article_set-2-date_0": "2009-03-18",
154.             "article_set-2-date_1": "11:54:58",
155.             "article_set-3-id": "",
156.             "article_set-3-title": "",
157.             "article_set-3-content": "",
158.             "article_set-3-date_0": "",
159.             "article_set-3-date_1": "",
160.             "article_set-4-id": "",
161.             "article_set-4-title": "",
162.             "article_set-4-content": "",
163.             "article_set-4-date_0": "",
164.             "article_set-4-date_1": "",
165.             "article_set-5-id": "",
166.             "article_set-5-title": "",
167.             "article_set-5-content": "",
168.             "article_set-5-date_0": "",
169.             "article_set-5-date_1": "",
170.         }
171. 
172.     def setUp(self):
173.         self.client.force_login(self.superuser)
174. 
175.     def assertContentBefore(self, response, text1, text2, failing_msg=None):
176.         """
177.         Testing utility asserting that text1 appears before text2 in response
178.         content.
179.         """
180.         self.assertEqual(response.status_code, 200)
181.         self.assertLess(
182.             response.content.index(text1.encode()),
183.             response.content.index(text2.encode()),
184.             (failing_msg or '') + '\nResponse:\n' + response.content.decode(response.charset)
185.         )
186. 
187. 
188. class AdminViewBasicTest(AdminViewBasicTestCase):
189.     def test_trailing_slash_required(self):
190.         """
191.         If you leave off the trailing slash, app should redirect and add it.
192.         """
193.         add_url = reverse('admin:admin_views_article_add')
194.         response = self.client.get(add_url[:-1])
195.         self.assertRedirects(response, add_url, status_code=301)
196. 
197.     def test_basic_add_GET(self):
198.         """
199.         A smoke test to ensure GET on the add_view works.
200.         """
201.         response = self.client.get(reverse('admin:admin_views_section_add'))
202.         self.assertIsInstance(response, TemplateResponse)
203.         self.assertEqual(response.status_code, 200)
204. 
205.     def test_add_with_GET_args(self):
206.         response = self.client.get(reverse('admin:admin_views_section_add'), {'name': 'My Section'})
207.         self.assertContains(
208.             response, 'value="My Section"',
209.             msg_prefix="Couldn't find an input with the right value in the response"
210.         )
211. 
212.     def test_basic_edit_GET(self):
213.         """
214.         A smoke test to ensure GET on the change_view works.
215.         """
216.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
217.         self.assertIsInstance(response, TemplateResponse)
218.         self.assertEqual(response.status_code, 200)
219. 
220.     def test_basic_edit_GET_string_PK(self):
221.         """
222.         GET on the change_view (when passing a string as the PK argument for a
223.         model with an integer PK field) redirects to the index page with a
224.         message saying the object doesn't exist.
225.         """
226.         response = self.client.get(reverse('admin:admin_views_section_change', args=(quote("abc/<b>"),)), follow=True)
227.         self.assertRedirects(response, reverse('admin:index'))
228.         self.assertEqual(
229.             [m.message for m in response.context['messages']],
230.             ["""section with ID "abc/<b>" doesn't exist. Perhaps it was deleted?"""]
231.         )
232. 
233.     def test_basic_edit_GET_old_url_redirect(self):
234.         """
235.         The change URL changed in Django 1.9, but the old one still redirects.
236.         """
237.         response = self.client.get(
238.             reverse('admin:admin_views_section_change', args=(self.s1.pk,)).replace('change/', '')
239.         )
240.         self.assertRedirects(response, reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
241. 
242.     def test_basic_inheritance_GET_string_PK(self):
243.         """
244.         GET on the change_view (for inherited models) redirects to the index
245.         page with a message saying the object doesn't exist.
246.         """
247.         response = self.client.get(reverse('admin:admin_views_supervillain_change', args=('abc',)), follow=True)
248.         self.assertRedirects(response, reverse('admin:index'))
249.         self.assertEqual(
250.             [m.message for m in response.context['messages']],
251.             ["""super villain with ID "abc" doesn't exist. Perhaps it was deleted?"""]
252.         )
253. 
254.     def test_basic_add_POST(self):
255.         """
256.         A smoke test to ensure POST on add_view works.
257.         """
258.         post_data = {
259.             "name": "Another Section",
260.             # inline data
261.             "article_set-TOTAL_FORMS": "3",
262.             "article_set-INITIAL_FORMS": "0",
263.             "article_set-MAX_NUM_FORMS": "0",
264.         }
265.         response = self.client.post(reverse('admin:admin_views_section_add'), post_data)
266.         self.assertEqual(response.status_code, 302)  # redirect somewhere
267. 
268.     def test_popup_add_POST(self):
269.         """
270.         Ensure http response from a popup is properly escaped.
271.         """
272.         post_data = {
273.             '_popup': '1',
274.             'title': 'title with a new\nline',
275.             'content': 'some content',
276.             'date_0': '2010-09-10',
277.             'date_1': '14:55:39',
278.         }
279.         response = self.client.post(reverse('admin:admin_views_article_add'), post_data)
280.         self.assertContains(response, 'title with a new\\nline')
281. 
282.     def test_basic_edit_POST(self):
283.         """
284.         A smoke test to ensure POST on edit_view works.
285.         """
286.         url = reverse('admin:admin_views_section_change', args=(self.s1.pk,))
287.         response = self.client.post(url, self.inline_post_data)
288.         self.assertEqual(response.status_code, 302)  # redirect somewhere
289. 
290.     def test_edit_save_as(self):
291.         """
292.         Test "save as".
293.         """
294.         post_data = self.inline_post_data.copy()
295.         post_data.update({
296.             '_saveasnew': 'Save+as+new',
297.             "article_set-1-section": "1",
298.             "article_set-2-section": "1",
299.             "article_set-3-section": "1",
300.             "article_set-4-section": "1",
301.             "article_set-5-section": "1",
302.         })
303.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), post_data)
304.         self.assertEqual(response.status_code, 302)  # redirect somewhere
305. 
306.     def test_edit_save_as_delete_inline(self):
307.         """
308.         Should be able to "Save as new" while also deleting an inline.
309.         """
310.         post_data = self.inline_post_data.copy()
311.         post_data.update({
312.             '_saveasnew': 'Save+as+new',
313.             "article_set-1-section": "1",
314.             "article_set-2-section": "1",
315.             "article_set-2-DELETE": "1",
316.             "article_set-3-section": "1",
317.         })
318.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), post_data)
319.         self.assertEqual(response.status_code, 302)
320.         # started with 3 articles, one was deleted.
321.         self.assertEqual(Section.objects.latest('id').article_set.count(), 2)
322. 
323.     def test_change_list_column_field_classes(self):
324.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
325.         # callables display the callable name.
326.         self.assertContains(response, 'column-callable_year')
327.         self.assertContains(response, 'field-callable_year')
328.         # lambdas display as "lambda" + index that they appear in list_display.
329.         self.assertContains(response, 'column-lambda8')
330.         self.assertContains(response, 'field-lambda8')
331. 
332.     def test_change_list_sorting_callable(self):
333.         """
334.         Ensure we can sort on a list_display field that is a callable
335.         (column 2 is callable_year in ArticleAdmin)
336.         """
337.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 2})
338.         self.assertContentBefore(
339.             response, 'Oldest content', 'Middle content',
340.             "Results of sorting on callable are out of order."
341.         )
342.         self.assertContentBefore(
343.             response, 'Middle content', 'Newest content',
344.             "Results of sorting on callable are out of order."
345.         )
346. 
347.     def test_change_list_sorting_property(self):
348.         """
349.         Sort on a list_display field that is a property (column 10 is
350.         a property in Article model).
351.         """
352.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 10})
353.         self.assertContentBefore(
354.             response,
355.             'Oldest content',
356.             'Middle content',
357.             'Results of sorting on property are out of order.',
358.         )
359.         self.assertContentBefore(
360.             response,
361.             'Middle content',
362.             'Newest content',
363.             'Results of sorting on property are out of order.',
364.         )
365. 
366.     def test_change_list_sorting_callable_query_expression(self):
367.         """
368.         Query expressions may be used for admin_order_field. (column 9 is
369.         order_by_expression in ArticleAdmin).
370.         """
371.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '9'})
372.         self.assertContentBefore(
373.             response, 'Oldest content', 'Middle content',
374.             'Results of sorting on callable are out of order.'
375.         )
376.         self.assertContentBefore(
377.             response, 'Middle content', 'Newest content',
378.             'Results of sorting on callable are out of order.'
379.         )
380. 
381.     def test_change_list_sorting_callable_query_expression_reverse(self):
382.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-9'})
383.         self.assertContentBefore(
384.             response, 'Middle content', 'Oldest content',
385.             'Results of sorting on callable are out of order.'
386.         )
387.         self.assertContentBefore(
388.             response, 'Newest content', 'Middle content',
389.             'Results of sorting on callable are out of order.'
390.         )
391. 
392.     def test_change_list_sorting_model(self):
393.         """
394.         Ensure we can sort on a list_display field that is a Model method
395.         (column 3 is 'model_year' in ArticleAdmin)
396.         """
397.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-3'})
398.         self.assertContentBefore(
399.             response, 'Newest content', 'Middle content',
400.             "Results of sorting on Model method are out of order."
401.         )
402.         self.assertContentBefore(
403.             response, 'Middle content', 'Oldest content',
404.             "Results of sorting on Model method are out of order."
405.         )
406. 
407.     def test_change_list_sorting_model_admin(self):
408.         """
409.         Ensure we can sort on a list_display field that is a ModelAdmin method
410.         (column 4 is 'modeladmin_year' in ArticleAdmin)
411.         """
412.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '4'})
413.         self.assertContentBefore(
414.             response, 'Oldest content', 'Middle content',
415.             "Results of sorting on ModelAdmin method are out of order."
416.         )
417.         self.assertContentBefore(
418.             response, 'Middle content', 'Newest content',
419.             "Results of sorting on ModelAdmin method are out of order."
420.         )
421. 
422.     def test_change_list_sorting_model_admin_reverse(self):
423.         """
424.         Ensure we can sort on a list_display field that is a ModelAdmin
425.         method in reverse order (i.e. admin_order_field uses the '-' prefix)
426.         (column 6 is 'model_year_reverse' in ArticleAdmin)
427.         """
428.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '6'})
429.         self.assertContentBefore(
430.             response, '2009', '2008',
431.             "Results of sorting on ModelAdmin method are out of order."
432.         )
433.         self.assertContentBefore(
434.             response, '2008', '2000',
435.             "Results of sorting on ModelAdmin method are out of order."
436.         )
437.         # Let's make sure the ordering is right and that we don't get a
438.         # FieldError when we change to descending order
439.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-6'})
440.         self.assertContentBefore(
441.             response, '2000', '2008',
442.             "Results of sorting on ModelAdmin method are out of order."
443.         )
444.         self.assertContentBefore(
445.             response, '2008', '2009',
446.             "Results of sorting on ModelAdmin method are out of order."
447.         )
448. 
449.     def test_change_list_sorting_multiple(self):
450.         p1 = Person.objects.create(name="Chris", gender=1, alive=True)
451.         p2 = Person.objects.create(name="Chris", gender=2, alive=True)
452.         p3 = Person.objects.create(name="Bob", gender=1, alive=True)
453.         link1 = reverse('admin:admin_views_person_change', args=(p1.pk,))
454.         link2 = reverse('admin:admin_views_person_change', args=(p2.pk,))
455.         link3 = reverse('admin:admin_views_person_change', args=(p3.pk,))
456. 
457.         # Sort by name, gender
458.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {'o': '1.2'})
459.         self.assertContentBefore(response, link3, link1)
460.         self.assertContentBefore(response, link1, link2)
461. 
462.         # Sort by gender descending, name
463.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {'o': '-2.1'})
464.         self.assertContentBefore(response, link2, link3)
465.         self.assertContentBefore(response, link3, link1)
466. 
467.     def test_change_list_sorting_preserve_queryset_ordering(self):
468.         """
469.         If no ordering is defined in `ModelAdmin.ordering` or in the query
470.         string, then the underlying order of the queryset should not be
471.         changed, even if it is defined in `Modeladmin.get_queryset()`.
472.         Refs #11868, #7309.
473.         """
474.         p1 = Person.objects.create(name="Amy", gender=1, alive=True, age=80)
475.         p2 = Person.objects.create(name="Bob", gender=1, alive=True, age=70)
476.         p3 = Person.objects.create(name="Chris", gender=2, alive=False, age=60)
477.         link1 = reverse('admin:admin_views_person_change', args=(p1.pk,))
478.         link2 = reverse('admin:admin_views_person_change', args=(p2.pk,))
479.         link3 = reverse('admin:admin_views_person_change', args=(p3.pk,))
480. 
481.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {})
482.         self.assertContentBefore(response, link3, link2)
483.         self.assertContentBefore(response, link2, link1)
484. 
485.     def test_change_list_sorting_model_meta(self):
486.         # Test ordering on Model Meta is respected
487. 
488.         l1 = Language.objects.create(iso='ur', name='Urdu')
489.         l2 = Language.objects.create(iso='ar', name='Arabic')
490.         link1 = reverse('admin:admin_views_language_change', args=(quote(l1.pk),))
491.         link2 = reverse('admin:admin_views_language_change', args=(quote(l2.pk),))
492. 
493.         response = self.client.get(reverse('admin:admin_views_language_changelist'), {})
494.         self.assertContentBefore(response, link2, link1)
495. 
496.         # Test we can override with query string
497.         response = self.client.get(reverse('admin:admin_views_language_changelist'), {'o': '-1'})
498.         self.assertContentBefore(response, link1, link2)
499. 
500.     def test_change_list_sorting_override_model_admin(self):
501.         # Test ordering on Model Admin is respected, and overrides Model Meta
502.         dt = datetime.datetime.now()
503.         p1 = Podcast.objects.create(name="A", release_date=dt)
504.         p2 = Podcast.objects.create(name="B", release_date=dt - datetime.timedelta(10))
505.         link1 = reverse('admin:admin_views_podcast_change', args=(p1.pk,))
506.         link2 = reverse('admin:admin_views_podcast_change', args=(p2.pk,))
507. 
508.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'), {})
509.         self.assertContentBefore(response, link1, link2)
510. 
511.     def test_multiple_sort_same_field(self):
512.         # The changelist displays the correct columns if two columns correspond
513.         # to the same ordering field.
514.         dt = datetime.datetime.now()
515.         p1 = Podcast.objects.create(name="A", release_date=dt)
516.         p2 = Podcast.objects.create(name="B", release_date=dt - datetime.timedelta(10))
517.         link1 = reverse('admin:admin_views_podcast_change', args=(quote(p1.pk),))
518.         link2 = reverse('admin:admin_views_podcast_change', args=(quote(p2.pk),))
519. 
520.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'), {})
521.         self.assertContentBefore(response, link1, link2)
522. 
523.         p1 = ComplexSortedPerson.objects.create(name="Bob", age=10)
524.         p2 = ComplexSortedPerson.objects.create(name="Amy", age=20)
525.         link1 = reverse('admin:admin_views_complexsortedperson_change', args=(p1.pk,))
526.         link2 = reverse('admin:admin_views_complexsortedperson_change', args=(p2.pk,))
527. 
528.         response = self.client.get(reverse('admin:admin_views_complexsortedperson_changelist'), {})
529.         # Should have 5 columns (including action checkbox col)
530.         self.assertContains(response, '<th scope="col"', count=5)
531. 
532.         self.assertContains(response, 'Name')
533.         self.assertContains(response, 'Colored name')
534. 
535.         # Check order
536.         self.assertContentBefore(response, 'Name', 'Colored name')
537. 
538.         # Check sorting - should be by name
539.         self.assertContentBefore(response, link2, link1)
540. 
541.     def test_sort_indicators_admin_order(self):
542.         """
543.         The admin shows default sort indicators for all kinds of 'ordering'
544.         fields: field names, method on the model admin and model itself, and
545.         other callables. See #17252.
546.         """
547.         models = [(AdminOrderedField, 'adminorderedfield'),
548.                   (AdminOrderedModelMethod, 'adminorderedmodelmethod'),
549.                   (AdminOrderedAdminMethod, 'adminorderedadminmethod'),
550.                   (AdminOrderedCallable, 'adminorderedcallable')]
551.         for model, url in models:
552.             model.objects.create(stuff='The Last Item', order=3)
553.             model.objects.create(stuff='The First Item', order=1)
554.             model.objects.create(stuff='The Middle Item', order=2)
555.             response = self.client.get(reverse('admin:admin_views_%s_changelist' % url), {})
556.             self.assertEqual(response.status_code, 200)
557.             # Should have 3 columns including action checkbox col.
558.             self.assertContains(response, '<th scope="col"', count=3, msg_prefix=url)
559.             # Check if the correct column was selected. 2 is the index of the
560.             # 'order' column in the model admin's 'list_display' with 0 being
561.             # the implicit 'action_checkbox' and 1 being the column 'stuff'.
562.             self.assertEqual(response.context['cl'].get_ordering_field_columns(), {2: 'asc'})
563.             # Check order of records.
564.             self.assertContentBefore(response, 'The First Item', 'The Middle Item')
565.             self.assertContentBefore(response, 'The Middle Item', 'The Last Item')
566. 
567.     def test_has_related_field_in_list_display_fk(self):
568.         """Joins shouldn't be performed for <FK>_id fields in list display."""
569.         state = State.objects.create(name='Karnataka')
570.         City.objects.create(state=state, name='Bangalore')
571.         response = self.client.get(reverse('admin:admin_views_city_changelist'), {})
572. 
573.         response.context['cl'].list_display = ['id', 'name', 'state']
574.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), True)
575. 
576.         response.context['cl'].list_display = ['id', 'name', 'state_id']
577.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), False)
578. 
579.     def test_has_related_field_in_list_display_o2o(self):
580.         """Joins shouldn't be performed for <O2O>_id fields in list display."""
581.         media = Media.objects.create(name='Foo')
582.         Vodcast.objects.create(media=media)
583.         response = self.client.get(reverse('admin:admin_views_vodcast_changelist'), {})
584. 
585.         response.context['cl'].list_display = ['media']
586.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), True)
587. 
588.         response.context['cl'].list_display = ['media_id']
589.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), False)
590. 
591.     def test_limited_filter(self):
592.         """Ensure admin changelist filters do not contain objects excluded via limit_choices_to.
593.         This also tests relation-spanning filters (e.g. 'color__value').
594.         """
595.         response = self.client.get(reverse('admin:admin_views_thing_changelist'))
596.         self.assertContains(
597.             response, '<div id="changelist-filter">',
598.             msg_prefix="Expected filter not found in changelist view"
599.         )
600.         self.assertNotContains(
601.             response, '<a href="?color__id__exact=3">Blue</a>',
602.             msg_prefix="Changelist filter not correctly limited by limit_choices_to"
603.         )
604. 
605.     def test_relation_spanning_filters(self):
606.         changelist_url = reverse('admin:admin_views_chapterxtra1_changelist')
607.         response = self.client.get(changelist_url)
608.         self.assertContains(response, '<div id="changelist-filter">')
609.         filters = {
610.             'chap__id__exact': {
611.                 'values': [c.id for c in Chapter.objects.all()],
612.                 'test': lambda obj, value: obj.chap.id == value,
613.             },
614.             'chap__title': {
615.                 'values': [c.title for c in Chapter.objects.all()],
616.                 'test': lambda obj, value: obj.chap.title == value,
617.             },
618.             'chap__book__id__exact': {
619.                 'values': [b.id for b in Book.objects.all()],
620.                 'test': lambda obj, value: obj.chap.book.id == value,
621.             },
622.             'chap__book__name': {
623.                 'values': [b.name for b in Book.objects.all()],
624.                 'test': lambda obj, value: obj.chap.book.name == value,
625.             },
626.             'chap__book__promo__id__exact': {
627.                 'values': [p.id for p in Promo.objects.all()],
628.                 'test': lambda obj, value: obj.chap.book.promo_set.filter(id=value).exists(),
629.             },
630.             'chap__book__promo__name': {
631.                 'values': [p.name for p in Promo.objects.all()],
632.                 'test': lambda obj, value: obj.chap.book.promo_set.filter(name=value).exists(),
633.             },
634.             # A forward relation (book) after a reverse relation (promo).
635.             'guest_author__promo__book__id__exact': {
636.                 'values': [p.id for p in Book.objects.all()],
637.                 'test': lambda obj, value: obj.guest_author.promo_set.filter(book=value).exists(),
638.             },
639.         }
640.         for filter_path, params in filters.items():
641.             for value in params['values']:
642.                 query_string = urlencode({filter_path: value})
643.                 # ensure filter link exists
644.                 self.assertContains(response, '<a href="?%s"' % query_string)
645.                 # ensure link works
646.                 filtered_response = self.client.get('%s?%s' % (changelist_url, query_string))
647.                 self.assertEqual(filtered_response.status_code, 200)
648.                 # ensure changelist contains only valid objects
649.                 for obj in filtered_response.context['cl'].queryset.all():
650.                     self.assertTrue(params['test'](obj, value))
651. 
652.     def test_incorrect_lookup_parameters(self):
653.         """Ensure incorrect lookup parameters are handled gracefully."""
654.         changelist_url = reverse('admin:admin_views_thing_changelist')
655.         response = self.client.get(changelist_url, {'notarealfield': '5'})
656.         self.assertRedirects(response, '%s?e=1' % changelist_url)
657. 
658.         # Spanning relationships through a nonexistent related object (Refs #16716)
659.         response = self.client.get(changelist_url, {'notarealfield__whatever': '5'})
660.         self.assertRedirects(response, '%s?e=1' % changelist_url)
661. 
662.         response = self.client.get(changelist_url, {'color__id__exact': 'StringNotInteger!'})
663.         self.assertRedirects(response, '%s?e=1' % changelist_url)
664. 
665.         # Regression test for #18530
666.         response = self.client.get(changelist_url, {'pub_date__gte': 'foo'})
667.         self.assertRedirects(response, '%s?e=1' % changelist_url)
668. 
669.     def test_isnull_lookups(self):
670.         """Ensure is_null is handled correctly."""
671.         Article.objects.create(title="I Could Go Anywhere", content="Versatile", date=datetime.datetime.now())
672.         changelist_url = reverse('admin:admin_views_article_changelist')
673.         response = self.client.get(changelist_url)
674.         self.assertContains(response, '4 articles')
675.         response = self.client.get(changelist_url, {'section__isnull': 'false'})
676.         self.assertContains(response, '3 articles')
677.         response = self.client.get(changelist_url, {'section__isnull': '0'})
678.         self.assertContains(response, '3 articles')
679.         response = self.client.get(changelist_url, {'section__isnull': 'true'})
680.         self.assertContains(response, '1 article')
681.         response = self.client.get(changelist_url, {'section__isnull': '1'})
682.         self.assertContains(response, '1 article')
683. 
684.     def test_logout_and_password_change_URLs(self):
685.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
686.         self.assertContains(response, '<a href="%s">' % reverse('admin:logout'))
687.         self.assertContains(response, '<a href="%s">' % reverse('admin:password_change'))
688. 
689.     def test_named_group_field_choices_change_list(self):
690.         """
691.         Ensures the admin changelist shows correct values in the relevant column
692.         for rows corresponding to instances of a model in which a named group
693.         has been used in the choices option of a field.
694.         """
695.         link1 = reverse('admin:admin_views_fabric_change', args=(self.fab1.pk,))
696.         link2 = reverse('admin:admin_views_fabric_change', args=(self.fab2.pk,))
697.         response = self.client.get(reverse('admin:admin_views_fabric_changelist'))
698.         fail_msg = (
699.             "Changelist table isn't showing the right human-readable values "
700.             "set by a model field 'choices' option named group."
701.         )
702.         self.assertContains(response, '<a href="%s">Horizontal</a>' % link1, msg_prefix=fail_msg, html=True)
703.         self.assertContains(response, '<a href="%s">Vertical</a>' % link2, msg_prefix=fail_msg, html=True)
704. 
705.     def test_named_group_field_choices_filter(self):
706.         """
707.         Ensures the filter UI shows correctly when at least one named group has
708.         been used in the choices option of a model field.
709.         """
710.         response = self.client.get(reverse('admin:admin_views_fabric_changelist'))
711.         fail_msg = (
712.             "Changelist filter isn't showing options contained inside a model "
713.             "field 'choices' option named group."
714.         )
715.         self.assertContains(response, '<div id="changelist-filter">')
716.         self.assertContains(
717.             response, '<a href="?surface__exact=x" title="Horizontal">Horizontal</a>',
718.             msg_prefix=fail_msg, html=True
719.         )
720.         self.assertContains(
721.             response, '<a href="?surface__exact=y" title="Vertical">Vertical</a>',
722.             msg_prefix=fail_msg, html=True
723.         )
724. 
725.     def test_change_list_null_boolean_display(self):
726.         Post.objects.create(public=None)
727.         response = self.client.get(reverse('admin:admin_views_post_changelist'))
728.         self.assertContains(response, 'icon-unknown.svg')
729. 
730.     def test_i18n_language_non_english_default(self):
731.         """
732.         Check if the JavaScript i18n view returns an empty language catalog
733.         if the default language is non-English but the selected language
734.         is English. See #13388 and #3594 for more details.
735.         """
736.         with self.settings(LANGUAGE_CODE='fr'), translation.override('en-us'):
737.             response = self.client.get(reverse('admin:jsi18n'))
738.             self.assertNotContains(response, 'Choisir une heure')
739. 
740.     def test_i18n_language_non_english_fallback(self):
741.         """
742.         Makes sure that the fallback language is still working properly
743.         in cases where the selected language cannot be found.
744.         """
745.         with self.settings(LANGUAGE_CODE='fr'), translation.override('none'):
746.             response = self.client.get(reverse('admin:jsi18n'))
747.             self.assertContains(response, 'Choisir une heure')
748. 
749.     def test_jsi18n_with_context(self):
750.         response = self.client.get(reverse('admin-extra-context:jsi18n'))
751.         self.assertEqual(response.status_code, 200)
752. 
753.     def test_L10N_deactivated(self):
754.         """
755.         Check if L10N is deactivated, the JavaScript i18n view doesn't
756.         return localized date/time formats. Refs #14824.
757.         """
758.         with self.settings(LANGUAGE_CODE='ru', USE_L10N=False), translation.override('none'):
759.             response = self.client.get(reverse('admin:jsi18n'))
760.             self.assertNotContains(response, '%d.%m.%Y %H:%M:%S')
761.             self.assertContains(response, '%Y-%m-%d %H:%M:%S')
762. 
763.     def test_disallowed_filtering(self):
764.         with self.assertLogs('django.security.DisallowedModelAdminLookup', 'ERROR'):
765.             response = self.client.get(
766.                 "%s?owner__email__startswith=fuzzy" % reverse('admin:admin_views_album_changelist')
767.             )
768.         self.assertEqual(response.status_code, 400)
769. 
770.         # Filters are allowed if explicitly included in list_filter
771.         response = self.client.get("%s?color__value__startswith=red" % reverse('admin:admin_views_thing_changelist'))
772.         self.assertEqual(response.status_code, 200)
773.         response = self.client.get("%s?color__value=red" % reverse('admin:admin_views_thing_changelist'))
774.         self.assertEqual(response.status_code, 200)
775. 
776.         # Filters should be allowed if they involve a local field without the
777.         # need to whitelist them in list_filter or date_hierarchy.
778.         response = self.client.get("%s?age__gt=30" % reverse('admin:admin_views_person_changelist'))
779.         self.assertEqual(response.status_code, 200)
780. 
781.         e1 = Employee.objects.create(name='Anonymous', gender=1, age=22, alive=True, code='123')
782.         e2 = Employee.objects.create(name='Visitor', gender=2, age=19, alive=True, code='124')
783.         WorkHour.objects.create(datum=datetime.datetime.now(), employee=e1)
784.         WorkHour.objects.create(datum=datetime.datetime.now(), employee=e2)
785.         response = self.client.get(reverse('admin:admin_views_workhour_changelist'))
786.         self.assertContains(response, 'employee__person_ptr__exact')
787.         response = self.client.get("%s?employee__person_ptr__exact=%d" % (
788.             reverse('admin:admin_views_workhour_changelist'), e1.pk)
789.         )
790.         self.assertEqual(response.status_code, 200)
791. 
792.     def test_disallowed_to_field(self):
793.         url = reverse('admin:admin_views_section_changelist')
794.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
795.             response = self.client.get(url, {TO_FIELD_VAR: 'missing_field'})
796.         self.assertEqual(response.status_code, 400)
797. 
798.         # Specifying a field that is not referred by any other model registered
799.         # to this admin site should raise an exception.
800.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
801.             response = self.client.get(reverse('admin:admin_views_section_changelist'), {TO_FIELD_VAR: 'name'})
802.         self.assertEqual(response.status_code, 400)
803. 
804.         # #23839 - Primary key should always be allowed, even if the referenced model isn't registered.
805.         response = self.client.get(reverse('admin:admin_views_notreferenced_changelist'), {TO_FIELD_VAR: 'id'})
806.         self.assertEqual(response.status_code, 200)
807. 
808.         # #23915 - Specifying a field referenced by another model though a m2m should be allowed.
809.         response = self.client.get(reverse('admin:admin_views_recipe_changelist'), {TO_FIELD_VAR: 'rname'})
810.         self.assertEqual(response.status_code, 200)
811. 
812.         # #23604, #23915 - Specifying a field referenced through a reverse m2m relationship should be allowed.
813.         response = self.client.get(reverse('admin:admin_views_ingredient_changelist'), {TO_FIELD_VAR: 'iname'})
814.         self.assertEqual(response.status_code, 200)
815. 
816.         # #23329 - Specifying a field that is not referred by any other model directly registered
817.         # to this admin site but registered through inheritance should be allowed.
818.         response = self.client.get(reverse('admin:admin_views_referencedbyparent_changelist'), {TO_FIELD_VAR: 'name'})
819.         self.assertEqual(response.status_code, 200)
820. 
821.         # #23431 - Specifying a field that is only referred to by a inline of a registered
822.         # model should be allowed.
823.         response = self.client.get(reverse('admin:admin_views_referencedbyinline_changelist'), {TO_FIELD_VAR: 'name'})
824.         self.assertEqual(response.status_code, 200)
825. 
826.         # #25622 - Specifying a field of a model only referred by a generic
827.         # relation should raise DisallowedModelAdminToField.
828.         url = reverse('admin:admin_views_referencedbygenrel_changelist')
829.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
830.             response = self.client.get(url, {TO_FIELD_VAR: 'object_id'})
831.         self.assertEqual(response.status_code, 400)
832. 
833.         # We also want to prevent the add, change, and delete views from
834.         # leaking a disallowed field value.
835.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
836.             response = self.client.post(reverse('admin:admin_views_section_add'), {TO_FIELD_VAR: 'name'})
837.         self.assertEqual(response.status_code, 400)
838. 
839.         section = Section.objects.create()
840.         url = reverse('admin:admin_views_section_change', args=(section.pk,))
841.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
842.             response = self.client.post(url, {TO_FIELD_VAR: 'name'})
843.         self.assertEqual(response.status_code, 400)
844. 
845.         url = reverse('admin:admin_views_section_delete', args=(section.pk,))
846.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
847.             response = self.client.post(url, {TO_FIELD_VAR: 'name'})
848.         self.assertEqual(response.status_code, 400)
849. 
850.     def test_allowed_filtering_15103(self):
851.         """
852.         Regressions test for ticket 15103 - filtering on fields defined in a
853.         ForeignKey 'limit_choices_to' should be allowed, otherwise raw_id_fields
854.         can break.
855.         """
856.         # Filters should be allowed if they are defined on a ForeignKey pointing to this model
857.         url = "%s?leader__name=Palin&leader__age=27" % reverse('admin:admin_views_inquisition_changelist')
858.         response = self.client.get(url)
859.         self.assertEqual(response.status_code, 200)
860. 
861.     def test_popup_dismiss_related(self):
862.         """
863.         Regression test for ticket 20664 - ensure the pk is properly quoted.
864.         """
865.         actor = Actor.objects.create(name="Palin", age=27)
866.         response = self.client.get("%s?%s" % (reverse('admin:admin_views_actor_changelist'), IS_POPUP_VAR))
867.         self.assertContains(response, 'data-popup-opener="%s"' % actor.pk)
868. 
869.     def test_hide_change_password(self):
870.         """
871.         Tests if the "change password" link in the admin is hidden if the User
872.         does not have a usable password set.
873.         (against 9bea85795705d015cdadc82c68b99196a8554f5c)
874.         """
875.         user = User.objects.get(username='super')
876.         user.set_unusable_password()
877.         user.save()
878.         self.client.force_login(user)
879.         response = self.client.get(reverse('admin:index'))
880.         self.assertNotContains(
881.             response, reverse('admin:password_change'),
882.             msg_prefix='The "change password" link should not be displayed if a user does not have a usable password.'
883.         )
884. 
885.     def test_change_view_with_show_delete_extra_context(self):
886.         """
887.         The 'show_delete' context variable in the admin's change view controls
888.         the display of the delete button.
889.         """
890.         instance = UndeletableObject.objects.create(name='foo')
891.         response = self.client.get(reverse('admin:admin_views_undeletableobject_change', args=(instance.pk,)))
892.         self.assertNotContains(response, 'deletelink')
893. 
894.     def test_change_view_logs_m2m_field_changes(self):
895.         """Changes to ManyToManyFields are included in the object's history."""
896.         pizza = ReadablePizza.objects.create(name='Cheese')
897.         cheese = Topping.objects.create(name='cheese')
898.         post_data = {'name': pizza.name, 'toppings': [cheese.pk]}
899.         response = self.client.post(reverse('admin:admin_views_readablepizza_change', args=(pizza.pk,)), post_data)
900.         self.assertRedirects(response, reverse('admin:admin_views_readablepizza_changelist'))
901.         pizza_ctype = ContentType.objects.get_for_model(ReadablePizza, for_concrete_model=False)
902.         log = LogEntry.objects.filter(content_type=pizza_ctype, object_id=pizza.pk).first()
903.         self.assertEqual(log.get_change_message(), 'Changed toppings.')
904. 
905.     def test_allows_attributeerror_to_bubble_up(self):
906.         """
907.         AttributeErrors are allowed to bubble when raised inside a change list
908.         view. Requires a model to be created so there's something to display.
909.         Refs: #16655, #18593, and #18747
910.         """
911.         Simple.objects.create()
912.         with self.assertRaises(AttributeError):
913.             self.client.get(reverse('admin:admin_views_simple_changelist'))
914. 
915.     def test_changelist_with_no_change_url(self):
916.         """
917.         ModelAdmin.changelist_view shouldn't result in a NoReverseMatch if url
918.         for change_view is removed from get_urls (#20934).
919.         """
920.         o = UnchangeableObject.objects.create()
921.         response = self.client.get(reverse('admin:admin_views_unchangeableobject_changelist'))
922.         self.assertEqual(response.status_code, 200)
923.         # Check the format of the shown object -- shouldn't contain a change link
924.         self.assertContains(response, '<th class="field-__str__">%s</th>' % o, html=True)
925. 
926.     def test_invalid_appindex_url(self):
927.         """
928.         #21056 -- URL reversing shouldn't work for nonexistent apps.
929.         """
930.         good_url = '/test_admin/admin/admin_views/'
931.         confirm_good_url = reverse('admin:app_list',
932.                                    kwargs={'app_label': 'admin_views'})
933.         self.assertEqual(good_url, confirm_good_url)
934. 
935.         with self.assertRaises(NoReverseMatch):
936.             reverse('admin:app_list', kwargs={'app_label': 'this_should_fail'})
937.         with self.assertRaises(NoReverseMatch):
938.             reverse('admin:app_list', args=('admin_views2',))
939. 
940.     def test_resolve_admin_views(self):
941.         index_match = resolve('/test_admin/admin4/')
942.         list_match = resolve('/test_admin/admin4/auth/user/')
943.         self.assertIs(index_match.func.admin_site, customadmin.simple_site)
944.         self.assertIsInstance(list_match.func.model_admin, customadmin.CustomPwdTemplateUserAdmin)
945. 
946.     def test_adminsite_display_site_url(self):
947.         """
948.         #13749 - Admin should display link to front-end site 'View site'
949.         """
950.         url = reverse('admin:index')
951.         response = self.client.get(url)
952.         self.assertEqual(response.context['site_url'], '/my-site-url/')
953.         self.assertContains(response, '<a href="/my-site-url/">View site</a>')
954. 
955.     @override_settings(TIME_ZONE='America/Sao_Paulo', USE_TZ=True)
956.     def test_date_hierarchy_timezone_dst(self):
957.         # This datetime doesn't exist in this timezone due to DST.
958.         date = pytz.timezone('America/Sao_Paulo').localize(datetime.datetime(2016, 10, 16, 15), is_dst=None)
959.         q = Question.objects.create(question='Why?', expires=date)
960.         Answer2.objects.create(question=q, answer='Because.')
961.         response = self.client.get(reverse('admin:admin_views_answer2_changelist'))
962.         self.assertEqual(response.status_code, 200)
963.         self.assertContains(response, 'question__expires__day=16')
964.         self.assertContains(response, 'question__expires__month=10')
965.         self.assertContains(response, 'question__expires__year=2016')
966. 
967.     def test_sortable_by_columns_subset(self):
968.         expected_sortable_fields = ('date', 'callable_year')
969.         expected_not_sortable_fields = (
970.             'content', 'model_year', 'modeladmin_year', 'model_year_reversed',
971.             'section',
972.         )
973.         response = self.client.get(reverse('admin6:admin_views_article_changelist'))
974.         for field_name in expected_sortable_fields:
975.             self.assertContains(response, '<th scope="col"  class="sortable column-%s">' % field_name)
976.         for field_name in expected_not_sortable_fields:
977.             self.assertContains(response, '<th scope="col"  class="column-%s">' % field_name)
978. 
979.     def test_get_sortable_by_columns_subset(self):
980.         response = self.client.get(reverse('admin6:admin_views_actor_changelist'))
981.         self.assertContains(response, '<th scope="col"  class="sortable column-age">')
982.         self.assertContains(response, '<th scope="col"  class="column-name">')
983. 
984.     def test_sortable_by_no_column(self):
985.         expected_not_sortable_fields = ('title', 'book')
986.         response = self.client.get(reverse('admin6:admin_views_chapter_changelist'))
987.         for field_name in expected_not_sortable_fields:
988.             self.assertContains(response, '<th scope="col"  class="column-%s">' % field_name)
989.         self.assertNotContains(response, '<th scope="col"  class="sortable column')
990. 
991.     def test_get_sortable_by_no_column(self):
992.         response = self.client.get(reverse('admin6:admin_views_color_changelist'))
993.         self.assertContains(response, '<th scope="col"  class="column-value">')
994.         self.assertNotContains(response, '<th scope="col"  class="sortable column')
995. 
996. 
997. @override_settings(TEMPLATES=[{
998.     'BACKEND': 'django.template.backends.django.DjangoTemplates',
999.     # Put this app's and the shared tests templates dirs in DIRS to take precedence
1000.     # over the admin's templates dir.
1001.     'DIRS': [
1002.         os.path.join(os.path.dirname(__file__), 'templates'),
1003.         os.path.join(os.path.dirname(os.path.dirname(__file__)), 'templates'),
1004.     ],
1005.     'APP_DIRS': True,
1006.     'OPTIONS': {
1007.         'context_processors': [
1008.             'django.template.context_processors.debug',
1009.             'django.template.context_processors.request',
1010.             'django.contrib.auth.context_processors.auth',
1011.             'django.contrib.messages.context_processors.messages',
1012.         ],
1013.     },
1014. }])
1015. class AdminCustomTemplateTests(AdminViewBasicTestCase):
1016.     def test_custom_model_admin_templates(self):
1017.         # Test custom change list template with custom extra context
1018.         response = self.client.get(reverse('admin:admin_views_customarticle_changelist'))
1019.         self.assertContains(response, "var hello = 'Hello!';")
1020.         self.assertTemplateUsed(response, 'custom_admin/change_list.html')
1021. 
1022.         # Test custom add form template
1023.         response = self.client.get(reverse('admin:admin_views_customarticle_add'))
1024.         self.assertTemplateUsed(response, 'custom_admin/add_form.html')
1025. 
1026.         # Add an article so we can test delete, change, and history views
1027.         post = self.client.post(reverse('admin:admin_views_customarticle_add'), {
1028.             'content': '<p>great article</p>',
1029.             'date_0': '2008-03-18',
1030.             'date_1': '10:54:39'
1031.         })
1032.         self.assertRedirects(post, reverse('admin:admin_views_customarticle_changelist'))
1033.         self.assertEqual(CustomArticle.objects.all().count(), 1)
1034.         article_pk = CustomArticle.objects.all()[0].pk
1035. 
1036.         # Test custom delete, change, and object history templates
1037.         # Test custom change form template
1038.         response = self.client.get(reverse('admin:admin_views_customarticle_change', args=(article_pk,)))
1039.         self.assertTemplateUsed(response, 'custom_admin/change_form.html')
1040.         response = self.client.get(reverse('admin:admin_views_customarticle_delete', args=(article_pk,)))
1041.         self.assertTemplateUsed(response, 'custom_admin/delete_confirmation.html')
1042.         response = self.client.post(reverse('admin:admin_views_customarticle_changelist'), data={
1043.             'index': 0,
1044.             'action': ['delete_selected'],
1045.             '_selected_action': ['1'],
1046.         })
1047.         self.assertTemplateUsed(response, 'custom_admin/delete_selected_confirmation.html')
1048.         response = self.client.get(reverse('admin:admin_views_customarticle_history', args=(article_pk,)))
1049.         self.assertTemplateUsed(response, 'custom_admin/object_history.html')
1050. 
1051.         # A custom popup response template may be specified by
1052.         # ModelAdmin.popup_response_template.
1053.         response = self.client.post(reverse('admin:admin_views_customarticle_add') + '?%s=1' % IS_POPUP_VAR, {
1054.             'content': '<p>great article</p>',
1055.             'date_0': '2008-03-18',
1056.             'date_1': '10:54:39',
1057.             IS_POPUP_VAR: '1'
1058.         })
1059.         self.assertEqual(response.template_name, 'custom_admin/popup_response.html')
1060. 
1061.     def test_extended_bodyclass_template_change_form(self):
1062.         """
1063.         The admin/change_form.html template uses block.super in the
1064.         bodyclass block.
1065.         """
1066.         response = self.client.get(reverse('admin:admin_views_section_add'))
1067.         self.assertContains(response, 'bodyclass_consistency_check ')
1068. 
1069.     def test_change_password_template(self):
1070.         user = User.objects.get(username='super')
1071.         response = self.client.get(reverse('admin:auth_user_password_change', args=(user.id,)))
1072.         # The auth/user/change_password.html template uses super in the
1073.         # bodyclass block.
1074.         self.assertContains(response, 'bodyclass_consistency_check ')
1075. 
1076.         # When a site has multiple passwords in the browser's password manager,
1077.         # a browser pop up asks which user the new password is for. To prevent
1078.         # this, the username is added to the change password form.
1079.         self.assertContains(response, '<input type="text" name="username" value="super" style="display: none">')
1080. 
1081.     def test_extended_bodyclass_template_index(self):
1082.         """
1083.         The admin/index.html template uses block.super in the bodyclass block.
1084.         """
1085.         response = self.client.get(reverse('admin:index'))
1086.         self.assertContains(response, 'bodyclass_consistency_check ')
1087. 
1088.     def test_extended_bodyclass_change_list(self):
1089.         """
1090.         The admin/change_list.html' template uses block.super
1091.         in the bodyclass block.
1092.         """
1093.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
1094.         self.assertContains(response, 'bodyclass_consistency_check ')
1095. 
1096.     def test_extended_bodyclass_template_login(self):
1097.         """
1098.         The admin/login.html template uses block.super in the
1099.         bodyclass block.
1100.         """
1101.         self.client.logout()
1102.         response = self.client.get(reverse('admin:login'))
1103.         self.assertContains(response, 'bodyclass_consistency_check ')
1104. 
1105.     def test_extended_bodyclass_template_delete_confirmation(self):
1106.         """
1107.         The admin/delete_confirmation.html template uses
1108.         block.super in the bodyclass block.
1109.         """
1110.         group = Group.objects.create(name="foogroup")
1111.         response = self.client.get(reverse('admin:auth_group_delete', args=(group.id,)))
1112.         self.assertContains(response, 'bodyclass_consistency_check ')
1113. 
1114.     def test_extended_bodyclass_template_delete_selected_confirmation(self):
1115.         """
1116.         The admin/delete_selected_confirmation.html template uses
1117.         block.super in bodyclass block.
1118.         """
1119.         group = Group.objects.create(name="foogroup")
1120.         post_data = {
1121.             'action': 'delete_selected',
1122.             'selected_across': '0',
1123.             'index': '0',
1124.             '_selected_action': group.id
1125.         }
1126.         response = self.client.post(reverse('admin:auth_group_changelist'), post_data)
1127.         self.assertEqual(response.context['site_header'], 'Django administration')
1128.         self.assertContains(response, 'bodyclass_consistency_check ')
1129. 
1130.     def test_filter_with_custom_template(self):
1131.         """
1132.         A custom template can be used to render an admin filter.
1133.         """
1134.         response = self.client.get(reverse('admin:admin_views_color2_changelist'))
1135.         self.assertTemplateUsed(response, 'custom_filter_template.html')
1136. 
1137. 
1138. @override_settings(ROOT_URLCONF='admin_views.urls')
1139. class AdminViewFormUrlTest(TestCase):
1140.     current_app = "admin3"
1141. 
1142.     @classmethod
1143.     def setUpTestData(cls):
1144.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1145.         cls.s1 = Section.objects.create(name='Test section')
1146.         cls.a1 = Article.objects.create(
1147.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
1148.         )
1149.         cls.a2 = Article.objects.create(
1150.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
1151.         )
1152.         cls.a3 = Article.objects.create(
1153.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
1154.         )
1155.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
1156. 
1157.     def setUp(self):
1158.         self.client.force_login(self.superuser)
1159. 
1160.     def test_change_form_URL_has_correct_value(self):
1161.         """
1162.         change_view has form_url in response.context
1163.         """
1164.         response = self.client.get(
1165.             reverse('admin:admin_views_section_change', args=(self.s1.pk,), current_app=self.current_app)
1166.         )
1167.         self.assertIn('form_url', response.context, msg='form_url not present in response.context')
1168.         self.assertEqual(response.context['form_url'], 'pony')
1169. 
1170.     def test_initial_data_can_be_overridden(self):
1171.         """
1172.         The behavior for setting initial form data can be overridden in the
1173.         ModelAdmin class. Usually, the initial value is set via the GET params.
1174.         """
1175.         response = self.client.get(
1176.             reverse('admin:admin_views_restaurant_add', current_app=self.current_app),
1177.             {'name': 'test_value'}
1178.         )
1179.         # this would be the usual behaviour
1180.         self.assertNotContains(response, 'value="test_value"')
1181.         # this is the overridden behaviour
1182.         self.assertContains(response, 'value="overridden_value"')
1183. 
1184. 
1185. @override_settings(ROOT_URLCONF='admin_views.urls')
1186. class AdminJavaScriptTest(TestCase):
1187. 
1188.     @classmethod
1189.     def setUpTestData(cls):
1190.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1191. 
1192.     def setUp(self):
1193.         self.client.force_login(self.superuser)
1194. 
1195.     def test_js_minified_only_if_debug_is_false(self):
1196.         """
1197.         The minified versions of the JS files are only used when DEBUG is False.
1198.         """
1199.         with override_settings(DEBUG=False):
1200.             response = self.client.get(reverse('admin:admin_views_section_add'))
1201.             self.assertNotContains(response, 'vendor/jquery/jquery.js')
1202.             self.assertContains(response, 'vendor/jquery/jquery.min.js')
1203.             self.assertNotContains(response, 'prepopulate.js')
1204.             self.assertContains(response, 'prepopulate.min.js')
1205.             self.assertNotContains(response, 'actions.js')
1206.             self.assertContains(response, 'actions.min.js')
1207.             self.assertNotContains(response, 'collapse.js')
1208.             self.assertContains(response, 'collapse.min.js')
1209.             self.assertNotContains(response, 'inlines.js')
1210.             self.assertContains(response, 'inlines.min.js')
1211.         with override_settings(DEBUG=True):
1212.             response = self.client.get(reverse('admin:admin_views_section_add'))
1213.             self.assertContains(response, 'vendor/jquery/jquery.js')
1214.             self.assertNotContains(response, 'vendor/jquery/jquery.min.js')
1215.             self.assertContains(response, 'prepopulate.js')
1216.             self.assertNotContains(response, 'prepopulate.min.js')
1217.             self.assertContains(response, 'actions.js')
1218.             self.assertNotContains(response, 'actions.min.js')
1219.             self.assertContains(response, 'collapse.js')
1220.             self.assertNotContains(response, 'collapse.min.js')
1221.             self.assertContains(response, 'inlines.js')
1222.             self.assertNotContains(response, 'inlines.min.js')
1223. 
1224. 
1225. @override_settings(ROOT_URLCONF='admin_views.urls')
1226. class SaveAsTests(TestCase):
1227. 
1228.     @classmethod
1229.     def setUpTestData(cls):
1230.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1231.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
1232. 
1233.     def setUp(self):
1234.         self.client.force_login(self.superuser)
1235. 
1236.     def test_save_as_duplication(self):
1237.         """'save as' creates a new person"""
1238.         post_data = {'_saveasnew': '', 'name': 'John M', 'gender': 1, 'age': 42}
1239.         response = self.client.post(reverse('admin:admin_views_person_change', args=(self.per1.pk,)), post_data)
1240.         self.assertEqual(len(Person.objects.filter(name='John M')), 1)
1241.         self.assertEqual(len(Person.objects.filter(id=self.per1.pk)), 1)
1242.         new_person = Person.objects.latest('id')
1243.         self.assertRedirects(response, reverse('admin:admin_views_person_change', args=(new_person.pk,)))
1244. 
1245.     def test_save_as_continue_false(self):
1246.         """
1247.         Saving a new object using "Save as new" redirects to the changelist
1248.         instead of the change view when ModelAdmin.save_as_continue=False.
1249.         """
1250.         post_data = {'_saveasnew': '', 'name': 'John M', 'gender': 1, 'age': 42}
1251.         url = reverse('admin:admin_views_person_change', args=(self.per1.pk,), current_app=site2.name)
1252.         response = self.client.post(url, post_data)
1253.         self.assertEqual(len(Person.objects.filter(name='John M')), 1)
1254.         self.assertEqual(len(Person.objects.filter(id=self.per1.pk)), 1)
1255.         self.assertRedirects(response, reverse('admin:admin_views_person_changelist', current_app=site2.name))
1256. 
1257.     def test_save_as_new_with_validation_errors(self):
1258.         """
1259.         When you click "Save as new" and have a validation error,
1260.         you only see the "Save as new" button and not the other save buttons,
1261.         and that only the "Save as" button is visible.
1262.         """
1263.         response = self.client.post(reverse('admin:admin_views_person_change', args=(self.per1.pk,)), {
1264.             '_saveasnew': '',
1265.             'gender': 'invalid',
1266.             '_addanother': 'fail',
1267.         })
1268.         self.assertContains(response, 'Please correct the errors below.')
1269.         self.assertFalse(response.context['show_save_and_add_another'])
1270.         self.assertFalse(response.context['show_save_and_continue'])
1271.         self.assertTrue(response.context['show_save_as_new'])
1272. 
1273.     def test_save_as_new_with_validation_errors_with_inlines(self):
1274.         parent = Parent.objects.create(name='Father')
1275.         child = Child.objects.create(parent=parent, name='Child')
1276.         response = self.client.post(reverse('admin:admin_views_parent_change', args=(parent.pk,)), {
1277.             '_saveasnew': 'Save as new',
1278.             'child_set-0-parent': parent.pk,
1279.             'child_set-0-id': child.pk,
1280.             'child_set-0-name': 'Child',
1281.             'child_set-INITIAL_FORMS': 1,
1282.             'child_set-MAX_NUM_FORMS': 1000,
1283.             'child_set-MIN_NUM_FORMS': 0,
1284.             'child_set-TOTAL_FORMS': 4,
1285.             'name': '_invalid',
1286.         })
1287.         self.assertContains(response, 'Please correct the error below.')
1288.         self.assertFalse(response.context['show_save_and_add_another'])
1289.         self.assertFalse(response.context['show_save_and_continue'])
1290.         self.assertTrue(response.context['show_save_as_new'])
1291. 
1292.     def test_save_as_new_with_inlines_with_validation_errors(self):
1293.         parent = Parent.objects.create(name='Father')
1294.         child = Child.objects.create(parent=parent, name='Child')
1295.         response = self.client.post(reverse('admin:admin_views_parent_change', args=(parent.pk,)), {
1296.             '_saveasnew': 'Save as new',
1297.             'child_set-0-parent': parent.pk,
1298.             'child_set-0-id': child.pk,
1299.             'child_set-0-name': '_invalid',
1300.             'child_set-INITIAL_FORMS': 1,
1301.             'child_set-MAX_NUM_FORMS': 1000,
1302.             'child_set-MIN_NUM_FORMS': 0,
1303.             'child_set-TOTAL_FORMS': 4,
1304.             'name': 'Father',
1305.         })
1306.         self.assertContains(response, 'Please correct the error below.')
1307.         self.assertFalse(response.context['show_save_and_add_another'])
1308.         self.assertFalse(response.context['show_save_and_continue'])
1309.         self.assertTrue(response.context['show_save_as_new'])
1310. 
1311. 
1312. @override_settings(ROOT_URLCONF='admin_views.urls')
1313. class CustomModelAdminTest(AdminViewBasicTestCase):
1314. 
1315.     def test_custom_admin_site_login_form(self):
1316.         self.client.logout()
1317.         response = self.client.get(reverse('admin2:index'), follow=True)
1318.         self.assertIsInstance(response, TemplateResponse)
1319.         self.assertEqual(response.status_code, 200)
1320.         login = self.client.post(reverse('admin2:login'), {
1321.             REDIRECT_FIELD_NAME: reverse('admin2:index'),
1322.             'username': 'customform',
1323.             'password': 'secret',
1324.         }, follow=True)
1325.         self.assertIsInstance(login, TemplateResponse)
1326.         self.assertEqual(login.status_code, 200)
1327.         self.assertContains(login, 'custom form error')
1328.         self.assertContains(login, 'path/to/media.css')
1329. 
1330.     def test_custom_admin_site_login_template(self):
1331.         self.client.logout()
1332.         response = self.client.get(reverse('admin2:index'), follow=True)
1333.         self.assertIsInstance(response, TemplateResponse)
1334.         self.assertTemplateUsed(response, 'custom_admin/login.html')
1335.         self.assertContains(response, 'Hello from a custom login template')
1336. 
1337.     def test_custom_admin_site_logout_template(self):
1338.         response = self.client.get(reverse('admin2:logout'))
1339.         self.assertIsInstance(response, TemplateResponse)
1340.         self.assertTemplateUsed(response, 'custom_admin/logout.html')
1341.         self.assertContains(response, 'Hello from a custom logout template')
1342. 
1343.     def test_custom_admin_site_index_view_and_template(self):
1344.         response = self.client.get(reverse('admin2:index'))
1345.         self.assertIsInstance(response, TemplateResponse)
1346.         self.assertTemplateUsed(response, 'custom_admin/index.html')
1347.         self.assertContains(response, 'Hello from a custom index template *bar*')
1348. 
1349.     def test_custom_admin_site_app_index_view_and_template(self):
1350.         response = self.client.get(reverse('admin2:app_list', args=('admin_views',)))
1351.         self.assertIsInstance(response, TemplateResponse)
1352.         self.assertTemplateUsed(response, 'custom_admin/app_index.html')
1353.         self.assertContains(response, 'Hello from a custom app_index template')
1354. 
1355.     def test_custom_admin_site_password_change_template(self):
1356.         response = self.client.get(reverse('admin2:password_change'))
1357.         self.assertIsInstance(response, TemplateResponse)
1358.         self.assertTemplateUsed(response, 'custom_admin/password_change_form.html')
1359.         self.assertContains(response, 'Hello from a custom password change form template')
1360. 
1361.     def test_custom_admin_site_password_change_with_extra_context(self):
1362.         response = self.client.get(reverse('admin2:password_change'))
1363.         self.assertIsInstance(response, TemplateResponse)
1364.         self.assertTemplateUsed(response, 'custom_admin/password_change_form.html')
1365.         self.assertContains(response, 'eggs')
1366. 
1367.     def test_custom_admin_site_password_change_done_template(self):
1368.         response = self.client.get(reverse('admin2:password_change_done'))
1369.         self.assertIsInstance(response, TemplateResponse)
1370.         self.assertTemplateUsed(response, 'custom_admin/password_change_done.html')
1371.         self.assertContains(response, 'Hello from a custom password change done template')
1372. 
1373.     def test_custom_admin_site_view(self):
1374.         self.client.force_login(self.superuser)
1375.         response = self.client.get(reverse('admin2:my_view'))
1376.         self.assertEqual(response.content, b"Django is a magical pony!")
1377. 
1378.     def test_pwd_change_custom_template(self):
1379.         self.client.force_login(self.superuser)
1380.         su = User.objects.get(username='super')
1381.         response = self.client.get(reverse('admin4:auth_user_password_change', args=(su.pk,)))
1382.         self.assertEqual(response.status_code, 200)
1383. 
1384. 
1385. def get_perm(Model, codename):
1386.     """Return the permission object, for the Model"""
1387.     ct = ContentType.objects.get_for_model(Model, for_concrete_model=False)
1388.     return Permission.objects.get(content_type=ct, codename=codename)
1389. 
1390. 
1391. @override_settings(
1392.     ROOT_URLCONF='admin_views.urls',
1393.     # Test with the admin's documented list of required context processors.
1394.     TEMPLATES=[{
1395.         'BACKEND': 'django.template.backends.django.DjangoTemplates',
1396.         'APP_DIRS': True,
1397.         'OPTIONS': {
1398.             'context_processors': [
1399.                 'django.contrib.auth.context_processors.auth',
1400.                 'django.contrib.messages.context_processors.messages',
1401.             ],
1402.         },
1403.     }],
1404. )
1405. class AdminViewPermissionsTest(TestCase):
1406.     """Tests for Admin Views Permissions."""
1407. 
1408.     @classmethod
1409.     def setUpTestData(cls):
1410.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1411.         cls.viewuser = User.objects.create_user(username='viewuser', password='secret', is_staff=True)
1412.         cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
1413.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
1414.         cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
1415.         cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
1416.         cls.nostaffuser = User.objects.create_user(username='nostaff', password='secret')
1417.         cls.s1 = Section.objects.create(name='Test section')
1418.         cls.a1 = Article.objects.create(
1419.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1,
1420.             another_section=cls.s1,
1421.         )
1422.         cls.a2 = Article.objects.create(
1423.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
1424.         )
1425.         cls.a3 = Article.objects.create(
1426.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
1427.         )
1428.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
1429. 
1430.         # Setup permissions, for our users who can add, change, and delete.
1431.         opts = Article._meta
1432. 
1433.         # User who can view Articles
1434.         cls.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('view', opts)))
1435.         # User who can add Articles
1436.         cls.adduser.user_permissions.add(get_perm(Article, get_permission_codename('add', opts)))
1437.         # User who can change Articles
1438.         cls.changeuser.user_permissions.add(get_perm(Article, get_permission_codename('change', opts)))
1439.         cls.nostaffuser.user_permissions.add(get_perm(Article, get_permission_codename('change', opts)))
1440. 
1441.         # User who can delete Articles
1442.         cls.deleteuser.user_permissions.add(get_perm(Article, get_permission_codename('delete', opts)))
1443.         cls.deleteuser.user_permissions.add(get_perm(Section, get_permission_codename('delete', Section._meta)))
1444. 
1445.         # login POST dicts
1446.         cls.index_url = reverse('admin:index')
1447.         cls.super_login = {
1448.             REDIRECT_FIELD_NAME: cls.index_url,
1449.             'username': 'super',
1450.             'password': 'secret',
1451.         }
1452.         cls.super_email_login = {
1453.             REDIRECT_FIELD_NAME: cls.index_url,
1454.             'username': 'super@example.com',
1455.             'password': 'secret',
1456.         }
1457.         cls.super_email_bad_login = {
1458.             REDIRECT_FIELD_NAME: cls.index_url,
1459.             'username': 'super@example.com',
1460.             'password': 'notsecret',
1461.         }
1462.         cls.adduser_login = {
1463.             REDIRECT_FIELD_NAME: cls.index_url,
1464.             'username': 'adduser',
1465.             'password': 'secret',
1466.         }
1467.         cls.changeuser_login = {
1468.             REDIRECT_FIELD_NAME: cls.index_url,
1469.             'username': 'changeuser',
1470.             'password': 'secret',
1471.         }
1472.         cls.deleteuser_login = {
1473.             REDIRECT_FIELD_NAME: cls.index_url,
1474.             'username': 'deleteuser',
1475.             'password': 'secret',
1476.         }
1477.         cls.nostaff_login = {
1478.             REDIRECT_FIELD_NAME: reverse('has_permission_admin:index'),
1479.             'username': 'nostaff',
1480.             'password': 'secret',
1481.         }
1482.         cls.joepublic_login = {
1483.             REDIRECT_FIELD_NAME: cls.index_url,
1484.             'username': 'joepublic',
1485.             'password': 'secret',
1486.         }
1487.         cls.viewuser_login = {
1488.             REDIRECT_FIELD_NAME: cls.index_url,
1489.             'username': 'viewuser',
1490.             'password': 'secret',
1491.         }
1492.         cls.no_username_login = {
1493.             REDIRECT_FIELD_NAME: cls.index_url,
1494.             'password': 'secret',
1495.         }
1496. 
1497.     def test_login(self):
1498.         """
1499.         Make sure only staff members can log in.
1500. 
1501.         Successful posts to the login page will redirect to the original url.
1502.         Unsuccessful attempts will continue to render the login page with
1503.         a 200 status code.
1504.         """
1505.         login_url = '%s?next=%s' % (reverse('admin:login'), reverse('admin:index'))
1506.         # Super User
1507.         response = self.client.get(self.index_url)
1508.         self.assertRedirects(response, login_url)
1509.         login = self.client.post(login_url, self.super_login)
1510.         self.assertRedirects(login, self.index_url)
1511.         self.assertFalse(login.context)
1512.         self.client.get(reverse('admin:logout'))
1513. 
1514.         # Test if user enters email address
1515.         response = self.client.get(self.index_url)
1516.         self.assertEqual(response.status_code, 302)
1517.         login = self.client.post(login_url, self.super_email_login)
1518.         self.assertContains(login, ERROR_MESSAGE)
1519.         # only correct passwords get a username hint
1520.         login = self.client.post(login_url, self.super_email_bad_login)
1521.         self.assertContains(login, ERROR_MESSAGE)
1522.         new_user = User(username='jondoe', password='secret', email='super@example.com')
1523.         new_user.save()
1524.         # check to ensure if there are multiple email addresses a user doesn't get a 500
1525.         login = self.client.post(login_url, self.super_email_login)
1526.         self.assertContains(login, ERROR_MESSAGE)
1527. 
1528.         # View User
1529.         response = self.client.get(self.index_url)
1530.         self.assertEqual(response.status_code, 302)
1531.         login = self.client.post(login_url, self.viewuser_login)
1532.         self.assertRedirects(login, self.index_url)
1533.         self.assertFalse(login.context)
1534.         self.client.get(reverse('admin:logout'))
1535. 
1536.         # Add User
1537.         response = self.client.get(self.index_url)
1538.         self.assertEqual(response.status_code, 302)
1539.         login = self.client.post(login_url, self.adduser_login)
1540.         self.assertRedirects(login, self.index_url)
1541.         self.assertFalse(login.context)
1542.         self.client.get(reverse('admin:logout'))
1543. 
1544.         # Change User
1545.         response = self.client.get(self.index_url)
1546.         self.assertEqual(response.status_code, 302)
1547.         login = self.client.post(login_url, self.changeuser_login)
1548.         self.assertRedirects(login, self.index_url)
1549.         self.assertFalse(login.context)
1550.         self.client.get(reverse('admin:logout'))
1551. 
1552.         # Delete User
1553.         response = self.client.get(self.index_url)
1554.         self.assertEqual(response.status_code, 302)
1555.         login = self.client.post(login_url, self.deleteuser_login)
1556.         self.assertRedirects(login, self.index_url)
1557.         self.assertFalse(login.context)
1558.         self.client.get(reverse('admin:logout'))
1559. 
1560.         # Regular User should not be able to login.
1561.         response = self.client.get(self.index_url)
1562.         self.assertEqual(response.status_code, 302)
1563.         login = self.client.post(login_url, self.joepublic_login)
1564.         self.assertEqual(login.status_code, 200)
1565.         self.assertContains(login, ERROR_MESSAGE)
1566. 
1567.         # Requests without username should not return 500 errors.
1568.         response = self.client.get(self.index_url)
1569.         self.assertEqual(response.status_code, 302)
1570.         login = self.client.post(login_url, self.no_username_login)
1571.         self.assertEqual(login.status_code, 200)
1572.         self.assertFormError(login, 'form', 'username', ['This field is required.'])
1573. 
1574.     def test_login_redirect_for_direct_get(self):
1575.         """
1576.         Login redirect should be to the admin index page when going directly to
1577.         /admin/login/.
1578.         """
1579.         response = self.client.get(reverse('admin:login'))
1580.         self.assertEqual(response.status_code, 200)
1581.         self.assertEqual(response.context[REDIRECT_FIELD_NAME], reverse('admin:index'))
1582. 
1583.     def test_login_has_permission(self):
1584.         # Regular User should not be able to login.
1585.         response = self.client.get(reverse('has_permission_admin:index'))
1586.         self.assertEqual(response.status_code, 302)
1587.         login = self.client.post(reverse('has_permission_admin:login'), self.joepublic_login)
1588.         self.assertEqual(login.status_code, 200)
1589.         self.assertContains(login, 'permission denied')
1590. 
1591.         # User with permissions should be able to login.
1592.         response = self.client.get(reverse('has_permission_admin:index'))
1593.         self.assertEqual(response.status_code, 302)
1594.         login = self.client.post(reverse('has_permission_admin:login'), self.nostaff_login)
1595.         self.assertRedirects(login, reverse('has_permission_admin:index'))
1596.         self.assertFalse(login.context)
1597.         self.client.get(reverse('has_permission_admin:logout'))
1598. 
1599.         # Staff should be able to login.
1600.         response = self.client.get(reverse('has_permission_admin:index'))
1601.         self.assertEqual(response.status_code, 302)
1602.         login = self.client.post(reverse('has_permission_admin:login'), {
1603.             REDIRECT_FIELD_NAME: reverse('has_permission_admin:index'),
1604.             'username': 'deleteuser',
1605.             'password': 'secret',
1606.         })
1607.         self.assertRedirects(login, reverse('has_permission_admin:index'))
1608.         self.assertFalse(login.context)
1609.         self.client.get(reverse('has_permission_admin:logout'))
1610. 
1611.     def test_login_successfully_redirects_to_original_URL(self):
1612.         response = self.client.get(self.index_url)
1613.         self.assertEqual(response.status_code, 302)
1614.         query_string = 'the-answer=42'
1615.         redirect_url = '%s?%s' % (self.index_url, query_string)
1616.         new_next = {REDIRECT_FIELD_NAME: redirect_url}
1617.         post_data = self.super_login.copy()
1618.         post_data.pop(REDIRECT_FIELD_NAME)
1619.         login = self.client.post(
1620.             '%s?%s' % (reverse('admin:login'), urlencode(new_next)),
1621.             post_data)
1622.         self.assertRedirects(login, redirect_url)
1623. 
1624.     def test_double_login_is_not_allowed(self):
1625.         """Regression test for #19327"""
1626.         login_url = '%s?next=%s' % (reverse('admin:login'), reverse('admin:index'))
1627. 
1628.         response = self.client.get(self.index_url)
1629.         self.assertEqual(response.status_code, 302)
1630. 
1631.         # Establish a valid admin session
1632.         login = self.client.post(login_url, self.super_login)
1633.         self.assertRedirects(login, self.index_url)
1634.         self.assertFalse(login.context)
1635. 
1636.         # Logging in with non-admin user fails
1637.         login = self.client.post(login_url, self.joepublic_login)
1638.         self.assertEqual(login.status_code, 200)
1639.         self.assertContains(login, ERROR_MESSAGE)
1640. 
1641.         # Establish a valid admin session
1642.         login = self.client.post(login_url, self.super_login)
1643.         self.assertRedirects(login, self.index_url)
1644.         self.assertFalse(login.context)
1645. 
1646.         # Logging in with admin user while already logged in
1647.         login = self.client.post(login_url, self.super_login)
1648.         self.assertRedirects(login, self.index_url)
1649.         self.assertFalse(login.context)
1650.         self.client.get(reverse('admin:logout'))
1651. 
1652.     def test_login_page_notice_for_non_staff_users(self):
1653.         """
1654.         A logged-in non-staff user trying to access the admin index should be
1655.         presented with the login page and a hint indicating that the current
1656.         user doesn't have access to it.
1657.         """
1658.         hint_template = 'You are authenticated as {}'
1659. 
1660.         # Anonymous user should not be shown the hint
1661.         response = self.client.get(self.index_url, follow=True)
1662.         self.assertContains(response, 'login-form')
1663.         self.assertNotContains(response, hint_template.format(''), status_code=200)
1664. 
1665.         # Non-staff user should be shown the hint
1666.         self.client.force_login(self.nostaffuser)
1667.         response = self.client.get(self.index_url, follow=True)
1668.         self.assertContains(response, 'login-form')
1669.         self.assertContains(response, hint_template.format(self.nostaffuser.username), status_code=200)
1670. 
1671.     def test_add_view(self):
1672.         """Test add view restricts access and actually adds items."""
1673.         add_dict = {
1674.             'title': 'Døm ikke',
1675.             'content': '<p>great article</p>',
1676.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1677.             'section': self.s1.pk,
1678.         }
1679.         # Change User should not have access to add articles
1680.         self.client.force_login(self.changeuser)
1681.         # make sure the view removes test cookie
1682.         self.assertIs(self.client.session.test_cookie_worked(), False)
1683.         response = self.client.get(reverse('admin:admin_views_article_add'))
1684.         self.assertEqual(response.status_code, 403)
1685.         # Try POST just to make sure
1686.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1687.         self.assertEqual(post.status_code, 403)
1688.         self.assertEqual(Article.objects.count(), 3)
1689.         self.client.get(reverse('admin:logout'))
1690. 
1691.         # View User should not have access to add articles
1692.         self.client.force_login(self.viewuser)
1693.         response = self.client.get(reverse('admin:admin_views_article_add'))
1694.         self.assertEqual(response.status_code, 403)
1695.         # Try POST just to make sure
1696.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1697.         self.assertEqual(post.status_code, 403)
1698.         self.assertEqual(Article.objects.count(), 3)
1699.         # Now give the user permission to add but not change.
1700.         self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('add', Article._meta)))
1701.         response = self.client.get(reverse('admin:admin_views_article_add'))
1702.         self.assertContains(response, '<input type="submit" value="Save and view" name="_continue">')
1703.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict, follow=False)
1704.         self.assertEqual(post.status_code, 302)
1705.         self.assertEqual(Article.objects.count(), 4)
1706.         article = Article.objects.latest('pk')
1707.         response = self.client.get(reverse('admin:admin_views_article_change', args=(article.pk,)))
1708.         self.assertContains(response, '<li class="success">The article "Døm ikke" was added successfully.</li>')
1709.         article.delete()
1710.         self.client.get(reverse('admin:logout'))
1711. 
1712.         # Add user may login and POST to add view, then redirect to admin root
1713.         self.client.force_login(self.adduser)
1714.         addpage = self.client.get(reverse('admin:admin_views_article_add'))
1715.         change_list_link = '&rsaquo; <a href="%s">Articles</a>' % reverse('admin:admin_views_article_changelist')
1716.         self.assertNotContains(
1717.             addpage, change_list_link,
1718.             msg_prefix='User restricted to add permission is given link to change list view in breadcrumbs.'
1719.         )
1720.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1721.         self.assertRedirects(post, self.index_url)
1722.         self.assertEqual(Article.objects.count(), 4)
1723.         self.assertEqual(len(mail.outbox), 2)
1724.         self.assertEqual(mail.outbox[0].subject, 'Greetings from a created object')
1725.         self.client.get(reverse('admin:logout'))
1726. 
1727.         # The addition was logged correctly
1728.         addition_log = LogEntry.objects.all()[0]
1729.         new_article = Article.objects.last()
1730.         article_ct = ContentType.objects.get_for_model(Article)
1731.         self.assertEqual(addition_log.user_id, self.adduser.pk)
1732.         self.assertEqual(addition_log.content_type_id, article_ct.pk)
1733.         self.assertEqual(addition_log.object_id, str(new_article.pk))
1734.         self.assertEqual(addition_log.object_repr, "Døm ikke")
1735.         self.assertEqual(addition_log.action_flag, ADDITION)
1736.         self.assertEqual(addition_log.get_change_message(), "Added.")
1737. 
1738.         # Super can add too, but is redirected to the change list view
1739.         self.client.force_login(self.superuser)
1740.         addpage = self.client.get(reverse('admin:admin_views_article_add'))
1741.         self.assertContains(
1742.             addpage, change_list_link,
1743.             msg_prefix='Unrestricted user is not given link to change list view in breadcrumbs.'
1744.         )
1745.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1746.         self.assertRedirects(post, reverse('admin:admin_views_article_changelist'))
1747.         self.assertEqual(Article.objects.count(), 5)
1748.         self.client.get(reverse('admin:logout'))
1749. 
1750.         # 8509 - if a normal user is already logged in, it is possible
1751.         # to change user into the superuser without error
1752.         self.client.force_login(self.joepublicuser)
1753.         # Check and make sure that if user expires, data still persists
1754.         self.client.force_login(self.superuser)
1755.         # make sure the view removes test cookie
1756.         self.assertIs(self.client.session.test_cookie_worked(), False)
1757. 
1758.     @mock.patch('django.contrib.admin.options.InlineModelAdmin.has_change_permission')
1759.     def test_add_view_with_view_only_inlines(self, has_change_permission):
1760.         """User with add permission to a section but view-only for inlines."""
1761.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('add', Section._meta)))
1762.         self.client.force_login(self.viewuser)
1763.         # Valid POST creates a new section.
1764.         data = {
1765.             'name': 'New obj',
1766.             'article_set-TOTAL_FORMS': 0,
1767.             'article_set-INITIAL_FORMS': 0,
1768.         }
1769.         response = self.client.post(reverse('admin:admin_views_section_add'), data)
1770.         self.assertRedirects(response, reverse('admin:index'))
1771.         self.assertEqual(Section.objects.latest('id').name, data['name'])
1772.         # InlineModelAdmin.has_change_permission()'s obj argument is always
1773.         # None during object add.
1774.         self.assertEqual([obj for (request, obj), _ in has_change_permission.call_args_list], [None, None])
1775. 
1776.     def test_change_view(self):
1777.         """Change view should restrict access and allow users to edit items."""
1778.         change_dict = {
1779.             'title': 'Ikke fordømt',
1780.             'content': '<p>edited article</p>',
1781.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1782.             'section': self.s1.pk,
1783.         }
1784.         article_change_url = reverse('admin:admin_views_article_change', args=(self.a1.pk,))
1785.         article_changelist_url = reverse('admin:admin_views_article_changelist')
1786. 
1787.         # add user should not be able to view the list of article or change any of them
1788.         self.client.force_login(self.adduser)
1789.         response = self.client.get(article_changelist_url)
1790.         self.assertEqual(response.status_code, 403)
1791.         response = self.client.get(article_change_url)
1792.         self.assertEqual(response.status_code, 403)
1793.         post = self.client.post(article_change_url, change_dict)
1794.         self.assertEqual(post.status_code, 403)
1795.         self.client.get(reverse('admin:logout'))
1796. 
1797.         # view user should be able to view the article but not change any of them
1798.         # (the POST can be sent, but no modification occurs)
1799.         self.client.force_login(self.viewuser)
1800.         response = self.client.get(article_changelist_url)
1801.         self.assertEqual(response.status_code, 200)
1802.         self.assertEqual(response.context['title'], 'Select article to view')
1803.         response = self.client.get(article_change_url)
1804.         self.assertEqual(response.status_code, 200)
1805.         self.assertEqual(response.context['title'], 'View article')
1806.         self.assertContains(response, '<label>Extra form field:</label>')
1807.         self.assertContains(response, '<a href="/test_admin/admin/admin_views/article/" class="closelink">Close</a>')
1808.         post = self.client.post(article_change_url, change_dict)
1809.         self.assertEqual(post.status_code, 302)
1810.         self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>Middle content</p>')
1811.         self.client.get(reverse('admin:logout'))
1812. 
1813.         # change user can view all items and edit them
1814.         self.client.force_login(self.changeuser)
1815.         response = self.client.get(article_changelist_url)
1816.         self.assertEqual(response.status_code, 200)
1817.         self.assertEqual(response.context['title'], 'Select article to change')
1818.         response = self.client.get(article_change_url)
1819.         self.assertEqual(response.status_code, 200)
1820.         self.assertEqual(response.context['title'], 'Change article')
1821.         post = self.client.post(article_change_url, change_dict)
1822.         self.assertRedirects(post, article_changelist_url)
1823.         self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>edited article</p>')
1824. 
1825.         # one error in form should produce singular error message, multiple errors plural
1826.         change_dict['title'] = ''
1827.         post = self.client.post(article_change_url, change_dict)
1828.         self.assertContains(
1829.             post, 'Please correct the error below.',
1830.             msg_prefix='Singular error message not found in response to post with one error'
1831.         )
1832. 
1833.         change_dict['content'] = ''
1834.         post = self.client.post(article_change_url, change_dict)
1835.         self.assertContains(
1836.             post, 'Please correct the errors below.',
1837.             msg_prefix='Plural error message not found in response to post with multiple errors'
1838.         )
1839.         self.client.get(reverse('admin:logout'))
1840. 
1841.         # Test redirection when using row-level change permissions. Refs #11513.
1842.         r1 = RowLevelChangePermissionModel.objects.create(id=1, name="odd id")
1843.         r2 = RowLevelChangePermissionModel.objects.create(id=2, name="even id")
1844.         r3 = RowLevelChangePermissionModel.objects.create(id=3, name='odd id mult 3')
1845.         r6 = RowLevelChangePermissionModel.objects.create(id=6, name='even id mult 3')
1846.         change_url_1 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r1.pk,))
1847.         change_url_2 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r2.pk,))
1848.         change_url_3 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r3.pk,))
1849.         change_url_6 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r6.pk,))
1850.         logins = [self.superuser, self.viewuser, self.adduser, self.changeuser, self.deleteuser]
1851.         for login_user in logins:
1852.             with self.subTest(login_user.username):
1853.                 self.client.force_login(login_user)
1854.                 response = self.client.get(change_url_1)
1855.                 self.assertEqual(response.status_code, 403)
1856.                 response = self.client.post(change_url_1, {'name': 'changed'})
1857.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=1).name, 'odd id')
1858.                 self.assertEqual(response.status_code, 403)
1859.                 response = self.client.get(change_url_2)
1860.                 self.assertEqual(response.status_code, 200)
1861.                 response = self.client.post(change_url_2, {'name': 'changed'})
1862.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=2).name, 'changed')
1863.                 self.assertRedirects(response, self.index_url)
1864.                 response = self.client.get(change_url_3)
1865.                 self.assertEqual(response.status_code, 200)
1866.                 response = self.client.post(change_url_3, {'name': 'changed'})
1867.                 self.assertRedirects(response, self.index_url)
1868.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=3).name, 'odd id mult 3')
1869.                 response = self.client.get(change_url_6)
1870.                 self.assertEqual(response.status_code, 200)
1871.                 response = self.client.post(change_url_6, {'name': 'changed'})
1872.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=6).name, 'changed')
1873.                 self.assertRedirects(response, self.index_url)
1874. 
1875.                 self.client.get(reverse('admin:logout'))
1876. 
1877.         for login_user in [self.joepublicuser, self.nostaffuser]:
1878.             with self.subTest(login_user.username):
1879.                 self.client.force_login(login_user)
1880.                 response = self.client.get(change_url_1, follow=True)
1881.                 self.assertContains(response, 'login-form')
1882.                 response = self.client.post(change_url_1, {'name': 'changed'}, follow=True)
1883.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=1).name, 'odd id')
1884.                 self.assertContains(response, 'login-form')
1885.                 response = self.client.get(change_url_2, follow=True)
1886.                 self.assertContains(response, 'login-form')
1887.                 response = self.client.post(change_url_2, {'name': 'changed again'}, follow=True)
1888.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=2).name, 'changed')
1889.                 self.assertContains(response, 'login-form')
1890.                 self.client.get(reverse('admin:logout'))
1891. 
1892.     def test_change_view_without_object_change_permission(self):
1893.         """
1894.         The object should be read-only if the user has permission to view it
1895.         and change objects of that type but not to change the current object.
1896.         """
1897.         change_url = reverse('admin9:admin_views_article_change', args=(self.a1.pk,))
1898.         self.client.force_login(self.viewuser)
1899.         response = self.client.get(change_url)
1900.         self.assertEqual(response.status_code, 200)
1901.         self.assertEqual(response.context['title'], 'View article')
1902.         self.assertContains(response, '<a href="/test_admin/admin9/admin_views/article/" class="closelink">Close</a>')
1903. 
1904.     def test_change_view_post_without_object_change_permission(self):
1905.         """A POST redirects to changelist without modifications."""
1906.         change_dict = {
1907.             'title': 'Ikke fordømt',
1908.             'content': '<p>edited article</p>',
1909.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1910.             'section': self.s1.pk,
1911.         }
1912.         change_url = reverse('admin10:admin_views_article_change', args=(self.a1.pk,))
1913.         changelist_url = reverse('admin10:admin_views_article_changelist')
1914.         self.client.force_login(self.viewuser)
1915.         response = self.client.post(change_url, change_dict)
1916.         self.assertRedirects(response, changelist_url)
1917.         self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>Middle content</p>')
1918. 
1919.     def test_change_view_save_as_new(self):
1920.         """
1921.         'Save as new' should raise PermissionDenied for users without the 'add'
1922.         permission.
1923.         """
1924.         change_dict_save_as_new = {
1925.             '_saveasnew': 'Save as new',
1926.             'title': 'Ikke fordømt',
1927.             'content': '<p>edited article</p>',
1928.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1929.             'section': self.s1.pk,
1930.         }
1931.         article_change_url = reverse('admin:admin_views_article_change', args=(self.a1.pk,))
1932. 
1933.         # Add user can perform "Save as new".
1934.         article_count = Article.objects.count()
1935.         self.client.force_login(self.adduser)
1936.         post = self.client.post(article_change_url, change_dict_save_as_new)
1937.         self.assertRedirects(post, self.index_url)
1938.         self.assertEqual(Article.objects.count(), article_count + 1)
1939.         self.client.logout()
1940. 
1941.         # Change user cannot perform "Save as new" (no 'add' permission).
1942.         article_count = Article.objects.count()
1943.         self.client.force_login(self.changeuser)
1944.         post = self.client.post(article_change_url, change_dict_save_as_new)
1945.         self.assertEqual(post.status_code, 403)
1946.         self.assertEqual(Article.objects.count(), article_count)
1947. 
1948.         # User with both add and change permissions should be redirected to the
1949.         # change page for the newly created object.
1950.         article_count = Article.objects.count()
1951.         self.client.force_login(self.superuser)
1952.         post = self.client.post(article_change_url, change_dict_save_as_new)
1953.         self.assertEqual(Article.objects.count(), article_count + 1)
1954.         new_article = Article.objects.latest('id')
1955.         self.assertRedirects(post, reverse('admin:admin_views_article_change', args=(new_article.pk,)))
1956. 
1957.     def test_change_view_with_view_only_inlines(self):
1958.         """
1959.         User with change permission to a section but view-only for inlines.
1960.         """
1961.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
1962.         self.client.force_login(self.viewuser)
1963.         # GET shows inlines.
1964.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
1965.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
1966.         formset = response.context['inline_admin_formsets'][0]
1967.         self.assertEqual(len(formset.forms), 3)
1968.         # Valid POST changes the name.
1969.         data = {
1970.             'name': 'Can edit name with view-only inlines',
1971.             'article_set-TOTAL_FORMS': 3,
1972.             'article_set-INITIAL_FORMS': 3
1973.         }
1974.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
1975.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
1976.         self.assertEqual(Section.objects.get(pk=self.s1.pk).name, data['name'])
1977.         # Invalid POST reshows inlines.
1978.         del data['name']
1979.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
1980.         self.assertEqual(response.status_code, 200)
1981.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
1982.         formset = response.context['inline_admin_formsets'][0]
1983.         self.assertEqual(len(formset.forms), 3)
1984. 
1985.     def test_change_view_with_view_and_add_inlines(self):
1986.         """User has view and add permissions on the inline model."""
1987.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
1988.         self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('add', Article._meta)))
1989.         self.client.force_login(self.viewuser)
1990.         # GET shows inlines.
1991.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
1992.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
1993.         formset = response.context['inline_admin_formsets'][0]
1994.         self.assertEqual(len(formset.forms), 6)
1995.         # Valid POST creates a new article.
1996.         data = {
1997.             'name': 'Can edit name with view-only inlines',
1998.             'article_set-TOTAL_FORMS': 6,
1999.             'article_set-INITIAL_FORMS': 3,
2000.             'article_set-3-id': [''],
2001.             'article_set-3-title': ['A title'],
2002.             'article_set-3-content': ['Added content'],
2003.             'article_set-3-date_0': ['2008-3-18'],
2004.             'article_set-3-date_1': ['11:54:58'],
2005.             'article_set-3-section': [str(self.s1.pk)],
2006.         }
2007.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2008.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
2009.         self.assertEqual(Section.objects.get(pk=self.s1.pk).name, data['name'])
2010.         self.assertEqual(Article.objects.count(), 4)
2011.         # Invalid POST reshows inlines.
2012.         del data['name']
2013.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2014.         self.assertEqual(response.status_code, 200)
2015.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
2016.         formset = response.context['inline_admin_formsets'][0]
2017.         self.assertEqual(len(formset.forms), 6)
2018. 
2019.     def test_change_view_with_view_and_delete_inlines(self):
2020.         """User has view and delete permissions on the inline model."""
2021.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
2022.         self.client.force_login(self.viewuser)
2023.         data = {
2024.             'name': 'Name is required.',
2025.             'article_set-TOTAL_FORMS': 6,
2026.             'article_set-INITIAL_FORMS': 3,
2027.             'article_set-0-id': [str(self.a1.pk)],
2028.             'article_set-0-DELETE': ['on'],
2029.         }
2030.         # Inline POST details are ignored without delete permission.
2031.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2032.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
2033.         self.assertEqual(Article.objects.count(), 3)
2034.         # Deletion successful when delete permission is added.
2035.         self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('delete', Article._meta)))
2036.         data = {
2037.             'name': 'Name is required.',
2038.             'article_set-TOTAL_FORMS': 6,
2039.             'article_set-INITIAL_FORMS': 3,
2040.             'article_set-0-id': [str(self.a1.pk)],
2041.             'article_set-0-DELETE': ['on'],
2042.         }
2043.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2044.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
2045.         self.assertEqual(Article.objects.count(), 2)
2046. 
2047.     def test_delete_view(self):
2048.         """Delete view should restrict access and actually delete items."""
2049.         delete_dict = {'post': 'yes'}
2050.         delete_url = reverse('admin:admin_views_article_delete', args=(self.a1.pk,))
2051. 
2052.         # add user should not be able to delete articles
2053.         self.client.force_login(self.adduser)
2054.         response = self.client.get(delete_url)
2055.         self.assertEqual(response.status_code, 403)
2056.         post = self.client.post(delete_url, delete_dict)
2057.         self.assertEqual(post.status_code, 403)
2058.         self.assertEqual(Article.objects.count(), 3)
2059.         self.client.logout()
2060. 
2061.         # view user should not be able to delete articles
2062.         self.client.force_login(self.viewuser)
2063.         response = self.client.get(delete_url)
2064.         self.assertEqual(response.status_code, 403)
2065.         post = self.client.post(delete_url, delete_dict)
2066.         self.assertEqual(post.status_code, 403)
2067.         self.assertEqual(Article.objects.count(), 3)
2068.         self.client.logout()
2069. 
2070.         # Delete user can delete
2071.         self.client.force_login(self.deleteuser)
2072.         response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
2073.         self.assertContains(response, "<h2>Summary</h2>")
2074.         self.assertContains(response, "<li>Articles: 3</li>")
2075.         # test response contains link to related Article
2076.         self.assertContains(response, "admin_views/article/%s/" % self.a1.pk)
2077. 
2078.         response = self.client.get(delete_url)
2079.         self.assertContains(response, "admin_views/article/%s/" % self.a1.pk)
2080.         self.assertContains(response, "<h2>Summary</h2>")
2081.         self.assertContains(response, "<li>Articles: 1</li>")
2082.         self.assertEqual(response.status_code, 200)
2083.         post = self.client.post(delete_url, delete_dict)
2084.         self.assertRedirects(post, self.index_url)
2085.         self.assertEqual(Article.objects.count(), 2)
2086.         self.assertEqual(len(mail.outbox), 1)
2087.         self.assertEqual(mail.outbox[0].subject, 'Greetings from a deleted object')
2088.         article_ct = ContentType.objects.get_for_model(Article)
2089.         logged = LogEntry.objects.get(content_type=article_ct, action_flag=DELETION)
2090.         self.assertEqual(logged.object_id, str(self.a1.pk))
2091. 
2092.     def test_delete_view_with_no_default_permissions(self):
2093.         """
2094.         The delete view allows users to delete collected objects without a
2095.         'delete' permission (ReadOnlyPizza.Meta.default_permissions is empty).
2096.         """
2097.         pizza = ReadOnlyPizza.objects.create(name='Double Cheese')
2098.         delete_url = reverse('admin:admin_views_readonlypizza_delete', args=(pizza.pk,))
2099.         self.client.force_login(self.adduser)
2100.         response = self.client.get(delete_url)
2101.         self.assertContains(response, 'admin_views/readonlypizza/%s/' % pizza.pk)
2102.         self.assertContains(response, '<h2>Summary</h2>')
2103.         self.assertContains(response, '<li>Read only pizzas: 1</li>')
2104.         self.assertEqual(response.status_code, 200)
2105.         post = self.client.post(delete_url, {'post': 'yes'})
2106.         self.assertRedirects(post, reverse('admin:admin_views_readonlypizza_changelist'))
2107.         self.assertEqual(ReadOnlyPizza.objects.count(), 0)
2108. 
2109.     def test_delete_view_nonexistent_obj(self):
2110.         self.client.force_login(self.deleteuser)
2111.         url = reverse('admin:admin_views_article_delete', args=('nonexistent',))
2112.         response = self.client.get(url, follow=True)
2113.         self.assertRedirects(response, reverse('admin:index'))
2114.         self.assertEqual(
2115.             [m.message for m in response.context['messages']],
2116.             ["""article with ID "nonexistent" doesn't exist. Perhaps it was deleted?"""]
2117.         )
2118. 
2119.     def test_history_view(self):
2120.         """History view should restrict access."""
2121.         # add user should not be able to view the list of article or change any of them
2122.         self.client.force_login(self.adduser)
2123.         response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
2124.         self.assertEqual(response.status_code, 403)
2125.         self.client.get(reverse('admin:logout'))
2126. 
2127.         # view user can view all items
2128.         self.client.force_login(self.viewuser)
2129.         response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
2130.         self.assertEqual(response.status_code, 200)
2131.         self.client.get(reverse('admin:logout'))
2132. 
2133.         # change user can view all items and edit them
2134.         self.client.force_login(self.changeuser)
2135.         response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
2136.         self.assertEqual(response.status_code, 200)
2137. 
2138.         # Test redirection when using row-level change permissions. Refs #11513.
2139.         rl1 = RowLevelChangePermissionModel.objects.create(name="odd id")
2140.         rl2 = RowLevelChangePermissionModel.objects.create(name="even id")
2141.         logins = [self.superuser, self.viewuser, self.adduser, self.changeuser, self.deleteuser]
2142.         for login_user in logins:
2143.             with self.subTest(login_user.username):
2144.                 self.client.force_login(login_user)
2145.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl1.pk,))
2146.                 response = self.client.get(url)
2147.                 self.assertEqual(response.status_code, 403)
2148. 
2149.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl2.pk,))
2150.                 response = self.client.get(url)
2151.                 self.assertEqual(response.status_code, 200)
2152. 
2153.                 self.client.get(reverse('admin:logout'))
2154. 
2155.         for login_user in [self.joepublicuser, self.nostaffuser]:
2156.             with self.subTest(login_user.username):
2157.                 self.client.force_login(login_user)
2158.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl1.pk,))
2159.                 response = self.client.get(url, follow=True)
2160.                 self.assertContains(response, 'login-form')
2161.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl2.pk,))
2162.                 response = self.client.get(url, follow=True)
2163.                 self.assertContains(response, 'login-form')
2164. 
2165.                 self.client.get(reverse('admin:logout'))
2166. 
2167.     def test_history_view_bad_url(self):
2168.         self.client.force_login(self.changeuser)
2169.         response = self.client.get(reverse('admin:admin_views_article_history', args=('foo',)), follow=True)
2170.         self.assertRedirects(response, reverse('admin:index'))
2171.         self.assertEqual(
2172.             [m.message for m in response.context['messages']],
2173.             ["""article with ID "foo" doesn't exist. Perhaps it was deleted?"""]
2174.         )
2175. 
2176.     def test_conditionally_show_add_section_link(self):
2177.         """
2178.         The foreign key widget should only show the "add related" button if the
2179.         user has permission to add that related item.
2180.         """
2181.         self.client.force_login(self.adduser)
2182.         # The user can't add sections yet, so they shouldn't see the "add section" link.
2183.         url = reverse('admin:admin_views_article_add')
2184.         add_link_text = 'add_id_section'
2185.         response = self.client.get(url)
2186.         self.assertNotContains(response, add_link_text)
2187.         # Allow the user to add sections too. Now they can see the "add section" link.
2188.         user = User.objects.get(username='adduser')
2189.         perm = get_perm(Section, get_permission_codename('add', Section._meta))
2190.         user.user_permissions.add(perm)
2191.         response = self.client.get(url)
2192.         self.assertContains(response, add_link_text)
2193. 
2194.     def test_conditionally_show_change_section_link(self):
2195.         """
2196.         The foreign key widget should only show the "change related" button if
2197.         the user has permission to change that related item.
2198.         """
2199.         def get_change_related(response):
2200.             return response.context['adminform'].form.fields['section'].widget.can_change_related
2201. 
2202.         self.client.force_login(self.adduser)
2203.         # The user can't change sections yet, so they shouldn't see the "change section" link.
2204.         url = reverse('admin:admin_views_article_add')
2205.         change_link_text = 'change_id_section'
2206.         response = self.client.get(url)
2207.         self.assertFalse(get_change_related(response))
2208.         self.assertNotContains(response, change_link_text)
2209.         # Allow the user to change sections too. Now they can see the "change section" link.
2210.         user = User.objects.get(username='adduser')
2211.         perm = get_perm(Section, get_permission_codename('change', Section._meta))
2212.         user.user_permissions.add(perm)
2213.         response = self.client.get(url)
2214.         self.assertTrue(get_change_related(response))
2215.         self.assertContains(response, change_link_text)
2216. 
2217.     def test_conditionally_show_delete_section_link(self):
2218.         """
2219.         The foreign key widget should only show the "delete related" button if
2220.         the user has permission to delete that related item.
2221.         """
2222.         def get_delete_related(response):
2223.             return response.context['adminform'].form.fields['sub_section'].widget.can_delete_related
2224. 
2225.         self.client.force_login(self.adduser)
2226.         # The user can't delete sections yet, so they shouldn't see the "delete section" link.
2227.         url = reverse('admin:admin_views_article_add')
2228.         delete_link_text = 'delete_id_sub_section'
2229.         response = self.client.get(url)
2230.         self.assertFalse(get_delete_related(response))
2231.         self.assertNotContains(response, delete_link_text)
2232.         # Allow the user to delete sections too. Now they can see the "delete section" link.
2233.         user = User.objects.get(username='adduser')
2234.         perm = get_perm(Section, get_permission_codename('delete', Section._meta))
2235.         user.user_permissions.add(perm)
2236.         response = self.client.get(url)
2237.         self.assertTrue(get_delete_related(response))
2238.         self.assertContains(response, delete_link_text)
2239. 
2240.     def test_disabled_permissions_when_logged_in(self):
2241.         self.client.force_login(self.superuser)
2242.         superuser = User.objects.get(username='super')
2243.         superuser.is_active = False
2244.         superuser.save()
2245. 
2246.         response = self.client.get(self.index_url, follow=True)
2247.         self.assertContains(response, 'id="login-form"')
2248.         self.assertNotContains(response, 'Log out')
2249. 
2250.         response = self.client.get(reverse('secure_view'), follow=True)
2251.         self.assertContains(response, 'id="login-form"')
2252. 
2253.     def test_disabled_staff_permissions_when_logged_in(self):
2254.         self.client.force_login(self.superuser)
2255.         superuser = User.objects.get(username='super')
2256.         superuser.is_staff = False
2257.         superuser.save()
2258. 
2259.         response = self.client.get(self.index_url, follow=True)
2260.         self.assertContains(response, 'id="login-form"')
2261.         self.assertNotContains(response, 'Log out')
2262. 
2263.         response = self.client.get(reverse('secure_view'), follow=True)
2264.         self.assertContains(response, 'id="login-form"')
2265. 
2266.     def test_app_list_permissions(self):
2267.         """
2268.         If a user has no module perms, the app list returns a 404.
2269.         """
2270.         opts = Article._meta
2271.         change_user = User.objects.get(username='changeuser')
2272.         permission = get_perm(Article, get_permission_codename('change', opts))
2273. 
2274.         self.client.force_login(self.changeuser)
2275. 
2276.         # the user has no module permissions
2277.         change_user.user_permissions.remove(permission)
2278.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
2279.         self.assertEqual(response.status_code, 404)
2280. 
2281.         # the user now has module permissions
2282.         change_user.user_permissions.add(permission)
2283.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
2284.         self.assertEqual(response.status_code, 200)
2285. 
2286.     def test_shortcut_view_only_available_to_staff(self):
2287.         """
2288.         Only admin users should be able to use the admin shortcut view.
2289.         """
2290.         model_ctype = ContentType.objects.get_for_model(ModelWithStringPrimaryKey)
2291.         obj = ModelWithStringPrimaryKey.objects.create(string_pk='foo')
2292.         shortcut_url = reverse('admin:view_on_site', args=(model_ctype.pk, obj.pk))
2293. 
2294.         # Not logged in: we should see the login page.
2295.         response = self.client.get(shortcut_url, follow=True)
2296.         self.assertTemplateUsed(response, 'admin/login.html')
2297. 
2298.         # Logged in? Redirect.
2299.         self.client.force_login(self.superuser)
2300.         response = self.client.get(shortcut_url, follow=False)
2301.         # Can't use self.assertRedirects() because User.get_absolute_url() is silly.
2302.         self.assertEqual(response.status_code, 302)
2303.         # Domain may depend on contrib.sites tests also run
2304.         self.assertRegex(response.url, 'http://(testserver|example.com)/dummy/foo/')
2305. 
2306.     def test_has_module_permission(self):
2307.         """
2308.         has_module_permission() returns True for all users who
2309.         have any permission for that module (add, change, or delete), so that
2310.         the module is displayed on the admin index page.
2311.         """
2312.         self.client.force_login(self.superuser)
2313.         response = self.client.get(self.index_url)
2314.         self.assertContains(response, 'admin_views')
2315.         self.assertContains(response, 'Articles')
2316.         self.client.logout()
2317. 
2318.         self.client.force_login(self.viewuser)
2319.         response = self.client.get(self.index_url)
2320.         self.assertContains(response, 'admin_views')
2321.         self.assertContains(response, 'Articles')
2322.         self.client.logout()
2323. 
2324.         self.client.force_login(self.adduser)
2325.         response = self.client.get(self.index_url)
2326.         self.assertContains(response, 'admin_views')
2327.         self.assertContains(response, 'Articles')
2328.         self.client.logout()
2329. 
2330.         self.client.force_login(self.changeuser)
2331.         response = self.client.get(self.index_url)
2332.         self.assertContains(response, 'admin_views')
2333.         self.assertContains(response, 'Articles')
2334.         self.client.logout()
2335. 
2336.         self.client.force_login(self.deleteuser)
2337.         response = self.client.get(self.index_url)
2338.         self.assertContains(response, 'admin_views')
2339.         self.assertContains(response, 'Articles')
2340. 
2341.     def test_overriding_has_module_permission(self):
2342.         """
2343.         If has_module_permission() always returns False, the module shouldn't
2344.         be displayed on the admin index page for any users.
2345.         """
2346.         articles = Article._meta.verbose_name_plural.title()
2347.         sections = Section._meta.verbose_name_plural.title()
2348.         index_url = reverse('admin7:index')
2349. 
2350.         self.client.force_login(self.superuser)
2351.         response = self.client.get(index_url)
2352.         self.assertContains(response, sections)
2353.         self.assertNotContains(response, articles)
2354.         self.client.logout()
2355. 
2356.         self.client.force_login(self.viewuser)
2357.         response = self.client.get(index_url)
2358.         self.assertNotContains(response, 'admin_views')
2359.         self.assertNotContains(response, articles)
2360.         self.client.logout()
2361. 
2362.         self.client.force_login(self.adduser)
2363.         response = self.client.get(index_url)
2364.         self.assertNotContains(response, 'admin_views')
2365.         self.assertNotContains(response, articles)
2366.         self.client.logout()
2367. 
2368.         self.client.force_login(self.changeuser)
2369.         response = self.client.get(index_url)
2370.         self.assertNotContains(response, 'admin_views')
2371.         self.assertNotContains(response, articles)
2372.         self.client.logout()
2373. 
2374.         self.client.force_login(self.deleteuser)
2375.         response = self.client.get(index_url)
2376.         self.assertNotContains(response, articles)
2377. 
2378.         # The app list displays Sections but not Articles as the latter has
2379.         # ModelAdmin.has_module_permission() = False.
2380.         self.client.force_login(self.superuser)
2381.         response = self.client.get(reverse('admin7:app_list', args=('admin_views',)))
2382.         self.assertContains(response, sections)
2383.         self.assertNotContains(response, articles)
2384. 
2385.     def test_post_save_message_no_forbidden_links_visible(self):
2386.         """
2387.         Post-save message shouldn't contain a link to the change form if the
2388.         user doesn't have the change permission.
2389.         """
2390.         self.client.force_login(self.adduser)
2391.         # Emulate Article creation for user with add-only permission.
2392.         post_data = {
2393.             "title": "Fun & games",
2394.             "content": "Some content",
2395.             "date_0": "2015-10-31",
2396.             "date_1": "16:35:00",
2397.             "_save": "Save",
2398.         }
2399.         response = self.client.post(reverse('admin:admin_views_article_add'), post_data, follow=True)
2400.         self.assertContains(
2401.             response,
2402.             '<li class="success">The article "Fun &amp; games" was added successfully.</li>',
2403.             html=True
2404.         )
2405. 
2406. 
2407. @override_settings(
2408.     ROOT_URLCONF='admin_views.urls',
2409.     TEMPLATES=[{
2410.         'BACKEND': 'django.template.backends.django.DjangoTemplates',
2411.         'APP_DIRS': True,
2412.         'OPTIONS': {
2413.             'context_processors': [
2414.                 'django.contrib.auth.context_processors.auth',
2415.                 'django.contrib.messages.context_processors.messages',
2416.             ],
2417.         },
2418.     }],
2419. )
2420. class AdminViewProxyModelPermissionsTests(TestCase):
2421.     """Tests for proxy models permissions in the admin."""
2422. 
2423.     @classmethod
2424.     def setUpTestData(cls):
2425.         cls.viewuser = User.objects.create_user(username='viewuser', password='secret', is_staff=True)
2426.         cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
2427.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
2428.         cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
2429.         # Setup permissions.
2430.         opts = UserProxy._meta
2431.         cls.viewuser.user_permissions.add(get_perm(UserProxy, get_permission_codename('view', opts)))
2432.         cls.adduser.user_permissions.add(get_perm(UserProxy, get_permission_codename('add', opts)))
2433.         cls.changeuser.user_permissions.add(get_perm(UserProxy, get_permission_codename('change', opts)))
2434.         cls.deleteuser.user_permissions.add(get_perm(UserProxy, get_permission_codename('delete', opts)))
2435.         # UserProxy instances.
2436.         cls.user_proxy = UserProxy.objects.create(username='user_proxy', password='secret')
2437. 
2438.     def test_add(self):
2439.         self.client.force_login(self.adduser)
2440.         url = reverse('admin:admin_views_userproxy_add')
2441.         data = {
2442.             'username': 'can_add',
2443.             'password': 'secret',
2444.             'date_joined_0': '2019-01-15',
2445.             'date_joined_1': '16:59:10',
2446.         }
2447.         response = self.client.post(url, data, follow=True)
2448.         self.assertEqual(response.status_code, 200)
2449.         self.assertTrue(UserProxy.objects.filter(username='can_add').exists())
2450. 
2451.     def test_view(self):
2452.         self.client.force_login(self.viewuser)
2453.         response = self.client.get(reverse('admin:admin_views_userproxy_changelist'))
2454.         self.assertContains(response, '<h1>Select user proxy to view</h1>')
2455.         self.assertEqual(response.status_code, 200)
2456.         response = self.client.get(reverse('admin:admin_views_userproxy_change', args=(self.user_proxy.pk,)))
2457.         self.assertContains(response, '<h1>View user proxy</h1>')
2458.         self.assertContains(response, '<div class="readonly">user_proxy</div>')
2459. 
2460.     def test_change(self):
2461.         self.client.force_login(self.changeuser)
2462.         data = {
2463.             'password': self.user_proxy.password,
2464.             'username': self.user_proxy.username,
2465.             'date_joined_0': self.user_proxy.date_joined.strftime('%Y-%m-%d'),
2466.             'date_joined_1': self.user_proxy.date_joined.strftime('%H:%M:%S'),
2467.             'first_name': 'first_name',
2468.         }
2469.         url = reverse('admin:admin_views_userproxy_change', args=(self.user_proxy.pk,))
2470.         response = self.client.post(url, data)
2471.         self.assertRedirects(response, reverse('admin:admin_views_userproxy_changelist'))
2472.         self.assertEqual(UserProxy.objects.get(pk=self.user_proxy.pk).first_name, 'first_name')
2473. 
2474.     def test_delete(self):
2475.         self.client.force_login(self.deleteuser)
2476.         url = reverse('admin:admin_views_userproxy_delete', args=(self.user_proxy.pk,))
2477.         response = self.client.post(url, {'post': 'yes'}, follow=True)
2478.         self.assertEqual(response.status_code, 200)
2479.         self.assertFalse(UserProxy.objects.filter(pk=self.user_proxy.pk).exists())
2480. 
2481. 
2482. @override_settings(ROOT_URLCONF='admin_views.urls')
2483. class AdminViewsNoUrlTest(TestCase):
2484.     """Regression test for #17333"""
2485. 
2486.     @classmethod
2487.     def setUpTestData(cls):
2488.         # User who can change Reports
2489.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
2490.         cls.changeuser.user_permissions.add(get_perm(Report, get_permission_codename('change', Report._meta)))
2491. 
2492.     def test_no_standard_modeladmin_urls(self):
2493.         """Admin index views don't break when user's ModelAdmin removes standard urls"""
2494.         self.client.force_login(self.changeuser)
2495.         r = self.client.get(reverse('admin:index'))
2496.         # we shouldn't get a 500 error caused by a NoReverseMatch
2497.         self.assertEqual(r.status_code, 200)
2498.         self.client.get(reverse('admin:logout'))
2499. 
2500. 
2501. @skipUnlessDBFeature('can_defer_constraint_checks')
2502. @override_settings(ROOT_URLCONF='admin_views.urls')
2503. class AdminViewDeletedObjectsTest(TestCase):
2504. 
2505.     @classmethod
2506.     def setUpTestData(cls):
2507.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2508.         cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
2509.         cls.s1 = Section.objects.create(name='Test section')
2510.         cls.a1 = Article.objects.create(
2511.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
2512.         )
2513.         cls.a2 = Article.objects.create(
2514.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
2515.         )
2516.         cls.a3 = Article.objects.create(
2517.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
2518.         )
2519.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
2520. 
2521.         cls.v1 = Villain.objects.create(name='Adam')
2522.         cls.v2 = Villain.objects.create(name='Sue')
2523.         cls.sv1 = SuperVillain.objects.create(name='Bob')
2524.         cls.pl1 = Plot.objects.create(name='World Domination', team_leader=cls.v1, contact=cls.v2)
2525.         cls.pl2 = Plot.objects.create(name='World Peace', team_leader=cls.v2, contact=cls.v2)
2526.         cls.pl3 = Plot.objects.create(name='Corn Conspiracy', team_leader=cls.v1, contact=cls.v1)
2527.         cls.pd1 = PlotDetails.objects.create(details='almost finished', plot=cls.pl1)
2528.         cls.sh1 = SecretHideout.objects.create(location='underground bunker', villain=cls.v1)
2529.         cls.sh2 = SecretHideout.objects.create(location='floating castle', villain=cls.sv1)
2530.         cls.ssh1 = SuperSecretHideout.objects.create(location='super floating castle!', supervillain=cls.sv1)
2531.         cls.cy1 = CyclicOne.objects.create(name='I am recursive', two_id=1)
2532.         cls.cy2 = CyclicTwo.objects.create(name='I am recursive too', one_id=1)
2533. 
2534.     def setUp(self):
2535.         self.client.force_login(self.superuser)
2536. 
2537.     def test_nesting(self):
2538.         """
2539.         Objects should be nested to display the relationships that
2540.         cause them to be scheduled for deletion.
2541.         """
2542.         pattern = re.compile(
2543.             r'<li>Plot: <a href="%s">World Domination</a>\s*<ul>\s*'
2544.             r'<li>Plot details: <a href="%s">almost finished</a>' % (
2545.                 reverse('admin:admin_views_plot_change', args=(self.pl1.pk,)),
2546.                 reverse('admin:admin_views_plotdetails_change', args=(self.pd1.pk,)),
2547.             )
2548.         )
2549.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v1.pk,)))
2550.         self.assertRegex(response.content.decode(), pattern)
2551. 
2552.     def test_cyclic(self):
2553.         """
2554.         Cyclic relationships should still cause each object to only be
2555.         listed once.
2556.         """
2557.         one = '<li>Cyclic one: <a href="%s">I am recursive</a>' % (
2558.             reverse('admin:admin_views_cyclicone_change', args=(self.cy1.pk,)),
2559.         )
2560.         two = '<li>Cyclic two: <a href="%s">I am recursive too</a>' % (
2561.             reverse('admin:admin_views_cyclictwo_change', args=(self.cy2.pk,)),
2562.         )
2563.         response = self.client.get(reverse('admin:admin_views_cyclicone_delete', args=(self.cy1.pk,)))
2564. 
2565.         self.assertContains(response, one, 1)
2566.         self.assertContains(response, two, 1)
2567. 
2568.     def test_perms_needed(self):
2569.         self.client.logout()
2570.         delete_user = User.objects.get(username='deleteuser')
2571.         delete_user.user_permissions.add(get_perm(Plot, get_permission_codename('delete', Plot._meta)))
2572. 
2573.         self.client.force_login(self.deleteuser)
2574.         response = self.client.get(reverse('admin:admin_views_plot_delete', args=(self.pl1.pk,)))
2575.         self.assertContains(response, "your account doesn't have permission to delete the following types of objects")
2576.         self.assertContains(response, "<li>plot details</li>")
2577. 
2578.     def test_protected(self):
2579.         q = Question.objects.create(question="Why?")
2580.         a1 = Answer.objects.create(question=q, answer="Because.")
2581.         a2 = Answer.objects.create(question=q, answer="Yes.")
2582. 
2583.         response = self.client.get(reverse('admin:admin_views_question_delete', args=(q.pk,)))
2584.         self.assertContains(response, "would require deleting the following protected related objects")
2585.         self.assertContains(
2586.             response,
2587.             '<li>Answer: <a href="%s">Because.</a></li>' % reverse('admin:admin_views_answer_change', args=(a1.pk,))
2588.         )
2589.         self.assertContains(
2590.             response,
2591.             '<li>Answer: <a href="%s">Yes.</a></li>' % reverse('admin:admin_views_answer_change', args=(a2.pk,))
2592.         )
2593. 
2594.     def test_post_delete_protected(self):
2595.         """
2596.         A POST request to delete protected objects should display the page
2597.         which says the deletion is prohibited.
2598.         """
2599.         q = Question.objects.create(question='Why?')
2600.         Answer.objects.create(question=q, answer='Because.')
2601. 
2602.         response = self.client.post(reverse('admin:admin_views_question_delete', args=(q.pk,)), {'post': 'yes'})
2603.         self.assertEqual(Question.objects.count(), 1)
2604.         self.assertContains(response, "would require deleting the following protected related objects")
2605. 
2606.     def test_not_registered(self):
2607.         should_contain = """<li>Secret hideout: underground bunker"""
2608.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v1.pk,)))
2609.         self.assertContains(response, should_contain, 1)
2610. 
2611.     def test_multiple_fkeys_to_same_model(self):
2612.         """
2613.         If a deleted object has two relationships from another model,
2614.         both of those should be followed in looking for related
2615.         objects to delete.
2616.         """
2617.         should_contain = '<li>Plot: <a href="%s">World Domination</a>' % reverse(
2618.             'admin:admin_views_plot_change', args=(self.pl1.pk,)
2619.         )
2620.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v1.pk,)))
2621.         self.assertContains(response, should_contain)
2622.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v2.pk,)))
2623.         self.assertContains(response, should_contain)
2624. 
2625.     def test_multiple_fkeys_to_same_instance(self):
2626.         """
2627.         If a deleted object has two relationships pointing to it from
2628.         another object, the other object should still only be listed
2629.         once.
2630.         """
2631.         should_contain = '<li>Plot: <a href="%s">World Peace</a></li>' % reverse(
2632.             'admin:admin_views_plot_change', args=(self.pl2.pk,)
2633.         )
2634.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v2.pk,)))
2635.         self.assertContains(response, should_contain, 1)
2636. 
2637.     def test_inheritance(self):
2638.         """
2639.         In the case of an inherited model, if either the child or
2640.         parent-model instance is deleted, both instances are listed
2641.         for deletion, as well as any relationships they have.
2642.         """
2643.         should_contain = [
2644.             '<li>Villain: <a href="%s">Bob</a>' % reverse('admin:admin_views_villain_change', args=(self.sv1.pk,)),
2645.             '<li>Super villain: <a href="%s">Bob</a>' % reverse(
2646.                 'admin:admin_views_supervillain_change', args=(self.sv1.pk,)
2647.             ),
2648.             '<li>Secret hideout: floating castle',
2649.             '<li>Super secret hideout: super floating castle!',
2650.         ]
2651.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.sv1.pk,)))
2652.         for should in should_contain:
2653.             self.assertContains(response, should, 1)
2654.         response = self.client.get(reverse('admin:admin_views_supervillain_delete', args=(self.sv1.pk,)))
2655.         for should in should_contain:
2656.             self.assertContains(response, should, 1)
2657. 
2658.     def test_generic_relations(self):
2659.         """
2660.         If a deleted object has GenericForeignKeys pointing to it,
2661.         those objects should be listed for deletion.
2662.         """
2663.         plot = self.pl3
2664.         tag = FunkyTag.objects.create(content_object=plot, name='hott')
2665.         should_contain = '<li>Funky tag: <a href="%s">hott' % reverse(
2666.             'admin:admin_views_funkytag_change', args=(tag.id,))
2667.         response = self.client.get(reverse('admin:admin_views_plot_delete', args=(plot.pk,)))
2668.         self.assertContains(response, should_contain)
2669. 
2670.     def test_generic_relations_with_related_query_name(self):
2671.         """
2672.         If a deleted object has GenericForeignKey with
2673.         GenericRelation(related_query_name='...') pointing to it, those objects
2674.         should be listed for deletion.
2675.         """
2676.         bookmark = Bookmark.objects.create(name='djangoproject')
2677.         tag = FunkyTag.objects.create(content_object=bookmark, name='django')
2678.         tag_url = reverse('admin:admin_views_funkytag_change', args=(tag.id,))
2679.         should_contain = '<li>Funky tag: <a href="%s">django' % tag_url
2680.         response = self.client.get(reverse('admin:admin_views_bookmark_delete', args=(bookmark.pk,)))
2681.         self.assertContains(response, should_contain)
2682. 
2683.     def test_delete_view_uses_get_deleted_objects(self):
2684.         """The delete view uses ModelAdmin.get_deleted_objects()."""
2685.         book = Book.objects.create(name='Test Book')
2686.         response = self.client.get(reverse('admin2:admin_views_book_delete', args=(book.pk,)))
2687.         # BookAdmin.get_deleted_objects() returns custom text.
2688.         self.assertContains(response, 'a deletable object')
2689. 
2690. 
2691. @override_settings(ROOT_URLCONF='admin_views.urls')
2692. class TestGenericRelations(TestCase):
2693. 
2694.     @classmethod
2695.     def setUpTestData(cls):
2696.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2697.         cls.v1 = Villain.objects.create(name='Adam')
2698.         cls.pl3 = Plot.objects.create(name='Corn Conspiracy', team_leader=cls.v1, contact=cls.v1)
2699. 
2700.     def setUp(self):
2701.         self.client.force_login(self.superuser)
2702. 
2703.     def test_generic_content_object_in_list_display(self):
2704.         FunkyTag.objects.create(content_object=self.pl3, name='hott')
2705.         response = self.client.get(reverse('admin:admin_views_funkytag_changelist'))
2706.         self.assertContains(response, "%s</td>" % self.pl3)
2707. 
2708. 
2709. @override_settings(ROOT_URLCONF='admin_views.urls')
2710. class AdminViewStringPrimaryKeyTest(TestCase):
2711. 
2712.     @classmethod
2713.     def setUpTestData(cls):
2714.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2715.         cls.s1 = Section.objects.create(name='Test section')
2716.         cls.a1 = Article.objects.create(
2717.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
2718.         )
2719.         cls.a2 = Article.objects.create(
2720.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
2721.         )
2722.         cls.a3 = Article.objects.create(
2723.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
2724.         )
2725.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
2726.         cls.pk = (
2727.             "abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 "
2728.             r"""-_.!~*'() ;/?:@&=+$, <>#%" {}|\^[]`"""
2729.         )
2730.         cls.m1 = ModelWithStringPrimaryKey.objects.create(string_pk=cls.pk)
2731.         content_type_pk = ContentType.objects.get_for_model(ModelWithStringPrimaryKey).pk
2732.         user_pk = cls.superuser.pk
2733.         LogEntry.objects.log_action(user_pk, content_type_pk, cls.pk, cls.pk, 2, change_message='Changed something')
2734. 
2735.     def setUp(self):
2736.         self.client.force_login(self.superuser)
2737. 
2738.     def test_get_history_view(self):
2739.         """
2740.         Retrieving the history for an object using urlencoded form of primary
2741.         key should work.
2742.         Refs #12349, #18550.
2743.         """
2744.         response = self.client.get(reverse('admin:admin_views_modelwithstringprimarykey_history', args=(self.pk,)))
2745.         self.assertContains(response, escape(self.pk))
2746.         self.assertContains(response, 'Changed something')
2747.         self.assertEqual(response.status_code, 200)
2748. 
2749.     def test_get_change_view(self):
2750.         "Retrieving the object using urlencoded form of primary key should work"
2751.         response = self.client.get(reverse('admin:admin_views_modelwithstringprimarykey_change', args=(self.pk,)))
2752.         self.assertContains(response, escape(self.pk))
2753.         self.assertEqual(response.status_code, 200)
2754. 
2755.     def test_changelist_to_changeform_link(self):
2756.         "Link to the changeform of the object in changelist should use reverse() and be quoted -- #18072"
2757.         response = self.client.get(reverse('admin:admin_views_modelwithstringprimarykey_changelist'))
2758.         # this URL now comes through reverse(), thus url quoting and iri_to_uri encoding
2759.         pk_final_url = escape(iri_to_uri(quote(self.pk)))
2760.         change_url = reverse(
2761.             'admin:admin_views_modelwithstringprimarykey_change', args=('__fk__',)
2762.         ).replace('__fk__', pk_final_url)
2763.         should_contain = '<th class="field-__str__"><a href="%s">%s</a></th>' % (change_url, escape(self.pk))
2764.         self.assertContains(response, should_contain)
2765. 
2766.     def test_recentactions_link(self):
2767.         "The link from the recent actions list referring to the changeform of the object should be quoted"
2768.         response = self.client.get(reverse('admin:index'))
2769.         link = reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(self.pk),))
2770.         should_contain = """<a href="%s">%s</a>""" % (escape(link), escape(self.pk))
2771.         self.assertContains(response, should_contain)
2772. 
2773.     def test_deleteconfirmation_link(self):
2774.         "The link from the delete confirmation page referring back to the changeform of the object should be quoted"
2775.         url = reverse('admin:admin_views_modelwithstringprimarykey_delete', args=(quote(self.pk),))
2776.         response = self.client.get(url)
2777.         # this URL now comes through reverse(), thus url quoting and iri_to_uri encoding
2778.         change_url = reverse(
2779.             'admin:admin_views_modelwithstringprimarykey_change', args=('__fk__',)
2780.         ).replace('__fk__', escape(iri_to_uri(quote(self.pk))))
2781.         should_contain = '<a href="%s">%s</a>' % (change_url, escape(self.pk))
2782.         self.assertContains(response, should_contain)
2783. 
2784.     def test_url_conflicts_with_add(self):
2785.         "A model with a primary key that ends with add or is `add` should be visible"
2786.         add_model = ModelWithStringPrimaryKey.objects.create(pk="i have something to add")
2787.         add_model.save()
2788.         response = self.client.get(
2789.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(add_model.pk),))
2790.         )
2791.         should_contain = """<h1>Change model with string primary key</h1>"""
2792.         self.assertContains(response, should_contain)
2793. 
2794.         add_model2 = ModelWithStringPrimaryKey.objects.create(pk="add")
2795.         add_url = reverse('admin:admin_views_modelwithstringprimarykey_add')
2796.         change_url = reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(add_model2.pk),))
2797.         self.assertNotEqual(add_url, change_url)
2798. 
2799.     def test_url_conflicts_with_delete(self):
2800.         "A model with a primary key that ends with delete should be visible"
2801.         delete_model = ModelWithStringPrimaryKey(pk="delete")
2802.         delete_model.save()
2803.         response = self.client.get(
2804.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(delete_model.pk),))
2805.         )
2806.         should_contain = """<h1>Change model with string primary key</h1>"""
2807.         self.assertContains(response, should_contain)
2808. 
2809.     def test_url_conflicts_with_history(self):
2810.         "A model with a primary key that ends with history should be visible"
2811.         history_model = ModelWithStringPrimaryKey(pk="history")
2812.         history_model.save()
2813.         response = self.client.get(
2814.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(history_model.pk),))
2815.         )
2816.         should_contain = """<h1>Change model with string primary key</h1>"""
2817.         self.assertContains(response, should_contain)
2818. 
2819.     def test_shortcut_view_with_escaping(self):
2820.         "'View on site should' work properly with char fields"
2821.         model = ModelWithStringPrimaryKey(pk='abc_123')
2822.         model.save()
2823.         response = self.client.get(
2824.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(model.pk),))
2825.         )
2826.         should_contain = '/%s/" class="viewsitelink">' % model.pk
2827.         self.assertContains(response, should_contain)
2828. 
2829.     def test_change_view_history_link(self):
2830.         """Object history button link should work and contain the pk value quoted."""
2831.         url = reverse(
2832.             'admin:%s_modelwithstringprimarykey_change' % ModelWithStringPrimaryKey._meta.app_label,
2833.             args=(quote(self.pk),)
2834.         )
2835.         response = self.client.get(url)
2836.         self.assertEqual(response.status_code, 200)
2837.         expected_link = reverse(
2838.             'admin:%s_modelwithstringprimarykey_history' % ModelWithStringPrimaryKey._meta.app_label,
2839.             args=(quote(self.pk),)
2840.         )
2841.         self.assertContains(response, '<a href="%s" class="historylink"' % escape(expected_link))
2842. 
2843.     def test_redirect_on_add_view_continue_button(self):
2844.         """As soon as an object is added using "Save and continue editing"
2845.         button, the user should be redirected to the object's change_view.
2846. 
2847.         In case primary key is a string containing some special characters
2848.         like slash or underscore, these characters must be escaped (see #22266)
2849.         """
2850.         response = self.client.post(
2851.             reverse('admin:admin_views_modelwithstringprimarykey_add'),
2852.             {
2853.                 'string_pk': '123/history',
2854.                 "_continue": "1",  # Save and continue editing
2855.             }
2856.         )
2857. 
2858.         self.assertEqual(response.status_code, 302)  # temporary redirect
2859.         self.assertIn('/123_2Fhistory/', response['location'])  # PK is quoted
2860. 
2861. 
2862. @override_settings(ROOT_URLCONF='admin_views.urls')
2863. class SecureViewTests(TestCase):
2864.     """
2865.     Test behavior of a view protected by the staff_member_required decorator.
2866.     """
2867. 
2868.     def test_secure_view_shows_login_if_not_logged_in(self):
2869.         secure_url = reverse('secure_view')
2870.         response = self.client.get(secure_url)
2871.         self.assertRedirects(response, '%s?next=%s' % (reverse('admin:login'), secure_url))
2872.         response = self.client.get(secure_url, follow=True)
2873.         self.assertTemplateUsed(response, 'admin/login.html')
2874.         self.assertEqual(response.context[REDIRECT_FIELD_NAME], secure_url)
2875. 
2876.     def test_staff_member_required_decorator_works_with_argument(self):
2877.         """
2878.         Staff_member_required decorator works with an argument
2879.         (redirect_field_name).
2880.         """
2881.         secure_url = '/test_admin/admin/secure-view2/'
2882.         response = self.client.get(secure_url)
2883.         self.assertRedirects(response, '%s?myfield=%s' % (reverse('admin:login'), secure_url))
2884. 
2885. 
2886. @override_settings(ROOT_URLCONF='admin_views.urls')
2887. class AdminViewUnicodeTest(TestCase):
2888. 
2889.     @classmethod
2890.     def setUpTestData(cls):
2891.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2892.         cls.b1 = Book.objects.create(name='Lærdommer')
2893.         cls.p1 = Promo.objects.create(name='<Promo for Lærdommer>', book=cls.b1)
2894.         cls.chap1 = Chapter.objects.create(
2895.             title='Norske bostaver æøå skaper problemer', content='<p>Svært frustrerende med UnicodeDecodeErro</p>',
2896.             book=cls.b1
2897.         )
2898.         cls.chap2 = Chapter.objects.create(
2899.             title='Kjærlighet', content='<p>La kjærligheten til de lidende seire.</p>', book=cls.b1)
2900.         cls.chap3 = Chapter.objects.create(title='Kjærlighet', content='<p>Noe innhold</p>', book=cls.b1)
2901.         cls.chap4 = ChapterXtra1.objects.create(chap=cls.chap1, xtra='<Xtra(1) Norske bostaver æøå skaper problemer>')
2902.         cls.chap5 = ChapterXtra1.objects.create(chap=cls.chap2, xtra='<Xtra(1) Kjærlighet>')
2903.         cls.chap6 = ChapterXtra1.objects.create(chap=cls.chap3, xtra='<Xtra(1) Kjærlighet>')
2904.         cls.chap7 = ChapterXtra2.objects.create(chap=cls.chap1, xtra='<Xtra(2) Norske bostaver æøå skaper problemer>')
2905.         cls.chap8 = ChapterXtra2.objects.create(chap=cls.chap2, xtra='<Xtra(2) Kjærlighet>')
2906.         cls.chap9 = ChapterXtra2.objects.create(chap=cls.chap3, xtra='<Xtra(2) Kjærlighet>')
2907. 
2908.     def setUp(self):
2909.         self.client.force_login(self.superuser)
2910. 
2911.     def test_unicode_edit(self):
2912.         """
2913.         A test to ensure that POST on edit_view handles non-ASCII characters.
2914.         """
2915.         post_data = {
2916.             "name": "Test lærdommer",
2917.             # inline data
2918.             "chapter_set-TOTAL_FORMS": "6",
2919.             "chapter_set-INITIAL_FORMS": "3",
2920.             "chapter_set-MAX_NUM_FORMS": "0",
2921.             "chapter_set-0-id": self.chap1.pk,
2922.             "chapter_set-0-title": "Norske bostaver æøå skaper problemer",
2923.             "chapter_set-0-content": "&lt;p&gt;Svært frustrerende med UnicodeDecodeError&lt;/p&gt;",
2924.             "chapter_set-1-id": self.chap2.id,
2925.             "chapter_set-1-title": "Kjærlighet.",
2926.             "chapter_set-1-content": "&lt;p&gt;La kjærligheten til de lidende seire.&lt;/p&gt;",
2927.             "chapter_set-2-id": self.chap3.id,
2928.             "chapter_set-2-title": "Need a title.",
2929.             "chapter_set-2-content": "&lt;p&gt;Newest content&lt;/p&gt;",
2930.             "chapter_set-3-id": "",
2931.             "chapter_set-3-title": "",
2932.             "chapter_set-3-content": "",
2933.             "chapter_set-4-id": "",
2934.             "chapter_set-4-title": "",
2935.             "chapter_set-4-content": "",
2936.             "chapter_set-5-id": "",
2937.             "chapter_set-5-title": "",
2938.             "chapter_set-5-content": "",
2939.         }
2940. 
2941.         response = self.client.post(reverse('admin:admin_views_book_change', args=(self.b1.pk,)), post_data)
2942.         self.assertEqual(response.status_code, 302)  # redirect somewhere
2943. 
2944.     def test_unicode_delete(self):
2945.         """
2946.         The delete_view handles non-ASCII characters
2947.         """
2948.         delete_dict = {'post': 'yes'}
2949.         delete_url = reverse('admin:admin_views_book_delete', args=(self.b1.pk,))
2950.         response = self.client.get(delete_url)
2951.         self.assertEqual(response.status_code, 200)
2952.         response = self.client.post(delete_url, delete_dict)
2953.         self.assertRedirects(response, reverse('admin:admin_views_book_changelist'))
2954. 
2955. 
2956. @override_settings(ROOT_URLCONF='admin_views.urls')
2957. class AdminViewListEditable(TestCase):
2958. 
2959.     @classmethod
2960.     def setUpTestData(cls):
2961.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2962.         cls.s1 = Section.objects.create(name='Test section')
2963.         cls.a1 = Article.objects.create(
2964.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
2965.         )
2966.         cls.a2 = Article.objects.create(
2967.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
2968.         )
2969.         cls.a3 = Article.objects.create(
2970.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
2971.         )
2972.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
2973.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
2974.         cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
2975.         cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)
2976. 
2977.     def setUp(self):
2978.         self.client.force_login(self.superuser)
2979. 
2980.     def test_inheritance(self):
2981.         Podcast.objects.create(name="This Week in Django", release_date=datetime.date.today())
2982.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'))
2983.         self.assertEqual(response.status_code, 200)
2984. 
2985.     def test_inheritance_2(self):
2986.         Vodcast.objects.create(name="This Week in Django", released=True)
2987.         response = self.client.get(reverse('admin:admin_views_vodcast_changelist'))
2988.         self.assertEqual(response.status_code, 200)
2989. 
2990.     def test_custom_pk(self):
2991.         Language.objects.create(iso='en', name='English', english_name='English')
2992.         response = self.client.get(reverse('admin:admin_views_language_changelist'))
2993.         self.assertEqual(response.status_code, 200)
2994. 
2995.     def test_changelist_input_html(self):
2996.         response = self.client.get(reverse('admin:admin_views_person_changelist'))
2997.         # 2 inputs per object(the field and the hidden id field) = 6
2998.         # 4 management hidden fields = 4
2999.         # 4 action inputs (3 regular checkboxes, 1 checkbox to select all)
3000.         # main form submit button = 1
3001.         # search field and search submit button = 2
3002.         # CSRF field = 1
3003.         # field to track 'select all' across paginated views = 1
3004.         # 6 + 4 + 4 + 1 + 2 + 1 + 1 = 19 inputs
3005.         self.assertContains(response, "<input", count=19)
3006.         # 1 select per object = 3 selects
3007.         self.assertContains(response, "<select", count=4)
3008. 
3009.     def test_post_messages(self):
3010.         # Ticket 12707: Saving inline editable should not show admin
3011.         # action warnings
3012.         data = {
3013.             "form-TOTAL_FORMS": "3",
3014.             "form-INITIAL_FORMS": "3",
3015.             "form-MAX_NUM_FORMS": "0",
3016. 
3017.             "form-0-gender": "1",
3018.             "form-0-id": "%s" % self.per1.pk,
3019. 
3020.             "form-1-gender": "2",
3021.             "form-1-id": "%s" % self.per2.pk,
3022. 
3023.             "form-2-alive": "checked",
3024.             "form-2-gender": "1",
3025.             "form-2-id": "%s" % self.per3.pk,
3026. 
3027.             "_save": "Save",
3028.         }
3029.         response = self.client.post(reverse('admin:admin_views_person_changelist'),
3030.                                     data, follow=True)
3031.         self.assertEqual(len(response.context['messages']), 1)
3032. 
3033.     def test_post_submission(self):
3034.         data = {
3035.             "form-TOTAL_FORMS": "3",
3036.             "form-INITIAL_FORMS": "3",
3037.             "form-MAX_NUM_FORMS": "0",
3038. 
3039.             "form-0-gender": "1",
3040.             "form-0-id": "%s" % self.per1.pk,
3041. 
3042.             "form-1-gender": "2",
3043.             "form-1-id": "%s" % self.per2.pk,
3044. 
3045.             "form-2-alive": "checked",
3046.             "form-2-gender": "1",
3047.             "form-2-id": "%s" % self.per3.pk,
3048. 
3049.             "_save": "Save",
3050.         }
3051.         self.client.post(reverse('admin:admin_views_person_changelist'), data)
3052. 
3053.         self.assertIs(Person.objects.get(name="John Mauchly").alive, False)
3054.         self.assertEqual(Person.objects.get(name="Grace Hopper").gender, 2)
3055. 
3056.         # test a filtered page
3057.         data = {
3058.             "form-TOTAL_FORMS": "2",
3059.             "form-INITIAL_FORMS": "2",
3060.             "form-MAX_NUM_FORMS": "0",
3061. 
3062.             "form-0-id": "%s" % self.per1.pk,
3063.             "form-0-gender": "1",
3064.             "form-0-alive": "checked",
3065. 
3066.             "form-1-id": "%s" % self.per3.pk,
3067.             "form-1-gender": "1",
3068.             "form-1-alive": "checked",
3069. 
3070.             "_save": "Save",
3071.         }
3072.         self.client.post(reverse('admin:admin_views_person_changelist') + '?gender__exact=1', data)
3073. 
3074.         self.assertIs(Person.objects.get(name="John Mauchly").alive, True)
3075. 
3076.         # test a searched page
3077.         data = {
3078.             "form-TOTAL_FORMS": "1",
3079.             "form-INITIAL_FORMS": "1",
3080.             "form-MAX_NUM_FORMS": "0",
3081. 
3082.             "form-0-id": "%s" % self.per1.pk,
3083.             "form-0-gender": "1",
3084. 
3085.             "_save": "Save",
3086.         }
3087.         self.client.post(reverse('admin:admin_views_person_changelist') + '?q=john', data)
3088. 
3089.         self.assertIs(Person.objects.get(name="John Mauchly").alive, False)
3090. 
3091.     def test_non_field_errors(self):
3092.         """
3093.         Non-field errors are displayed for each of the forms in the
3094.         changelist's formset.
3095.         """
3096.         fd1 = FoodDelivery.objects.create(reference='123', driver='bill', restaurant='thai')
3097.         fd2 = FoodDelivery.objects.create(reference='456', driver='bill', restaurant='india')
3098.         fd3 = FoodDelivery.objects.create(reference='789', driver='bill', restaurant='pizza')
3099. 
3100.         data = {
3101.             "form-TOTAL_FORMS": "3",
3102.             "form-INITIAL_FORMS": "3",
3103.             "form-MAX_NUM_FORMS": "0",
3104. 
3105.             "form-0-id": str(fd1.id),
3106.             "form-0-reference": "123",
3107.             "form-0-driver": "bill",
3108.             "form-0-restaurant": "thai",
3109. 
3110.             # Same data as above: Forbidden because of unique_together!
3111.             "form-1-id": str(fd2.id),
3112.             "form-1-reference": "456",
3113.             "form-1-driver": "bill",
3114.             "form-1-restaurant": "thai",
3115. 
3116.             "form-2-id": str(fd3.id),
3117.             "form-2-reference": "789",
3118.             "form-2-driver": "bill",
3119.             "form-2-restaurant": "pizza",
3120. 
3121.             "_save": "Save",
3122.         }
3123.         response = self.client.post(reverse('admin:admin_views_fooddelivery_changelist'), data)
3124.         self.assertContains(
3125.             response,
3126.             '<tr><td colspan="4"><ul class="errorlist nonfield"><li>Food delivery '
3127.             'with this Driver and Restaurant already exists.</li></ul></td></tr>',
3128.             1,
3129.             html=True
3130.         )
3131. 
3132.         data = {
3133.             "form-TOTAL_FORMS": "3",
3134.             "form-INITIAL_FORMS": "3",
3135.             "form-MAX_NUM_FORMS": "0",
3136. 
3137.             "form-0-id": str(fd1.id),
3138.             "form-0-reference": "123",
3139.             "form-0-driver": "bill",
3140.             "form-0-restaurant": "thai",
3141. 
3142.             # Same data as above: Forbidden because of unique_together!
3143.             "form-1-id": str(fd2.id),
3144.             "form-1-reference": "456",
3145.             "form-1-driver": "bill",
3146.             "form-1-restaurant": "thai",
3147. 
3148.             # Same data also.
3149.             "form-2-id": str(fd3.id),
3150.             "form-2-reference": "789",
3151.             "form-2-driver": "bill",
3152.             "form-2-restaurant": "thai",
3153. 
3154.             "_save": "Save",
3155.         }
3156.         response = self.client.post(reverse('admin:admin_views_fooddelivery_changelist'), data)
3157.         self.assertContains(
3158.             response,
3159.             '<tr><td colspan="4"><ul class="errorlist nonfield"><li>Food delivery '
3160.             'with this Driver and Restaurant already exists.</li></ul></td></tr>',
3161.             2,
3162.             html=True
3163.         )
3164. 
3165.     def test_non_form_errors(self):
3166.         # test if non-form errors are handled; ticket #12716
3167.         data = {
3168.             "form-TOTAL_FORMS": "1",
3169.             "form-INITIAL_FORMS": "1",
3170.             "form-MAX_NUM_FORMS": "0",
3171. 
3172.             "form-0-id": "%s" % self.per2.pk,
3173.             "form-0-alive": "1",
3174.             "form-0-gender": "2",
3175. 
3176.             # The form processing understands this as a list_editable "Save"
3177.             # and not an action "Go".
3178.             "_save": "Save",
3179.         }
3180.         response = self.client.post(reverse('admin:admin_views_person_changelist'), data)
3181.         self.assertContains(response, "Grace is not a Zombie")
3182. 
3183.     def test_non_form_errors_is_errorlist(self):
3184.         # test if non-form errors are correctly handled; ticket #12878
3185.         data = {
3186.             "form-TOTAL_FORMS": "1",
3187.             "form-INITIAL_FORMS": "1",
3188.             "form-MAX_NUM_FORMS": "0",
3189. 
3190.             "form-0-id": "%s" % self.per2.pk,
3191.             "form-0-alive": "1",
3192.             "form-0-gender": "2",
3193. 
3194.             "_save": "Save",
3195.         }
3196.         response = self.client.post(reverse('admin:admin_views_person_changelist'), data)
3197.         non_form_errors = response.context['cl'].formset.non_form_errors()
3198.         self.assertIsInstance(non_form_errors, ErrorList)
3199.         self.assertEqual(str(non_form_errors), str(ErrorList(["Grace is not a Zombie"])))
3200. 
3201.     def test_list_editable_ordering(self):
3202.         collector = Collector.objects.create(id=1, name="Frederick Clegg")
3203. 
3204.         Category.objects.create(id=1, order=1, collector=collector)
3205.         Category.objects.create(id=2, order=2, collector=collector)
3206.         Category.objects.create(id=3, order=0, collector=collector)
3207.         Category.objects.create(id=4, order=0, collector=collector)
3208. 
3209.         # NB: The order values must be changed so that the items are reordered.
3210.         data = {
3211.             "form-TOTAL_FORMS": "4",
3212.             "form-INITIAL_FORMS": "4",
3213.             "form-MAX_NUM_FORMS": "0",
3214. 
3215.             "form-0-order": "14",
3216.             "form-0-id": "1",
3217.             "form-0-collector": "1",
3218. 
3219.             "form-1-order": "13",
3220.             "form-1-id": "2",
3221.             "form-1-collector": "1",
3222. 
3223.             "form-2-order": "1",
3224.             "form-2-id": "3",
3225.             "form-2-collector": "1",
3226. 
3227.             "form-3-order": "0",
3228.             "form-3-id": "4",
3229.             "form-3-collector": "1",
3230. 
3231.             # The form processing understands this as a list_editable "Save"
3232.             # and not an action "Go".
3233.             "_save": "Save",
3234.         }
3235.         response = self.client.post(reverse('admin:admin_views_category_changelist'), data)
3236.         # Successful post will redirect
3237.         self.assertEqual(response.status_code, 302)
3238. 
3239.         # The order values have been applied to the right objects
3240.         self.assertEqual(Category.objects.get(id=1).order, 14)
3241.         self.assertEqual(Category.objects.get(id=2).order, 13)
3242.         self.assertEqual(Category.objects.get(id=3).order, 1)
3243.         self.assertEqual(Category.objects.get(id=4).order, 0)
3244. 
3245.     def test_list_editable_pagination(self):
3246.         """
3247.         Pagination works for list_editable items.
3248.         """
3249.         UnorderedObject.objects.create(id=1, name='Unordered object #1')
3250.         UnorderedObject.objects.create(id=2, name='Unordered object #2')
3251.         UnorderedObject.objects.create(id=3, name='Unordered object #3')
3252.         response = self.client.get(reverse('admin:admin_views_unorderedobject_changelist'))
3253.         self.assertContains(response, 'Unordered object #3')
3254.         self.assertContains(response, 'Unordered object #2')
3255.         self.assertNotContains(response, 'Unordered object #1')
3256.         response = self.client.get(reverse('admin:admin_views_unorderedobject_changelist') + '?p=1')
3257.         self.assertNotContains(response, 'Unordered object #3')
3258.         self.assertNotContains(response, 'Unordered object #2')
3259.         self.assertContains(response, 'Unordered object #1')
3260. 
3261.     def test_list_editable_action_submit(self):
3262.         # List editable changes should not be executed if the action "Go" button is
3263.         # used to submit the form.
3264.         data = {
3265.             "form-TOTAL_FORMS": "3",
3266.             "form-INITIAL_FORMS": "3",
3267.             "form-MAX_NUM_FORMS": "0",
3268. 
3269.             "form-0-gender": "1",
3270.             "form-0-id": "1",
3271. 
3272.             "form-1-gender": "2",
3273.             "form-1-id": "2",
3274. 
3275.             "form-2-alive": "checked",
3276.             "form-2-gender": "1",
3277.             "form-2-id": "3",
3278. 
3279.             "index": "0",
3280.             "_selected_action": ['3'],
3281.             "action": ['', 'delete_selected'],
3282.         }
3283.         self.client.post(reverse('admin:admin_views_person_changelist'), data)
3284. 
3285.         self.assertIs(Person.objects.get(name="John Mauchly").alive, True)
3286.         self.assertEqual(Person.objects.get(name="Grace Hopper").gender, 1)
3287. 
3288.     def test_list_editable_action_choices(self):
3289.         # List editable changes should be executed if the "Save" button is
3290.         # used to submit the form - any action choices should be ignored.
3291.         data = {
3292.             "form-TOTAL_FORMS": "3",
3293.             "form-INITIAL_FORMS": "3",
3294.             "form-MAX_NUM_FORMS": "0",
3295. 
3296.             "form-0-gender": "1",
3297.             "form-0-id": "%s" % self.per1.pk,
3298. 
3299.             "form-1-gender": "2",
3300.             "form-1-id": "%s" % self.per2.pk,
3301. 
3302.             "form-2-alive": "checked",
3303.             "form-2-gender": "1",
3304.             "form-2-id": "%s" % self.per3.pk,
3305. 
3306.             "_save": "Save",
3307.             "_selected_action": ['1'],
3308.             "action": ['', 'delete_selected'],
3309.         }
3310.         self.client.post(reverse('admin:admin_views_person_changelist'), data)
3311. 
3312.         self.assertIs(Person.objects.get(name="John Mauchly").alive, False)
3313.         self.assertEqual(Person.objects.get(name="Grace Hopper").gender, 2)
3314. 
3315.     def test_list_editable_popup(self):
3316.         """
3317.         Fields should not be list-editable in popups.
3318.         """
3319.         response = self.client.get(reverse('admin:admin_views_person_changelist'))
3320.         self.assertNotEqual(response.context['cl'].list_editable, ())
3321.         response = self.client.get(reverse('admin:admin_views_person_changelist') + '?%s' % IS_POPUP_VAR)
3322.         self.assertEqual(response.context['cl'].list_editable, ())
3323. 
3324.     def test_pk_hidden_fields(self):
3325.         """
3326.         hidden pk fields aren't displayed in the table body and their
3327.         corresponding human-readable value is displayed instead. The hidden pk
3328.         fields are displayed but separately (not in the table) and only once.
3329.         """
3330.         story1 = Story.objects.create(title='The adventures of Guido', content='Once upon a time in Djangoland...')
3331.         story2 = Story.objects.create(
3332.             title='Crouching Tiger, Hidden Python',
3333.             content='The Python was sneaking into...',
3334.         )
3335.         response = self.client.get(reverse('admin:admin_views_story_changelist'))
3336.         # Only one hidden field, in a separate place than the table.
3337.         self.assertContains(response, 'id="id_form-0-id"', 1)
3338.         self.assertContains(response, 'id="id_form-1-id"', 1)
3339.         self.assertContains(
3340.             response,
3341.             '<div class="hiddenfields">\n'
3342.             '<input type="hidden" name="form-0-id" value="%d" id="id_form-0-id">'
3343.             '<input type="hidden" name="form-1-id" value="%d" id="id_form-1-id">\n</div>'
3344.             % (story2.id, story1.id),
3345.             html=True
3346.         )
3347.         self.assertContains(response, '<td class="field-id">%d</td>' % story1.id, 1)
3348.         self.assertContains(response, '<td class="field-id">%d</td>' % story2.id, 1)
3349. 
3350.     def test_pk_hidden_fields_with_list_display_links(self):
3351.         """ Similarly as test_pk_hidden_fields, but when the hidden pk fields are
3352.             referenced in list_display_links.
3353.             Refs #12475.
3354.         """
3355.         story1 = OtherStory.objects.create(
3356.             title='The adventures of Guido',
3357.             content='Once upon a time in Djangoland...',
3358.         )
3359.         story2 = OtherStory.objects.create(
3360.             title='Crouching Tiger, Hidden Python',
3361.             content='The Python was sneaking into...',
3362.         )
3363.         link1 = reverse('admin:admin_views_otherstory_change', args=(story1.pk,))
3364.         link2 = reverse('admin:admin_views_otherstory_change', args=(story2.pk,))
3365.         response = self.client.get(reverse('admin:admin_views_otherstory_changelist'))
3366.         # Only one hidden field, in a separate place than the table.
3367.         self.assertContains(response, 'id="id_form-0-id"', 1)
3368.         self.assertContains(response, 'id="id_form-1-id"', 1)
3369.         self.assertContains(
3370.             response,
3371.             '<div class="hiddenfields">\n'
3372.             '<input type="hidden" name="form-0-id" value="%d" id="id_form-0-id">'
3373.             '<input type="hidden" name="form-1-id" value="%d" id="id_form-1-id">\n</div>'
3374.             % (story2.id, story1.id),
3375.             html=True
3376.         )
3377.         self.assertContains(response, '<th class="field-id"><a href="%s">%d</a></th>' % (link1, story1.id), 1)
3378.         self.assertContains(response, '<th class="field-id"><a href="%s">%d</a></th>' % (link2, story2.id), 1)
3379. 
3380. 
3381. @override_settings(ROOT_URLCONF='admin_views.urls')
3382. class AdminSearchTest(TestCase):
3383. 
3384.     @classmethod
3385.     def setUpTestData(cls):
3386.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3387.         cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
3388.         cls.s1 = Section.objects.create(name='Test section')
3389.         cls.a1 = Article.objects.create(
3390.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
3391.         )
3392.         cls.a2 = Article.objects.create(
3393.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
3394.         )
3395.         cls.a3 = Article.objects.create(
3396.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
3397.         )
3398.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
3399. 
3400.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
3401.         cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
3402.         cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)
3403. 
3404.         cls.t1 = Recommender.objects.create()
3405.         cls.t2 = Recommendation.objects.create(the_recommender=cls.t1)
3406.         cls.t3 = Recommender.objects.create()
3407.         cls.t4 = Recommendation.objects.create(the_recommender=cls.t3)
3408. 
3409.         cls.tt1 = TitleTranslation.objects.create(title=cls.t1, text='Bar')
3410.         cls.tt2 = TitleTranslation.objects.create(title=cls.t2, text='Foo')
3411.         cls.tt3 = TitleTranslation.objects.create(title=cls.t3, text='Few')
3412.         cls.tt4 = TitleTranslation.objects.create(title=cls.t4, text='Bas')
3413. 
3414.     def setUp(self):
3415.         self.client.force_login(self.superuser)
3416. 
3417.     def test_search_on_sibling_models(self):
3418.         "A search that mentions sibling models"
3419.         response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=bar')
3420.         # confirm the search returned 1 object
3421.         self.assertContains(response, "\n1 recommendation\n")
3422. 
3423.     def test_with_fk_to_field(self):
3424.         """
3425.         The to_field GET parameter is preserved when a search is performed.
3426.         Refs #10918.
3427.         """
3428.         response = self.client.get(reverse('admin:auth_user_changelist') + '?q=joe&%s=id' % TO_FIELD_VAR)
3429.         self.assertContains(response, "\n1 user\n")
3430.         self.assertContains(response, '<input type="hidden" name="%s" value="id">' % TO_FIELD_VAR, html=True)
3431. 
3432.     def test_exact_matches(self):
3433.         response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=bar')
3434.         # confirm the search returned one object
3435.         self.assertContains(response, "\n1 recommendation\n")
3436. 
3437.         response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=ba')
3438.         # confirm the search returned zero objects
3439.         self.assertContains(response, "\n0 recommendations\n")
3440. 
3441.     def test_beginning_matches(self):
3442.         response = self.client.get(reverse('admin:admin_views_person_changelist') + '?q=Gui')
3443.         # confirm the search returned one object
3444.         self.assertContains(response, "\n1 person\n")
3445.         self.assertContains(response, "Guido")
3446. 
3447.         response = self.client.get(reverse('admin:admin_views_person_changelist') + '?q=uido')
3448.         # confirm the search returned zero objects
3449.         self.assertContains(response, "\n0 persons\n")
3450.         self.assertNotContains(response, "Guido")
3451. 
3452.     def test_pluggable_search(self):
3453.         PluggableSearchPerson.objects.create(name="Bob", age=10)
3454.         PluggableSearchPerson.objects.create(name="Amy", age=20)
3455. 
3456.         response = self.client.get(reverse('admin:admin_views_pluggablesearchperson_changelist') + '?q=Bob')
3457.         # confirm the search returned one object
3458.         self.assertContains(response, "\n1 pluggable search person\n")
3459.         self.assertContains(response, "Bob")
3460. 
3461.         response = self.client.get(reverse('admin:admin_views_pluggablesearchperson_changelist') + '?q=20')
3462.         # confirm the search returned one object
3463.         self.assertContains(response, "\n1 pluggable search person\n")
3464.         self.assertContains(response, "Amy")
3465. 
3466.     def test_reset_link(self):
3467.         """
3468.         Test presence of reset link in search bar ("1 result (_x total_)").
3469.         """
3470.         #   1 query for session + 1 for fetching user
3471.         # + 1 for filtered result + 1 for filtered count
3472.         # + 1 for total count
3473.         with self.assertNumQueries(5):
3474.             response = self.client.get(reverse('admin:admin_views_person_changelist') + '?q=Gui')
3475.         self.assertContains(
3476.             response,
3477.             """<span class="small quiet">1 result (<a href="?">3 total</a>)</span>""",
3478.             html=True
3479.         )
3480. 
3481.     def test_no_total_count(self):
3482.         """
3483.         #8408 -- "Show all" should be displayed instead of the total count if
3484.         ModelAdmin.show_full_result_count is False.
3485.         """
3486.         #   1 query for session + 1 for fetching user
3487.         # + 1 for filtered result + 1 for filtered count
3488.         with self.assertNumQueries(4):
3489.             response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=bar')
3490.         self.assertContains(
3491.             response,
3492.             """<span class="small quiet">1 result (<a href="?">Show all</a>)</span>""",
3493.             html=True
3494.         )
3495.         self.assertTrue(response.context['cl'].show_admin_actions)
3496. 
3497. 
3498. @override_settings(ROOT_URLCONF='admin_views.urls')
3499. class AdminInheritedInlinesTest(TestCase):
3500. 
3501.     @classmethod
3502.     def setUpTestData(cls):
3503.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3504. 
3505.     def setUp(self):
3506.         self.client.force_login(self.superuser)
3507. 
3508.     def test_inline(self):
3509.         """
3510.         Inline models which inherit from a common parent are correctly handled.
3511.         """
3512.         foo_user = "foo username"
3513.         bar_user = "bar username"
3514. 
3515.         name_re = re.compile(b'name="(.*?)"')
3516. 
3517.         # test the add case
3518.         response = self.client.get(reverse('admin:admin_views_persona_add'))
3519.         names = name_re.findall(response.content)
3520.         # make sure we have no duplicate HTML names
3521.         self.assertEqual(len(names), len(set(names)))
3522. 
3523.         # test the add case
3524.         post_data = {
3525.             "name": "Test Name",
3526.             # inline data
3527.             "accounts-TOTAL_FORMS": "1",
3528.             "accounts-INITIAL_FORMS": "0",
3529.             "accounts-MAX_NUM_FORMS": "0",
3530.             "accounts-0-username": foo_user,
3531.             "accounts-2-TOTAL_FORMS": "1",
3532.             "accounts-2-INITIAL_FORMS": "0",
3533.             "accounts-2-MAX_NUM_FORMS": "0",
3534.             "accounts-2-0-username": bar_user,
3535.         }
3536. 
3537.         response = self.client.post(reverse('admin:admin_views_persona_add'), post_data)
3538.         self.assertEqual(response.status_code, 302)  # redirect somewhere
3539.         self.assertEqual(Persona.objects.count(), 1)
3540.         self.assertEqual(FooAccount.objects.count(), 1)
3541.         self.assertEqual(BarAccount.objects.count(), 1)
3542.         self.assertEqual(FooAccount.objects.all()[0].username, foo_user)
3543.         self.assertEqual(BarAccount.objects.all()[0].username, bar_user)
3544.         self.assertEqual(Persona.objects.all()[0].accounts.count(), 2)
3545. 
3546.         persona_id = Persona.objects.all()[0].id
3547.         foo_id = FooAccount.objects.all()[0].id
3548.         bar_id = BarAccount.objects.all()[0].id
3549. 
3550.         # test the edit case
3551. 
3552.         response = self.client.get(reverse('admin:admin_views_persona_change', args=(persona_id,)))
3553.         names = name_re.findall(response.content)
3554.         # make sure we have no duplicate HTML names
3555.         self.assertEqual(len(names), len(set(names)))
3556. 
3557.         post_data = {
3558.             "name": "Test Name",
3559. 
3560.             "accounts-TOTAL_FORMS": "2",
3561.             "accounts-INITIAL_FORMS": "1",
3562.             "accounts-MAX_NUM_FORMS": "0",
3563. 
3564.             "accounts-0-username": "%s-1" % foo_user,
3565.             "accounts-0-account_ptr": str(foo_id),
3566.             "accounts-0-persona": str(persona_id),
3567. 
3568.             "accounts-2-TOTAL_FORMS": "2",
3569.             "accounts-2-INITIAL_FORMS": "1",
3570.             "accounts-2-MAX_NUM_FORMS": "0",
3571. 
3572.             "accounts-2-0-username": "%s-1" % bar_user,
3573.             "accounts-2-0-account_ptr": str(bar_id),
3574.             "accounts-2-0-persona": str(persona_id),
3575.         }
3576.         response = self.client.post(reverse('admin:admin_views_persona_change', args=(persona_id,)), post_data)
3577.         self.assertEqual(response.status_code, 302)
3578.         self.assertEqual(Persona.objects.count(), 1)
3579.         self.assertEqual(FooAccount.objects.count(), 1)
3580.         self.assertEqual(BarAccount.objects.count(), 1)
3581.         self.assertEqual(FooAccount.objects.all()[0].username, "%s-1" % foo_user)
3582.         self.assertEqual(BarAccount.objects.all()[0].username, "%s-1" % bar_user)
3583.         self.assertEqual(Persona.objects.all()[0].accounts.count(), 2)
3584. 
3585. 
3586. @override_settings(ROOT_URLCONF='admin_views.urls')
3587. class TestCustomChangeList(TestCase):
3588. 
3589.     @classmethod
3590.     def setUpTestData(cls):
3591.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3592. 
3593.     def setUp(self):
3594.         self.client.force_login(self.superuser)
3595. 
3596.     def test_custom_changelist(self):
3597.         """
3598.         Validate that a custom ChangeList class can be used (#9749)
3599.         """
3600.         # Insert some data
3601.         post_data = {"name": "First Gadget"}
3602.         response = self.client.post(reverse('admin:admin_views_gadget_add'), post_data)
3603.         self.assertEqual(response.status_code, 302)  # redirect somewhere
3604.         # Hit the page once to get messages out of the queue message list
3605.         response = self.client.get(reverse('admin:admin_views_gadget_changelist'))
3606.         # Data is still not visible on the page
3607.         response = self.client.get(reverse('admin:admin_views_gadget_changelist'))
3608.         self.assertEqual(response.status_code, 200)
3609.         self.assertNotContains(response, 'First Gadget')
3610. 
3611. 
3612. @override_settings(ROOT_URLCONF='admin_views.urls')
3613. class TestInlineNotEditable(TestCase):
3614. 
3615.     @classmethod
3616.     def setUpTestData(cls):
3617.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3618. 
3619.     def setUp(self):
3620.         self.client.force_login(self.superuser)
3621. 
3622.     def test_GET_parent_add(self):
3623.         """
3624.         InlineModelAdmin broken?
3625.         """
3626.         response = self.client.get(reverse('admin:admin_views_parent_add'))
3627.         self.assertEqual(response.status_code, 200)
3628. 
3629. 
3630. @override_settings(ROOT_URLCONF='admin_views.urls')
3631. class AdminCustomQuerysetTest(TestCase):
3632. 
3633.     @classmethod
3634.     def setUpTestData(cls):
3635.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3636.         cls.pks = [EmptyModel.objects.create().id for i in range(3)]
3637. 
3638.     def setUp(self):
3639.         self.client.force_login(self.superuser)
3640.         self.super_login = {
3641.             REDIRECT_FIELD_NAME: reverse('admin:index'),
3642.             'username': 'super',
3643.             'password': 'secret',
3644.         }
3645. 
3646.     def test_changelist_view(self):
3647.         response = self.client.get(reverse('admin:admin_views_emptymodel_changelist'))
3648.         for i in self.pks:
3649.             if i > 1:
3650.                 self.assertContains(response, 'Primary key = %s' % i)
3651.             else:
3652.                 self.assertNotContains(response, 'Primary key = %s' % i)
3653. 
3654.     def test_changelist_view_count_queries(self):
3655.         # create 2 Person objects
3656.         Person.objects.create(name='person1', gender=1)
3657.         Person.objects.create(name='person2', gender=2)
3658.         changelist_url = reverse('admin:admin_views_person_changelist')
3659. 
3660.         # 5 queries are expected: 1 for the session, 1 for the user,
3661.         # 2 for the counts and 1 for the objects on the page
3662.         with self.assertNumQueries(5):
3663.             resp = self.client.get(changelist_url)
3664.             self.assertEqual(resp.context['selection_note'], '0 of 2 selected')
3665.             self.assertEqual(resp.context['selection_note_all'], 'All 2 selected')
3666.         with self.assertNumQueries(5):
3667.             extra = {'q': 'not_in_name'}
3668.             resp = self.client.get(changelist_url, extra)
3669.             self.assertEqual(resp.context['selection_note'], '0 of 0 selected')
3670.             self.assertEqual(resp.context['selection_note_all'], 'All 0 selected')
3671.         with self.assertNumQueries(5):
3672.             extra = {'q': 'person'}
3673.             resp = self.client.get(changelist_url, extra)
3674.             self.assertEqual(resp.context['selection_note'], '0 of 2 selected')
3675.             self.assertEqual(resp.context['selection_note_all'], 'All 2 selected')
3676.         with self.assertNumQueries(5):
3677.             extra = {'gender__exact': '1'}
3678.             resp = self.client.get(changelist_url, extra)
3679.             self.assertEqual(resp.context['selection_note'], '0 of 1 selected')
3680.             self.assertEqual(resp.context['selection_note_all'], '1 selected')
3681. 
3682.     def test_change_view(self):
3683.         for i in self.pks:
3684.             url = reverse('admin:admin_views_emptymodel_change', args=(i,))
3685.             response = self.client.get(url, follow=True)
3686.             if i > 1:
3687.                 self.assertEqual(response.status_code, 200)
3688.             else:
3689.                 self.assertRedirects(response, reverse('admin:index'))
3690.                 self.assertEqual(
3691.                     [m.message for m in response.context['messages']],
3692.                     ["""empty model with ID "1" doesn't exist. Perhaps it was deleted?"""]
3693.                 )
3694. 
3695.     def test_add_model_modeladmin_defer_qs(self):
3696.         # Test for #14529. defer() is used in ModelAdmin.get_queryset()
3697. 
3698.         # model has __str__ method
3699.         self.assertEqual(CoverLetter.objects.count(), 0)
3700.         # Emulate model instance creation via the admin
3701.         post_data = {
3702.             "author": "Candidate, Best",
3703.             "_save": "Save",
3704.         }
3705.         response = self.client.post(reverse('admin:admin_views_coverletter_add'), post_data, follow=True)
3706.         self.assertEqual(response.status_code, 200)
3707.         self.assertEqual(CoverLetter.objects.count(), 1)
3708.         # Message should contain non-ugly model verbose name
3709.         pk = CoverLetter.objects.all()[0].pk
3710.         self.assertContains(
3711.             response,
3712.             '<li class="success">The cover letter "<a href="%s">'
3713.             'Candidate, Best</a>" was added successfully.</li>' %
3714.             reverse('admin:admin_views_coverletter_change', args=(pk,)), html=True
3715.         )
3716. 
3717.         # model has no __str__ method
3718.         self.assertEqual(ShortMessage.objects.count(), 0)
3719.         # Emulate model instance creation via the admin
3720.         post_data = {
3721.             "content": "What's this SMS thing?",
3722.             "_save": "Save",
3723.         }
3724.         response = self.client.post(reverse('admin:admin_views_shortmessage_add'), post_data, follow=True)
3725.         self.assertEqual(response.status_code, 200)
3726.         self.assertEqual(ShortMessage.objects.count(), 1)
3727.         # Message should contain non-ugly model verbose name
3728.         sm = ShortMessage.objects.all()[0]
3729.         self.assertContains(
3730.             response,
3731.             '<li class="success">The short message "<a href="%s">'
3732.             '%s</a>" was added successfully.</li>' %
3733.             (reverse('admin:admin_views_shortmessage_change', args=(sm.pk,)), sm), html=True
3734.         )
3735. 
3736.     def test_add_model_modeladmin_only_qs(self):
3737.         # Test for #14529. only() is used in ModelAdmin.get_queryset()
3738. 
3739.         # model has __str__ method
3740.         self.assertEqual(Telegram.objects.count(), 0)
3741.         # Emulate model instance creation via the admin
3742.         post_data = {
3743.             "title": "Urgent telegram",
3744.             "_save": "Save",
3745.         }
3746.         response = self.client.post(reverse('admin:admin_views_telegram_add'), post_data, follow=True)
3747.         self.assertEqual(response.status_code, 200)
3748.         self.assertEqual(Telegram.objects.count(), 1)
3749.         # Message should contain non-ugly model verbose name
3750.         pk = Telegram.objects.all()[0].pk
3751.         self.assertContains(
3752.             response,
3753.             '<li class="success">The telegram "<a href="%s">'
3754.             'Urgent telegram</a>" was added successfully.</li>' %
3755.             reverse('admin:admin_views_telegram_change', args=(pk,)), html=True
3756.         )
3757. 
3758.         # model has no __str__ method
3759.         self.assertEqual(Paper.objects.count(), 0)
3760.         # Emulate model instance creation via the admin
3761.         post_data = {
3762.             "title": "My Modified Paper Title",
3763.             "_save": "Save",
3764.         }
3765.         response = self.client.post(reverse('admin:admin_views_paper_add'), post_data, follow=True)
3766.         self.assertEqual(response.status_code, 200)
3767.         self.assertEqual(Paper.objects.count(), 1)
3768.         # Message should contain non-ugly model verbose name
3769.         p = Paper.objects.all()[0]
3770.         self.assertContains(
3771.             response,
3772.             '<li class="success">The paper "<a href="%s">'
3773.             '%s</a>" was added successfully.</li>' %
3774.             (reverse('admin:admin_views_paper_change', args=(p.pk,)), p), html=True
3775.         )
3776. 
3777.     def test_edit_model_modeladmin_defer_qs(self):
3778.         # Test for #14529. defer() is used in ModelAdmin.get_queryset()
3779. 
3780.         # model has __str__ method
3781.         cl = CoverLetter.objects.create(author="John Doe")
3782.         self.assertEqual(CoverLetter.objects.count(), 1)
3783.         response = self.client.get(reverse('admin:admin_views_coverletter_change', args=(cl.pk,)))
3784.         self.assertEqual(response.status_code, 200)
3785.         # Emulate model instance edit via the admin
3786.         post_data = {
3787.             "author": "John Doe II",
3788.             "_save": "Save",
3789.         }
3790.         url = reverse('admin:admin_views_coverletter_change', args=(cl.pk,))
3791.         response = self.client.post(url, post_data, follow=True)
3792.         self.assertEqual(response.status_code, 200)
3793.         self.assertEqual(CoverLetter.objects.count(), 1)
3794.         # Message should contain non-ugly model verbose name. Instance
3795.         # representation is set by model's __str__()
3796.         self.assertContains(
3797.             response,
3798.             '<li class="success">The cover letter "<a href="%s">'
3799.             'John Doe II</a>" was changed successfully.</li>' %
3800.             reverse('admin:admin_views_coverletter_change', args=(cl.pk,)), html=True
3801.         )
3802. 
3803.         # model has no __str__ method
3804.         sm = ShortMessage.objects.create(content="This is expensive")
3805.         self.assertEqual(ShortMessage.objects.count(), 1)
3806.         response = self.client.get(reverse('admin:admin_views_shortmessage_change', args=(sm.pk,)))
3807.         self.assertEqual(response.status_code, 200)
3808.         # Emulate model instance edit via the admin
3809.         post_data = {
3810.             "content": "Too expensive",
3811.             "_save": "Save",
3812.         }
3813.         url = reverse('admin:admin_views_shortmessage_change', args=(sm.pk,))
3814.         response = self.client.post(url, post_data, follow=True)
3815.         self.assertEqual(response.status_code, 200)
3816.         self.assertEqual(ShortMessage.objects.count(), 1)
3817.         # Message should contain non-ugly model verbose name. The ugly(!)
3818.         # instance representation is set by __str__().
3819.         self.assertContains(
3820.             response,
3821.             '<li class="success">The short message "<a href="%s">'
3822.             '%s</a>" was changed successfully.</li>' %
3823.             (reverse('admin:admin_views_shortmessage_change', args=(sm.pk,)), sm), html=True
3824.         )
3825. 
3826.     def test_edit_model_modeladmin_only_qs(self):
3827.         # Test for #14529. only() is used in ModelAdmin.get_queryset()
3828. 
3829.         # model has __str__ method
3830.         t = Telegram.objects.create(title="First Telegram")
3831.         self.assertEqual(Telegram.objects.count(), 1)
3832.         response = self.client.get(reverse('admin:admin_views_telegram_change', args=(t.pk,)))
3833.         self.assertEqual(response.status_code, 200)
3834.         # Emulate model instance edit via the admin
3835.         post_data = {
3836.             "title": "Telegram without typo",
3837.             "_save": "Save",
3838.         }
3839.         response = self.client.post(reverse('admin:admin_views_telegram_change', args=(t.pk,)), post_data, follow=True)
3840.         self.assertEqual(response.status_code, 200)
3841.         self.assertEqual(Telegram.objects.count(), 1)
3842.         # Message should contain non-ugly model verbose name. The instance
3843.         # representation is set by model's __str__()
3844.         self.assertContains(
3845.             response,
3846.             '<li class="success">The telegram "<a href="%s">'
3847.             'Telegram without typo</a>" was changed successfully.</li>' %
3848.             reverse('admin:admin_views_telegram_change', args=(t.pk,)), html=True
3849.         )
3850. 
3851.         # model has no __str__ method
3852.         p = Paper.objects.create(title="My Paper Title")
3853.         self.assertEqual(Paper.objects.count(), 1)
3854.         response = self.client.get(reverse('admin:admin_views_paper_change', args=(p.pk,)))
3855.         self.assertEqual(response.status_code, 200)
3856.         # Emulate model instance edit via the admin
3857.         post_data = {
3858.             "title": "My Modified Paper Title",
3859.             "_save": "Save",
3860.         }
3861.         response = self.client.post(reverse('admin:admin_views_paper_change', args=(p.pk,)), post_data, follow=True)
3862.         self.assertEqual(response.status_code, 200)
3863.         self.assertEqual(Paper.objects.count(), 1)
3864.         # Message should contain non-ugly model verbose name. The ugly(!)
3865.         # instance representation is set by __str__().
3866.         self.assertContains(
3867.             response,
3868.             '<li class="success">The paper "<a href="%s">'
3869.             '%s</a>" was changed successfully.</li>' %
3870.             (reverse('admin:admin_views_paper_change', args=(p.pk,)), p), html=True
3871.         )
3872. 
3873.     def test_history_view_custom_qs(self):
3874.         """
3875.         Custom querysets are considered for the admin history view.
3876.         """
3877.         self.client.post(reverse('admin:login'), self.super_login)
3878.         FilteredManager.objects.create(pk=1)
3879.         FilteredManager.objects.create(pk=2)
3880.         response = self.client.get(reverse('admin:admin_views_filteredmanager_changelist'))
3881.         self.assertContains(response, "PK=1")
3882.         self.assertContains(response, "PK=2")
3883.         self.assertEqual(
3884.             self.client.get(reverse('admin:admin_views_filteredmanager_history', args=(1,))).status_code, 200
3885.         )
3886.         self.assertEqual(
3887.             self.client.get(reverse('admin:admin_views_filteredmanager_history', args=(2,))).status_code, 200
3888.         )
3889. 
3890. 
3891. @override_settings(ROOT_URLCONF='admin_views.urls')
3892. class AdminInlineFileUploadTest(TestCase):
3893. 
3894.     @classmethod
3895.     def setUpTestData(cls):
3896.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3897.         file1 = tempfile.NamedTemporaryFile(suffix=".file1")
3898.         file1.write(b'a' * (2 ** 21))
3899.         filename = file1.name
3900.         file1.close()
3901.         cls.gallery = Gallery.objects.create(name='Test Gallery')
3902.         cls.picture = Picture.objects.create(
3903.             name='Test Picture',
3904.             image=filename,
3905.             gallery=cls.gallery,
3906.         )
3907. 
3908.     def setUp(self):
3909.         self.client.force_login(self.superuser)
3910. 
3911.     def test_form_has_multipart_enctype(self):
3912.         response = self.client.get(
3913.             reverse('admin:admin_views_gallery_change', args=(self.gallery.id,))
3914.         )
3915.         self.assertIs(response.context['has_file_field'], True)
3916.         self.assertContains(response, MULTIPART_ENCTYPE)
3917. 
3918.     def test_inline_file_upload_edit_validation_error_post(self):
3919.         """
3920.         Inline file uploads correctly display prior data (#10002).
3921.         """
3922.         post_data = {
3923.             "name": "Test Gallery",
3924.             "pictures-TOTAL_FORMS": "2",
3925.             "pictures-INITIAL_FORMS": "1",
3926.             "pictures-MAX_NUM_FORMS": "0",
3927.             "pictures-0-id": str(self.picture.id),
3928.             "pictures-0-gallery": str(self.gallery.id),
3929.             "pictures-0-name": "Test Picture",
3930.             "pictures-0-image": "",
3931.             "pictures-1-id": "",
3932.             "pictures-1-gallery": str(self.gallery.id),
3933.             "pictures-1-name": "Test Picture 2",
3934.             "pictures-1-image": "",
3935.         }
3936.         response = self.client.post(
3937.             reverse('admin:admin_views_gallery_change', args=(self.gallery.id,)), post_data
3938.         )
3939.         self.assertContains(response, b"Currently")
3940. 
3941. 
3942. @override_settings(ROOT_URLCONF='admin_views.urls')
3943. class AdminInlineTests(TestCase):
3944. 
3945.     @classmethod
3946.     def setUpTestData(cls):
3947.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3948.         cls.collector = Collector.objects.create(pk=1, name='John Fowles')
3949. 
3950.     def setUp(self):
3951.         self.post_data = {
3952.             "name": "Test Name",
3953. 
3954.             "widget_set-TOTAL_FORMS": "3",
3955.             "widget_set-INITIAL_FORMS": "0",
3956.             "widget_set-MAX_NUM_FORMS": "0",
3957.             "widget_set-0-id": "",
3958.             "widget_set-0-owner": "1",
3959.             "widget_set-0-name": "",
3960.             "widget_set-1-id": "",
3961.             "widget_set-1-owner": "1",
3962.             "widget_set-1-name": "",
3963.             "widget_set-2-id": "",
3964.             "widget_set-2-owner": "1",
3965.             "widget_set-2-name": "",
3966. 
3967.             "doohickey_set-TOTAL_FORMS": "3",
3968.             "doohickey_set-INITIAL_FORMS": "0",
3969.             "doohickey_set-MAX_NUM_FORMS": "0",
3970.             "doohickey_set-0-owner": "1",
3971.             "doohickey_set-0-code": "",
3972.             "doohickey_set-0-name": "",
3973.             "doohickey_set-1-owner": "1",
3974.             "doohickey_set-1-code": "",
3975.             "doohickey_set-1-name": "",
3976.             "doohickey_set-2-owner": "1",
3977.             "doohickey_set-2-code": "",
3978.             "doohickey_set-2-name": "",
3979. 
3980.             "grommet_set-TOTAL_FORMS": "3",
3981.             "grommet_set-INITIAL_FORMS": "0",
3982.             "grommet_set-MAX_NUM_FORMS": "0",
3983.             "grommet_set-0-code": "",
3984.             "grommet_set-0-owner": "1",
3985.             "grommet_set-0-name": "",
3986.             "grommet_set-1-code": "",
3987.             "grommet_set-1-owner": "1",
3988.             "grommet_set-1-name": "",
3989.             "grommet_set-2-code": "",
3990.             "grommet_set-2-owner": "1",
3991.             "grommet_set-2-name": "",
3992. 
3993.             "whatsit_set-TOTAL_FORMS": "3",
3994.             "whatsit_set-INITIAL_FORMS": "0",
3995.             "whatsit_set-MAX_NUM_FORMS": "0",
3996.             "whatsit_set-0-owner": "1",
3997.             "whatsit_set-0-index": "",
3998.             "whatsit_set-0-name": "",
3999.             "whatsit_set-1-owner": "1",
4000.             "whatsit_set-1-index": "",
4001.             "whatsit_set-1-name": "",
4002.             "whatsit_set-2-owner": "1",
4003.             "whatsit_set-2-index": "",
4004.             "whatsit_set-2-name": "",
4005. 
4006.             "fancydoodad_set-TOTAL_FORMS": "3",
4007.             "fancydoodad_set-INITIAL_FORMS": "0",
4008.             "fancydoodad_set-MAX_NUM_FORMS": "0",
4009.             "fancydoodad_set-0-doodad_ptr": "",
4010.             "fancydoodad_set-0-owner": "1",
4011.             "fancydoodad_set-0-name": "",
4012.             "fancydoodad_set-0-expensive": "on",
4013.             "fancydoodad_set-1-doodad_ptr": "",
4014.             "fancydoodad_set-1-owner": "1",
4015.             "fancydoodad_set-1-name": "",
4016.             "fancydoodad_set-1-expensive": "on",
4017.             "fancydoodad_set-2-doodad_ptr": "",
4018.             "fancydoodad_set-2-owner": "1",
4019.             "fancydoodad_set-2-name": "",
4020.             "fancydoodad_set-2-expensive": "on",
4021. 
4022.             "category_set-TOTAL_FORMS": "3",
4023.             "category_set-INITIAL_FORMS": "0",
4024.             "category_set-MAX_NUM_FORMS": "0",
4025.             "category_set-0-order": "",
4026.             "category_set-0-id": "",
4027.             "category_set-0-collector": "1",
4028.             "category_set-1-order": "",
4029.             "category_set-1-id": "",
4030.             "category_set-1-collector": "1",
4031.             "category_set-2-order": "",
4032.             "category_set-2-id": "",
4033.             "category_set-2-collector": "1",
4034.         }
4035. 
4036.         self.client.force_login(self.superuser)
4037. 
4038.     def test_simple_inline(self):
4039.         "A simple model can be saved as inlines"
4040.         # First add a new inline
4041.         self.post_data['widget_set-0-name'] = "Widget 1"
4042.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4043.         response = self.client.post(collector_url, self.post_data)
4044.         self.assertEqual(response.status_code, 302)
4045.         self.assertEqual(Widget.objects.count(), 1)
4046.         self.assertEqual(Widget.objects.all()[0].name, "Widget 1")
4047.         widget_id = Widget.objects.all()[0].id
4048. 
4049.         # The PK link exists on the rendered form
4050.         response = self.client.get(collector_url)
4051.         self.assertContains(response, 'name="widget_set-0-id"')
4052. 
4053.         # No file or image fields, no enctype on the forms
4054.         self.assertIs(response.context['has_file_field'], False)
4055.         self.assertNotContains(response, MULTIPART_ENCTYPE)
4056. 
4057.         # Now resave that inline
4058.         self.post_data['widget_set-INITIAL_FORMS'] = "1"
4059.         self.post_data['widget_set-0-id'] = str(widget_id)
4060.         self.post_data['widget_set-0-name'] = "Widget 1"
4061.         response = self.client.post(collector_url, self.post_data)
4062.         self.assertEqual(response.status_code, 302)
4063.         self.assertEqual(Widget.objects.count(), 1)
4064.         self.assertEqual(Widget.objects.all()[0].name, "Widget 1")
4065. 
4066.         # Now modify that inline
4067.         self.post_data['widget_set-INITIAL_FORMS'] = "1"
4068.         self.post_data['widget_set-0-id'] = str(widget_id)
4069.         self.post_data['widget_set-0-name'] = "Widget 1 Updated"
4070.         response = self.client.post(collector_url, self.post_data)
4071.         self.assertEqual(response.status_code, 302)
4072.         self.assertEqual(Widget.objects.count(), 1)
4073.         self.assertEqual(Widget.objects.all()[0].name, "Widget 1 Updated")
4074. 
4075.     def test_simple_inline_permissions(self):
4076.         """
4077.         Changes aren't allowed without change permissions for the inline object.
4078.         """
4079.         # User who can view Articles
4080.         permissionuser = User.objects.create_user(
4081.             username='permissionuser', password='secret',
4082.             email='vuser@example.com', is_staff=True,
4083.         )
4084.         permissionuser.user_permissions.add(get_perm(Collector, get_permission_codename('view', Collector._meta)))
4085.         permissionuser.user_permissions.add(get_perm(Widget, get_permission_codename('view', Widget._meta)))
4086.         self.client.force_login(permissionuser)
4087.         # Without add permission, a new inline can't be added.
4088.         self.post_data['widget_set-0-name'] = 'Widget 1'
4089.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4090.         response = self.client.post(collector_url, self.post_data)
4091.         self.assertEqual(response.status_code, 302)
4092.         self.assertEqual(Widget.objects.count(), 0)
4093.         # But after adding the permisson it can.
4094.         permissionuser.user_permissions.add(get_perm(Widget, get_permission_codename('add', Widget._meta)))
4095.         self.post_data['widget_set-0-name'] = "Widget 1"
4096.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4097.         response = self.client.post(collector_url, self.post_data)
4098.         self.assertEqual(response.status_code, 302)
4099.         self.assertEqual(Widget.objects.count(), 1)
4100.         self.assertEqual(Widget.objects.first().name, 'Widget 1')
4101.         widget_id = Widget.objects.first().id
4102.         # Without the change permission, a POST doesn't change the object.
4103.         self.post_data['widget_set-INITIAL_FORMS'] = '1'
4104.         self.post_data['widget_set-0-id'] = str(widget_id)
4105.         self.post_data['widget_set-0-name'] = 'Widget 1 Updated'
4106.         response = self.client.post(collector_url, self.post_data)
4107.         self.assertEqual(response.status_code, 302)
4108.         self.assertEqual(Widget.objects.count(), 1)
4109.         self.assertEqual(Widget.objects.first().name, 'Widget 1')
4110.         # Now adding the change permission and editing works.
4111.         permissionuser.user_permissions.remove(get_perm(Widget, get_permission_codename('add', Widget._meta)))
4112.         permissionuser.user_permissions.add(get_perm(Widget, get_permission_codename('change', Widget._meta)))
4113.         self.post_data['widget_set-INITIAL_FORMS'] = '1'
4114.         self.post_data['widget_set-0-id'] = str(widget_id)
4115.         self.post_data['widget_set-0-name'] = 'Widget 1 Updated'
4116.         response = self.client.post(collector_url, self.post_data)
4117.         self.assertEqual(response.status_code, 302)
4118.         self.assertEqual(Widget.objects.count(), 1)
4119.         self.assertEqual(Widget.objects.first().name, 'Widget 1 Updated')
4120. 
4121.     def test_explicit_autofield_inline(self):
4122.         "A model with an explicit autofield primary key can be saved as inlines. Regression for #8093"
4123.         # First add a new inline
4124.         self.post_data['grommet_set-0-name'] = "Grommet 1"
4125.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4126.         response = self.client.post(collector_url, self.post_data)
4127.         self.assertEqual(response.status_code, 302)
4128.         self.assertEqual(Grommet.objects.count(), 1)
4129.         self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1")
4130. 
4131.         # The PK link exists on the rendered form
4132.         response = self.client.get(collector_url)
4133.         self.assertContains(response, 'name="grommet_set-0-code"')
4134. 
4135.         # Now resave that inline
4136.         self.post_data['grommet_set-INITIAL_FORMS'] = "1"
4137.         self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)
4138.         self.post_data['grommet_set-0-name'] = "Grommet 1"
4139.         response = self.client.post(collector_url, self.post_data)
4140.         self.assertEqual(response.status_code, 302)
4141.         self.assertEqual(Grommet.objects.count(), 1)
4142.         self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1")
4143. 
4144.         # Now modify that inline
4145.         self.post_data['grommet_set-INITIAL_FORMS'] = "1"
4146.         self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)
4147.         self.post_data['grommet_set-0-name'] = "Grommet 1 Updated"
4148.         response = self.client.post(collector_url, self.post_data)
4149.         self.assertEqual(response.status_code, 302)
4150.         self.assertEqual(Grommet.objects.count(), 1)
4151.         self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1 Updated")
4152. 
4153.     def test_char_pk_inline(self):
4154.         "A model with a character PK can be saved as inlines. Regression for #10992"
4155.         # First add a new inline
4156.         self.post_data['doohickey_set-0-code'] = "DH1"
4157.         self.post_data['doohickey_set-0-name'] = "Doohickey 1"
4158.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4159.         response = self.client.post(collector_url, self.post_data)
4160.         self.assertEqual(response.status_code, 302)
4161.         self.assertEqual(DooHickey.objects.count(), 1)
4162.         self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1")
4163. 
4164.         # The PK link exists on the rendered form
4165.         response = self.client.get(collector_url)
4166.         self.assertContains(response, 'name="doohickey_set-0-code"')
4167. 
4168.         # Now resave that inline
4169.         self.post_data['doohickey_set-INITIAL_FORMS'] = "1"
4170.         self.post_data['doohickey_set-0-code'] = "DH1"
4171.         self.post_data['doohickey_set-0-name'] = "Doohickey 1"
4172.         response = self.client.post(collector_url, self.post_data)
4173.         self.assertEqual(response.status_code, 302)
4174.         self.assertEqual(DooHickey.objects.count(), 1)
4175.         self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1")
4176. 
4177.         # Now modify that inline
4178.         self.post_data['doohickey_set-INITIAL_FORMS'] = "1"
4179.         self.post_data['doohickey_set-0-code'] = "DH1"
4180.         self.post_data['doohickey_set-0-name'] = "Doohickey 1 Updated"
4181.         response = self.client.post(collector_url, self.post_data)
4182.         self.assertEqual(response.status_code, 302)
4183.         self.assertEqual(DooHickey.objects.count(), 1)
4184.         self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1 Updated")
4185. 
4186.     def test_integer_pk_inline(self):
4187.         "A model with an integer PK can be saved as inlines. Regression for #10992"
4188.         # First add a new inline
4189.         self.post_data['whatsit_set-0-index'] = "42"
4190.         self.post_data['whatsit_set-0-name'] = "Whatsit 1"
4191.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4192.         response = self.client.post(collector_url, self.post_data)
4193.         self.assertEqual(response.status_code, 302)
4194.         self.assertEqual(Whatsit.objects.count(), 1)
4195.         self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1")
4196. 
4197.         # The PK link exists on the rendered form
4198.         response = self.client.get(collector_url)
4199.         self.assertContains(response, 'name="whatsit_set-0-index"')
4200. 
4201.         # Now resave that inline
4202.         self.post_data['whatsit_set-INITIAL_FORMS'] = "1"
4203.         self.post_data['whatsit_set-0-index'] = "42"
4204.         self.post_data['whatsit_set-0-name'] = "Whatsit 1"
4205.         response = self.client.post(collector_url, self.post_data)
4206.         self.assertEqual(response.status_code, 302)
4207.         self.assertEqual(Whatsit.objects.count(), 1)
4208.         self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1")
4209. 
4210.         # Now modify that inline
4211.         self.post_data['whatsit_set-INITIAL_FORMS'] = "1"
4212.         self.post_data['whatsit_set-0-index'] = "42"
4213.         self.post_data['whatsit_set-0-name'] = "Whatsit 1 Updated"
4214.         response = self.client.post(collector_url, self.post_data)
4215.         self.assertEqual(response.status_code, 302)
4216.         self.assertEqual(Whatsit.objects.count(), 1)
4217.         self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1 Updated")
4218. 
4219.     def test_inherited_inline(self):
4220.         "An inherited model can be saved as inlines. Regression for #11042"
4221.         # First add a new inline
4222.         self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1"
4223.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4224.         response = self.client.post(collector_url, self.post_data)
4225.         self.assertEqual(response.status_code, 302)
4226.         self.assertEqual(FancyDoodad.objects.count(), 1)
4227.         self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1")
4228.         doodad_pk = FancyDoodad.objects.all()[0].pk
4229. 
4230.         # The PK link exists on the rendered form
4231.         response = self.client.get(collector_url)
4232.         self.assertContains(response, 'name="fancydoodad_set-0-doodad_ptr"')
4233. 
4234.         # Now resave that inline
4235.         self.post_data['fancydoodad_set-INITIAL_FORMS'] = "1"
4236.         self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)
4237.         self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1"
4238.         response = self.client.post(collector_url, self.post_data)
4239.         self.assertEqual(response.status_code, 302)
4240.         self.assertEqual(FancyDoodad.objects.count(), 1)
4241.         self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1")
4242. 
4243.         # Now modify that inline
4244.         self.post_data['fancydoodad_set-INITIAL_FORMS'] = "1"
4245.         self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)
4246.         self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1 Updated"
4247.         response = self.client.post(collector_url, self.post_data)
4248.         self.assertEqual(response.status_code, 302)
4249.         self.assertEqual(FancyDoodad.objects.count(), 1)
4250.         self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1 Updated")
4251. 
4252.     def test_ordered_inline(self):
4253.         """
4254.         An inline with an editable ordering fields is updated correctly.
4255.         """
4256.         # Create some objects with an initial ordering
4257.         Category.objects.create(id=1, order=1, collector=self.collector)
4258.         Category.objects.create(id=2, order=2, collector=self.collector)
4259.         Category.objects.create(id=3, order=0, collector=self.collector)
4260.         Category.objects.create(id=4, order=0, collector=self.collector)
4261. 
4262.         # NB: The order values must be changed so that the items are reordered.
4263.         self.post_data.update({
4264.             "name": "Frederick Clegg",
4265. 
4266.             "category_set-TOTAL_FORMS": "7",
4267.             "category_set-INITIAL_FORMS": "4",
4268.             "category_set-MAX_NUM_FORMS": "0",
4269. 
4270.             "category_set-0-order": "14",
4271.             "category_set-0-id": "1",
4272.             "category_set-0-collector": "1",
4273. 
4274.             "category_set-1-order": "13",
4275.             "category_set-1-id": "2",
4276.             "category_set-1-collector": "1",
4277. 
4278.             "category_set-2-order": "1",
4279.             "category_set-2-id": "3",
4280.             "category_set-2-collector": "1",
4281. 
4282.             "category_set-3-order": "0",
4283.             "category_set-3-id": "4",
4284.             "category_set-3-collector": "1",
4285. 
4286.             "category_set-4-order": "",
4287.             "category_set-4-id": "",
4288.             "category_set-4-collector": "1",
4289. 
4290.             "category_set-5-order": "",
4291.             "category_set-5-id": "",
4292.             "category_set-5-collector": "1",
4293. 
4294.             "category_set-6-order": "",
4295.             "category_set-6-id": "",
4296.             "category_set-6-collector": "1",
4297.         })
4298.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4299.         response = self.client.post(collector_url, self.post_data)
4300.         # Successful post will redirect
4301.         self.assertEqual(response.status_code, 302)
4302. 
4303.         # The order values have been applied to the right objects
4304.         self.assertEqual(self.collector.category_set.count(), 4)
4305.         self.assertEqual(Category.objects.get(id=1).order, 14)
4306.         self.assertEqual(Category.objects.get(id=2).order, 13)
4307.         self.assertEqual(Category.objects.get(id=3).order, 1)
4308.         self.assertEqual(Category.objects.get(id=4).order, 0)
4309. 
4310. 
4311. @override_settings(ROOT_URLCONF='admin_views.urls')
4312. class NeverCacheTests(TestCase):
4313. 
4314.     @classmethod
4315.     def setUpTestData(cls):
4316.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4317.         cls.s1 = Section.objects.create(name='Test section')
4318. 
4319.     def setUp(self):
4320.         self.client.force_login(self.superuser)
4321. 
4322.     def test_admin_index(self):
4323.         "Check the never-cache status of the main index"
4324.         response = self.client.get(reverse('admin:index'))
4325.         self.assertEqual(get_max_age(response), 0)
4326. 
4327.     def test_app_index(self):
4328.         "Check the never-cache status of an application index"
4329.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
4330.         self.assertEqual(get_max_age(response), 0)
4331. 
4332.     def test_model_index(self):
4333.         "Check the never-cache status of a model index"
4334.         response = self.client.get(reverse('admin:admin_views_fabric_changelist'))
4335.         self.assertEqual(get_max_age(response), 0)
4336. 
4337.     def test_model_add(self):
4338.         "Check the never-cache status of a model add page"
4339.         response = self.client.get(reverse('admin:admin_views_fabric_add'))
4340.         self.assertEqual(get_max_age(response), 0)
4341. 
4342.     def test_model_view(self):
4343.         "Check the never-cache status of a model edit page"
4344.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
4345.         self.assertEqual(get_max_age(response), 0)
4346. 
4347.     def test_model_history(self):
4348.         "Check the never-cache status of a model history page"
4349.         response = self.client.get(reverse('admin:admin_views_section_history', args=(self.s1.pk,)))
4350.         self.assertEqual(get_max_age(response), 0)
4351. 
4352.     def test_model_delete(self):
4353.         "Check the never-cache status of a model delete page"
4354.         response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
4355.         self.assertEqual(get_max_age(response), 0)
4356. 
4357.     def test_login(self):
4358.         "Check the never-cache status of login views"
4359.         self.client.logout()
4360.         response = self.client.get(reverse('admin:index'))
4361.         self.assertEqual(get_max_age(response), 0)
4362. 
4363.     def test_logout(self):
4364.         "Check the never-cache status of logout view"
4365.         response = self.client.get(reverse('admin:logout'))
4366.         self.assertEqual(get_max_age(response), 0)
4367. 
4368.     def test_password_change(self):
4369.         "Check the never-cache status of the password change view"
4370.         self.client.logout()
4371.         response = self.client.get(reverse('admin:password_change'))
4372.         self.assertIsNone(get_max_age(response))
4373. 
4374.     def test_password_change_done(self):
4375.         "Check the never-cache status of the password change done view"
4376.         response = self.client.get(reverse('admin:password_change_done'))
4377.         self.assertIsNone(get_max_age(response))
4378. 
4379.     def test_JS_i18n(self):
4380.         "Check the never-cache status of the JavaScript i18n view"
4381.         response = self.client.get(reverse('admin:jsi18n'))
4382.         self.assertIsNone(get_max_age(response))
4383. 
4384. 
4385. @override_settings(ROOT_URLCONF='admin_views.urls')
4386. class PrePopulatedTest(TestCase):
4387. 
4388.     @classmethod
4389.     def setUpTestData(cls):
4390.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4391.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
4392. 
4393.     def setUp(self):
4394.         self.client.force_login(self.superuser)
4395. 
4396.     def test_prepopulated_on(self):
4397.         response = self.client.get(reverse('admin:admin_views_prepopulatedpost_add'))
4398.         self.assertContains(response, "&quot;id&quot;: &quot;#id_slug&quot;")
4399.         self.assertContains(response, "&quot;dependency_ids&quot;: [&quot;#id_title&quot;]")
4400.         self.assertContains(response, "&quot;id&quot;: &quot;#id_prepopulatedsubpost_set-0-subslug&quot;")
4401. 
4402.     def test_prepopulated_off(self):
4403.         response = self.client.get(reverse('admin:admin_views_prepopulatedpost_change', args=(self.p1.pk,)))
4404.         self.assertContains(response, "A Long Title")
4405.         self.assertNotContains(response, "&quot;id&quot;: &quot;#id_slug&quot;")
4406.         self.assertNotContains(response, "&quot;dependency_ids&quot;: [&quot;#id_title&quot;]")
4407.         self.assertNotContains(
4408.             response,
4409.             "&quot;id&quot;: &quot;#id_prepopulatedsubpost_set-0-subslug&quot;"
4410.         )
4411. 
4412.     @override_settings(USE_THOUSAND_SEPARATOR=True, USE_L10N=True)
4413.     def test_prepopulated_maxlength_localized(self):
4414.         """
4415.         Regression test for #15938: if USE_THOUSAND_SEPARATOR is set, make sure
4416.         that maxLength (in the JavaScript) is rendered without separators.
4417.         """
4418.         response = self.client.get(reverse('admin:admin_views_prepopulatedpostlargeslug_add'))
4419.         self.assertContains(response, "&quot;maxLength&quot;: 1000")  # instead of 1,000
4420. 
4421.     def test_view_only_add_form(self):
4422.         """
4423.         PrePopulatedPostReadOnlyAdmin.prepopulated_fields includes 'slug'
4424.         which is present in the add view, even if the
4425.         ModelAdmin.has_change_permission() returns False.
4426.         """
4427.         response = self.client.get(reverse('admin7:admin_views_prepopulatedpost_add'))
4428.         self.assertContains(response, 'data-prepopulated-fields=')
4429.         self.assertContains(response, '&quot;id&quot;: &quot;#id_slug&quot;')
4430. 
4431.     def test_view_only_change_form(self):
4432.         """
4433.         PrePopulatedPostReadOnlyAdmin.prepopulated_fields includes 'slug'. That
4434.         doesn't break a view-only change view.
4435.         """
4436.         response = self.client.get(reverse('admin7:admin_views_prepopulatedpost_change', args=(self.p1.pk,)))
4437.         self.assertContains(response, 'data-prepopulated-fields="[]"')
4438.         self.assertContains(response, '<div class="readonly">%s</div>' % self.p1.slug)
4439. 
4440. 
4441. @override_settings(ROOT_URLCONF='admin_views.urls')
4442. class SeleniumTests(AdminSeleniumTestCase):
4443. 
4444.     available_apps = ['admin_views'] + AdminSeleniumTestCase.available_apps
4445. 
4446.     def setUp(self):
4447.         self.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4448.         self.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
4449. 
4450.     def test_prepopulated_fields(self):
4451.         """
4452.         The JavaScript-automated prepopulated fields work with the main form
4453.         and with stacked and tabular inlines.
4454.         Refs #13068, #9264, #9983, #9784.
4455.         """
4456.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4457.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_mainprepopulated_add'))
4458.         self.wait_for('.select2')
4459. 
4460.         # Main form ----------------------------------------------------------
4461.         self.selenium.find_element_by_id('id_pubdate').send_keys('2012-02-18')
4462.         self.get_select_option('#id_status', 'option two').click()
4463.         self.selenium.find_element_by_id('id_name').send_keys(' this is the mAin nÀMë and it\'s awεšomeııı')
4464.         slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
4465.         slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
4466.         slug3 = self.selenium.find_element_by_id('id_slug3').get_attribute('value')
4467.         self.assertEqual(slug1, 'main-name-and-its-awesomeiii-2012-02-18')
4468.         self.assertEqual(slug2, 'option-two-main-name-and-its-awesomeiii')
4469.         self.assertEqual(slug3, 'this-is-the-main-n\xe0m\xeb-and-its-aw\u03b5\u0161ome\u0131\u0131\u0131')
4470. 
4471.         # Stacked inlines ----------------------------------------------------
4472.         # Initial inline
4473.         self.selenium.find_element_by_id('id_relatedprepopulated_set-0-pubdate').send_keys('2011-12-17')
4474.         self.get_select_option('#id_relatedprepopulated_set-0-status', 'option one').click()
4475.         self.selenium.find_element_by_id('id_relatedprepopulated_set-0-name').send_keys(
4476.             ' here is a sŤāÇkeð   inline !  '
4477.         )
4478.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-0-slug1').get_attribute('value')
4479.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-0-slug2').get_attribute('value')
4480.         self.assertEqual(slug1, 'here-stacked-inline-2011-12-17')
4481.         self.assertEqual(slug2, 'option-one-here-stacked-inline')
4482.         initial_select2_inputs = self.selenium.find_elements_by_class_name('select2-selection')
4483.         # Inline formsets have empty/invisible forms.
4484.         # Only the 4 visible select2 inputs are initialized.
4485.         num_initial_select2_inputs = len(initial_select2_inputs)
4486.         self.assertEqual(num_initial_select2_inputs, 4)
4487. 
4488.         # Add an inline
4489.         self.selenium.find_elements_by_link_text('Add another Related prepopulated')[0].click()
4490.         self.assertEqual(
4491.             len(self.selenium.find_elements_by_class_name('select2-selection')),
4492.             num_initial_select2_inputs + 2
4493.         )
4494.         self.selenium.find_element_by_id('id_relatedprepopulated_set-1-pubdate').send_keys('1999-01-25')
4495.         self.get_select_option('#id_relatedprepopulated_set-1-status', 'option two').click()
4496.         self.selenium.find_element_by_id('id_relatedprepopulated_set-1-name').send_keys(
4497.             ' now you haVe anöther   sŤāÇkeð  inline with a very ... '
4498.             'loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooog text... '
4499.         )
4500.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-1-slug1').get_attribute('value')
4501.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-1-slug2').get_attribute('value')
4502.         # 50 characters maximum for slug1 field
4503.         self.assertEqual(slug1, 'now-you-have-another-stacked-inline-very-loooooooo')
4504.         # 60 characters maximum for slug2 field
4505.         self.assertEqual(slug2, 'option-two-now-you-have-another-stacked-inline-very-looooooo')
4506. 
4507.         # Tabular inlines ----------------------------------------------------
4508.         # Initial inline
4509.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-pubdate').send_keys('1234-12-07')
4510.         self.get_select_option('#id_relatedprepopulated_set-2-0-status', 'option two').click()
4511.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-name').send_keys(
4512.             'And now, with a tÃbűlaŘ inline !!!'
4513.         )
4514.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-slug1').get_attribute('value')
4515.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-slug2').get_attribute('value')
4516.         self.assertEqual(slug1, 'and-now-tabular-inline-1234-12-07')
4517.         self.assertEqual(slug2, 'option-two-and-now-tabular-inline')
4518. 
4519.         # Add an inline
4520.         self.selenium.find_elements_by_link_text('Add another Related prepopulated')[1].click()
4521.         self.assertEqual(
4522.             len(self.selenium.find_elements_by_class_name('select2-selection')),
4523.             num_initial_select2_inputs + 4
4524.         )
4525.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-pubdate').send_keys('1981-08-22')
4526.         self.get_select_option('#id_relatedprepopulated_set-2-1-status', 'option one').click()
4527.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-name').send_keys(
4528.             r'a tÃbűlaŘ inline with ignored ;"&*^\%$#@-/`~ characters'
4529.         )
4530.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-slug1').get_attribute('value')
4531.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-slug2').get_attribute('value')
4532.         self.assertEqual(slug1, 'tabular-inline-ignored-characters-1981-08-22')
4533.         self.assertEqual(slug2, 'option-one-tabular-inline-ignored-characters')
4534.         # Add an inline without an initial inline.
4535.         # The button is outside of the browser frame.
4536.         self.selenium.execute_script("window.scrollTo(0, document.body.scrollHeight);")
4537.         self.selenium.find_elements_by_link_text('Add another Related prepopulated')[2].click()
4538.         self.assertEqual(
4539.             len(self.selenium.find_elements_by_class_name('select2-selection')),
4540.             num_initial_select2_inputs + 6
4541.         )
4542.         # Save and check that everything is properly stored in the database
4543.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4544.         self.wait_page_loaded()
4545.         self.assertEqual(MainPrepopulated.objects.all().count(), 1)
4546.         MainPrepopulated.objects.get(
4547.             name=' this is the mAin nÀMë and it\'s awεšomeııı',
4548.             pubdate='2012-02-18',
4549.             status='option two',
4550.             slug1='main-name-and-its-awesomeiii-2012-02-18',
4551.             slug2='option-two-main-name-and-its-awesomeiii',
4552.         )
4553.         self.assertEqual(RelatedPrepopulated.objects.all().count(), 4)
4554.         RelatedPrepopulated.objects.get(
4555.             name=' here is a sŤāÇkeð   inline !  ',
4556.             pubdate='2011-12-17',
4557.             status='option one',
4558.             slug1='here-stacked-inline-2011-12-17',
4559.             slug2='option-one-here-stacked-inline',
4560.         )
4561.         RelatedPrepopulated.objects.get(
4562.             # 75 characters in name field
4563.             name=' now you haVe anöther   sŤāÇkeð  inline with a very ... loooooooooooooooooo',
4564.             pubdate='1999-01-25',
4565.             status='option two',
4566.             slug1='now-you-have-another-stacked-inline-very-loooooooo',
4567.             slug2='option-two-now-you-have-another-stacked-inline-very-looooooo',
4568.         )
4569.         RelatedPrepopulated.objects.get(
4570.             name='And now, with a tÃbűlaŘ inline !!!',
4571.             pubdate='1234-12-07',
4572.             status='option two',
4573.             slug1='and-now-tabular-inline-1234-12-07',
4574.             slug2='option-two-and-now-tabular-inline',
4575.         )
4576.         RelatedPrepopulated.objects.get(
4577.             name=r'a tÃbűlaŘ inline with ignored ;"&*^\%$#@-/`~ characters',
4578.             pubdate='1981-08-22',
4579.             status='option one',
4580.             slug1='tabular-inline-ignored-characters-1981-08-22',
4581.             slug2='option-one-tabular-inline-ignored-characters',
4582.         )
4583. 
4584.     def test_populate_existing_object(self):
4585.         """
4586.         The prepopulation works for existing objects too, as long as
4587.         the original field is empty (#19082).
4588.         """
4589.         # Slugs are empty to start with.
4590.         item = MainPrepopulated.objects.create(
4591.             name=' this is the mAin nÀMë',
4592.             pubdate='2012-02-18',
4593.             status='option two',
4594.             slug1='',
4595.             slug2='',
4596.         )
4597.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4598. 
4599.         object_url = self.live_server_url + reverse('admin:admin_views_mainprepopulated_change', args=(item.id,))
4600. 
4601.         self.selenium.get(object_url)
4602.         self.selenium.find_element_by_id('id_name').send_keys(' the best')
4603. 
4604.         # The slugs got prepopulated since they were originally empty
4605.         slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
4606.         slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
4607.         self.assertEqual(slug1, 'main-name-best-2012-02-18')
4608.         self.assertEqual(slug2, 'option-two-main-name-best')
4609. 
4610.         # Save the object
4611.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4612.         self.wait_page_loaded()
4613. 
4614.         self.selenium.get(object_url)
4615.         self.selenium.find_element_by_id('id_name').send_keys(' hello')
4616. 
4617.         # The slugs got prepopulated didn't change since they were originally not empty
4618.         slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
4619.         slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
4620.         self.assertEqual(slug1, 'main-name-best-2012-02-18')
4621.         self.assertEqual(slug2, 'option-two-main-name-best')
4622. 
4623.     def test_collapsible_fieldset(self):
4624.         """
4625.         The 'collapse' class in fieldsets definition allows to
4626.         show/hide the appropriate field section.
4627.         """
4628.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4629.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_article_add'))
4630.         self.assertFalse(self.selenium.find_element_by_id('id_title').is_displayed())
4631.         self.selenium.find_elements_by_link_text('Show')[0].click()
4632.         self.assertTrue(self.selenium.find_element_by_id('id_title').is_displayed())
4633.         self.assertEqual(self.selenium.find_element_by_id('fieldsetcollapser0').text, "Hide")
4634. 
4635.     def test_first_field_focus(self):
4636.         """JavaScript-assisted auto-focus on first usable form field."""
4637.         # First form field has a single widget
4638.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4639.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_picture_add'))
4640.         self.assertEqual(
4641.             self.selenium.switch_to.active_element,
4642.             self.selenium.find_element_by_id('id_name')
4643.         )
4644. 
4645.         # First form field has a MultiWidget
4646.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_reservation_add'))
4647.         self.assertEqual(
4648.             self.selenium.switch_to.active_element,
4649.             self.selenium.find_element_by_id('id_start_date_0')
4650.         )
4651. 
4652.     def test_cancel_delete_confirmation(self):
4653.         "Cancelling the deletion of an object takes the user back one page."
4654.         pizza = Pizza.objects.create(name="Double Cheese")
4655.         url = reverse('admin:admin_views_pizza_change', args=(pizza.id,))
4656.         full_url = self.live_server_url + url
4657.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4658.         self.selenium.get(full_url)
4659.         self.selenium.find_element_by_class_name('deletelink').click()
4660.         # Click 'cancel' on the delete page.
4661.         self.selenium.find_element_by_class_name('cancel-link').click()
4662.         # Wait until we're back on the change page.
4663.         self.wait_for_text('#content h1', 'Change pizza')
4664.         self.assertEqual(self.selenium.current_url, full_url)
4665.         self.assertEqual(Pizza.objects.count(), 1)
4666. 
4667.     def test_cancel_delete_related_confirmation(self):
4668.         """
4669.         Cancelling the deletion of an object with relations takes the user back
4670.         one page.
4671.         """
4672.         pizza = Pizza.objects.create(name="Double Cheese")
4673.         topping1 = Topping.objects.create(name="Cheddar")
4674.         topping2 = Topping.objects.create(name="Mozzarella")
4675.         pizza.toppings.add(topping1, topping2)
4676.         url = reverse('admin:admin_views_pizza_change', args=(pizza.id,))
4677.         full_url = self.live_server_url + url
4678.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4679.         self.selenium.get(full_url)
4680.         self.selenium.find_element_by_class_name('deletelink').click()
4681.         # Click 'cancel' on the delete page.
4682.         self.selenium.find_element_by_class_name('cancel-link').click()
4683.         # Wait until we're back on the change page.
4684.         self.wait_for_text('#content h1', 'Change pizza')
4685.         self.assertEqual(self.selenium.current_url, full_url)
4686.         self.assertEqual(Pizza.objects.count(), 1)
4687.         self.assertEqual(Topping.objects.count(), 2)
4688. 
4689.     def test_list_editable_popups(self):
4690.         """
4691.         list_editable foreign keys have add/change popups.
4692.         """
4693.         from selenium.webdriver.support.ui import Select
4694.         s1 = Section.objects.create(name='Test section')
4695.         Article.objects.create(
4696.             title='foo',
4697.             content='<p>Middle content</p>',
4698.             date=datetime.datetime(2008, 3, 18, 11, 54, 58),
4699.             section=s1,
4700.         )
4701.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4702.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_article_changelist'))
4703.         # Change popup
4704.         self.selenium.find_element_by_id('change_id_form-0-section').click()
4705.         self.wait_for_popup()
4706.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4707.         self.wait_for_text('#content h1', 'Change section')
4708.         name_input = self.selenium.find_element_by_id('id_name')
4709.         name_input.clear()
4710.         name_input.send_keys('<i>edited section</i>')
4711.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4712.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4713.         select = Select(self.selenium.find_element_by_id('id_form-0-section'))
4714.         self.assertEqual(select.first_selected_option.text, '<i>edited section</i>')
4715.         # Rendered select2 input.
4716.         select2_display = self.selenium.find_element_by_class_name('select2-selection__rendered')
4717.         # Clear button (×\n) is included in text.
4718.         self.assertEqual(select2_display.text, '×\n<i>edited section</i>')
4719. 
4720.         # Add popup
4721.         self.selenium.find_element_by_id('add_id_form-0-section').click()
4722.         self.wait_for_popup()
4723.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4724.         self.wait_for_text('#content h1', 'Add section')
4725.         self.selenium.find_element_by_id('id_name').send_keys('new section')
4726.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4727.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4728.         select = Select(self.selenium.find_element_by_id('id_form-0-section'))
4729.         self.assertEqual(select.first_selected_option.text, 'new section')
4730.         select2_display = self.selenium.find_element_by_class_name('select2-selection__rendered')
4731.         # Clear button (×\n) is included in text.
4732.         self.assertEqual(select2_display.text, '×\nnew section')
4733. 
4734.     def test_inline_uuid_pk_edit_with_popup(self):
4735.         from selenium.webdriver.support.ui import Select
4736.         parent = ParentWithUUIDPK.objects.create(title='test')
4737.         related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
4738.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4739.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
4740.         self.selenium.get(self.live_server_url + change_url)
4741.         self.selenium.find_element_by_id('change_id_parent').click()
4742.         self.wait_for_popup()
4743.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4744.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4745.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4746.         select = Select(self.selenium.find_element_by_id('id_parent'))
4747.         self.assertEqual(select.first_selected_option.text, str(parent.id))
4748.         self.assertEqual(select.first_selected_option.get_attribute('value'), str(parent.id))
4749. 
4750.     def test_inline_uuid_pk_add_with_popup(self):
4751.         from selenium.webdriver.support.ui import Select
4752.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4753.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_relatedwithuuidpkmodel_add'))
4754.         self.selenium.find_element_by_id('add_id_parent').click()
4755.         self.wait_for_popup()
4756.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4757.         self.selenium.find_element_by_id('id_title').send_keys('test')
4758.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4759.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4760.         select = Select(self.selenium.find_element_by_id('id_parent'))
4761.         uuid_id = str(ParentWithUUIDPK.objects.first().id)
4762.         self.assertEqual(select.first_selected_option.text, uuid_id)
4763.         self.assertEqual(select.first_selected_option.get_attribute('value'), uuid_id)
4764. 
4765.     def test_inline_uuid_pk_delete_with_popup(self):
4766.         from selenium.webdriver.support.ui import Select
4767.         parent = ParentWithUUIDPK.objects.create(title='test')
4768.         related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
4769.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4770.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
4771.         self.selenium.get(self.live_server_url + change_url)
4772.         self.selenium.find_element_by_id('delete_id_parent').click()
4773.         self.wait_for_popup()
4774.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4775.         self.selenium.find_element_by_xpath('//input[@value="Yes, I\'m sure"]').click()
4776.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4777.         select = Select(self.selenium.find_element_by_id('id_parent'))
4778.         self.assertEqual(ParentWithUUIDPK.objects.count(), 0)
4779.         self.assertEqual(select.first_selected_option.text, '---------')
4780.         self.assertEqual(select.first_selected_option.get_attribute('value'), '')
4781. 
4782.     def test_inline_with_popup_cancel_delete(self):
4783.         """Clicking ""No, take me back" on a delete popup closes the window."""
4784.         parent = ParentWithUUIDPK.objects.create(title='test')
4785.         related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
4786.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4787.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
4788.         self.selenium.get(self.live_server_url + change_url)
4789.         self.selenium.find_element_by_id('delete_id_parent').click()
4790.         self.wait_for_popup()
4791.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4792.         self.selenium.find_element_by_xpath('//a[text()="No, take me back"]').click()
4793.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4794.         self.assertEqual(len(self.selenium.window_handles), 1)
4795. 
4796.     def test_list_editable_raw_id_fields(self):
4797.         parent = ParentWithUUIDPK.objects.create(title='test')
4798.         parent2 = ParentWithUUIDPK.objects.create(title='test2')
4799.         RelatedWithUUIDPKModel.objects.create(parent=parent)
4800.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4801.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_changelist', current_app=site2.name)
4802.         self.selenium.get(self.live_server_url + change_url)
4803.         self.selenium.find_element_by_id('lookup_id_form-0-parent').click()
4804.         self.wait_for_popup()
4805.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4806.         # Select "parent2" in the popup.
4807.         self.selenium.find_element_by_link_text(str(parent2.pk)).click()
4808.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4809.         # The newly selected pk should appear in the raw id input.
4810.         value = self.selenium.find_element_by_id('id_form-0-parent').get_attribute('value')
4811.         self.assertEqual(value, str(parent2.pk))
4812. 
4813. 
4814. @override_settings(ROOT_URLCONF='admin_views.urls')
4815. class ReadonlyTest(AdminFieldExtractionMixin, TestCase):
4816. 
4817.     @classmethod
4818.     def setUpTestData(cls):
4819.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4820. 
4821.     def setUp(self):
4822.         self.client.force_login(self.superuser)
4823. 
4824.     def test_readonly_get(self):
4825.         response = self.client.get(reverse('admin:admin_views_post_add'))
4826.         self.assertEqual(response.status_code, 200)
4827.         self.assertNotContains(response, 'name="posted"')
4828.         # 3 fields + 2 submit buttons + 5 inline management form fields, + 2
4829.         # hidden fields for inlines + 1 field for the inline + 2 empty form
4830.         self.assertContains(response, "<input", count=15)
4831.         self.assertContains(response, formats.localize(datetime.date.today()))
4832.         self.assertContains(response, "<label>Awesomeness level:</label>")
4833.         self.assertContains(response, "Very awesome.")
4834.         self.assertContains(response, "Unknown coolness.")
4835.         self.assertContains(response, "foo")
4836. 
4837.         # Multiline text in a readonly field gets <br> tags
4838.         self.assertContains(response, 'Multiline<br>test<br>string')
4839.         self.assertContains(response, '<div class="readonly">Multiline<br>html<br>content</div>', html=True)
4840.         self.assertContains(response, 'InlineMultiline<br>test<br>string')
4841. 
4842.         self.assertContains(response, formats.localize(datetime.date.today() - datetime.timedelta(days=7)))
4843. 
4844.         self.assertContains(response, '<div class="form-row field-coolness">')
4845.         self.assertContains(response, '<div class="form-row field-awesomeness_level">')
4846.         self.assertContains(response, '<div class="form-row field-posted">')
4847.         self.assertContains(response, '<div class="form-row field-value">')
4848.         self.assertContains(response, '<div class="form-row">')
4849.         self.assertContains(response, '<div class="help">', 3)
4850.         self.assertContains(
4851.             response,
4852.             '<div class="help">Some help text for the title (with unicode ŠĐĆŽćžšđ)</div>',
4853.             html=True
4854.         )
4855.         self.assertContains(
4856.             response,
4857.             '<div class="help">Some help text for the content (with unicode ŠĐĆŽćžšđ)</div>',
4858.             html=True
4859.         )
4860.         self.assertContains(
4861.             response,
4862.             '<div class="help">Some help text for the date (with unicode ŠĐĆŽćžšđ)</div>',
4863.             html=True
4864.         )
4865. 
4866.         p = Post.objects.create(title="I worked on readonly_fields", content="Its good stuff")
4867.         response = self.client.get(reverse('admin:admin_views_post_change', args=(p.pk,)))
4868.         self.assertContains(response, "%d amount of cool" % p.pk)
4869. 
4870.     def test_readonly_text_field(self):
4871.         p = Post.objects.create(
4872.             title="Readonly test", content="test",
4873.             readonly_content='test\r\n\r\ntest\r\n\r\ntest\r\n\r\ntest',
4874.         )
4875.         Link.objects.create(
4876.             url="http://www.djangoproject.com", post=p,
4877.             readonly_link_content="test\r\nlink",
4878.         )
4879.         response = self.client.get(reverse('admin:admin_views_post_change', args=(p.pk,)))
4880.         # Checking readonly field.
4881.         self.assertContains(response, 'test<br><br>test<br><br>test<br><br>test')
4882.         # Checking readonly field in inline.
4883.         self.assertContains(response, 'test<br>link')
4884. 
4885.     def test_readonly_post(self):
4886.         data = {
4887.             "title": "Django Got Readonly Fields",
4888.             "content": "This is an incredible development.",
4889.             "link_set-TOTAL_FORMS": "1",
4890.             "link_set-INITIAL_FORMS": "0",
4891.             "link_set-MAX_NUM_FORMS": "0",
4892.         }
4893.         response = self.client.post(reverse('admin:admin_views_post_add'), data)
4894.         self.assertEqual(response.status_code, 302)
4895.         self.assertEqual(Post.objects.count(), 1)
4896.         p = Post.objects.get()
4897.         self.assertEqual(p.posted, datetime.date.today())
4898. 
4899.         data["posted"] = "10-8-1990"  # some date that's not today
4900.         response = self.client.post(reverse('admin:admin_views_post_add'), data)
4901.         self.assertEqual(response.status_code, 302)
4902.         self.assertEqual(Post.objects.count(), 2)
4903.         p = Post.objects.order_by('-id')[0]
4904.         self.assertEqual(p.posted, datetime.date.today())
4905. 
4906.     def test_readonly_manytomany(self):
4907.         "Regression test for #13004"
4908.         response = self.client.get(reverse('admin:admin_views_pizza_add'))
4909.         self.assertEqual(response.status_code, 200)
4910. 
4911.     def test_user_password_change_limited_queryset(self):
4912.         su = User.objects.filter(is_superuser=True)[0]
4913.         response = self.client.get(reverse('admin2:auth_user_password_change', args=(su.pk,)))
4914.         self.assertEqual(response.status_code, 404)
4915. 
4916.     def test_change_form_renders_correct_null_choice_value(self):
4917.         """
4918.         Regression test for #17911.
4919.         """
4920.         choice = Choice.objects.create(choice=None)
4921.         response = self.client.get(reverse('admin:admin_views_choice_change', args=(choice.pk,)))
4922.         self.assertContains(response, '<div class="readonly">No opinion</div>', html=True)
4923. 
4924.     def test_readonly_manytomany_backwards_ref(self):
4925.         """
4926.         Regression test for #16433 - backwards references for related objects
4927.         broke if the related field is read-only due to the help_text attribute
4928.         """
4929.         topping = Topping.objects.create(name='Salami')
4930.         pizza = Pizza.objects.create(name='Americano')
4931.         pizza.toppings.add(topping)
4932.         response = self.client.get(reverse('admin:admin_views_topping_add'))
4933.         self.assertEqual(response.status_code, 200)
4934. 
4935.     def test_readonly_manytomany_forwards_ref(self):
4936.         topping = Topping.objects.create(name='Salami')
4937.         pizza = Pizza.objects.create(name='Americano')
4938.         pizza.toppings.add(topping)
4939.         response = self.client.get(reverse('admin:admin_views_pizza_change', args=(pizza.pk,)))
4940.         self.assertContains(response, '<label>Toppings:</label>', html=True)
4941.         self.assertContains(response, '<div class="readonly">Salami</div>', html=True)
4942. 
4943.     def test_readonly_onetoone_backwards_ref(self):
4944.         """
4945.         Can reference a reverse OneToOneField in ModelAdmin.readonly_fields.
4946.         """
4947.         v1 = Villain.objects.create(name='Adam')
4948.         pl = Plot.objects.create(name='Test Plot', team_leader=v1, contact=v1)
4949.         pd = PlotDetails.objects.create(details='Brand New Plot', plot=pl)
4950. 
4951.         response = self.client.get(reverse('admin:admin_views_plotproxy_change', args=(pl.pk,)))
4952.         field = self.get_admin_readonly_field(response, 'plotdetails')
4953.         self.assertEqual(field.contents(), 'Brand New Plot')
4954. 
4955.         # The reverse relation also works if the OneToOneField is null.
4956.         pd.plot = None
4957.         pd.save()
4958. 
4959.         response = self.client.get(reverse('admin:admin_views_plotproxy_change', args=(pl.pk,)))
4960.         field = self.get_admin_readonly_field(response, 'plotdetails')
4961.         self.assertEqual(field.contents(), '-')  # default empty value
4962. 
4963.     def test_readonly_field_overrides(self):
4964.         """
4965.         Regression test for #22087 - ModelForm Meta overrides are ignored by
4966.         AdminReadonlyField
4967.         """
4968.         p = FieldOverridePost.objects.create(title="Test Post", content="Test Content")
4969.         response = self.client.get(reverse('admin:admin_views_fieldoverridepost_change', args=(p.pk,)))
4970.         self.assertContains(response, '<div class="help">Overridden help text for the date</div>')
4971.         self.assertContains(response, '<label for="id_public">Overridden public label:</label>', html=True)
4972.         self.assertNotContains(response, "Some help text for the date (with unicode ŠĐĆŽćžšđ)")
4973. 
4974.     def test_correct_autoescaping(self):
4975.         """
4976.         Make sure that non-field readonly elements are properly autoescaped (#24461)
4977.         """
4978.         section = Section.objects.create(name='<a>evil</a>')
4979.         response = self.client.get(reverse('admin:admin_views_section_change', args=(section.pk,)))
4980.         self.assertNotContains(response, "<a>evil</a>", status_code=200)
4981.         self.assertContains(response, "&lt;a&gt;evil&lt;/a&gt;", status_code=200)
4982. 
4983.     def test_label_suffix_translated(self):
4984.         pizza = Pizza.objects.create(name='Americano')
4985.         url = reverse('admin:admin_views_pizza_change', args=(pizza.pk,))
4986.         with self.settings(LANGUAGE_CODE='fr'):
4987.             response = self.client.get(url)
4988.         self.assertContains(response, '<label>Toppings\u00A0:</label>', html=True)
4989. 
4990. 
4991. @override_settings(ROOT_URLCONF='admin_views.urls')
4992. class LimitChoicesToInAdminTest(TestCase):
4993. 
4994.     @classmethod
4995.     def setUpTestData(cls):
4996.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4997. 
4998.     def setUp(self):
4999.         self.client.force_login(self.superuser)
5000. 
5001.     def test_limit_choices_to_as_callable(self):
5002.         """Test for ticket 2445 changes to admin."""
5003.         threepwood = Character.objects.create(
5004.             username='threepwood',
5005.             last_action=datetime.datetime.today() + datetime.timedelta(days=1),
5006.         )
5007.         marley = Character.objects.create(
5008.             username='marley',
5009.             last_action=datetime.datetime.today() - datetime.timedelta(days=1),
5010.         )
5011.         response = self.client.get(reverse('admin:admin_views_stumpjoke_add'))
5012.         # The allowed option should appear twice; the limited option should not appear.
5013.         self.assertContains(response, threepwood.username, count=2)
5014.         self.assertNotContains(response, marley.username)
5015. 
5016. 
5017. @override_settings(ROOT_URLCONF='admin_views.urls')
5018. class RawIdFieldsTest(TestCase):
5019. 
5020.     @classmethod
5021.     def setUpTestData(cls):
5022.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5023. 
5024.     def setUp(self):
5025.         self.client.force_login(self.superuser)
5026. 
5027.     def test_limit_choices_to(self):
5028.         """Regression test for 14880"""
5029.         actor = Actor.objects.create(name="Palin", age=27)
5030.         Inquisition.objects.create(expected=True,
5031.                                    leader=actor,
5032.                                    country="England")
5033.         Inquisition.objects.create(expected=False,
5034.                                    leader=actor,
5035.                                    country="Spain")
5036.         response = self.client.get(reverse('admin:admin_views_sketch_add'))
5037.         # Find the link
5038.         m = re.search(br'<a href="([^"]*)"[^>]* id="lookup_id_inquisition"', response.content)
5039.         self.assertTrue(m)  # Got a match
5040.         popup_url = m.groups()[0].decode().replace("&amp;", "&")
5041. 
5042.         # Handle relative links
5043.         popup_url = urljoin(response.request['PATH_INFO'], popup_url)
5044.         # Get the popup and verify the correct objects show up in the resulting
5045.         # page. This step also tests integers, strings and booleans in the
5046.         # lookup query string; in model we define inquisition field to have a
5047.         # limit_choices_to option that includes a filter on a string field
5048.         # (inquisition__actor__name), a filter on an integer field
5049.         # (inquisition__actor__age), and a filter on a boolean field
5050.         # (inquisition__expected).
5051.         response2 = self.client.get(popup_url)
5052.         self.assertContains(response2, "Spain")
5053.         self.assertNotContains(response2, "England")
5054. 
5055.     def test_limit_choices_to_isnull_false(self):
5056.         """Regression test for 20182"""
5057.         Actor.objects.create(name="Palin", age=27)
5058.         Actor.objects.create(name="Kilbraken", age=50, title="Judge")
5059.         response = self.client.get(reverse('admin:admin_views_sketch_add'))
5060.         # Find the link
5061.         m = re.search(br'<a href="([^"]*)"[^>]* id="lookup_id_defendant0"', response.content)
5062.         self.assertTrue(m)  # Got a match
5063.         popup_url = m.groups()[0].decode().replace("&amp;", "&")
5064. 
5065.         # Handle relative links
5066.         popup_url = urljoin(response.request['PATH_INFO'], popup_url)
5067.         # Get the popup and verify the correct objects show up in the resulting
5068.         # page. This step tests field__isnull=0 gets parsed correctly from the
5069.         # lookup query string; in model we define defendant0 field to have a
5070.         # limit_choices_to option that includes "actor__title__isnull=False".
5071.         response2 = self.client.get(popup_url)
5072.         self.assertContains(response2, "Kilbraken")
5073.         self.assertNotContains(response2, "Palin")
5074. 
5075.     def test_limit_choices_to_isnull_true(self):
5076.         """Regression test for 20182"""
5077.         Actor.objects.create(name="Palin", age=27)
5078.         Actor.objects.create(name="Kilbraken", age=50, title="Judge")
5079.         response = self.client.get(reverse('admin:admin_views_sketch_add'))
5080.         # Find the link
5081.         m = re.search(br'<a href="([^"]*)"[^>]* id="lookup_id_defendant1"', response.content)
5082.         self.assertTrue(m)  # Got a match
5083.         popup_url = m.groups()[0].decode().replace("&amp;", "&")
5084. 
5085.         # Handle relative links
5086.         popup_url = urljoin(response.request['PATH_INFO'], popup_url)
5087.         # Get the popup and verify the correct objects show up in the resulting
5088.         # page. This step tests field__isnull=1 gets parsed correctly from the
5089.         # lookup query string; in model we define defendant1 field to have a
5090.         # limit_choices_to option that includes "actor__title__isnull=True".
5091.         response2 = self.client.get(popup_url)
5092.         self.assertNotContains(response2, "Kilbraken")
5093.         self.assertContains(response2, "Palin")
5094. 
5095.     def test_list_display_method_same_name_as_reverse_accessor(self):
5096.         """
5097.         Should be able to use a ModelAdmin method in list_display that has the
5098.         same name as a reverse model field ("sketch" in this case).
5099.         """
5100.         actor = Actor.objects.create(name="Palin", age=27)
5101.         Inquisition.objects.create(expected=True, leader=actor, country="England")
5102.         response = self.client.get(reverse('admin:admin_views_inquisition_changelist'))
5103.         self.assertContains(response, 'list-display-sketch')
5104. 
5105. 
5106. @override_settings(ROOT_URLCONF='admin_views.urls')
5107. class UserAdminTest(TestCase):
5108.     """
5109.     Tests user CRUD functionality.
5110.     """
5111. 
5112.     @classmethod
5113.     def setUpTestData(cls):
5114.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5115.         cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
5116.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
5117.         cls.s1 = Section.objects.create(name='Test section')
5118.         cls.a1 = Article.objects.create(
5119.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
5120.         )
5121.         cls.a2 = Article.objects.create(
5122.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
5123.         )
5124.         cls.a3 = Article.objects.create(
5125.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
5126.         )
5127.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
5128. 
5129.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
5130.         cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
5131.         cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)
5132. 
5133.     def setUp(self):
5134.         self.client.force_login(self.superuser)
5135. 
5136.     def test_save_button(self):
5137.         user_count = User.objects.count()
5138.         response = self.client.post(reverse('admin:auth_user_add'), {
5139.             'username': 'newuser',
5140.             'password1': 'newpassword',
5141.             'password2': 'newpassword',
5142.         })
5143.         new_user = User.objects.get(username='newuser')
5144.         self.assertRedirects(response, reverse('admin:auth_user_change', args=(new_user.pk,)))
5145.         self.assertEqual(User.objects.count(), user_count + 1)
5146.         self.assertTrue(new_user.has_usable_password())
5147. 
5148.     def test_save_continue_editing_button(self):
5149.         user_count = User.objects.count()
5150.         response = self.client.post(reverse('admin:auth_user_add'), {
5151.             'username': 'newuser',
5152.             'password1': 'newpassword',
5153.             'password2': 'newpassword',
5154.             '_continue': '1',
5155.         })
5156.         new_user = User.objects.get(username='newuser')
5157.         new_user_url = reverse('admin:auth_user_change', args=(new_user.pk,))
5158.         self.assertRedirects(response, new_user_url, fetch_redirect_response=False)
5159.         self.assertEqual(User.objects.count(), user_count + 1)
5160.         self.assertTrue(new_user.has_usable_password())
5161.         response = self.client.get(new_user_url)
5162.         self.assertContains(
5163.             response,
5164.             '<li class="success">The user "<a href="%s">'
5165.             '%s</a>" was added successfully. You may edit it again below.</li>'
5166.             % (new_user_url, new_user),
5167.             html=True,
5168.         )
5169. 
5170.     def test_password_mismatch(self):
5171.         response = self.client.post(reverse('admin:auth_user_add'), {
5172.             'username': 'newuser',
5173.             'password1': 'newpassword',
5174.             'password2': 'mismatch',
5175.         })
5176.         self.assertEqual(response.status_code, 200)
5177.         self.assertFormError(response, 'adminform', 'password', [])
5178.         self.assertFormError(response, 'adminform', 'password2', ["The two password fields didn't match."])
5179. 
5180.     def test_user_fk_add_popup(self):
5181.         """User addition through a FK popup should return the appropriate JavaScript response."""
5182.         response = self.client.get(reverse('admin:admin_views_album_add'))
5183.         self.assertContains(response, reverse('admin:auth_user_add'))
5184.         self.assertContains(response, 'class="related-widget-wrapper-link add-related" id="add_id_owner"')
5185.         response = self.client.get(reverse('admin:auth_user_add') + '?_popup=1')
5186.         self.assertNotContains(response, 'name="_continue"')
5187.         self.assertNotContains(response, 'name="_addanother"')
5188.         data = {
5189.             'username': 'newuser',
5190.             'password1': 'newpassword',
5191.             'password2': 'newpassword',
5192.             '_popup': '1',
5193.             '_save': '1',
5194.         }
5195.         response = self.client.post(reverse('admin:auth_user_add') + '?_popup=1', data, follow=True)
5196.         self.assertContains(response, '&quot;obj&quot;: &quot;newuser&quot;')
5197. 
5198.     def test_user_fk_change_popup(self):
5199.         """User change through a FK popup should return the appropriate JavaScript response."""
5200.         response = self.client.get(reverse('admin:admin_views_album_add'))
5201.         self.assertContains(response, reverse('admin:auth_user_change', args=('__fk__',)))
5202.         self.assertContains(response, 'class="related-widget-wrapper-link change-related" id="change_id_owner"')
5203.         user = User.objects.get(username='changeuser')
5204.         url = reverse('admin:auth_user_change', args=(user.pk,)) + '?_popup=1'
5205.         response = self.client.get(url)
5206.         self.assertNotContains(response, 'name="_continue"')
5207.         self.assertNotContains(response, 'name="_addanother"')
5208.         data = {
5209.             'username': 'newuser',
5210.             'password1': 'newpassword',
5211.             'password2': 'newpassword',
5212.             'last_login_0': '2007-05-30',
5213.             'last_login_1': '13:20:10',
5214.             'date_joined_0': '2007-05-30',
5215.             'date_joined_1': '13:20:10',
5216.             '_popup': '1',
5217.             '_save': '1',
5218.         }
5219.         response = self.client.post(url, data, follow=True)
5220.         self.assertContains(response, '&quot;obj&quot;: &quot;newuser&quot;')
5221.         self.assertContains(response, '&quot;action&quot;: &quot;change&quot;')
5222. 
5223.     def test_user_fk_delete_popup(self):
5224.         """User deletion through a FK popup should return the appropriate JavaScript response."""
5225.         response = self.client.get(reverse('admin:admin_views_album_add'))
5226.         self.assertContains(response, reverse('admin:auth_user_delete', args=('__fk__',)))
5227.         self.assertContains(response, 'class="related-widget-wrapper-link change-related" id="change_id_owner"')
5228.         user = User.objects.get(username='changeuser')
5229.         url = reverse('admin:auth_user_delete', args=(user.pk,)) + '?_popup=1'
5230.         response = self.client.get(url)
5231.         self.assertEqual(response.status_code, 200)
5232.         data = {
5233.             'post': 'yes',
5234.             '_popup': '1',
5235.         }
5236.         response = self.client.post(url, data, follow=True)
5237.         self.assertContains(response, '&quot;action&quot;: &quot;delete&quot;')
5238. 
5239.     def test_save_add_another_button(self):
5240.         user_count = User.objects.count()
5241.         response = self.client.post(reverse('admin:auth_user_add'), {
5242.             'username': 'newuser',
5243.             'password1': 'newpassword',
5244.             'password2': 'newpassword',
5245.             '_addanother': '1',
5246.         })
5247.         new_user = User.objects.order_by('-id')[0]
5248.         self.assertRedirects(response, reverse('admin:auth_user_add'))
5249.         self.assertEqual(User.objects.count(), user_count + 1)
5250.         self.assertTrue(new_user.has_usable_password())
5251. 
5252.     def test_user_permission_performance(self):
5253.         u = User.objects.all()[0]
5254. 
5255.         # Don't depend on a warm cache, see #17377.
5256.         ContentType.objects.clear_cache()
5257. 
5258.         with self.assertNumQueries(10):
5259.             response = self.client.get(reverse('admin:auth_user_change', args=(u.pk,)))
5260.             self.assertEqual(response.status_code, 200)
5261. 
5262.     def test_form_url_present_in_context(self):
5263.         u = User.objects.all()[0]
5264.         response = self.client.get(reverse('admin3:auth_user_password_change', args=(u.pk,)))
5265.         self.assertEqual(response.status_code, 200)
5266.         self.assertEqual(response.context['form_url'], 'pony')
5267. 
5268. 
5269. @override_settings(ROOT_URLCONF='admin_views.urls')
5270. class GroupAdminTest(TestCase):
5271.     """
5272.     Tests group CRUD functionality.
5273.     """
5274. 
5275.     @classmethod
5276.     def setUpTestData(cls):
5277.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5278. 
5279.     def setUp(self):
5280.         self.client.force_login(self.superuser)
5281. 
5282.     def test_save_button(self):
5283.         group_count = Group.objects.count()
5284.         response = self.client.post(reverse('admin:auth_group_add'), {
5285.             'name': 'newgroup',
5286.         })
5287. 
5288.         Group.objects.order_by('-id')[0]
5289.         self.assertRedirects(response, reverse('admin:auth_group_changelist'))
5290.         self.assertEqual(Group.objects.count(), group_count + 1)
5291. 
5292.     def test_group_permission_performance(self):
5293.         g = Group.objects.create(name="test_group")
5294. 
5295.         # Ensure no queries are skipped due to cached content type for Group.
5296.         ContentType.objects.clear_cache()
5297. 
5298.         with self.assertNumQueries(8):
5299.             response = self.client.get(reverse('admin:auth_group_change', args=(g.pk,)))
5300.             self.assertEqual(response.status_code, 200)
5301. 
5302. 
5303. @override_settings(ROOT_URLCONF='admin_views.urls')
5304. class CSSTest(TestCase):
5305. 
5306.     @classmethod
5307.     def setUpTestData(cls):
5308.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5309.         cls.s1 = Section.objects.create(name='Test section')
5310.         cls.a1 = Article.objects.create(
5311.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
5312.         )
5313.         cls.a2 = Article.objects.create(
5314.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
5315.         )
5316.         cls.a3 = Article.objects.create(
5317.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
5318.         )
5319.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
5320. 
5321.     def setUp(self):
5322.         self.client.force_login(self.superuser)
5323. 
5324.     def test_field_prefix_css_classes(self):
5325.         """
5326.         Fields have a CSS class name with a 'field-' prefix.
5327.         """
5328.         response = self.client.get(reverse('admin:admin_views_post_add'))
5329. 
5330.         # The main form
5331.         self.assertContains(response, 'class="form-row field-title"')
5332.         self.assertContains(response, 'class="form-row field-content"')
5333.         self.assertContains(response, 'class="form-row field-public"')
5334.         self.assertContains(response, 'class="form-row field-awesomeness_level"')
5335.         self.assertContains(response, 'class="form-row field-coolness"')
5336.         self.assertContains(response, 'class="form-row field-value"')
5337.         self.assertContains(response, 'class="form-row"')  # The lambda function
5338. 
5339.         # The tabular inline
5340.         self.assertContains(response, '<td class="field-url">')
5341.         self.assertContains(response, '<td class="field-posted">')
5342. 
5343.     def test_index_css_classes(self):
5344.         """
5345.         CSS class names are used for each app and model on the admin index
5346.         pages (#17050).
5347.         """
5348.         # General index page
5349.         response = self.client.get(reverse('admin:index'))
5350.         self.assertContains(response, '<div class="app-admin_views module">')
5351.         self.assertContains(response, '<tr class="model-actor">')
5352.         self.assertContains(response, '<tr class="model-album">')
5353. 
5354.         # App index page
5355.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
5356.         self.assertContains(response, '<div class="app-admin_views module">')
5357.         self.assertContains(response, '<tr class="model-actor">')
5358.         self.assertContains(response, '<tr class="model-album">')
5359. 
5360.     def test_app_model_in_form_body_class(self):
5361.         """
5362.         Ensure app and model tag are correctly read by change_form template
5363.         """
5364.         response = self.client.get(reverse('admin:admin_views_section_add'))
5365.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5366. 
5367.     def test_app_model_in_list_body_class(self):
5368.         """
5369.         Ensure app and model tag are correctly read by change_list template
5370.         """
5371.         response = self.client.get(reverse('admin:admin_views_section_changelist'))
5372.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5373. 
5374.     def test_app_model_in_delete_confirmation_body_class(self):
5375.         """
5376.         Ensure app and model tag are correctly read by delete_confirmation
5377.         template
5378.         """
5379.         response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
5380.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5381. 
5382.     def test_app_model_in_app_index_body_class(self):
5383.         """
5384.         Ensure app and model tag are correctly read by app_index template
5385.         """
5386.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
5387.         self.assertContains(response, '<body class=" dashboard app-admin_views')
5388. 
5389.     def test_app_model_in_delete_selected_confirmation_body_class(self):
5390.         """
5391.         Ensure app and model tag are correctly read by
5392.         delete_selected_confirmation template
5393.         """
5394.         action_data = {
5395.             ACTION_CHECKBOX_NAME: [self.s1.pk],
5396.             'action': 'delete_selected',
5397.             'index': 0,
5398.         }
5399.         response = self.client.post(reverse('admin:admin_views_section_changelist'), action_data)
5400.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5401. 
5402.     def test_changelist_field_classes(self):
5403.         """
5404.         Cells of the change list table should contain the field name in their class attribute
5405.         Refs #11195.
5406.         """
5407.         Podcast.objects.create(name="Django Dose", release_date=datetime.date.today())
5408.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'))
5409.         self.assertContains(response, '<th class="field-name">')
5410.         self.assertContains(response, '<td class="field-release_date nowrap">')
5411.         self.assertContains(response, '<td class="action-checkbox">')
5412. 
5413. 
5414. try:
5415.     import docutils
5416. except ImportError:
5417.     docutils = None
5418. 
5419. 
5420. @unittest.skipUnless(docutils, "no docutils installed.")
5421. @override_settings(ROOT_URLCONF='admin_views.urls')
5422. @modify_settings(INSTALLED_APPS={'append': ['django.contrib.admindocs', 'django.contrib.flatpages']})
5423. class AdminDocsTest(TestCase):
5424. 
5425.     @classmethod
5426.     def setUpTestData(cls):
5427.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5428. 
5429.     def setUp(self):
5430.         self.client.force_login(self.superuser)
5431. 
5432.     def test_tags(self):
5433.         response = self.client.get(reverse('django-admindocs-tags'))
5434. 
5435.         # The builtin tag group exists
5436.         self.assertContains(response, "<h2>Built-in tags</h2>", count=2, html=True)
5437. 
5438.         # A builtin tag exists in both the index and detail
5439.         self.assertContains(response, '<h3 id="built_in-autoescape">autoescape</h3>', html=True)
5440.         self.assertContains(response, '<li><a href="#built_in-autoescape">autoescape</a></li>', html=True)
5441. 
5442.         # An app tag exists in both the index and detail
5443.         self.assertContains(response, '<h3 id="flatpages-get_flatpages">get_flatpages</h3>', html=True)
5444.         self.assertContains(response, '<li><a href="#flatpages-get_flatpages">get_flatpages</a></li>', html=True)
5445. 
5446.         # The admin list tag group exists
5447.         self.assertContains(response, "<h2>admin_list</h2>", count=2, html=True)
5448. 
5449.         # An admin list tag exists in both the index and detail
5450.         self.assertContains(response, '<h3 id="admin_list-admin_actions">admin_actions</h3>', html=True)
5451.         self.assertContains(response, '<li><a href="#admin_list-admin_actions">admin_actions</a></li>', html=True)
5452. 
5453.     def test_filters(self):
5454.         response = self.client.get(reverse('django-admindocs-filters'))
5455. 
5456.         # The builtin filter group exists
5457.         self.assertContains(response, "<h2>Built-in filters</h2>", count=2, html=True)
5458. 
5459.         # A builtin filter exists in both the index and detail
5460.         self.assertContains(response, '<h3 id="built_in-add">add</h3>', html=True)
5461.         self.assertContains(response, '<li><a href="#built_in-add">add</a></li>', html=True)
5462. 
5463. 
5464. @override_settings(
5465.     ROOT_URLCONF='admin_views.urls',
5466.     TEMPLATES=[{
5467.         'BACKEND': 'django.template.backends.django.DjangoTemplates',
5468.         'APP_DIRS': True,
5469.         'OPTIONS': {
5470.             'context_processors': [
5471.                 'django.template.context_processors.debug',
5472.                 'django.template.context_processors.request',
5473.                 'django.contrib.auth.context_processors.auth',
5474.                 'django.contrib.messages.context_processors.messages',
5475.             ],
5476.         },
5477.     }],
5478.     USE_I18N=False,
5479. )
5480. class ValidXHTMLTests(TestCase):
5481. 
5482.     @classmethod
5483.     def setUpTestData(cls):
5484.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5485. 
5486.     def setUp(self):
5487.         self.client.force_login(self.superuser)
5488. 
5489.     def test_lang_name_present(self):
5490.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
5491.         self.assertNotContains(response, ' lang=""')
5492.         self.assertNotContains(response, ' xml:lang=""')
5493. 
5494. 
5495. @override_settings(ROOT_URLCONF='admin_views.urls', USE_THOUSAND_SEPARATOR=True, USE_L10N=True)
5496. class DateHierarchyTests(TestCase):
5497. 
5498.     @classmethod
5499.     def setUpTestData(cls):
5500.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5501. 
5502.     def setUp(self):
5503.         self.client.force_login(self.superuser)
5504. 
5505.     def assert_non_localized_year(self, response, year):
5506.         """
5507.         The year is not localized with USE_THOUSAND_SEPARATOR (#15234).
5508.         """
5509.         self.assertNotContains(response, formats.number_format(year))
5510. 
5511.     def assert_contains_year_link(self, response, date):
5512.         self.assertContains(response, '?release_date__year=%d"' % (date.year,))
5513. 
5514.     def assert_contains_month_link(self, response, date):
5515.         self.assertContains(
5516.             response, '?release_date__month=%d&amp;release_date__year=%d"' % (
5517.                 date.month, date.year))
5518. 
5519.     def assert_contains_day_link(self, response, date):
5520.         self.assertContains(
5521.             response, '?release_date__day=%d&amp;'
5522.             'release_date__month=%d&amp;release_date__year=%d"' % (
5523.                 date.day, date.month, date.year))
5524. 
5525.     def test_empty(self):
5526.         """
5527.         No date hierarchy links display with empty changelist.
5528.         """
5529.         response = self.client.get(
5530.             reverse('admin:admin_views_podcast_changelist'))
5531.         self.assertNotContains(response, 'release_date__year=')
5532.         self.assertNotContains(response, 'release_date__month=')
5533.         self.assertNotContains(response, 'release_date__day=')
5534. 
5535.     def test_single(self):
5536.         """
5537.         Single day-level date hierarchy appears for single object.
5538.         """
5539.         DATE = datetime.date(2000, 6, 30)
5540.         Podcast.objects.create(release_date=DATE)
5541.         url = reverse('admin:admin_views_podcast_changelist')
5542.         response = self.client.get(url)
5543.         self.assert_contains_day_link(response, DATE)
5544.         self.assert_non_localized_year(response, 2000)
5545. 
5546.     def test_within_month(self):
5547.         """
5548.         day-level links appear for changelist within single month.
5549.         """
5550.         DATES = (datetime.date(2000, 6, 30),
5551.                  datetime.date(2000, 6, 15),
5552.                  datetime.date(2000, 6, 3))
5553.         for date in DATES:
5554.             Podcast.objects.create(release_date=date)
5555.         url = reverse('admin:admin_views_podcast_changelist')
5556.         response = self.client.get(url)
5557.         for date in DATES:
5558.             self.assert_contains_day_link(response, date)
5559.         self.assert_non_localized_year(response, 2000)
5560. 
5561.     def test_within_year(self):
5562.         """
5563.         month-level links appear for changelist within single year.
5564.         """
5565.         DATES = (datetime.date(2000, 1, 30),
5566.                  datetime.date(2000, 3, 15),
5567.                  datetime.date(2000, 5, 3))
5568.         for date in DATES:
5569.             Podcast.objects.create(release_date=date)
5570.         url = reverse('admin:admin_views_podcast_changelist')
5571.         response = self.client.get(url)
5572.         # no day-level links
5573.         self.assertNotContains(response, 'release_date__day=')
5574.         for date in DATES:
5575.             self.assert_contains_month_link(response, date)
5576.         self.assert_non_localized_year(response, 2000)
5577. 
5578.     def test_multiple_years(self):
5579.         """
5580.         year-level links appear for year-spanning changelist.
5581.         """
5582.         DATES = (datetime.date(2001, 1, 30),
5583.                  datetime.date(2003, 3, 15),
5584.                  datetime.date(2005, 5, 3))
5585.         for date in DATES:
5586.             Podcast.objects.create(release_date=date)
5587.         response = self.client.get(
5588.             reverse('admin:admin_views_podcast_changelist'))
5589.         # no day/month-level links
5590.         self.assertNotContains(response, 'release_date__day=')
5591.         self.assertNotContains(response, 'release_date__month=')
5592.         for date in DATES:
5593.             self.assert_contains_year_link(response, date)
5594. 
5595.         # and make sure GET parameters still behave correctly
5596.         for date in DATES:
5597.             url = '%s?release_date__year=%d' % (
5598.                   reverse('admin:admin_views_podcast_changelist'),
5599.                   date.year)
5600.             response = self.client.get(url)
5601.             self.assert_contains_month_link(response, date)
5602.             self.assert_non_localized_year(response, 2000)
5603.             self.assert_non_localized_year(response, 2003)
5604.             self.assert_non_localized_year(response, 2005)
5605. 
5606.             url = '%s?release_date__year=%d&release_date__month=%d' % (
5607.                   reverse('admin:admin_views_podcast_changelist'),
5608.                   date.year, date.month)
5609.             response = self.client.get(url)
5610.             self.assert_contains_day_link(response, date)
5611.             self.assert_non_localized_year(response, 2000)
5612.             self.assert_non_localized_year(response, 2003)
5613.             self.assert_non_localized_year(response, 2005)
5614. 
5615.     def test_related_field(self):
5616.         questions_data = (
5617.             # (posted data, number of answers),
5618.             (datetime.date(2001, 1, 30), 0),
5619.             (datetime.date(2003, 3, 15), 1),
5620.             (datetime.date(2005, 5, 3), 2),
5621.         )
5622.         for date, answer_count in questions_data:
5623.             question = Question.objects.create(posted=date)
5624.             for i in range(answer_count):
5625.                 question.answer_set.create()
5626. 
5627.         response = self.client.get(reverse('admin:admin_views_answer_changelist'))
5628.         for date, answer_count in questions_data:
5629.             link = '?question__posted__year=%d"' % (date.year,)
5630.             if answer_count > 0:
5631.                 self.assertContains(response, link)
5632.             else:
5633.                 self.assertNotContains(response, link)
5634. 
5635. 
5636. @override_settings(ROOT_URLCONF='admin_views.urls')
5637. class AdminCustomSaveRelatedTests(TestCase):
5638.     """
5639.     One can easily customize the way related objects are saved.
5640.     Refs #16115.
5641.     """
5642. 
5643.     @classmethod
5644.     def setUpTestData(cls):
5645.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5646. 
5647.     def setUp(self):
5648.         self.client.force_login(self.superuser)
5649. 
5650.     def test_should_be_able_to_edit_related_objects_on_add_view(self):
5651.         post = {
5652.             'child_set-TOTAL_FORMS': '3',
5653.             'child_set-INITIAL_FORMS': '0',
5654.             'name': 'Josh Stone',
5655.             'child_set-0-name': 'Paul',
5656.             'child_set-1-name': 'Catherine',
5657.         }
5658.         self.client.post(reverse('admin:admin_views_parent_add'), post)
5659.         self.assertEqual(1, Parent.objects.count())
5660.         self.assertEqual(2, Child.objects.count())
5661. 
5662.         children_names = list(Child.objects.order_by('name').values_list('name', flat=True))
5663. 
5664.         self.assertEqual('Josh Stone', Parent.objects.latest('id').name)
5665.         self.assertEqual(['Catherine Stone', 'Paul Stone'], children_names)
5666. 
5667.     def test_should_be_able_to_edit_related_objects_on_change_view(self):
5668.         parent = Parent.objects.create(name='Josh Stone')
5669.         paul = Child.objects.create(parent=parent, name='Paul')
5670.         catherine = Child.objects.create(parent=parent, name='Catherine')
5671.         post = {
5672.             'child_set-TOTAL_FORMS': '5',
5673.             'child_set-INITIAL_FORMS': '2',
5674.             'name': 'Josh Stone',
5675.             'child_set-0-name': 'Paul',
5676.             'child_set-0-id': paul.id,
5677.             'child_set-1-name': 'Catherine',
5678.             'child_set-1-id': catherine.id,
5679.         }
5680.         self.client.post(reverse('admin:admin_views_parent_change', args=(parent.id,)), post)
5681. 
5682.         children_names = list(Child.objects.order_by('name').values_list('name', flat=True))
5683. 
5684.         self.assertEqual('Josh Stone', Parent.objects.latest('id').name)
5685.         self.assertEqual(['Catherine Stone', 'Paul Stone'], children_names)
5686. 
5687.     def test_should_be_able_to_edit_related_objects_on_changelist_view(self):
5688.         parent = Parent.objects.create(name='Josh Rock')
5689.         Child.objects.create(parent=parent, name='Paul')
5690.         Child.objects.create(parent=parent, name='Catherine')
5691.         post = {
5692.             'form-TOTAL_FORMS': '1',
5693.             'form-INITIAL_FORMS': '1',
5694.             'form-MAX_NUM_FORMS': '0',
5695.             'form-0-id': parent.id,
5696.             'form-0-name': 'Josh Stone',
5697.             '_save': 'Save'
5698.         }
5699. 
5700.         self.client.post(reverse('admin:admin_views_parent_changelist'), post)
5701.         children_names = list(Child.objects.order_by('name').values_list('name', flat=True))
5702. 
5703.         self.assertEqual('Josh Stone', Parent.objects.latest('id').name)
5704.         self.assertEqual(['Catherine Stone', 'Paul Stone'], children_names)
5705. 
5706. 
5707. @override_settings(ROOT_URLCONF='admin_views.urls')
5708. class AdminViewLogoutTests(TestCase):
5709. 
5710.     @classmethod
5711.     def setUpTestData(cls):
5712.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5713. 
5714.     def test_logout(self):
5715.         self.client.force_login(self.superuser)
5716.         response = self.client.get(reverse('admin:logout'))
5717.         self.assertEqual(response.status_code, 200)
5718.         self.assertTemplateUsed(response, 'registration/logged_out.html')
5719.         self.assertEqual(response.request['PATH_INFO'], reverse('admin:logout'))
5720.         self.assertFalse(response.context['has_permission'])
5721.         self.assertNotContains(response, 'user-tools')  # user-tools div shouldn't visible.
5722. 
5723.     def test_client_logout_url_can_be_used_to_login(self):
5724.         response = self.client.get(reverse('admin:logout'))
5725.         self.assertEqual(response.status_code, 302)  # we should be redirected to the login page.
5726. 
5727.         # follow the redirect and test results.
5728.         response = self.client.get(reverse('admin:logout'), follow=True)
5729.         self.assertEqual(response.status_code, 200)
5730.         self.assertTemplateUsed(response, 'admin/login.html')
5731.         self.assertEqual(response.request['PATH_INFO'], reverse('admin:login'))
5732.         self.assertContains(response, '<input type="hidden" name="next" value="%s">' % reverse('admin:index'))
5733. 
5734. 
5735. @override_settings(ROOT_URLCONF='admin_views.urls')
5736. class AdminUserMessageTest(TestCase):
5737. 
5738.     @classmethod
5739.     def setUpTestData(cls):
5740.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5741. 
5742.     def setUp(self):
5743.         self.client.force_login(self.superuser)
5744. 
5745.     def send_message(self, level):
5746.         """
5747.         Helper that sends a post to the dummy test methods and asserts that a
5748.         message with the level has appeared in the response.
5749.         """
5750.         action_data = {
5751.             ACTION_CHECKBOX_NAME: [1],
5752.             'action': 'message_%s' % level,
5753.             'index': 0,
5754.         }
5755. 
5756.         response = self.client.post(reverse('admin:admin_views_usermessenger_changelist'),
5757.                                     action_data, follow=True)
5758.         self.assertContains(response,
5759.                             '<li class="%s">Test %s</li>' % (level, level),
5760.                             html=True)
5761. 
5762.     @override_settings(MESSAGE_LEVEL=10)  # Set to DEBUG for this request
5763.     def test_message_debug(self):
5764.         self.send_message('debug')
5765. 
5766.     def test_message_info(self):
5767.         self.send_message('info')
5768. 
5769.     def test_message_success(self):
5770.         self.send_message('success')
5771. 
5772.     def test_message_warning(self):
5773.         self.send_message('warning')
5774. 
5775.     def test_message_error(self):
5776.         self.send_message('error')
5777. 
5778.     def test_message_extra_tags(self):
5779.         action_data = {
5780.             ACTION_CHECKBOX_NAME: [1],
5781.             'action': 'message_extra_tags',
5782.             'index': 0,
5783.         }
5784. 
5785.         response = self.client.post(reverse('admin:admin_views_usermessenger_changelist'),
5786.                                     action_data, follow=True)
5787.         self.assertContains(response,
5788.                             '<li class="extra_tag info">Test tags</li>',
5789.                             html=True)
5790. 
5791. 
5792. @override_settings(ROOT_URLCONF='admin_views.urls')
5793. class AdminKeepChangeListFiltersTests(TestCase):
5794.     admin_site = site
5795. 
5796.     @classmethod
5797.     def setUpTestData(cls):
5798.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5799.         cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
5800. 
5801.     def setUp(self):
5802.         self.client.force_login(self.superuser)
5803. 
5804.     def assertURLEqual(self, url1, url2, msg_prefix=''):
5805.         """
5806.         Assert that two URLs are equal despite the ordering
5807.         of their querystring. Refs #22360.
5808.         """
5809.         parsed_url1 = urlparse(url1)
5810.         path1 = parsed_url1.path
5811.         parsed_qs1 = dict(parse_qsl(parsed_url1.query))
5812. 
5813.         parsed_url2 = urlparse(url2)
5814.         path2 = parsed_url2.path
5815.         parsed_qs2 = dict(parse_qsl(parsed_url2.query))
5816. 
5817.         for parsed_qs in [parsed_qs1, parsed_qs2]:
5818.             if '_changelist_filters' in parsed_qs:
5819.                 changelist_filters = parsed_qs['_changelist_filters']
5820.                 parsed_filters = dict(parse_qsl(changelist_filters))
5821.                 parsed_qs['_changelist_filters'] = parsed_filters
5822. 
5823.         self.assertEqual(path1, path2)
5824.         self.assertEqual(parsed_qs1, parsed_qs2)
5825. 
5826.     def test_assert_url_equal(self):
5827.         # Test equality.
5828.         change_user_url = reverse('admin:auth_user_change', args=(self.joepublicuser.pk,))
5829.         self.assertURLEqual(
5830.             'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5831.                 change_user_url
5832.             ),
5833.             'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5834.                 change_user_url
5835.             )
5836.         )
5837. 
5838.         # Test inequality.
5839.         with self.assertRaises(AssertionError):
5840.             self.assertURLEqual(
5841.                 'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5842.                     change_user_url
5843.                 ),
5844.                 'http://testserver{}?_changelist_filters=is_staff__exact%3D1%26is_superuser__exact%3D1'.format(
5845.                     change_user_url
5846.                 )
5847.             )
5848. 
5849.         # Ignore scheme and host.
5850.         self.assertURLEqual(
5851.             'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5852.                 change_user_url
5853.             ),
5854.             '{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(change_user_url)
5855.         )
5856. 
5857.         # Ignore ordering of querystring.
5858.         self.assertURLEqual(
5859.             '{}?is_staff__exact=0&is_superuser__exact=0'.format(reverse('admin:auth_user_changelist')),
5860.             '{}?is_superuser__exact=0&is_staff__exact=0'.format(reverse('admin:auth_user_changelist'))
5861.         )
5862. 
5863.         # Ignore ordering of _changelist_filters.
5864.         self.assertURLEqual(
5865.             '{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(change_user_url),
5866.             '{}?_changelist_filters=is_superuser__exact%3D0%26is_staff__exact%3D0'.format(change_user_url)
5867.         )
5868. 
5869.     def get_changelist_filters(self):
5870.         return {
5871.             'is_superuser__exact': 0,
5872.             'is_staff__exact': 0,
5873.         }
5874. 
5875.     def get_changelist_filters_querystring(self):
5876.         return urlencode(self.get_changelist_filters())
5877. 
5878.     def get_preserved_filters_querystring(self):
5879.         return urlencode({
5880.             '_changelist_filters': self.get_changelist_filters_querystring()
5881.         })
5882. 
5883.     def get_sample_user_id(self):
5884.         return self.joepublicuser.pk
5885. 
5886.     def get_changelist_url(self):
5887.         return '%s?%s' % (
5888.             reverse('admin:auth_user_changelist',
5889.                     current_app=self.admin_site.name),
5890.             self.get_changelist_filters_querystring(),
5891.         )
5892. 
5893.     def get_add_url(self):
5894.         return '%s?%s' % (
5895.             reverse('admin:auth_user_add',
5896.                     current_app=self.admin_site.name),
5897.             self.get_preserved_filters_querystring(),
5898.         )
5899. 
5900.     def get_change_url(self, user_id=None):
5901.         if user_id is None:
5902.             user_id = self.get_sample_user_id()
5903.         return "%s?%s" % (
5904.             reverse('admin:auth_user_change', args=(user_id,),
5905.                     current_app=self.admin_site.name),
5906.             self.get_preserved_filters_querystring(),
5907.         )
5908. 
5909.     def get_history_url(self, user_id=None):
5910.         if user_id is None:
5911.             user_id = self.get_sample_user_id()
5912.         return "%s?%s" % (
5913.             reverse('admin:auth_user_history', args=(user_id,),
5914.                     current_app=self.admin_site.name),
5915.             self.get_preserved_filters_querystring(),
5916.         )
5917. 
5918.     def get_delete_url(self, user_id=None):
5919.         if user_id is None:
5920.             user_id = self.get_sample_user_id()
5921.         return "%s?%s" % (
5922.             reverse('admin:auth_user_delete', args=(user_id,),
5923.                     current_app=self.admin_site.name),
5924.             self.get_preserved_filters_querystring(),
5925.         )
5926. 
5927.     def test_changelist_view(self):
5928.         response = self.client.get(self.get_changelist_url())
5929.         self.assertEqual(response.status_code, 200)
5930. 
5931.         # Check the `change_view` link has the correct querystring.
5932.         detail_link = re.search(
5933.             '<a href="(.*?)">{}</a>'.format(self.joepublicuser.username),
5934.             response.content.decode()
5935.         )
5936.         self.assertURLEqual(detail_link.group(1), self.get_change_url())
5937. 
5938.     def test_change_view(self):
5939.         # Get the `change_view`.
5940.         response = self.client.get(self.get_change_url())
5941.         self.assertEqual(response.status_code, 200)
5942. 
5943.         # Check the form action.
5944.         form_action = re.search(
5945.             '<form action="(.*?)" method="post" id="user_form".*?>',
5946.             response.content.decode()
5947.         )
5948.         self.assertURLEqual(form_action.group(1), '?%s' % self.get_preserved_filters_querystring())
5949. 
5950.         # Check the history link.
5951.         history_link = re.search(
5952.             '<a href="(.*?)" class="historylink">History</a>',
5953.             response.content.decode()
5954.         )
5955.         self.assertURLEqual(history_link.group(1), self.get_history_url())
5956. 
5957.         # Check the delete link.
5958.         delete_link = re.search(
5959.             '<a href="(.*?)" class="deletelink">Delete</a>',
5960.             response.content.decode()
5961.         )
5962.         self.assertURLEqual(delete_link.group(1), self.get_delete_url())
5963. 
5964.         # Test redirect on "Save".
5965.         post_data = {
5966.             'username': 'joepublic',
5967.             'last_login_0': '2007-05-30',
5968.             'last_login_1': '13:20:10',
5969.             'date_joined_0': '2007-05-30',
5970.             'date_joined_1': '13:20:10',
5971.         }
5972. 
5973.         post_data['_save'] = 1
5974.         response = self.client.post(self.get_change_url(), data=post_data)
5975.         self.assertRedirects(response, self.get_changelist_url())
5976.         post_data.pop('_save')
5977. 
5978.         # Test redirect on "Save and continue".
5979.         post_data['_continue'] = 1
5980.         response = self.client.post(self.get_change_url(), data=post_data)
5981.         self.assertRedirects(response, self.get_change_url())
5982.         post_data.pop('_continue')
5983. 
5984.         # Test redirect on "Save and add new".
5985.         post_data['_addanother'] = 1
5986.         response = self.client.post(self.get_change_url(), data=post_data)
5987.         self.assertRedirects(response, self.get_add_url())
5988.         post_data.pop('_addanother')
5989. 
5990.     def test_add_view(self):
5991.         # Get the `add_view`.
5992.         response = self.client.get(self.get_add_url())
5993.         self.assertEqual(response.status_code, 200)
5994. 
5995.         # Check the form action.
5996.         form_action = re.search(
5997.             '<form action="(.*?)" method="post" id="user_form".*?>',
5998.             response.content.decode()
5999.         )
6000.         self.assertURLEqual(form_action.group(1), '?%s' % self.get_preserved_filters_querystring())
6001. 
6002.         post_data = {
6003.             'username': 'dummy',
6004.             'password1': 'test',
6005.             'password2': 'test',
6006.         }
6007. 
6008.         # Test redirect on "Save".
6009.         post_data['_save'] = 1
6010.         response = self.client.post(self.get_add_url(), data=post_data)
6011.         self.assertRedirects(response, self.get_change_url(User.objects.get(username='dummy').pk))
6012.         post_data.pop('_save')
6013. 
6014.         # Test redirect on "Save and continue".
6015.         post_data['username'] = 'dummy2'
6016.         post_data['_continue'] = 1
6017.         response = self.client.post(self.get_add_url(), data=post_data)
6018.         self.assertRedirects(response, self.get_change_url(User.objects.get(username='dummy2').pk))
6019.         post_data.pop('_continue')
6020. 
6021.         # Test redirect on "Save and add new".
6022.         post_data['username'] = 'dummy3'
6023.         post_data['_addanother'] = 1
6024.         response = self.client.post(self.get_add_url(), data=post_data)
6025.         self.assertRedirects(response, self.get_add_url())
6026.         post_data.pop('_addanother')
6027. 
6028.     def test_delete_view(self):
6029.         # Test redirect on "Delete".
6030.         response = self.client.post(self.get_delete_url(), {'post': 'yes'})
6031.         self.assertRedirects(response, self.get_changelist_url())
6032. 
6033.     def test_url_prefix(self):
6034.         context = {
6035.             'preserved_filters': self.get_preserved_filters_querystring(),
6036.             'opts': User._meta,
6037.         }
6038.         prefixes = ('', '/prefix/', '/後台/')
6039.         for prefix in prefixes:
6040.             with self.subTest(prefix=prefix), override_script_prefix(prefix):
6041.                 url = reverse('admin:auth_user_changelist', current_app=self.admin_site.name)
6042.                 self.assertURLEqual(
6043.                     self.get_changelist_url(),
6044.                     add_preserved_filters(context, url),
6045.                 )
6046. 
6047. 
6048. class NamespacedAdminKeepChangeListFiltersTests(AdminKeepChangeListFiltersTests):
6049.     admin_site = site2

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 18:54:11,863 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of `tests/admin_views/tests.py`.\n   - Given the file's large size, the user specified a fallback to include tests for `get_list_display`, `get_readonly_fields`, and `get_queryset`.\n2. Extended relevance:\n   - This entire file is relevant as it contains all the tests. Providing the whole file in a single context block directly answers the primary query.", relative_path='tests/admin_views/tests.py', start_line=1, end_line=6050)]
2025-12-24 18:54:11,874 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of tests/admin_views/tests.py.
2025-12-24 18:54:11,874 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 18:54:11,874 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 18:54:11,875 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-24 18:54:11,875 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-24 18:54:11,876 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   └── with_last_login_attr.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_remote_user_deprecation.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   ├── test_file_charset.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_deprecated_features.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   └── test_tree.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   ├── debug
    |   |   |   ├── template_error.html
    |   |   |   └── template_exception.html
    |   |   ├── jsi18n-multi-catalogs.html
    |   |   └── jsi18n.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.

Description: Description
	
add ModelAdmin.get_inlines() hook to allow set inlines based on the request or model instance.
Currently, We can override the method get_inline_instances to do such a thing, but a for loop should be copied to my code. So I wished add a hook get_inlines(request, obj=None)

Patch information:
diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py
index 5e7b23f9a0..023d30c1fb 100644
--- a/django/contrib/admin/options.py
+++ b/django/contrib/admin/options.py
@@ -580,9 +580,16 @@ class ModelAdmin(BaseModelAdmin):
     def __str__(self):
         return "%s.%s" % (self.model._meta.app_label, self.__class__.__name__)
 
+    def get_inlines(self, request, obj=None):
+        """
+        Hook for specifying the InlineModelAdmin classes to use.
+        Return a list or tuple of InlineModelAdmin classes.
+        """
+        return self.inlines
+
     def get_inline_instances(self, request, obj=None):
         inline_instances = []
-        for inline_class in self.inlines:
+        for inline_class in self.get_inlines(request, obj):
             inline = inline_class(self.model, self.admin_site)
             if request:
                 if not (inline.has_view_or_change_permission(request, obj) or
diff --git a/docs/ref/contrib/admin/index.txt b/docs/ref/contrib/admin/index.txt
index 93679c46fd..a6f3e5d519 100644
--- a/docs/ref/contrib/admin/index.txt
+++ b/docs/ref/contrib/admin/index.txt
@@ -1608,24 +1608,35 @@ templates used by the :class:`ModelAdmin` views:
             def get_sortable_by(self, request):
                 return {*self.get_list_display(request)} - {'rank'}
 
-.. method:: ModelAdmin.get_inline_instances(request, obj=None)
+.. method:: ModelAdmin.get_inlines(request, obj=None)
 
-    The ``get_inline_instances`` method is given the ``HttpRequest`` and the
-    ``obj`` being edited (or ``None`` on an add form) and is expected to return
-    a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
-    objects, as described below in the :class:`~django.contrib.admin.InlineModelAdmin`
-    section. For example, the following would return inlines without the default
-    filtering based on add, change, delete, and view permissions::
+    Return a ``list`` or ``tuple`` of :class:`~django.contrib.admin.InlineModelAdmin`
+    classes to use for the given ``request`` and the ``obj`` being edited (or
+    ``None`` on an add form). By default, this returns :attr:`inlines`. Override
+    this method to choose inlines based on the current request or object::
 
         class MyModelAdmin(admin.ModelAdmin):
-            inlines = (MyInline,)
+            inlines = (MyInline, OtherInline)
+
+            def get_inlines(self, request, obj=None):
+                if obj is None:
+                    return (MyInline,)
+                return (MyInline, OtherInline)
 
-            def get_inline_instances(self, request, obj=None):
-                return [inline(self.model, self.admin_site) for inline in self.inlines]
+    If you override this method, make sure that the returned classes are also
+    listed in :attr:`inlines` or you might encounter a "Bad Request" error when
+    adding related objects.
+
+.. method:: ModelAdmin.get_inline_instances(request, obj=None)
 
-    If you override this method, make sure that the returned inlines are
-    instances of the classes defined in :attr:`inlines` or you might encounter
-    a "Bad Request" error when adding related objects.
+    Given the ``HttpRequest`` and the ``obj`` being edited (or ``None`` on an
+    add form), return a ``list`` or ``tuple`` of instantiated
+    :class:`~django.contrib.admin.InlineModelAdmin` objects. The base
+    implementation instantiates the classes returned by
+    :meth:`get_inlines` and applies the default filtering based on add,
+    change, delete, and view permissions. To customize which inlines are
+    displayed for a given request or object, override :meth:`get_inlines`
+    rather than this method.
 
 .. method:: ModelAdmin.get_urls()
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of tests/admin_inlines/tests.py.
Extra Requirements: 
Purpose: I need to find existing test cases that demonstrate how to test customizable hooks on ModelAdmin, which will serve as a pattern for testing the new `get_inlines` method.

Previous refined query 2:
Essential Query: Please provide the full content of tests/admin_views/tests.py.
Extra Requirements: If the file is too large, please include at least tests for `get_list_display`, `get_readonly_fields`, and `get_queryset`.
Purpose: I need to find test cases for `ModelAdmin` hooks that are dependent on the HTTP request, which will serve as a template for testing the new `get_inlines` method.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/admin_inlines/tests.py
Line number range: 1 - 500
Content:
1. from django.contrib.admin import ModelAdmin, TabularInline
2. from django.contrib.admin.helpers import InlineAdminForm
3. from django.contrib.admin.tests import AdminSeleniumTestCase
4. from django.contrib.auth.models import Permission, User
5. from django.contrib.contenttypes.models import ContentType
6. from django.test import RequestFactory, TestCase, override_settings
7. from django.urls import reverse
8. 
9. from .admin import InnerInline, site as admin_site
10. from .models import (
11.     Author, BinaryTree, Book, Chapter, Child, ChildModel1, ChildModel2,
12.     Fashionista, FootNote, Holder, Holder2, Holder3, Holder4, Inner, Inner2,
13.     Inner3, Inner4Stacked, Inner4Tabular, Novel, OutfitItem, Parent,
14.     ParentModelWithCustomPk, Person, Poll, Profile, ProfileCollection,
15.     Question, Sighting, SomeChildModel, SomeParentModel, Teacher,
16. )
17. 
18. INLINE_CHANGELINK_HTML = 'class="inlinechangelink">Change</a>'
19. 
20. 
21. class TestDataMixin:
22. 
23.     @classmethod
24.     def setUpTestData(cls):
25.         cls.superuser = User.objects.create_superuser(username='super', email='super@example.com', password='secret')
26. 
27. 
28. @override_settings(ROOT_URLCONF='admin_inlines.urls')
29. class TestInline(TestDataMixin, TestCase):
30.     factory = RequestFactory()
31. 
32.     @classmethod
33.     def setUpTestData(cls):
34.         super().setUpTestData()
35.         cls.holder = Holder.objects.create(dummy=13)
36.         Inner.objects.create(dummy=42, holder=cls.holder)
37. 
38.     def setUp(self):
39.         self.client.force_login(self.superuser)
40. 
41.     def test_can_delete(self):
42.         """
43.         can_delete should be passed to inlineformset factory.
44.         """
45.         response = self.client.get(
46.             reverse('admin:admin_inlines_holder_change', args=(self.holder.id,))
47.         )
48.         inner_formset = response.context['inline_admin_formsets'][0].formset
49.         expected = InnerInline.can_delete
50.         actual = inner_formset.can_delete
51.         self.assertEqual(expected, actual, 'can_delete must be equal')
52. 
53.     def test_readonly_stacked_inline_label(self):
54.         """Bug #13174."""
55.         holder = Holder.objects.create(dummy=42)
56.         Inner.objects.create(holder=holder, dummy=42, readonly='')
57.         response = self.client.get(
58.             reverse('admin:admin_inlines_holder_change', args=(holder.id,))
59.         )
60.         self.assertContains(response, '<label>Inner readonly label:</label>')
61. 
62.     def test_many_to_many_inlines(self):
63.         "Autogenerated many-to-many inlines are displayed correctly (#13407)"
64.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
65.         # The heading for the m2m inline block uses the right text
66.         self.assertContains(response, '<h2>Author-book relationships</h2>')
67.         # The "add another" label is correct
68.         self.assertContains(response, 'Add another Author-book relationship')
69.         # The '+' is dropped from the autogenerated form prefix (Author_books+)
70.         self.assertContains(response, 'id="id_Author_books-TOTAL_FORMS"')
71. 
72.     def test_inline_primary(self):
73.         person = Person.objects.create(firstname='Imelda')
74.         item = OutfitItem.objects.create(name='Shoes')
75.         # Imelda likes shoes, but can't carry her own bags.
76.         data = {
77.             'shoppingweakness_set-TOTAL_FORMS': 1,
78.             'shoppingweakness_set-INITIAL_FORMS': 0,
79.             'shoppingweakness_set-MAX_NUM_FORMS': 0,
80.             '_save': 'Save',
81.             'person': person.id,
82.             'max_weight': 0,
83.             'shoppingweakness_set-0-item': item.id,
84.         }
85.         response = self.client.post(reverse('admin:admin_inlines_fashionista_add'), data)
86.         self.assertEqual(response.status_code, 302)
87.         self.assertEqual(len(Fashionista.objects.filter(person__firstname='Imelda')), 1)
88. 
89.     def test_tabular_inline_column_css_class(self):
90.         """
91.         Field names are included in the context to output a field-specific
92.         CSS class name in the column headers.
93.         """
94.         response = self.client.get(reverse('admin:admin_inlines_poll_add'))
95.         text_field, call_me_field = list(response.context['inline_admin_formset'].fields())
96.         # Editable field.
97.         self.assertEqual(text_field['name'], 'text')
98.         self.assertContains(response, '<th class="column-text required">')
99.         # Read-only field.
100.         self.assertEqual(call_me_field['name'], 'call_me')
101.         self.assertContains(response, '<th class="column-call_me">')
102. 
103.     def test_custom_form_tabular_inline_label(self):
104.         """
105.         A model form with a form field specified (TitleForm.title1) should have
106.         its label rendered in the tabular inline.
107.         """
108.         response = self.client.get(reverse('admin:admin_inlines_titlecollection_add'))
109.         self.assertContains(response, '<th class="column-title1 required">Title1</th>', html=True)
110. 
111.     def test_custom_form_tabular_inline_overridden_label(self):
112.         """
113.         SomeChildModelForm.__init__() overrides the label of a form field.
114.         That label is displayed in the TabularInline.
115.         """
116.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_add'))
117.         field = list(response.context['inline_admin_formset'].fields())[0]
118.         self.assertEqual(field['label'], 'new label')
119.         self.assertContains(response, '<th class="column-name required">New label</th>', html=True)
120. 
121.     def test_tabular_non_field_errors(self):
122.         """
123.         non_field_errors are displayed correctly, including the correct value
124.         for colspan.
125.         """
126.         data = {
127.             'title_set-TOTAL_FORMS': 1,
128.             'title_set-INITIAL_FORMS': 0,
129.             'title_set-MAX_NUM_FORMS': 0,
130.             '_save': 'Save',
131.             'title_set-0-title1': 'a title',
132.             'title_set-0-title2': 'a different title',
133.         }
134.         response = self.client.post(reverse('admin:admin_inlines_titlecollection_add'), data)
135.         # Here colspan is "4": two fields (title1 and title2), one hidden field and the delete checkbox.
136.         self.assertContains(
137.             response,
138.             '<tr><td colspan="4"><ul class="errorlist nonfield">'
139.             '<li>The two titles must be the same</li></ul></td></tr>'
140.         )
141. 
142.     def test_no_parent_callable_lookup(self):
143.         """Admin inline `readonly_field` shouldn't invoke parent ModelAdmin callable"""
144.         # Identically named callable isn't present in the parent ModelAdmin,
145.         # rendering of the add view shouldn't explode
146.         response = self.client.get(reverse('admin:admin_inlines_novel_add'))
147.         self.assertEqual(response.status_code, 200)
148.         # View should have the child inlines section
149.         self.assertContains(
150.             response,
151.             '<div class="js-inline-admin-formset inline-group" id="chapter_set-group"'
152.         )
153. 
154.     def test_callable_lookup(self):
155.         """Admin inline should invoke local callable when its name is listed in readonly_fields"""
156.         response = self.client.get(reverse('admin:admin_inlines_poll_add'))
157.         self.assertEqual(response.status_code, 200)
158.         # Add parent object view should have the child inlines section
159.         self.assertContains(
160.             response,
161.             '<div class="js-inline-admin-formset inline-group" id="question_set-group"'
162.         )
163.         # The right callable should be used for the inline readonly_fields
164.         # column cells
165.         self.assertContains(response, '<p>Callable in QuestionInline</p>')
166. 
167.     def test_help_text(self):
168.         """
169.         The inlines' model field help texts are displayed when using both the
170.         stacked and tabular layouts.
171.         """
172.         response = self.client.get(reverse('admin:admin_inlines_holder4_add'))
173.         self.assertContains(response, '<div class="help">Awesome stacked help text is awesome.</div>', 4)
174.         self.assertContains(
175.             response,
176.             '<img src="/static/admin/img/icon-unknown.svg" '
177.             'class="help help-tooltip" width="10" height="10" '
178.             'alt="(Awesome tabular help text is awesome.)" '
179.             'title="Awesome tabular help text is awesome.">',
180.             1
181.         )
182.         # ReadOnly fields
183.         response = self.client.get(reverse('admin:admin_inlines_capofamiglia_add'))
184.         self.assertContains(
185.             response,
186.             '<img src="/static/admin/img/icon-unknown.svg" '
187.             'class="help help-tooltip" width="10" height="10" '
188.             'alt="(Help text for ReadOnlyInline)" '
189.             'title="Help text for ReadOnlyInline">',
190.             1
191.         )
192. 
193.     def test_tabular_model_form_meta_readonly_field(self):
194.         """
195.         Tabular inlines use ModelForm.Meta.help_texts and labels for read-only
196.         fields.
197.         """
198.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_add'))
199.         self.assertContains(
200.             response,
201.             '<img src="/static/admin/img/icon-unknown.svg" '
202.             'class="help help-tooltip" width="10" height="10" '
203.             'alt="(Help text from ModelForm.Meta)" '
204.             'title="Help text from ModelForm.Meta">'
205.         )
206.         self.assertContains(response, 'Label from ModelForm.Meta')
207. 
208.     def test_inline_hidden_field_no_column(self):
209.         """#18263 -- Make sure hidden fields don't get a column in tabular inlines"""
210.         parent = SomeParentModel.objects.create(name='a')
211.         SomeChildModel.objects.create(name='b', position='0', parent=parent)
212.         SomeChildModel.objects.create(name='c', position='1', parent=parent)
213.         response = self.client.get(reverse('admin:admin_inlines_someparentmodel_change', args=(parent.pk,)))
214.         self.assertNotContains(response, '<td class="field-position">')
215.         self.assertInHTML(
216.             '<input id="id_somechildmodel_set-1-position" '
217.             'name="somechildmodel_set-1-position" type="hidden" value="1">',
218.             response.rendered_content,
219.         )
220. 
221.     def test_non_related_name_inline(self):
222.         """
223.         Multiple inlines with related_name='+' have correct form prefixes.
224.         """
225.         response = self.client.get(reverse('admin:admin_inlines_capofamiglia_add'))
226.         self.assertContains(response, '<input type="hidden" name="-1-0-id" id="id_-1-0-id">', html=True)
227.         self.assertContains(
228.             response,
229.             '<input type="hidden" name="-1-0-capo_famiglia" id="id_-1-0-capo_famiglia">',
230.             html=True
231.         )
232.         self.assertContains(
233.             response,
234.             '<input id="id_-1-0-name" type="text" class="vTextField" name="-1-0-name" maxlength="100">',
235.             html=True
236.         )
237.         self.assertContains(response, '<input type="hidden" name="-2-0-id" id="id_-2-0-id">', html=True)
238.         self.assertContains(
239.             response,
240.             '<input type="hidden" name="-2-0-capo_famiglia" id="id_-2-0-capo_famiglia">',
241.             html=True
242.         )
243.         self.assertContains(
244.             response,
245.             '<input id="id_-2-0-name" type="text" class="vTextField" name="-2-0-name" maxlength="100">',
246.             html=True
247.         )
248. 
249.     @override_settings(USE_L10N=True, USE_THOUSAND_SEPARATOR=True)
250.     def test_localize_pk_shortcut(self):
251.         """
252.         The "View on Site" link is correct for locales that use thousand
253.         separators.
254.         """
255.         holder = Holder.objects.create(pk=123456789, dummy=42)
256.         inner = Inner.objects.create(pk=987654321, holder=holder, dummy=42, readonly='')
257.         response = self.client.get(reverse('admin:admin_inlines_holder_change', args=(holder.id,)))
258.         inner_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(inner).pk, inner.pk)
259.         self.assertContains(response, inner_shortcut)
260. 
261.     def test_custom_pk_shortcut(self):
262.         """
263.         The "View on Site" link is correct for models with a custom primary key
264.         field.
265.         """
266.         parent = ParentModelWithCustomPk.objects.create(my_own_pk="foo", name="Foo")
267.         child1 = ChildModel1.objects.create(my_own_pk="bar", name="Bar", parent=parent)
268.         child2 = ChildModel2.objects.create(my_own_pk="baz", name="Baz", parent=parent)
269.         response = self.client.get(reverse('admin:admin_inlines_parentmodelwithcustompk_change', args=('foo',)))
270.         child1_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(child1).pk, child1.pk)
271.         child2_shortcut = 'r/%s/%s/' % (ContentType.objects.get_for_model(child2).pk, child2.pk)
272.         self.assertContains(response, child1_shortcut)
273.         self.assertContains(response, child2_shortcut)
274. 
275.     def test_create_inlines_on_inherited_model(self):
276.         """
277.         An object can be created with inlines when it inherits another class.
278.         """
279.         data = {
280.             'name': 'Martian',
281.             'sighting_set-TOTAL_FORMS': 1,
282.             'sighting_set-INITIAL_FORMS': 0,
283.             'sighting_set-MAX_NUM_FORMS': 0,
284.             'sighting_set-0-place': 'Zone 51',
285.             '_save': 'Save',
286.         }
287.         response = self.client.post(reverse('admin:admin_inlines_extraterrestrial_add'), data)
288.         self.assertEqual(response.status_code, 302)
289.         self.assertEqual(Sighting.objects.filter(et__name='Martian').count(), 1)
290. 
291.     def test_custom_get_extra_form(self):
292.         bt_head = BinaryTree.objects.create(name="Tree Head")
293.         BinaryTree.objects.create(name="First Child", parent=bt_head)
294.         # The maximum number of forms should respect 'get_max_num' on the
295.         # ModelAdmin
296.         max_forms_input = (
297.             '<input id="id_binarytree_set-MAX_NUM_FORMS" '
298.             'name="binarytree_set-MAX_NUM_FORMS" type="hidden" value="%d">'
299.         )
300.         # The total number of forms will remain the same in either case
301.         total_forms_hidden = (
302.             '<input id="id_binarytree_set-TOTAL_FORMS" '
303.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="2">'
304.         )
305.         response = self.client.get(reverse('admin:admin_inlines_binarytree_add'))
306.         self.assertInHTML(max_forms_input % 3, response.rendered_content)
307.         self.assertInHTML(total_forms_hidden, response.rendered_content)
308. 
309.         response = self.client.get(reverse('admin:admin_inlines_binarytree_change', args=(bt_head.id,)))
310.         self.assertInHTML(max_forms_input % 2, response.rendered_content)
311.         self.assertInHTML(total_forms_hidden, response.rendered_content)
312. 
313.     def test_min_num(self):
314.         """
315.         min_num and extra determine number of forms.
316.         """
317.         class MinNumInline(TabularInline):
318.             model = BinaryTree
319.             min_num = 2
320.             extra = 3
321. 
322.         modeladmin = ModelAdmin(BinaryTree, admin_site)
323.         modeladmin.inlines = [MinNumInline]
324.         min_forms = (
325.             '<input id="id_binarytree_set-MIN_NUM_FORMS" '
326.             'name="binarytree_set-MIN_NUM_FORMS" type="hidden" value="2">'
327.         )
328.         total_forms = (
329.             '<input id="id_binarytree_set-TOTAL_FORMS" '
330.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="5">'
331.         )
332.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_add'))
333.         request.user = User(username='super', is_superuser=True)
334.         response = modeladmin.changeform_view(request)
335.         self.assertInHTML(min_forms, response.rendered_content)
336.         self.assertInHTML(total_forms, response.rendered_content)
337. 
338.     def test_custom_min_num(self):
339.         bt_head = BinaryTree.objects.create(name="Tree Head")
340.         BinaryTree.objects.create(name="First Child", parent=bt_head)
341. 
342.         class MinNumInline(TabularInline):
343.             model = BinaryTree
344.             extra = 3
345. 
346.             def get_min_num(self, request, obj=None, **kwargs):
347.                 if obj:
348.                     return 5
349.                 return 2
350. 
351.         modeladmin = ModelAdmin(BinaryTree, admin_site)
352.         modeladmin.inlines = [MinNumInline]
353.         min_forms = (
354.             '<input id="id_binarytree_set-MIN_NUM_FORMS" '
355.             'name="binarytree_set-MIN_NUM_FORMS" type="hidden" value="%d">'
356.         )
357.         total_forms = (
358.             '<input id="id_binarytree_set-TOTAL_FORMS" '
359.             'name="binarytree_set-TOTAL_FORMS" type="hidden" value="%d">'
360.         )
361.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_add'))
362.         request.user = User(username='super', is_superuser=True)
363.         response = modeladmin.changeform_view(request)
364.         self.assertInHTML(min_forms % 2, response.rendered_content)
365.         self.assertInHTML(total_forms % 5, response.rendered_content)
366. 
367.         request = self.factory.get(reverse('admin:admin_inlines_binarytree_change', args=(bt_head.id,)))
368.         request.user = User(username='super', is_superuser=True)
369.         response = modeladmin.changeform_view(request, object_id=str(bt_head.id))
370.         self.assertInHTML(min_forms % 5, response.rendered_content)
371.         self.assertInHTML(total_forms % 8, response.rendered_content)
372. 
373.     def test_inline_nonauto_noneditable_pk(self):
374.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
375.         self.assertContains(
376.             response,
377.             '<input id="id_nonautopkbook_set-0-rand_pk" '
378.             'name="nonautopkbook_set-0-rand_pk" type="hidden">',
379.             html=True
380.         )
381.         self.assertContains(
382.             response,
383.             '<input id="id_nonautopkbook_set-2-0-rand_pk" '
384.             'name="nonautopkbook_set-2-0-rand_pk" type="hidden">',
385.             html=True
386.         )
387. 
388.     def test_inline_nonauto_noneditable_inherited_pk(self):
389.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
390.         self.assertContains(
391.             response,
392.             '<input id="id_nonautopkbookchild_set-0-nonautopkbook_ptr" '
393.             'name="nonautopkbookchild_set-0-nonautopkbook_ptr" type="hidden">',
394.             html=True
395.         )
396.         self.assertContains(
397.             response,
398.             '<input id="id_nonautopkbookchild_set-2-nonautopkbook_ptr" '
399.             'name="nonautopkbookchild_set-2-nonautopkbook_ptr" type="hidden">',
400.             html=True
401.         )
402. 
403.     def test_inline_editable_pk(self):
404.         response = self.client.get(reverse('admin:admin_inlines_author_add'))
405.         self.assertContains(
406.             response,
407.             '<input class="vIntegerField" id="id_editablepkbook_set-0-manual_pk" '
408.             'name="editablepkbook_set-0-manual_pk" type="number">',
409.             html=True, count=1
410.         )
411.         self.assertContains(
412.             response,
413.             '<input class="vIntegerField" id="id_editablepkbook_set-2-0-manual_pk" '
414.             'name="editablepkbook_set-2-0-manual_pk" type="number">',
415.             html=True, count=1
416.         )
417. 
418.     def test_stacked_inline_edit_form_contains_has_original_class(self):
419.         holder = Holder.objects.create(dummy=1)
420.         holder.inner_set.create(dummy=1)
421.         response = self.client.get(reverse('admin:admin_inlines_holder_change', args=(holder.pk,)))
422.         self.assertContains(
423.             response,
424.             '<div class="inline-related has_original" id="inner_set-0">',
425.             count=1
426.         )
427.         self.assertContains(
428.             response,
429.             '<div class="inline-related" id="inner_set-1">',
430.             count=1
431.         )
432. 
433.     def test_inlines_show_change_link_registered(self):
434.         "Inlines `show_change_link` for registered models when enabled."
435.         holder = Holder4.objects.create(dummy=1)
436.         item1 = Inner4Stacked.objects.create(dummy=1, holder=holder)
437.         item2 = Inner4Tabular.objects.create(dummy=1, holder=holder)
438.         items = (
439.             ('inner4stacked', item1.pk),
440.             ('inner4tabular', item2.pk),
441.         )
442.         response = self.client.get(reverse('admin:admin_inlines_holder4_change', args=(holder.pk,)))
443.         self.assertTrue(response.context['inline_admin_formset'].opts.has_registered_model)
444.         for model, pk in items:
445.             url = reverse('admin:admin_inlines_%s_change' % model, args=(pk,))
446.             self.assertContains(response, '<a href="%s" %s' % (url, INLINE_CHANGELINK_HTML))
447. 
448.     def test_inlines_show_change_link_unregistered(self):
449.         "Inlines `show_change_link` disabled for unregistered models."
450.         parent = ParentModelWithCustomPk.objects.create(my_own_pk="foo", name="Foo")
451.         ChildModel1.objects.create(my_own_pk="bar", name="Bar", parent=parent)
452.         ChildModel2.objects.create(my_own_pk="baz", name="Baz", parent=parent)
453.         response = self.client.get(reverse('admin:admin_inlines_parentmodelwithcustompk_change', args=('foo',)))
454.         self.assertFalse(response.context['inline_admin_formset'].opts.has_registered_model)
455.         self.assertNotContains(response, INLINE_CHANGELINK_HTML)
456. 
457.     def test_tabular_inline_show_change_link_false_registered(self):
458.         "Inlines `show_change_link` disabled by default."
459.         poll = Poll.objects.create(name="New poll")
460.         Question.objects.create(poll=poll)
461.         response = self.client.get(reverse('admin:admin_inlines_poll_change', args=(poll.pk,)))
462.         self.assertTrue(response.context['inline_admin_formset'].opts.has_registered_model)
463.         self.assertNotContains(response, INLINE_CHANGELINK_HTML)
464. 
465.     def test_noneditable_inline_has_field_inputs(self):
466.         """Inlines without change permission shows field inputs on add form."""
467.         response = self.client.get(reverse('admin:admin_inlines_novelreadonlychapter_add'))
468.         self.assertContains(
469.             response,
470.             '<input type="text" name="chapter_set-0-name" '
471.             'class="vTextField" maxlength="40" id="id_chapter_set-0-name">',
472.             html=True
473.         )
474. 
475. 
476. @override_settings(ROOT_URLCONF='admin_inlines.urls')
477. class TestInlineMedia(TestDataMixin, TestCase):
478. 
479.     def setUp(self):
480.         self.client.force_login(self.superuser)
481. 
482.     def test_inline_media_only_base(self):
483.         holder = Holder(dummy=13)
484.         holder.save()
485.         Inner(dummy=42, holder=holder).save()
486.         change_url = reverse('admin:admin_inlines_holder_change', args=(holder.id,))
487.         response = self.client.get(change_url)
488.         self.assertContains(response, 'my_awesome_admin_scripts.js')
489. 
490.     def test_inline_media_only_inline(self):
491.         holder = Holder3(dummy=13)
492.         holder.save()
493.         Inner3(dummy=42, holder=holder).save()
494.         change_url = reverse('admin:admin_inlines_holder3_change', args=(holder.id,))
495.         response = self.client.get(change_url)
496.         self.assertEqual(
497.             response.context['inline_admin_formsets'][0].media._js,
498.             [
499.                 'admin/js/vendor/jquery/jquery.min.js',
500.                 'my_awesome_inline_scripts.js',


File: tests/admin_views/tests.py
Line number range: 1 - 6050
Content:
1. import datetime
2. import os
3. import re
4. import unittest
5. from unittest import mock
6. from urllib.parse import parse_qsl, urljoin, urlparse
7. 
8. import pytz
9. 
10. from django.contrib.admin import AdminSite, ModelAdmin
11. from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
12. from django.contrib.admin.models import ADDITION, DELETION, LogEntry
13. from django.contrib.admin.options import TO_FIELD_VAR
14. from django.contrib.admin.templatetags.admin_urls import add_preserved_filters
15. from django.contrib.admin.tests import AdminSeleniumTestCase
16. from django.contrib.admin.utils import quote
17. from django.contrib.admin.views.main import IS_POPUP_VAR
18. from django.contrib.auth import REDIRECT_FIELD_NAME, get_permission_codename
19. from django.contrib.auth.models import Group, Permission, User
20. from django.contrib.contenttypes.models import ContentType
21. from django.core import mail
22. from django.core.checks import Error
23. from django.core.files import temp as tempfile
24. from django.forms.utils import ErrorList
25. from django.template.response import TemplateResponse
26. from django.test import (
27.     TestCase, modify_settings, override_settings, skipUnlessDBFeature,
28. )
29. from django.test.utils import override_script_prefix
30. from django.urls import NoReverseMatch, resolve, reverse
31. from django.utils import formats, translation
32. from django.utils.cache import get_max_age
33. from django.utils.encoding import iri_to_uri
34. from django.utils.html import escape
35. from django.utils.http import urlencode
36. 
37. from . import customadmin
38. from .admin import CityAdmin, site, site2
39. from .models import (
40.     Actor, AdminOrderedAdminMethod, AdminOrderedCallable, AdminOrderedField,
41.     AdminOrderedModelMethod, Answer, Answer2, Article, BarAccount, Book,
42.     Bookmark, Category, Chapter, ChapterXtra1, ChapterXtra2, Character, Child,
43.     Choice, City, Collector, Color, ComplexSortedPerson, CoverLetter,
44.     CustomArticle, CyclicOne, CyclicTwo, DooHickey, Employee, EmptyModel,
45.     Fabric, FancyDoodad, FieldOverridePost, FilteredManager, FooAccount,
46.     FoodDelivery, FunkyTag, Gallery, Grommet, Inquisition, Language, Link,
47.     MainPrepopulated, Media, ModelWithStringPrimaryKey, OtherStory, Paper,
48.     Parent, ParentWithDependentChildren, ParentWithUUIDPK, Person, Persona,
49.     Picture, Pizza, Plot, PlotDetails, PluggableSearchPerson, Podcast, Post,
50.     PrePopulatedPost, Promo, Question, ReadablePizza, ReadOnlyPizza,
51.     Recommendation, Recommender, RelatedPrepopulated, RelatedWithUUIDPKModel,
52.     Report, Restaurant, RowLevelChangePermissionModel, SecretHideout, Section,
53.     ShortMessage, Simple, State, Story, SuperSecretHideout, SuperVillain,
54.     Telegram, TitleTranslation, Topping, UnchangeableObject, UndeletableObject,
55.     UnorderedObject, UserProxy, Villain, Vodcast, Whatsit, Widget, Worker,
56.     WorkHour,
57. )
58. 
59. ERROR_MESSAGE = "Please enter the correct username and password \
60. for a staff account. Note that both fields may be case-sensitive."
61. 
62. MULTIPART_ENCTYPE = 'enctype="multipart/form-data"'
63. 
64. 
65. class AdminFieldExtractionMixin:
66.     """
67.     Helper methods for extracting data from AdminForm.
68.     """
69.     def get_admin_form_fields(self, response):
70.         """
71.         Return a list of AdminFields for the AdminForm in the response.
72.         """
73.         fields = []
74.         for fieldset in response.context['adminform']:
75.             for field_line in fieldset:
76.                 fields.extend(field_line)
77.         return fields
78. 
79.     def get_admin_readonly_fields(self, response):
80.         """
81.         Return the readonly fields for the response's AdminForm.
82.         """
83.         return [f for f in self.get_admin_form_fields(response) if f.is_readonly]
84. 
85.     def get_admin_readonly_field(self, response, field_name):
86.         """
87.         Return the readonly field for the given field_name.
88.         """
89.         admin_readonly_fields = self.get_admin_readonly_fields(response)
90.         for field in admin_readonly_fields:
91.             if field.field['name'] == field_name:
92.                 return field
93. 
94. 
95. @override_settings(ROOT_URLCONF='admin_views.urls', USE_I18N=True, USE_L10N=False, LANGUAGE_CODE='en')
96. class AdminViewBasicTestCase(TestCase):
97. 
98.     @classmethod
99.     def setUpTestData(cls):
100.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
101.         cls.s1 = Section.objects.create(name='Test section')
102.         cls.a1 = Article.objects.create(
103.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
104.         )
105.         cls.a2 = Article.objects.create(
106.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
107.         )
108.         cls.a3 = Article.objects.create(
109.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
110.         )
111.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
112.         cls.color1 = Color.objects.create(value='Red', warm=True)
113.         cls.color2 = Color.objects.create(value='Orange', warm=True)
114.         cls.color3 = Color.objects.create(value='Blue', warm=False)
115.         cls.color4 = Color.objects.create(value='Green', warm=False)
116.         cls.fab1 = Fabric.objects.create(surface='x')
117.         cls.fab2 = Fabric.objects.create(surface='y')
118.         cls.fab3 = Fabric.objects.create(surface='plain')
119.         cls.b1 = Book.objects.create(name='Book 1')
120.         cls.b2 = Book.objects.create(name='Book 2')
121.         cls.pro1 = Promo.objects.create(name='Promo 1', book=cls.b1)
122.         cls.pro1 = Promo.objects.create(name='Promo 2', book=cls.b2)
123.         cls.chap1 = Chapter.objects.create(title='Chapter 1', content='[ insert contents here ]', book=cls.b1)
124.         cls.chap2 = Chapter.objects.create(title='Chapter 2', content='[ insert contents here ]', book=cls.b1)
125.         cls.chap3 = Chapter.objects.create(title='Chapter 1', content='[ insert contents here ]', book=cls.b2)
126.         cls.chap4 = Chapter.objects.create(title='Chapter 2', content='[ insert contents here ]', book=cls.b2)
127.         cls.cx1 = ChapterXtra1.objects.create(chap=cls.chap1, xtra='ChapterXtra1 1')
128.         cls.cx2 = ChapterXtra1.objects.create(chap=cls.chap3, xtra='ChapterXtra1 2')
129.         Actor.objects.create(name='Palin', age=27)
130. 
131.         # Post data for edit inline
132.         cls.inline_post_data = {
133.             "name": "Test section",
134.             # inline data
135.             "article_set-TOTAL_FORMS": "6",
136.             "article_set-INITIAL_FORMS": "3",
137.             "article_set-MAX_NUM_FORMS": "0",
138.             "article_set-0-id": cls.a1.pk,
139.             # there is no title in database, give one here or formset will fail.
140.             "article_set-0-title": "Norske bostaver æøå skaper problemer",
141.             "article_set-0-content": "&lt;p&gt;Middle content&lt;/p&gt;",
142.             "article_set-0-date_0": "2008-03-18",
143.             "article_set-0-date_1": "11:54:58",
144.             "article_set-0-section": cls.s1.pk,
145.             "article_set-1-id": cls.a2.pk,
146.             "article_set-1-title": "Need a title.",
147.             "article_set-1-content": "&lt;p&gt;Oldest content&lt;/p&gt;",
148.             "article_set-1-date_0": "2000-03-18",
149.             "article_set-1-date_1": "11:54:58",
150.             "article_set-2-id": cls.a3.pk,
151.             "article_set-2-title": "Need a title.",
152.             "article_set-2-content": "&lt;p&gt;Newest content&lt;/p&gt;",
153.             "article_set-2-date_0": "2009-03-18",
154.             "article_set-2-date_1": "11:54:58",
155.             "article_set-3-id": "",
156.             "article_set-3-title": "",
157.             "article_set-3-content": "",
158.             "article_set-3-date_0": "",
159.             "article_set-3-date_1": "",
160.             "article_set-4-id": "",
161.             "article_set-4-title": "",
162.             "article_set-4-content": "",
163.             "article_set-4-date_0": "",
164.             "article_set-4-date_1": "",
165.             "article_set-5-id": "",
166.             "article_set-5-title": "",
167.             "article_set-5-content": "",
168.             "article_set-5-date_0": "",
169.             "article_set-5-date_1": "",
170.         }
171. 
172.     def setUp(self):
173.         self.client.force_login(self.superuser)
174. 
175.     def assertContentBefore(self, response, text1, text2, failing_msg=None):
176.         """
177.         Testing utility asserting that text1 appears before text2 in response
178.         content.
179.         """
180.         self.assertEqual(response.status_code, 200)
181.         self.assertLess(
182.             response.content.index(text1.encode()),
183.             response.content.index(text2.encode()),
184.             (failing_msg or '') + '\nResponse:\n' + response.content.decode(response.charset)
185.         )
186. 
187. 
188. class AdminViewBasicTest(AdminViewBasicTestCase):
189.     def test_trailing_slash_required(self):
190.         """
191.         If you leave off the trailing slash, app should redirect and add it.
192.         """
193.         add_url = reverse('admin:admin_views_article_add')
194.         response = self.client.get(add_url[:-1])
195.         self.assertRedirects(response, add_url, status_code=301)
196. 
197.     def test_basic_add_GET(self):
198.         """
199.         A smoke test to ensure GET on the add_view works.
200.         """
201.         response = self.client.get(reverse('admin:admin_views_section_add'))
202.         self.assertIsInstance(response, TemplateResponse)
203.         self.assertEqual(response.status_code, 200)
204. 
205.     def test_add_with_GET_args(self):
206.         response = self.client.get(reverse('admin:admin_views_section_add'), {'name': 'My Section'})
207.         self.assertContains(
208.             response, 'value="My Section"',
209.             msg_prefix="Couldn't find an input with the right value in the response"
210.         )
211. 
212.     def test_basic_edit_GET(self):
213.         """
214.         A smoke test to ensure GET on the change_view works.
215.         """
216.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
217.         self.assertIsInstance(response, TemplateResponse)
218.         self.assertEqual(response.status_code, 200)
219. 
220.     def test_basic_edit_GET_string_PK(self):
221.         """
222.         GET on the change_view (when passing a string as the PK argument for a
223.         model with an integer PK field) redirects to the index page with a
224.         message saying the object doesn't exist.
225.         """
226.         response = self.client.get(reverse('admin:admin_views_section_change', args=(quote("abc/<b>"),)), follow=True)
227.         self.assertRedirects(response, reverse('admin:index'))
228.         self.assertEqual(
229.             [m.message for m in response.context['messages']],
230.             ["""section with ID "abc/<b>" doesn't exist. Perhaps it was deleted?"""]
231.         )
232. 
233.     def test_basic_edit_GET_old_url_redirect(self):
234.         """
235.         The change URL changed in Django 1.9, but the old one still redirects.
236.         """
237.         response = self.client.get(
238.             reverse('admin:admin_views_section_change', args=(self.s1.pk,)).replace('change/', '')
239.         )
240.         self.assertRedirects(response, reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
241. 
242.     def test_basic_inheritance_GET_string_PK(self):
243.         """
244.         GET on the change_view (for inherited models) redirects to the index
245.         page with a message saying the object doesn't exist.
246.         """
247.         response = self.client.get(reverse('admin:admin_views_supervillain_change', args=('abc',)), follow=True)
248.         self.assertRedirects(response, reverse('admin:index'))
249.         self.assertEqual(
250.             [m.message for m in response.context['messages']],
251.             ["""super villain with ID "abc" doesn't exist. Perhaps it was deleted?"""]
252.         )
253. 
254.     def test_basic_add_POST(self):
255.         """
256.         A smoke test to ensure POST on add_view works.
257.         """
258.         post_data = {
259.             "name": "Another Section",
260.             # inline data
261.             "article_set-TOTAL_FORMS": "3",
262.             "article_set-INITIAL_FORMS": "0",
263.             "article_set-MAX_NUM_FORMS": "0",
264.         }
265.         response = self.client.post(reverse('admin:admin_views_section_add'), post_data)
266.         self.assertEqual(response.status_code, 302)  # redirect somewhere
267. 
268.     def test_popup_add_POST(self):
269.         """
270.         Ensure http response from a popup is properly escaped.
271.         """
272.         post_data = {
273.             '_popup': '1',
274.             'title': 'title with a new\nline',
275.             'content': 'some content',
276.             'date_0': '2010-09-10',
277.             'date_1': '14:55:39',
278.         }
279.         response = self.client.post(reverse('admin:admin_views_article_add'), post_data)
280.         self.assertContains(response, 'title with a new\\nline')
281. 
282.     def test_basic_edit_POST(self):
283.         """
284.         A smoke test to ensure POST on edit_view works.
285.         """
286.         url = reverse('admin:admin_views_section_change', args=(self.s1.pk,))
287.         response = self.client.post(url, self.inline_post_data)
288.         self.assertEqual(response.status_code, 302)  # redirect somewhere
289. 
290.     def test_edit_save_as(self):
291.         """
292.         Test "save as".
293.         """
294.         post_data = self.inline_post_data.copy()
295.         post_data.update({
296.             '_saveasnew': 'Save+as+new',
297.             "article_set-1-section": "1",
298.             "article_set-2-section": "1",
299.             "article_set-3-section": "1",
300.             "article_set-4-section": "1",
301.             "article_set-5-section": "1",
302.         })
303.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), post_data)
304.         self.assertEqual(response.status_code, 302)  # redirect somewhere
305. 
306.     def test_edit_save_as_delete_inline(self):
307.         """
308.         Should be able to "Save as new" while also deleting an inline.
309.         """
310.         post_data = self.inline_post_data.copy()
311.         post_data.update({
312.             '_saveasnew': 'Save+as+new',
313.             "article_set-1-section": "1",
314.             "article_set-2-section": "1",
315.             "article_set-2-DELETE": "1",
316.             "article_set-3-section": "1",
317.         })
318.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), post_data)
319.         self.assertEqual(response.status_code, 302)
320.         # started with 3 articles, one was deleted.
321.         self.assertEqual(Section.objects.latest('id').article_set.count(), 2)
322. 
323.     def test_change_list_column_field_classes(self):
324.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
325.         # callables display the callable name.
326.         self.assertContains(response, 'column-callable_year')
327.         self.assertContains(response, 'field-callable_year')
328.         # lambdas display as "lambda" + index that they appear in list_display.
329.         self.assertContains(response, 'column-lambda8')
330.         self.assertContains(response, 'field-lambda8')
331. 
332.     def test_change_list_sorting_callable(self):
333.         """
334.         Ensure we can sort on a list_display field that is a callable
335.         (column 2 is callable_year in ArticleAdmin)
336.         """
337.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 2})
338.         self.assertContentBefore(
339.             response, 'Oldest content', 'Middle content',
340.             "Results of sorting on callable are out of order."
341.         )
342.         self.assertContentBefore(
343.             response, 'Middle content', 'Newest content',
344.             "Results of sorting on callable are out of order."
345.         )
346. 
347.     def test_change_list_sorting_property(self):
348.         """
349.         Sort on a list_display field that is a property (column 10 is
350.         a property in Article model).
351.         """
352.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 10})
353.         self.assertContentBefore(
354.             response,
355.             'Oldest content',
356.             'Middle content',
357.             'Results of sorting on property are out of order.',
358.         )
359.         self.assertContentBefore(
360.             response,
361.             'Middle content',
362.             'Newest content',
363.             'Results of sorting on property are out of order.',
364.         )
365. 
366.     def test_change_list_sorting_callable_query_expression(self):
367.         """
368.         Query expressions may be used for admin_order_field. (column 9 is
369.         order_by_expression in ArticleAdmin).
370.         """
371.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '9'})
372.         self.assertContentBefore(
373.             response, 'Oldest content', 'Middle content',
374.             'Results of sorting on callable are out of order.'
375.         )
376.         self.assertContentBefore(
377.             response, 'Middle content', 'Newest content',
378.             'Results of sorting on callable are out of order.'
379.         )
380. 
381.     def test_change_list_sorting_callable_query_expression_reverse(self):
382.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-9'})
383.         self.assertContentBefore(
384.             response, 'Middle content', 'Oldest content',
385.             'Results of sorting on callable are out of order.'
386.         )
387.         self.assertContentBefore(
388.             response, 'Newest content', 'Middle content',
389.             'Results of sorting on callable are out of order.'
390.         )
391. 
392.     def test_change_list_sorting_model(self):
393.         """
394.         Ensure we can sort on a list_display field that is a Model method
395.         (column 3 is 'model_year' in ArticleAdmin)
396.         """
397.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-3'})
398.         self.assertContentBefore(
399.             response, 'Newest content', 'Middle content',
400.             "Results of sorting on Model method are out of order."
401.         )
402.         self.assertContentBefore(
403.             response, 'Middle content', 'Oldest content',
404.             "Results of sorting on Model method are out of order."
405.         )
406. 
407.     def test_change_list_sorting_model_admin(self):
408.         """
409.         Ensure we can sort on a list_display field that is a ModelAdmin method
410.         (column 4 is 'modeladmin_year' in ArticleAdmin)
411.         """
412.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '4'})
413.         self.assertContentBefore(
414.             response, 'Oldest content', 'Middle content',
415.             "Results of sorting on ModelAdmin method are out of order."
416.         )
417.         self.assertContentBefore(
418.             response, 'Middle content', 'Newest content',
419.             "Results of sorting on ModelAdmin method are out of order."
420.         )
421. 
422.     def test_change_list_sorting_model_admin_reverse(self):
423.         """
424.         Ensure we can sort on a list_display field that is a ModelAdmin
425.         method in reverse order (i.e. admin_order_field uses the '-' prefix)
426.         (column 6 is 'model_year_reverse' in ArticleAdmin)
427.         """
428.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '6'})
429.         self.assertContentBefore(
430.             response, '2009', '2008',
431.             "Results of sorting on ModelAdmin method are out of order."
432.         )
433.         self.assertContentBefore(
434.             response, '2008', '2000',
435.             "Results of sorting on ModelAdmin method are out of order."
436.         )
437.         # Let's make sure the ordering is right and that we don't get a
438.         # FieldError when we change to descending order
439.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-6'})
440.         self.assertContentBefore(
441.             response, '2000', '2008',
442.             "Results of sorting on ModelAdmin method are out of order."
443.         )
444.         self.assertContentBefore(
445.             response, '2008', '2009',
446.             "Results of sorting on ModelAdmin method are out of order."
447.         )
448. 
449.     def test_change_list_sorting_multiple(self):
450.         p1 = Person.objects.create(name="Chris", gender=1, alive=True)
451.         p2 = Person.objects.create(name="Chris", gender=2, alive=True)
452.         p3 = Person.objects.create(name="Bob", gender=1, alive=True)
453.         link1 = reverse('admin:admin_views_person_change', args=(p1.pk,))
454.         link2 = reverse('admin:admin_views_person_change', args=(p2.pk,))
455.         link3 = reverse('admin:admin_views_person_change', args=(p3.pk,))
456. 
457.         # Sort by name, gender
458.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {'o': '1.2'})
459.         self.assertContentBefore(response, link3, link1)
460.         self.assertContentBefore(response, link1, link2)
461. 
462.         # Sort by gender descending, name
463.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {'o': '-2.1'})
464.         self.assertContentBefore(response, link2, link3)
465.         self.assertContentBefore(response, link3, link1)
466. 
467.     def test_change_list_sorting_preserve_queryset_ordering(self):
468.         """
469.         If no ordering is defined in `ModelAdmin.ordering` or in the query
470.         string, then the underlying order of the queryset should not be
471.         changed, even if it is defined in `Modeladmin.get_queryset()`.
472.         Refs #11868, #7309.
473.         """
474.         p1 = Person.objects.create(name="Amy", gender=1, alive=True, age=80)
475.         p2 = Person.objects.create(name="Bob", gender=1, alive=True, age=70)
476.         p3 = Person.objects.create(name="Chris", gender=2, alive=False, age=60)
477.         link1 = reverse('admin:admin_views_person_change', args=(p1.pk,))
478.         link2 = reverse('admin:admin_views_person_change', args=(p2.pk,))
479.         link3 = reverse('admin:admin_views_person_change', args=(p3.pk,))
480. 
481.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {})
482.         self.assertContentBefore(response, link3, link2)
483.         self.assertContentBefore(response, link2, link1)
484. 
485.     def test_change_list_sorting_model_meta(self):
486.         # Test ordering on Model Meta is respected
487. 
488.         l1 = Language.objects.create(iso='ur', name='Urdu')
489.         l2 = Language.objects.create(iso='ar', name='Arabic')
490.         link1 = reverse('admin:admin_views_language_change', args=(quote(l1.pk),))
491.         link2 = reverse('admin:admin_views_language_change', args=(quote(l2.pk),))
492. 
493.         response = self.client.get(reverse('admin:admin_views_language_changelist'), {})
494.         self.assertContentBefore(response, link2, link1)
495. 
496.         # Test we can override with query string
497.         response = self.client.get(reverse('admin:admin_views_language_changelist'), {'o': '-1'})
498.         self.assertContentBefore(response, link1, link2)
499. 
500.     def test_change_list_sorting_override_model_admin(self):
501.         # Test ordering on Model Admin is respected, and overrides Model Meta
502.         dt = datetime.datetime.now()
503.         p1 = Podcast.objects.create(name="A", release_date=dt)
504.         p2 = Podcast.objects.create(name="B", release_date=dt - datetime.timedelta(10))
505.         link1 = reverse('admin:admin_views_podcast_change', args=(p1.pk,))
506.         link2 = reverse('admin:admin_views_podcast_change', args=(p2.pk,))
507. 
508.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'), {})
509.         self.assertContentBefore(response, link1, link2)
510. 
511.     def test_multiple_sort_same_field(self):
512.         # The changelist displays the correct columns if two columns correspond
513.         # to the same ordering field.
514.         dt = datetime.datetime.now()
515.         p1 = Podcast.objects.create(name="A", release_date=dt)
516.         p2 = Podcast.objects.create(name="B", release_date=dt - datetime.timedelta(10))
517.         link1 = reverse('admin:admin_views_podcast_change', args=(quote(p1.pk),))
518.         link2 = reverse('admin:admin_views_podcast_change', args=(quote(p2.pk),))
519. 
520.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'), {})
521.         self.assertContentBefore(response, link1, link2)
522. 
523.         p1 = ComplexSortedPerson.objects.create(name="Bob", age=10)
524.         p2 = ComplexSortedPerson.objects.create(name="Amy", age=20)
525.         link1 = reverse('admin:admin_views_complexsortedperson_change', args=(p1.pk,))
526.         link2 = reverse('admin:admin_views_complexsortedperson_change', args=(p2.pk,))
527. 
528.         response = self.client.get(reverse('admin:admin_views_complexsortedperson_changelist'), {})
529.         # Should have 5 columns (including action checkbox col)
530.         self.assertContains(response, '<th scope="col"', count=5)
531. 
532.         self.assertContains(response, 'Name')
533.         self.assertContains(response, 'Colored name')
534. 
535.         # Check order
536.         self.assertContentBefore(response, 'Name', 'Colored name')
537. 
538.         # Check sorting - should be by name
539.         self.assertContentBefore(response, link2, link1)
540. 
541.     def test_sort_indicators_admin_order(self):
542.         """
543.         The admin shows default sort indicators for all kinds of 'ordering'
544.         fields: field names, method on the model admin and model itself, and
545.         other callables. See #17252.
546.         """
547.         models = [(AdminOrderedField, 'adminorderedfield'),
548.                   (AdminOrderedModelMethod, 'adminorderedmodelmethod'),
549.                   (AdminOrderedAdminMethod, 'adminorderedadminmethod'),
550.                   (AdminOrderedCallable, 'adminorderedcallable')]
551.         for model, url in models:
552.             model.objects.create(stuff='The Last Item', order=3)
553.             model.objects.create(stuff='The First Item', order=1)
554.             model.objects.create(stuff='The Middle Item', order=2)
555.             response = self.client.get(reverse('admin:admin_views_%s_changelist' % url), {})
556.             self.assertEqual(response.status_code, 200)
557.             # Should have 3 columns including action checkbox col.
558.             self.assertContains(response, '<th scope="col"', count=3, msg_prefix=url)
559.             # Check if the correct column was selected. 2 is the index of the
560.             # 'order' column in the model admin's 'list_display' with 0 being
561.             # the implicit 'action_checkbox' and 1 being the column 'stuff'.
562.             self.assertEqual(response.context['cl'].get_ordering_field_columns(), {2: 'asc'})
563.             # Check order of records.
564.             self.assertContentBefore(response, 'The First Item', 'The Middle Item')
565.             self.assertContentBefore(response, 'The Middle Item', 'The Last Item')
566. 
567.     def test_has_related_field_in_list_display_fk(self):
568.         """Joins shouldn't be performed for <FK>_id fields in list display."""
569.         state = State.objects.create(name='Karnataka')
570.         City.objects.create(state=state, name='Bangalore')
571.         response = self.client.get(reverse('admin:admin_views_city_changelist'), {})
572. 
573.         response.context['cl'].list_display = ['id', 'name', 'state']
574.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), True)
575. 
576.         response.context['cl'].list_display = ['id', 'name', 'state_id']
577.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), False)
578. 
579.     def test_has_related_field_in_list_display_o2o(self):
580.         """Joins shouldn't be performed for <O2O>_id fields in list display."""
581.         media = Media.objects.create(name='Foo')
582.         Vodcast.objects.create(media=media)
583.         response = self.client.get(reverse('admin:admin_views_vodcast_changelist'), {})
584. 
585.         response.context['cl'].list_display = ['media']
586.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), True)
587. 
588.         response.context['cl'].list_display = ['media_id']
589.         self.assertIs(response.context['cl'].has_related_field_in_list_display(), False)
590. 
591.     def test_limited_filter(self):
592.         """Ensure admin changelist filters do not contain objects excluded via limit_choices_to.
593.         This also tests relation-spanning filters (e.g. 'color__value').
594.         """
595.         response = self.client.get(reverse('admin:admin_views_thing_changelist'))
596.         self.assertContains(
597.             response, '<div id="changelist-filter">',
598.             msg_prefix="Expected filter not found in changelist view"
599.         )
600.         self.assertNotContains(
601.             response, '<a href="?color__id__exact=3">Blue</a>',
602.             msg_prefix="Changelist filter not correctly limited by limit_choices_to"
603.         )
604. 
605.     def test_relation_spanning_filters(self):
606.         changelist_url = reverse('admin:admin_views_chapterxtra1_changelist')
607.         response = self.client.get(changelist_url)
608.         self.assertContains(response, '<div id="changelist-filter">')
609.         filters = {
610.             'chap__id__exact': {
611.                 'values': [c.id for c in Chapter.objects.all()],
612.                 'test': lambda obj, value: obj.chap.id == value,
613.             },
614.             'chap__title': {
615.                 'values': [c.title for c in Chapter.objects.all()],
616.                 'test': lambda obj, value: obj.chap.title == value,
617.             },
618.             'chap__book__id__exact': {
619.                 'values': [b.id for b in Book.objects.all()],
620.                 'test': lambda obj, value: obj.chap.book.id == value,
621.             },
622.             'chap__book__name': {
623.                 'values': [b.name for b in Book.objects.all()],
624.                 'test': lambda obj, value: obj.chap.book.name == value,
625.             },
626.             'chap__book__promo__id__exact': {
627.                 'values': [p.id for p in Promo.objects.all()],
628.                 'test': lambda obj, value: obj.chap.book.promo_set.filter(id=value).exists(),
629.             },
630.             'chap__book__promo__name': {
631.                 'values': [p.name for p in Promo.objects.all()],
632.                 'test': lambda obj, value: obj.chap.book.promo_set.filter(name=value).exists(),
633.             },
634.             # A forward relation (book) after a reverse relation (promo).
635.             'guest_author__promo__book__id__exact': {
636.                 'values': [p.id for p in Book.objects.all()],
637.                 'test': lambda obj, value: obj.guest_author.promo_set.filter(book=value).exists(),
638.             },
639.         }
640.         for filter_path, params in filters.items():
641.             for value in params['values']:
642.                 query_string = urlencode({filter_path: value})
643.                 # ensure filter link exists
644.                 self.assertContains(response, '<a href="?%s"' % query_string)
645.                 # ensure link works
646.                 filtered_response = self.client.get('%s?%s' % (changelist_url, query_string))
647.                 self.assertEqual(filtered_response.status_code, 200)
648.                 # ensure changelist contains only valid objects
649.                 for obj in filtered_response.context['cl'].queryset.all():
650.                     self.assertTrue(params['test'](obj, value))
651. 
652.     def test_incorrect_lookup_parameters(self):
653.         """Ensure incorrect lookup parameters are handled gracefully."""
654.         changelist_url = reverse('admin:admin_views_thing_changelist')
655.         response = self.client.get(changelist_url, {'notarealfield': '5'})
656.         self.assertRedirects(response, '%s?e=1' % changelist_url)
657. 
658.         # Spanning relationships through a nonexistent related object (Refs #16716)
659.         response = self.client.get(changelist_url, {'notarealfield__whatever': '5'})
660.         self.assertRedirects(response, '%s?e=1' % changelist_url)
661. 
662.         response = self.client.get(changelist_url, {'color__id__exact': 'StringNotInteger!'})
663.         self.assertRedirects(response, '%s?e=1' % changelist_url)
664. 
665.         # Regression test for #18530
666.         response = self.client.get(changelist_url, {'pub_date__gte': 'foo'})
667.         self.assertRedirects(response, '%s?e=1' % changelist_url)
668. 
669.     def test_isnull_lookups(self):
670.         """Ensure is_null is handled correctly."""
671.         Article.objects.create(title="I Could Go Anywhere", content="Versatile", date=datetime.datetime.now())
672.         changelist_url = reverse('admin:admin_views_article_changelist')
673.         response = self.client.get(changelist_url)
674.         self.assertContains(response, '4 articles')
675.         response = self.client.get(changelist_url, {'section__isnull': 'false'})
676.         self.assertContains(response, '3 articles')
677.         response = self.client.get(changelist_url, {'section__isnull': '0'})
678.         self.assertContains(response, '3 articles')
679.         response = self.client.get(changelist_url, {'section__isnull': 'true'})
680.         self.assertContains(response, '1 article')
681.         response = self.client.get(changelist_url, {'section__isnull': '1'})
682.         self.assertContains(response, '1 article')
683. 
684.     def test_logout_and_password_change_URLs(self):
685.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
686.         self.assertContains(response, '<a href="%s">' % reverse('admin:logout'))
687.         self.assertContains(response, '<a href="%s">' % reverse('admin:password_change'))
688. 
689.     def test_named_group_field_choices_change_list(self):
690.         """
691.         Ensures the admin changelist shows correct values in the relevant column
692.         for rows corresponding to instances of a model in which a named group
693.         has been used in the choices option of a field.
694.         """
695.         link1 = reverse('admin:admin_views_fabric_change', args=(self.fab1.pk,))
696.         link2 = reverse('admin:admin_views_fabric_change', args=(self.fab2.pk,))
697.         response = self.client.get(reverse('admin:admin_views_fabric_changelist'))
698.         fail_msg = (
699.             "Changelist table isn't showing the right human-readable values "
700.             "set by a model field 'choices' option named group."
701.         )
702.         self.assertContains(response, '<a href="%s">Horizontal</a>' % link1, msg_prefix=fail_msg, html=True)
703.         self.assertContains(response, '<a href="%s">Vertical</a>' % link2, msg_prefix=fail_msg, html=True)
704. 
705.     def test_named_group_field_choices_filter(self):
706.         """
707.         Ensures the filter UI shows correctly when at least one named group has
708.         been used in the choices option of a model field.
709.         """
710.         response = self.client.get(reverse('admin:admin_views_fabric_changelist'))
711.         fail_msg = (
712.             "Changelist filter isn't showing options contained inside a model "
713.             "field 'choices' option named group."
714.         )
715.         self.assertContains(response, '<div id="changelist-filter">')
716.         self.assertContains(
717.             response, '<a href="?surface__exact=x" title="Horizontal">Horizontal</a>',
718.             msg_prefix=fail_msg, html=True
719.         )
720.         self.assertContains(
721.             response, '<a href="?surface__exact=y" title="Vertical">Vertical</a>',
722.             msg_prefix=fail_msg, html=True
723.         )
724. 
725.     def test_change_list_null_boolean_display(self):
726.         Post.objects.create(public=None)
727.         response = self.client.get(reverse('admin:admin_views_post_changelist'))
728.         self.assertContains(response, 'icon-unknown.svg')
729. 
730.     def test_i18n_language_non_english_default(self):
731.         """
732.         Check if the JavaScript i18n view returns an empty language catalog
733.         if the default language is non-English but the selected language
734.         is English. See #13388 and #3594 for more details.
735.         """
736.         with self.settings(LANGUAGE_CODE='fr'), translation.override('en-us'):
737.             response = self.client.get(reverse('admin:jsi18n'))
738.             self.assertNotContains(response, 'Choisir une heure')
739. 
740.     def test_i18n_language_non_english_fallback(self):
741.         """
742.         Makes sure that the fallback language is still working properly
743.         in cases where the selected language cannot be found.
744.         """
745.         with self.settings(LANGUAGE_CODE='fr'), translation.override('none'):
746.             response = self.client.get(reverse('admin:jsi18n'))
747.             self.assertContains(response, 'Choisir une heure')
748. 
749.     def test_jsi18n_with_context(self):
750.         response = self.client.get(reverse('admin-extra-context:jsi18n'))
751.         self.assertEqual(response.status_code, 200)
752. 
753.     def test_L10N_deactivated(self):
754.         """
755.         Check if L10N is deactivated, the JavaScript i18n view doesn't
756.         return localized date/time formats. Refs #14824.
757.         """
758.         with self.settings(LANGUAGE_CODE='ru', USE_L10N=False), translation.override('none'):
759.             response = self.client.get(reverse('admin:jsi18n'))
760.             self.assertNotContains(response, '%d.%m.%Y %H:%M:%S')
761.             self.assertContains(response, '%Y-%m-%d %H:%M:%S')
762. 
763.     def test_disallowed_filtering(self):
764.         with self.assertLogs('django.security.DisallowedModelAdminLookup', 'ERROR'):
765.             response = self.client.get(
766.                 "%s?owner__email__startswith=fuzzy" % reverse('admin:admin_views_album_changelist')
767.             )
768.         self.assertEqual(response.status_code, 400)
769. 
770.         # Filters are allowed if explicitly included in list_filter
771.         response = self.client.get("%s?color__value__startswith=red" % reverse('admin:admin_views_thing_changelist'))
772.         self.assertEqual(response.status_code, 200)
773.         response = self.client.get("%s?color__value=red" % reverse('admin:admin_views_thing_changelist'))
774.         self.assertEqual(response.status_code, 200)
775. 
776.         # Filters should be allowed if they involve a local field without the
777.         # need to whitelist them in list_filter or date_hierarchy.
778.         response = self.client.get("%s?age__gt=30" % reverse('admin:admin_views_person_changelist'))
779.         self.assertEqual(response.status_code, 200)
780. 
781.         e1 = Employee.objects.create(name='Anonymous', gender=1, age=22, alive=True, code='123')
782.         e2 = Employee.objects.create(name='Visitor', gender=2, age=19, alive=True, code='124')
783.         WorkHour.objects.create(datum=datetime.datetime.now(), employee=e1)
784.         WorkHour.objects.create(datum=datetime.datetime.now(), employee=e2)
785.         response = self.client.get(reverse('admin:admin_views_workhour_changelist'))
786.         self.assertContains(response, 'employee__person_ptr__exact')
787.         response = self.client.get("%s?employee__person_ptr__exact=%d" % (
788.             reverse('admin:admin_views_workhour_changelist'), e1.pk)
789.         )
790.         self.assertEqual(response.status_code, 200)
791. 
792.     def test_disallowed_to_field(self):
793.         url = reverse('admin:admin_views_section_changelist')
794.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
795.             response = self.client.get(url, {TO_FIELD_VAR: 'missing_field'})
796.         self.assertEqual(response.status_code, 400)
797. 
798.         # Specifying a field that is not referred by any other model registered
799.         # to this admin site should raise an exception.
800.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
801.             response = self.client.get(reverse('admin:admin_views_section_changelist'), {TO_FIELD_VAR: 'name'})
802.         self.assertEqual(response.status_code, 400)
803. 
804.         # #23839 - Primary key should always be allowed, even if the referenced model isn't registered.
805.         response = self.client.get(reverse('admin:admin_views_notreferenced_changelist'), {TO_FIELD_VAR: 'id'})
806.         self.assertEqual(response.status_code, 200)
807. 
808.         # #23915 - Specifying a field referenced by another model though a m2m should be allowed.
809.         response = self.client.get(reverse('admin:admin_views_recipe_changelist'), {TO_FIELD_VAR: 'rname'})
810.         self.assertEqual(response.status_code, 200)
811. 
812.         # #23604, #23915 - Specifying a field referenced through a reverse m2m relationship should be allowed.
813.         response = self.client.get(reverse('admin:admin_views_ingredient_changelist'), {TO_FIELD_VAR: 'iname'})
814.         self.assertEqual(response.status_code, 200)
815. 
816.         # #23329 - Specifying a field that is not referred by any other model directly registered
817.         # to this admin site but registered through inheritance should be allowed.
818.         response = self.client.get(reverse('admin:admin_views_referencedbyparent_changelist'), {TO_FIELD_VAR: 'name'})
819.         self.assertEqual(response.status_code, 200)
820. 
821.         # #23431 - Specifying a field that is only referred to by a inline of a registered
822.         # model should be allowed.
823.         response = self.client.get(reverse('admin:admin_views_referencedbyinline_changelist'), {TO_FIELD_VAR: 'name'})
824.         self.assertEqual(response.status_code, 200)
825. 
826.         # #25622 - Specifying a field of a model only referred by a generic
827.         # relation should raise DisallowedModelAdminToField.
828.         url = reverse('admin:admin_views_referencedbygenrel_changelist')
829.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
830.             response = self.client.get(url, {TO_FIELD_VAR: 'object_id'})
831.         self.assertEqual(response.status_code, 400)
832. 
833.         # We also want to prevent the add, change, and delete views from
834.         # leaking a disallowed field value.
835.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
836.             response = self.client.post(reverse('admin:admin_views_section_add'), {TO_FIELD_VAR: 'name'})
837.         self.assertEqual(response.status_code, 400)
838. 
839.         section = Section.objects.create()
840.         url = reverse('admin:admin_views_section_change', args=(section.pk,))
841.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
842.             response = self.client.post(url, {TO_FIELD_VAR: 'name'})
843.         self.assertEqual(response.status_code, 400)
844. 
845.         url = reverse('admin:admin_views_section_delete', args=(section.pk,))
846.         with self.assertLogs('django.security.DisallowedModelAdminToField', 'ERROR'):
847.             response = self.client.post(url, {TO_FIELD_VAR: 'name'})
848.         self.assertEqual(response.status_code, 400)
849. 
850.     def test_allowed_filtering_15103(self):
851.         """
852.         Regressions test for ticket 15103 - filtering on fields defined in a
853.         ForeignKey 'limit_choices_to' should be allowed, otherwise raw_id_fields
854.         can break.
855.         """
856.         # Filters should be allowed if they are defined on a ForeignKey pointing to this model
857.         url = "%s?leader__name=Palin&leader__age=27" % reverse('admin:admin_views_inquisition_changelist')
858.         response = self.client.get(url)
859.         self.assertEqual(response.status_code, 200)
860. 
861.     def test_popup_dismiss_related(self):
862.         """
863.         Regression test for ticket 20664 - ensure the pk is properly quoted.
864.         """
865.         actor = Actor.objects.create(name="Palin", age=27)
866.         response = self.client.get("%s?%s" % (reverse('admin:admin_views_actor_changelist'), IS_POPUP_VAR))
867.         self.assertContains(response, 'data-popup-opener="%s"' % actor.pk)
868. 
869.     def test_hide_change_password(self):
870.         """
871.         Tests if the "change password" link in the admin is hidden if the User
872.         does not have a usable password set.
873.         (against 9bea85795705d015cdadc82c68b99196a8554f5c)
874.         """
875.         user = User.objects.get(username='super')
876.         user.set_unusable_password()
877.         user.save()
878.         self.client.force_login(user)
879.         response = self.client.get(reverse('admin:index'))
880.         self.assertNotContains(
881.             response, reverse('admin:password_change'),
882.             msg_prefix='The "change password" link should not be displayed if a user does not have a usable password.'
883.         )
884. 
885.     def test_change_view_with_show_delete_extra_context(self):
886.         """
887.         The 'show_delete' context variable in the admin's change view controls
888.         the display of the delete button.
889.         """
890.         instance = UndeletableObject.objects.create(name='foo')
891.         response = self.client.get(reverse('admin:admin_views_undeletableobject_change', args=(instance.pk,)))
892.         self.assertNotContains(response, 'deletelink')
893. 
894.     def test_change_view_logs_m2m_field_changes(self):
895.         """Changes to ManyToManyFields are included in the object's history."""
896.         pizza = ReadablePizza.objects.create(name='Cheese')
897.         cheese = Topping.objects.create(name='cheese')
898.         post_data = {'name': pizza.name, 'toppings': [cheese.pk]}
899.         response = self.client.post(reverse('admin:admin_views_readablepizza_change', args=(pizza.pk,)), post_data)
900.         self.assertRedirects(response, reverse('admin:admin_views_readablepizza_changelist'))
901.         pizza_ctype = ContentType.objects.get_for_model(ReadablePizza, for_concrete_model=False)
902.         log = LogEntry.objects.filter(content_type=pizza_ctype, object_id=pizza.pk).first()
903.         self.assertEqual(log.get_change_message(), 'Changed toppings.')
904. 
905.     def test_allows_attributeerror_to_bubble_up(self):
906.         """
907.         AttributeErrors are allowed to bubble when raised inside a change list
908.         view. Requires a model to be created so there's something to display.
909.         Refs: #16655, #18593, and #18747
910.         """
911.         Simple.objects.create()
912.         with self.assertRaises(AttributeError):
913.             self.client.get(reverse('admin:admin_views_simple_changelist'))
914. 
915.     def test_changelist_with_no_change_url(self):
916.         """
917.         ModelAdmin.changelist_view shouldn't result in a NoReverseMatch if url
918.         for change_view is removed from get_urls (#20934).
919.         """
920.         o = UnchangeableObject.objects.create()
921.         response = self.client.get(reverse('admin:admin_views_unchangeableobject_changelist'))
922.         self.assertEqual(response.status_code, 200)
923.         # Check the format of the shown object -- shouldn't contain a change link
924.         self.assertContains(response, '<th class="field-__str__">%s</th>' % o, html=True)
925. 
926.     def test_invalid_appindex_url(self):
927.         """
928.         #21056 -- URL reversing shouldn't work for nonexistent apps.
929.         """
930.         good_url = '/test_admin/admin/admin_views/'
931.         confirm_good_url = reverse('admin:app_list',
932.                                    kwargs={'app_label': 'admin_views'})
933.         self.assertEqual(good_url, confirm_good_url)
934. 
935.         with self.assertRaises(NoReverseMatch):
936.             reverse('admin:app_list', kwargs={'app_label': 'this_should_fail'})
937.         with self.assertRaises(NoReverseMatch):
938.             reverse('admin:app_list', args=('admin_views2',))
939. 
940.     def test_resolve_admin_views(self):
941.         index_match = resolve('/test_admin/admin4/')
942.         list_match = resolve('/test_admin/admin4/auth/user/')
943.         self.assertIs(index_match.func.admin_site, customadmin.simple_site)
944.         self.assertIsInstance(list_match.func.model_admin, customadmin.CustomPwdTemplateUserAdmin)
945. 
946.     def test_adminsite_display_site_url(self):
947.         """
948.         #13749 - Admin should display link to front-end site 'View site'
949.         """
950.         url = reverse('admin:index')
951.         response = self.client.get(url)
952.         self.assertEqual(response.context['site_url'], '/my-site-url/')
953.         self.assertContains(response, '<a href="/my-site-url/">View site</a>')
954. 
955.     @override_settings(TIME_ZONE='America/Sao_Paulo', USE_TZ=True)
956.     def test_date_hierarchy_timezone_dst(self):
957.         # This datetime doesn't exist in this timezone due to DST.
958.         date = pytz.timezone('America/Sao_Paulo').localize(datetime.datetime(2016, 10, 16, 15), is_dst=None)
959.         q = Question.objects.create(question='Why?', expires=date)
960.         Answer2.objects.create(question=q, answer='Because.')
961.         response = self.client.get(reverse('admin:admin_views_answer2_changelist'))
962.         self.assertEqual(response.status_code, 200)
963.         self.assertContains(response, 'question__expires__day=16')
964.         self.assertContains(response, 'question__expires__month=10')
965.         self.assertContains(response, 'question__expires__year=2016')
966. 
967.     def test_sortable_by_columns_subset(self):
968.         expected_sortable_fields = ('date', 'callable_year')
969.         expected_not_sortable_fields = (
970.             'content', 'model_year', 'modeladmin_year', 'model_year_reversed',
971.             'section',
972.         )
973.         response = self.client.get(reverse('admin6:admin_views_article_changelist'))
974.         for field_name in expected_sortable_fields:
975.             self.assertContains(response, '<th scope="col"  class="sortable column-%s">' % field_name)
976.         for field_name in expected_not_sortable_fields:
977.             self.assertContains(response, '<th scope="col"  class="column-%s">' % field_name)
978. 
979.     def test_get_sortable_by_columns_subset(self):
980.         response = self.client.get(reverse('admin6:admin_views_actor_changelist'))
981.         self.assertContains(response, '<th scope="col"  class="sortable column-age">')
982.         self.assertContains(response, '<th scope="col"  class="column-name">')
983. 
984.     def test_sortable_by_no_column(self):
985.         expected_not_sortable_fields = ('title', 'book')
986.         response = self.client.get(reverse('admin6:admin_views_chapter_changelist'))
987.         for field_name in expected_not_sortable_fields:
988.             self.assertContains(response, '<th scope="col"  class="column-%s">' % field_name)
989.         self.assertNotContains(response, '<th scope="col"  class="sortable column')
990. 
991.     def test_get_sortable_by_no_column(self):
992.         response = self.client.get(reverse('admin6:admin_views_color_changelist'))
993.         self.assertContains(response, '<th scope="col"  class="column-value">')
994.         self.assertNotContains(response, '<th scope="col"  class="sortable column')
995. 
996. 
997. @override_settings(TEMPLATES=[{
998.     'BACKEND': 'django.template.backends.django.DjangoTemplates',
999.     # Put this app's and the shared tests templates dirs in DIRS to take precedence
1000.     # over the admin's templates dir.
1001.     'DIRS': [
1002.         os.path.join(os.path.dirname(__file__), 'templates'),
1003.         os.path.join(os.path.dirname(os.path.dirname(__file__)), 'templates'),
1004.     ],
1005.     'APP_DIRS': True,
1006.     'OPTIONS': {
1007.         'context_processors': [
1008.             'django.template.context_processors.debug',
1009.             'django.template.context_processors.request',
1010.             'django.contrib.auth.context_processors.auth',
1011.             'django.contrib.messages.context_processors.messages',
1012.         ],
1013.     },
1014. }])
1015. class AdminCustomTemplateTests(AdminViewBasicTestCase):
1016.     def test_custom_model_admin_templates(self):
1017.         # Test custom change list template with custom extra context
1018.         response = self.client.get(reverse('admin:admin_views_customarticle_changelist'))
1019.         self.assertContains(response, "var hello = 'Hello!';")
1020.         self.assertTemplateUsed(response, 'custom_admin/change_list.html')
1021. 
1022.         # Test custom add form template
1023.         response = self.client.get(reverse('admin:admin_views_customarticle_add'))
1024.         self.assertTemplateUsed(response, 'custom_admin/add_form.html')
1025. 
1026.         # Add an article so we can test delete, change, and history views
1027.         post = self.client.post(reverse('admin:admin_views_customarticle_add'), {
1028.             'content': '<p>great article</p>',
1029.             'date_0': '2008-03-18',
1030.             'date_1': '10:54:39'
1031.         })
1032.         self.assertRedirects(post, reverse('admin:admin_views_customarticle_changelist'))
1033.         self.assertEqual(CustomArticle.objects.all().count(), 1)
1034.         article_pk = CustomArticle.objects.all()[0].pk
1035. 
1036.         # Test custom delete, change, and object history templates
1037.         # Test custom change form template
1038.         response = self.client.get(reverse('admin:admin_views_customarticle_change', args=(article_pk,)))
1039.         self.assertTemplateUsed(response, 'custom_admin/change_form.html')
1040.         response = self.client.get(reverse('admin:admin_views_customarticle_delete', args=(article_pk,)))
1041.         self.assertTemplateUsed(response, 'custom_admin/delete_confirmation.html')
1042.         response = self.client.post(reverse('admin:admin_views_customarticle_changelist'), data={
1043.             'index': 0,
1044.             'action': ['delete_selected'],
1045.             '_selected_action': ['1'],
1046.         })
1047.         self.assertTemplateUsed(response, 'custom_admin/delete_selected_confirmation.html')
1048.         response = self.client.get(reverse('admin:admin_views_customarticle_history', args=(article_pk,)))
1049.         self.assertTemplateUsed(response, 'custom_admin/object_history.html')
1050. 
1051.         # A custom popup response template may be specified by
1052.         # ModelAdmin.popup_response_template.
1053.         response = self.client.post(reverse('admin:admin_views_customarticle_add') + '?%s=1' % IS_POPUP_VAR, {
1054.             'content': '<p>great article</p>',
1055.             'date_0': '2008-03-18',
1056.             'date_1': '10:54:39',
1057.             IS_POPUP_VAR: '1'
1058.         })
1059.         self.assertEqual(response.template_name, 'custom_admin/popup_response.html')
1060. 
1061.     def test_extended_bodyclass_template_change_form(self):
1062.         """
1063.         The admin/change_form.html template uses block.super in the
1064.         bodyclass block.
1065.         """
1066.         response = self.client.get(reverse('admin:admin_views_section_add'))
1067.         self.assertContains(response, 'bodyclass_consistency_check ')
1068. 
1069.     def test_change_password_template(self):
1070.         user = User.objects.get(username='super')
1071.         response = self.client.get(reverse('admin:auth_user_password_change', args=(user.id,)))
1072.         # The auth/user/change_password.html template uses super in the
1073.         # bodyclass block.
1074.         self.assertContains(response, 'bodyclass_consistency_check ')
1075. 
1076.         # When a site has multiple passwords in the browser's password manager,
1077.         # a browser pop up asks which user the new password is for. To prevent
1078.         # this, the username is added to the change password form.
1079.         self.assertContains(response, '<input type="text" name="username" value="super" style="display: none">')
1080. 
1081.     def test_extended_bodyclass_template_index(self):
1082.         """
1083.         The admin/index.html template uses block.super in the bodyclass block.
1084.         """
1085.         response = self.client.get(reverse('admin:index'))
1086.         self.assertContains(response, 'bodyclass_consistency_check ')
1087. 
1088.     def test_extended_bodyclass_change_list(self):
1089.         """
1090.         The admin/change_list.html' template uses block.super
1091.         in the bodyclass block.
1092.         """
1093.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
1094.         self.assertContains(response, 'bodyclass_consistency_check ')
1095. 
1096.     def test_extended_bodyclass_template_login(self):
1097.         """
1098.         The admin/login.html template uses block.super in the
1099.         bodyclass block.
1100.         """
1101.         self.client.logout()
1102.         response = self.client.get(reverse('admin:login'))
1103.         self.assertContains(response, 'bodyclass_consistency_check ')
1104. 
1105.     def test_extended_bodyclass_template_delete_confirmation(self):
1106.         """
1107.         The admin/delete_confirmation.html template uses
1108.         block.super in the bodyclass block.
1109.         """
1110.         group = Group.objects.create(name="foogroup")
1111.         response = self.client.get(reverse('admin:auth_group_delete', args=(group.id,)))
1112.         self.assertContains(response, 'bodyclass_consistency_check ')
1113. 
1114.     def test_extended_bodyclass_template_delete_selected_confirmation(self):
1115.         """
1116.         The admin/delete_selected_confirmation.html template uses
1117.         block.super in bodyclass block.
1118.         """
1119.         group = Group.objects.create(name="foogroup")
1120.         post_data = {
1121.             'action': 'delete_selected',
1122.             'selected_across': '0',
1123.             'index': '0',
1124.             '_selected_action': group.id
1125.         }
1126.         response = self.client.post(reverse('admin:auth_group_changelist'), post_data)
1127.         self.assertEqual(response.context['site_header'], 'Django administration')
1128.         self.assertContains(response, 'bodyclass_consistency_check ')
1129. 
1130.     def test_filter_with_custom_template(self):
1131.         """
1132.         A custom template can be used to render an admin filter.
1133.         """
1134.         response = self.client.get(reverse('admin:admin_views_color2_changelist'))
1135.         self.assertTemplateUsed(response, 'custom_filter_template.html')
1136. 
1137. 
1138. @override_settings(ROOT_URLCONF='admin_views.urls')
1139. class AdminViewFormUrlTest(TestCase):
1140.     current_app = "admin3"
1141. 
1142.     @classmethod
1143.     def setUpTestData(cls):
1144.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1145.         cls.s1 = Section.objects.create(name='Test section')
1146.         cls.a1 = Article.objects.create(
1147.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
1148.         )
1149.         cls.a2 = Article.objects.create(
1150.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
1151.         )
1152.         cls.a3 = Article.objects.create(
1153.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
1154.         )
1155.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
1156. 
1157.     def setUp(self):
1158.         self.client.force_login(self.superuser)
1159. 
1160.     def test_change_form_URL_has_correct_value(self):
1161.         """
1162.         change_view has form_url in response.context
1163.         """
1164.         response = self.client.get(
1165.             reverse('admin:admin_views_section_change', args=(self.s1.pk,), current_app=self.current_app)
1166.         )
1167.         self.assertIn('form_url', response.context, msg='form_url not present in response.context')
1168.         self.assertEqual(response.context['form_url'], 'pony')
1169. 
1170.     def test_initial_data_can_be_overridden(self):
1171.         """
1172.         The behavior for setting initial form data can be overridden in the
1173.         ModelAdmin class. Usually, the initial value is set via the GET params.
1174.         """
1175.         response = self.client.get(
1176.             reverse('admin:admin_views_restaurant_add', current_app=self.current_app),
1177.             {'name': 'test_value'}
1178.         )
1179.         # this would be the usual behaviour
1180.         self.assertNotContains(response, 'value="test_value"')
1181.         # this is the overridden behaviour
1182.         self.assertContains(response, 'value="overridden_value"')
1183. 
1184. 
1185. @override_settings(ROOT_URLCONF='admin_views.urls')
1186. class AdminJavaScriptTest(TestCase):
1187. 
1188.     @classmethod
1189.     def setUpTestData(cls):
1190.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1191. 
1192.     def setUp(self):
1193.         self.client.force_login(self.superuser)
1194. 
1195.     def test_js_minified_only_if_debug_is_false(self):
1196.         """
1197.         The minified versions of the JS files are only used when DEBUG is False.
1198.         """
1199.         with override_settings(DEBUG=False):
1200.             response = self.client.get(reverse('admin:admin_views_section_add'))
1201.             self.assertNotContains(response, 'vendor/jquery/jquery.js')
1202.             self.assertContains(response, 'vendor/jquery/jquery.min.js')
1203.             self.assertNotContains(response, 'prepopulate.js')
1204.             self.assertContains(response, 'prepopulate.min.js')
1205.             self.assertNotContains(response, 'actions.js')
1206.             self.assertContains(response, 'actions.min.js')
1207.             self.assertNotContains(response, 'collapse.js')
1208.             self.assertContains(response, 'collapse.min.js')
1209.             self.assertNotContains(response, 'inlines.js')
1210.             self.assertContains(response, 'inlines.min.js')
1211.         with override_settings(DEBUG=True):
1212.             response = self.client.get(reverse('admin:admin_views_section_add'))
1213.             self.assertContains(response, 'vendor/jquery/jquery.js')
1214.             self.assertNotContains(response, 'vendor/jquery/jquery.min.js')
1215.             self.assertContains(response, 'prepopulate.js')
1216.             self.assertNotContains(response, 'prepopulate.min.js')
1217.             self.assertContains(response, 'actions.js')
1218.             self.assertNotContains(response, 'actions.min.js')
1219.             self.assertContains(response, 'collapse.js')
1220.             self.assertNotContains(response, 'collapse.min.js')
1221.             self.assertContains(response, 'inlines.js')
1222.             self.assertNotContains(response, 'inlines.min.js')
1223. 
1224. 
1225. @override_settings(ROOT_URLCONF='admin_views.urls')
1226. class SaveAsTests(TestCase):
1227. 
1228.     @classmethod
1229.     def setUpTestData(cls):
1230.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1231.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
1232. 
1233.     def setUp(self):
1234.         self.client.force_login(self.superuser)
1235. 
1236.     def test_save_as_duplication(self):
1237.         """'save as' creates a new person"""
1238.         post_data = {'_saveasnew': '', 'name': 'John M', 'gender': 1, 'age': 42}
1239.         response = self.client.post(reverse('admin:admin_views_person_change', args=(self.per1.pk,)), post_data)
1240.         self.assertEqual(len(Person.objects.filter(name='John M')), 1)
1241.         self.assertEqual(len(Person.objects.filter(id=self.per1.pk)), 1)
1242.         new_person = Person.objects.latest('id')
1243.         self.assertRedirects(response, reverse('admin:admin_views_person_change', args=(new_person.pk,)))
1244. 
1245.     def test_save_as_continue_false(self):
1246.         """
1247.         Saving a new object using "Save as new" redirects to the changelist
1248.         instead of the change view when ModelAdmin.save_as_continue=False.
1249.         """
1250.         post_data = {'_saveasnew': '', 'name': 'John M', 'gender': 1, 'age': 42}
1251.         url = reverse('admin:admin_views_person_change', args=(self.per1.pk,), current_app=site2.name)
1252.         response = self.client.post(url, post_data)
1253.         self.assertEqual(len(Person.objects.filter(name='John M')), 1)
1254.         self.assertEqual(len(Person.objects.filter(id=self.per1.pk)), 1)
1255.         self.assertRedirects(response, reverse('admin:admin_views_person_changelist', current_app=site2.name))
1256. 
1257.     def test_save_as_new_with_validation_errors(self):
1258.         """
1259.         When you click "Save as new" and have a validation error,
1260.         you only see the "Save as new" button and not the other save buttons,
1261.         and that only the "Save as" button is visible.
1262.         """
1263.         response = self.client.post(reverse('admin:admin_views_person_change', args=(self.per1.pk,)), {
1264.             '_saveasnew': '',
1265.             'gender': 'invalid',
1266.             '_addanother': 'fail',
1267.         })
1268.         self.assertContains(response, 'Please correct the errors below.')
1269.         self.assertFalse(response.context['show_save_and_add_another'])
1270.         self.assertFalse(response.context['show_save_and_continue'])
1271.         self.assertTrue(response.context['show_save_as_new'])
1272. 
1273.     def test_save_as_new_with_validation_errors_with_inlines(self):
1274.         parent = Parent.objects.create(name='Father')
1275.         child = Child.objects.create(parent=parent, name='Child')
1276.         response = self.client.post(reverse('admin:admin_views_parent_change', args=(parent.pk,)), {
1277.             '_saveasnew': 'Save as new',
1278.             'child_set-0-parent': parent.pk,
1279.             'child_set-0-id': child.pk,
1280.             'child_set-0-name': 'Child',
1281.             'child_set-INITIAL_FORMS': 1,
1282.             'child_set-MAX_NUM_FORMS': 1000,
1283.             'child_set-MIN_NUM_FORMS': 0,
1284.             'child_set-TOTAL_FORMS': 4,
1285.             'name': '_invalid',
1286.         })
1287.         self.assertContains(response, 'Please correct the error below.')
1288.         self.assertFalse(response.context['show_save_and_add_another'])
1289.         self.assertFalse(response.context['show_save_and_continue'])
1290.         self.assertTrue(response.context['show_save_as_new'])
1291. 
1292.     def test_save_as_new_with_inlines_with_validation_errors(self):
1293.         parent = Parent.objects.create(name='Father')
1294.         child = Child.objects.create(parent=parent, name='Child')
1295.         response = self.client.post(reverse('admin:admin_views_parent_change', args=(parent.pk,)), {
1296.             '_saveasnew': 'Save as new',
1297.             'child_set-0-parent': parent.pk,
1298.             'child_set-0-id': child.pk,
1299.             'child_set-0-name': '_invalid',
1300.             'child_set-INITIAL_FORMS': 1,
1301.             'child_set-MAX_NUM_FORMS': 1000,
1302.             'child_set-MIN_NUM_FORMS': 0,
1303.             'child_set-TOTAL_FORMS': 4,
1304.             'name': 'Father',
1305.         })
1306.         self.assertContains(response, 'Please correct the error below.')
1307.         self.assertFalse(response.context['show_save_and_add_another'])
1308.         self.assertFalse(response.context['show_save_and_continue'])
1309.         self.assertTrue(response.context['show_save_as_new'])
1310. 
1311. 
1312. @override_settings(ROOT_URLCONF='admin_views.urls')
1313. class CustomModelAdminTest(AdminViewBasicTestCase):
1314. 
1315.     def test_custom_admin_site_login_form(self):
1316.         self.client.logout()
1317.         response = self.client.get(reverse('admin2:index'), follow=True)
1318.         self.assertIsInstance(response, TemplateResponse)
1319.         self.assertEqual(response.status_code, 200)
1320.         login = self.client.post(reverse('admin2:login'), {
1321.             REDIRECT_FIELD_NAME: reverse('admin2:index'),
1322.             'username': 'customform',
1323.             'password': 'secret',
1324.         }, follow=True)
1325.         self.assertIsInstance(login, TemplateResponse)
1326.         self.assertEqual(login.status_code, 200)
1327.         self.assertContains(login, 'custom form error')
1328.         self.assertContains(login, 'path/to/media.css')
1329. 
1330.     def test_custom_admin_site_login_template(self):
1331.         self.client.logout()
1332.         response = self.client.get(reverse('admin2:index'), follow=True)
1333.         self.assertIsInstance(response, TemplateResponse)
1334.         self.assertTemplateUsed(response, 'custom_admin/login.html')
1335.         self.assertContains(response, 'Hello from a custom login template')
1336. 
1337.     def test_custom_admin_site_logout_template(self):
1338.         response = self.client.get(reverse('admin2:logout'))
1339.         self.assertIsInstance(response, TemplateResponse)
1340.         self.assertTemplateUsed(response, 'custom_admin/logout.html')
1341.         self.assertContains(response, 'Hello from a custom logout template')
1342. 
1343.     def test_custom_admin_site_index_view_and_template(self):
1344.         response = self.client.get(reverse('admin2:index'))
1345.         self.assertIsInstance(response, TemplateResponse)
1346.         self.assertTemplateUsed(response, 'custom_admin/index.html')
1347.         self.assertContains(response, 'Hello from a custom index template *bar*')
1348. 
1349.     def test_custom_admin_site_app_index_view_and_template(self):
1350.         response = self.client.get(reverse('admin2:app_list', args=('admin_views',)))
1351.         self.assertIsInstance(response, TemplateResponse)
1352.         self.assertTemplateUsed(response, 'custom_admin/app_index.html')
1353.         self.assertContains(response, 'Hello from a custom app_index template')
1354. 
1355.     def test_custom_admin_site_password_change_template(self):
1356.         response = self.client.get(reverse('admin2:password_change'))
1357.         self.assertIsInstance(response, TemplateResponse)
1358.         self.assertTemplateUsed(response, 'custom_admin/password_change_form.html')
1359.         self.assertContains(response, 'Hello from a custom password change form template')
1360. 
1361.     def test_custom_admin_site_password_change_with_extra_context(self):
1362.         response = self.client.get(reverse('admin2:password_change'))
1363.         self.assertIsInstance(response, TemplateResponse)
1364.         self.assertTemplateUsed(response, 'custom_admin/password_change_form.html')
1365.         self.assertContains(response, 'eggs')
1366. 
1367.     def test_custom_admin_site_password_change_done_template(self):
1368.         response = self.client.get(reverse('admin2:password_change_done'))
1369.         self.assertIsInstance(response, TemplateResponse)
1370.         self.assertTemplateUsed(response, 'custom_admin/password_change_done.html')
1371.         self.assertContains(response, 'Hello from a custom password change done template')
1372. 
1373.     def test_custom_admin_site_view(self):
1374.         self.client.force_login(self.superuser)
1375.         response = self.client.get(reverse('admin2:my_view'))
1376.         self.assertEqual(response.content, b"Django is a magical pony!")
1377. 
1378.     def test_pwd_change_custom_template(self):
1379.         self.client.force_login(self.superuser)
1380.         su = User.objects.get(username='super')
1381.         response = self.client.get(reverse('admin4:auth_user_password_change', args=(su.pk,)))
1382.         self.assertEqual(response.status_code, 200)
1383. 
1384. 
1385. def get_perm(Model, codename):
1386.     """Return the permission object, for the Model"""
1387.     ct = ContentType.objects.get_for_model(Model, for_concrete_model=False)
1388.     return Permission.objects.get(content_type=ct, codename=codename)
1389. 
1390. 
1391. @override_settings(
1392.     ROOT_URLCONF='admin_views.urls',
1393.     # Test with the admin's documented list of required context processors.
1394.     TEMPLATES=[{
1395.         'BACKEND': 'django.template.backends.django.DjangoTemplates',
1396.         'APP_DIRS': True,
1397.         'OPTIONS': {
1398.             'context_processors': [
1399.                 'django.contrib.auth.context_processors.auth',
1400.                 'django.contrib.messages.context_processors.messages',
1401.             ],
1402.         },
1403.     }],
1404. )
1405. class AdminViewPermissionsTest(TestCase):
1406.     """Tests for Admin Views Permissions."""
1407. 
1408.     @classmethod
1409.     def setUpTestData(cls):
1410.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
1411.         cls.viewuser = User.objects.create_user(username='viewuser', password='secret', is_staff=True)
1412.         cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
1413.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
1414.         cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
1415.         cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
1416.         cls.nostaffuser = User.objects.create_user(username='nostaff', password='secret')
1417.         cls.s1 = Section.objects.create(name='Test section')
1418.         cls.a1 = Article.objects.create(
1419.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1,
1420.             another_section=cls.s1,
1421.         )
1422.         cls.a2 = Article.objects.create(
1423.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
1424.         )
1425.         cls.a3 = Article.objects.create(
1426.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
1427.         )
1428.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
1429. 
1430.         # Setup permissions, for our users who can add, change, and delete.
1431.         opts = Article._meta
1432. 
1433.         # User who can view Articles
1434.         cls.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('view', opts)))
1435.         # User who can add Articles
1436.         cls.adduser.user_permissions.add(get_perm(Article, get_permission_codename('add', opts)))
1437.         # User who can change Articles
1438.         cls.changeuser.user_permissions.add(get_perm(Article, get_permission_codename('change', opts)))
1439.         cls.nostaffuser.user_permissions.add(get_perm(Article, get_permission_codename('change', opts)))
1440. 
1441.         # User who can delete Articles
1442.         cls.deleteuser.user_permissions.add(get_perm(Article, get_permission_codename('delete', opts)))
1443.         cls.deleteuser.user_permissions.add(get_perm(Section, get_permission_codename('delete', Section._meta)))
1444. 
1445.         # login POST dicts
1446.         cls.index_url = reverse('admin:index')
1447.         cls.super_login = {
1448.             REDIRECT_FIELD_NAME: cls.index_url,
1449.             'username': 'super',
1450.             'password': 'secret',
1451.         }
1452.         cls.super_email_login = {
1453.             REDIRECT_FIELD_NAME: cls.index_url,
1454.             'username': 'super@example.com',
1455.             'password': 'secret',
1456.         }
1457.         cls.super_email_bad_login = {
1458.             REDIRECT_FIELD_NAME: cls.index_url,
1459.             'username': 'super@example.com',
1460.             'password': 'notsecret',
1461.         }
1462.         cls.adduser_login = {
1463.             REDIRECT_FIELD_NAME: cls.index_url,
1464.             'username': 'adduser',
1465.             'password': 'secret',
1466.         }
1467.         cls.changeuser_login = {
1468.             REDIRECT_FIELD_NAME: cls.index_url,
1469.             'username': 'changeuser',
1470.             'password': 'secret',
1471.         }
1472.         cls.deleteuser_login = {
1473.             REDIRECT_FIELD_NAME: cls.index_url,
1474.             'username': 'deleteuser',
1475.             'password': 'secret',
1476.         }
1477.         cls.nostaff_login = {
1478.             REDIRECT_FIELD_NAME: reverse('has_permission_admin:index'),
1479.             'username': 'nostaff',
1480.             'password': 'secret',
1481.         }
1482.         cls.joepublic_login = {
1483.             REDIRECT_FIELD_NAME: cls.index_url,
1484.             'username': 'joepublic',
1485.             'password': 'secret',
1486.         }
1487.         cls.viewuser_login = {
1488.             REDIRECT_FIELD_NAME: cls.index_url,
1489.             'username': 'viewuser',
1490.             'password': 'secret',
1491.         }
1492.         cls.no_username_login = {
1493.             REDIRECT_FIELD_NAME: cls.index_url,
1494.             'password': 'secret',
1495.         }
1496. 
1497.     def test_login(self):
1498.         """
1499.         Make sure only staff members can log in.
1500. 
1501.         Successful posts to the login page will redirect to the original url.
1502.         Unsuccessful attempts will continue to render the login page with
1503.         a 200 status code.
1504.         """
1505.         login_url = '%s?next=%s' % (reverse('admin:login'), reverse('admin:index'))
1506.         # Super User
1507.         response = self.client.get(self.index_url)
1508.         self.assertRedirects(response, login_url)
1509.         login = self.client.post(login_url, self.super_login)
1510.         self.assertRedirects(login, self.index_url)
1511.         self.assertFalse(login.context)
1512.         self.client.get(reverse('admin:logout'))
1513. 
1514.         # Test if user enters email address
1515.         response = self.client.get(self.index_url)
1516.         self.assertEqual(response.status_code, 302)
1517.         login = self.client.post(login_url, self.super_email_login)
1518.         self.assertContains(login, ERROR_MESSAGE)
1519.         # only correct passwords get a username hint
1520.         login = self.client.post(login_url, self.super_email_bad_login)
1521.         self.assertContains(login, ERROR_MESSAGE)
1522.         new_user = User(username='jondoe', password='secret', email='super@example.com')
1523.         new_user.save()
1524.         # check to ensure if there are multiple email addresses a user doesn't get a 500
1525.         login = self.client.post(login_url, self.super_email_login)
1526.         self.assertContains(login, ERROR_MESSAGE)
1527. 
1528.         # View User
1529.         response = self.client.get(self.index_url)
1530.         self.assertEqual(response.status_code, 302)
1531.         login = self.client.post(login_url, self.viewuser_login)
1532.         self.assertRedirects(login, self.index_url)
1533.         self.assertFalse(login.context)
1534.         self.client.get(reverse('admin:logout'))
1535. 
1536.         # Add User
1537.         response = self.client.get(self.index_url)
1538.         self.assertEqual(response.status_code, 302)
1539.         login = self.client.post(login_url, self.adduser_login)
1540.         self.assertRedirects(login, self.index_url)
1541.         self.assertFalse(login.context)
1542.         self.client.get(reverse('admin:logout'))
1543. 
1544.         # Change User
1545.         response = self.client.get(self.index_url)
1546.         self.assertEqual(response.status_code, 302)
1547.         login = self.client.post(login_url, self.changeuser_login)
1548.         self.assertRedirects(login, self.index_url)
1549.         self.assertFalse(login.context)
1550.         self.client.get(reverse('admin:logout'))
1551. 
1552.         # Delete User
1553.         response = self.client.get(self.index_url)
1554.         self.assertEqual(response.status_code, 302)
1555.         login = self.client.post(login_url, self.deleteuser_login)
1556.         self.assertRedirects(login, self.index_url)
1557.         self.assertFalse(login.context)
1558.         self.client.get(reverse('admin:logout'))
1559. 
1560.         # Regular User should not be able to login.
1561.         response = self.client.get(self.index_url)
1562.         self.assertEqual(response.status_code, 302)
1563.         login = self.client.post(login_url, self.joepublic_login)
1564.         self.assertEqual(login.status_code, 200)
1565.         self.assertContains(login, ERROR_MESSAGE)
1566. 
1567.         # Requests without username should not return 500 errors.
1568.         response = self.client.get(self.index_url)
1569.         self.assertEqual(response.status_code, 302)
1570.         login = self.client.post(login_url, self.no_username_login)
1571.         self.assertEqual(login.status_code, 200)
1572.         self.assertFormError(login, 'form', 'username', ['This field is required.'])
1573. 
1574.     def test_login_redirect_for_direct_get(self):
1575.         """
1576.         Login redirect should be to the admin index page when going directly to
1577.         /admin/login/.
1578.         """
1579.         response = self.client.get(reverse('admin:login'))
1580.         self.assertEqual(response.status_code, 200)
1581.         self.assertEqual(response.context[REDIRECT_FIELD_NAME], reverse('admin:index'))
1582. 
1583.     def test_login_has_permission(self):
1584.         # Regular User should not be able to login.
1585.         response = self.client.get(reverse('has_permission_admin:index'))
1586.         self.assertEqual(response.status_code, 302)
1587.         login = self.client.post(reverse('has_permission_admin:login'), self.joepublic_login)
1588.         self.assertEqual(login.status_code, 200)
1589.         self.assertContains(login, 'permission denied')
1590. 
1591.         # User with permissions should be able to login.
1592.         response = self.client.get(reverse('has_permission_admin:index'))
1593.         self.assertEqual(response.status_code, 302)
1594.         login = self.client.post(reverse('has_permission_admin:login'), self.nostaff_login)
1595.         self.assertRedirects(login, reverse('has_permission_admin:index'))
1596.         self.assertFalse(login.context)
1597.         self.client.get(reverse('has_permission_admin:logout'))
1598. 
1599.         # Staff should be able to login.
1600.         response = self.client.get(reverse('has_permission_admin:index'))
1601.         self.assertEqual(response.status_code, 302)
1602.         login = self.client.post(reverse('has_permission_admin:login'), {
1603.             REDIRECT_FIELD_NAME: reverse('has_permission_admin:index'),
1604.             'username': 'deleteuser',
1605.             'password': 'secret',
1606.         })
1607.         self.assertRedirects(login, reverse('has_permission_admin:index'))
1608.         self.assertFalse(login.context)
1609.         self.client.get(reverse('has_permission_admin:logout'))
1610. 
1611.     def test_login_successfully_redirects_to_original_URL(self):
1612.         response = self.client.get(self.index_url)
1613.         self.assertEqual(response.status_code, 302)
1614.         query_string = 'the-answer=42'
1615.         redirect_url = '%s?%s' % (self.index_url, query_string)
1616.         new_next = {REDIRECT_FIELD_NAME: redirect_url}
1617.         post_data = self.super_login.copy()
1618.         post_data.pop(REDIRECT_FIELD_NAME)
1619.         login = self.client.post(
1620.             '%s?%s' % (reverse('admin:login'), urlencode(new_next)),
1621.             post_data)
1622.         self.assertRedirects(login, redirect_url)
1623. 
1624.     def test_double_login_is_not_allowed(self):
1625.         """Regression test for #19327"""
1626.         login_url = '%s?next=%s' % (reverse('admin:login'), reverse('admin:index'))
1627. 
1628.         response = self.client.get(self.index_url)
1629.         self.assertEqual(response.status_code, 302)
1630. 
1631.         # Establish a valid admin session
1632.         login = self.client.post(login_url, self.super_login)
1633.         self.assertRedirects(login, self.index_url)
1634.         self.assertFalse(login.context)
1635. 
1636.         # Logging in with non-admin user fails
1637.         login = self.client.post(login_url, self.joepublic_login)
1638.         self.assertEqual(login.status_code, 200)
1639.         self.assertContains(login, ERROR_MESSAGE)
1640. 
1641.         # Establish a valid admin session
1642.         login = self.client.post(login_url, self.super_login)
1643.         self.assertRedirects(login, self.index_url)
1644.         self.assertFalse(login.context)
1645. 
1646.         # Logging in with admin user while already logged in
1647.         login = self.client.post(login_url, self.super_login)
1648.         self.assertRedirects(login, self.index_url)
1649.         self.assertFalse(login.context)
1650.         self.client.get(reverse('admin:logout'))
1651. 
1652.     def test_login_page_notice_for_non_staff_users(self):
1653.         """
1654.         A logged-in non-staff user trying to access the admin index should be
1655.         presented with the login page and a hint indicating that the current
1656.         user doesn't have access to it.
1657.         """
1658.         hint_template = 'You are authenticated as {}'
1659. 
1660.         # Anonymous user should not be shown the hint
1661.         response = self.client.get(self.index_url, follow=True)
1662.         self.assertContains(response, 'login-form')
1663.         self.assertNotContains(response, hint_template.format(''), status_code=200)
1664. 
1665.         # Non-staff user should be shown the hint
1666.         self.client.force_login(self.nostaffuser)
1667.         response = self.client.get(self.index_url, follow=True)
1668.         self.assertContains(response, 'login-form')
1669.         self.assertContains(response, hint_template.format(self.nostaffuser.username), status_code=200)
1670. 
1671.     def test_add_view(self):
1672.         """Test add view restricts access and actually adds items."""
1673.         add_dict = {
1674.             'title': 'Døm ikke',
1675.             'content': '<p>great article</p>',
1676.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1677.             'section': self.s1.pk,
1678.         }
1679.         # Change User should not have access to add articles
1680.         self.client.force_login(self.changeuser)
1681.         # make sure the view removes test cookie
1682.         self.assertIs(self.client.session.test_cookie_worked(), False)
1683.         response = self.client.get(reverse('admin:admin_views_article_add'))
1684.         self.assertEqual(response.status_code, 403)
1685.         # Try POST just to make sure
1686.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1687.         self.assertEqual(post.status_code, 403)
1688.         self.assertEqual(Article.objects.count(), 3)
1689.         self.client.get(reverse('admin:logout'))
1690. 
1691.         # View User should not have access to add articles
1692.         self.client.force_login(self.viewuser)
1693.         response = self.client.get(reverse('admin:admin_views_article_add'))
1694.         self.assertEqual(response.status_code, 403)
1695.         # Try POST just to make sure
1696.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1697.         self.assertEqual(post.status_code, 403)
1698.         self.assertEqual(Article.objects.count(), 3)
1699.         # Now give the user permission to add but not change.
1700.         self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('add', Article._meta)))
1701.         response = self.client.get(reverse('admin:admin_views_article_add'))
1702.         self.assertContains(response, '<input type="submit" value="Save and view" name="_continue">')
1703.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict, follow=False)
1704.         self.assertEqual(post.status_code, 302)
1705.         self.assertEqual(Article.objects.count(), 4)
1706.         article = Article.objects.latest('pk')
1707.         response = self.client.get(reverse('admin:admin_views_article_change', args=(article.pk,)))
1708.         self.assertContains(response, '<li class="success">The article "Døm ikke" was added successfully.</li>')
1709.         article.delete()
1710.         self.client.get(reverse('admin:logout'))
1711. 
1712.         # Add user may login and POST to add view, then redirect to admin root
1713.         self.client.force_login(self.adduser)
1714.         addpage = self.client.get(reverse('admin:admin_views_article_add'))
1715.         change_list_link = '&rsaquo; <a href="%s">Articles</a>' % reverse('admin:admin_views_article_changelist')
1716.         self.assertNotContains(
1717.             addpage, change_list_link,
1718.             msg_prefix='User restricted to add permission is given link to change list view in breadcrumbs.'
1719.         )
1720.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1721.         self.assertRedirects(post, self.index_url)
1722.         self.assertEqual(Article.objects.count(), 4)
1723.         self.assertEqual(len(mail.outbox), 2)
1724.         self.assertEqual(mail.outbox[0].subject, 'Greetings from a created object')
1725.         self.client.get(reverse('admin:logout'))
1726. 
1727.         # The addition was logged correctly
1728.         addition_log = LogEntry.objects.all()[0]
1729.         new_article = Article.objects.last()
1730.         article_ct = ContentType.objects.get_for_model(Article)
1731.         self.assertEqual(addition_log.user_id, self.adduser.pk)
1732.         self.assertEqual(addition_log.content_type_id, article_ct.pk)
1733.         self.assertEqual(addition_log.object_id, str(new_article.pk))
1734.         self.assertEqual(addition_log.object_repr, "Døm ikke")
1735.         self.assertEqual(addition_log.action_flag, ADDITION)
1736.         self.assertEqual(addition_log.get_change_message(), "Added.")
1737. 
1738.         # Super can add too, but is redirected to the change list view
1739.         self.client.force_login(self.superuser)
1740.         addpage = self.client.get(reverse('admin:admin_views_article_add'))
1741.         self.assertContains(
1742.             addpage, change_list_link,
1743.             msg_prefix='Unrestricted user is not given link to change list view in breadcrumbs.'
1744.         )
1745.         post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
1746.         self.assertRedirects(post, reverse('admin:admin_views_article_changelist'))
1747.         self.assertEqual(Article.objects.count(), 5)
1748.         self.client.get(reverse('admin:logout'))
1749. 
1750.         # 8509 - if a normal user is already logged in, it is possible
1751.         # to change user into the superuser without error
1752.         self.client.force_login(self.joepublicuser)
1753.         # Check and make sure that if user expires, data still persists
1754.         self.client.force_login(self.superuser)
1755.         # make sure the view removes test cookie
1756.         self.assertIs(self.client.session.test_cookie_worked(), False)
1757. 
1758.     @mock.patch('django.contrib.admin.options.InlineModelAdmin.has_change_permission')
1759.     def test_add_view_with_view_only_inlines(self, has_change_permission):
1760.         """User with add permission to a section but view-only for inlines."""
1761.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('add', Section._meta)))
1762.         self.client.force_login(self.viewuser)
1763.         # Valid POST creates a new section.
1764.         data = {
1765.             'name': 'New obj',
1766.             'article_set-TOTAL_FORMS': 0,
1767.             'article_set-INITIAL_FORMS': 0,
1768.         }
1769.         response = self.client.post(reverse('admin:admin_views_section_add'), data)
1770.         self.assertRedirects(response, reverse('admin:index'))
1771.         self.assertEqual(Section.objects.latest('id').name, data['name'])
1772.         # InlineModelAdmin.has_change_permission()'s obj argument is always
1773.         # None during object add.
1774.         self.assertEqual([obj for (request, obj), _ in has_change_permission.call_args_list], [None, None])
1775. 
1776.     def test_change_view(self):
1777.         """Change view should restrict access and allow users to edit items."""
1778.         change_dict = {
1779.             'title': 'Ikke fordømt',
1780.             'content': '<p>edited article</p>',
1781.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1782.             'section': self.s1.pk,
1783.         }
1784.         article_change_url = reverse('admin:admin_views_article_change', args=(self.a1.pk,))
1785.         article_changelist_url = reverse('admin:admin_views_article_changelist')
1786. 
1787.         # add user should not be able to view the list of article or change any of them
1788.         self.client.force_login(self.adduser)
1789.         response = self.client.get(article_changelist_url)
1790.         self.assertEqual(response.status_code, 403)
1791.         response = self.client.get(article_change_url)
1792.         self.assertEqual(response.status_code, 403)
1793.         post = self.client.post(article_change_url, change_dict)
1794.         self.assertEqual(post.status_code, 403)
1795.         self.client.get(reverse('admin:logout'))
1796. 
1797.         # view user should be able to view the article but not change any of them
1798.         # (the POST can be sent, but no modification occurs)
1799.         self.client.force_login(self.viewuser)
1800.         response = self.client.get(article_changelist_url)
1801.         self.assertEqual(response.status_code, 200)
1802.         self.assertEqual(response.context['title'], 'Select article to view')
1803.         response = self.client.get(article_change_url)
1804.         self.assertEqual(response.status_code, 200)
1805.         self.assertEqual(response.context['title'], 'View article')
1806.         self.assertContains(response, '<label>Extra form field:</label>')
1807.         self.assertContains(response, '<a href="/test_admin/admin/admin_views/article/" class="closelink">Close</a>')
1808.         post = self.client.post(article_change_url, change_dict)
1809.         self.assertEqual(post.status_code, 302)
1810.         self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>Middle content</p>')
1811.         self.client.get(reverse('admin:logout'))
1812. 
1813.         # change user can view all items and edit them
1814.         self.client.force_login(self.changeuser)
1815.         response = self.client.get(article_changelist_url)
1816.         self.assertEqual(response.status_code, 200)
1817.         self.assertEqual(response.context['title'], 'Select article to change')
1818.         response = self.client.get(article_change_url)
1819.         self.assertEqual(response.status_code, 200)
1820.         self.assertEqual(response.context['title'], 'Change article')
1821.         post = self.client.post(article_change_url, change_dict)
1822.         self.assertRedirects(post, article_changelist_url)
1823.         self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>edited article</p>')
1824. 
1825.         # one error in form should produce singular error message, multiple errors plural
1826.         change_dict['title'] = ''
1827.         post = self.client.post(article_change_url, change_dict)
1828.         self.assertContains(
1829.             post, 'Please correct the error below.',
1830.             msg_prefix='Singular error message not found in response to post with one error'
1831.         )
1832. 
1833.         change_dict['content'] = ''
1834.         post = self.client.post(article_change_url, change_dict)
1835.         self.assertContains(
1836.             post, 'Please correct the errors below.',
1837.             msg_prefix='Plural error message not found in response to post with multiple errors'
1838.         )
1839.         self.client.get(reverse('admin:logout'))
1840. 
1841.         # Test redirection when using row-level change permissions. Refs #11513.
1842.         r1 = RowLevelChangePermissionModel.objects.create(id=1, name="odd id")
1843.         r2 = RowLevelChangePermissionModel.objects.create(id=2, name="even id")
1844.         r3 = RowLevelChangePermissionModel.objects.create(id=3, name='odd id mult 3')
1845.         r6 = RowLevelChangePermissionModel.objects.create(id=6, name='even id mult 3')
1846.         change_url_1 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r1.pk,))
1847.         change_url_2 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r2.pk,))
1848.         change_url_3 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r3.pk,))
1849.         change_url_6 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r6.pk,))
1850.         logins = [self.superuser, self.viewuser, self.adduser, self.changeuser, self.deleteuser]
1851.         for login_user in logins:
1852.             with self.subTest(login_user.username):
1853.                 self.client.force_login(login_user)
1854.                 response = self.client.get(change_url_1)
1855.                 self.assertEqual(response.status_code, 403)
1856.                 response = self.client.post(change_url_1, {'name': 'changed'})
1857.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=1).name, 'odd id')
1858.                 self.assertEqual(response.status_code, 403)
1859.                 response = self.client.get(change_url_2)
1860.                 self.assertEqual(response.status_code, 200)
1861.                 response = self.client.post(change_url_2, {'name': 'changed'})
1862.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=2).name, 'changed')
1863.                 self.assertRedirects(response, self.index_url)
1864.                 response = self.client.get(change_url_3)
1865.                 self.assertEqual(response.status_code, 200)
1866.                 response = self.client.post(change_url_3, {'name': 'changed'})
1867.                 self.assertRedirects(response, self.index_url)
1868.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=3).name, 'odd id mult 3')
1869.                 response = self.client.get(change_url_6)
1870.                 self.assertEqual(response.status_code, 200)
1871.                 response = self.client.post(change_url_6, {'name': 'changed'})
1872.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=6).name, 'changed')
1873.                 self.assertRedirects(response, self.index_url)
1874. 
1875.                 self.client.get(reverse('admin:logout'))
1876. 
1877.         for login_user in [self.joepublicuser, self.nostaffuser]:
1878.             with self.subTest(login_user.username):
1879.                 self.client.force_login(login_user)
1880.                 response = self.client.get(change_url_1, follow=True)
1881.                 self.assertContains(response, 'login-form')
1882.                 response = self.client.post(change_url_1, {'name': 'changed'}, follow=True)
1883.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=1).name, 'odd id')
1884.                 self.assertContains(response, 'login-form')
1885.                 response = self.client.get(change_url_2, follow=True)
1886.                 self.assertContains(response, 'login-form')
1887.                 response = self.client.post(change_url_2, {'name': 'changed again'}, follow=True)
1888.                 self.assertEqual(RowLevelChangePermissionModel.objects.get(id=2).name, 'changed')
1889.                 self.assertContains(response, 'login-form')
1890.                 self.client.get(reverse('admin:logout'))
1891. 
1892.     def test_change_view_without_object_change_permission(self):
1893.         """
1894.         The object should be read-only if the user has permission to view it
1895.         and change objects of that type but not to change the current object.
1896.         """
1897.         change_url = reverse('admin9:admin_views_article_change', args=(self.a1.pk,))
1898.         self.client.force_login(self.viewuser)
1899.         response = self.client.get(change_url)
1900.         self.assertEqual(response.status_code, 200)
1901.         self.assertEqual(response.context['title'], 'View article')
1902.         self.assertContains(response, '<a href="/test_admin/admin9/admin_views/article/" class="closelink">Close</a>')
1903. 
1904.     def test_change_view_post_without_object_change_permission(self):
1905.         """A POST redirects to changelist without modifications."""
1906.         change_dict = {
1907.             'title': 'Ikke fordømt',
1908.             'content': '<p>edited article</p>',
1909.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1910.             'section': self.s1.pk,
1911.         }
1912.         change_url = reverse('admin10:admin_views_article_change', args=(self.a1.pk,))
1913.         changelist_url = reverse('admin10:admin_views_article_changelist')
1914.         self.client.force_login(self.viewuser)
1915.         response = self.client.post(change_url, change_dict)
1916.         self.assertRedirects(response, changelist_url)
1917.         self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>Middle content</p>')
1918. 
1919.     def test_change_view_save_as_new(self):
1920.         """
1921.         'Save as new' should raise PermissionDenied for users without the 'add'
1922.         permission.
1923.         """
1924.         change_dict_save_as_new = {
1925.             '_saveasnew': 'Save as new',
1926.             'title': 'Ikke fordømt',
1927.             'content': '<p>edited article</p>',
1928.             'date_0': '2008-03-18', 'date_1': '10:54:39',
1929.             'section': self.s1.pk,
1930.         }
1931.         article_change_url = reverse('admin:admin_views_article_change', args=(self.a1.pk,))
1932. 
1933.         # Add user can perform "Save as new".
1934.         article_count = Article.objects.count()
1935.         self.client.force_login(self.adduser)
1936.         post = self.client.post(article_change_url, change_dict_save_as_new)
1937.         self.assertRedirects(post, self.index_url)
1938.         self.assertEqual(Article.objects.count(), article_count + 1)
1939.         self.client.logout()
1940. 
1941.         # Change user cannot perform "Save as new" (no 'add' permission).
1942.         article_count = Article.objects.count()
1943.         self.client.force_login(self.changeuser)
1944.         post = self.client.post(article_change_url, change_dict_save_as_new)
1945.         self.assertEqual(post.status_code, 403)
1946.         self.assertEqual(Article.objects.count(), article_count)
1947. 
1948.         # User with both add and change permissions should be redirected to the
1949.         # change page for the newly created object.
1950.         article_count = Article.objects.count()
1951.         self.client.force_login(self.superuser)
1952.         post = self.client.post(article_change_url, change_dict_save_as_new)
1953.         self.assertEqual(Article.objects.count(), article_count + 1)
1954.         new_article = Article.objects.latest('id')
1955.         self.assertRedirects(post, reverse('admin:admin_views_article_change', args=(new_article.pk,)))
1956. 
1957.     def test_change_view_with_view_only_inlines(self):
1958.         """
1959.         User with change permission to a section but view-only for inlines.
1960.         """
1961.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
1962.         self.client.force_login(self.viewuser)
1963.         # GET shows inlines.
1964.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
1965.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
1966.         formset = response.context['inline_admin_formsets'][0]
1967.         self.assertEqual(len(formset.forms), 3)
1968.         # Valid POST changes the name.
1969.         data = {
1970.             'name': 'Can edit name with view-only inlines',
1971.             'article_set-TOTAL_FORMS': 3,
1972.             'article_set-INITIAL_FORMS': 3
1973.         }
1974.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
1975.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
1976.         self.assertEqual(Section.objects.get(pk=self.s1.pk).name, data['name'])
1977.         # Invalid POST reshows inlines.
1978.         del data['name']
1979.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
1980.         self.assertEqual(response.status_code, 200)
1981.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
1982.         formset = response.context['inline_admin_formsets'][0]
1983.         self.assertEqual(len(formset.forms), 3)
1984. 
1985.     def test_change_view_with_view_and_add_inlines(self):
1986.         """User has view and add permissions on the inline model."""
1987.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
1988.         self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('add', Article._meta)))
1989.         self.client.force_login(self.viewuser)
1990.         # GET shows inlines.
1991.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
1992.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
1993.         formset = response.context['inline_admin_formsets'][0]
1994.         self.assertEqual(len(formset.forms), 6)
1995.         # Valid POST creates a new article.
1996.         data = {
1997.             'name': 'Can edit name with view-only inlines',
1998.             'article_set-TOTAL_FORMS': 6,
1999.             'article_set-INITIAL_FORMS': 3,
2000.             'article_set-3-id': [''],
2001.             'article_set-3-title': ['A title'],
2002.             'article_set-3-content': ['Added content'],
2003.             'article_set-3-date_0': ['2008-3-18'],
2004.             'article_set-3-date_1': ['11:54:58'],
2005.             'article_set-3-section': [str(self.s1.pk)],
2006.         }
2007.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2008.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
2009.         self.assertEqual(Section.objects.get(pk=self.s1.pk).name, data['name'])
2010.         self.assertEqual(Article.objects.count(), 4)
2011.         # Invalid POST reshows inlines.
2012.         del data['name']
2013.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2014.         self.assertEqual(response.status_code, 200)
2015.         self.assertEqual(len(response.context['inline_admin_formsets']), 1)
2016.         formset = response.context['inline_admin_formsets'][0]
2017.         self.assertEqual(len(formset.forms), 6)
2018. 
2019.     def test_change_view_with_view_and_delete_inlines(self):
2020.         """User has view and delete permissions on the inline model."""
2021.         self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
2022.         self.client.force_login(self.viewuser)
2023.         data = {
2024.             'name': 'Name is required.',
2025.             'article_set-TOTAL_FORMS': 6,
2026.             'article_set-INITIAL_FORMS': 3,
2027.             'article_set-0-id': [str(self.a1.pk)],
2028.             'article_set-0-DELETE': ['on'],
2029.         }
2030.         # Inline POST details are ignored without delete permission.
2031.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2032.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
2033.         self.assertEqual(Article.objects.count(), 3)
2034.         # Deletion successful when delete permission is added.
2035.         self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('delete', Article._meta)))
2036.         data = {
2037.             'name': 'Name is required.',
2038.             'article_set-TOTAL_FORMS': 6,
2039.             'article_set-INITIAL_FORMS': 3,
2040.             'article_set-0-id': [str(self.a1.pk)],
2041.             'article_set-0-DELETE': ['on'],
2042.         }
2043.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
2044.         self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
2045.         self.assertEqual(Article.objects.count(), 2)
2046. 
2047.     def test_delete_view(self):
2048.         """Delete view should restrict access and actually delete items."""
2049.         delete_dict = {'post': 'yes'}
2050.         delete_url = reverse('admin:admin_views_article_delete', args=(self.a1.pk,))
2051. 
2052.         # add user should not be able to delete articles
2053.         self.client.force_login(self.adduser)
2054.         response = self.client.get(delete_url)
2055.         self.assertEqual(response.status_code, 403)
2056.         post = self.client.post(delete_url, delete_dict)
2057.         self.assertEqual(post.status_code, 403)
2058.         self.assertEqual(Article.objects.count(), 3)
2059.         self.client.logout()
2060. 
2061.         # view user should not be able to delete articles
2062.         self.client.force_login(self.viewuser)
2063.         response = self.client.get(delete_url)
2064.         self.assertEqual(response.status_code, 403)
2065.         post = self.client.post(delete_url, delete_dict)
2066.         self.assertEqual(post.status_code, 403)
2067.         self.assertEqual(Article.objects.count(), 3)
2068.         self.client.logout()
2069. 
2070.         # Delete user can delete
2071.         self.client.force_login(self.deleteuser)
2072.         response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
2073.         self.assertContains(response, "<h2>Summary</h2>")
2074.         self.assertContains(response, "<li>Articles: 3</li>")
2075.         # test response contains link to related Article
2076.         self.assertContains(response, "admin_views/article/%s/" % self.a1.pk)
2077. 
2078.         response = self.client.get(delete_url)
2079.         self.assertContains(response, "admin_views/article/%s/" % self.a1.pk)
2080.         self.assertContains(response, "<h2>Summary</h2>")
2081.         self.assertContains(response, "<li>Articles: 1</li>")
2082.         self.assertEqual(response.status_code, 200)
2083.         post = self.client.post(delete_url, delete_dict)
2084.         self.assertRedirects(post, self.index_url)
2085.         self.assertEqual(Article.objects.count(), 2)
2086.         self.assertEqual(len(mail.outbox), 1)
2087.         self.assertEqual(mail.outbox[0].subject, 'Greetings from a deleted object')
2088.         article_ct = ContentType.objects.get_for_model(Article)
2089.         logged = LogEntry.objects.get(content_type=article_ct, action_flag=DELETION)
2090.         self.assertEqual(logged.object_id, str(self.a1.pk))
2091. 
2092.     def test_delete_view_with_no_default_permissions(self):
2093.         """
2094.         The delete view allows users to delete collected objects without a
2095.         'delete' permission (ReadOnlyPizza.Meta.default_permissions is empty).
2096.         """
2097.         pizza = ReadOnlyPizza.objects.create(name='Double Cheese')
2098.         delete_url = reverse('admin:admin_views_readonlypizza_delete', args=(pizza.pk,))
2099.         self.client.force_login(self.adduser)
2100.         response = self.client.get(delete_url)
2101.         self.assertContains(response, 'admin_views/readonlypizza/%s/' % pizza.pk)
2102.         self.assertContains(response, '<h2>Summary</h2>')
2103.         self.assertContains(response, '<li>Read only pizzas: 1</li>')
2104.         self.assertEqual(response.status_code, 200)
2105.         post = self.client.post(delete_url, {'post': 'yes'})
2106.         self.assertRedirects(post, reverse('admin:admin_views_readonlypizza_changelist'))
2107.         self.assertEqual(ReadOnlyPizza.objects.count(), 0)
2108. 
2109.     def test_delete_view_nonexistent_obj(self):
2110.         self.client.force_login(self.deleteuser)
2111.         url = reverse('admin:admin_views_article_delete', args=('nonexistent',))
2112.         response = self.client.get(url, follow=True)
2113.         self.assertRedirects(response, reverse('admin:index'))
2114.         self.assertEqual(
2115.             [m.message for m in response.context['messages']],
2116.             ["""article with ID "nonexistent" doesn't exist. Perhaps it was deleted?"""]
2117.         )
2118. 
2119.     def test_history_view(self):
2120.         """History view should restrict access."""
2121.         # add user should not be able to view the list of article or change any of them
2122.         self.client.force_login(self.adduser)
2123.         response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
2124.         self.assertEqual(response.status_code, 403)
2125.         self.client.get(reverse('admin:logout'))
2126. 
2127.         # view user can view all items
2128.         self.client.force_login(self.viewuser)
2129.         response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
2130.         self.assertEqual(response.status_code, 200)
2131.         self.client.get(reverse('admin:logout'))
2132. 
2133.         # change user can view all items and edit them
2134.         self.client.force_login(self.changeuser)
2135.         response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
2136.         self.assertEqual(response.status_code, 200)
2137. 
2138.         # Test redirection when using row-level change permissions. Refs #11513.
2139.         rl1 = RowLevelChangePermissionModel.objects.create(name="odd id")
2140.         rl2 = RowLevelChangePermissionModel.objects.create(name="even id")
2141.         logins = [self.superuser, self.viewuser, self.adduser, self.changeuser, self.deleteuser]
2142.         for login_user in logins:
2143.             with self.subTest(login_user.username):
2144.                 self.client.force_login(login_user)
2145.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl1.pk,))
2146.                 response = self.client.get(url)
2147.                 self.assertEqual(response.status_code, 403)
2148. 
2149.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl2.pk,))
2150.                 response = self.client.get(url)
2151.                 self.assertEqual(response.status_code, 200)
2152. 
2153.                 self.client.get(reverse('admin:logout'))
2154. 
2155.         for login_user in [self.joepublicuser, self.nostaffuser]:
2156.             with self.subTest(login_user.username):
2157.                 self.client.force_login(login_user)
2158.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl1.pk,))
2159.                 response = self.client.get(url, follow=True)
2160.                 self.assertContains(response, 'login-form')
2161.                 url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl2.pk,))
2162.                 response = self.client.get(url, follow=True)
2163.                 self.assertContains(response, 'login-form')
2164. 
2165.                 self.client.get(reverse('admin:logout'))
2166. 
2167.     def test_history_view_bad_url(self):
2168.         self.client.force_login(self.changeuser)
2169.         response = self.client.get(reverse('admin:admin_views_article_history', args=('foo',)), follow=True)
2170.         self.assertRedirects(response, reverse('admin:index'))
2171.         self.assertEqual(
2172.             [m.message for m in response.context['messages']],
2173.             ["""article with ID "foo" doesn't exist. Perhaps it was deleted?"""]
2174.         )
2175. 
2176.     def test_conditionally_show_add_section_link(self):
2177.         """
2178.         The foreign key widget should only show the "add related" button if the
2179.         user has permission to add that related item.
2180.         """
2181.         self.client.force_login(self.adduser)
2182.         # The user can't add sections yet, so they shouldn't see the "add section" link.
2183.         url = reverse('admin:admin_views_article_add')
2184.         add_link_text = 'add_id_section'
2185.         response = self.client.get(url)
2186.         self.assertNotContains(response, add_link_text)
2187.         # Allow the user to add sections too. Now they can see the "add section" link.
2188.         user = User.objects.get(username='adduser')
2189.         perm = get_perm(Section, get_permission_codename('add', Section._meta))
2190.         user.user_permissions.add(perm)
2191.         response = self.client.get(url)
2192.         self.assertContains(response, add_link_text)
2193. 
2194.     def test_conditionally_show_change_section_link(self):
2195.         """
2196.         The foreign key widget should only show the "change related" button if
2197.         the user has permission to change that related item.
2198.         """
2199.         def get_change_related(response):
2200.             return response.context['adminform'].form.fields['section'].widget.can_change_related
2201. 
2202.         self.client.force_login(self.adduser)
2203.         # The user can't change sections yet, so they shouldn't see the "change section" link.
2204.         url = reverse('admin:admin_views_article_add')
2205.         change_link_text = 'change_id_section'
2206.         response = self.client.get(url)
2207.         self.assertFalse(get_change_related(response))
2208.         self.assertNotContains(response, change_link_text)
2209.         # Allow the user to change sections too. Now they can see the "change section" link.
2210.         user = User.objects.get(username='adduser')
2211.         perm = get_perm(Section, get_permission_codename('change', Section._meta))
2212.         user.user_permissions.add(perm)
2213.         response = self.client.get(url)
2214.         self.assertTrue(get_change_related(response))
2215.         self.assertContains(response, change_link_text)
2216. 
2217.     def test_conditionally_show_delete_section_link(self):
2218.         """
2219.         The foreign key widget should only show the "delete related" button if
2220.         the user has permission to delete that related item.
2221.         """
2222.         def get_delete_related(response):
2223.             return response.context['adminform'].form.fields['sub_section'].widget.can_delete_related
2224. 
2225.         self.client.force_login(self.adduser)
2226.         # The user can't delete sections yet, so they shouldn't see the "delete section" link.
2227.         url = reverse('admin:admin_views_article_add')
2228.         delete_link_text = 'delete_id_sub_section'
2229.         response = self.client.get(url)
2230.         self.assertFalse(get_delete_related(response))
2231.         self.assertNotContains(response, delete_link_text)
2232.         # Allow the user to delete sections too. Now they can see the "delete section" link.
2233.         user = User.objects.get(username='adduser')
2234.         perm = get_perm(Section, get_permission_codename('delete', Section._meta))
2235.         user.user_permissions.add(perm)
2236.         response = self.client.get(url)
2237.         self.assertTrue(get_delete_related(response))
2238.         self.assertContains(response, delete_link_text)
2239. 
2240.     def test_disabled_permissions_when_logged_in(self):
2241.         self.client.force_login(self.superuser)
2242.         superuser = User.objects.get(username='super')
2243.         superuser.is_active = False
2244.         superuser.save()
2245. 
2246.         response = self.client.get(self.index_url, follow=True)
2247.         self.assertContains(response, 'id="login-form"')
2248.         self.assertNotContains(response, 'Log out')
2249. 
2250.         response = self.client.get(reverse('secure_view'), follow=True)
2251.         self.assertContains(response, 'id="login-form"')
2252. 
2253.     def test_disabled_staff_permissions_when_logged_in(self):
2254.         self.client.force_login(self.superuser)
2255.         superuser = User.objects.get(username='super')
2256.         superuser.is_staff = False
2257.         superuser.save()
2258. 
2259.         response = self.client.get(self.index_url, follow=True)
2260.         self.assertContains(response, 'id="login-form"')
2261.         self.assertNotContains(response, 'Log out')
2262. 
2263.         response = self.client.get(reverse('secure_view'), follow=True)
2264.         self.assertContains(response, 'id="login-form"')
2265. 
2266.     def test_app_list_permissions(self):
2267.         """
2268.         If a user has no module perms, the app list returns a 404.
2269.         """
2270.         opts = Article._meta
2271.         change_user = User.objects.get(username='changeuser')
2272.         permission = get_perm(Article, get_permission_codename('change', opts))
2273. 
2274.         self.client.force_login(self.changeuser)
2275. 
2276.         # the user has no module permissions
2277.         change_user.user_permissions.remove(permission)
2278.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
2279.         self.assertEqual(response.status_code, 404)
2280. 
2281.         # the user now has module permissions
2282.         change_user.user_permissions.add(permission)
2283.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
2284.         self.assertEqual(response.status_code, 200)
2285. 
2286.     def test_shortcut_view_only_available_to_staff(self):
2287.         """
2288.         Only admin users should be able to use the admin shortcut view.
2289.         """
2290.         model_ctype = ContentType.objects.get_for_model(ModelWithStringPrimaryKey)
2291.         obj = ModelWithStringPrimaryKey.objects.create(string_pk='foo')
2292.         shortcut_url = reverse('admin:view_on_site', args=(model_ctype.pk, obj.pk))
2293. 
2294.         # Not logged in: we should see the login page.
2295.         response = self.client.get(shortcut_url, follow=True)
2296.         self.assertTemplateUsed(response, 'admin/login.html')
2297. 
2298.         # Logged in? Redirect.
2299.         self.client.force_login(self.superuser)
2300.         response = self.client.get(shortcut_url, follow=False)
2301.         # Can't use self.assertRedirects() because User.get_absolute_url() is silly.
2302.         self.assertEqual(response.status_code, 302)
2303.         # Domain may depend on contrib.sites tests also run
2304.         self.assertRegex(response.url, 'http://(testserver|example.com)/dummy/foo/')
2305. 
2306.     def test_has_module_permission(self):
2307.         """
2308.         has_module_permission() returns True for all users who
2309.         have any permission for that module (add, change, or delete), so that
2310.         the module is displayed on the admin index page.
2311.         """
2312.         self.client.force_login(self.superuser)
2313.         response = self.client.get(self.index_url)
2314.         self.assertContains(response, 'admin_views')
2315.         self.assertContains(response, 'Articles')
2316.         self.client.logout()
2317. 
2318.         self.client.force_login(self.viewuser)
2319.         response = self.client.get(self.index_url)
2320.         self.assertContains(response, 'admin_views')
2321.         self.assertContains(response, 'Articles')
2322.         self.client.logout()
2323. 
2324.         self.client.force_login(self.adduser)
2325.         response = self.client.get(self.index_url)
2326.         self.assertContains(response, 'admin_views')
2327.         self.assertContains(response, 'Articles')
2328.         self.client.logout()
2329. 
2330.         self.client.force_login(self.changeuser)
2331.         response = self.client.get(self.index_url)
2332.         self.assertContains(response, 'admin_views')
2333.         self.assertContains(response, 'Articles')
2334.         self.client.logout()
2335. 
2336.         self.client.force_login(self.deleteuser)
2337.         response = self.client.get(self.index_url)
2338.         self.assertContains(response, 'admin_views')
2339.         self.assertContains(response, 'Articles')
2340. 
2341.     def test_overriding_has_module_permission(self):
2342.         """
2343.         If has_module_permission() always returns False, the module shouldn't
2344.         be displayed on the admin index page for any users.
2345.         """
2346.         articles = Article._meta.verbose_name_plural.title()
2347.         sections = Section._meta.verbose_name_plural.title()
2348.         index_url = reverse('admin7:index')
2349. 
2350.         self.client.force_login(self.superuser)
2351.         response = self.client.get(index_url)
2352.         self.assertContains(response, sections)
2353.         self.assertNotContains(response, articles)
2354.         self.client.logout()
2355. 
2356.         self.client.force_login(self.viewuser)
2357.         response = self.client.get(index_url)
2358.         self.assertNotContains(response, 'admin_views')
2359.         self.assertNotContains(response, articles)
2360.         self.client.logout()
2361. 
2362.         self.client.force_login(self.adduser)
2363.         response = self.client.get(index_url)
2364.         self.assertNotContains(response, 'admin_views')
2365.         self.assertNotContains(response, articles)
2366.         self.client.logout()
2367. 
2368.         self.client.force_login(self.changeuser)
2369.         response = self.client.get(index_url)
2370.         self.assertNotContains(response, 'admin_views')
2371.         self.assertNotContains(response, articles)
2372.         self.client.logout()
2373. 
2374.         self.client.force_login(self.deleteuser)
2375.         response = self.client.get(index_url)
2376.         self.assertNotContains(response, articles)
2377. 
2378.         # The app list displays Sections but not Articles as the latter has
2379.         # ModelAdmin.has_module_permission() = False.
2380.         self.client.force_login(self.superuser)
2381.         response = self.client.get(reverse('admin7:app_list', args=('admin_views',)))
2382.         self.assertContains(response, sections)
2383.         self.assertNotContains(response, articles)
2384. 
2385.     def test_post_save_message_no_forbidden_links_visible(self):
2386.         """
2387.         Post-save message shouldn't contain a link to the change form if the
2388.         user doesn't have the change permission.
2389.         """
2390.         self.client.force_login(self.adduser)
2391.         # Emulate Article creation for user with add-only permission.
2392.         post_data = {
2393.             "title": "Fun & games",
2394.             "content": "Some content",
2395.             "date_0": "2015-10-31",
2396.             "date_1": "16:35:00",
2397.             "_save": "Save",
2398.         }
2399.         response = self.client.post(reverse('admin:admin_views_article_add'), post_data, follow=True)
2400.         self.assertContains(
2401.             response,
2402.             '<li class="success">The article "Fun &amp; games" was added successfully.</li>',
2403.             html=True
2404.         )
2405. 
2406. 
2407. @override_settings(
2408.     ROOT_URLCONF='admin_views.urls',
2409.     TEMPLATES=[{
2410.         'BACKEND': 'django.template.backends.django.DjangoTemplates',
2411.         'APP_DIRS': True,
2412.         'OPTIONS': {
2413.             'context_processors': [
2414.                 'django.contrib.auth.context_processors.auth',
2415.                 'django.contrib.messages.context_processors.messages',
2416.             ],
2417.         },
2418.     }],
2419. )
2420. class AdminViewProxyModelPermissionsTests(TestCase):
2421.     """Tests for proxy models permissions in the admin."""
2422. 
2423.     @classmethod
2424.     def setUpTestData(cls):
2425.         cls.viewuser = User.objects.create_user(username='viewuser', password='secret', is_staff=True)
2426.         cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
2427.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
2428.         cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
2429.         # Setup permissions.
2430.         opts = UserProxy._meta
2431.         cls.viewuser.user_permissions.add(get_perm(UserProxy, get_permission_codename('view', opts)))
2432.         cls.adduser.user_permissions.add(get_perm(UserProxy, get_permission_codename('add', opts)))
2433.         cls.changeuser.user_permissions.add(get_perm(UserProxy, get_permission_codename('change', opts)))
2434.         cls.deleteuser.user_permissions.add(get_perm(UserProxy, get_permission_codename('delete', opts)))
2435.         # UserProxy instances.
2436.         cls.user_proxy = UserProxy.objects.create(username='user_proxy', password='secret')
2437. 
2438.     def test_add(self):
2439.         self.client.force_login(self.adduser)
2440.         url = reverse('admin:admin_views_userproxy_add')
2441.         data = {
2442.             'username': 'can_add',
2443.             'password': 'secret',
2444.             'date_joined_0': '2019-01-15',
2445.             'date_joined_1': '16:59:10',
2446.         }
2447.         response = self.client.post(url, data, follow=True)
2448.         self.assertEqual(response.status_code, 200)
2449.         self.assertTrue(UserProxy.objects.filter(username='can_add').exists())
2450. 
2451.     def test_view(self):
2452.         self.client.force_login(self.viewuser)
2453.         response = self.client.get(reverse('admin:admin_views_userproxy_changelist'))
2454.         self.assertContains(response, '<h1>Select user proxy to view</h1>')
2455.         self.assertEqual(response.status_code, 200)
2456.         response = self.client.get(reverse('admin:admin_views_userproxy_change', args=(self.user_proxy.pk,)))
2457.         self.assertContains(response, '<h1>View user proxy</h1>')
2458.         self.assertContains(response, '<div class="readonly">user_proxy</div>')
2459. 
2460.     def test_change(self):
2461.         self.client.force_login(self.changeuser)
2462.         data = {
2463.             'password': self.user_proxy.password,
2464.             'username': self.user_proxy.username,
2465.             'date_joined_0': self.user_proxy.date_joined.strftime('%Y-%m-%d'),
2466.             'date_joined_1': self.user_proxy.date_joined.strftime('%H:%M:%S'),
2467.             'first_name': 'first_name',
2468.         }
2469.         url = reverse('admin:admin_views_userproxy_change', args=(self.user_proxy.pk,))
2470.         response = self.client.post(url, data)
2471.         self.assertRedirects(response, reverse('admin:admin_views_userproxy_changelist'))
2472.         self.assertEqual(UserProxy.objects.get(pk=self.user_proxy.pk).first_name, 'first_name')
2473. 
2474.     def test_delete(self):
2475.         self.client.force_login(self.deleteuser)
2476.         url = reverse('admin:admin_views_userproxy_delete', args=(self.user_proxy.pk,))
2477.         response = self.client.post(url, {'post': 'yes'}, follow=True)
2478.         self.assertEqual(response.status_code, 200)
2479.         self.assertFalse(UserProxy.objects.filter(pk=self.user_proxy.pk).exists())
2480. 
2481. 
2482. @override_settings(ROOT_URLCONF='admin_views.urls')
2483. class AdminViewsNoUrlTest(TestCase):
2484.     """Regression test for #17333"""
2485. 
2486.     @classmethod
2487.     def setUpTestData(cls):
2488.         # User who can change Reports
2489.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
2490.         cls.changeuser.user_permissions.add(get_perm(Report, get_permission_codename('change', Report._meta)))
2491. 
2492.     def test_no_standard_modeladmin_urls(self):
2493.         """Admin index views don't break when user's ModelAdmin removes standard urls"""
2494.         self.client.force_login(self.changeuser)
2495.         r = self.client.get(reverse('admin:index'))
2496.         # we shouldn't get a 500 error caused by a NoReverseMatch
2497.         self.assertEqual(r.status_code, 200)
2498.         self.client.get(reverse('admin:logout'))
2499. 
2500. 
2501. @skipUnlessDBFeature('can_defer_constraint_checks')
2502. @override_settings(ROOT_URLCONF='admin_views.urls')
2503. class AdminViewDeletedObjectsTest(TestCase):
2504. 
2505.     @classmethod
2506.     def setUpTestData(cls):
2507.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2508.         cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
2509.         cls.s1 = Section.objects.create(name='Test section')
2510.         cls.a1 = Article.objects.create(
2511.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
2512.         )
2513.         cls.a2 = Article.objects.create(
2514.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
2515.         )
2516.         cls.a3 = Article.objects.create(
2517.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
2518.         )
2519.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
2520. 
2521.         cls.v1 = Villain.objects.create(name='Adam')
2522.         cls.v2 = Villain.objects.create(name='Sue')
2523.         cls.sv1 = SuperVillain.objects.create(name='Bob')
2524.         cls.pl1 = Plot.objects.create(name='World Domination', team_leader=cls.v1, contact=cls.v2)
2525.         cls.pl2 = Plot.objects.create(name='World Peace', team_leader=cls.v2, contact=cls.v2)
2526.         cls.pl3 = Plot.objects.create(name='Corn Conspiracy', team_leader=cls.v1, contact=cls.v1)
2527.         cls.pd1 = PlotDetails.objects.create(details='almost finished', plot=cls.pl1)
2528.         cls.sh1 = SecretHideout.objects.create(location='underground bunker', villain=cls.v1)
2529.         cls.sh2 = SecretHideout.objects.create(location='floating castle', villain=cls.sv1)
2530.         cls.ssh1 = SuperSecretHideout.objects.create(location='super floating castle!', supervillain=cls.sv1)
2531.         cls.cy1 = CyclicOne.objects.create(name='I am recursive', two_id=1)
2532.         cls.cy2 = CyclicTwo.objects.create(name='I am recursive too', one_id=1)
2533. 
2534.     def setUp(self):
2535.         self.client.force_login(self.superuser)
2536. 
2537.     def test_nesting(self):
2538.         """
2539.         Objects should be nested to display the relationships that
2540.         cause them to be scheduled for deletion.
2541.         """
2542.         pattern = re.compile(
2543.             r'<li>Plot: <a href="%s">World Domination</a>\s*<ul>\s*'
2544.             r'<li>Plot details: <a href="%s">almost finished</a>' % (
2545.                 reverse('admin:admin_views_plot_change', args=(self.pl1.pk,)),
2546.                 reverse('admin:admin_views_plotdetails_change', args=(self.pd1.pk,)),
2547.             )
2548.         )
2549.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v1.pk,)))
2550.         self.assertRegex(response.content.decode(), pattern)
2551. 
2552.     def test_cyclic(self):
2553.         """
2554.         Cyclic relationships should still cause each object to only be
2555.         listed once.
2556.         """
2557.         one = '<li>Cyclic one: <a href="%s">I am recursive</a>' % (
2558.             reverse('admin:admin_views_cyclicone_change', args=(self.cy1.pk,)),
2559.         )
2560.         two = '<li>Cyclic two: <a href="%s">I am recursive too</a>' % (
2561.             reverse('admin:admin_views_cyclictwo_change', args=(self.cy2.pk,)),
2562.         )
2563.         response = self.client.get(reverse('admin:admin_views_cyclicone_delete', args=(self.cy1.pk,)))
2564. 
2565.         self.assertContains(response, one, 1)
2566.         self.assertContains(response, two, 1)
2567. 
2568.     def test_perms_needed(self):
2569.         self.client.logout()
2570.         delete_user = User.objects.get(username='deleteuser')
2571.         delete_user.user_permissions.add(get_perm(Plot, get_permission_codename('delete', Plot._meta)))
2572. 
2573.         self.client.force_login(self.deleteuser)
2574.         response = self.client.get(reverse('admin:admin_views_plot_delete', args=(self.pl1.pk,)))
2575.         self.assertContains(response, "your account doesn't have permission to delete the following types of objects")
2576.         self.assertContains(response, "<li>plot details</li>")
2577. 
2578.     def test_protected(self):
2579.         q = Question.objects.create(question="Why?")
2580.         a1 = Answer.objects.create(question=q, answer="Because.")
2581.         a2 = Answer.objects.create(question=q, answer="Yes.")
2582. 
2583.         response = self.client.get(reverse('admin:admin_views_question_delete', args=(q.pk,)))
2584.         self.assertContains(response, "would require deleting the following protected related objects")
2585.         self.assertContains(
2586.             response,
2587.             '<li>Answer: <a href="%s">Because.</a></li>' % reverse('admin:admin_views_answer_change', args=(a1.pk,))
2588.         )
2589.         self.assertContains(
2590.             response,
2591.             '<li>Answer: <a href="%s">Yes.</a></li>' % reverse('admin:admin_views_answer_change', args=(a2.pk,))
2592.         )
2593. 
2594.     def test_post_delete_protected(self):
2595.         """
2596.         A POST request to delete protected objects should display the page
2597.         which says the deletion is prohibited.
2598.         """
2599.         q = Question.objects.create(question='Why?')
2600.         Answer.objects.create(question=q, answer='Because.')
2601. 
2602.         response = self.client.post(reverse('admin:admin_views_question_delete', args=(q.pk,)), {'post': 'yes'})
2603.         self.assertEqual(Question.objects.count(), 1)
2604.         self.assertContains(response, "would require deleting the following protected related objects")
2605. 
2606.     def test_not_registered(self):
2607.         should_contain = """<li>Secret hideout: underground bunker"""
2608.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v1.pk,)))
2609.         self.assertContains(response, should_contain, 1)
2610. 
2611.     def test_multiple_fkeys_to_same_model(self):
2612.         """
2613.         If a deleted object has two relationships from another model,
2614.         both of those should be followed in looking for related
2615.         objects to delete.
2616.         """
2617.         should_contain = '<li>Plot: <a href="%s">World Domination</a>' % reverse(
2618.             'admin:admin_views_plot_change', args=(self.pl1.pk,)
2619.         )
2620.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v1.pk,)))
2621.         self.assertContains(response, should_contain)
2622.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v2.pk,)))
2623.         self.assertContains(response, should_contain)
2624. 
2625.     def test_multiple_fkeys_to_same_instance(self):
2626.         """
2627.         If a deleted object has two relationships pointing to it from
2628.         another object, the other object should still only be listed
2629.         once.
2630.         """
2631.         should_contain = '<li>Plot: <a href="%s">World Peace</a></li>' % reverse(
2632.             'admin:admin_views_plot_change', args=(self.pl2.pk,)
2633.         )
2634.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.v2.pk,)))
2635.         self.assertContains(response, should_contain, 1)
2636. 
2637.     def test_inheritance(self):
2638.         """
2639.         In the case of an inherited model, if either the child or
2640.         parent-model instance is deleted, both instances are listed
2641.         for deletion, as well as any relationships they have.
2642.         """
2643.         should_contain = [
2644.             '<li>Villain: <a href="%s">Bob</a>' % reverse('admin:admin_views_villain_change', args=(self.sv1.pk,)),
2645.             '<li>Super villain: <a href="%s">Bob</a>' % reverse(
2646.                 'admin:admin_views_supervillain_change', args=(self.sv1.pk,)
2647.             ),
2648.             '<li>Secret hideout: floating castle',
2649.             '<li>Super secret hideout: super floating castle!',
2650.         ]
2651.         response = self.client.get(reverse('admin:admin_views_villain_delete', args=(self.sv1.pk,)))
2652.         for should in should_contain:
2653.             self.assertContains(response, should, 1)
2654.         response = self.client.get(reverse('admin:admin_views_supervillain_delete', args=(self.sv1.pk,)))
2655.         for should in should_contain:
2656.             self.assertContains(response, should, 1)
2657. 
2658.     def test_generic_relations(self):
2659.         """
2660.         If a deleted object has GenericForeignKeys pointing to it,
2661.         those objects should be listed for deletion.
2662.         """
2663.         plot = self.pl3
2664.         tag = FunkyTag.objects.create(content_object=plot, name='hott')
2665.         should_contain = '<li>Funky tag: <a href="%s">hott' % reverse(
2666.             'admin:admin_views_funkytag_change', args=(tag.id,))
2667.         response = self.client.get(reverse('admin:admin_views_plot_delete', args=(plot.pk,)))
2668.         self.assertContains(response, should_contain)
2669. 
2670.     def test_generic_relations_with_related_query_name(self):
2671.         """
2672.         If a deleted object has GenericForeignKey with
2673.         GenericRelation(related_query_name='...') pointing to it, those objects
2674.         should be listed for deletion.
2675.         """
2676.         bookmark = Bookmark.objects.create(name='djangoproject')
2677.         tag = FunkyTag.objects.create(content_object=bookmark, name='django')
2678.         tag_url = reverse('admin:admin_views_funkytag_change', args=(tag.id,))
2679.         should_contain = '<li>Funky tag: <a href="%s">django' % tag_url
2680.         response = self.client.get(reverse('admin:admin_views_bookmark_delete', args=(bookmark.pk,)))
2681.         self.assertContains(response, should_contain)
2682. 
2683.     def test_delete_view_uses_get_deleted_objects(self):
2684.         """The delete view uses ModelAdmin.get_deleted_objects()."""
2685.         book = Book.objects.create(name='Test Book')
2686.         response = self.client.get(reverse('admin2:admin_views_book_delete', args=(book.pk,)))
2687.         # BookAdmin.get_deleted_objects() returns custom text.
2688.         self.assertContains(response, 'a deletable object')
2689. 
2690. 
2691. @override_settings(ROOT_URLCONF='admin_views.urls')
2692. class TestGenericRelations(TestCase):
2693. 
2694.     @classmethod
2695.     def setUpTestData(cls):
2696.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2697.         cls.v1 = Villain.objects.create(name='Adam')
2698.         cls.pl3 = Plot.objects.create(name='Corn Conspiracy', team_leader=cls.v1, contact=cls.v1)
2699. 
2700.     def setUp(self):
2701.         self.client.force_login(self.superuser)
2702. 
2703.     def test_generic_content_object_in_list_display(self):
2704.         FunkyTag.objects.create(content_object=self.pl3, name='hott')
2705.         response = self.client.get(reverse('admin:admin_views_funkytag_changelist'))
2706.         self.assertContains(response, "%s</td>" % self.pl3)
2707. 
2708. 
2709. @override_settings(ROOT_URLCONF='admin_views.urls')
2710. class AdminViewStringPrimaryKeyTest(TestCase):
2711. 
2712.     @classmethod
2713.     def setUpTestData(cls):
2714.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2715.         cls.s1 = Section.objects.create(name='Test section')
2716.         cls.a1 = Article.objects.create(
2717.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
2718.         )
2719.         cls.a2 = Article.objects.create(
2720.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
2721.         )
2722.         cls.a3 = Article.objects.create(
2723.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
2724.         )
2725.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
2726.         cls.pk = (
2727.             "abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 "
2728.             r"""-_.!~*'() ;/?:@&=+$, <>#%" {}|\^[]`"""
2729.         )
2730.         cls.m1 = ModelWithStringPrimaryKey.objects.create(string_pk=cls.pk)
2731.         content_type_pk = ContentType.objects.get_for_model(ModelWithStringPrimaryKey).pk
2732.         user_pk = cls.superuser.pk
2733.         LogEntry.objects.log_action(user_pk, content_type_pk, cls.pk, cls.pk, 2, change_message='Changed something')
2734. 
2735.     def setUp(self):
2736.         self.client.force_login(self.superuser)
2737. 
2738.     def test_get_history_view(self):
2739.         """
2740.         Retrieving the history for an object using urlencoded form of primary
2741.         key should work.
2742.         Refs #12349, #18550.
2743.         """
2744.         response = self.client.get(reverse('admin:admin_views_modelwithstringprimarykey_history', args=(self.pk,)))
2745.         self.assertContains(response, escape(self.pk))
2746.         self.assertContains(response, 'Changed something')
2747.         self.assertEqual(response.status_code, 200)
2748. 
2749.     def test_get_change_view(self):
2750.         "Retrieving the object using urlencoded form of primary key should work"
2751.         response = self.client.get(reverse('admin:admin_views_modelwithstringprimarykey_change', args=(self.pk,)))
2752.         self.assertContains(response, escape(self.pk))
2753.         self.assertEqual(response.status_code, 200)
2754. 
2755.     def test_changelist_to_changeform_link(self):
2756.         "Link to the changeform of the object in changelist should use reverse() and be quoted -- #18072"
2757.         response = self.client.get(reverse('admin:admin_views_modelwithstringprimarykey_changelist'))
2758.         # this URL now comes through reverse(), thus url quoting and iri_to_uri encoding
2759.         pk_final_url = escape(iri_to_uri(quote(self.pk)))
2760.         change_url = reverse(
2761.             'admin:admin_views_modelwithstringprimarykey_change', args=('__fk__',)
2762.         ).replace('__fk__', pk_final_url)
2763.         should_contain = '<th class="field-__str__"><a href="%s">%s</a></th>' % (change_url, escape(self.pk))
2764.         self.assertContains(response, should_contain)
2765. 
2766.     def test_recentactions_link(self):
2767.         "The link from the recent actions list referring to the changeform of the object should be quoted"
2768.         response = self.client.get(reverse('admin:index'))
2769.         link = reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(self.pk),))
2770.         should_contain = """<a href="%s">%s</a>""" % (escape(link), escape(self.pk))
2771.         self.assertContains(response, should_contain)
2772. 
2773.     def test_deleteconfirmation_link(self):
2774.         "The link from the delete confirmation page referring back to the changeform of the object should be quoted"
2775.         url = reverse('admin:admin_views_modelwithstringprimarykey_delete', args=(quote(self.pk),))
2776.         response = self.client.get(url)
2777.         # this URL now comes through reverse(), thus url quoting and iri_to_uri encoding
2778.         change_url = reverse(
2779.             'admin:admin_views_modelwithstringprimarykey_change', args=('__fk__',)
2780.         ).replace('__fk__', escape(iri_to_uri(quote(self.pk))))
2781.         should_contain = '<a href="%s">%s</a>' % (change_url, escape(self.pk))
2782.         self.assertContains(response, should_contain)
2783. 
2784.     def test_url_conflicts_with_add(self):
2785.         "A model with a primary key that ends with add or is `add` should be visible"
2786.         add_model = ModelWithStringPrimaryKey.objects.create(pk="i have something to add")
2787.         add_model.save()
2788.         response = self.client.get(
2789.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(add_model.pk),))
2790.         )
2791.         should_contain = """<h1>Change model with string primary key</h1>"""
2792.         self.assertContains(response, should_contain)
2793. 
2794.         add_model2 = ModelWithStringPrimaryKey.objects.create(pk="add")
2795.         add_url = reverse('admin:admin_views_modelwithstringprimarykey_add')
2796.         change_url = reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(add_model2.pk),))
2797.         self.assertNotEqual(add_url, change_url)
2798. 
2799.     def test_url_conflicts_with_delete(self):
2800.         "A model with a primary key that ends with delete should be visible"
2801.         delete_model = ModelWithStringPrimaryKey(pk="delete")
2802.         delete_model.save()
2803.         response = self.client.get(
2804.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(delete_model.pk),))
2805.         )
2806.         should_contain = """<h1>Change model with string primary key</h1>"""
2807.         self.assertContains(response, should_contain)
2808. 
2809.     def test_url_conflicts_with_history(self):
2810.         "A model with a primary key that ends with history should be visible"
2811.         history_model = ModelWithStringPrimaryKey(pk="history")
2812.         history_model.save()
2813.         response = self.client.get(
2814.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(history_model.pk),))
2815.         )
2816.         should_contain = """<h1>Change model with string primary key</h1>"""
2817.         self.assertContains(response, should_contain)
2818. 
2819.     def test_shortcut_view_with_escaping(self):
2820.         "'View on site should' work properly with char fields"
2821.         model = ModelWithStringPrimaryKey(pk='abc_123')
2822.         model.save()
2823.         response = self.client.get(
2824.             reverse('admin:admin_views_modelwithstringprimarykey_change', args=(quote(model.pk),))
2825.         )
2826.         should_contain = '/%s/" class="viewsitelink">' % model.pk
2827.         self.assertContains(response, should_contain)
2828. 
2829.     def test_change_view_history_link(self):
2830.         """Object history button link should work and contain the pk value quoted."""
2831.         url = reverse(
2832.             'admin:%s_modelwithstringprimarykey_change' % ModelWithStringPrimaryKey._meta.app_label,
2833.             args=(quote(self.pk),)
2834.         )
2835.         response = self.client.get(url)
2836.         self.assertEqual(response.status_code, 200)
2837.         expected_link = reverse(
2838.             'admin:%s_modelwithstringprimarykey_history' % ModelWithStringPrimaryKey._meta.app_label,
2839.             args=(quote(self.pk),)
2840.         )
2841.         self.assertContains(response, '<a href="%s" class="historylink"' % escape(expected_link))
2842. 
2843.     def test_redirect_on_add_view_continue_button(self):
2844.         """As soon as an object is added using "Save and continue editing"
2845.         button, the user should be redirected to the object's change_view.
2846. 
2847.         In case primary key is a string containing some special characters
2848.         like slash or underscore, these characters must be escaped (see #22266)
2849.         """
2850.         response = self.client.post(
2851.             reverse('admin:admin_views_modelwithstringprimarykey_add'),
2852.             {
2853.                 'string_pk': '123/history',
2854.                 "_continue": "1",  # Save and continue editing
2855.             }
2856.         )
2857. 
2858.         self.assertEqual(response.status_code, 302)  # temporary redirect
2859.         self.assertIn('/123_2Fhistory/', response['location'])  # PK is quoted
2860. 
2861. 
2862. @override_settings(ROOT_URLCONF='admin_views.urls')
2863. class SecureViewTests(TestCase):
2864.     """
2865.     Test behavior of a view protected by the staff_member_required decorator.
2866.     """
2867. 
2868.     def test_secure_view_shows_login_if_not_logged_in(self):
2869.         secure_url = reverse('secure_view')
2870.         response = self.client.get(secure_url)
2871.         self.assertRedirects(response, '%s?next=%s' % (reverse('admin:login'), secure_url))
2872.         response = self.client.get(secure_url, follow=True)
2873.         self.assertTemplateUsed(response, 'admin/login.html')
2874.         self.assertEqual(response.context[REDIRECT_FIELD_NAME], secure_url)
2875. 
2876.     def test_staff_member_required_decorator_works_with_argument(self):
2877.         """
2878.         Staff_member_required decorator works with an argument
2879.         (redirect_field_name).
2880.         """
2881.         secure_url = '/test_admin/admin/secure-view2/'
2882.         response = self.client.get(secure_url)
2883.         self.assertRedirects(response, '%s?myfield=%s' % (reverse('admin:login'), secure_url))
2884. 
2885. 
2886. @override_settings(ROOT_URLCONF='admin_views.urls')
2887. class AdminViewUnicodeTest(TestCase):
2888. 
2889.     @classmethod
2890.     def setUpTestData(cls):
2891.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2892.         cls.b1 = Book.objects.create(name='Lærdommer')
2893.         cls.p1 = Promo.objects.create(name='<Promo for Lærdommer>', book=cls.b1)
2894.         cls.chap1 = Chapter.objects.create(
2895.             title='Norske bostaver æøå skaper problemer', content='<p>Svært frustrerende med UnicodeDecodeErro</p>',
2896.             book=cls.b1
2897.         )
2898.         cls.chap2 = Chapter.objects.create(
2899.             title='Kjærlighet', content='<p>La kjærligheten til de lidende seire.</p>', book=cls.b1)
2900.         cls.chap3 = Chapter.objects.create(title='Kjærlighet', content='<p>Noe innhold</p>', book=cls.b1)
2901.         cls.chap4 = ChapterXtra1.objects.create(chap=cls.chap1, xtra='<Xtra(1) Norske bostaver æøå skaper problemer>')
2902.         cls.chap5 = ChapterXtra1.objects.create(chap=cls.chap2, xtra='<Xtra(1) Kjærlighet>')
2903.         cls.chap6 = ChapterXtra1.objects.create(chap=cls.chap3, xtra='<Xtra(1) Kjærlighet>')
2904.         cls.chap7 = ChapterXtra2.objects.create(chap=cls.chap1, xtra='<Xtra(2) Norske bostaver æøå skaper problemer>')
2905.         cls.chap8 = ChapterXtra2.objects.create(chap=cls.chap2, xtra='<Xtra(2) Kjærlighet>')
2906.         cls.chap9 = ChapterXtra2.objects.create(chap=cls.chap3, xtra='<Xtra(2) Kjærlighet>')
2907. 
2908.     def setUp(self):
2909.         self.client.force_login(self.superuser)
2910. 
2911.     def test_unicode_edit(self):
2912.         """
2913.         A test to ensure that POST on edit_view handles non-ASCII characters.
2914.         """
2915.         post_data = {
2916.             "name": "Test lærdommer",
2917.             # inline data
2918.             "chapter_set-TOTAL_FORMS": "6",
2919.             "chapter_set-INITIAL_FORMS": "3",
2920.             "chapter_set-MAX_NUM_FORMS": "0",
2921.             "chapter_set-0-id": self.chap1.pk,
2922.             "chapter_set-0-title": "Norske bostaver æøå skaper problemer",
2923.             "chapter_set-0-content": "&lt;p&gt;Svært frustrerende med UnicodeDecodeError&lt;/p&gt;",
2924.             "chapter_set-1-id": self.chap2.id,
2925.             "chapter_set-1-title": "Kjærlighet.",
2926.             "chapter_set-1-content": "&lt;p&gt;La kjærligheten til de lidende seire.&lt;/p&gt;",
2927.             "chapter_set-2-id": self.chap3.id,
2928.             "chapter_set-2-title": "Need a title.",
2929.             "chapter_set-2-content": "&lt;p&gt;Newest content&lt;/p&gt;",
2930.             "chapter_set-3-id": "",
2931.             "chapter_set-3-title": "",
2932.             "chapter_set-3-content": "",
2933.             "chapter_set-4-id": "",
2934.             "chapter_set-4-title": "",
2935.             "chapter_set-4-content": "",
2936.             "chapter_set-5-id": "",
2937.             "chapter_set-5-title": "",
2938.             "chapter_set-5-content": "",
2939.         }
2940. 
2941.         response = self.client.post(reverse('admin:admin_views_book_change', args=(self.b1.pk,)), post_data)
2942.         self.assertEqual(response.status_code, 302)  # redirect somewhere
2943. 
2944.     def test_unicode_delete(self):
2945.         """
2946.         The delete_view handles non-ASCII characters
2947.         """
2948.         delete_dict = {'post': 'yes'}
2949.         delete_url = reverse('admin:admin_views_book_delete', args=(self.b1.pk,))
2950.         response = self.client.get(delete_url)
2951.         self.assertEqual(response.status_code, 200)
2952.         response = self.client.post(delete_url, delete_dict)
2953.         self.assertRedirects(response, reverse('admin:admin_views_book_changelist'))
2954. 
2955. 
2956. @override_settings(ROOT_URLCONF='admin_views.urls')
2957. class AdminViewListEditable(TestCase):
2958. 
2959.     @classmethod
2960.     def setUpTestData(cls):
2961.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
2962.         cls.s1 = Section.objects.create(name='Test section')
2963.         cls.a1 = Article.objects.create(
2964.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
2965.         )
2966.         cls.a2 = Article.objects.create(
2967.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
2968.         )
2969.         cls.a3 = Article.objects.create(
2970.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
2971.         )
2972.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
2973.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
2974.         cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
2975.         cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)
2976. 
2977.     def setUp(self):
2978.         self.client.force_login(self.superuser)
2979. 
2980.     def test_inheritance(self):
2981.         Podcast.objects.create(name="This Week in Django", release_date=datetime.date.today())
2982.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'))
2983.         self.assertEqual(response.status_code, 200)
2984. 
2985.     def test_inheritance_2(self):
2986.         Vodcast.objects.create(name="This Week in Django", released=True)
2987.         response = self.client.get(reverse('admin:admin_views_vodcast_changelist'))
2988.         self.assertEqual(response.status_code, 200)
2989. 
2990.     def test_custom_pk(self):
2991.         Language.objects.create(iso='en', name='English', english_name='English')
2992.         response = self.client.get(reverse('admin:admin_views_language_changelist'))
2993.         self.assertEqual(response.status_code, 200)
2994. 
2995.     def test_changelist_input_html(self):
2996.         response = self.client.get(reverse('admin:admin_views_person_changelist'))
2997.         # 2 inputs per object(the field and the hidden id field) = 6
2998.         # 4 management hidden fields = 4
2999.         # 4 action inputs (3 regular checkboxes, 1 checkbox to select all)
3000.         # main form submit button = 1
3001.         # search field and search submit button = 2
3002.         # CSRF field = 1
3003.         # field to track 'select all' across paginated views = 1
3004.         # 6 + 4 + 4 + 1 + 2 + 1 + 1 = 19 inputs
3005.         self.assertContains(response, "<input", count=19)
3006.         # 1 select per object = 3 selects
3007.         self.assertContains(response, "<select", count=4)
3008. 
3009.     def test_post_messages(self):
3010.         # Ticket 12707: Saving inline editable should not show admin
3011.         # action warnings
3012.         data = {
3013.             "form-TOTAL_FORMS": "3",
3014.             "form-INITIAL_FORMS": "3",
3015.             "form-MAX_NUM_FORMS": "0",
3016. 
3017.             "form-0-gender": "1",
3018.             "form-0-id": "%s" % self.per1.pk,
3019. 
3020.             "form-1-gender": "2",
3021.             "form-1-id": "%s" % self.per2.pk,
3022. 
3023.             "form-2-alive": "checked",
3024.             "form-2-gender": "1",
3025.             "form-2-id": "%s" % self.per3.pk,
3026. 
3027.             "_save": "Save",
3028.         }
3029.         response = self.client.post(reverse('admin:admin_views_person_changelist'),
3030.                                     data, follow=True)
3031.         self.assertEqual(len(response.context['messages']), 1)
3032. 
3033.     def test_post_submission(self):
3034.         data = {
3035.             "form-TOTAL_FORMS": "3",
3036.             "form-INITIAL_FORMS": "3",
3037.             "form-MAX_NUM_FORMS": "0",
3038. 
3039.             "form-0-gender": "1",
3040.             "form-0-id": "%s" % self.per1.pk,
3041. 
3042.             "form-1-gender": "2",
3043.             "form-1-id": "%s" % self.per2.pk,
3044. 
3045.             "form-2-alive": "checked",
3046.             "form-2-gender": "1",
3047.             "form-2-id": "%s" % self.per3.pk,
3048. 
3049.             "_save": "Save",
3050.         }
3051.         self.client.post(reverse('admin:admin_views_person_changelist'), data)
3052. 
3053.         self.assertIs(Person.objects.get(name="John Mauchly").alive, False)
3054.         self.assertEqual(Person.objects.get(name="Grace Hopper").gender, 2)
3055. 
3056.         # test a filtered page
3057.         data = {
3058.             "form-TOTAL_FORMS": "2",
3059.             "form-INITIAL_FORMS": "2",
3060.             "form-MAX_NUM_FORMS": "0",
3061. 
3062.             "form-0-id": "%s" % self.per1.pk,
3063.             "form-0-gender": "1",
3064.             "form-0-alive": "checked",
3065. 
3066.             "form-1-id": "%s" % self.per3.pk,
3067.             "form-1-gender": "1",
3068.             "form-1-alive": "checked",
3069. 
3070.             "_save": "Save",
3071.         }
3072.         self.client.post(reverse('admin:admin_views_person_changelist') + '?gender__exact=1', data)
3073. 
3074.         self.assertIs(Person.objects.get(name="John Mauchly").alive, True)
3075. 
3076.         # test a searched page
3077.         data = {
3078.             "form-TOTAL_FORMS": "1",
3079.             "form-INITIAL_FORMS": "1",
3080.             "form-MAX_NUM_FORMS": "0",
3081. 
3082.             "form-0-id": "%s" % self.per1.pk,
3083.             "form-0-gender": "1",
3084. 
3085.             "_save": "Save",
3086.         }
3087.         self.client.post(reverse('admin:admin_views_person_changelist') + '?q=john', data)
3088. 
3089.         self.assertIs(Person.objects.get(name="John Mauchly").alive, False)
3090. 
3091.     def test_non_field_errors(self):
3092.         """
3093.         Non-field errors are displayed for each of the forms in the
3094.         changelist's formset.
3095.         """
3096.         fd1 = FoodDelivery.objects.create(reference='123', driver='bill', restaurant='thai')
3097.         fd2 = FoodDelivery.objects.create(reference='456', driver='bill', restaurant='india')
3098.         fd3 = FoodDelivery.objects.create(reference='789', driver='bill', restaurant='pizza')
3099. 
3100.         data = {
3101.             "form-TOTAL_FORMS": "3",
3102.             "form-INITIAL_FORMS": "3",
3103.             "form-MAX_NUM_FORMS": "0",
3104. 
3105.             "form-0-id": str(fd1.id),
3106.             "form-0-reference": "123",
3107.             "form-0-driver": "bill",
3108.             "form-0-restaurant": "thai",
3109. 
3110.             # Same data as above: Forbidden because of unique_together!
3111.             "form-1-id": str(fd2.id),
3112.             "form-1-reference": "456",
3113.             "form-1-driver": "bill",
3114.             "form-1-restaurant": "thai",
3115. 
3116.             "form-2-id": str(fd3.id),
3117.             "form-2-reference": "789",
3118.             "form-2-driver": "bill",
3119.             "form-2-restaurant": "pizza",
3120. 
3121.             "_save": "Save",
3122.         }
3123.         response = self.client.post(reverse('admin:admin_views_fooddelivery_changelist'), data)
3124.         self.assertContains(
3125.             response,
3126.             '<tr><td colspan="4"><ul class="errorlist nonfield"><li>Food delivery '
3127.             'with this Driver and Restaurant already exists.</li></ul></td></tr>',
3128.             1,
3129.             html=True
3130.         )
3131. 
3132.         data = {
3133.             "form-TOTAL_FORMS": "3",
3134.             "form-INITIAL_FORMS": "3",
3135.             "form-MAX_NUM_FORMS": "0",
3136. 
3137.             "form-0-id": str(fd1.id),
3138.             "form-0-reference": "123",
3139.             "form-0-driver": "bill",
3140.             "form-0-restaurant": "thai",
3141. 
3142.             # Same data as above: Forbidden because of unique_together!
3143.             "form-1-id": str(fd2.id),
3144.             "form-1-reference": "456",
3145.             "form-1-driver": "bill",
3146.             "form-1-restaurant": "thai",
3147. 
3148.             # Same data also.
3149.             "form-2-id": str(fd3.id),
3150.             "form-2-reference": "789",
3151.             "form-2-driver": "bill",
3152.             "form-2-restaurant": "thai",
3153. 
3154.             "_save": "Save",
3155.         }
3156.         response = self.client.post(reverse('admin:admin_views_fooddelivery_changelist'), data)
3157.         self.assertContains(
3158.             response,
3159.             '<tr><td colspan="4"><ul class="errorlist nonfield"><li>Food delivery '
3160.             'with this Driver and Restaurant already exists.</li></ul></td></tr>',
3161.             2,
3162.             html=True
3163.         )
3164. 
3165.     def test_non_form_errors(self):
3166.         # test if non-form errors are handled; ticket #12716
3167.         data = {
3168.             "form-TOTAL_FORMS": "1",
3169.             "form-INITIAL_FORMS": "1",
3170.             "form-MAX_NUM_FORMS": "0",
3171. 
3172.             "form-0-id": "%s" % self.per2.pk,
3173.             "form-0-alive": "1",
3174.             "form-0-gender": "2",
3175. 
3176.             # The form processing understands this as a list_editable "Save"
3177.             # and not an action "Go".
3178.             "_save": "Save",
3179.         }
3180.         response = self.client.post(reverse('admin:admin_views_person_changelist'), data)
3181.         self.assertContains(response, "Grace is not a Zombie")
3182. 
3183.     def test_non_form_errors_is_errorlist(self):
3184.         # test if non-form errors are correctly handled; ticket #12878
3185.         data = {
3186.             "form-TOTAL_FORMS": "1",
3187.             "form-INITIAL_FORMS": "1",
3188.             "form-MAX_NUM_FORMS": "0",
3189. 
3190.             "form-0-id": "%s" % self.per2.pk,
3191.             "form-0-alive": "1",
3192.             "form-0-gender": "2",
3193. 
3194.             "_save": "Save",
3195.         }
3196.         response = self.client.post(reverse('admin:admin_views_person_changelist'), data)
3197.         non_form_errors = response.context['cl'].formset.non_form_errors()
3198.         self.assertIsInstance(non_form_errors, ErrorList)
3199.         self.assertEqual(str(non_form_errors), str(ErrorList(["Grace is not a Zombie"])))
3200. 
3201.     def test_list_editable_ordering(self):
3202.         collector = Collector.objects.create(id=1, name="Frederick Clegg")
3203. 
3204.         Category.objects.create(id=1, order=1, collector=collector)
3205.         Category.objects.create(id=2, order=2, collector=collector)
3206.         Category.objects.create(id=3, order=0, collector=collector)
3207.         Category.objects.create(id=4, order=0, collector=collector)
3208. 
3209.         # NB: The order values must be changed so that the items are reordered.
3210.         data = {
3211.             "form-TOTAL_FORMS": "4",
3212.             "form-INITIAL_FORMS": "4",
3213.             "form-MAX_NUM_FORMS": "0",
3214. 
3215.             "form-0-order": "14",
3216.             "form-0-id": "1",
3217.             "form-0-collector": "1",
3218. 
3219.             "form-1-order": "13",
3220.             "form-1-id": "2",
3221.             "form-1-collector": "1",
3222. 
3223.             "form-2-order": "1",
3224.             "form-2-id": "3",
3225.             "form-2-collector": "1",
3226. 
3227.             "form-3-order": "0",
3228.             "form-3-id": "4",
3229.             "form-3-collector": "1",
3230. 
3231.             # The form processing understands this as a list_editable "Save"
3232.             # and not an action "Go".
3233.             "_save": "Save",
3234.         }
3235.         response = self.client.post(reverse('admin:admin_views_category_changelist'), data)
3236.         # Successful post will redirect
3237.         self.assertEqual(response.status_code, 302)
3238. 
3239.         # The order values have been applied to the right objects
3240.         self.assertEqual(Category.objects.get(id=1).order, 14)
3241.         self.assertEqual(Category.objects.get(id=2).order, 13)
3242.         self.assertEqual(Category.objects.get(id=3).order, 1)
3243.         self.assertEqual(Category.objects.get(id=4).order, 0)
3244. 
3245.     def test_list_editable_pagination(self):
3246.         """
3247.         Pagination works for list_editable items.
3248.         """
3249.         UnorderedObject.objects.create(id=1, name='Unordered object #1')
3250.         UnorderedObject.objects.create(id=2, name='Unordered object #2')
3251.         UnorderedObject.objects.create(id=3, name='Unordered object #3')
3252.         response = self.client.get(reverse('admin:admin_views_unorderedobject_changelist'))
3253.         self.assertContains(response, 'Unordered object #3')
3254.         self.assertContains(response, 'Unordered object #2')
3255.         self.assertNotContains(response, 'Unordered object #1')
3256.         response = self.client.get(reverse('admin:admin_views_unorderedobject_changelist') + '?p=1')
3257.         self.assertNotContains(response, 'Unordered object #3')
3258.         self.assertNotContains(response, 'Unordered object #2')
3259.         self.assertContains(response, 'Unordered object #1')
3260. 
3261.     def test_list_editable_action_submit(self):
3262.         # List editable changes should not be executed if the action "Go" button is
3263.         # used to submit the form.
3264.         data = {
3265.             "form-TOTAL_FORMS": "3",
3266.             "form-INITIAL_FORMS": "3",
3267.             "form-MAX_NUM_FORMS": "0",
3268. 
3269.             "form-0-gender": "1",
3270.             "form-0-id": "1",
3271. 
3272.             "form-1-gender": "2",
3273.             "form-1-id": "2",
3274. 
3275.             "form-2-alive": "checked",
3276.             "form-2-gender": "1",
3277.             "form-2-id": "3",
3278. 
3279.             "index": "0",
3280.             "_selected_action": ['3'],
3281.             "action": ['', 'delete_selected'],
3282.         }
3283.         self.client.post(reverse('admin:admin_views_person_changelist'), data)
3284. 
3285.         self.assertIs(Person.objects.get(name="John Mauchly").alive, True)
3286.         self.assertEqual(Person.objects.get(name="Grace Hopper").gender, 1)
3287. 
3288.     def test_list_editable_action_choices(self):
3289.         # List editable changes should be executed if the "Save" button is
3290.         # used to submit the form - any action choices should be ignored.
3291.         data = {
3292.             "form-TOTAL_FORMS": "3",
3293.             "form-INITIAL_FORMS": "3",
3294.             "form-MAX_NUM_FORMS": "0",
3295. 
3296.             "form-0-gender": "1",
3297.             "form-0-id": "%s" % self.per1.pk,
3298. 
3299.             "form-1-gender": "2",
3300.             "form-1-id": "%s" % self.per2.pk,
3301. 
3302.             "form-2-alive": "checked",
3303.             "form-2-gender": "1",
3304.             "form-2-id": "%s" % self.per3.pk,
3305. 
3306.             "_save": "Save",
3307.             "_selected_action": ['1'],
3308.             "action": ['', 'delete_selected'],
3309.         }
3310.         self.client.post(reverse('admin:admin_views_person_changelist'), data)
3311. 
3312.         self.assertIs(Person.objects.get(name="John Mauchly").alive, False)
3313.         self.assertEqual(Person.objects.get(name="Grace Hopper").gender, 2)
3314. 
3315.     def test_list_editable_popup(self):
3316.         """
3317.         Fields should not be list-editable in popups.
3318.         """
3319.         response = self.client.get(reverse('admin:admin_views_person_changelist'))
3320.         self.assertNotEqual(response.context['cl'].list_editable, ())
3321.         response = self.client.get(reverse('admin:admin_views_person_changelist') + '?%s' % IS_POPUP_VAR)
3322.         self.assertEqual(response.context['cl'].list_editable, ())
3323. 
3324.     def test_pk_hidden_fields(self):
3325.         """
3326.         hidden pk fields aren't displayed in the table body and their
3327.         corresponding human-readable value is displayed instead. The hidden pk
3328.         fields are displayed but separately (not in the table) and only once.
3329.         """
3330.         story1 = Story.objects.create(title='The adventures of Guido', content='Once upon a time in Djangoland...')
3331.         story2 = Story.objects.create(
3332.             title='Crouching Tiger, Hidden Python',
3333.             content='The Python was sneaking into...',
3334.         )
3335.         response = self.client.get(reverse('admin:admin_views_story_changelist'))
3336.         # Only one hidden field, in a separate place than the table.
3337.         self.assertContains(response, 'id="id_form-0-id"', 1)
3338.         self.assertContains(response, 'id="id_form-1-id"', 1)
3339.         self.assertContains(
3340.             response,
3341.             '<div class="hiddenfields">\n'
3342.             '<input type="hidden" name="form-0-id" value="%d" id="id_form-0-id">'
3343.             '<input type="hidden" name="form-1-id" value="%d" id="id_form-1-id">\n</div>'
3344.             % (story2.id, story1.id),
3345.             html=True
3346.         )
3347.         self.assertContains(response, '<td class="field-id">%d</td>' % story1.id, 1)
3348.         self.assertContains(response, '<td class="field-id">%d</td>' % story2.id, 1)
3349. 
3350.     def test_pk_hidden_fields_with_list_display_links(self):
3351.         """ Similarly as test_pk_hidden_fields, but when the hidden pk fields are
3352.             referenced in list_display_links.
3353.             Refs #12475.
3354.         """
3355.         story1 = OtherStory.objects.create(
3356.             title='The adventures of Guido',
3357.             content='Once upon a time in Djangoland...',
3358.         )
3359.         story2 = OtherStory.objects.create(
3360.             title='Crouching Tiger, Hidden Python',
3361.             content='The Python was sneaking into...',
3362.         )
3363.         link1 = reverse('admin:admin_views_otherstory_change', args=(story1.pk,))
3364.         link2 = reverse('admin:admin_views_otherstory_change', args=(story2.pk,))
3365.         response = self.client.get(reverse('admin:admin_views_otherstory_changelist'))
3366.         # Only one hidden field, in a separate place than the table.
3367.         self.assertContains(response, 'id="id_form-0-id"', 1)
3368.         self.assertContains(response, 'id="id_form-1-id"', 1)
3369.         self.assertContains(
3370.             response,
3371.             '<div class="hiddenfields">\n'
3372.             '<input type="hidden" name="form-0-id" value="%d" id="id_form-0-id">'
3373.             '<input type="hidden" name="form-1-id" value="%d" id="id_form-1-id">\n</div>'
3374.             % (story2.id, story1.id),
3375.             html=True
3376.         )
3377.         self.assertContains(response, '<th class="field-id"><a href="%s">%d</a></th>' % (link1, story1.id), 1)
3378.         self.assertContains(response, '<th class="field-id"><a href="%s">%d</a></th>' % (link2, story2.id), 1)
3379. 
3380. 
3381. @override_settings(ROOT_URLCONF='admin_views.urls')
3382. class AdminSearchTest(TestCase):
3383. 
3384.     @classmethod
3385.     def setUpTestData(cls):
3386.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3387.         cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
3388.         cls.s1 = Section.objects.create(name='Test section')
3389.         cls.a1 = Article.objects.create(
3390.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
3391.         )
3392.         cls.a2 = Article.objects.create(
3393.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
3394.         )
3395.         cls.a3 = Article.objects.create(
3396.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
3397.         )
3398.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
3399. 
3400.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
3401.         cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
3402.         cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)
3403. 
3404.         cls.t1 = Recommender.objects.create()
3405.         cls.t2 = Recommendation.objects.create(the_recommender=cls.t1)
3406.         cls.t3 = Recommender.objects.create()
3407.         cls.t4 = Recommendation.objects.create(the_recommender=cls.t3)
3408. 
3409.         cls.tt1 = TitleTranslation.objects.create(title=cls.t1, text='Bar')
3410.         cls.tt2 = TitleTranslation.objects.create(title=cls.t2, text='Foo')
3411.         cls.tt3 = TitleTranslation.objects.create(title=cls.t3, text='Few')
3412.         cls.tt4 = TitleTranslation.objects.create(title=cls.t4, text='Bas')
3413. 
3414.     def setUp(self):
3415.         self.client.force_login(self.superuser)
3416. 
3417.     def test_search_on_sibling_models(self):
3418.         "A search that mentions sibling models"
3419.         response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=bar')
3420.         # confirm the search returned 1 object
3421.         self.assertContains(response, "\n1 recommendation\n")
3422. 
3423.     def test_with_fk_to_field(self):
3424.         """
3425.         The to_field GET parameter is preserved when a search is performed.
3426.         Refs #10918.
3427.         """
3428.         response = self.client.get(reverse('admin:auth_user_changelist') + '?q=joe&%s=id' % TO_FIELD_VAR)
3429.         self.assertContains(response, "\n1 user\n")
3430.         self.assertContains(response, '<input type="hidden" name="%s" value="id">' % TO_FIELD_VAR, html=True)
3431. 
3432.     def test_exact_matches(self):
3433.         response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=bar')
3434.         # confirm the search returned one object
3435.         self.assertContains(response, "\n1 recommendation\n")
3436. 
3437.         response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=ba')
3438.         # confirm the search returned zero objects
3439.         self.assertContains(response, "\n0 recommendations\n")
3440. 
3441.     def test_beginning_matches(self):
3442.         response = self.client.get(reverse('admin:admin_views_person_changelist') + '?q=Gui')
3443.         # confirm the search returned one object
3444.         self.assertContains(response, "\n1 person\n")
3445.         self.assertContains(response, "Guido")
3446. 
3447.         response = self.client.get(reverse('admin:admin_views_person_changelist') + '?q=uido')
3448.         # confirm the search returned zero objects
3449.         self.assertContains(response, "\n0 persons\n")
3450.         self.assertNotContains(response, "Guido")
3451. 
3452.     def test_pluggable_search(self):
3453.         PluggableSearchPerson.objects.create(name="Bob", age=10)
3454.         PluggableSearchPerson.objects.create(name="Amy", age=20)
3455. 
3456.         response = self.client.get(reverse('admin:admin_views_pluggablesearchperson_changelist') + '?q=Bob')
3457.         # confirm the search returned one object
3458.         self.assertContains(response, "\n1 pluggable search person\n")
3459.         self.assertContains(response, "Bob")
3460. 
3461.         response = self.client.get(reverse('admin:admin_views_pluggablesearchperson_changelist') + '?q=20')
3462.         # confirm the search returned one object
3463.         self.assertContains(response, "\n1 pluggable search person\n")
3464.         self.assertContains(response, "Amy")
3465. 
3466.     def test_reset_link(self):
3467.         """
3468.         Test presence of reset link in search bar ("1 result (_x total_)").
3469.         """
3470.         #   1 query for session + 1 for fetching user
3471.         # + 1 for filtered result + 1 for filtered count
3472.         # + 1 for total count
3473.         with self.assertNumQueries(5):
3474.             response = self.client.get(reverse('admin:admin_views_person_changelist') + '?q=Gui')
3475.         self.assertContains(
3476.             response,
3477.             """<span class="small quiet">1 result (<a href="?">3 total</a>)</span>""",
3478.             html=True
3479.         )
3480. 
3481.     def test_no_total_count(self):
3482.         """
3483.         #8408 -- "Show all" should be displayed instead of the total count if
3484.         ModelAdmin.show_full_result_count is False.
3485.         """
3486.         #   1 query for session + 1 for fetching user
3487.         # + 1 for filtered result + 1 for filtered count
3488.         with self.assertNumQueries(4):
3489.             response = self.client.get(reverse('admin:admin_views_recommendation_changelist') + '?q=bar')
3490.         self.assertContains(
3491.             response,
3492.             """<span class="small quiet">1 result (<a href="?">Show all</a>)</span>""",
3493.             html=True
3494.         )
3495.         self.assertTrue(response.context['cl'].show_admin_actions)
3496. 
3497. 
3498. @override_settings(ROOT_URLCONF='admin_views.urls')
3499. class AdminInheritedInlinesTest(TestCase):
3500. 
3501.     @classmethod
3502.     def setUpTestData(cls):
3503.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3504. 
3505.     def setUp(self):
3506.         self.client.force_login(self.superuser)
3507. 
3508.     def test_inline(self):
3509.         """
3510.         Inline models which inherit from a common parent are correctly handled.
3511.         """
3512.         foo_user = "foo username"
3513.         bar_user = "bar username"
3514. 
3515.         name_re = re.compile(b'name="(.*?)"')
3516. 
3517.         # test the add case
3518.         response = self.client.get(reverse('admin:admin_views_persona_add'))
3519.         names = name_re.findall(response.content)
3520.         # make sure we have no duplicate HTML names
3521.         self.assertEqual(len(names), len(set(names)))
3522. 
3523.         # test the add case
3524.         post_data = {
3525.             "name": "Test Name",
3526.             # inline data
3527.             "accounts-TOTAL_FORMS": "1",
3528.             "accounts-INITIAL_FORMS": "0",
3529.             "accounts-MAX_NUM_FORMS": "0",
3530.             "accounts-0-username": foo_user,
3531.             "accounts-2-TOTAL_FORMS": "1",
3532.             "accounts-2-INITIAL_FORMS": "0",
3533.             "accounts-2-MAX_NUM_FORMS": "0",
3534.             "accounts-2-0-username": bar_user,
3535.         }
3536. 
3537.         response = self.client.post(reverse('admin:admin_views_persona_add'), post_data)
3538.         self.assertEqual(response.status_code, 302)  # redirect somewhere
3539.         self.assertEqual(Persona.objects.count(), 1)
3540.         self.assertEqual(FooAccount.objects.count(), 1)
3541.         self.assertEqual(BarAccount.objects.count(), 1)
3542.         self.assertEqual(FooAccount.objects.all()[0].username, foo_user)
3543.         self.assertEqual(BarAccount.objects.all()[0].username, bar_user)
3544.         self.assertEqual(Persona.objects.all()[0].accounts.count(), 2)
3545. 
3546.         persona_id = Persona.objects.all()[0].id
3547.         foo_id = FooAccount.objects.all()[0].id
3548.         bar_id = BarAccount.objects.all()[0].id
3549. 
3550.         # test the edit case
3551. 
3552.         response = self.client.get(reverse('admin:admin_views_persona_change', args=(persona_id,)))
3553.         names = name_re.findall(response.content)
3554.         # make sure we have no duplicate HTML names
3555.         self.assertEqual(len(names), len(set(names)))
3556. 
3557.         post_data = {
3558.             "name": "Test Name",
3559. 
3560.             "accounts-TOTAL_FORMS": "2",
3561.             "accounts-INITIAL_FORMS": "1",
3562.             "accounts-MAX_NUM_FORMS": "0",
3563. 
3564.             "accounts-0-username": "%s-1" % foo_user,
3565.             "accounts-0-account_ptr": str(foo_id),
3566.             "accounts-0-persona": str(persona_id),
3567. 
3568.             "accounts-2-TOTAL_FORMS": "2",
3569.             "accounts-2-INITIAL_FORMS": "1",
3570.             "accounts-2-MAX_NUM_FORMS": "0",
3571. 
3572.             "accounts-2-0-username": "%s-1" % bar_user,
3573.             "accounts-2-0-account_ptr": str(bar_id),
3574.             "accounts-2-0-persona": str(persona_id),
3575.         }
3576.         response = self.client.post(reverse('admin:admin_views_persona_change', args=(persona_id,)), post_data)
3577.         self.assertEqual(response.status_code, 302)
3578.         self.assertEqual(Persona.objects.count(), 1)
3579.         self.assertEqual(FooAccount.objects.count(), 1)
3580.         self.assertEqual(BarAccount.objects.count(), 1)
3581.         self.assertEqual(FooAccount.objects.all()[0].username, "%s-1" % foo_user)
3582.         self.assertEqual(BarAccount.objects.all()[0].username, "%s-1" % bar_user)
3583.         self.assertEqual(Persona.objects.all()[0].accounts.count(), 2)
3584. 
3585. 
3586. @override_settings(ROOT_URLCONF='admin_views.urls')
3587. class TestCustomChangeList(TestCase):
3588. 
3589.     @classmethod
3590.     def setUpTestData(cls):
3591.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3592. 
3593.     def setUp(self):
3594.         self.client.force_login(self.superuser)
3595. 
3596.     def test_custom_changelist(self):
3597.         """
3598.         Validate that a custom ChangeList class can be used (#9749)
3599.         """
3600.         # Insert some data
3601.         post_data = {"name": "First Gadget"}
3602.         response = self.client.post(reverse('admin:admin_views_gadget_add'), post_data)
3603.         self.assertEqual(response.status_code, 302)  # redirect somewhere
3604.         # Hit the page once to get messages out of the queue message list
3605.         response = self.client.get(reverse('admin:admin_views_gadget_changelist'))
3606.         # Data is still not visible on the page
3607.         response = self.client.get(reverse('admin:admin_views_gadget_changelist'))
3608.         self.assertEqual(response.status_code, 200)
3609.         self.assertNotContains(response, 'First Gadget')
3610. 
3611. 
3612. @override_settings(ROOT_URLCONF='admin_views.urls')
3613. class TestInlineNotEditable(TestCase):
3614. 
3615.     @classmethod
3616.     def setUpTestData(cls):
3617.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3618. 
3619.     def setUp(self):
3620.         self.client.force_login(self.superuser)
3621. 
3622.     def test_GET_parent_add(self):
3623.         """
3624.         InlineModelAdmin broken?
3625.         """
3626.         response = self.client.get(reverse('admin:admin_views_parent_add'))
3627.         self.assertEqual(response.status_code, 200)
3628. 
3629. 
3630. @override_settings(ROOT_URLCONF='admin_views.urls')
3631. class AdminCustomQuerysetTest(TestCase):
3632. 
3633.     @classmethod
3634.     def setUpTestData(cls):
3635.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3636.         cls.pks = [EmptyModel.objects.create().id for i in range(3)]
3637. 
3638.     def setUp(self):
3639.         self.client.force_login(self.superuser)
3640.         self.super_login = {
3641.             REDIRECT_FIELD_NAME: reverse('admin:index'),
3642.             'username': 'super',
3643.             'password': 'secret',
3644.         }
3645. 
3646.     def test_changelist_view(self):
3647.         response = self.client.get(reverse('admin:admin_views_emptymodel_changelist'))
3648.         for i in self.pks:
3649.             if i > 1:
3650.                 self.assertContains(response, 'Primary key = %s' % i)
3651.             else:
3652.                 self.assertNotContains(response, 'Primary key = %s' % i)
3653. 
3654.     def test_changelist_view_count_queries(self):
3655.         # create 2 Person objects
3656.         Person.objects.create(name='person1', gender=1)
3657.         Person.objects.create(name='person2', gender=2)
3658.         changelist_url = reverse('admin:admin_views_person_changelist')
3659. 
3660.         # 5 queries are expected: 1 for the session, 1 for the user,
3661.         # 2 for the counts and 1 for the objects on the page
3662.         with self.assertNumQueries(5):
3663.             resp = self.client.get(changelist_url)
3664.             self.assertEqual(resp.context['selection_note'], '0 of 2 selected')
3665.             self.assertEqual(resp.context['selection_note_all'], 'All 2 selected')
3666.         with self.assertNumQueries(5):
3667.             extra = {'q': 'not_in_name'}
3668.             resp = self.client.get(changelist_url, extra)
3669.             self.assertEqual(resp.context['selection_note'], '0 of 0 selected')
3670.             self.assertEqual(resp.context['selection_note_all'], 'All 0 selected')
3671.         with self.assertNumQueries(5):
3672.             extra = {'q': 'person'}
3673.             resp = self.client.get(changelist_url, extra)
3674.             self.assertEqual(resp.context['selection_note'], '0 of 2 selected')
3675.             self.assertEqual(resp.context['selection_note_all'], 'All 2 selected')
3676.         with self.assertNumQueries(5):
3677.             extra = {'gender__exact': '1'}
3678.             resp = self.client.get(changelist_url, extra)
3679.             self.assertEqual(resp.context['selection_note'], '0 of 1 selected')
3680.             self.assertEqual(resp.context['selection_note_all'], '1 selected')
3681. 
3682.     def test_change_view(self):
3683.         for i in self.pks:
3684.             url = reverse('admin:admin_views_emptymodel_change', args=(i,))
3685.             response = self.client.get(url, follow=True)
3686.             if i > 1:
3687.                 self.assertEqual(response.status_code, 200)
3688.             else:
3689.                 self.assertRedirects(response, reverse('admin:index'))
3690.                 self.assertEqual(
3691.                     [m.message for m in response.context['messages']],
3692.                     ["""empty model with ID "1" doesn't exist. Perhaps it was deleted?"""]
3693.                 )
3694. 
3695.     def test_add_model_modeladmin_defer_qs(self):
3696.         # Test for #14529. defer() is used in ModelAdmin.get_queryset()
3697. 
3698.         # model has __str__ method
3699.         self.assertEqual(CoverLetter.objects.count(), 0)
3700.         # Emulate model instance creation via the admin
3701.         post_data = {
3702.             "author": "Candidate, Best",
3703.             "_save": "Save",
3704.         }
3705.         response = self.client.post(reverse('admin:admin_views_coverletter_add'), post_data, follow=True)
3706.         self.assertEqual(response.status_code, 200)
3707.         self.assertEqual(CoverLetter.objects.count(), 1)
3708.         # Message should contain non-ugly model verbose name
3709.         pk = CoverLetter.objects.all()[0].pk
3710.         self.assertContains(
3711.             response,
3712.             '<li class="success">The cover letter "<a href="%s">'
3713.             'Candidate, Best</a>" was added successfully.</li>' %
3714.             reverse('admin:admin_views_coverletter_change', args=(pk,)), html=True
3715.         )
3716. 
3717.         # model has no __str__ method
3718.         self.assertEqual(ShortMessage.objects.count(), 0)
3719.         # Emulate model instance creation via the admin
3720.         post_data = {
3721.             "content": "What's this SMS thing?",
3722.             "_save": "Save",
3723.         }
3724.         response = self.client.post(reverse('admin:admin_views_shortmessage_add'), post_data, follow=True)
3725.         self.assertEqual(response.status_code, 200)
3726.         self.assertEqual(ShortMessage.objects.count(), 1)
3727.         # Message should contain non-ugly model verbose name
3728.         sm = ShortMessage.objects.all()[0]
3729.         self.assertContains(
3730.             response,
3731.             '<li class="success">The short message "<a href="%s">'
3732.             '%s</a>" was added successfully.</li>' %
3733.             (reverse('admin:admin_views_shortmessage_change', args=(sm.pk,)), sm), html=True
3734.         )
3735. 
3736.     def test_add_model_modeladmin_only_qs(self):
3737.         # Test for #14529. only() is used in ModelAdmin.get_queryset()
3738. 
3739.         # model has __str__ method
3740.         self.assertEqual(Telegram.objects.count(), 0)
3741.         # Emulate model instance creation via the admin
3742.         post_data = {
3743.             "title": "Urgent telegram",
3744.             "_save": "Save",
3745.         }
3746.         response = self.client.post(reverse('admin:admin_views_telegram_add'), post_data, follow=True)
3747.         self.assertEqual(response.status_code, 200)
3748.         self.assertEqual(Telegram.objects.count(), 1)
3749.         # Message should contain non-ugly model verbose name
3750.         pk = Telegram.objects.all()[0].pk
3751.         self.assertContains(
3752.             response,
3753.             '<li class="success">The telegram "<a href="%s">'
3754.             'Urgent telegram</a>" was added successfully.</li>' %
3755.             reverse('admin:admin_views_telegram_change', args=(pk,)), html=True
3756.         )
3757. 
3758.         # model has no __str__ method
3759.         self.assertEqual(Paper.objects.count(), 0)
3760.         # Emulate model instance creation via the admin
3761.         post_data = {
3762.             "title": "My Modified Paper Title",
3763.             "_save": "Save",
3764.         }
3765.         response = self.client.post(reverse('admin:admin_views_paper_add'), post_data, follow=True)
3766.         self.assertEqual(response.status_code, 200)
3767.         self.assertEqual(Paper.objects.count(), 1)
3768.         # Message should contain non-ugly model verbose name
3769.         p = Paper.objects.all()[0]
3770.         self.assertContains(
3771.             response,
3772.             '<li class="success">The paper "<a href="%s">'
3773.             '%s</a>" was added successfully.</li>' %
3774.             (reverse('admin:admin_views_paper_change', args=(p.pk,)), p), html=True
3775.         )
3776. 
3777.     def test_edit_model_modeladmin_defer_qs(self):
3778.         # Test for #14529. defer() is used in ModelAdmin.get_queryset()
3779. 
3780.         # model has __str__ method
3781.         cl = CoverLetter.objects.create(author="John Doe")
3782.         self.assertEqual(CoverLetter.objects.count(), 1)
3783.         response = self.client.get(reverse('admin:admin_views_coverletter_change', args=(cl.pk,)))
3784.         self.assertEqual(response.status_code, 200)
3785.         # Emulate model instance edit via the admin
3786.         post_data = {
3787.             "author": "John Doe II",
3788.             "_save": "Save",
3789.         }
3790.         url = reverse('admin:admin_views_coverletter_change', args=(cl.pk,))
3791.         response = self.client.post(url, post_data, follow=True)
3792.         self.assertEqual(response.status_code, 200)
3793.         self.assertEqual(CoverLetter.objects.count(), 1)
3794.         # Message should contain non-ugly model verbose name. Instance
3795.         # representation is set by model's __str__()
3796.         self.assertContains(
3797.             response,
3798.             '<li class="success">The cover letter "<a href="%s">'
3799.             'John Doe II</a>" was changed successfully.</li>' %
3800.             reverse('admin:admin_views_coverletter_change', args=(cl.pk,)), html=True
3801.         )
3802. 
3803.         # model has no __str__ method
3804.         sm = ShortMessage.objects.create(content="This is expensive")
3805.         self.assertEqual(ShortMessage.objects.count(), 1)
3806.         response = self.client.get(reverse('admin:admin_views_shortmessage_change', args=(sm.pk,)))
3807.         self.assertEqual(response.status_code, 200)
3808.         # Emulate model instance edit via the admin
3809.         post_data = {
3810.             "content": "Too expensive",
3811.             "_save": "Save",
3812.         }
3813.         url = reverse('admin:admin_views_shortmessage_change', args=(sm.pk,))
3814.         response = self.client.post(url, post_data, follow=True)
3815.         self.assertEqual(response.status_code, 200)
3816.         self.assertEqual(ShortMessage.objects.count(), 1)
3817.         # Message should contain non-ugly model verbose name. The ugly(!)
3818.         # instance representation is set by __str__().
3819.         self.assertContains(
3820.             response,
3821.             '<li class="success">The short message "<a href="%s">'
3822.             '%s</a>" was changed successfully.</li>' %
3823.             (reverse('admin:admin_views_shortmessage_change', args=(sm.pk,)), sm), html=True
3824.         )
3825. 
3826.     def test_edit_model_modeladmin_only_qs(self):
3827.         # Test for #14529. only() is used in ModelAdmin.get_queryset()
3828. 
3829.         # model has __str__ method
3830.         t = Telegram.objects.create(title="First Telegram")
3831.         self.assertEqual(Telegram.objects.count(), 1)
3832.         response = self.client.get(reverse('admin:admin_views_telegram_change', args=(t.pk,)))
3833.         self.assertEqual(response.status_code, 200)
3834.         # Emulate model instance edit via the admin
3835.         post_data = {
3836.             "title": "Telegram without typo",
3837.             "_save": "Save",
3838.         }
3839.         response = self.client.post(reverse('admin:admin_views_telegram_change', args=(t.pk,)), post_data, follow=True)
3840.         self.assertEqual(response.status_code, 200)
3841.         self.assertEqual(Telegram.objects.count(), 1)
3842.         # Message should contain non-ugly model verbose name. The instance
3843.         # representation is set by model's __str__()
3844.         self.assertContains(
3845.             response,
3846.             '<li class="success">The telegram "<a href="%s">'
3847.             'Telegram without typo</a>" was changed successfully.</li>' %
3848.             reverse('admin:admin_views_telegram_change', args=(t.pk,)), html=True
3849.         )
3850. 
3851.         # model has no __str__ method
3852.         p = Paper.objects.create(title="My Paper Title")
3853.         self.assertEqual(Paper.objects.count(), 1)
3854.         response = self.client.get(reverse('admin:admin_views_paper_change', args=(p.pk,)))
3855.         self.assertEqual(response.status_code, 200)
3856.         # Emulate model instance edit via the admin
3857.         post_data = {
3858.             "title": "My Modified Paper Title",
3859.             "_save": "Save",
3860.         }
3861.         response = self.client.post(reverse('admin:admin_views_paper_change', args=(p.pk,)), post_data, follow=True)
3862.         self.assertEqual(response.status_code, 200)
3863.         self.assertEqual(Paper.objects.count(), 1)
3864.         # Message should contain non-ugly model verbose name. The ugly(!)
3865.         # instance representation is set by __str__().
3866.         self.assertContains(
3867.             response,
3868.             '<li class="success">The paper "<a href="%s">'
3869.             '%s</a>" was changed successfully.</li>' %
3870.             (reverse('admin:admin_views_paper_change', args=(p.pk,)), p), html=True
3871.         )
3872. 
3873.     def test_history_view_custom_qs(self):
3874.         """
3875.         Custom querysets are considered for the admin history view.
3876.         """
3877.         self.client.post(reverse('admin:login'), self.super_login)
3878.         FilteredManager.objects.create(pk=1)
3879.         FilteredManager.objects.create(pk=2)
3880.         response = self.client.get(reverse('admin:admin_views_filteredmanager_changelist'))
3881.         self.assertContains(response, "PK=1")
3882.         self.assertContains(response, "PK=2")
3883.         self.assertEqual(
3884.             self.client.get(reverse('admin:admin_views_filteredmanager_history', args=(1,))).status_code, 200
3885.         )
3886.         self.assertEqual(
3887.             self.client.get(reverse('admin:admin_views_filteredmanager_history', args=(2,))).status_code, 200
3888.         )
3889. 
3890. 
3891. @override_settings(ROOT_URLCONF='admin_views.urls')
3892. class AdminInlineFileUploadTest(TestCase):
3893. 
3894.     @classmethod
3895.     def setUpTestData(cls):
3896.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3897.         file1 = tempfile.NamedTemporaryFile(suffix=".file1")
3898.         file1.write(b'a' * (2 ** 21))
3899.         filename = file1.name
3900.         file1.close()
3901.         cls.gallery = Gallery.objects.create(name='Test Gallery')
3902.         cls.picture = Picture.objects.create(
3903.             name='Test Picture',
3904.             image=filename,
3905.             gallery=cls.gallery,
3906.         )
3907. 
3908.     def setUp(self):
3909.         self.client.force_login(self.superuser)
3910. 
3911.     def test_form_has_multipart_enctype(self):
3912.         response = self.client.get(
3913.             reverse('admin:admin_views_gallery_change', args=(self.gallery.id,))
3914.         )
3915.         self.assertIs(response.context['has_file_field'], True)
3916.         self.assertContains(response, MULTIPART_ENCTYPE)
3917. 
3918.     def test_inline_file_upload_edit_validation_error_post(self):
3919.         """
3920.         Inline file uploads correctly display prior data (#10002).
3921.         """
3922.         post_data = {
3923.             "name": "Test Gallery",
3924.             "pictures-TOTAL_FORMS": "2",
3925.             "pictures-INITIAL_FORMS": "1",
3926.             "pictures-MAX_NUM_FORMS": "0",
3927.             "pictures-0-id": str(self.picture.id),
3928.             "pictures-0-gallery": str(self.gallery.id),
3929.             "pictures-0-name": "Test Picture",
3930.             "pictures-0-image": "",
3931.             "pictures-1-id": "",
3932.             "pictures-1-gallery": str(self.gallery.id),
3933.             "pictures-1-name": "Test Picture 2",
3934.             "pictures-1-image": "",
3935.         }
3936.         response = self.client.post(
3937.             reverse('admin:admin_views_gallery_change', args=(self.gallery.id,)), post_data
3938.         )
3939.         self.assertContains(response, b"Currently")
3940. 
3941. 
3942. @override_settings(ROOT_URLCONF='admin_views.urls')
3943. class AdminInlineTests(TestCase):
3944. 
3945.     @classmethod
3946.     def setUpTestData(cls):
3947.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
3948.         cls.collector = Collector.objects.create(pk=1, name='John Fowles')
3949. 
3950.     def setUp(self):
3951.         self.post_data = {
3952.             "name": "Test Name",
3953. 
3954.             "widget_set-TOTAL_FORMS": "3",
3955.             "widget_set-INITIAL_FORMS": "0",
3956.             "widget_set-MAX_NUM_FORMS": "0",
3957.             "widget_set-0-id": "",
3958.             "widget_set-0-owner": "1",
3959.             "widget_set-0-name": "",
3960.             "widget_set-1-id": "",
3961.             "widget_set-1-owner": "1",
3962.             "widget_set-1-name": "",
3963.             "widget_set-2-id": "",
3964.             "widget_set-2-owner": "1",
3965.             "widget_set-2-name": "",
3966. 
3967.             "doohickey_set-TOTAL_FORMS": "3",
3968.             "doohickey_set-INITIAL_FORMS": "0",
3969.             "doohickey_set-MAX_NUM_FORMS": "0",
3970.             "doohickey_set-0-owner": "1",
3971.             "doohickey_set-0-code": "",
3972.             "doohickey_set-0-name": "",
3973.             "doohickey_set-1-owner": "1",
3974.             "doohickey_set-1-code": "",
3975.             "doohickey_set-1-name": "",
3976.             "doohickey_set-2-owner": "1",
3977.             "doohickey_set-2-code": "",
3978.             "doohickey_set-2-name": "",
3979. 
3980.             "grommet_set-TOTAL_FORMS": "3",
3981.             "grommet_set-INITIAL_FORMS": "0",
3982.             "grommet_set-MAX_NUM_FORMS": "0",
3983.             "grommet_set-0-code": "",
3984.             "grommet_set-0-owner": "1",
3985.             "grommet_set-0-name": "",
3986.             "grommet_set-1-code": "",
3987.             "grommet_set-1-owner": "1",
3988.             "grommet_set-1-name": "",
3989.             "grommet_set-2-code": "",
3990.             "grommet_set-2-owner": "1",
3991.             "grommet_set-2-name": "",
3992. 
3993.             "whatsit_set-TOTAL_FORMS": "3",
3994.             "whatsit_set-INITIAL_FORMS": "0",
3995.             "whatsit_set-MAX_NUM_FORMS": "0",
3996.             "whatsit_set-0-owner": "1",
3997.             "whatsit_set-0-index": "",
3998.             "whatsit_set-0-name": "",
3999.             "whatsit_set-1-owner": "1",
4000.             "whatsit_set-1-index": "",
4001.             "whatsit_set-1-name": "",
4002.             "whatsit_set-2-owner": "1",
4003.             "whatsit_set-2-index": "",
4004.             "whatsit_set-2-name": "",
4005. 
4006.             "fancydoodad_set-TOTAL_FORMS": "3",
4007.             "fancydoodad_set-INITIAL_FORMS": "0",
4008.             "fancydoodad_set-MAX_NUM_FORMS": "0",
4009.             "fancydoodad_set-0-doodad_ptr": "",
4010.             "fancydoodad_set-0-owner": "1",
4011.             "fancydoodad_set-0-name": "",
4012.             "fancydoodad_set-0-expensive": "on",
4013.             "fancydoodad_set-1-doodad_ptr": "",
4014.             "fancydoodad_set-1-owner": "1",
4015.             "fancydoodad_set-1-name": "",
4016.             "fancydoodad_set-1-expensive": "on",
4017.             "fancydoodad_set-2-doodad_ptr": "",
4018.             "fancydoodad_set-2-owner": "1",
4019.             "fancydoodad_set-2-name": "",
4020.             "fancydoodad_set-2-expensive": "on",
4021. 
4022.             "category_set-TOTAL_FORMS": "3",
4023.             "category_set-INITIAL_FORMS": "0",
4024.             "category_set-MAX_NUM_FORMS": "0",
4025.             "category_set-0-order": "",
4026.             "category_set-0-id": "",
4027.             "category_set-0-collector": "1",
4028.             "category_set-1-order": "",
4029.             "category_set-1-id": "",
4030.             "category_set-1-collector": "1",
4031.             "category_set-2-order": "",
4032.             "category_set-2-id": "",
4033.             "category_set-2-collector": "1",
4034.         }
4035. 
4036.         self.client.force_login(self.superuser)
4037. 
4038.     def test_simple_inline(self):
4039.         "A simple model can be saved as inlines"
4040.         # First add a new inline
4041.         self.post_data['widget_set-0-name'] = "Widget 1"
4042.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4043.         response = self.client.post(collector_url, self.post_data)
4044.         self.assertEqual(response.status_code, 302)
4045.         self.assertEqual(Widget.objects.count(), 1)
4046.         self.assertEqual(Widget.objects.all()[0].name, "Widget 1")
4047.         widget_id = Widget.objects.all()[0].id
4048. 
4049.         # The PK link exists on the rendered form
4050.         response = self.client.get(collector_url)
4051.         self.assertContains(response, 'name="widget_set-0-id"')
4052. 
4053.         # No file or image fields, no enctype on the forms
4054.         self.assertIs(response.context['has_file_field'], False)
4055.         self.assertNotContains(response, MULTIPART_ENCTYPE)
4056. 
4057.         # Now resave that inline
4058.         self.post_data['widget_set-INITIAL_FORMS'] = "1"
4059.         self.post_data['widget_set-0-id'] = str(widget_id)
4060.         self.post_data['widget_set-0-name'] = "Widget 1"
4061.         response = self.client.post(collector_url, self.post_data)
4062.         self.assertEqual(response.status_code, 302)
4063.         self.assertEqual(Widget.objects.count(), 1)
4064.         self.assertEqual(Widget.objects.all()[0].name, "Widget 1")
4065. 
4066.         # Now modify that inline
4067.         self.post_data['widget_set-INITIAL_FORMS'] = "1"
4068.         self.post_data['widget_set-0-id'] = str(widget_id)
4069.         self.post_data['widget_set-0-name'] = "Widget 1 Updated"
4070.         response = self.client.post(collector_url, self.post_data)
4071.         self.assertEqual(response.status_code, 302)
4072.         self.assertEqual(Widget.objects.count(), 1)
4073.         self.assertEqual(Widget.objects.all()[0].name, "Widget 1 Updated")
4074. 
4075.     def test_simple_inline_permissions(self):
4076.         """
4077.         Changes aren't allowed without change permissions for the inline object.
4078.         """
4079.         # User who can view Articles
4080.         permissionuser = User.objects.create_user(
4081.             username='permissionuser', password='secret',
4082.             email='vuser@example.com', is_staff=True,
4083.         )
4084.         permissionuser.user_permissions.add(get_perm(Collector, get_permission_codename('view', Collector._meta)))
4085.         permissionuser.user_permissions.add(get_perm(Widget, get_permission_codename('view', Widget._meta)))
4086.         self.client.force_login(permissionuser)
4087.         # Without add permission, a new inline can't be added.
4088.         self.post_data['widget_set-0-name'] = 'Widget 1'
4089.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4090.         response = self.client.post(collector_url, self.post_data)
4091.         self.assertEqual(response.status_code, 302)
4092.         self.assertEqual(Widget.objects.count(), 0)
4093.         # But after adding the permisson it can.
4094.         permissionuser.user_permissions.add(get_perm(Widget, get_permission_codename('add', Widget._meta)))
4095.         self.post_data['widget_set-0-name'] = "Widget 1"
4096.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4097.         response = self.client.post(collector_url, self.post_data)
4098.         self.assertEqual(response.status_code, 302)
4099.         self.assertEqual(Widget.objects.count(), 1)
4100.         self.assertEqual(Widget.objects.first().name, 'Widget 1')
4101.         widget_id = Widget.objects.first().id
4102.         # Without the change permission, a POST doesn't change the object.
4103.         self.post_data['widget_set-INITIAL_FORMS'] = '1'
4104.         self.post_data['widget_set-0-id'] = str(widget_id)
4105.         self.post_data['widget_set-0-name'] = 'Widget 1 Updated'
4106.         response = self.client.post(collector_url, self.post_data)
4107.         self.assertEqual(response.status_code, 302)
4108.         self.assertEqual(Widget.objects.count(), 1)
4109.         self.assertEqual(Widget.objects.first().name, 'Widget 1')
4110.         # Now adding the change permission and editing works.
4111.         permissionuser.user_permissions.remove(get_perm(Widget, get_permission_codename('add', Widget._meta)))
4112.         permissionuser.user_permissions.add(get_perm(Widget, get_permission_codename('change', Widget._meta)))
4113.         self.post_data['widget_set-INITIAL_FORMS'] = '1'
4114.         self.post_data['widget_set-0-id'] = str(widget_id)
4115.         self.post_data['widget_set-0-name'] = 'Widget 1 Updated'
4116.         response = self.client.post(collector_url, self.post_data)
4117.         self.assertEqual(response.status_code, 302)
4118.         self.assertEqual(Widget.objects.count(), 1)
4119.         self.assertEqual(Widget.objects.first().name, 'Widget 1 Updated')
4120. 
4121.     def test_explicit_autofield_inline(self):
4122.         "A model with an explicit autofield primary key can be saved as inlines. Regression for #8093"
4123.         # First add a new inline
4124.         self.post_data['grommet_set-0-name'] = "Grommet 1"
4125.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4126.         response = self.client.post(collector_url, self.post_data)
4127.         self.assertEqual(response.status_code, 302)
4128.         self.assertEqual(Grommet.objects.count(), 1)
4129.         self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1")
4130. 
4131.         # The PK link exists on the rendered form
4132.         response = self.client.get(collector_url)
4133.         self.assertContains(response, 'name="grommet_set-0-code"')
4134. 
4135.         # Now resave that inline
4136.         self.post_data['grommet_set-INITIAL_FORMS'] = "1"
4137.         self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)
4138.         self.post_data['grommet_set-0-name'] = "Grommet 1"
4139.         response = self.client.post(collector_url, self.post_data)
4140.         self.assertEqual(response.status_code, 302)
4141.         self.assertEqual(Grommet.objects.count(), 1)
4142.         self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1")
4143. 
4144.         # Now modify that inline
4145.         self.post_data['grommet_set-INITIAL_FORMS'] = "1"
4146.         self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)
4147.         self.post_data['grommet_set-0-name'] = "Grommet 1 Updated"
4148.         response = self.client.post(collector_url, self.post_data)
4149.         self.assertEqual(response.status_code, 302)
4150.         self.assertEqual(Grommet.objects.count(), 1)
4151.         self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1 Updated")
4152. 
4153.     def test_char_pk_inline(self):
4154.         "A model with a character PK can be saved as inlines. Regression for #10992"
4155.         # First add a new inline
4156.         self.post_data['doohickey_set-0-code'] = "DH1"
4157.         self.post_data['doohickey_set-0-name'] = "Doohickey 1"
4158.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4159.         response = self.client.post(collector_url, self.post_data)
4160.         self.assertEqual(response.status_code, 302)
4161.         self.assertEqual(DooHickey.objects.count(), 1)
4162.         self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1")
4163. 
4164.         # The PK link exists on the rendered form
4165.         response = self.client.get(collector_url)
4166.         self.assertContains(response, 'name="doohickey_set-0-code"')
4167. 
4168.         # Now resave that inline
4169.         self.post_data['doohickey_set-INITIAL_FORMS'] = "1"
4170.         self.post_data['doohickey_set-0-code'] = "DH1"
4171.         self.post_data['doohickey_set-0-name'] = "Doohickey 1"
4172.         response = self.client.post(collector_url, self.post_data)
4173.         self.assertEqual(response.status_code, 302)
4174.         self.assertEqual(DooHickey.objects.count(), 1)
4175.         self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1")
4176. 
4177.         # Now modify that inline
4178.         self.post_data['doohickey_set-INITIAL_FORMS'] = "1"
4179.         self.post_data['doohickey_set-0-code'] = "DH1"
4180.         self.post_data['doohickey_set-0-name'] = "Doohickey 1 Updated"
4181.         response = self.client.post(collector_url, self.post_data)
4182.         self.assertEqual(response.status_code, 302)
4183.         self.assertEqual(DooHickey.objects.count(), 1)
4184.         self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1 Updated")
4185. 
4186.     def test_integer_pk_inline(self):
4187.         "A model with an integer PK can be saved as inlines. Regression for #10992"
4188.         # First add a new inline
4189.         self.post_data['whatsit_set-0-index'] = "42"
4190.         self.post_data['whatsit_set-0-name'] = "Whatsit 1"
4191.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4192.         response = self.client.post(collector_url, self.post_data)
4193.         self.assertEqual(response.status_code, 302)
4194.         self.assertEqual(Whatsit.objects.count(), 1)
4195.         self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1")
4196. 
4197.         # The PK link exists on the rendered form
4198.         response = self.client.get(collector_url)
4199.         self.assertContains(response, 'name="whatsit_set-0-index"')
4200. 
4201.         # Now resave that inline
4202.         self.post_data['whatsit_set-INITIAL_FORMS'] = "1"
4203.         self.post_data['whatsit_set-0-index'] = "42"
4204.         self.post_data['whatsit_set-0-name'] = "Whatsit 1"
4205.         response = self.client.post(collector_url, self.post_data)
4206.         self.assertEqual(response.status_code, 302)
4207.         self.assertEqual(Whatsit.objects.count(), 1)
4208.         self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1")
4209. 
4210.         # Now modify that inline
4211.         self.post_data['whatsit_set-INITIAL_FORMS'] = "1"
4212.         self.post_data['whatsit_set-0-index'] = "42"
4213.         self.post_data['whatsit_set-0-name'] = "Whatsit 1 Updated"
4214.         response = self.client.post(collector_url, self.post_data)
4215.         self.assertEqual(response.status_code, 302)
4216.         self.assertEqual(Whatsit.objects.count(), 1)
4217.         self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1 Updated")
4218. 
4219.     def test_inherited_inline(self):
4220.         "An inherited model can be saved as inlines. Regression for #11042"
4221.         # First add a new inline
4222.         self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1"
4223.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4224.         response = self.client.post(collector_url, self.post_data)
4225.         self.assertEqual(response.status_code, 302)
4226.         self.assertEqual(FancyDoodad.objects.count(), 1)
4227.         self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1")
4228.         doodad_pk = FancyDoodad.objects.all()[0].pk
4229. 
4230.         # The PK link exists on the rendered form
4231.         response = self.client.get(collector_url)
4232.         self.assertContains(response, 'name="fancydoodad_set-0-doodad_ptr"')
4233. 
4234.         # Now resave that inline
4235.         self.post_data['fancydoodad_set-INITIAL_FORMS'] = "1"
4236.         self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)
4237.         self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1"
4238.         response = self.client.post(collector_url, self.post_data)
4239.         self.assertEqual(response.status_code, 302)
4240.         self.assertEqual(FancyDoodad.objects.count(), 1)
4241.         self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1")
4242. 
4243.         # Now modify that inline
4244.         self.post_data['fancydoodad_set-INITIAL_FORMS'] = "1"
4245.         self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)
4246.         self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1 Updated"
4247.         response = self.client.post(collector_url, self.post_data)
4248.         self.assertEqual(response.status_code, 302)
4249.         self.assertEqual(FancyDoodad.objects.count(), 1)
4250.         self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1 Updated")
4251. 
4252.     def test_ordered_inline(self):
4253.         """
4254.         An inline with an editable ordering fields is updated correctly.
4255.         """
4256.         # Create some objects with an initial ordering
4257.         Category.objects.create(id=1, order=1, collector=self.collector)
4258.         Category.objects.create(id=2, order=2, collector=self.collector)
4259.         Category.objects.create(id=3, order=0, collector=self.collector)
4260.         Category.objects.create(id=4, order=0, collector=self.collector)
4261. 
4262.         # NB: The order values must be changed so that the items are reordered.
4263.         self.post_data.update({
4264.             "name": "Frederick Clegg",
4265. 
4266.             "category_set-TOTAL_FORMS": "7",
4267.             "category_set-INITIAL_FORMS": "4",
4268.             "category_set-MAX_NUM_FORMS": "0",
4269. 
4270.             "category_set-0-order": "14",
4271.             "category_set-0-id": "1",
4272.             "category_set-0-collector": "1",
4273. 
4274.             "category_set-1-order": "13",
4275.             "category_set-1-id": "2",
4276.             "category_set-1-collector": "1",
4277. 
4278.             "category_set-2-order": "1",
4279.             "category_set-2-id": "3",
4280.             "category_set-2-collector": "1",
4281. 
4282.             "category_set-3-order": "0",
4283.             "category_set-3-id": "4",
4284.             "category_set-3-collector": "1",
4285. 
4286.             "category_set-4-order": "",
4287.             "category_set-4-id": "",
4288.             "category_set-4-collector": "1",
4289. 
4290.             "category_set-5-order": "",
4291.             "category_set-5-id": "",
4292.             "category_set-5-collector": "1",
4293. 
4294.             "category_set-6-order": "",
4295.             "category_set-6-id": "",
4296.             "category_set-6-collector": "1",
4297.         })
4298.         collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
4299.         response = self.client.post(collector_url, self.post_data)
4300.         # Successful post will redirect
4301.         self.assertEqual(response.status_code, 302)
4302. 
4303.         # The order values have been applied to the right objects
4304.         self.assertEqual(self.collector.category_set.count(), 4)
4305.         self.assertEqual(Category.objects.get(id=1).order, 14)
4306.         self.assertEqual(Category.objects.get(id=2).order, 13)
4307.         self.assertEqual(Category.objects.get(id=3).order, 1)
4308.         self.assertEqual(Category.objects.get(id=4).order, 0)
4309. 
4310. 
4311. @override_settings(ROOT_URLCONF='admin_views.urls')
4312. class NeverCacheTests(TestCase):
4313. 
4314.     @classmethod
4315.     def setUpTestData(cls):
4316.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4317.         cls.s1 = Section.objects.create(name='Test section')
4318. 
4319.     def setUp(self):
4320.         self.client.force_login(self.superuser)
4321. 
4322.     def test_admin_index(self):
4323.         "Check the never-cache status of the main index"
4324.         response = self.client.get(reverse('admin:index'))
4325.         self.assertEqual(get_max_age(response), 0)
4326. 
4327.     def test_app_index(self):
4328.         "Check the never-cache status of an application index"
4329.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
4330.         self.assertEqual(get_max_age(response), 0)
4331. 
4332.     def test_model_index(self):
4333.         "Check the never-cache status of a model index"
4334.         response = self.client.get(reverse('admin:admin_views_fabric_changelist'))
4335.         self.assertEqual(get_max_age(response), 0)
4336. 
4337.     def test_model_add(self):
4338.         "Check the never-cache status of a model add page"
4339.         response = self.client.get(reverse('admin:admin_views_fabric_add'))
4340.         self.assertEqual(get_max_age(response), 0)
4341. 
4342.     def test_model_view(self):
4343.         "Check the never-cache status of a model edit page"
4344.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
4345.         self.assertEqual(get_max_age(response), 0)
4346. 
4347.     def test_model_history(self):
4348.         "Check the never-cache status of a model history page"
4349.         response = self.client.get(reverse('admin:admin_views_section_history', args=(self.s1.pk,)))
4350.         self.assertEqual(get_max_age(response), 0)
4351. 
4352.     def test_model_delete(self):
4353.         "Check the never-cache status of a model delete page"
4354.         response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
4355.         self.assertEqual(get_max_age(response), 0)
4356. 
4357.     def test_login(self):
4358.         "Check the never-cache status of login views"
4359.         self.client.logout()
4360.         response = self.client.get(reverse('admin:index'))
4361.         self.assertEqual(get_max_age(response), 0)
4362. 
4363.     def test_logout(self):
4364.         "Check the never-cache status of logout view"
4365.         response = self.client.get(reverse('admin:logout'))
4366.         self.assertEqual(get_max_age(response), 0)
4367. 
4368.     def test_password_change(self):
4369.         "Check the never-cache status of the password change view"
4370.         self.client.logout()
4371.         response = self.client.get(reverse('admin:password_change'))
4372.         self.assertIsNone(get_max_age(response))
4373. 
4374.     def test_password_change_done(self):
4375.         "Check the never-cache status of the password change done view"
4376.         response = self.client.get(reverse('admin:password_change_done'))
4377.         self.assertIsNone(get_max_age(response))
4378. 
4379.     def test_JS_i18n(self):
4380.         "Check the never-cache status of the JavaScript i18n view"
4381.         response = self.client.get(reverse('admin:jsi18n'))
4382.         self.assertIsNone(get_max_age(response))
4383. 
4384. 
4385. @override_settings(ROOT_URLCONF='admin_views.urls')
4386. class PrePopulatedTest(TestCase):
4387. 
4388.     @classmethod
4389.     def setUpTestData(cls):
4390.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4391.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
4392. 
4393.     def setUp(self):
4394.         self.client.force_login(self.superuser)
4395. 
4396.     def test_prepopulated_on(self):
4397.         response = self.client.get(reverse('admin:admin_views_prepopulatedpost_add'))
4398.         self.assertContains(response, "&quot;id&quot;: &quot;#id_slug&quot;")
4399.         self.assertContains(response, "&quot;dependency_ids&quot;: [&quot;#id_title&quot;]")
4400.         self.assertContains(response, "&quot;id&quot;: &quot;#id_prepopulatedsubpost_set-0-subslug&quot;")
4401. 
4402.     def test_prepopulated_off(self):
4403.         response = self.client.get(reverse('admin:admin_views_prepopulatedpost_change', args=(self.p1.pk,)))
4404.         self.assertContains(response, "A Long Title")
4405.         self.assertNotContains(response, "&quot;id&quot;: &quot;#id_slug&quot;")
4406.         self.assertNotContains(response, "&quot;dependency_ids&quot;: [&quot;#id_title&quot;]")
4407.         self.assertNotContains(
4408.             response,
4409.             "&quot;id&quot;: &quot;#id_prepopulatedsubpost_set-0-subslug&quot;"
4410.         )
4411. 
4412.     @override_settings(USE_THOUSAND_SEPARATOR=True, USE_L10N=True)
4413.     def test_prepopulated_maxlength_localized(self):
4414.         """
4415.         Regression test for #15938: if USE_THOUSAND_SEPARATOR is set, make sure
4416.         that maxLength (in the JavaScript) is rendered without separators.
4417.         """
4418.         response = self.client.get(reverse('admin:admin_views_prepopulatedpostlargeslug_add'))
4419.         self.assertContains(response, "&quot;maxLength&quot;: 1000")  # instead of 1,000
4420. 
4421.     def test_view_only_add_form(self):
4422.         """
4423.         PrePopulatedPostReadOnlyAdmin.prepopulated_fields includes 'slug'
4424.         which is present in the add view, even if the
4425.         ModelAdmin.has_change_permission() returns False.
4426.         """
4427.         response = self.client.get(reverse('admin7:admin_views_prepopulatedpost_add'))
4428.         self.assertContains(response, 'data-prepopulated-fields=')
4429.         self.assertContains(response, '&quot;id&quot;: &quot;#id_slug&quot;')
4430. 
4431.     def test_view_only_change_form(self):
4432.         """
4433.         PrePopulatedPostReadOnlyAdmin.prepopulated_fields includes 'slug'. That
4434.         doesn't break a view-only change view.
4435.         """
4436.         response = self.client.get(reverse('admin7:admin_views_prepopulatedpost_change', args=(self.p1.pk,)))
4437.         self.assertContains(response, 'data-prepopulated-fields="[]"')
4438.         self.assertContains(response, '<div class="readonly">%s</div>' % self.p1.slug)
4439. 
4440. 
4441. @override_settings(ROOT_URLCONF='admin_views.urls')
4442. class SeleniumTests(AdminSeleniumTestCase):
4443. 
4444.     available_apps = ['admin_views'] + AdminSeleniumTestCase.available_apps
4445. 
4446.     def setUp(self):
4447.         self.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4448.         self.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
4449. 
4450.     def test_prepopulated_fields(self):
4451.         """
4452.         The JavaScript-automated prepopulated fields work with the main form
4453.         and with stacked and tabular inlines.
4454.         Refs #13068, #9264, #9983, #9784.
4455.         """
4456.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4457.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_mainprepopulated_add'))
4458.         self.wait_for('.select2')
4459. 
4460.         # Main form ----------------------------------------------------------
4461.         self.selenium.find_element_by_id('id_pubdate').send_keys('2012-02-18')
4462.         self.get_select_option('#id_status', 'option two').click()
4463.         self.selenium.find_element_by_id('id_name').send_keys(' this is the mAin nÀMë and it\'s awεšomeııı')
4464.         slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
4465.         slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
4466.         slug3 = self.selenium.find_element_by_id('id_slug3').get_attribute('value')
4467.         self.assertEqual(slug1, 'main-name-and-its-awesomeiii-2012-02-18')
4468.         self.assertEqual(slug2, 'option-two-main-name-and-its-awesomeiii')
4469.         self.assertEqual(slug3, 'this-is-the-main-n\xe0m\xeb-and-its-aw\u03b5\u0161ome\u0131\u0131\u0131')
4470. 
4471.         # Stacked inlines ----------------------------------------------------
4472.         # Initial inline
4473.         self.selenium.find_element_by_id('id_relatedprepopulated_set-0-pubdate').send_keys('2011-12-17')
4474.         self.get_select_option('#id_relatedprepopulated_set-0-status', 'option one').click()
4475.         self.selenium.find_element_by_id('id_relatedprepopulated_set-0-name').send_keys(
4476.             ' here is a sŤāÇkeð   inline !  '
4477.         )
4478.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-0-slug1').get_attribute('value')
4479.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-0-slug2').get_attribute('value')
4480.         self.assertEqual(slug1, 'here-stacked-inline-2011-12-17')
4481.         self.assertEqual(slug2, 'option-one-here-stacked-inline')
4482.         initial_select2_inputs = self.selenium.find_elements_by_class_name('select2-selection')
4483.         # Inline formsets have empty/invisible forms.
4484.         # Only the 4 visible select2 inputs are initialized.
4485.         num_initial_select2_inputs = len(initial_select2_inputs)
4486.         self.assertEqual(num_initial_select2_inputs, 4)
4487. 
4488.         # Add an inline
4489.         self.selenium.find_elements_by_link_text('Add another Related prepopulated')[0].click()
4490.         self.assertEqual(
4491.             len(self.selenium.find_elements_by_class_name('select2-selection')),
4492.             num_initial_select2_inputs + 2
4493.         )
4494.         self.selenium.find_element_by_id('id_relatedprepopulated_set-1-pubdate').send_keys('1999-01-25')
4495.         self.get_select_option('#id_relatedprepopulated_set-1-status', 'option two').click()
4496.         self.selenium.find_element_by_id('id_relatedprepopulated_set-1-name').send_keys(
4497.             ' now you haVe anöther   sŤāÇkeð  inline with a very ... '
4498.             'loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooog text... '
4499.         )
4500.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-1-slug1').get_attribute('value')
4501.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-1-slug2').get_attribute('value')
4502.         # 50 characters maximum for slug1 field
4503.         self.assertEqual(slug1, 'now-you-have-another-stacked-inline-very-loooooooo')
4504.         # 60 characters maximum for slug2 field
4505.         self.assertEqual(slug2, 'option-two-now-you-have-another-stacked-inline-very-looooooo')
4506. 
4507.         # Tabular inlines ----------------------------------------------------
4508.         # Initial inline
4509.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-pubdate').send_keys('1234-12-07')
4510.         self.get_select_option('#id_relatedprepopulated_set-2-0-status', 'option two').click()
4511.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-name').send_keys(
4512.             'And now, with a tÃbűlaŘ inline !!!'
4513.         )
4514.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-slug1').get_attribute('value')
4515.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-slug2').get_attribute('value')
4516.         self.assertEqual(slug1, 'and-now-tabular-inline-1234-12-07')
4517.         self.assertEqual(slug2, 'option-two-and-now-tabular-inline')
4518. 
4519.         # Add an inline
4520.         self.selenium.find_elements_by_link_text('Add another Related prepopulated')[1].click()
4521.         self.assertEqual(
4522.             len(self.selenium.find_elements_by_class_name('select2-selection')),
4523.             num_initial_select2_inputs + 4
4524.         )
4525.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-pubdate').send_keys('1981-08-22')
4526.         self.get_select_option('#id_relatedprepopulated_set-2-1-status', 'option one').click()
4527.         self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-name').send_keys(
4528.             r'a tÃbűlaŘ inline with ignored ;"&*^\%$#@-/`~ characters'
4529.         )
4530.         slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-slug1').get_attribute('value')
4531.         slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-slug2').get_attribute('value')
4532.         self.assertEqual(slug1, 'tabular-inline-ignored-characters-1981-08-22')
4533.         self.assertEqual(slug2, 'option-one-tabular-inline-ignored-characters')
4534.         # Add an inline without an initial inline.
4535.         # The button is outside of the browser frame.
4536.         self.selenium.execute_script("window.scrollTo(0, document.body.scrollHeight);")
4537.         self.selenium.find_elements_by_link_text('Add another Related prepopulated')[2].click()
4538.         self.assertEqual(
4539.             len(self.selenium.find_elements_by_class_name('select2-selection')),
4540.             num_initial_select2_inputs + 6
4541.         )
4542.         # Save and check that everything is properly stored in the database
4543.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4544.         self.wait_page_loaded()
4545.         self.assertEqual(MainPrepopulated.objects.all().count(), 1)
4546.         MainPrepopulated.objects.get(
4547.             name=' this is the mAin nÀMë and it\'s awεšomeııı',
4548.             pubdate='2012-02-18',
4549.             status='option two',
4550.             slug1='main-name-and-its-awesomeiii-2012-02-18',
4551.             slug2='option-two-main-name-and-its-awesomeiii',
4552.         )
4553.         self.assertEqual(RelatedPrepopulated.objects.all().count(), 4)
4554.         RelatedPrepopulated.objects.get(
4555.             name=' here is a sŤāÇkeð   inline !  ',
4556.             pubdate='2011-12-17',
4557.             status='option one',
4558.             slug1='here-stacked-inline-2011-12-17',
4559.             slug2='option-one-here-stacked-inline',
4560.         )
4561.         RelatedPrepopulated.objects.get(
4562.             # 75 characters in name field
4563.             name=' now you haVe anöther   sŤāÇkeð  inline with a very ... loooooooooooooooooo',
4564.             pubdate='1999-01-25',
4565.             status='option two',
4566.             slug1='now-you-have-another-stacked-inline-very-loooooooo',
4567.             slug2='option-two-now-you-have-another-stacked-inline-very-looooooo',
4568.         )
4569.         RelatedPrepopulated.objects.get(
4570.             name='And now, with a tÃbűlaŘ inline !!!',
4571.             pubdate='1234-12-07',
4572.             status='option two',
4573.             slug1='and-now-tabular-inline-1234-12-07',
4574.             slug2='option-two-and-now-tabular-inline',
4575.         )
4576.         RelatedPrepopulated.objects.get(
4577.             name=r'a tÃbűlaŘ inline with ignored ;"&*^\%$#@-/`~ characters',
4578.             pubdate='1981-08-22',
4579.             status='option one',
4580.             slug1='tabular-inline-ignored-characters-1981-08-22',
4581.             slug2='option-one-tabular-inline-ignored-characters',
4582.         )
4583. 
4584.     def test_populate_existing_object(self):
4585.         """
4586.         The prepopulation works for existing objects too, as long as
4587.         the original field is empty (#19082).
4588.         """
4589.         # Slugs are empty to start with.
4590.         item = MainPrepopulated.objects.create(
4591.             name=' this is the mAin nÀMë',
4592.             pubdate='2012-02-18',
4593.             status='option two',
4594.             slug1='',
4595.             slug2='',
4596.         )
4597.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4598. 
4599.         object_url = self.live_server_url + reverse('admin:admin_views_mainprepopulated_change', args=(item.id,))
4600. 
4601.         self.selenium.get(object_url)
4602.         self.selenium.find_element_by_id('id_name').send_keys(' the best')
4603. 
4604.         # The slugs got prepopulated since they were originally empty
4605.         slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
4606.         slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
4607.         self.assertEqual(slug1, 'main-name-best-2012-02-18')
4608.         self.assertEqual(slug2, 'option-two-main-name-best')
4609. 
4610.         # Save the object
4611.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4612.         self.wait_page_loaded()
4613. 
4614.         self.selenium.get(object_url)
4615.         self.selenium.find_element_by_id('id_name').send_keys(' hello')
4616. 
4617.         # The slugs got prepopulated didn't change since they were originally not empty
4618.         slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
4619.         slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
4620.         self.assertEqual(slug1, 'main-name-best-2012-02-18')
4621.         self.assertEqual(slug2, 'option-two-main-name-best')
4622. 
4623.     def test_collapsible_fieldset(self):
4624.         """
4625.         The 'collapse' class in fieldsets definition allows to
4626.         show/hide the appropriate field section.
4627.         """
4628.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4629.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_article_add'))
4630.         self.assertFalse(self.selenium.find_element_by_id('id_title').is_displayed())
4631.         self.selenium.find_elements_by_link_text('Show')[0].click()
4632.         self.assertTrue(self.selenium.find_element_by_id('id_title').is_displayed())
4633.         self.assertEqual(self.selenium.find_element_by_id('fieldsetcollapser0').text, "Hide")
4634. 
4635.     def test_first_field_focus(self):
4636.         """JavaScript-assisted auto-focus on first usable form field."""
4637.         # First form field has a single widget
4638.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4639.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_picture_add'))
4640.         self.assertEqual(
4641.             self.selenium.switch_to.active_element,
4642.             self.selenium.find_element_by_id('id_name')
4643.         )
4644. 
4645.         # First form field has a MultiWidget
4646.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_reservation_add'))
4647.         self.assertEqual(
4648.             self.selenium.switch_to.active_element,
4649.             self.selenium.find_element_by_id('id_start_date_0')
4650.         )
4651. 
4652.     def test_cancel_delete_confirmation(self):
4653.         "Cancelling the deletion of an object takes the user back one page."
4654.         pizza = Pizza.objects.create(name="Double Cheese")
4655.         url = reverse('admin:admin_views_pizza_change', args=(pizza.id,))
4656.         full_url = self.live_server_url + url
4657.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4658.         self.selenium.get(full_url)
4659.         self.selenium.find_element_by_class_name('deletelink').click()
4660.         # Click 'cancel' on the delete page.
4661.         self.selenium.find_element_by_class_name('cancel-link').click()
4662.         # Wait until we're back on the change page.
4663.         self.wait_for_text('#content h1', 'Change pizza')
4664.         self.assertEqual(self.selenium.current_url, full_url)
4665.         self.assertEqual(Pizza.objects.count(), 1)
4666. 
4667.     def test_cancel_delete_related_confirmation(self):
4668.         """
4669.         Cancelling the deletion of an object with relations takes the user back
4670.         one page.
4671.         """
4672.         pizza = Pizza.objects.create(name="Double Cheese")
4673.         topping1 = Topping.objects.create(name="Cheddar")
4674.         topping2 = Topping.objects.create(name="Mozzarella")
4675.         pizza.toppings.add(topping1, topping2)
4676.         url = reverse('admin:admin_views_pizza_change', args=(pizza.id,))
4677.         full_url = self.live_server_url + url
4678.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4679.         self.selenium.get(full_url)
4680.         self.selenium.find_element_by_class_name('deletelink').click()
4681.         # Click 'cancel' on the delete page.
4682.         self.selenium.find_element_by_class_name('cancel-link').click()
4683.         # Wait until we're back on the change page.
4684.         self.wait_for_text('#content h1', 'Change pizza')
4685.         self.assertEqual(self.selenium.current_url, full_url)
4686.         self.assertEqual(Pizza.objects.count(), 1)
4687.         self.assertEqual(Topping.objects.count(), 2)
4688. 
4689.     def test_list_editable_popups(self):
4690.         """
4691.         list_editable foreign keys have add/change popups.
4692.         """
4693.         from selenium.webdriver.support.ui import Select
4694.         s1 = Section.objects.create(name='Test section')
4695.         Article.objects.create(
4696.             title='foo',
4697.             content='<p>Middle content</p>',
4698.             date=datetime.datetime(2008, 3, 18, 11, 54, 58),
4699.             section=s1,
4700.         )
4701.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4702.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_article_changelist'))
4703.         # Change popup
4704.         self.selenium.find_element_by_id('change_id_form-0-section').click()
4705.         self.wait_for_popup()
4706.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4707.         self.wait_for_text('#content h1', 'Change section')
4708.         name_input = self.selenium.find_element_by_id('id_name')
4709.         name_input.clear()
4710.         name_input.send_keys('<i>edited section</i>')
4711.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4712.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4713.         select = Select(self.selenium.find_element_by_id('id_form-0-section'))
4714.         self.assertEqual(select.first_selected_option.text, '<i>edited section</i>')
4715.         # Rendered select2 input.
4716.         select2_display = self.selenium.find_element_by_class_name('select2-selection__rendered')
4717.         # Clear button (×\n) is included in text.
4718.         self.assertEqual(select2_display.text, '×\n<i>edited section</i>')
4719. 
4720.         # Add popup
4721.         self.selenium.find_element_by_id('add_id_form-0-section').click()
4722.         self.wait_for_popup()
4723.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4724.         self.wait_for_text('#content h1', 'Add section')
4725.         self.selenium.find_element_by_id('id_name').send_keys('new section')
4726.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4727.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4728.         select = Select(self.selenium.find_element_by_id('id_form-0-section'))
4729.         self.assertEqual(select.first_selected_option.text, 'new section')
4730.         select2_display = self.selenium.find_element_by_class_name('select2-selection__rendered')
4731.         # Clear button (×\n) is included in text.
4732.         self.assertEqual(select2_display.text, '×\nnew section')
4733. 
4734.     def test_inline_uuid_pk_edit_with_popup(self):
4735.         from selenium.webdriver.support.ui import Select
4736.         parent = ParentWithUUIDPK.objects.create(title='test')
4737.         related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
4738.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4739.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
4740.         self.selenium.get(self.live_server_url + change_url)
4741.         self.selenium.find_element_by_id('change_id_parent').click()
4742.         self.wait_for_popup()
4743.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4744.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4745.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4746.         select = Select(self.selenium.find_element_by_id('id_parent'))
4747.         self.assertEqual(select.first_selected_option.text, str(parent.id))
4748.         self.assertEqual(select.first_selected_option.get_attribute('value'), str(parent.id))
4749. 
4750.     def test_inline_uuid_pk_add_with_popup(self):
4751.         from selenium.webdriver.support.ui import Select
4752.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4753.         self.selenium.get(self.live_server_url + reverse('admin:admin_views_relatedwithuuidpkmodel_add'))
4754.         self.selenium.find_element_by_id('add_id_parent').click()
4755.         self.wait_for_popup()
4756.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4757.         self.selenium.find_element_by_id('id_title').send_keys('test')
4758.         self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
4759.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4760.         select = Select(self.selenium.find_element_by_id('id_parent'))
4761.         uuid_id = str(ParentWithUUIDPK.objects.first().id)
4762.         self.assertEqual(select.first_selected_option.text, uuid_id)
4763.         self.assertEqual(select.first_selected_option.get_attribute('value'), uuid_id)
4764. 
4765.     def test_inline_uuid_pk_delete_with_popup(self):
4766.         from selenium.webdriver.support.ui import Select
4767.         parent = ParentWithUUIDPK.objects.create(title='test')
4768.         related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
4769.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4770.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
4771.         self.selenium.get(self.live_server_url + change_url)
4772.         self.selenium.find_element_by_id('delete_id_parent').click()
4773.         self.wait_for_popup()
4774.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4775.         self.selenium.find_element_by_xpath('//input[@value="Yes, I\'m sure"]').click()
4776.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4777.         select = Select(self.selenium.find_element_by_id('id_parent'))
4778.         self.assertEqual(ParentWithUUIDPK.objects.count(), 0)
4779.         self.assertEqual(select.first_selected_option.text, '---------')
4780.         self.assertEqual(select.first_selected_option.get_attribute('value'), '')
4781. 
4782.     def test_inline_with_popup_cancel_delete(self):
4783.         """Clicking ""No, take me back" on a delete popup closes the window."""
4784.         parent = ParentWithUUIDPK.objects.create(title='test')
4785.         related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
4786.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4787.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
4788.         self.selenium.get(self.live_server_url + change_url)
4789.         self.selenium.find_element_by_id('delete_id_parent').click()
4790.         self.wait_for_popup()
4791.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4792.         self.selenium.find_element_by_xpath('//a[text()="No, take me back"]').click()
4793.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4794.         self.assertEqual(len(self.selenium.window_handles), 1)
4795. 
4796.     def test_list_editable_raw_id_fields(self):
4797.         parent = ParentWithUUIDPK.objects.create(title='test')
4798.         parent2 = ParentWithUUIDPK.objects.create(title='test2')
4799.         RelatedWithUUIDPKModel.objects.create(parent=parent)
4800.         self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
4801.         change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_changelist', current_app=site2.name)
4802.         self.selenium.get(self.live_server_url + change_url)
4803.         self.selenium.find_element_by_id('lookup_id_form-0-parent').click()
4804.         self.wait_for_popup()
4805.         self.selenium.switch_to.window(self.selenium.window_handles[-1])
4806.         # Select "parent2" in the popup.
4807.         self.selenium.find_element_by_link_text(str(parent2.pk)).click()
4808.         self.selenium.switch_to.window(self.selenium.window_handles[0])
4809.         # The newly selected pk should appear in the raw id input.
4810.         value = self.selenium.find_element_by_id('id_form-0-parent').get_attribute('value')
4811.         self.assertEqual(value, str(parent2.pk))
4812. 
4813. 
4814. @override_settings(ROOT_URLCONF='admin_views.urls')
4815. class ReadonlyTest(AdminFieldExtractionMixin, TestCase):
4816. 
4817.     @classmethod
4818.     def setUpTestData(cls):
4819.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4820. 
4821.     def setUp(self):
4822.         self.client.force_login(self.superuser)
4823. 
4824.     def test_readonly_get(self):
4825.         response = self.client.get(reverse('admin:admin_views_post_add'))
4826.         self.assertEqual(response.status_code, 200)
4827.         self.assertNotContains(response, 'name="posted"')
4828.         # 3 fields + 2 submit buttons + 5 inline management form fields, + 2
4829.         # hidden fields for inlines + 1 field for the inline + 2 empty form
4830.         self.assertContains(response, "<input", count=15)
4831.         self.assertContains(response, formats.localize(datetime.date.today()))
4832.         self.assertContains(response, "<label>Awesomeness level:</label>")
4833.         self.assertContains(response, "Very awesome.")
4834.         self.assertContains(response, "Unknown coolness.")
4835.         self.assertContains(response, "foo")
4836. 
4837.         # Multiline text in a readonly field gets <br> tags
4838.         self.assertContains(response, 'Multiline<br>test<br>string')
4839.         self.assertContains(response, '<div class="readonly">Multiline<br>html<br>content</div>', html=True)
4840.         self.assertContains(response, 'InlineMultiline<br>test<br>string')
4841. 
4842.         self.assertContains(response, formats.localize(datetime.date.today() - datetime.timedelta(days=7)))
4843. 
4844.         self.assertContains(response, '<div class="form-row field-coolness">')
4845.         self.assertContains(response, '<div class="form-row field-awesomeness_level">')
4846.         self.assertContains(response, '<div class="form-row field-posted">')
4847.         self.assertContains(response, '<div class="form-row field-value">')
4848.         self.assertContains(response, '<div class="form-row">')
4849.         self.assertContains(response, '<div class="help">', 3)
4850.         self.assertContains(
4851.             response,
4852.             '<div class="help">Some help text for the title (with unicode ŠĐĆŽćžšđ)</div>',
4853.             html=True
4854.         )
4855.         self.assertContains(
4856.             response,
4857.             '<div class="help">Some help text for the content (with unicode ŠĐĆŽćžšđ)</div>',
4858.             html=True
4859.         )
4860.         self.assertContains(
4861.             response,
4862.             '<div class="help">Some help text for the date (with unicode ŠĐĆŽćžšđ)</div>',
4863.             html=True
4864.         )
4865. 
4866.         p = Post.objects.create(title="I worked on readonly_fields", content="Its good stuff")
4867.         response = self.client.get(reverse('admin:admin_views_post_change', args=(p.pk,)))
4868.         self.assertContains(response, "%d amount of cool" % p.pk)
4869. 
4870.     def test_readonly_text_field(self):
4871.         p = Post.objects.create(
4872.             title="Readonly test", content="test",
4873.             readonly_content='test\r\n\r\ntest\r\n\r\ntest\r\n\r\ntest',
4874.         )
4875.         Link.objects.create(
4876.             url="http://www.djangoproject.com", post=p,
4877.             readonly_link_content="test\r\nlink",
4878.         )
4879.         response = self.client.get(reverse('admin:admin_views_post_change', args=(p.pk,)))
4880.         # Checking readonly field.
4881.         self.assertContains(response, 'test<br><br>test<br><br>test<br><br>test')
4882.         # Checking readonly field in inline.
4883.         self.assertContains(response, 'test<br>link')
4884. 
4885.     def test_readonly_post(self):
4886.         data = {
4887.             "title": "Django Got Readonly Fields",
4888.             "content": "This is an incredible development.",
4889.             "link_set-TOTAL_FORMS": "1",
4890.             "link_set-INITIAL_FORMS": "0",
4891.             "link_set-MAX_NUM_FORMS": "0",
4892.         }
4893.         response = self.client.post(reverse('admin:admin_views_post_add'), data)
4894.         self.assertEqual(response.status_code, 302)
4895.         self.assertEqual(Post.objects.count(), 1)
4896.         p = Post.objects.get()
4897.         self.assertEqual(p.posted, datetime.date.today())
4898. 
4899.         data["posted"] = "10-8-1990"  # some date that's not today
4900.         response = self.client.post(reverse('admin:admin_views_post_add'), data)
4901.         self.assertEqual(response.status_code, 302)
4902.         self.assertEqual(Post.objects.count(), 2)
4903.         p = Post.objects.order_by('-id')[0]
4904.         self.assertEqual(p.posted, datetime.date.today())
4905. 
4906.     def test_readonly_manytomany(self):
4907.         "Regression test for #13004"
4908.         response = self.client.get(reverse('admin:admin_views_pizza_add'))
4909.         self.assertEqual(response.status_code, 200)
4910. 
4911.     def test_user_password_change_limited_queryset(self):
4912.         su = User.objects.filter(is_superuser=True)[0]
4913.         response = self.client.get(reverse('admin2:auth_user_password_change', args=(su.pk,)))
4914.         self.assertEqual(response.status_code, 404)
4915. 
4916.     def test_change_form_renders_correct_null_choice_value(self):
4917.         """
4918.         Regression test for #17911.
4919.         """
4920.         choice = Choice.objects.create(choice=None)
4921.         response = self.client.get(reverse('admin:admin_views_choice_change', args=(choice.pk,)))
4922.         self.assertContains(response, '<div class="readonly">No opinion</div>', html=True)
4923. 
4924.     def test_readonly_manytomany_backwards_ref(self):
4925.         """
4926.         Regression test for #16433 - backwards references for related objects
4927.         broke if the related field is read-only due to the help_text attribute
4928.         """
4929.         topping = Topping.objects.create(name='Salami')
4930.         pizza = Pizza.objects.create(name='Americano')
4931.         pizza.toppings.add(topping)
4932.         response = self.client.get(reverse('admin:admin_views_topping_add'))
4933.         self.assertEqual(response.status_code, 200)
4934. 
4935.     def test_readonly_manytomany_forwards_ref(self):
4936.         topping = Topping.objects.create(name='Salami')
4937.         pizza = Pizza.objects.create(name='Americano')
4938.         pizza.toppings.add(topping)
4939.         response = self.client.get(reverse('admin:admin_views_pizza_change', args=(pizza.pk,)))
4940.         self.assertContains(response, '<label>Toppings:</label>', html=True)
4941.         self.assertContains(response, '<div class="readonly">Salami</div>', html=True)
4942. 
4943.     def test_readonly_onetoone_backwards_ref(self):
4944.         """
4945.         Can reference a reverse OneToOneField in ModelAdmin.readonly_fields.
4946.         """
4947.         v1 = Villain.objects.create(name='Adam')
4948.         pl = Plot.objects.create(name='Test Plot', team_leader=v1, contact=v1)
4949.         pd = PlotDetails.objects.create(details='Brand New Plot', plot=pl)
4950. 
4951.         response = self.client.get(reverse('admin:admin_views_plotproxy_change', args=(pl.pk,)))
4952.         field = self.get_admin_readonly_field(response, 'plotdetails')
4953.         self.assertEqual(field.contents(), 'Brand New Plot')
4954. 
4955.         # The reverse relation also works if the OneToOneField is null.
4956.         pd.plot = None
4957.         pd.save()
4958. 
4959.         response = self.client.get(reverse('admin:admin_views_plotproxy_change', args=(pl.pk,)))
4960.         field = self.get_admin_readonly_field(response, 'plotdetails')
4961.         self.assertEqual(field.contents(), '-')  # default empty value
4962. 
4963.     def test_readonly_field_overrides(self):
4964.         """
4965.         Regression test for #22087 - ModelForm Meta overrides are ignored by
4966.         AdminReadonlyField
4967.         """
4968.         p = FieldOverridePost.objects.create(title="Test Post", content="Test Content")
4969.         response = self.client.get(reverse('admin:admin_views_fieldoverridepost_change', args=(p.pk,)))
4970.         self.assertContains(response, '<div class="help">Overridden help text for the date</div>')
4971.         self.assertContains(response, '<label for="id_public">Overridden public label:</label>', html=True)
4972.         self.assertNotContains(response, "Some help text for the date (with unicode ŠĐĆŽćžšđ)")
4973. 
4974.     def test_correct_autoescaping(self):
4975.         """
4976.         Make sure that non-field readonly elements are properly autoescaped (#24461)
4977.         """
4978.         section = Section.objects.create(name='<a>evil</a>')
4979.         response = self.client.get(reverse('admin:admin_views_section_change', args=(section.pk,)))
4980.         self.assertNotContains(response, "<a>evil</a>", status_code=200)
4981.         self.assertContains(response, "&lt;a&gt;evil&lt;/a&gt;", status_code=200)
4982. 
4983.     def test_label_suffix_translated(self):
4984.         pizza = Pizza.objects.create(name='Americano')
4985.         url = reverse('admin:admin_views_pizza_change', args=(pizza.pk,))
4986.         with self.settings(LANGUAGE_CODE='fr'):
4987.             response = self.client.get(url)
4988.         self.assertContains(response, '<label>Toppings\u00A0:</label>', html=True)
4989. 
4990. 
4991. @override_settings(ROOT_URLCONF='admin_views.urls')
4992. class LimitChoicesToInAdminTest(TestCase):
4993. 
4994.     @classmethod
4995.     def setUpTestData(cls):
4996.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
4997. 
4998.     def setUp(self):
4999.         self.client.force_login(self.superuser)
5000. 
5001.     def test_limit_choices_to_as_callable(self):
5002.         """Test for ticket 2445 changes to admin."""
5003.         threepwood = Character.objects.create(
5004.             username='threepwood',
5005.             last_action=datetime.datetime.today() + datetime.timedelta(days=1),
5006.         )
5007.         marley = Character.objects.create(
5008.             username='marley',
5009.             last_action=datetime.datetime.today() - datetime.timedelta(days=1),
5010.         )
5011.         response = self.client.get(reverse('admin:admin_views_stumpjoke_add'))
5012.         # The allowed option should appear twice; the limited option should not appear.
5013.         self.assertContains(response, threepwood.username, count=2)
5014.         self.assertNotContains(response, marley.username)
5015. 
5016. 
5017. @override_settings(ROOT_URLCONF='admin_views.urls')
5018. class RawIdFieldsTest(TestCase):
5019. 
5020.     @classmethod
5021.     def setUpTestData(cls):
5022.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5023. 
5024.     def setUp(self):
5025.         self.client.force_login(self.superuser)
5026. 
5027.     def test_limit_choices_to(self):
5028.         """Regression test for 14880"""
5029.         actor = Actor.objects.create(name="Palin", age=27)
5030.         Inquisition.objects.create(expected=True,
5031.                                    leader=actor,
5032.                                    country="England")
5033.         Inquisition.objects.create(expected=False,
5034.                                    leader=actor,
5035.                                    country="Spain")
5036.         response = self.client.get(reverse('admin:admin_views_sketch_add'))
5037.         # Find the link
5038.         m = re.search(br'<a href="([^"]*)"[^>]* id="lookup_id_inquisition"', response.content)
5039.         self.assertTrue(m)  # Got a match
5040.         popup_url = m.groups()[0].decode().replace("&amp;", "&")
5041. 
5042.         # Handle relative links
5043.         popup_url = urljoin(response.request['PATH_INFO'], popup_url)
5044.         # Get the popup and verify the correct objects show up in the resulting
5045.         # page. This step also tests integers, strings and booleans in the
5046.         # lookup query string; in model we define inquisition field to have a
5047.         # limit_choices_to option that includes a filter on a string field
5048.         # (inquisition__actor__name), a filter on an integer field
5049.         # (inquisition__actor__age), and a filter on a boolean field
5050.         # (inquisition__expected).
5051.         response2 = self.client.get(popup_url)
5052.         self.assertContains(response2, "Spain")
5053.         self.assertNotContains(response2, "England")
5054. 
5055.     def test_limit_choices_to_isnull_false(self):
5056.         """Regression test for 20182"""
5057.         Actor.objects.create(name="Palin", age=27)
5058.         Actor.objects.create(name="Kilbraken", age=50, title="Judge")
5059.         response = self.client.get(reverse('admin:admin_views_sketch_add'))
5060.         # Find the link
5061.         m = re.search(br'<a href="([^"]*)"[^>]* id="lookup_id_defendant0"', response.content)
5062.         self.assertTrue(m)  # Got a match
5063.         popup_url = m.groups()[0].decode().replace("&amp;", "&")
5064. 
5065.         # Handle relative links
5066.         popup_url = urljoin(response.request['PATH_INFO'], popup_url)
5067.         # Get the popup and verify the correct objects show up in the resulting
5068.         # page. This step tests field__isnull=0 gets parsed correctly from the
5069.         # lookup query string; in model we define defendant0 field to have a
5070.         # limit_choices_to option that includes "actor__title__isnull=False".
5071.         response2 = self.client.get(popup_url)
5072.         self.assertContains(response2, "Kilbraken")
5073.         self.assertNotContains(response2, "Palin")
5074. 
5075.     def test_limit_choices_to_isnull_true(self):
5076.         """Regression test for 20182"""
5077.         Actor.objects.create(name="Palin", age=27)
5078.         Actor.objects.create(name="Kilbraken", age=50, title="Judge")
5079.         response = self.client.get(reverse('admin:admin_views_sketch_add'))
5080.         # Find the link
5081.         m = re.search(br'<a href="([^"]*)"[^>]* id="lookup_id_defendant1"', response.content)
5082.         self.assertTrue(m)  # Got a match
5083.         popup_url = m.groups()[0].decode().replace("&amp;", "&")
5084. 
5085.         # Handle relative links
5086.         popup_url = urljoin(response.request['PATH_INFO'], popup_url)
5087.         # Get the popup and verify the correct objects show up in the resulting
5088.         # page. This step tests field__isnull=1 gets parsed correctly from the
5089.         # lookup query string; in model we define defendant1 field to have a
5090.         # limit_choices_to option that includes "actor__title__isnull=True".
5091.         response2 = self.client.get(popup_url)
5092.         self.assertNotContains(response2, "Kilbraken")
5093.         self.assertContains(response2, "Palin")
5094. 
5095.     def test_list_display_method_same_name_as_reverse_accessor(self):
5096.         """
5097.         Should be able to use a ModelAdmin method in list_display that has the
5098.         same name as a reverse model field ("sketch" in this case).
5099.         """
5100.         actor = Actor.objects.create(name="Palin", age=27)
5101.         Inquisition.objects.create(expected=True, leader=actor, country="England")
5102.         response = self.client.get(reverse('admin:admin_views_inquisition_changelist'))
5103.         self.assertContains(response, 'list-display-sketch')
5104. 
5105. 
5106. @override_settings(ROOT_URLCONF='admin_views.urls')
5107. class UserAdminTest(TestCase):
5108.     """
5109.     Tests user CRUD functionality.
5110.     """
5111. 
5112.     @classmethod
5113.     def setUpTestData(cls):
5114.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5115.         cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
5116.         cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
5117.         cls.s1 = Section.objects.create(name='Test section')
5118.         cls.a1 = Article.objects.create(
5119.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
5120.         )
5121.         cls.a2 = Article.objects.create(
5122.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
5123.         )
5124.         cls.a3 = Article.objects.create(
5125.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
5126.         )
5127.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
5128. 
5129.         cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
5130.         cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
5131.         cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)
5132. 
5133.     def setUp(self):
5134.         self.client.force_login(self.superuser)
5135. 
5136.     def test_save_button(self):
5137.         user_count = User.objects.count()
5138.         response = self.client.post(reverse('admin:auth_user_add'), {
5139.             'username': 'newuser',
5140.             'password1': 'newpassword',
5141.             'password2': 'newpassword',
5142.         })
5143.         new_user = User.objects.get(username='newuser')
5144.         self.assertRedirects(response, reverse('admin:auth_user_change', args=(new_user.pk,)))
5145.         self.assertEqual(User.objects.count(), user_count + 1)
5146.         self.assertTrue(new_user.has_usable_password())
5147. 
5148.     def test_save_continue_editing_button(self):
5149.         user_count = User.objects.count()
5150.         response = self.client.post(reverse('admin:auth_user_add'), {
5151.             'username': 'newuser',
5152.             'password1': 'newpassword',
5153.             'password2': 'newpassword',
5154.             '_continue': '1',
5155.         })
5156.         new_user = User.objects.get(username='newuser')
5157.         new_user_url = reverse('admin:auth_user_change', args=(new_user.pk,))
5158.         self.assertRedirects(response, new_user_url, fetch_redirect_response=False)
5159.         self.assertEqual(User.objects.count(), user_count + 1)
5160.         self.assertTrue(new_user.has_usable_password())
5161.         response = self.client.get(new_user_url)
5162.         self.assertContains(
5163.             response,
5164.             '<li class="success">The user "<a href="%s">'
5165.             '%s</a>" was added successfully. You may edit it again below.</li>'
5166.             % (new_user_url, new_user),
5167.             html=True,
5168.         )
5169. 
5170.     def test_password_mismatch(self):
5171.         response = self.client.post(reverse('admin:auth_user_add'), {
5172.             'username': 'newuser',
5173.             'password1': 'newpassword',
5174.             'password2': 'mismatch',
5175.         })
5176.         self.assertEqual(response.status_code, 200)
5177.         self.assertFormError(response, 'adminform', 'password', [])
5178.         self.assertFormError(response, 'adminform', 'password2', ["The two password fields didn't match."])
5179. 
5180.     def test_user_fk_add_popup(self):
5181.         """User addition through a FK popup should return the appropriate JavaScript response."""
5182.         response = self.client.get(reverse('admin:admin_views_album_add'))
5183.         self.assertContains(response, reverse('admin:auth_user_add'))
5184.         self.assertContains(response, 'class="related-widget-wrapper-link add-related" id="add_id_owner"')
5185.         response = self.client.get(reverse('admin:auth_user_add') + '?_popup=1')
5186.         self.assertNotContains(response, 'name="_continue"')
5187.         self.assertNotContains(response, 'name="_addanother"')
5188.         data = {
5189.             'username': 'newuser',
5190.             'password1': 'newpassword',
5191.             'password2': 'newpassword',
5192.             '_popup': '1',
5193.             '_save': '1',
5194.         }
5195.         response = self.client.post(reverse('admin:auth_user_add') + '?_popup=1', data, follow=True)
5196.         self.assertContains(response, '&quot;obj&quot;: &quot;newuser&quot;')
5197. 
5198.     def test_user_fk_change_popup(self):
5199.         """User change through a FK popup should return the appropriate JavaScript response."""
5200.         response = self.client.get(reverse('admin:admin_views_album_add'))
5201.         self.assertContains(response, reverse('admin:auth_user_change', args=('__fk__',)))
5202.         self.assertContains(response, 'class="related-widget-wrapper-link change-related" id="change_id_owner"')
5203.         user = User.objects.get(username='changeuser')
5204.         url = reverse('admin:auth_user_change', args=(user.pk,)) + '?_popup=1'
5205.         response = self.client.get(url)
5206.         self.assertNotContains(response, 'name="_continue"')
5207.         self.assertNotContains(response, 'name="_addanother"')
5208.         data = {
5209.             'username': 'newuser',
5210.             'password1': 'newpassword',
5211.             'password2': 'newpassword',
5212.             'last_login_0': '2007-05-30',
5213.             'last_login_1': '13:20:10',
5214.             'date_joined_0': '2007-05-30',
5215.             'date_joined_1': '13:20:10',
5216.             '_popup': '1',
5217.             '_save': '1',
5218.         }
5219.         response = self.client.post(url, data, follow=True)
5220.         self.assertContains(response, '&quot;obj&quot;: &quot;newuser&quot;')
5221.         self.assertContains(response, '&quot;action&quot;: &quot;change&quot;')
5222. 
5223.     def test_user_fk_delete_popup(self):
5224.         """User deletion through a FK popup should return the appropriate JavaScript response."""
5225.         response = self.client.get(reverse('admin:admin_views_album_add'))
5226.         self.assertContains(response, reverse('admin:auth_user_delete', args=('__fk__',)))
5227.         self.assertContains(response, 'class="related-widget-wrapper-link change-related" id="change_id_owner"')
5228.         user = User.objects.get(username='changeuser')
5229.         url = reverse('admin:auth_user_delete', args=(user.pk,)) + '?_popup=1'
5230.         response = self.client.get(url)
5231.         self.assertEqual(response.status_code, 200)
5232.         data = {
5233.             'post': 'yes',
5234.             '_popup': '1',
5235.         }
5236.         response = self.client.post(url, data, follow=True)
5237.         self.assertContains(response, '&quot;action&quot;: &quot;delete&quot;')
5238. 
5239.     def test_save_add_another_button(self):
5240.         user_count = User.objects.count()
5241.         response = self.client.post(reverse('admin:auth_user_add'), {
5242.             'username': 'newuser',
5243.             'password1': 'newpassword',
5244.             'password2': 'newpassword',
5245.             '_addanother': '1',
5246.         })
5247.         new_user = User.objects.order_by('-id')[0]
5248.         self.assertRedirects(response, reverse('admin:auth_user_add'))
5249.         self.assertEqual(User.objects.count(), user_count + 1)
5250.         self.assertTrue(new_user.has_usable_password())
5251. 
5252.     def test_user_permission_performance(self):
5253.         u = User.objects.all()[0]
5254. 
5255.         # Don't depend on a warm cache, see #17377.
5256.         ContentType.objects.clear_cache()
5257. 
5258.         with self.assertNumQueries(10):
5259.             response = self.client.get(reverse('admin:auth_user_change', args=(u.pk,)))
5260.             self.assertEqual(response.status_code, 200)
5261. 
5262.     def test_form_url_present_in_context(self):
5263.         u = User.objects.all()[0]
5264.         response = self.client.get(reverse('admin3:auth_user_password_change', args=(u.pk,)))
5265.         self.assertEqual(response.status_code, 200)
5266.         self.assertEqual(response.context['form_url'], 'pony')
5267. 
5268. 
5269. @override_settings(ROOT_URLCONF='admin_views.urls')
5270. class GroupAdminTest(TestCase):
5271.     """
5272.     Tests group CRUD functionality.
5273.     """
5274. 
5275.     @classmethod
5276.     def setUpTestData(cls):
5277.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5278. 
5279.     def setUp(self):
5280.         self.client.force_login(self.superuser)
5281. 
5282.     def test_save_button(self):
5283.         group_count = Group.objects.count()
5284.         response = self.client.post(reverse('admin:auth_group_add'), {
5285.             'name': 'newgroup',
5286.         })
5287. 
5288.         Group.objects.order_by('-id')[0]
5289.         self.assertRedirects(response, reverse('admin:auth_group_changelist'))
5290.         self.assertEqual(Group.objects.count(), group_count + 1)
5291. 
5292.     def test_group_permission_performance(self):
5293.         g = Group.objects.create(name="test_group")
5294. 
5295.         # Ensure no queries are skipped due to cached content type for Group.
5296.         ContentType.objects.clear_cache()
5297. 
5298.         with self.assertNumQueries(8):
5299.             response = self.client.get(reverse('admin:auth_group_change', args=(g.pk,)))
5300.             self.assertEqual(response.status_code, 200)
5301. 
5302. 
5303. @override_settings(ROOT_URLCONF='admin_views.urls')
5304. class CSSTest(TestCase):
5305. 
5306.     @classmethod
5307.     def setUpTestData(cls):
5308.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5309.         cls.s1 = Section.objects.create(name='Test section')
5310.         cls.a1 = Article.objects.create(
5311.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
5312.         )
5313.         cls.a2 = Article.objects.create(
5314.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
5315.         )
5316.         cls.a3 = Article.objects.create(
5317.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
5318.         )
5319.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
5320. 
5321.     def setUp(self):
5322.         self.client.force_login(self.superuser)
5323. 
5324.     def test_field_prefix_css_classes(self):
5325.         """
5326.         Fields have a CSS class name with a 'field-' prefix.
5327.         """
5328.         response = self.client.get(reverse('admin:admin_views_post_add'))
5329. 
5330.         # The main form
5331.         self.assertContains(response, 'class="form-row field-title"')
5332.         self.assertContains(response, 'class="form-row field-content"')
5333.         self.assertContains(response, 'class="form-row field-public"')
5334.         self.assertContains(response, 'class="form-row field-awesomeness_level"')
5335.         self.assertContains(response, 'class="form-row field-coolness"')
5336.         self.assertContains(response, 'class="form-row field-value"')
5337.         self.assertContains(response, 'class="form-row"')  # The lambda function
5338. 
5339.         # The tabular inline
5340.         self.assertContains(response, '<td class="field-url">')
5341.         self.assertContains(response, '<td class="field-posted">')
5342. 
5343.     def test_index_css_classes(self):
5344.         """
5345.         CSS class names are used for each app and model on the admin index
5346.         pages (#17050).
5347.         """
5348.         # General index page
5349.         response = self.client.get(reverse('admin:index'))
5350.         self.assertContains(response, '<div class="app-admin_views module">')
5351.         self.assertContains(response, '<tr class="model-actor">')
5352.         self.assertContains(response, '<tr class="model-album">')
5353. 
5354.         # App index page
5355.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
5356.         self.assertContains(response, '<div class="app-admin_views module">')
5357.         self.assertContains(response, '<tr class="model-actor">')
5358.         self.assertContains(response, '<tr class="model-album">')
5359. 
5360.     def test_app_model_in_form_body_class(self):
5361.         """
5362.         Ensure app and model tag are correctly read by change_form template
5363.         """
5364.         response = self.client.get(reverse('admin:admin_views_section_add'))
5365.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5366. 
5367.     def test_app_model_in_list_body_class(self):
5368.         """
5369.         Ensure app and model tag are correctly read by change_list template
5370.         """
5371.         response = self.client.get(reverse('admin:admin_views_section_changelist'))
5372.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5373. 
5374.     def test_app_model_in_delete_confirmation_body_class(self):
5375.         """
5376.         Ensure app and model tag are correctly read by delete_confirmation
5377.         template
5378.         """
5379.         response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
5380.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5381. 
5382.     def test_app_model_in_app_index_body_class(self):
5383.         """
5384.         Ensure app and model tag are correctly read by app_index template
5385.         """
5386.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
5387.         self.assertContains(response, '<body class=" dashboard app-admin_views')
5388. 
5389.     def test_app_model_in_delete_selected_confirmation_body_class(self):
5390.         """
5391.         Ensure app and model tag are correctly read by
5392.         delete_selected_confirmation template
5393.         """
5394.         action_data = {
5395.             ACTION_CHECKBOX_NAME: [self.s1.pk],
5396.             'action': 'delete_selected',
5397.             'index': 0,
5398.         }
5399.         response = self.client.post(reverse('admin:admin_views_section_changelist'), action_data)
5400.         self.assertContains(response, '<body class=" app-admin_views model-section ')
5401. 
5402.     def test_changelist_field_classes(self):
5403.         """
5404.         Cells of the change list table should contain the field name in their class attribute
5405.         Refs #11195.
5406.         """
5407.         Podcast.objects.create(name="Django Dose", release_date=datetime.date.today())
5408.         response = self.client.get(reverse('admin:admin_views_podcast_changelist'))
5409.         self.assertContains(response, '<th class="field-name">')
5410.         self.assertContains(response, '<td class="field-release_date nowrap">')
5411.         self.assertContains(response, '<td class="action-checkbox">')
5412. 
5413. 
5414. try:
5415.     import docutils
5416. except ImportError:
5417.     docutils = None
5418. 
5419. 
5420. @unittest.skipUnless(docutils, "no docutils installed.")
5421. @override_settings(ROOT_URLCONF='admin_views.urls')
5422. @modify_settings(INSTALLED_APPS={'append': ['django.contrib.admindocs', 'django.contrib.flatpages']})
5423. class AdminDocsTest(TestCase):
5424. 
5425.     @classmethod
5426.     def setUpTestData(cls):
5427.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5428. 
5429.     def setUp(self):
5430.         self.client.force_login(self.superuser)
5431. 
5432.     def test_tags(self):
5433.         response = self.client.get(reverse('django-admindocs-tags'))
5434. 
5435.         # The builtin tag group exists
5436.         self.assertContains(response, "<h2>Built-in tags</h2>", count=2, html=True)
5437. 
5438.         # A builtin tag exists in both the index and detail
5439.         self.assertContains(response, '<h3 id="built_in-autoescape">autoescape</h3>', html=True)
5440.         self.assertContains(response, '<li><a href="#built_in-autoescape">autoescape</a></li>', html=True)
5441. 
5442.         # An app tag exists in both the index and detail
5443.         self.assertContains(response, '<h3 id="flatpages-get_flatpages">get_flatpages</h3>', html=True)
5444.         self.assertContains(response, '<li><a href="#flatpages-get_flatpages">get_flatpages</a></li>', html=True)
5445. 
5446.         # The admin list tag group exists
5447.         self.assertContains(response, "<h2>admin_list</h2>", count=2, html=True)
5448. 
5449.         # An admin list tag exists in both the index and detail
5450.         self.assertContains(response, '<h3 id="admin_list-admin_actions">admin_actions</h3>', html=True)
5451.         self.assertContains(response, '<li><a href="#admin_list-admin_actions">admin_actions</a></li>', html=True)
5452. 
5453.     def test_filters(self):
5454.         response = self.client.get(reverse('django-admindocs-filters'))
5455. 
5456.         # The builtin filter group exists
5457.         self.assertContains(response, "<h2>Built-in filters</h2>", count=2, html=True)
5458. 
5459.         # A builtin filter exists in both the index and detail
5460.         self.assertContains(response, '<h3 id="built_in-add">add</h3>', html=True)
5461.         self.assertContains(response, '<li><a href="#built_in-add">add</a></li>', html=True)
5462. 
5463. 
5464. @override_settings(
5465.     ROOT_URLCONF='admin_views.urls',
5466.     TEMPLATES=[{
5467.         'BACKEND': 'django.template.backends.django.DjangoTemplates',
5468.         'APP_DIRS': True,
5469.         'OPTIONS': {
5470.             'context_processors': [
5471.                 'django.template.context_processors.debug',
5472.                 'django.template.context_processors.request',
5473.                 'django.contrib.auth.context_processors.auth',
5474.                 'django.contrib.messages.context_processors.messages',
5475.             ],
5476.         },
5477.     }],
5478.     USE_I18N=False,
5479. )
5480. class ValidXHTMLTests(TestCase):
5481. 
5482.     @classmethod
5483.     def setUpTestData(cls):
5484.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5485. 
5486.     def setUp(self):
5487.         self.client.force_login(self.superuser)
5488. 
5489.     def test_lang_name_present(self):
5490.         response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
5491.         self.assertNotContains(response, ' lang=""')
5492.         self.assertNotContains(response, ' xml:lang=""')
5493. 
5494. 
5495. @override_settings(ROOT_URLCONF='admin_views.urls', USE_THOUSAND_SEPARATOR=True, USE_L10N=True)
5496. class DateHierarchyTests(TestCase):
5497. 
5498.     @classmethod
5499.     def setUpTestData(cls):
5500.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5501. 
5502.     def setUp(self):
5503.         self.client.force_login(self.superuser)
5504. 
5505.     def assert_non_localized_year(self, response, year):
5506.         """
5507.         The year is not localized with USE_THOUSAND_SEPARATOR (#15234).
5508.         """
5509.         self.assertNotContains(response, formats.number_format(year))
5510. 
5511.     def assert_contains_year_link(self, response, date):
5512.         self.assertContains(response, '?release_date__year=%d"' % (date.year,))
5513. 
5514.     def assert_contains_month_link(self, response, date):
5515.         self.assertContains(
5516.             response, '?release_date__month=%d&amp;release_date__year=%d"' % (
5517.                 date.month, date.year))
5518. 
5519.     def assert_contains_day_link(self, response, date):
5520.         self.assertContains(
5521.             response, '?release_date__day=%d&amp;'
5522.             'release_date__month=%d&amp;release_date__year=%d"' % (
5523.                 date.day, date.month, date.year))
5524. 
5525.     def test_empty(self):
5526.         """
5527.         No date hierarchy links display with empty changelist.
5528.         """
5529.         response = self.client.get(
5530.             reverse('admin:admin_views_podcast_changelist'))
5531.         self.assertNotContains(response, 'release_date__year=')
5532.         self.assertNotContains(response, 'release_date__month=')
5533.         self.assertNotContains(response, 'release_date__day=')
5534. 
5535.     def test_single(self):
5536.         """
5537.         Single day-level date hierarchy appears for single object.
5538.         """
5539.         DATE = datetime.date(2000, 6, 30)
5540.         Podcast.objects.create(release_date=DATE)
5541.         url = reverse('admin:admin_views_podcast_changelist')
5542.         response = self.client.get(url)
5543.         self.assert_contains_day_link(response, DATE)
5544.         self.assert_non_localized_year(response, 2000)
5545. 
5546.     def test_within_month(self):
5547.         """
5548.         day-level links appear for changelist within single month.
5549.         """
5550.         DATES = (datetime.date(2000, 6, 30),
5551.                  datetime.date(2000, 6, 15),
5552.                  datetime.date(2000, 6, 3))
5553.         for date in DATES:
5554.             Podcast.objects.create(release_date=date)
5555.         url = reverse('admin:admin_views_podcast_changelist')
5556.         response = self.client.get(url)
5557.         for date in DATES:
5558.             self.assert_contains_day_link(response, date)
5559.         self.assert_non_localized_year(response, 2000)
5560. 
5561.     def test_within_year(self):
5562.         """
5563.         month-level links appear for changelist within single year.
5564.         """
5565.         DATES = (datetime.date(2000, 1, 30),
5566.                  datetime.date(2000, 3, 15),
5567.                  datetime.date(2000, 5, 3))
5568.         for date in DATES:
5569.             Podcast.objects.create(release_date=date)
5570.         url = reverse('admin:admin_views_podcast_changelist')
5571.         response = self.client.get(url)
5572.         # no day-level links
5573.         self.assertNotContains(response, 'release_date__day=')
5574.         for date in DATES:
5575.             self.assert_contains_month_link(response, date)
5576.         self.assert_non_localized_year(response, 2000)
5577. 
5578.     def test_multiple_years(self):
5579.         """
5580.         year-level links appear for year-spanning changelist.
5581.         """
5582.         DATES = (datetime.date(2001, 1, 30),
5583.                  datetime.date(2003, 3, 15),
5584.                  datetime.date(2005, 5, 3))
5585.         for date in DATES:
5586.             Podcast.objects.create(release_date=date)
5587.         response = self.client.get(
5588.             reverse('admin:admin_views_podcast_changelist'))
5589.         # no day/month-level links
5590.         self.assertNotContains(response, 'release_date__day=')
5591.         self.assertNotContains(response, 'release_date__month=')
5592.         for date in DATES:
5593.             self.assert_contains_year_link(response, date)
5594. 
5595.         # and make sure GET parameters still behave correctly
5596.         for date in DATES:
5597.             url = '%s?release_date__year=%d' % (
5598.                   reverse('admin:admin_views_podcast_changelist'),
5599.                   date.year)
5600.             response = self.client.get(url)
5601.             self.assert_contains_month_link(response, date)
5602.             self.assert_non_localized_year(response, 2000)
5603.             self.assert_non_localized_year(response, 2003)
5604.             self.assert_non_localized_year(response, 2005)
5605. 
5606.             url = '%s?release_date__year=%d&release_date__month=%d' % (
5607.                   reverse('admin:admin_views_podcast_changelist'),
5608.                   date.year, date.month)
5609.             response = self.client.get(url)
5610.             self.assert_contains_day_link(response, date)
5611.             self.assert_non_localized_year(response, 2000)
5612.             self.assert_non_localized_year(response, 2003)
5613.             self.assert_non_localized_year(response, 2005)
5614. 
5615.     def test_related_field(self):
5616.         questions_data = (
5617.             # (posted data, number of answers),
5618.             (datetime.date(2001, 1, 30), 0),
5619.             (datetime.date(2003, 3, 15), 1),
5620.             (datetime.date(2005, 5, 3), 2),
5621.         )
5622.         for date, answer_count in questions_data:
5623.             question = Question.objects.create(posted=date)
5624.             for i in range(answer_count):
5625.                 question.answer_set.create()
5626. 
5627.         response = self.client.get(reverse('admin:admin_views_answer_changelist'))
5628.         for date, answer_count in questions_data:
5629.             link = '?question__posted__year=%d"' % (date.year,)
5630.             if answer_count > 0:
5631.                 self.assertContains(response, link)
5632.             else:
5633.                 self.assertNotContains(response, link)
5634. 
5635. 
5636. @override_settings(ROOT_URLCONF='admin_views.urls')
5637. class AdminCustomSaveRelatedTests(TestCase):
5638.     """
5639.     One can easily customize the way related objects are saved.
5640.     Refs #16115.
5641.     """
5642. 
5643.     @classmethod
5644.     def setUpTestData(cls):
5645.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5646. 
5647.     def setUp(self):
5648.         self.client.force_login(self.superuser)
5649. 
5650.     def test_should_be_able_to_edit_related_objects_on_add_view(self):
5651.         post = {
5652.             'child_set-TOTAL_FORMS': '3',
5653.             'child_set-INITIAL_FORMS': '0',
5654.             'name': 'Josh Stone',
5655.             'child_set-0-name': 'Paul',
5656.             'child_set-1-name': 'Catherine',
5657.         }
5658.         self.client.post(reverse('admin:admin_views_parent_add'), post)
5659.         self.assertEqual(1, Parent.objects.count())
5660.         self.assertEqual(2, Child.objects.count())
5661. 
5662.         children_names = list(Child.objects.order_by('name').values_list('name', flat=True))
5663. 
5664.         self.assertEqual('Josh Stone', Parent.objects.latest('id').name)
5665.         self.assertEqual(['Catherine Stone', 'Paul Stone'], children_names)
5666. 
5667.     def test_should_be_able_to_edit_related_objects_on_change_view(self):
5668.         parent = Parent.objects.create(name='Josh Stone')
5669.         paul = Child.objects.create(parent=parent, name='Paul')
5670.         catherine = Child.objects.create(parent=parent, name='Catherine')
5671.         post = {
5672.             'child_set-TOTAL_FORMS': '5',
5673.             'child_set-INITIAL_FORMS': '2',
5674.             'name': 'Josh Stone',
5675.             'child_set-0-name': 'Paul',
5676.             'child_set-0-id': paul.id,
5677.             'child_set-1-name': 'Catherine',
5678.             'child_set-1-id': catherine.id,
5679.         }
5680.         self.client.post(reverse('admin:admin_views_parent_change', args=(parent.id,)), post)
5681. 
5682.         children_names = list(Child.objects.order_by('name').values_list('name', flat=True))
5683. 
5684.         self.assertEqual('Josh Stone', Parent.objects.latest('id').name)
5685.         self.assertEqual(['Catherine Stone', 'Paul Stone'], children_names)
5686. 
5687.     def test_should_be_able_to_edit_related_objects_on_changelist_view(self):
5688.         parent = Parent.objects.create(name='Josh Rock')
5689.         Child.objects.create(parent=parent, name='Paul')
5690.         Child.objects.create(parent=parent, name='Catherine')
5691.         post = {
5692.             'form-TOTAL_FORMS': '1',
5693.             'form-INITIAL_FORMS': '1',
5694.             'form-MAX_NUM_FORMS': '0',
5695.             'form-0-id': parent.id,
5696.             'form-0-name': 'Josh Stone',
5697.             '_save': 'Save'
5698.         }
5699. 
5700.         self.client.post(reverse('admin:admin_views_parent_changelist'), post)
5701.         children_names = list(Child.objects.order_by('name').values_list('name', flat=True))
5702. 
5703.         self.assertEqual('Josh Stone', Parent.objects.latest('id').name)
5704.         self.assertEqual(['Catherine Stone', 'Paul Stone'], children_names)
5705. 
5706. 
5707. @override_settings(ROOT_URLCONF='admin_views.urls')
5708. class AdminViewLogoutTests(TestCase):
5709. 
5710.     @classmethod
5711.     def setUpTestData(cls):
5712.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5713. 
5714.     def test_logout(self):
5715.         self.client.force_login(self.superuser)
5716.         response = self.client.get(reverse('admin:logout'))
5717.         self.assertEqual(response.status_code, 200)
5718.         self.assertTemplateUsed(response, 'registration/logged_out.html')
5719.         self.assertEqual(response.request['PATH_INFO'], reverse('admin:logout'))
5720.         self.assertFalse(response.context['has_permission'])
5721.         self.assertNotContains(response, 'user-tools')  # user-tools div shouldn't visible.
5722. 
5723.     def test_client_logout_url_can_be_used_to_login(self):
5724.         response = self.client.get(reverse('admin:logout'))
5725.         self.assertEqual(response.status_code, 302)  # we should be redirected to the login page.
5726. 
5727.         # follow the redirect and test results.
5728.         response = self.client.get(reverse('admin:logout'), follow=True)
5729.         self.assertEqual(response.status_code, 200)
5730.         self.assertTemplateUsed(response, 'admin/login.html')
5731.         self.assertEqual(response.request['PATH_INFO'], reverse('admin:login'))
5732.         self.assertContains(response, '<input type="hidden" name="next" value="%s">' % reverse('admin:index'))
5733. 
5734. 
5735. @override_settings(ROOT_URLCONF='admin_views.urls')
5736. class AdminUserMessageTest(TestCase):
5737. 
5738.     @classmethod
5739.     def setUpTestData(cls):
5740.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5741. 
5742.     def setUp(self):
5743.         self.client.force_login(self.superuser)
5744. 
5745.     def send_message(self, level):
5746.         """
5747.         Helper that sends a post to the dummy test methods and asserts that a
5748.         message with the level has appeared in the response.
5749.         """
5750.         action_data = {
5751.             ACTION_CHECKBOX_NAME: [1],
5752.             'action': 'message_%s' % level,
5753.             'index': 0,
5754.         }
5755. 
5756.         response = self.client.post(reverse('admin:admin_views_usermessenger_changelist'),
5757.                                     action_data, follow=True)
5758.         self.assertContains(response,
5759.                             '<li class="%s">Test %s</li>' % (level, level),
5760.                             html=True)
5761. 
5762.     @override_settings(MESSAGE_LEVEL=10)  # Set to DEBUG for this request
5763.     def test_message_debug(self):
5764.         self.send_message('debug')
5765. 
5766.     def test_message_info(self):
5767.         self.send_message('info')
5768. 
5769.     def test_message_success(self):
5770.         self.send_message('success')
5771. 
5772.     def test_message_warning(self):
5773.         self.send_message('warning')
5774. 
5775.     def test_message_error(self):
5776.         self.send_message('error')
5777. 
5778.     def test_message_extra_tags(self):
5779.         action_data = {
5780.             ACTION_CHECKBOX_NAME: [1],
5781.             'action': 'message_extra_tags',
5782.             'index': 0,
5783.         }
5784. 
5785.         response = self.client.post(reverse('admin:admin_views_usermessenger_changelist'),
5786.                                     action_data, follow=True)
5787.         self.assertContains(response,
5788.                             '<li class="extra_tag info">Test tags</li>',
5789.                             html=True)
5790. 
5791. 
5792. @override_settings(ROOT_URLCONF='admin_views.urls')
5793. class AdminKeepChangeListFiltersTests(TestCase):
5794.     admin_site = site
5795. 
5796.     @classmethod
5797.     def setUpTestData(cls):
5798.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5799.         cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
5800. 
5801.     def setUp(self):
5802.         self.client.force_login(self.superuser)
5803. 
5804.     def assertURLEqual(self, url1, url2, msg_prefix=''):
5805.         """
5806.         Assert that two URLs are equal despite the ordering
5807.         of their querystring. Refs #22360.
5808.         """
5809.         parsed_url1 = urlparse(url1)
5810.         path1 = parsed_url1.path
5811.         parsed_qs1 = dict(parse_qsl(parsed_url1.query))
5812. 
5813.         parsed_url2 = urlparse(url2)
5814.         path2 = parsed_url2.path
5815.         parsed_qs2 = dict(parse_qsl(parsed_url2.query))
5816. 
5817.         for parsed_qs in [parsed_qs1, parsed_qs2]:
5818.             if '_changelist_filters' in parsed_qs:
5819.                 changelist_filters = parsed_qs['_changelist_filters']
5820.                 parsed_filters = dict(parse_qsl(changelist_filters))
5821.                 parsed_qs['_changelist_filters'] = parsed_filters
5822. 
5823.         self.assertEqual(path1, path2)
5824.         self.assertEqual(parsed_qs1, parsed_qs2)
5825. 
5826.     def test_assert_url_equal(self):
5827.         # Test equality.
5828.         change_user_url = reverse('admin:auth_user_change', args=(self.joepublicuser.pk,))
5829.         self.assertURLEqual(
5830.             'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5831.                 change_user_url
5832.             ),
5833.             'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5834.                 change_user_url
5835.             )
5836.         )
5837. 
5838.         # Test inequality.
5839.         with self.assertRaises(AssertionError):
5840.             self.assertURLEqual(
5841.                 'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5842.                     change_user_url
5843.                 ),
5844.                 'http://testserver{}?_changelist_filters=is_staff__exact%3D1%26is_superuser__exact%3D1'.format(
5845.                     change_user_url
5846.                 )
5847.             )
5848. 
5849.         # Ignore scheme and host.
5850.         self.assertURLEqual(
5851.             'http://testserver{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(
5852.                 change_user_url
5853.             ),
5854.             '{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(change_user_url)
5855.         )
5856. 
5857.         # Ignore ordering of querystring.
5858.         self.assertURLEqual(
5859.             '{}?is_staff__exact=0&is_superuser__exact=0'.format(reverse('admin:auth_user_changelist')),
5860.             '{}?is_superuser__exact=0&is_staff__exact=0'.format(reverse('admin:auth_user_changelist'))
5861.         )
5862. 
5863.         # Ignore ordering of _changelist_filters.
5864.         self.assertURLEqual(
5865.             '{}?_changelist_filters=is_staff__exact%3D0%26is_superuser__exact%3D0'.format(change_user_url),
5866.             '{}?_changelist_filters=is_superuser__exact%3D0%26is_staff__exact%3D0'.format(change_user_url)
5867.         )
5868. 
5869.     def get_changelist_filters(self):
5870.         return {
5871.             'is_superuser__exact': 0,
5872.             'is_staff__exact': 0,
5873.         }
5874. 
5875.     def get_changelist_filters_querystring(self):
5876.         return urlencode(self.get_changelist_filters())
5877. 
5878.     def get_preserved_filters_querystring(self):
5879.         return urlencode({
5880.             '_changelist_filters': self.get_changelist_filters_querystring()
5881.         })
5882. 
5883.     def get_sample_user_id(self):
5884.         return self.joepublicuser.pk
5885. 
5886.     def get_changelist_url(self):
5887.         return '%s?%s' % (
5888.             reverse('admin:auth_user_changelist',
5889.                     current_app=self.admin_site.name),
5890.             self.get_changelist_filters_querystring(),
5891.         )
5892. 
5893.     def get_add_url(self):
5894.         return '%s?%s' % (
5895.             reverse('admin:auth_user_add',
5896.                     current_app=self.admin_site.name),
5897.             self.get_preserved_filters_querystring(),
5898.         )
5899. 
5900.     def get_change_url(self, user_id=None):
5901.         if user_id is None:
5902.             user_id = self.get_sample_user_id()
5903.         return "%s?%s" % (
5904.             reverse('admin:auth_user_change', args=(user_id,),
5905.                     current_app=self.admin_site.name),
5906.             self.get_preserved_filters_querystring(),
5907.         )
5908. 
5909.     def get_history_url(self, user_id=None):
5910.         if user_id is None:
5911.             user_id = self.get_sample_user_id()
5912.         return "%s?%s" % (
5913.             reverse('admin:auth_user_history', args=(user_id,),
5914.                     current_app=self.admin_site.name),
5915.             self.get_preserved_filters_querystring(),
5916.         )
5917. 
5918.     def get_delete_url(self, user_id=None):
5919.         if user_id is None:
5920.             user_id = self.get_sample_user_id()
5921.         return "%s?%s" % (
5922.             reverse('admin:auth_user_delete', args=(user_id,),
5923.                     current_app=self.admin_site.name),
5924.             self.get_preserved_filters_querystring(),
5925.         )
5926. 
5927.     def test_changelist_view(self):
5928.         response = self.client.get(self.get_changelist_url())
5929.         self.assertEqual(response.status_code, 200)
5930. 
5931.         # Check the `change_view` link has the correct querystring.
5932.         detail_link = re.search(
5933.             '<a href="(.*?)">{}</a>'.format(self.joepublicuser.username),
5934.             response.content.decode()
5935.         )
5936.         self.assertURLEqual(detail_link.group(1), self.get_change_url())
5937. 
5938.     def test_change_view(self):
5939.         # Get the `change_view`.
5940.         response = self.client.get(self.get_change_url())
5941.         self.assertEqual(response.status_code, 200)
5942. 
5943.         # Check the form action.
5944.         form_action = re.search(
5945.             '<form action="(.*?)" method="post" id="user_form".*?>',
5946.             response.content.decode()
5947.         )
5948.         self.assertURLEqual(form_action.group(1), '?%s' % self.get_preserved_filters_querystring())
5949. 
5950.         # Check the history link.
5951.         history_link = re.search(
5952.             '<a href="(.*?)" class="historylink">History</a>',
5953.             response.content.decode()
5954.         )
5955.         self.assertURLEqual(history_link.group(1), self.get_history_url())
5956. 
5957.         # Check the delete link.
5958.         delete_link = re.search(
5959.             '<a href="(.*?)" class="deletelink">Delete</a>',
5960.             response.content.decode()
5961.         )
5962.         self.assertURLEqual(delete_link.group(1), self.get_delete_url())
5963. 
5964.         # Test redirect on "Save".
5965.         post_data = {
5966.             'username': 'joepublic',
5967.             'last_login_0': '2007-05-30',
5968.             'last_login_1': '13:20:10',
5969.             'date_joined_0': '2007-05-30',
5970.             'date_joined_1': '13:20:10',
5971.         }
5972. 
5973.         post_data['_save'] = 1
5974.         response = self.client.post(self.get_change_url(), data=post_data)
5975.         self.assertRedirects(response, self.get_changelist_url())
5976.         post_data.pop('_save')
5977. 
5978.         # Test redirect on "Save and continue".
5979.         post_data['_continue'] = 1
5980.         response = self.client.post(self.get_change_url(), data=post_data)
5981.         self.assertRedirects(response, self.get_change_url())
5982.         post_data.pop('_continue')
5983. 
5984.         # Test redirect on "Save and add new".
5985.         post_data['_addanother'] = 1
5986.         response = self.client.post(self.get_change_url(), data=post_data)
5987.         self.assertRedirects(response, self.get_add_url())
5988.         post_data.pop('_addanother')
5989. 
5990.     def test_add_view(self):
5991.         # Get the `add_view`.
5992.         response = self.client.get(self.get_add_url())
5993.         self.assertEqual(response.status_code, 200)
5994. 
5995.         # Check the form action.
5996.         form_action = re.search(
5997.             '<form action="(.*?)" method="post" id="user_form".*?>',
5998.             response.content.decode()
5999.         )
6000.         self.assertURLEqual(form_action.group(1), '?%s' % self.get_preserved_filters_querystring())
6001. 
6002.         post_data = {
6003.             'username': 'dummy',
6004.             'password1': 'test',
6005.             'password2': 'test',
6006.         }
6007. 
6008.         # Test redirect on "Save".
6009.         post_data['_save'] = 1
6010.         response = self.client.post(self.get_add_url(), data=post_data)
6011.         self.assertRedirects(response, self.get_change_url(User.objects.get(username='dummy').pk))
6012.         post_data.pop('_save')
6013. 
6014.         # Test redirect on "Save and continue".
6015.         post_data['username'] = 'dummy2'
6016.         post_data['_continue'] = 1
6017.         response = self.client.post(self.get_add_url(), data=post_data)
6018.         self.assertRedirects(response, self.get_change_url(User.objects.get(username='dummy2').pk))
6019.         post_data.pop('_continue')
6020. 
6021.         # Test redirect on "Save and add new".
6022.         post_data['username'] = 'dummy3'
6023.         post_data['_addanother'] = 1
6024.         response = self.client.post(self.get_add_url(), data=post_data)
6025.         self.assertRedirects(response, self.get_add_url())
6026.         post_data.pop('_addanother')
6027. 
6028.     def test_delete_view(self):
6029.         # Test redirect on "Delete".
6030.         response = self.client.post(self.get_delete_url(), {'post': 'yes'})
6031.         self.assertRedirects(response, self.get_changelist_url())
6032. 
6033.     def test_url_prefix(self):
6034.         context = {
6035.             'preserved_filters': self.get_preserved_filters_querystring(),
6036.             'opts': User._meta,
6037.         }
6038.         prefixes = ('', '/prefix/', '/後台/')
6039.         for prefix in prefixes:
6040.             with self.subTest(prefix=prefix), override_script_prefix(prefix):
6041.                 url = reverse('admin:auth_user_changelist', current_app=self.admin_site.name)
6042.                 self.assertURLEqual(
6043.                     self.get_changelist_url(),
6044.                     add_preserved_filters(context, url),
6045.                 )
6046. 
6047. 
6048. class NamespacedAdminKeepChangeListFiltersTests(AdminKeepChangeListFiltersTests):
6049.     admin_site = site2
6050. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 18:54:55,058 - thread-128180010612416.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='I have analyzed the provided context from `tests/admin_inlines/tests.py` and `tests/admin_views/tests.py`. The user wants to find 3 relevant test cases for the new `get_inlines` hook. The provided context is sufficient. I have identified three test cases that demonstrate testing similar functionality: `TestInline.test_custom_min_num` which tests a similar hook, `AdminCustomQuerysetTest.test_change_view` which tests the `get_queryset` hook, and `AdminViewPermissionsTest.test_change_view_with_view_only_inlines` which shows how to test inline behavior based on user permissions. These cover the requirements of testing a request- and object-dependent hook on `ModelAdmin`. I can extract these complete test cases from the existing context.' query='' extra_requirements='' purpose=''
2025-12-24 18:54:55,061 - thread-128180010612416.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
