2025-12-23 23:21:32,171 - thread-136502599202496.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: [Bug]: Datetime axis with usetex is unclear

Description: ### Bug summary

The spacing for a datetime axis when using `usetex=True` is unclear in matplotlib version 3.4 when comparing it to 3.3.

### Code for reproduction

```python
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

np.random.seed(1)
matplotlib.rcParams["text.usetex"] = True

dates = pd.date_range("2020-01-01 00:00:00", end="2020-01-01 00:10:00", periods=100)
data = np.random.rand(100)

fig, ax = plt.subplots(constrained_layout=True)
ax.plot(dates, data)
plt.savefig(matplotlib.__version__ + ".png")
```


### Actual outcome

Example of how it look in 3.3.4:
![3 3 4](https://user-images.githubusercontent.com/19758978/139711077-e4fd7727-1e8b-4225-b399-ddad2307f754.png)

Example of how it look in 3.4.3:
![3 4 3](https://user-images.githubusercontent.com/19758978/139711070-2859fd7a-70b2-449e-a3b0-d48e50184077.png)

### Expected outcome

The ideal case would be to have the spacing from version 3.3 in a tex format.

### Operating system

Windows

### Matplotlib Version

3.4.3

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Other libraries

_No response_

### Installation

conda

### Conda channel

conda-forge

Patch information:
diff --git a/lib/matplotlib/dates.py b/lib/matplotlib/dates.py
index 0766156d64..f3fbc6600b 100644
--- a/lib/matplotlib/dates.py
+++ b/lib/matplotlib/dates.py
@@ -596,7 +596,7 @@ def _wrap_in_tex(text):
     ret_text = re.sub(p, r'}$\1$\\mathdefault{', text)
 
     # Braces ensure dashes are not spaced like binary operators.
-    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}')+'}$'
+    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}').replace(':', '\\mathord{:}')+'}$'
     ret_text = ret_text.replace('$\\mathdefault{}$', '')
     return ret_text
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 23:21:32,239 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   └── check_wheel_licenses.py
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   └── 21026-DS.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   └── 21415-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       └── 20990-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.5.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   ├── installing_faq.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   ├── index.rst
|       |   └── installing_source.rst
|       ├── next_whats_new
|       |   ├── README.rst
|       |   ├── extending_MarkerStyle.rst
|       |   └── marker_none.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   └── whats_new_3.5.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── frontpage
|   |   ├── 3D.py
|   |   ├── README.txt
|   |   ├── contour_frontpage.py
|   |   ├── histogram.py
|   |   └── membrane.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── markevery_prop_cycle.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_piecharts.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_symbol.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── cursor_demo.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── load_converter.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── log_test.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── date_index_formatter.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc_sgskip.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_index_formatter2.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   └── ticklabels_rotation.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _enums.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_pickle
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── inset_locator.py
|   |   |   └── parasite_axes.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _contour.cpp
|   ├── _contour_wrapper.cpp
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   ├── qhull_wrap.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── gridspec.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   ├── sample_plots.py
    |   └── usage.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: Datetime axis with usetex is unclear

Description: ### Bug summary

The spacing for a datetime axis when using `usetex=True` is unclear in matplotlib version 3.4 when comparing it to 3.3.

### Code for reproduction

```python
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

np.random.seed(1)
matplotlib.rcParams["text.usetex"] = True

dates = pd.date_range("2020-01-01 00:00:00", end="2020-01-01 00:10:00", periods=100)
data = np.random.rand(100)

fig, ax = plt.subplots(constrained_layout=True)
ax.plot(dates, data)
plt.savefig(matplotlib.__version__ + ".png")
```


### Actual outcome

Example of how it look in 3.3.4:
![3 3 4](https://user-images.githubusercontent.com/19758978/139711077-e4fd7727-1e8b-4225-b399-ddad2307f754.png)

Example of how it look in 3.4.3:
![3 4 3](https://user-images.githubusercontent.com/19758978/139711070-2859fd7a-70b2-449e-a3b0-d48e50184077.png)

### Expected outcome

The ideal case would be to have the spacing from version 3.3 in a tex format.

### Operating system

Windows

### Matplotlib Version

3.4.3

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Other libraries

_No response_

### Installation

conda

### Conda channel

conda-forge

Patch information:
diff --git a/lib/matplotlib/dates.py b/lib/matplotlib/dates.py
index 0766156d64..f3fbc6600b 100644
--- a/lib/matplotlib/dates.py
+++ b/lib/matplotlib/dates.py
@@ -596,7 +596,7 @@ def _wrap_in_tex(text):
     ret_text = re.sub(p, r'}$\1$\\mathdefault{', text)
 
     # Braces ensure dashes are not spaced like binary operators.
-    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}')+'}$'
+    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}').replace(':', '\\mathord{:}')+'}$'
     ret_text = ret_text.replace('$\\mathdefault{}$', '')
     return ret_text
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 23:21:46,037 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user is reporting a bug related to datetime axis formatting with `usetex=True`. The provided patch points to `lib/matplotlib/dates.py`. The most relevant test file is therefore `lib/matplotlib/tests/test_dates.py`. I need the content of this file to find test cases that exercise date formatting with `usetex` enabled, which are likely image comparison tests.' query='Please provide the full content of lib/matplotlib/tests/test_dates.py' extra_requirements='' purpose='I need to find relevant test cases for a bug involving datetime axis formatting with `usetex`.'
2025-12-23 23:21:46,038 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of lib/matplotlib/tests/test_dates.py
2025-12-23 23:21:46,038 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 23:21:46,039 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 23:21:46,039 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 23:21:46,040 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of lib/matplotlib/tests/test_dates.py
Purpose: I need to find relevant test cases for a bug involving datetime axis formatting with `usetex`.
2025-12-23 23:21:49,366 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of the specified test file. This will allow you to examine all the test cases and identify those relevant to datetime axis formatting, which should help in addressing the bug.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_dates.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2132, 'candidates_token_count': 64, 'total_token_count': 2398, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2132}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 202, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.20210297405719757, 'model_name': 'gemini-2.5-pro'} id='run--0e36d3f8-a569-41f0-a61f-11e644df0bcd-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_dates.py'}, 'id': '5b039bbf-1527-49cb-8570-4b962fd87af8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2132, 'output_tokens': 64, 'total_tokens': 2398, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 202}}
2025-12-23 23:21:59,325 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of `lib/matplotlib/tests/test_dates.py` as you requested. I found a test named `test_date_formatter_usetex` that appears to be highly relevant to your query. This test specifically examines the behavior of `AutoDateFormatter` when the `usetex` parameter is enabled, which should provide a good starting point for investigating the bug you're encountering." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 780, 'end_index': 1135, 'uri': 'https://mygit.th-deg.de/ao02473/pythonProjectAB/-/blob/2de06b4396d3be8ebdea6cf8dee2bd0e1bd27738/venv/Lib/site-packages/matplotlib/tests/test_dates.py', 'title': '', 'license_': ''}, {'start_index': 999, 'end_index': 1349, 'uri': 'https://gitlab.pld.ttu.ee/taishi/IAS0360_lab_excercises/blob/4c0b223a557b18b94b8b34308b1acc8a9b268806/home_assignment2/venv/lib/python3.10/site-packages/matplotlib/tests/test_dates.py', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 14023, 'candidates_token_count': 87, 'total_token_count': 14998, 'cached_content_token_count': 1881, 'prompt_tokens_details': [{'modality': 1, 'token_count': 14023}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1881}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 888}, 'finish_reason': 'STOP', 'avg_logprobs': -0.90399178691294, 'model_name': 'gemini-2.5-pro'} id='run--28cc9903-e931-4570-853c-b7f72bb0cfa6-0' usage_metadata={'input_tokens': 14023, 'output_tokens': 87, 'total_tokens': 14998, 'input_token_details': {'cache_read': 1881}, 'output_token_details': {'reasoning': 888}}
2025-12-23 23:21:59,327 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of lib/matplotlib/tests/test_dates.py
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find relevant test cases for a bug involving datetime axis formatting with `usetex`.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_dates.py
Line number range: 1 - 500
Content:
1. import datetime
2. 
3. import dateutil.tz
4. import dateutil.rrule
5. import functools
6. import numpy as np
7. import pytest
8. 
9. from matplotlib import rc_context
10. import matplotlib.dates as mdates
11. import matplotlib.pyplot as plt
12. from matplotlib.testing.decorators import image_comparison
13. import matplotlib.ticker as mticker
14. import matplotlib._api as _api
15. 
16. 
17. def test_date_numpyx():
18.     # test that numpy dates work properly...
19.     base = datetime.datetime(2017, 1, 1)
20.     time = [base + datetime.timedelta(days=x) for x in range(0, 3)]
21.     timenp = np.array(time, dtype='datetime64[ns]')
22.     data = np.array([0., 2., 1.])
23.     fig = plt.figure(figsize=(10, 2))
24.     ax = fig.add_subplot(1, 1, 1)
25.     h, = ax.plot(time, data)
26.     hnp, = ax.plot(timenp, data)
27.     np.testing.assert_equal(h.get_xdata(orig=False), hnp.get_xdata(orig=False))
28.     fig = plt.figure(figsize=(10, 2))
29.     ax = fig.add_subplot(1, 1, 1)
30.     h, = ax.plot(data, time)
31.     hnp, = ax.plot(data, timenp)
32.     np.testing.assert_equal(h.get_ydata(orig=False), hnp.get_ydata(orig=False))
33. 
34. 
35. @pytest.mark.parametrize('t0', [datetime.datetime(2017, 1, 1, 0, 1, 1),
36. 
37.                                 [datetime.datetime(2017, 1, 1, 0, 1, 1),
38.                                  datetime.datetime(2017, 1, 1, 1, 1, 1)],
39. 
40.                                 [[datetime.datetime(2017, 1, 1, 0, 1, 1),
41.                                   datetime.datetime(2017, 1, 1, 1, 1, 1)],
42.                                  [datetime.datetime(2017, 1, 1, 2, 1, 1),
43.                                   datetime.datetime(2017, 1, 1, 3, 1, 1)]]])
44. @pytest.mark.parametrize('dtype', ['datetime64[s]',
45.                                    'datetime64[us]',
46.                                    'datetime64[ms]',
47.                                    'datetime64[ns]'])
48. def test_date_date2num_numpy(t0, dtype):
49.     time = mdates.date2num(t0)
50.     tnp = np.array(t0, dtype=dtype)
51.     nptime = mdates.date2num(tnp)
52.     np.testing.assert_equal(time, nptime)
53. 
54. 
55. @pytest.mark.parametrize('dtype', ['datetime64[s]',
56.                                    'datetime64[us]',
57.                                    'datetime64[ms]',
58.                                    'datetime64[ns]'])
59. def test_date2num_NaT(dtype):
60.     t0 = datetime.datetime(2017, 1, 1, 0, 1, 1)
61.     tmpl = [mdates.date2num(t0), np.nan]
62.     tnp = np.array([t0, 'NaT'], dtype=dtype)
63.     nptime = mdates.date2num(tnp)
64.     np.testing.assert_array_equal(tmpl, nptime)
65. 
66. 
67. @pytest.mark.parametrize('units', ['s', 'ms', 'us', 'ns'])
68. def test_date2num_NaT_scalar(units):
69.     tmpl = mdates.date2num(np.datetime64('NaT', units))
70.     assert np.isnan(tmpl)
71. 
72. 
73. def test_date_empty():
74.     # make sure we do the right thing when told to plot dates even
75.     # if no date data has been presented, cf
76.     # http://sourceforge.net/tracker/?func=detail&aid=2850075&group_id=80706&atid=560720
77.     fig, ax = plt.subplots()
78.     ax.xaxis_date()
79.     fig.draw_without_rendering()
80.     np.testing.assert_allclose(ax.get_xlim(),
81.                                [mdates.date2num(np.datetime64('2000-01-01')),
82.                                 mdates.date2num(np.datetime64('2010-01-01'))])
83. 
84.     mdates._reset_epoch_test_example()
85.     mdates.set_epoch('0000-12-31')
86.     fig, ax = plt.subplots()
87.     ax.xaxis_date()
88.     fig.draw_without_rendering()
89.     np.testing.assert_allclose(ax.get_xlim(),
90.                                [mdates.date2num(np.datetime64('2000-01-01')),
91.                                 mdates.date2num(np.datetime64('2010-01-01'))])
92.     mdates._reset_epoch_test_example()
93. 
94. 
95. def test_date_not_empty():
96.     fig = plt.figure()
97.     ax = fig.add_subplot()
98. 
99.     ax.plot([50, 70], [1, 2])
100.     ax.xaxis.axis_date()
101.     np.testing.assert_allclose(ax.get_xlim(), [50, 70])
102. 
103. 
104. def test_axhline():
105.     # make sure that axhline doesn't set the xlimits...
106.     fig, ax = plt.subplots()
107.     ax.axhline(1.5)
108.     ax.plot([np.datetime64('2016-01-01'), np.datetime64('2016-01-02')], [1, 2])
109.     np.testing.assert_allclose(ax.get_xlim(),
110.                                [mdates.date2num(np.datetime64('2016-01-01')),
111.                                 mdates.date2num(np.datetime64('2016-01-02'))])
112. 
113.     mdates._reset_epoch_test_example()
114.     mdates.set_epoch('0000-12-31')
115.     fig, ax = plt.subplots()
116.     ax.axhline(1.5)
117.     ax.plot([np.datetime64('2016-01-01'), np.datetime64('2016-01-02')], [1, 2])
118.     np.testing.assert_allclose(ax.get_xlim(),
119.                                [mdates.date2num(np.datetime64('2016-01-01')),
120.                                 mdates.date2num(np.datetime64('2016-01-02'))])
121.     mdates._reset_epoch_test_example()
122. 
123. 
124. @image_comparison(['date_axhspan.png'])
125. def test_date_axhspan():
126.     # test axhspan with date inputs
127.     t0 = datetime.datetime(2009, 1, 20)
128.     tf = datetime.datetime(2009, 1, 21)
129.     fig, ax = plt.subplots()
130.     ax.axhspan(t0, tf, facecolor="blue", alpha=0.25)
131.     ax.set_ylim(t0 - datetime.timedelta(days=5),
132.                 tf + datetime.timedelta(days=5))
133.     fig.subplots_adjust(left=0.25)
134. 
135. 
136. @image_comparison(['date_axvspan.png'])
137. def test_date_axvspan():
138.     # test axvspan with date inputs
139.     t0 = datetime.datetime(2000, 1, 20)
140.     tf = datetime.datetime(2010, 1, 21)
141.     fig, ax = plt.subplots()
142.     ax.axvspan(t0, tf, facecolor="blue", alpha=0.25)
143.     ax.set_xlim(t0 - datetime.timedelta(days=720),
144.                 tf + datetime.timedelta(days=720))
145.     fig.autofmt_xdate()
146. 
147. 
148. @image_comparison(['date_axhline.png'])
149. def test_date_axhline():
150.     # test axhline with date inputs
151.     t0 = datetime.datetime(2009, 1, 20)
152.     tf = datetime.datetime(2009, 1, 31)
153.     fig, ax = plt.subplots()
154.     ax.axhline(t0, color="blue", lw=3)
155.     ax.set_ylim(t0 - datetime.timedelta(days=5),
156.                 tf + datetime.timedelta(days=5))
157.     fig.subplots_adjust(left=0.25)
158. 
159. 
160. @image_comparison(['date_axvline.png'])
161. def test_date_axvline():
162.     # test axvline with date inputs
163.     t0 = datetime.datetime(2000, 1, 20)
164.     tf = datetime.datetime(2000, 1, 21)
165.     fig, ax = plt.subplots()
166.     ax.axvline(t0, color="red", lw=3)
167.     ax.set_xlim(t0 - datetime.timedelta(days=5),
168.                 tf + datetime.timedelta(days=5))
169.     fig.autofmt_xdate()
170. 
171. 
172. def test_too_many_date_ticks(caplog):
173.     # Attempt to test SF 2715172, see
174.     # https://sourceforge.net/tracker/?func=detail&aid=2715172&group_id=80706&atid=560720
175.     # setting equal datetimes triggers and expander call in
176.     # transforms.nonsingular which results in too many ticks in the
177.     # DayLocator.  This should emit a log at WARNING level.
178.     caplog.set_level("WARNING")
179.     t0 = datetime.datetime(2000, 1, 20)
180.     tf = datetime.datetime(2000, 1, 20)
181.     fig, ax = plt.subplots()
182.     with pytest.warns(UserWarning) as rec:
183.         ax.set_xlim((t0, tf), auto=True)
184.         assert len(rec) == 1
185.         assert \
186.             'Attempting to set identical left == right' in str(rec[0].message)
187.     ax.plot([], [])
188.     ax.xaxis.set_major_locator(mdates.DayLocator())
189.     v = ax.xaxis.get_major_locator()()
190.     assert len(v) > 1000
191.     # The warning is emitted multiple times because the major locator is also
192.     # called both when placing the minor ticks (for overstriking detection) and
193.     # during tick label positioning.
194.     assert caplog.records and all(
195.         record.name == "matplotlib.ticker" and record.levelname == "WARNING"
196.         for record in caplog.records)
197.     assert len(caplog.records) > 0
198. 
199. 
200. def _new_epoch_decorator(thefunc):
201.     @functools.wraps(thefunc)
202.     def wrapper():
203.         mdates._reset_epoch_test_example()
204.         mdates.set_epoch('2000-01-01')
205.         thefunc()
206.         mdates._reset_epoch_test_example()
207.     return wrapper
208. 
209. 
210. @image_comparison(['RRuleLocator_bounds.png'])
211. def test_RRuleLocator():
212.     import matplotlib.testing.jpl_units as units
213.     units.register()
214.     # This will cause the RRuleLocator to go out of bounds when it tries
215.     # to add padding to the limits, so we make sure it caps at the correct
216.     # boundary values.
217.     t0 = datetime.datetime(1000, 1, 1)
218.     tf = datetime.datetime(6000, 1, 1)
219. 
220.     fig = plt.figure()
221.     ax = plt.subplot()
222.     ax.set_autoscale_on(True)
223.     ax.plot([t0, tf], [0.0, 1.0], marker='o')
224. 
225.     rrule = mdates.rrulewrapper(dateutil.rrule.YEARLY, interval=500)
226.     locator = mdates.RRuleLocator(rrule)
227.     ax.xaxis.set_major_locator(locator)
228.     ax.xaxis.set_major_formatter(mdates.AutoDateFormatter(locator))
229. 
230.     ax.autoscale_view()
231.     fig.autofmt_xdate()
232. 
233. 
234. def test_RRuleLocator_dayrange():
235.     loc = mdates.DayLocator()
236.     x1 = datetime.datetime(year=1, month=1, day=1, tzinfo=mdates.UTC)
237.     y1 = datetime.datetime(year=1, month=1, day=16, tzinfo=mdates.UTC)
238.     loc.tick_values(x1, y1)
239.     # On success, no overflow error shall be thrown
240. 
241. 
242. def test_RRuleLocator_close_minmax():
243.     # if d1 and d2 are very close together, rrule cannot create
244.     # reasonable tick intervals; ensure that this is handled properly
245.     rrule = mdates.rrulewrapper(dateutil.rrule.SECONDLY, interval=5)
246.     loc = mdates.RRuleLocator(rrule)
247.     d1 = datetime.datetime(year=2020, month=1, day=1)
248.     d2 = datetime.datetime(year=2020, month=1, day=1, microsecond=1)
249.     expected = ['2020-01-01 00:00:00+00:00',
250.                 '2020-01-01 00:00:00.000001+00:00']
251.     assert list(map(str, mdates.num2date(loc.tick_values(d1, d2)))) == expected
252. 
253. 
254. @image_comparison(['DateFormatter_fractionalSeconds.png'])
255. def test_DateFormatter():
256.     import matplotlib.testing.jpl_units as units
257.     units.register()
258. 
259.     # Lets make sure that DateFormatter will allow us to have tick marks
260.     # at intervals of fractional seconds.
261. 
262.     t0 = datetime.datetime(2001, 1, 1, 0, 0, 0)
263.     tf = datetime.datetime(2001, 1, 1, 0, 0, 1)
264. 
265.     fig = plt.figure()
266.     ax = plt.subplot()
267.     ax.set_autoscale_on(True)
268.     ax.plot([t0, tf], [0.0, 1.0], marker='o')
269. 
270.     # rrule = mpldates.rrulewrapper( dateutil.rrule.YEARLY, interval=500 )
271.     # locator = mpldates.RRuleLocator( rrule )
272.     # ax.xaxis.set_major_locator( locator )
273.     # ax.xaxis.set_major_formatter( mpldates.AutoDateFormatter(locator) )
274. 
275.     ax.autoscale_view()
276.     fig.autofmt_xdate()
277. 
278. 
279. def test_locator_set_formatter():
280.     """
281.     Test if setting the locator only will update the AutoDateFormatter to use
282.     the new locator.
283.     """
284.     plt.rcParams["date.autoformatter.minute"] = "%d %H:%M"
285.     t = [datetime.datetime(2018, 9, 30, 8, 0),
286.          datetime.datetime(2018, 9, 30, 8, 59),
287.          datetime.datetime(2018, 9, 30, 10, 30)]
288.     x = [2, 3, 1]
289. 
290.     fig, ax = plt.subplots()
291.     ax.plot(t, x)
292.     ax.xaxis.set_major_locator(mdates.MinuteLocator((0, 30)))
293.     fig.canvas.draw()
294.     ticklabels = [tl.get_text() for tl in ax.get_xticklabels()]
295.     expected = ['30 08:00', '30 08:30', '30 09:00',
296.                 '30 09:30', '30 10:00', '30 10:30']
297.     assert ticklabels == expected
298. 
299.     ax.xaxis.set_major_locator(mticker.NullLocator())
300.     ax.xaxis.set_minor_locator(mdates.MinuteLocator((5, 55)))
301.     decoy_loc = mdates.MinuteLocator((12, 27))
302.     ax.xaxis.set_minor_formatter(mdates.AutoDateFormatter(decoy_loc))
303. 
304.     ax.xaxis.set_minor_locator(mdates.MinuteLocator((15, 45)))
305.     fig.canvas.draw()
306.     ticklabels = [tl.get_text() for tl in ax.get_xticklabels(which="minor")]
307.     expected = ['30 08:15', '30 08:45', '30 09:15', '30 09:45', '30 10:15']
308.     assert ticklabels == expected
309. 
310. 
311. def test_date_formatter_callable():
312. 
313.     class _Locator:
314.         def _get_unit(self): return -11
315. 
316.     def callable_formatting_function(dates, _):
317.         return [dt.strftime('%d-%m//%Y') for dt in dates]
318. 
319.     formatter = mdates.AutoDateFormatter(_Locator())
320.     formatter.scaled[-10] = callable_formatting_function
321.     assert formatter([datetime.datetime(2014, 12, 25)]) == ['25-12//2014']
322. 
323. 
324. @pytest.mark.parametrize('delta, expected', [
325.     (datetime.timedelta(weeks=52 * 200),
326.      [r'$\mathdefault{%d}$' % (year,) for year in range(1990, 2171, 20)]),
327.     (datetime.timedelta(days=30),
328.      [r'Jan$\mathdefault{ %02d 1990}$' % (day,) for day in range(1, 32, 3)]),
329.     (datetime.timedelta(hours=20),
330.      [r'$\mathdefault{%02d:00:00}$' % (hour,) for hour in range(0, 21, 2)]),
331. ])
332. def test_date_formatter_usetex(delta, expected):
333.     d1 = datetime.datetime(1990, 1, 1)
334.     d2 = d1 + delta
335. 
336.     locator = mdates.AutoDateLocator(interval_multiples=False)
337.     locator.create_dummy_axis()
338.     locator.axis.set_view_interval(mdates.date2num(d1), mdates.date2num(d2))
339. 
340.     formatter = mdates.AutoDateFormatter(locator, usetex=True)
341.     assert [formatter(loc) for loc in locator()] == expected
342. 
343. 
344. def test_drange():
345.     """
346.     This test should check if drange works as expected, and if all the
347.     rounding errors are fixed
348.     """
349.     start = datetime.datetime(2011, 1, 1, tzinfo=mdates.UTC)
350.     end = datetime.datetime(2011, 1, 2, tzinfo=mdates.UTC)
351.     delta = datetime.timedelta(hours=1)
352.     # We expect 24 values in drange(start, end, delta), because drange returns
353.     # dates from an half open interval [start, end)
354.     assert len(mdates.drange(start, end, delta)) == 24
355. 
356.     # if end is a little bit later, we expect the range to contain one element
357.     # more
358.     end = end + datetime.timedelta(microseconds=1)
359.     assert len(mdates.drange(start, end, delta)) == 25
360. 
361.     # reset end
362.     end = datetime.datetime(2011, 1, 2, tzinfo=mdates.UTC)
363. 
364.     # and tst drange with "complicated" floats:
365.     # 4 hours = 1/6 day, this is an "dangerous" float
366.     delta = datetime.timedelta(hours=4)
367.     daterange = mdates.drange(start, end, delta)
368.     assert len(daterange) == 6
369.     assert mdates.num2date(daterange[-1]) == (end - delta)
370. 
371. 
372. @_new_epoch_decorator
373. def test_auto_date_locator():
374.     def _create_auto_date_locator(date1, date2):
375.         locator = mdates.AutoDateLocator(interval_multiples=False)
376.         locator.create_dummy_axis()
377.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
378.         return locator
379. 
380.     d1 = datetime.datetime(1990, 1, 1)
381.     results = ([datetime.timedelta(weeks=52 * 200),
382.                 ['1990-01-01 00:00:00+00:00', '2010-01-01 00:00:00+00:00',
383.                  '2030-01-01 00:00:00+00:00', '2050-01-01 00:00:00+00:00',
384.                  '2070-01-01 00:00:00+00:00', '2090-01-01 00:00:00+00:00',
385.                  '2110-01-01 00:00:00+00:00', '2130-01-01 00:00:00+00:00',
386.                  '2150-01-01 00:00:00+00:00', '2170-01-01 00:00:00+00:00']
387.                 ],
388.                [datetime.timedelta(weeks=52),
389.                 ['1990-01-01 00:00:00+00:00', '1990-02-01 00:00:00+00:00',
390.                  '1990-03-01 00:00:00+00:00', '1990-04-01 00:00:00+00:00',
391.                  '1990-05-01 00:00:00+00:00', '1990-06-01 00:00:00+00:00',
392.                  '1990-07-01 00:00:00+00:00', '1990-08-01 00:00:00+00:00',
393.                  '1990-09-01 00:00:00+00:00', '1990-10-01 00:00:00+00:00',
394.                  '1990-11-01 00:00:00+00:00', '1990-12-01 00:00:00+00:00']
395.                 ],
396.                [datetime.timedelta(days=141),
397.                 ['1990-01-05 00:00:00+00:00', '1990-01-26 00:00:00+00:00',
398.                  '1990-02-16 00:00:00+00:00', '1990-03-09 00:00:00+00:00',
399.                  '1990-03-30 00:00:00+00:00', '1990-04-20 00:00:00+00:00',
400.                  '1990-05-11 00:00:00+00:00']
401.                 ],
402.                [datetime.timedelta(days=40),
403.                 ['1990-01-03 00:00:00+00:00', '1990-01-10 00:00:00+00:00',
404.                  '1990-01-17 00:00:00+00:00', '1990-01-24 00:00:00+00:00',
405.                  '1990-01-31 00:00:00+00:00', '1990-02-07 00:00:00+00:00']
406.                 ],
407.                [datetime.timedelta(hours=40),
408.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 04:00:00+00:00',
409.                  '1990-01-01 08:00:00+00:00', '1990-01-01 12:00:00+00:00',
410.                  '1990-01-01 16:00:00+00:00', '1990-01-01 20:00:00+00:00',
411.                  '1990-01-02 00:00:00+00:00', '1990-01-02 04:00:00+00:00',
412.                  '1990-01-02 08:00:00+00:00', '1990-01-02 12:00:00+00:00',
413.                  '1990-01-02 16:00:00+00:00']
414.                 ],
415.                [datetime.timedelta(minutes=20),
416.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 00:05:00+00:00',
417.                  '1990-01-01 00:10:00+00:00', '1990-01-01 00:15:00+00:00',
418.                  '1990-01-01 00:20:00+00:00']
419.                 ],
420.                [datetime.timedelta(seconds=40),
421.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 00:00:05+00:00',
422.                  '1990-01-01 00:00:10+00:00', '1990-01-01 00:00:15+00:00',
423.                  '1990-01-01 00:00:20+00:00', '1990-01-01 00:00:25+00:00',
424.                  '1990-01-01 00:00:30+00:00', '1990-01-01 00:00:35+00:00',
425.                  '1990-01-01 00:00:40+00:00']
426.                 ],
427.                [datetime.timedelta(microseconds=1500),
428.                 ['1989-12-31 23:59:59.999500+00:00',
429.                  '1990-01-01 00:00:00+00:00',
430.                  '1990-01-01 00:00:00.000500+00:00',
431.                  '1990-01-01 00:00:00.001000+00:00',
432.                  '1990-01-01 00:00:00.001500+00:00',
433.                  '1990-01-01 00:00:00.002000+00:00']
434.                 ],
435.                )
436. 
437.     for t_delta, expected in results:
438.         d2 = d1 + t_delta
439.         locator = _create_auto_date_locator(d1, d2)
440.         assert list(map(str, mdates.num2date(locator()))) == expected
441. 
442. 
443. @_new_epoch_decorator
444. def test_auto_date_locator_intmult():
445.     def _create_auto_date_locator(date1, date2):
446.         locator = mdates.AutoDateLocator(interval_multiples=True)
447.         locator.create_dummy_axis()
448.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
449.         return locator
450. 
451.     results = ([datetime.timedelta(weeks=52 * 200),
452.                 ['1980-01-01 00:00:00+00:00', '2000-01-01 00:00:00+00:00',
453.                  '2020-01-01 00:00:00+00:00', '2040-01-01 00:00:00+00:00',
454.                  '2060-01-01 00:00:00+00:00', '2080-01-01 00:00:00+00:00',
455.                  '2100-01-01 00:00:00+00:00', '2120-01-01 00:00:00+00:00',
456.                  '2140-01-01 00:00:00+00:00', '2160-01-01 00:00:00+00:00',
457.                  '2180-01-01 00:00:00+00:00', '2200-01-01 00:00:00+00:00']
458.                 ],
459.                [datetime.timedelta(weeks=52),
460.                 ['1997-01-01 00:00:00+00:00', '1997-02-01 00:00:00+00:00',
461.                  '1997-03-01 00:00:00+00:00', '1997-04-01 00:00:00+00:00',
462.                  '1997-05-01 00:00:00+00:00', '1997-06-01 00:00:00+00:00',
463.                  '1997-07-01 00:00:00+00:00', '1997-08-01 00:00:00+00:00',
464.                  '1997-09-01 00:00:00+00:00', '1997-10-01 00:00:00+00:00',
465.                  '1997-11-01 00:00:00+00:00', '1997-12-01 00:00:00+00:00']
466.                 ],
467.                [datetime.timedelta(days=141),
468.                 ['1997-01-01 00:00:00+00:00', '1997-01-15 00:00:00+00:00',
469.                  '1997-02-01 00:00:00+00:00', '1997-02-15 00:00:00+00:00',
470.                  '1997-03-01 00:00:00+00:00', '1997-03-15 00:00:00+00:00',
471.                  '1997-04-01 00:00:00+00:00', '1997-04-15 00:00:00+00:00',
472.                  '1997-05-01 00:00:00+00:00', '1997-05-15 00:00:00+00:00']
473.                 ],
474.                [datetime.timedelta(days=40),
475.                 ['1997-01-01 00:00:00+00:00', '1997-01-05 00:00:00+00:00',
476.                  '1997-01-09 00:00:00+00:00', '1997-01-13 00:00:00+00:00',
477.                  '1997-01-17 00:00:00+00:00', '1997-01-21 00:00:00+00:00',
478.                  '1997-01-25 00:00:00+00:00', '1997-01-29 00:00:00+00:00',
479.                  '1997-02-01 00:00:00+00:00', '1997-02-05 00:00:00+00:00',
480.                  '1997-02-09 00:00:00+00:00']
481.                 ],
482.                [datetime.timedelta(hours=40),
483.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 04:00:00+00:00',
484.                  '1997-01-01 08:00:00+00:00', '1997-01-01 12:00:00+00:00',
485.                  '1997-01-01 16:00:00+00:00', '1997-01-01 20:00:00+00:00',
486.                  '1997-01-02 00:00:00+00:00', '1997-01-02 04:00:00+00:00',
487.                  '1997-01-02 08:00:00+00:00', '1997-01-02 12:00:00+00:00',
488.                  '1997-01-02 16:00:00+00:00']
489.                 ],
490.                [datetime.timedelta(minutes=20),
491.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 00:05:00+00:00',
492.                  '1997-01-01 00:10:00+00:00', '1997-01-01 00:15:00+00:00',
493.                  '1997-01-01 00:20:00+00:00']
494.                 ],
495.                [datetime.timedelta(seconds=40),
496.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 00:00:05+00:00',
497.                  '1997-01-01 00:00:10+00:00', '1997-01-01 00:00:15+00:00',
498.                  '1997-01-01 00:00:20+00:00', '1997-01-01 00:00:25+00:00',
499.                  '1997-01-01 00:00:30+00:00', '1997-01-01 00:00:35+00:00',
500.                  '1997-01-01 00:00:40+00:00']

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 23:23:04,202 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's query is 'Please provide the full content of lib/matplotlib/tests/test_dates.py'.\n   - This requires returning the entire content of the specified file.\n2. Extended relevance:\n   - The context provided contains lines 1-500 of the requested file. To fulfill the user's request, the entire available content of the file is selected as the context.", relative_path='lib/matplotlib/tests/test_dates.py', start_line=1, end_line=500)]
2025-12-23 23:23:04,203 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of lib/matplotlib/tests/test_dates.py
2025-12-23 23:23:04,203 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 23:23:04,203 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 23:23:04,204 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 23:23:04,204 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 23:23:04,205 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   └── check_wheel_licenses.py
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   └── 21026-DS.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   └── 21415-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       └── 20990-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.5.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   ├── installing_faq.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   ├── index.rst
|       |   └── installing_source.rst
|       ├── next_whats_new
|       |   ├── README.rst
|       |   ├── extending_MarkerStyle.rst
|       |   └── marker_none.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   └── whats_new_3.5.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── frontpage
|   |   ├── 3D.py
|   |   ├── README.txt
|   |   ├── contour_frontpage.py
|   |   ├── histogram.py
|   |   └── membrane.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── markevery_prop_cycle.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_piecharts.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_symbol.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── cursor_demo.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── load_converter.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── log_test.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── date_index_formatter.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc_sgskip.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_index_formatter2.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   └── ticklabels_rotation.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _enums.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_pickle
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── inset_locator.py
|   |   |   └── parasite_axes.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _contour.cpp
|   ├── _contour_wrapper.cpp
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   ├── qhull_wrap.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── gridspec.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   ├── sample_plots.py
    |   └── usage.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: Datetime axis with usetex is unclear

Description: ### Bug summary

The spacing for a datetime axis when using `usetex=True` is unclear in matplotlib version 3.4 when comparing it to 3.3.

### Code for reproduction

```python
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

np.random.seed(1)
matplotlib.rcParams["text.usetex"] = True

dates = pd.date_range("2020-01-01 00:00:00", end="2020-01-01 00:10:00", periods=100)
data = np.random.rand(100)

fig, ax = plt.subplots(constrained_layout=True)
ax.plot(dates, data)
plt.savefig(matplotlib.__version__ + ".png")
```


### Actual outcome

Example of how it look in 3.3.4:
![3 3 4](https://user-images.githubusercontent.com/19758978/139711077-e4fd7727-1e8b-4225-b399-ddad2307f754.png)

Example of how it look in 3.4.3:
![3 4 3](https://user-images.githubusercontent.com/19758978/139711070-2859fd7a-70b2-449e-a3b0-d48e50184077.png)

### Expected outcome

The ideal case would be to have the spacing from version 3.3 in a tex format.

### Operating system

Windows

### Matplotlib Version

3.4.3

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Other libraries

_No response_

### Installation

conda

### Conda channel

conda-forge

Patch information:
diff --git a/lib/matplotlib/dates.py b/lib/matplotlib/dates.py
index 0766156d64..f3fbc6600b 100644
--- a/lib/matplotlib/dates.py
+++ b/lib/matplotlib/dates.py
@@ -596,7 +596,7 @@ def _wrap_in_tex(text):
     ret_text = re.sub(p, r'}$\1$\\mathdefault{', text)
 
     # Braces ensure dashes are not spaced like binary operators.
-    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}')+'}$'
+    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}').replace(':', '\\mathord{:}')+'}$'
     ret_text = ret_text.replace('$\\mathdefault{}$', '')
     return ret_text
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of lib/matplotlib/tests/test_dates.py
Extra Requirements: 
Purpose: I need to find relevant test cases for a bug involving datetime axis formatting with `usetex`.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_dates.py
Line number range: 1 - 500
Content:
1. import datetime
2. 
3. import dateutil.tz
4. import dateutil.rrule
5. import functools
6. import numpy as np
7. import pytest
8. 
9. from matplotlib import rc_context
10. import matplotlib.dates as mdates
11. import matplotlib.pyplot as plt
12. from matplotlib.testing.decorators import image_comparison
13. import matplotlib.ticker as mticker
14. import matplotlib._api as _api
15. 
16. 
17. def test_date_numpyx():
18.     # test that numpy dates work properly...
19.     base = datetime.datetime(2017, 1, 1)
20.     time = [base + datetime.timedelta(days=x) for x in range(0, 3)]
21.     timenp = np.array(time, dtype='datetime64[ns]')
22.     data = np.array([0., 2., 1.])
23.     fig = plt.figure(figsize=(10, 2))
24.     ax = fig.add_subplot(1, 1, 1)
25.     h, = ax.plot(time, data)
26.     hnp, = ax.plot(timenp, data)
27.     np.testing.assert_equal(h.get_xdata(orig=False), hnp.get_xdata(orig=False))
28.     fig = plt.figure(figsize=(10, 2))
29.     ax = fig.add_subplot(1, 1, 1)
30.     h, = ax.plot(data, time)
31.     hnp, = ax.plot(data, timenp)
32.     np.testing.assert_equal(h.get_ydata(orig=False), hnp.get_ydata(orig=False))
33. 
34. 
35. @pytest.mark.parametrize('t0', [datetime.datetime(2017, 1, 1, 0, 1, 1),
36. 
37.                                 [datetime.datetime(2017, 1, 1, 0, 1, 1),
38.                                  datetime.datetime(2017, 1, 1, 1, 1, 1)],
39. 
40.                                 [[datetime.datetime(2017, 1, 1, 0, 1, 1),
41.                                   datetime.datetime(2017, 1, 1, 1, 1, 1)],
42.                                  [datetime.datetime(2017, 1, 1, 2, 1, 1),
43.                                   datetime.datetime(2017, 1, 1, 3, 1, 1)]]])
44. @pytest.mark.parametrize('dtype', ['datetime64[s]',
45.                                    'datetime64[us]',
46.                                    'datetime64[ms]',
47.                                    'datetime64[ns]'])
48. def test_date_date2num_numpy(t0, dtype):
49.     time = mdates.date2num(t0)
50.     tnp = np.array(t0, dtype=dtype)
51.     nptime = mdates.date2num(tnp)
52.     np.testing.assert_equal(time, nptime)
53. 
54. 
55. @pytest.mark.parametrize('dtype', ['datetime64[s]',
56.                                    'datetime64[us]',
57.                                    'datetime64[ms]',
58.                                    'datetime64[ns]'])
59. def test_date2num_NaT(dtype):
60.     t0 = datetime.datetime(2017, 1, 1, 0, 1, 1)
61.     tmpl = [mdates.date2num(t0), np.nan]
62.     tnp = np.array([t0, 'NaT'], dtype=dtype)
63.     nptime = mdates.date2num(tnp)
64.     np.testing.assert_array_equal(tmpl, nptime)
65. 
66. 
67. @pytest.mark.parametrize('units', ['s', 'ms', 'us', 'ns'])
68. def test_date2num_NaT_scalar(units):
69.     tmpl = mdates.date2num(np.datetime64('NaT', units))
70.     assert np.isnan(tmpl)
71. 
72. 
73. def test_date_empty():
74.     # make sure we do the right thing when told to plot dates even
75.     # if no date data has been presented, cf
76.     # http://sourceforge.net/tracker/?func=detail&aid=2850075&group_id=80706&atid=560720
77.     fig, ax = plt.subplots()
78.     ax.xaxis_date()
79.     fig.draw_without_rendering()
80.     np.testing.assert_allclose(ax.get_xlim(),
81.                                [mdates.date2num(np.datetime64('2000-01-01')),
82.                                 mdates.date2num(np.datetime64('2010-01-01'))])
83. 
84.     mdates._reset_epoch_test_example()
85.     mdates.set_epoch('0000-12-31')
86.     fig, ax = plt.subplots()
87.     ax.xaxis_date()
88.     fig.draw_without_rendering()
89.     np.testing.assert_allclose(ax.get_xlim(),
90.                                [mdates.date2num(np.datetime64('2000-01-01')),
91.                                 mdates.date2num(np.datetime64('2010-01-01'))])
92.     mdates._reset_epoch_test_example()
93. 
94. 
95. def test_date_not_empty():
96.     fig = plt.figure()
97.     ax = fig.add_subplot()
98. 
99.     ax.plot([50, 70], [1, 2])
100.     ax.xaxis.axis_date()
101.     np.testing.assert_allclose(ax.get_xlim(), [50, 70])
102. 
103. 
104. def test_axhline():
105.     # make sure that axhline doesn't set the xlimits...
106.     fig, ax = plt.subplots()
107.     ax.axhline(1.5)
108.     ax.plot([np.datetime64('2016-01-01'), np.datetime64('2016-01-02')], [1, 2])
109.     np.testing.assert_allclose(ax.get_xlim(),
110.                                [mdates.date2num(np.datetime64('2016-01-01')),
111.                                 mdates.date2num(np.datetime64('2016-01-02'))])
112. 
113.     mdates._reset_epoch_test_example()
114.     mdates.set_epoch('0000-12-31')
115.     fig, ax = plt.subplots()
116.     ax.axhline(1.5)
117.     ax.plot([np.datetime64('2016-01-01'), np.datetime64('2016-01-02')], [1, 2])
118.     np.testing.assert_allclose(ax.get_xlim(),
119.                                [mdates.date2num(np.datetime64('2016-01-01')),
120.                                 mdates.date2num(np.datetime64('2016-01-02'))])
121.     mdates._reset_epoch_test_example()
122. 
123. 
124. @image_comparison(['date_axhspan.png'])
125. def test_date_axhspan():
126.     # test axhspan with date inputs
127.     t0 = datetime.datetime(2009, 1, 20)
128.     tf = datetime.datetime(2009, 1, 21)
129.     fig, ax = plt.subplots()
130.     ax.axhspan(t0, tf, facecolor="blue", alpha=0.25)
131.     ax.set_ylim(t0 - datetime.timedelta(days=5),
132.                 tf + datetime.timedelta(days=5))
133.     fig.subplots_adjust(left=0.25)
134. 
135. 
136. @image_comparison(['date_axvspan.png'])
137. def test_date_axvspan():
138.     # test axvspan with date inputs
139.     t0 = datetime.datetime(2000, 1, 20)
140.     tf = datetime.datetime(2010, 1, 21)
141.     fig, ax = plt.subplots()
142.     ax.axvspan(t0, tf, facecolor="blue", alpha=0.25)
143.     ax.set_xlim(t0 - datetime.timedelta(days=720),
144.                 tf + datetime.timedelta(days=720))
145.     fig.autofmt_xdate()
146. 
147. 
148. @image_comparison(['date_axhline.png'])
149. def test_date_axhline():
150.     # test axhline with date inputs
151.     t0 = datetime.datetime(2009, 1, 20)
152.     tf = datetime.datetime(2009, 1, 31)
153.     fig, ax = plt.subplots()
154.     ax.axhline(t0, color="blue", lw=3)
155.     ax.set_ylim(t0 - datetime.timedelta(days=5),
156.                 tf + datetime.timedelta(days=5))
157.     fig.subplots_adjust(left=0.25)
158. 
159. 
160. @image_comparison(['date_axvline.png'])
161. def test_date_axvline():
162.     # test axvline with date inputs
163.     t0 = datetime.datetime(2000, 1, 20)
164.     tf = datetime.datetime(2000, 1, 21)
165.     fig, ax = plt.subplots()
166.     ax.axvline(t0, color="red", lw=3)
167.     ax.set_xlim(t0 - datetime.timedelta(days=5),
168.                 tf + datetime.timedelta(days=5))
169.     fig.autofmt_xdate()
170. 
171. 
172. def test_too_many_date_ticks(caplog):
173.     # Attempt to test SF 2715172, see
174.     # https://sourceforge.net/tracker/?func=detail&aid=2715172&group_id=80706&atid=560720
175.     # setting equal datetimes triggers and expander call in
176.     # transforms.nonsingular which results in too many ticks in the
177.     # DayLocator.  This should emit a log at WARNING level.
178.     caplog.set_level("WARNING")
179.     t0 = datetime.datetime(2000, 1, 20)
180.     tf = datetime.datetime(2000, 1, 20)
181.     fig, ax = plt.subplots()
182.     with pytest.warns(UserWarning) as rec:
183.         ax.set_xlim((t0, tf), auto=True)
184.         assert len(rec) == 1
185.         assert \
186.             'Attempting to set identical left == right' in str(rec[0].message)
187.     ax.plot([], [])
188.     ax.xaxis.set_major_locator(mdates.DayLocator())
189.     v = ax.xaxis.get_major_locator()()
190.     assert len(v) > 1000
191.     # The warning is emitted multiple times because the major locator is also
192.     # called both when placing the minor ticks (for overstriking detection) and
193.     # during tick label positioning.
194.     assert caplog.records and all(
195.         record.name == "matplotlib.ticker" and record.levelname == "WARNING"
196.         for record in caplog.records)
197.     assert len(caplog.records) > 0
198. 
199. 
200. def _new_epoch_decorator(thefunc):
201.     @functools.wraps(thefunc)
202.     def wrapper():
203.         mdates._reset_epoch_test_example()
204.         mdates.set_epoch('2000-01-01')
205.         thefunc()
206.         mdates._reset_epoch_test_example()
207.     return wrapper
208. 
209. 
210. @image_comparison(['RRuleLocator_bounds.png'])
211. def test_RRuleLocator():
212.     import matplotlib.testing.jpl_units as units
213.     units.register()
214.     # This will cause the RRuleLocator to go out of bounds when it tries
215.     # to add padding to the limits, so we make sure it caps at the correct
216.     # boundary values.
217.     t0 = datetime.datetime(1000, 1, 1)
218.     tf = datetime.datetime(6000, 1, 1)
219. 
220.     fig = plt.figure()
221.     ax = plt.subplot()
222.     ax.set_autoscale_on(True)
223.     ax.plot([t0, tf], [0.0, 1.0], marker='o')
224. 
225.     rrule = mdates.rrulewrapper(dateutil.rrule.YEARLY, interval=500)
226.     locator = mdates.RRuleLocator(rrule)
227.     ax.xaxis.set_major_locator(locator)
228.     ax.xaxis.set_major_formatter(mdates.AutoDateFormatter(locator))
229. 
230.     ax.autoscale_view()
231.     fig.autofmt_xdate()
232. 
233. 
234. def test_RRuleLocator_dayrange():
235.     loc = mdates.DayLocator()
236.     x1 = datetime.datetime(year=1, month=1, day=1, tzinfo=mdates.UTC)
237.     y1 = datetime.datetime(year=1, month=1, day=16, tzinfo=mdates.UTC)
238.     loc.tick_values(x1, y1)
239.     # On success, no overflow error shall be thrown
240. 
241. 
242. def test_RRuleLocator_close_minmax():
243.     # if d1 and d2 are very close together, rrule cannot create
244.     # reasonable tick intervals; ensure that this is handled properly
245.     rrule = mdates.rrulewrapper(dateutil.rrule.SECONDLY, interval=5)
246.     loc = mdates.RRuleLocator(rrule)
247.     d1 = datetime.datetime(year=2020, month=1, day=1)
248.     d2 = datetime.datetime(year=2020, month=1, day=1, microsecond=1)
249.     expected = ['2020-01-01 00:00:00+00:00',
250.                 '2020-01-01 00:00:00.000001+00:00']
251.     assert list(map(str, mdates.num2date(loc.tick_values(d1, d2)))) == expected
252. 
253. 
254. @image_comparison(['DateFormatter_fractionalSeconds.png'])
255. def test_DateFormatter():
256.     import matplotlib.testing.jpl_units as units
257.     units.register()
258. 
259.     # Lets make sure that DateFormatter will allow us to have tick marks
260.     # at intervals of fractional seconds.
261. 
262.     t0 = datetime.datetime(2001, 1, 1, 0, 0, 0)
263.     tf = datetime.datetime(2001, 1, 1, 0, 0, 1)
264. 
265.     fig = plt.figure()
266.     ax = plt.subplot()
267.     ax.set_autoscale_on(True)
268.     ax.plot([t0, tf], [0.0, 1.0], marker='o')
269. 
270.     # rrule = mpldates.rrulewrapper( dateutil.rrule.YEARLY, interval=500 )
271.     # locator = mpldates.RRuleLocator( rrule )
272.     # ax.xaxis.set_major_locator( locator )
273.     # ax.xaxis.set_major_formatter( mpldates.AutoDateFormatter(locator) )
274. 
275.     ax.autoscale_view()
276.     fig.autofmt_xdate()
277. 
278. 
279. def test_locator_set_formatter():
280.     """
281.     Test if setting the locator only will update the AutoDateFormatter to use
282.     the new locator.
283.     """
284.     plt.rcParams["date.autoformatter.minute"] = "%d %H:%M"
285.     t = [datetime.datetime(2018, 9, 30, 8, 0),
286.          datetime.datetime(2018, 9, 30, 8, 59),
287.          datetime.datetime(2018, 9, 30, 10, 30)]
288.     x = [2, 3, 1]
289. 
290.     fig, ax = plt.subplots()
291.     ax.plot(t, x)
292.     ax.xaxis.set_major_locator(mdates.MinuteLocator((0, 30)))
293.     fig.canvas.draw()
294.     ticklabels = [tl.get_text() for tl in ax.get_xticklabels()]
295.     expected = ['30 08:00', '30 08:30', '30 09:00',
296.                 '30 09:30', '30 10:00', '30 10:30']
297.     assert ticklabels == expected
298. 
299.     ax.xaxis.set_major_locator(mticker.NullLocator())
300.     ax.xaxis.set_minor_locator(mdates.MinuteLocator((5, 55)))
301.     decoy_loc = mdates.MinuteLocator((12, 27))
302.     ax.xaxis.set_minor_formatter(mdates.AutoDateFormatter(decoy_loc))
303. 
304.     ax.xaxis.set_minor_locator(mdates.MinuteLocator((15, 45)))
305.     fig.canvas.draw()
306.     ticklabels = [tl.get_text() for tl in ax.get_xticklabels(which="minor")]
307.     expected = ['30 08:15', '30 08:45', '30 09:15', '30 09:45', '30 10:15']
308.     assert ticklabels == expected
309. 
310. 
311. def test_date_formatter_callable():
312. 
313.     class _Locator:
314.         def _get_unit(self): return -11
315. 
316.     def callable_formatting_function(dates, _):
317.         return [dt.strftime('%d-%m//%Y') for dt in dates]
318. 
319.     formatter = mdates.AutoDateFormatter(_Locator())
320.     formatter.scaled[-10] = callable_formatting_function
321.     assert formatter([datetime.datetime(2014, 12, 25)]) == ['25-12//2014']
322. 
323. 
324. @pytest.mark.parametrize('delta, expected', [
325.     (datetime.timedelta(weeks=52 * 200),
326.      [r'$\mathdefault{%d}$' % (year,) for year in range(1990, 2171, 20)]),
327.     (datetime.timedelta(days=30),
328.      [r'Jan$\mathdefault{ %02d 1990}$' % (day,) for day in range(1, 32, 3)]),
329.     (datetime.timedelta(hours=20),
330.      [r'$\mathdefault{%02d:00:00}$' % (hour,) for hour in range(0, 21, 2)]),
331. ])
332. def test_date_formatter_usetex(delta, expected):
333.     d1 = datetime.datetime(1990, 1, 1)
334.     d2 = d1 + delta
335. 
336.     locator = mdates.AutoDateLocator(interval_multiples=False)
337.     locator.create_dummy_axis()
338.     locator.axis.set_view_interval(mdates.date2num(d1), mdates.date2num(d2))
339. 
340.     formatter = mdates.AutoDateFormatter(locator, usetex=True)
341.     assert [formatter(loc) for loc in locator()] == expected
342. 
343. 
344. def test_drange():
345.     """
346.     This test should check if drange works as expected, and if all the
347.     rounding errors are fixed
348.     """
349.     start = datetime.datetime(2011, 1, 1, tzinfo=mdates.UTC)
350.     end = datetime.datetime(2011, 1, 2, tzinfo=mdates.UTC)
351.     delta = datetime.timedelta(hours=1)
352.     # We expect 24 values in drange(start, end, delta), because drange returns
353.     # dates from an half open interval [start, end)
354.     assert len(mdates.drange(start, end, delta)) == 24
355. 
356.     # if end is a little bit later, we expect the range to contain one element
357.     # more
358.     end = end + datetime.timedelta(microseconds=1)
359.     assert len(mdates.drange(start, end, delta)) == 25
360. 
361.     # reset end
362.     end = datetime.datetime(2011, 1, 2, tzinfo=mdates.UTC)
363. 
364.     # and tst drange with "complicated" floats:
365.     # 4 hours = 1/6 day, this is an "dangerous" float
366.     delta = datetime.timedelta(hours=4)
367.     daterange = mdates.drange(start, end, delta)
368.     assert len(daterange) == 6
369.     assert mdates.num2date(daterange[-1]) == (end - delta)
370. 
371. 
372. @_new_epoch_decorator
373. def test_auto_date_locator():
374.     def _create_auto_date_locator(date1, date2):
375.         locator = mdates.AutoDateLocator(interval_multiples=False)
376.         locator.create_dummy_axis()
377.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
378.         return locator
379. 
380.     d1 = datetime.datetime(1990, 1, 1)
381.     results = ([datetime.timedelta(weeks=52 * 200),
382.                 ['1990-01-01 00:00:00+00:00', '2010-01-01 00:00:00+00:00',
383.                  '2030-01-01 00:00:00+00:00', '2050-01-01 00:00:00+00:00',
384.                  '2070-01-01 00:00:00+00:00', '2090-01-01 00:00:00+00:00',
385.                  '2110-01-01 00:00:00+00:00', '2130-01-01 00:00:00+00:00',
386.                  '2150-01-01 00:00:00+00:00', '2170-01-01 00:00:00+00:00']
387.                 ],
388.                [datetime.timedelta(weeks=52),
389.                 ['1990-01-01 00:00:00+00:00', '1990-02-01 00:00:00+00:00',
390.                  '1990-03-01 00:00:00+00:00', '1990-04-01 00:00:00+00:00',
391.                  '1990-05-01 00:00:00+00:00', '1990-06-01 00:00:00+00:00',
392.                  '1990-07-01 00:00:00+00:00', '1990-08-01 00:00:00+00:00',
393.                  '1990-09-01 00:00:00+00:00', '1990-10-01 00:00:00+00:00',
394.                  '1990-11-01 00:00:00+00:00', '1990-12-01 00:00:00+00:00']
395.                 ],
396.                [datetime.timedelta(days=141),
397.                 ['1990-01-05 00:00:00+00:00', '1990-01-26 00:00:00+00:00',
398.                  '1990-02-16 00:00:00+00:00', '1990-03-09 00:00:00+00:00',
399.                  '1990-03-30 00:00:00+00:00', '1990-04-20 00:00:00+00:00',
400.                  '1990-05-11 00:00:00+00:00']
401.                 ],
402.                [datetime.timedelta(days=40),
403.                 ['1990-01-03 00:00:00+00:00', '1990-01-10 00:00:00+00:00',
404.                  '1990-01-17 00:00:00+00:00', '1990-01-24 00:00:00+00:00',
405.                  '1990-01-31 00:00:00+00:00', '1990-02-07 00:00:00+00:00']
406.                 ],
407.                [datetime.timedelta(hours=40),
408.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 04:00:00+00:00',
409.                  '1990-01-01 08:00:00+00:00', '1990-01-01 12:00:00+00:00',
410.                  '1990-01-01 16:00:00+00:00', '1990-01-01 20:00:00+00:00',
411.                  '1990-01-02 00:00:00+00:00', '1990-01-02 04:00:00+00:00',
412.                  '1990-01-02 08:00:00+00:00', '1990-01-02 12:00:00+00:00',
413.                  '1990-01-02 16:00:00+00:00']
414.                 ],
415.                [datetime.timedelta(minutes=20),
416.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 00:05:00+00:00',
417.                  '1990-01-01 00:10:00+00:00', '1990-01-01 00:15:00+00:00',
418.                  '1990-01-01 00:20:00+00:00']
419.                 ],
420.                [datetime.timedelta(seconds=40),
421.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 00:00:05+00:00',
422.                  '1990-01-01 00:00:10+00:00', '1990-01-01 00:00:15+00:00',
423.                  '1990-01-01 00:00:20+00:00', '1990-01-01 00:00:25+00:00',
424.                  '1990-01-01 00:00:30+00:00', '1990-01-01 00:00:35+00:00',
425.                  '1990-01-01 00:00:40+00:00']
426.                 ],
427.                [datetime.timedelta(microseconds=1500),
428.                 ['1989-12-31 23:59:59.999500+00:00',
429.                  '1990-01-01 00:00:00+00:00',
430.                  '1990-01-01 00:00:00.000500+00:00',
431.                  '1990-01-01 00:00:00.001000+00:00',
432.                  '1990-01-01 00:00:00.001500+00:00',
433.                  '1990-01-01 00:00:00.002000+00:00']
434.                 ],
435.                )
436. 
437.     for t_delta, expected in results:
438.         d2 = d1 + t_delta
439.         locator = _create_auto_date_locator(d1, d2)
440.         assert list(map(str, mdates.num2date(locator()))) == expected
441. 
442. 
443. @_new_epoch_decorator
444. def test_auto_date_locator_intmult():
445.     def _create_auto_date_locator(date1, date2):
446.         locator = mdates.AutoDateLocator(interval_multiples=True)
447.         locator.create_dummy_axis()
448.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
449.         return locator
450. 
451.     results = ([datetime.timedelta(weeks=52 * 200),
452.                 ['1980-01-01 00:00:00+00:00', '2000-01-01 00:00:00+00:00',
453.                  '2020-01-01 00:00:00+00:00', '2040-01-01 00:00:00+00:00',
454.                  '2060-01-01 00:00:00+00:00', '2080-01-01 00:00:00+00:00',
455.                  '2100-01-01 00:00:00+00:00', '2120-01-01 00:00:00+00:00',
456.                  '2140-01-01 00:00:00+00:00', '2160-01-01 00:00:00+00:00',
457.                  '2180-01-01 00:00:00+00:00', '2200-01-01 00:00:00+00:00']
458.                 ],
459.                [datetime.timedelta(weeks=52),
460.                 ['1997-01-01 00:00:00+00:00', '1997-02-01 00:00:00+00:00',
461.                  '1997-03-01 00:00:00+00:00', '1997-04-01 00:00:00+00:00',
462.                  '1997-05-01 00:00:00+00:00', '1997-06-01 00:00:00+00:00',
463.                  '1997-07-01 00:00:00+00:00', '1997-08-01 00:00:00+00:00',
464.                  '1997-09-01 00:00:00+00:00', '1997-10-01 00:00:00+00:00',
465.                  '1997-11-01 00:00:00+00:00', '1997-12-01 00:00:00+00:00']
466.                 ],
467.                [datetime.timedelta(days=141),
468.                 ['1997-01-01 00:00:00+00:00', '1997-01-15 00:00:00+00:00',
469.                  '1997-02-01 00:00:00+00:00', '1997-02-15 00:00:00+00:00',
470.                  '1997-03-01 00:00:00+00:00', '1997-03-15 00:00:00+00:00',
471.                  '1997-04-01 00:00:00+00:00', '1997-04-15 00:00:00+00:00',
472.                  '1997-05-01 00:00:00+00:00', '1997-05-15 00:00:00+00:00']
473.                 ],
474.                [datetime.timedelta(days=40),
475.                 ['1997-01-01 00:00:00+00:00', '1997-01-05 00:00:00+00:00',
476.                  '1997-01-09 00:00:00+00:00', '1997-01-13 00:00:00+00:00',
477.                  '1997-01-17 00:00:00+00:00', '1997-01-21 00:00:00+00:00',
478.                  '1997-01-25 00:00:00+00:00', '1997-01-29 00:00:00+00:00',
479.                  '1997-02-01 00:00:00+00:00', '1997-02-05 00:00:00+00:00',
480.                  '1997-02-09 00:00:00+00:00']
481.                 ],
482.                [datetime.timedelta(hours=40),
483.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 04:00:00+00:00',
484.                  '1997-01-01 08:00:00+00:00', '1997-01-01 12:00:00+00:00',
485.                  '1997-01-01 16:00:00+00:00', '1997-01-01 20:00:00+00:00',
486.                  '1997-01-02 00:00:00+00:00', '1997-01-02 04:00:00+00:00',
487.                  '1997-01-02 08:00:00+00:00', '1997-01-02 12:00:00+00:00',
488.                  '1997-01-02 16:00:00+00:00']
489.                 ],
490.                [datetime.timedelta(minutes=20),
491.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 00:05:00+00:00',
492.                  '1997-01-01 00:10:00+00:00', '1997-01-01 00:15:00+00:00',
493.                  '1997-01-01 00:20:00+00:00']
494.                 ],
495.                [datetime.timedelta(seconds=40),
496.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 00:00:05+00:00',
497.                  '1997-01-01 00:00:10+00:00', '1997-01-01 00:00:15+00:00',
498.                  '1997-01-01 00:00:20+00:00', '1997-01-01 00:00:25+00:00',
499.                  '1997-01-01 00:00:30+00:00', '1997-01-01 00:00:35+00:00',
500.                  '1997-01-01 00:00:40+00:00']

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 23:23:37,508 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants 3 relevant test cases for a bug involving datetime axis formatting with `usetex=True`. I have analyzed the first 500 lines of `lib/matplotlib/tests/test_dates.py` and found one relevant test, `test_date_formatter_usetex`, which checks the string formatting. However, the bug is a visual spacing issue, so image comparison tests are more relevant. The provided context is incomplete, and it is likely that more relevant tests, particularly image comparison tests using `usetex`, exist later in the file. To find two more suitable test cases, I need the complete content of the test file.' query='Please provide the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.' extra_requirements='If the file is shorter than 501 lines, please indicate that.' purpose="I need to find two more relevant test cases, ideally image comparison tests, that test datetime formatting with `usetex` enabled to fully address the user's request."
2025-12-23 23:23:37,509 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.
2025-12-23 23:23:37,509 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 23:23:37,509 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 23:23:37,510 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 23:23:37,510 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.
Extra requirements: If the file is shorter than 501 lines, please indicate that.
Purpose: I need to find two more relevant test cases, ideally image comparison tests, that test datetime formatting with `usetex` enabled to fully address the user's request.
2025-12-23 23:23:41,970 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_dates.py"}'}, '__gemini_function_call_thought_signatures__': {'857478a7-0c91-4f32-a5fa-03f8b46e3f90': 'CtwKAY89a1/EjH4iHP9fiFoRObvZ+uVnmpJmNqS5MQBcII7UT1c7sqNFzY/XGjBT7ou0oTBx79XLGXj6NLWb5Q0jw6SHeZrMDyxPBxfTbqXwFC5Z0cJse6Hr5Rbjlodw9A9TctqxRprVIkDL7qmTOrorYUjPd0r2uLQIt+lvd1pSKfMxku/WZVN4qdnwJqnZzLTey6yIdEDn1icVQbkfoog76MugmQOvMWd7yKVR5rt8IsA/YT9VIzV79xk3MzqxF35fxM0v1Sllh0DfJTLMbfLbWv0mvoNITOG8VpNdYG/Ad+xc24vHOMTioqy8Uvcu05X0r+X3vkZMOa5Ap8ecbC4MBheZ76RkiCSNiA6pZfXpF1FToJ3RjpsGQAdkwZArgjEqrU+VlZc6V6WKFhHlw1/9Tr8ZKRjejQ9Hm3Rwt/14F9i/BHDBeVhL4Q/toaBQJSRxj2F1N5Em4mtXSzQqOm5INqExGRix9nuRrtAfd8OgmlcSYjH0Eyp9wuhMXmhimjM13RHSoB55AuRQNLYfX4oG8N7qrsRTg28i9F0xzN2LC7boaGJHM8KChOmL+s+bFDRNUWthKeww7FKjAHtSO9qZ1JPaVQeUdzrz4JVfjiBMvi+iA7uJOhdAZJjEl9DW6d1DtQl5jOWhssIprWYubwsfBDvVQTxJOzSvU0BK6zbt2afq2IIUptqumxP+IFPqUKXaodc3SQ8kxuP5MMHs7/s/VnKjBPns8l2svNfGDBXjyZEkPcTZR1vpIf9QWj6UlbA4fn6suID+BnFPqnui2PNfnf8nKPzD3k7EAHk3wp7MM6aG/kaLnijs3xnpKueqIxe5Q3eOWNPofKlADoqlgXtx6i00Ipk5pjGE18jS3Ne2Nnrk06ufPI3QoAxIjcYaCAIlxEO7NYz9cy2gxyu62YImYj8AxR6AUUU9kaaBzac8quNJIDqAco9SrJZ+fxtqDLyGwVWcTlQvVMXiD3d5+if4YHEY1iRYLO8X2GZC2SJaTmTeX1JGGi/uwKA2k6fcw158EDlfFtmpGn1iSFUncyxv/mKSu68skyXxLErvgW3XEA8jyQqMo/Ofl4LVlMnj4s4gja+8yUscq+Eeu3A19tOBlMr5QIJiyf6Z+1kHO1RSZ8rokTUfJzPxvGby9r/5wZSO/kRARIl2o5m4Ujw9g0TxMjLPswPU1ign3DY9w6QFsSI8IjlTsxLnwkcmWxVfC4Z0BYj3PZpRWSdjFKaEQSfy2vcNcNeM5qbv7D+rS+T+EYSrbRfrNGMYj3ioxOMaSfHxsu7It3lTqx8pisQq5PoFm16peaBgdMwTEKPnGPQuj3Cm22UxSeRghC9yHo2cy0QFYzPC5s/1gDWSy7M8NeJHpPF5B/HoeX9H87aLYDfHoDfddSVnxURBmVrteXSsEomSzDOcJFccbF8VqYT6GjjTcDE+mZ9GAP8y+bS9XhLP0RbX0DFoRWgg3YVjD46JUDPDgqqGJQ9Whlsvm+7LHzmunCG94NH3UiGub1Cve2RJrJl/vooc7E7pcQJVvWq5W24TSS8PXYFjJ+fP7Op53Cd0GSuIctktEBCCqVhiVTQq6VPwhIb/BApo4z7OSh1Sm0OealPiJvXiOsWwccyz/qQDR0suvT3IK7ECbdRQatBNmD3WUrN6y5V8SHmU5xvSslEZc72hcpag1NB+WdlVwjQ7hgYm9bwpYEXMcb14Dsn1FsPpWYBNO+Ft5l/Dx1yph49CqH+MIIt5VJOLztKbR6qt7E1YI/FF8CRIJdVd8zPoLBcBzyMJ0v9d1/i/NlemNTkNR+xGiFaTQaryD1yA8cwtINnh2TFfa+djpG3C/g=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2181, 'candidates_token_count': 25, 'total_token_count': 2585, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2181}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 379, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7735929870605469, 'model_name': 'gemini-2.5-pro'} id='run--d3d4a8b1-b2d7-4f54-9b8e-e7216a2f0ded-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/tests/test_dates.py'}, 'id': '857478a7-0c91-4f32-a5fa-03f8b46e3f90', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2181, 'output_tokens': 25, 'total_tokens': 2585, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 379}}
2025-12-23 23:23:47,232 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 10000.0, "relative_path": "lib/matplotlib/tests/test_dates.py", "start_line": 501.0}'}, '__gemini_function_call_thought_signatures__': {'9bb03ff8-9717-416d-8992-bbd843702515': 'CoUGAY89a1/umLk6DDHB7sEfDzvRb7/KwwWeicouByfgEZK6JQo1frOvqhd3MogLMcdGQOzdaYx3dNBaPPfi54cZwKflh8Q+y8lKSUmUwndXD+UWoozdJFNpSeuVde4hfzkplgmBtfh11mfh+O/EmAilAbFgVbIP0aK9SrwJhaQtwuxjVi4LpFHGzIR7Dupn+CDKmtj4qkYaBGgHWz4JVu91DQu7tn3wUaobddj0E5ocRTFjMVnULyDzMQlqxRCQ2gQlFVTC+4VpgMR0w2Wd6T9k/6KB2YGcJes+zZYwklGR58e15RE413pASoodSNIUNFCmJQ6GUDWkae9g/3/NC199R83z6VePoKcf1lSFue6pH3ZpWMLO/FnNaEz3ambEb6X0oPQ2BgcR+Ld4unSE3mQK1iw8GB2BBHWHVh3WrZ0t8mKp6GarZIy2ky88BxlPfzA5WGMSpk4dWM5I5IGeioNN7aemsdJ3Lb7FtH/qyOPM4qjpNa+/HQH1pW0z5q13SLXDiStOovH5OEkcITI2wSl2ut4/BXgUAc9eoEGUN/hzi1H5G0DwAqSofGduoQRsrwfP4L3oIWe6hkiqWsjri+guoDT5+Y+LMn4zm5Y/1foznZADGm5hMxu19tTByY/wMy9H9yc0lWembVrvlYVo7voMLH8T5HOJzOk7V8ZeG3YQkwA8PDfUdNP3Tw+fPo29pYBgQziZC2BFtvH1L9+1zNxSs33KF81Z6QqknvvEoLHnKQn5amTfncI7kbszBeT4E1ql4Gja3LQt3fK7aH4DbxqW4dCBvIZhHKaXUxgT/j/Qcj/jqEAFOUZAirbzpSLV/8eypO/Xqv7IZUtLDBq8G+fTn/3i7B9au+inkRlHVM0aRKY6wIO3/WNWS0reGLRFWjEunApgR1hAdAq1LAzF4fYEbRIRDuZxcKeCzWSwddvwZjt9ZItM7OsH+IwW+aOTYpPKmp3wkoFs9v85br2YJ8+LdCYxpe9w8xuYJ5AWBryP8PkwjWnOAkWOLcrlZ3njjk1tY2eeLIQ='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2268, 'candidates_token_count': 31, 'total_token_count': 2511, 'cached_content_token_count': 1536, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2647}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1536}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 212}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4834879905946793, 'model_name': 'gemini-2.5-pro'} id='run--d8c8b7e2-6c36-4516-9593-f902e5208653-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 10000.0, 'relative_path': 'lib/matplotlib/tests/test_dates.py', 'start_line': 501.0}, 'id': '9bb03ff8-9717-416d-8992-bbd843702515', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2268, 'output_tokens': 31, 'total_tokens': 2511, 'input_token_details': {'cache_read': 1536}, 'output_token_details': {'reasoning': 212}}
2025-12-23 23:23:52,225 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_dates.py", "text": "usetex"}'}, '__gemini_function_call_thought_signatures__': {'53c21062-1f99-42ed-8e7c-f23502a05b2d': 'Cq4KAY89a184KFgjVcmEStmkCaekCXLNCMQtVCg+pFMzhnR+Rl3KfniHmVQOSQw2/OfexljhNDRY5cdz3V9vwFjt+6jHPLW/1Bc5D7wPg5Z2099KgjDWaQ4rguxtuXumb9NJfeZZTDjAcNkdqMuTYg1pHvGOi+EZEPOYQSw3cLOYvv26VPyDK8C5IndKKmaX8UITRHwhJubl8tbBLGiTBeCDq3DGAUeLlxyphet1Bz58nrNKgnv8EwY3chDVZ0r84tQAtClgyIbRR+IYlJi25kHmMzJ13x3F/KhbIrR7FcM0H49Y4NnOLAZYdQ/I354wixrfa4jHdgjO5qgxxq+G/u+EReBlZJcjFQ45FPTFIt7TfAJ3MEVkXM/jT59jrSLJ14CENSBYsO3kgC1T30V8QZM+jtcbRU52wgFHgNpThkexDNhTZj6KtceAhEUJkBgFHTi37CZMjg1iu6hp4wttdYcodw2LgM1RZvwKHdhjMcqYDfone9x8Y95N9jH9P0GL5tWN3p3nmUjoHcl/xAJnngcr/R1gfwXZ3vakMFIbz1M80KWqbigxIw5X4SwtUCPxTs59rLoYLEE74t9ZB7e8pqbdnvJ3crE/8HN1GtuWjG/FzDNkgcLmuOHvJUexIkh//0F48W/Se4r5lGvdM7cANu6z6MTb9VODjffA4uKVmPbA6IAeNZ6SzTPYO6HB8kVPvC+JZBirDe0HHYQrbXacdUeQtRDmIee+4ZkY3JTjLtg0MOpYZ/3G8hyxnKtSHuY05ax6E7UTzRV20wWiLvPuOy6Wq0MVMkzdygT46Nzx9CogBP4RnuJVodX5gGL4+VmVFKNMgQhvb5Eb+8TwPji68y/4gjBlpYfciQYZ+oFFW9Zjvbb3BKWkdETEX1RCt9+UHKiC7oO16JMKo/2yjLfggsmSsjWWmBsFJJDhRuVCsSdCBDnpu48beVRP1O9fvBtRe36teXDhu3c0zvQHHVUn3Yihzr9CqHicHoieJ+pZGFZizGU75RSj3oom5RboH+ND9Vy39b2Pmj3Cv70ohwyKggafStRr5k1AXDVreBq2dmlMdJwZ6NEFn+4bpvbP2YGNo82bq0A1FwmPyEnYSYwni70cNEYTN8v1IDJBUWd/sexeGgOPVBDeESq/sjfeKDULT/jHvY4wVM37tW5UijOq3JmdtaXvUK6Aaj/Pa+hRMBzAnP+b1+zaYyK5cH2WNSWrIE6DgDra4XlErSksRr01CTiUf2HTWgSdxUXhCOr8+CXxwMmt1A09rFmp3p0aGpmZ/cz6If0BjiZs5IaNWBiOS7isyUWD/PvN81h/waafRvRKzUDtgQUHnZjyf3dvOWzb5xgVL7/t83YKqgK+KrC6ciwHTJV4mnZfjmnJ5Ot6X1qf52Zj9iALzObbxQ9Z4Ah5XnjI0omFVzXPiCmWgBcZQoOjSHtIPcXgXi6p7dqEiLeDwymBzT8xJosBDHAfwMLtR9A6Orf1P6miwHPXvrAgEqnTPb3DZ+9ArSWUHSKxug+EgZ9mtAmYybHKB+bCB3si7iR6fXzjsFQHSnuF7ArxHRj9GmQUHNO8XbWDUifzi8ZLNCeH/u0WgZninCq0e4LaedApfdC3b0gsj3/qI1/K1Sj394Z7VWYcqkMA8mOvJUHf175rrCN8DLVV0BLIgesF2TfwwV4H1Q9HU+XpqhadO0/0WnLIS9yakrTDEONhbE306czYu6LB62HTGJDveF7zhLqdgNw03mkrcvXKzKBal/gOmdCtt49/eJtQHASFXY6i'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18120, 'candidates_token_count': 36, 'total_token_count': 18511, 'cached_content_token_count': 1880, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18711}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1880}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 36}], 'thoughts_token_count': 355}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0921394560072157, 'model_name': 'gemini-2.5-pro'} id='run--3a66eb41-e67f-401c-af29-45d73d090397-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/tests/test_dates.py', 'text': 'usetex'}, 'id': '53c21062-1f99-42ed-8e7c-f23502a05b2d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18120, 'output_tokens': 36, 'total_tokens': 18511, 'input_token_details': {'cache_read': 1880}, 'output_token_details': {'reasoning': 355}}
2025-12-23 23:23:54,760 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_dates.py", "text": "@image_comparison"}'}, '__gemini_function_call_thought_signatures__': {'a4b4295f-d01d-4cfa-af16-e9af97598f19': 'CusDAY89a19UpNu2NwZVvah6zpE4y8X+Nv4wuXrsoxYH5Jj1bZepJ/63pHycPhUwuJPoQccIOI5h97vcgkF2qPDlSvp0QV86i9q1tkG8twwiqksVQRpaSplY3HafoGLd1apAMiJZQ1vy+P/mXETeHcIaTrqbMrKI1E07x5HbhJgz0m4TGU+75ZKYZhKJw5U9KMVU0+N6s+mevzDAZr1ARPOepvC+Nyiy5bSjZIo/Lvsfc/XehlbCu2AJLyrXqPdHnaNKN9yNSMsl+MqTJoBcJNRqO22aczHplu8/7wrNrFVWNMaJBb5Bk36jvWaM0KCwfAuW0BoPM9z6P5QZvMC2ctT2kB4vSSu8H1YmG3sRp/jWu8DJDpi7Lmj+D9HJNbPD7TVVSDCb5vDNRt7cOZdD39PMILwKiij41N+zc9Barz5mytlNf/pxYMsAicHZPGNaSkwFLzJQ06wZeBfNnu+KQRczFjNhZWwmHenO3gqEP+vVFE+1iqo8bJRDvGi+mP60+vs8o4JD374ek3bi+cPgjWYOzU/fAWGWI3BZYSxS/s7iBggRruBqryikUtWwBvuyRntFTikAfhBnfFXr2NpR4CHXXeJkwsWALFF44ZuMsrheEBpxH+Z+dWtuHIGAY/t8gCDVH9wFL2/6tP7xzRM='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19286, 'candidates_token_count': 38, 'total_token_count': 19450, 'cached_content_token_count': 16919, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20232}], 'cache_tokens_details': [{'modality': 1, 'token_count': 16919}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 38}], 'thoughts_token_count': 126}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11931795822946649, 'model_name': 'gemini-2.5-pro'} id='run--b449bec5-5858-4f82-9e19-188eab5bca36-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/tests/test_dates.py', 'text': '@image_comparison'}, 'id': 'a4b4295f-d01d-4cfa-af16-e9af97598f19', 'type': 'tool_call'}] usage_metadata={'input_tokens': 19286, 'output_tokens': 38, 'total_tokens': 19450, 'input_token_details': {'cache_read': 16919}, 'output_token_details': {'reasoning': 126}}
2025-12-23 23:23:58,888 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 169.0, "relative_path": "lib/matplotlib/tests/test_dates.py", "start_line": 160.0}'}, '__gemini_function_call_thought_signatures__': {'cbdb0819-3ed4-4d2a-b5c7-a50fac00b8d2': 'Cq0DAY89a1804ZW5Ja1zrjgCF4SdD6QsyMdk9cH6I/HhWKgvXxJUn6q+mAKaaVMOivZQtgavxcsn6lJw5Zx2Jrxtib/VW2sNmY0KqU/gF/V1UfmWQMJp4Af/jgd3jnGYhEX89e5earkx3kNVDJnh4p5550Ew0C9LRm7eVOyUZItGCQ7bzSua85LNcw95jZI8UXAWuEz4U2710Lv+IpmWKN50WKjCGL897xu9mlfSvpPk7V6mdqppWzQEKW27zxZmXjZdBtzb1hIaExrbLBUScK2IRVACdPh2QNvMz3Yo2gEO6X8mHT9vhyt7NDlars20sL3Jb5ps0qf+mq36wspgMb2dSd/tqNg4+n08KWUnrerHTSq1Ppn3pGsjofi5CDtPmbz3GwPtN+57gHhlAw7HHWcUuoxurW6BI+KEhm+0wIu+w++FRu3Dbuft1JAmn9buHDSk4GVpeGr/R/Qv9BrahaZU1oyIIQjcCqLg7TyvGNwSRf3jdS0zWqfM9gxN0owquIJZGYSbWt1C/Jq44nXbCxnwXL3pKJ3uWhah7KLYE/otUygfaL7pn4E8P11TMeq0'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20620, 'candidates_token_count': 31, 'total_token_count': 20867, 'cached_content_token_count': 18788, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21692}], 'cache_tokens_details': [{'modality': 1, 'token_count': 18788}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 216}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8755863558861517, 'model_name': 'gemini-2.5-pro'} id='run--a6643cbc-dea0-4154-9ee4-2ab1ae17c1c3-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 169.0, 'relative_path': 'lib/matplotlib/tests/test_dates.py', 'start_line': 160.0}, 'id': 'cbdb0819-3ed4-4d2a-b5c7-a50fac00b8d2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20620, 'output_tokens': 31, 'total_tokens': 20867, 'input_token_details': {'cache_read': 18788}, 'output_token_details': {'reasoning': 216}}
2025-12-23 23:24:01,065 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 157.0, "relative_path": "lib/matplotlib/tests/test_dates.py", "start_line": 148.0}'}, '__gemini_function_call_thought_signatures__': {'c027be42-4646-4e9e-bfce-6e50dd1ed42e': 'CoYDAY89a19NTX1KlmlIrxnUdWfT7W/tivJWu6TTl2jCf4xA0A+LXgpFkKC5BG9kMrGng7cvErA+uFhZuzR2kY9J9rkLZUmlJkRr5/AtmJ7iA9w/+obt1o4NLhVddbjimP5spA05g+v1DTCViZRTfxLbl54ujFfz8KR2PdATWVxVjjqkpPbUIGngFIBB6h5UbkGPBqyEhcdRZvZi4hIhe1VHHqPNcw6saZLqiIkQaQFa2UZn4ZRy55VhQ7nlD3iGYsNGa4cc+cGh4a8KisPmCjXX6qog22ivY9ABVfa32ocZMnciCoaC6ZHOgdpu4Gcz4A6xKo7szcPWq2nkB1U48exZyGT9LCqhB/GP1s2W7yVtDutyiB1reTHGYC99fo+ppuCfYHU7spU9eNqa2dZ9TWvhUX5jQYvcFz0R26VNWNOJa0WPwQnles8jtcuLg11SZ1VzdiJg/Iveypv0z7ZHDq4HLDPqDVMSQffLEzmAanHrLFrM56Uq7+vTNCoqC/gFmSTU/1Vyb0/e'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20926, 'candidates_token_count': 31, 'total_token_count': 21061, 'cached_content_token_count': 20649, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22111}], 'cache_tokens_details': [{'modality': 1, 'token_count': 20649}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 104}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10978691808639034, 'model_name': 'gemini-2.5-pro'} id='run--2faa781b-c304-4bfe-a784-1aeb4c949ed2-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 157.0, 'relative_path': 'lib/matplotlib/tests/test_dates.py', 'start_line': 148.0}, 'id': 'c027be42-4646-4e9e-bfce-6e50dd1ed42e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20926, 'output_tokens': 31, 'total_tokens': 21061, 'input_token_details': {'cache_read': 20649}, 'output_token_details': {'reasoning': 104}}
2025-12-23 23:24:02,955 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 145.0, "relative_path": "lib/matplotlib/tests/test_dates.py", "start_line": 136.0}'}, '__gemini_function_call_thought_signatures__': {'e9fe724e-db29-464a-b25f-7c97d05c351a': 'Cu0BAY89a187RYFOAlcslFjyb5oBqjJxovUUk8sa7tBmKawPalFMAYOaPK3Dyljb7EAJaYeb2sTFWh7CUQYmkV4CIlC8MaCLnaQBlGGkUgplAyCZ0KY0kPnqdSx3DBzYnxEoxts9cu3uVGOY6+r75j0fbR6cZeVa4jiI/Ioga6AZVl89Y2TINYWl+mHHmROIG6hgt4DSUG+ALUlRDt9oOKOLdX7qxwt6HHXAyKzS9HJOEngxdDjVK5cxR/vj0rndrhHLmT3GH2I+8YUWV34OYXc10J51jLV1hxVbxbKmkjpNfbltvzMc/EjiOAECNsyB'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21235, 'candidates_token_count': 31, 'total_token_count': 21325, 'cached_content_token_count': 20630, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22524}], 'cache_tokens_details': [{'modality': 1, 'token_count': 20630}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 59}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12502962543118384, 'model_name': 'gemini-2.5-pro'} id='run--e58a0e65-caee-4d8a-8d7a-dee8853a6a81-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 145.0, 'relative_path': 'lib/matplotlib/tests/test_dates.py', 'start_line': 136.0}, 'id': 'e9fe724e-db29-464a-b25f-7c97d05c351a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21235, 'output_tokens': 31, 'total_tokens': 21325, 'input_token_details': {'cache_read': 20630}, 'output_token_details': {'reasoning': 59}}
2025-12-23 23:24:04,668 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 133.0, "relative_path": "lib/matplotlib/tests/test_dates.py", "start_line": 124.0}'}, '__gemini_function_call_thought_signatures__': {'55e0665d-428a-4b0c-a906-f7277d05f720': 'Co4CAY89a18DJF7TWukx5YAtcZPsJgZdZeIS1+4lORxr4wAlOSp0bXeFtRqAZpGllHYQ8ADf21YtXTceE+uytqrvFrlYd3s2eQ3Xc/WeovJSHL5IdtLab1UBi8K5A7OMzYjTJsOerI030dyKw3sXZEXrKrsPzq0DqbfzsSk51dxZzwJ2vKJMadNqVjf2l25JVV4WsOQfB+B4M71by4KHkUcYg14jOoXbkyDCyivdxWDffLkzqUDCRi6+L7DyKE9vnCdVZlc4rZmopsWAdDChYZ8E40a1OOa7he/iQHwMj81eW5wNwDNSpJiXmuvR0EXjEAyebEF6GDnjYzXCsoTR/c790Sjr5rHD0I6R976G4JP5'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21555, 'candidates_token_count': 31, 'total_token_count': 21658, 'cached_content_token_count': 22483, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22903}], 'cache_tokens_details': [{'modality': 1, 'token_count': 22483}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 72}, 'finish_reason': 'STOP', 'avg_logprobs': -0.01784620169670351, 'model_name': 'gemini-2.5-pro'} id='run--05b29f6e-8c9f-4e55-97b1-2f5eeefbd550-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 133.0, 'relative_path': 'lib/matplotlib/tests/test_dates.py', 'start_line': 124.0}, 'id': '55e0665d-428a-4b0c-a906-f7277d05f720', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21555, 'output_tokens': 31, 'total_tokens': 21658, 'input_token_details': {'cache_read': 22483}, 'output_token_details': {'reasoning': 72}}
2025-12-23 23:24:06,435 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 864.0, "relative_path": "lib/matplotlib/tests/test_dates.py", "start_line": 854.0}'}, '__gemini_function_call_thought_signatures__': {'eeadb2f6-7e4f-46b3-8253-099cf8b173de': 'CqoCAY89a1+m/RibLd8vizCxqtHiccKio0ClMaBPpeDTtj/rRp4d/A6EKv1G79k3DrvLV8lsCA9RDecO+2vMBOAu5qPcUetw846dSILWojWM5H6sUtKvauD8J4TiMj+Sys9iAYQkC8RLi3+Xbm16qelBARaLIVNDwSXuoE0Seuzk5QbHxRf8h6gbSswqyY+ZPFaO59mtEnrTVzSxawWt8gNyMpDkUMqEr8RvZZtxoVRYTYfveLVMjnK7gBp3a+dJGQHFUKBl3Omin7vmPn8XE193vuv9wtPIUFxsHZ+gvnjaSLzRlbVarjxYPuv4KrpIKUSehBPVHnIa/Qf54Q90vvJhFumhsxbw+IVNjp2nBFKTC7xGTlRrc8SWD2ZKL1k1boBalJXOSO33WsONqQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21874, 'candidates_token_count': 31, 'total_token_count': 21986, 'cached_content_token_count': 22463, 'prompt_tokens_details': [{'modality': 1, 'token_count': 23294}], 'cache_tokens_details': [{'modality': 1, 'token_count': 22463}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 81}, 'finish_reason': 'STOP', 'avg_logprobs': -0.019457938209656748, 'model_name': 'gemini-2.5-pro'} id='run--3ba46d9e-2b87-4e64-bb54-ff73c30825a3-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 864.0, 'relative_path': 'lib/matplotlib/tests/test_dates.py', 'start_line': 854.0}, 'id': 'eeadb2f6-7e4f-46b3-8253-099cf8b173de', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21874, 'output_tokens': 31, 'total_tokens': 21986, 'input_token_details': {'cache_read': 22463}, 'output_token_details': {'reasoning': 81}}
2025-12-23 23:24:09,664 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have provided the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file as requested. I then searched for image comparison tests that also use `usetex` for datetime formatting, but none of the image comparison tests in this file use `usetex`. However, I did find two other relevant test cases, `test_date_formatter_usetex` and `test_concise_formatter_usetex`, that test datetime formatting with `usetex` enabled, which I believe will be helpful.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22198, 'candidates_token_count': 118, 'total_token_count': 22436, 'cached_content_token_count': 22443, 'prompt_tokens_details': [{'modality': 1, 'token_count': 23699}], 'cache_tokens_details': [{'modality': 1, 'token_count': 22443}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 118}], 'thoughts_token_count': 120}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12208758370350983, 'model_name': 'gemini-2.5-pro'} id='run--dee11545-4761-4739-ac33-5390021219e5-0' usage_metadata={'input_tokens': 22198, 'output_tokens': 118, 'total_tokens': 22436, 'input_token_details': {'cache_read': 22443}, 'output_token_details': {'reasoning': 120}}
2025-12-23 23:24:09,667 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is shorter than 501 lines, please indicate that.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find two more relevant test cases, ideally image comparison tests, that test datetime formatting with `usetex` enabled to fully address the user's request.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_dates.py
Line number range: 124 - 133
Content:
@image_comparison(['date_axhspan.png'])
def test_date_axhspan():
    # test axhspan with date inputs
    t0 = datetime.datetime(2009, 1, 20)
    tf = datetime.datetime(2009, 1, 21)
    fig, ax = plt.subplots()
    ax.axhspan(t0, tf, facecolor="blue", alpha=0.25)
    ax.set_ylim(t0 - datetime.timedelta(days=5),
                tf + datetime.timedelta(days=5))
    fig.subplots_adjust(left=0.25)


File: lib/matplotlib/tests/test_dates.py
Line number range: 136 - 145
Content:
@image_comparison(['date_axvspan.png'])
def test_date_axvspan():
    # test axvspan with date inputs
    t0 = datetime.datetime(2000, 1, 20)
    tf = datetime.datetime(2010, 1, 21)
    fig, ax = plt.subplots()
    ax.axvspan(t0, tf, facecolor="blue", alpha=0.25)
    ax.set_xlim(t0 - datetime.timedelta(days=720),
                tf + datetime.timedelta(days=720))
    fig.autofmt_xdate()


File: lib/matplotlib/tests/test_dates.py
Line number range: 148 - 157
Content:
@image_comparison(['date_axhline.png'])
def test_date_axhline():
    # test axhline with date inputs
    t0 = datetime.datetime(2009, 1, 20)
    tf = datetime.datetime(2009, 1, 31)
    fig, ax = plt.subplots()
    ax.axhline(t0, color="blue", lw=3)
    ax.set_ylim(t0 - datetime.timedelta(days=5),
                tf + datetime.timedelta(days=5))
    fig.subplots_adjust(left=0.25)


File: lib/matplotlib/tests/test_dates.py
Line number range: 160 - 169
Content:
@image_comparison(['date_axvline.png'])
def test_date_axvline():
    # test axvline with date inputs
    t0 = datetime.datetime(2000, 1, 20)
    tf = datetime.datetime(2000, 1, 21)
    fig, ax = plt.subplots()
    ax.axvline(t0, color="red", lw=3)
    ax.set_xlim(t0 - datetime.timedelta(days=5),
                tf + datetime.timedelta(days=5))
    fig.autofmt_xdate()


File: lib/matplotlib/tests/test_dates.py
Line number range: 324 - 341
Content:
@pytest.mark.parametrize('delta, expected', [
    (datetime.timedelta(weeks=52 * 200),
     [r'$\mathdefault{%d}$' % (year,) for year in range(1990, 2171, 20)]),
    (datetime.timedelta(days=30),
     [r'Jan$\mathdefault{ %02d 1990}$' % (day,) for day in range(1, 32, 3)]),
    (datetime.timedelta(hours=20),
     [r'$\mathdefault{%02d:00:00}$' % (hour,) for hour in range(0, 21, 2)]),
])
def test_date_formatter_usetex(delta, expected):
    d1 = datetime.datetime(1990, 1, 1)
    d2 = d1 + delta

    locator = mdates.AutoDateLocator(interval_multiples=False)
    locator.create_dummy_axis()
    locator.axis.set_view_interval(mdates.date2num(d1), mdates.date2num(d2))

    formatter = mdates.AutoDateFormatter(locator, usetex=True)
    assert [formatter(loc) for loc in locator()] == expected


File: lib/matplotlib/tests/test_dates.py
Line number range: 501 - 10000
Content:
501.                 ],
502.                [datetime.timedelta(microseconds=1500),
503.                 ['1996-12-31 23:59:59.999500+00:00',
504.                  '1997-01-01 00:00:00+00:00',
505.                  '1997-01-01 00:00:00.000500+00:00',
506.                  '1997-01-01 00:00:00.001000+00:00',
507.                  '1997-01-01 00:00:00.001500+00:00',
508.                  '1997-01-01 00:00:00.002000+00:00']
509.                 ],
510.                )
511. 
512.     d1 = datetime.datetime(1997, 1, 1)
513.     for t_delta, expected in results:
514.         d2 = d1 + t_delta
515.         locator = _create_auto_date_locator(d1, d2)
516.         assert list(map(str, mdates.num2date(locator()))) == expected
517. 
518. 
519. def test_concise_formatter_subsecond():
520.     locator = mdates.AutoDateLocator(interval_multiples=True)
521.     formatter = mdates.ConciseDateFormatter(locator)
522.     year_1996 = 9861.0
523.     strings = formatter.format_ticks([
524.         year_1996,
525.         year_1996 + 500 / mdates.MUSECONDS_PER_DAY,
526.         year_1996 + 900 / mdates.MUSECONDS_PER_DAY])
527.     assert strings == ['00:00', '00.0005', '00.0009']
528. 
529. 
530. def test_concise_formatter():
531.     def _create_auto_date_locator(date1, date2):
532.         fig, ax = plt.subplots()
533. 
534.         locator = mdates.AutoDateLocator(interval_multiples=True)
535.         formatter = mdates.ConciseDateFormatter(locator)
536.         ax.yaxis.set_major_locator(locator)
537.         ax.yaxis.set_major_formatter(formatter)
538.         ax.set_ylim(date1, date2)
539.         fig.canvas.draw()
540.         sts = [st.get_text() for st in ax.get_yticklabels()]
541.         return sts
542. 
543.     d1 = datetime.datetime(1997, 1, 1)
544.     results = ([datetime.timedelta(weeks=52 * 200),
545.                 [str(t) for t in range(1980, 2201, 20)]
546.                 ],
547.                [datetime.timedelta(weeks=52),
548.                 ['1997', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
549.                  'Sep', 'Oct', 'Nov', 'Dec']
550.                 ],
551.                [datetime.timedelta(days=141),
552.                 ['Jan', '15', 'Feb', '15', 'Mar', '15', 'Apr', '15',
553.                  'May', '15']
554.                 ],
555.                [datetime.timedelta(days=40),
556.                 ['Jan', '05', '09', '13', '17', '21', '25', '29', 'Feb',
557.                  '05', '09']
558.                 ],
559.                [datetime.timedelta(hours=40),
560.                 ['Jan-01', '04:00', '08:00', '12:00', '16:00', '20:00',
561.                  'Jan-02', '04:00', '08:00', '12:00', '16:00']
562.                 ],
563.                [datetime.timedelta(minutes=20),
564.                 ['00:00', '00:05', '00:10', '00:15', '00:20']
565.                 ],
566.                [datetime.timedelta(seconds=40),
567.                 ['00:00', '05', '10', '15', '20', '25', '30', '35', '40']
568.                 ],
569.                [datetime.timedelta(seconds=2),
570.                 ['59.5', '00:00', '00.5', '01.0', '01.5', '02.0', '02.5']
571.                 ],
572.                )
573.     for t_delta, expected in results:
574.         d2 = d1 + t_delta
575.         strings = _create_auto_date_locator(d1, d2)
576.         assert strings == expected
577. 
578. 
579. @pytest.mark.parametrize('t_delta, expected', [
580.     (datetime.timedelta(seconds=0.01), '1997-Jan-01 00:00'),
581.     (datetime.timedelta(minutes=1), '1997-Jan-01 00:01'),
582.     (datetime.timedelta(hours=1), '1997-Jan-01'),
583.     (datetime.timedelta(days=1), '1997-Jan-02'),
584.     (datetime.timedelta(weeks=1), '1997-Jan'),
585.     (datetime.timedelta(weeks=26), ''),
586.     (datetime.timedelta(weeks=520), '')
587. ])
588. def test_concise_formatter_show_offset(t_delta, expected):
589.     d1 = datetime.datetime(1997, 1, 1)
590.     d2 = d1 + t_delta
591. 
592.     fig, ax = plt.subplots()
593.     locator = mdates.AutoDateLocator()
594.     formatter = mdates.ConciseDateFormatter(locator)
595.     ax.xaxis.set_major_locator(locator)
596.     ax.xaxis.set_major_formatter(formatter)
597. 
598.     ax.plot([d1, d2], [0, 0])
599.     fig.canvas.draw()
600.     assert formatter.get_offset() == expected
601. 
602. 
603. @pytest.mark.parametrize('t_delta, expected', [
604.     (datetime.timedelta(weeks=52 * 200),
605.      ['$\\mathdefault{%d}$' % (t, ) for t in range(1980, 2201, 20)]),
606.     (datetime.timedelta(days=40),
607.      ['Jan', '$\\mathdefault{05}$', '$\\mathdefault{09}$',
608.       '$\\mathdefault{13}$', '$\\mathdefault{17}$', '$\\mathdefault{21}$',
609.       '$\\mathdefault{25}$', '$\\mathdefault{29}$', 'Feb',
610.       '$\\mathdefault{05}$', '$\\mathdefault{09}$']),
611.     (datetime.timedelta(hours=40),
612.      ['Jan$\\mathdefault{{-}01}$', '$\\mathdefault{04:00}$',
613.       '$\\mathdefault{08:00}$', '$\\mathdefault{12:00}$',
614.       '$\\mathdefault{16:00}$', '$\\mathdefault{20:00}$',
615.       'Jan$\\mathdefault{{-}02}$', '$\\mathdefault{04:00}$',
616.       '$\\mathdefault{08:00}$', '$\\mathdefault{12:00}$',
617.       '$\\mathdefault{16:00}$']),
618.     (datetime.timedelta(seconds=2),
619.      ['$\\mathdefault{59.5}$', '$\\mathdefault{00:00}$',
620.       '$\\mathdefault{00.5}$', '$\\mathdefault{01.0}$',
621.       '$\\mathdefault{01.5}$', '$\\mathdefault{02.0}$',
622.       '$\\mathdefault{02.5}$']),
623. ])
624. def test_concise_formatter_usetex(t_delta, expected):
625.     d1 = datetime.datetime(1997, 1, 1)
626.     d2 = d1 + t_delta
627. 
628.     locator = mdates.AutoDateLocator(interval_multiples=True)
629.     locator.create_dummy_axis()
630.     locator.axis.set_view_interval(mdates.date2num(d1), mdates.date2num(d2))
631. 
632.     formatter = mdates.ConciseDateFormatter(locator, usetex=True)
633.     assert formatter.format_ticks(locator()) == expected
634. 
635. 
636. def test_concise_formatter_formats():
637.     formats = ['%Y', '%m/%Y', 'day: %d',
638.                '%H hr %M min', '%H hr %M min', '%S.%f sec']
639. 
640.     def _create_auto_date_locator(date1, date2):
641.         fig, ax = plt.subplots()
642. 
643.         locator = mdates.AutoDateLocator(interval_multiples=True)
644.         formatter = mdates.ConciseDateFormatter(locator, formats=formats)
645.         ax.yaxis.set_major_locator(locator)
646.         ax.yaxis.set_major_formatter(formatter)
647.         ax.set_ylim(date1, date2)
648.         fig.canvas.draw()
649.         sts = [st.get_text() for st in ax.get_yticklabels()]
650.         return sts
651. 
652.     d1 = datetime.datetime(1997, 1, 1)
653.     results = (
654.         [datetime.timedelta(weeks=52 * 200), [str(t) for t in range(1980,
655.          2201, 20)]],
656.         [datetime.timedelta(weeks=52), [
657.             '1997', '02/1997', '03/1997', '04/1997', '05/1997', '06/1997',
658.             '07/1997', '08/1997', '09/1997', '10/1997', '11/1997', '12/1997',
659.             ]],
660.         [datetime.timedelta(days=141), [
661.             '01/1997', 'day: 15', '02/1997', 'day: 15', '03/1997', 'day: 15',
662.             '04/1997', 'day: 15', '05/1997', 'day: 15',
663.             ]],
664.         [datetime.timedelta(days=40), [
665.             '01/1997', 'day: 05', 'day: 09', 'day: 13', 'day: 17', 'day: 21',
666.             'day: 25', 'day: 29', '02/1997', 'day: 05', 'day: 09',
667.             ]],
668.         [datetime.timedelta(hours=40), [
669.             'day: 01', '04 hr 00 min', '08 hr 00 min', '12 hr 00 min',
670.             '16 hr 00 min', '20 hr 00 min', 'day: 02', '04 hr 00 min',
671.             '08 hr 00 min', '12 hr 00 min', '16 hr 00 min',
672.             ]],
673.         [datetime.timedelta(minutes=20), ['00 hr 00 min', '00 hr 05 min',
674.          '00 hr 10 min', '00 hr 15 min', '00 hr 20 min']],
675.         [datetime.timedelta(seconds=40), [
676.             '00 hr 00 min', '05.000000 sec', '10.000000 sec',
677.             '15.000000 sec', '20.000000 sec', '25.000000 sec',
678.             '30.000000 sec', '35.000000 sec', '40.000000 sec',
679.             ]],
680.         [datetime.timedelta(seconds=2), [
681.             '59.500000 sec', '00 hr 00 min', '00.500000 sec', '01.000000 sec',
682.             '01.500000 sec', '02.000000 sec', '02.500000 sec',
683.             ]],
684.         )
685.     for t_delta, expected in results:
686.         d2 = d1 + t_delta
687.         strings = _create_auto_date_locator(d1, d2)
688.         assert strings == expected
689. 
690. 
691. def test_concise_formatter_zformats():
692.     zero_formats = ['', "'%y", '%B', '%m-%d', '%S', '%S.%f']
693. 
694.     def _create_auto_date_locator(date1, date2):
695.         fig, ax = plt.subplots()
696. 
697.         locator = mdates.AutoDateLocator(interval_multiples=True)
698.         formatter = mdates.ConciseDateFormatter(
699.             locator, zero_formats=zero_formats)
700.         ax.yaxis.set_major_locator(locator)
701.         ax.yaxis.set_major_formatter(formatter)
702.         ax.set_ylim(date1, date2)
703.         fig.canvas.draw()
704.         sts = [st.get_text() for st in ax.get_yticklabels()]
705.         return sts
706. 
707.     d1 = datetime.datetime(1997, 1, 1)
708.     results = ([datetime.timedelta(weeks=52 * 200),
709.                 [str(t) for t in range(1980, 2201, 20)]
710.                 ],
711.                [datetime.timedelta(weeks=52),
712.                 ["'97", 'Feb', 'Mar', 'Apr', 'May', 'Jun',
713.                     'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
714.                 ],
715.                [datetime.timedelta(days=141),
716.                 ['January', '15', 'February', '15', 'March',
717.                     '15', 'April', '15', 'May', '15']
718.                 ],
719.                [datetime.timedelta(days=40),
720.                 ['January', '05', '09', '13', '17', '21',
721.                     '25', '29', 'February', '05', '09']
722.                 ],
723.                [datetime.timedelta(hours=40),
724.                 ['01-01', '04:00', '08:00', '12:00', '16:00', '20:00',
725.                     '01-02', '04:00', '08:00', '12:00', '16:00']
726.                 ],
727.                [datetime.timedelta(minutes=20),
728.                 ['00', '00:05', '00:10', '00:15', '00:20']
729.                 ],
730.                [datetime.timedelta(seconds=40),
731.                 ['00', '05', '10', '15', '20', '25', '30', '35', '40']
732.                 ],
733.                [datetime.timedelta(seconds=2),
734.                 ['59.5', '00.0', '00.5', '01.0', '01.5', '02.0', '02.5']
735.                 ],
736.                )
737.     for t_delta, expected in results:
738.         d2 = d1 + t_delta
739.         strings = _create_auto_date_locator(d1, d2)
740.         assert strings == expected
741. 
742. 
743. def test_concise_formatter_tz():
744.     def _create_auto_date_locator(date1, date2, tz):
745.         fig, ax = plt.subplots()
746. 
747.         locator = mdates.AutoDateLocator(interval_multiples=True)
748.         formatter = mdates.ConciseDateFormatter(locator, tz=tz)
749.         ax.yaxis.set_major_locator(locator)
750.         ax.yaxis.set_major_formatter(formatter)
751.         ax.set_ylim(date1, date2)
752.         fig.canvas.draw()
753.         sts = [st.get_text() for st in ax.get_yticklabels()]
754.         return sts, ax.yaxis.get_offset_text().get_text()
755. 
756.     d1 = datetime.datetime(1997, 1, 1).replace(tzinfo=datetime.timezone.utc)
757.     results = ([datetime.timedelta(hours=40),
758.                 ['03:00', '07:00', '11:00', '15:00', '19:00', '23:00',
759.                  '03:00', '07:00', '11:00', '15:00', '19:00'],
760.                 "1997-Jan-02"
761.                 ],
762.                [datetime.timedelta(minutes=20),
763.                 ['03:00', '03:05', '03:10', '03:15', '03:20'],
764.                 "1997-Jan-01"
765.                 ],
766.                [datetime.timedelta(seconds=40),
767.                 ['03:00', '05', '10', '15', '20', '25', '30', '35', '40'],
768.                 "1997-Jan-01 03:00"
769.                 ],
770.                [datetime.timedelta(seconds=2),
771.                 ['59.5', '03:00', '00.5', '01.0', '01.5', '02.0', '02.5'],
772.                 "1997-Jan-01 03:00"
773.                 ],
774.                )
775. 
776.     new_tz = datetime.timezone(datetime.timedelta(hours=3))
777.     for t_delta, expected_strings, expected_offset in results:
778.         d2 = d1 + t_delta
779.         strings, offset = _create_auto_date_locator(d1, d2, new_tz)
780.         assert strings == expected_strings
781.         assert offset == expected_offset
782. 
783. 
784. def test_auto_date_locator_intmult_tz():
785.     def _create_auto_date_locator(date1, date2, tz):
786.         locator = mdates.AutoDateLocator(interval_multiples=True, tz=tz)
787.         locator.create_dummy_axis()
788.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
789.         return locator
790. 
791.     results = ([datetime.timedelta(weeks=52*200),
792.                 ['1980-01-01 00:00:00-08:00', '2000-01-01 00:00:00-08:00',
793.                  '2020-01-01 00:00:00-08:00', '2040-01-01 00:00:00-08:00',
794.                  '2060-01-01 00:00:00-08:00', '2080-01-01 00:00:00-08:00',
795.                  '2100-01-01 00:00:00-08:00', '2120-01-01 00:00:00-08:00',
796.                  '2140-01-01 00:00:00-08:00', '2160-01-01 00:00:00-08:00',
797.                  '2180-01-01 00:00:00-08:00', '2200-01-01 00:00:00-08:00']
798.                 ],
799.                [datetime.timedelta(weeks=52),
800.                 ['1997-01-01 00:00:00-08:00', '1997-02-01 00:00:00-08:00',
801.                  '1997-03-01 00:00:00-08:00', '1997-04-01 00:00:00-08:00',
802.                  '1997-05-01 00:00:00-07:00', '1997-06-01 00:00:00-07:00',
803.                  '1997-07-01 00:00:00-07:00', '1997-08-01 00:00:00-07:00',
804.                  '1997-09-01 00:00:00-07:00', '1997-10-01 00:00:00-07:00',
805.                  '1997-11-01 00:00:00-08:00', '1997-12-01 00:00:00-08:00']
806.                 ],
807.                [datetime.timedelta(days=141),
808.                 ['1997-01-01 00:00:00-08:00', '1997-01-15 00:00:00-08:00',
809.                  '1997-02-01 00:00:00-08:00', '1997-02-15 00:00:00-08:00',
810.                  '1997-03-01 00:00:00-08:00', '1997-03-15 00:00:00-08:00',
811.                  '1997-04-01 00:00:00-08:00', '1997-04-15 00:00:00-07:00',
812.                  '1997-05-01 00:00:00-07:00', '1997-05-15 00:00:00-07:00']
813.                 ],
814.                [datetime.timedelta(days=40),
815.                 ['1997-01-01 00:00:00-08:00', '1997-01-05 00:00:00-08:00',
816.                  '1997-01-09 00:00:00-08:00', '1997-01-13 00:00:00-08:00',
817.                  '1997-01-17 00:00:00-08:00', '1997-01-21 00:00:00-08:00',
818.                  '1997-01-25 00:00:00-08:00', '1997-01-29 00:00:00-08:00',
819.                  '1997-02-01 00:00:00-08:00', '1997-02-05 00:00:00-08:00',
820.                  '1997-02-09 00:00:00-08:00']
821.                 ],
822.                [datetime.timedelta(hours=40),
823.                 ['1997-01-01 00:00:00-08:00', '1997-01-01 04:00:00-08:00',
824.                  '1997-01-01 08:00:00-08:00', '1997-01-01 12:00:00-08:00',
825.                  '1997-01-01 16:00:00-08:00', '1997-01-01 20:00:00-08:00',
826.                  '1997-01-02 00:00:00-08:00', '1997-01-02 04:00:00-08:00',
827.                  '1997-01-02 08:00:00-08:00', '1997-01-02 12:00:00-08:00',
828.                  '1997-01-02 16:00:00-08:00']
829.                 ],
830.                [datetime.timedelta(minutes=20),
831.                 ['1997-01-01 00:00:00-08:00', '1997-01-01 00:05:00-08:00',
832.                  '1997-01-01 00:10:00-08:00', '1997-01-01 00:15:00-08:00',
833.                  '1997-01-01 00:20:00-08:00']
834.                 ],
835.                [datetime.timedelta(seconds=40),
836.                 ['1997-01-01 00:00:00-08:00', '1997-01-01 00:00:05-08:00',
837.                  '1997-01-01 00:00:10-08:00', '1997-01-01 00:00:15-08:00',
838.                  '1997-01-01 00:00:20-08:00', '1997-01-01 00:00:25-08:00',
839.                  '1997-01-01 00:00:30-08:00', '1997-01-01 00:00:35-08:00',
840.                  '1997-01-01 00:00:40-08:00']
841.                 ]
842.                )
843. 
844.     tz = dateutil.tz.gettz('Canada/Pacific')
845.     d1 = datetime.datetime(1997, 1, 1, tzinfo=tz)
846.     for t_delta, expected in results:
847.         with rc_context({'_internal.classic_mode': False}):
848.             d2 = d1 + t_delta
849.             locator = _create_auto_date_locator(d1, d2, tz)
850.             st = list(map(str, mdates.num2date(locator(), tz=tz)))
851.             assert st == expected
852. 
853. 
854. @image_comparison(['date_inverted_limit.png'])
855. def test_date_inverted_limit():
856.     # test ax hline with date inputs
857.     t0 = datetime.datetime(2009, 1, 20)
858.     tf = datetime.datetime(2009, 1, 31)
859.     fig, ax = plt.subplots()
860.     ax.axhline(t0, color="blue", lw=3)
861.     ax.set_ylim(t0 - datetime.timedelta(days=5),
862.                 tf + datetime.timedelta(days=5))
863.     ax.invert_yaxis()
864.     fig.subplots_adjust(left=0.25)
865. 
866. 
867. def _test_date2num_dst(date_range, tz_convert):
868.     # Timezones
869. 
870.     BRUSSELS = dateutil.tz.gettz('Europe/Brussels')
871.     UTC = mdates.UTC
872. 
873.     # Create a list of timezone-aware datetime objects in UTC
874.     # Interval is 0b0.0000011 days, to prevent float rounding issues
875.     dtstart = datetime.datetime(2014, 3, 30, 0, 0, tzinfo=UTC)
876.     interval = datetime.timedelta(minutes=33, seconds=45)
877.     interval_days = 0.0234375   # 2025 / 86400 seconds
878.     N = 8
879. 
880.     dt_utc = date_range(start=dtstart, freq=interval, periods=N)
881.     dt_bxl = tz_convert(dt_utc, BRUSSELS)
882.     t0 = 735322.0 + mdates.date2num(np.datetime64('0000-12-31'))
883.     expected_ordinalf = [t0 + (i * interval_days) for i in range(N)]
884.     actual_ordinalf = list(mdates.date2num(dt_bxl))
885. 
886.     assert actual_ordinalf == expected_ordinalf
887. 
888. 
889. def test_date2num_dst():
890.     # Test for github issue #3896, but in date2num around DST transitions
891.     # with a timezone-aware pandas date_range object.
892. 
893.     class dt_tzaware(datetime.datetime):
894.         """
895.         This bug specifically occurs because of the normalization behavior of
896.         pandas Timestamp objects, so in order to replicate it, we need a
897.         datetime-like object that applies timezone normalization after
898.         subtraction.
899.         """
900. 
901.         def __sub__(self, other):
902.             r = super().__sub__(other)
903.             tzinfo = getattr(r, 'tzinfo', None)
904. 
905.             if tzinfo is not None:
906.                 localizer = getattr(tzinfo, 'normalize', None)
907.                 if localizer is not None:
908.                     r = tzinfo.normalize(r)
909. 
910.             if isinstance(r, datetime.datetime):
911.                 r = self.mk_tzaware(r)
912. 
913.             return r
914. 
915.         def __add__(self, other):
916.             return self.mk_tzaware(super().__add__(other))
917. 
918.         def astimezone(self, tzinfo):
919.             dt = super().astimezone(tzinfo)
920.             return self.mk_tzaware(dt)
921. 
922.         @classmethod
923.         def mk_tzaware(cls, datetime_obj):
924.             kwargs = {}
925.             attrs = ('year',
926.                      'month',
927.                      'day',
928.                      'hour',
929.                      'minute',
930.                      'second',
931.                      'microsecond',
932.                      'tzinfo')
933. 
934.             for attr in attrs:
935.                 val = getattr(datetime_obj, attr, None)
936.                 if val is not None:
937.                     kwargs[attr] = val
938. 
939.             return cls(**kwargs)
940. 
941.     # Define a date_range function similar to pandas.date_range
942.     def date_range(start, freq, periods):
943.         dtstart = dt_tzaware.mk_tzaware(start)
944. 
945.         return [dtstart + (i * freq) for i in range(periods)]
946. 
947.     # Define a tz_convert function that converts a list to a new time zone.
948.     def tz_convert(dt_list, tzinfo):
949.         return [d.astimezone(tzinfo) for d in dt_list]
950. 
951.     _test_date2num_dst(date_range, tz_convert)
952. 
953. 
954. def test_date2num_dst_pandas(pd):
955.     # Test for github issue #3896, but in date2num around DST transitions
956.     # with a timezone-aware pandas date_range object.
957. 
958.     def tz_convert(*args):
959.         return pd.DatetimeIndex.tz_convert(*args).astype(object)
960. 
961.     _test_date2num_dst(pd.date_range, tz_convert)
962. 
963. 
964. def _test_rrulewrapper(attach_tz, get_tz):
965.     SYD = get_tz('Australia/Sydney')
966. 
967.     dtstart = attach_tz(datetime.datetime(2017, 4, 1, 0), SYD)
968.     dtend = attach_tz(datetime.datetime(2017, 4, 4, 0), SYD)
969. 
970.     rule = mdates.rrulewrapper(freq=dateutil.rrule.DAILY, dtstart=dtstart)
971. 
972.     act = rule.between(dtstart, dtend)
973.     exp = [datetime.datetime(2017, 4, 1, 13, tzinfo=dateutil.tz.tzutc()),
974.            datetime.datetime(2017, 4, 2, 14, tzinfo=dateutil.tz.tzutc())]
975. 
976.     assert act == exp
977. 
978. 
979. def test_rrulewrapper():
980.     def attach_tz(dt, zi):
981.         return dt.replace(tzinfo=zi)
982. 
983.     _test_rrulewrapper(attach_tz, dateutil.tz.gettz)
984. 
985. 
986. @pytest.mark.pytz
987. def test_rrulewrapper_pytz():
988.     # Test to make sure pytz zones are supported in rrules
989.     pytz = pytest.importorskip("pytz")
990. 
991.     def attach_tz(dt, zi):
992.         return zi.localize(dt)
993. 
994.     _test_rrulewrapper(attach_tz, pytz.timezone)
995. 
996. 
997. @pytest.mark.pytz
998. def test_yearlocator_pytz():
999.     pytz = pytest.importorskip("pytz")
1000. 
1001.     tz = pytz.timezone('America/New_York')
1002.     x = [tz.localize(datetime.datetime(2010, 1, 1))
1003.          + datetime.timedelta(i) for i in range(2000)]
1004.     locator = mdates.AutoDateLocator(interval_multiples=True, tz=tz)
1005.     locator.create_dummy_axis()
1006.     locator.axis.set_view_interval(mdates.date2num(x[0])-1.0,
1007.                                    mdates.date2num(x[-1])+1.0)
1008.     t = np.array([733408.208333, 733773.208333, 734138.208333,
1009.                   734503.208333, 734869.208333, 735234.208333, 735599.208333])
1010.     # convert to new epoch from old...
1011.     t = t + mdates.date2num(np.datetime64('0000-12-31'))
1012.     np.testing.assert_allclose(t, locator())
1013.     expected = ['2009-01-01 00:00:00-05:00',
1014.                 '2010-01-01 00:00:00-05:00', '2011-01-01 00:00:00-05:00',
1015.                 '2012-01-01 00:00:00-05:00', '2013-01-01 00:00:00-05:00',
1016.                 '2014-01-01 00:00:00-05:00', '2015-01-01 00:00:00-05:00']
1017.     st = list(map(str, mdates.num2date(locator(), tz=tz)))
1018.     assert st == expected
1019. 
1020. 
1021. def test_YearLocator():
1022.     def _create_year_locator(date1, date2, **kwargs):
1023.         locator = mdates.YearLocator(**kwargs)
1024.         locator.create_dummy_axis()
1025.         locator.axis.set_view_interval(mdates.date2num(date1),
1026.                                        mdates.date2num(date2))
1027.         return locator
1028. 
1029.     d1 = datetime.datetime(1990, 1, 1)
1030.     results = ([datetime.timedelta(weeks=52 * 200),
1031.                 {'base': 20, 'month': 1, 'day': 1},
1032.                 ['1980-01-01 00:00:00+00:00', '2000-01-01 00:00:00+00:00',
1033.                  '2020-01-01 00:00:00+00:00', '2040-01-01 00:00:00+00:00',
1034.                  '2060-01-01 00:00:00+00:00', '2080-01-01 00:00:00+00:00',
1035.                  '2100-01-01 00:00:00+00:00', '2120-01-01 00:00:00+00:00',
1036.                  '2140-01-01 00:00:00+00:00', '2160-01-01 00:00:00+00:00',
1037.                  '2180-01-01 00:00:00+00:00', '2200-01-01 00:00:00+00:00']
1038.                 ],
1039.                [datetime.timedelta(weeks=52 * 200),
1040.                 {'base': 20, 'month': 5, 'day': 16},
1041.                 ['1980-05-16 00:00:00+00:00', '2000-05-16 00:00:00+00:00',
1042.                  '2020-05-16 00:00:00+00:00', '2040-05-16 00:00:00+00:00',
1043.                  '2060-05-16 00:00:00+00:00', '2080-05-16 00:00:00+00:00',
1044.                  '2100-05-16 00:00:00+00:00', '2120-05-16 00:00:00+00:00',
1045.                  '2140-05-16 00:00:00+00:00', '2160-05-16 00:00:00+00:00',
1046.                  '2180-05-16 00:00:00+00:00', '2200-05-16 00:00:00+00:00']
1047.                 ],
1048.                [datetime.timedelta(weeks=52 * 5),
1049.                 {'base': 20, 'month': 9, 'day': 25},
1050.                 ['1980-09-25 00:00:00+00:00', '2000-09-25 00:00:00+00:00']
1051.                 ],
1052.                )
1053. 
1054.     for delta, arguments, expected in results:
1055.         d2 = d1 + delta
1056.         locator = _create_year_locator(d1, d2, **arguments)
1057.         assert list(map(str, mdates.num2date(locator()))) == expected
1058. 
1059. 
1060. def test_DayLocator():
1061.     with pytest.raises(ValueError):
1062.         mdates.DayLocator(interval=-1)
1063.     with pytest.raises(ValueError):
1064.         mdates.DayLocator(interval=-1.5)
1065.     with pytest.raises(ValueError):
1066.         mdates.DayLocator(interval=0)
1067.     with pytest.raises(ValueError):
1068.         mdates.DayLocator(interval=1.3)
1069.     mdates.DayLocator(interval=1.0)
1070. 
1071. 
1072. def test_tz_utc():
1073.     dt = datetime.datetime(1970, 1, 1, tzinfo=mdates.UTC)
1074.     dt.tzname()
1075. 
1076. 
1077. @pytest.mark.parametrize("x, tdelta",
1078.                          [(1, datetime.timedelta(days=1)),
1079.                           ([1, 1.5], [datetime.timedelta(days=1),
1080.                                       datetime.timedelta(days=1.5)])])
1081. def test_num2timedelta(x, tdelta):
1082.     dt = mdates.num2timedelta(x)
1083.     assert dt == tdelta
1084. 
1085. 
1086. def test_datetime64_in_list():
1087.     dt = [np.datetime64('2000-01-01'), np.datetime64('2001-01-01')]
1088.     dn = mdates.date2num(dt)
1089.     # convert fixed values from old to new epoch
1090.     t = (np.array([730120.,  730486.]) +
1091.          mdates.date2num(np.datetime64('0000-12-31')))
1092.     np.testing.assert_equal(dn, t)
1093. 
1094. 
1095. def test_change_epoch():
1096.     date = np.datetime64('2000-01-01')
1097. 
1098.     # use private method to clear the epoch and allow it to be set...
1099.     mdates._reset_epoch_test_example()
1100.     mdates.get_epoch()  # Set default.
1101. 
1102.     with pytest.raises(RuntimeError):
1103.         # this should fail here because there is a sentinel on the epoch
1104.         # if the epoch has been used then it cannot be set.
1105.         mdates.set_epoch('0000-01-01')
1106. 
1107.     mdates._reset_epoch_test_example()
1108.     mdates.set_epoch('1970-01-01')
1109.     dt = (date - np.datetime64('1970-01-01')).astype('datetime64[D]')
1110.     dt = dt.astype('int')
1111.     np.testing.assert_equal(mdates.date2num(date), float(dt))
1112. 
1113.     mdates._reset_epoch_test_example()
1114.     mdates.set_epoch('0000-12-31')
1115.     np.testing.assert_equal(mdates.date2num(date), 730120.0)
1116. 
1117.     mdates._reset_epoch_test_example()
1118.     mdates.set_epoch('1970-01-01T01:00:00')
1119.     np.testing.assert_allclose(mdates.date2num(date), dt - 1./24.)
1120.     mdates._reset_epoch_test_example()
1121.     mdates.set_epoch('1970-01-01T00:00:00')
1122.     np.testing.assert_allclose(
1123.         mdates.date2num(np.datetime64('1970-01-01T12:00:00')),
1124.         0.5)
1125. 
1126. 
1127. def test_warn_notintervals():
1128.     dates = np.arange('2001-01-10', '2001-03-04', dtype='datetime64[D]')
1129.     locator = mdates.AutoDateLocator(interval_multiples=False)
1130.     locator.intervald[3] = [2]
1131.     locator.create_dummy_axis()
1132.     locator.axis.set_view_interval(mdates.date2num(dates[0]),
1133.                                    mdates.date2num(dates[-1]))
1134.     with pytest.warns(UserWarning, match="AutoDateLocator was unable") as rec:
1135.         locs = locator()
1136. 
1137. 
1138. def test_change_converter():
1139.     plt.rcParams['date.converter'] = 'concise'
1140.     dates = np.arange('2020-01-01', '2020-05-01', dtype='datetime64[D]')
1141.     fig, ax = plt.subplots()
1142. 
1143.     ax.plot(dates, np.arange(len(dates)))
1144.     fig.canvas.draw()
1145.     assert ax.get_xticklabels()[0].get_text() == 'Jan'
1146.     assert ax.get_xticklabels()[1].get_text() == '15'
1147. 
1148.     plt.rcParams['date.converter'] = 'auto'
1149.     fig, ax = plt.subplots()
1150. 
1151.     ax.plot(dates, np.arange(len(dates)))
1152.     fig.canvas.draw()
1153.     assert ax.get_xticklabels()[0].get_text() == 'Jan 01 2020'
1154.     assert ax.get_xticklabels()[1].get_text() == 'Jan 15 2020'
1155.     with pytest.raises(ValueError):
1156.         plt.rcParams['date.converter'] = 'boo'
1157. 
1158. 
1159. def test_change_interval_multiples():
1160.     plt.rcParams['date.interval_multiples'] = False
1161.     dates = np.arange('2020-01-10', '2020-05-01', dtype='datetime64[D]')
1162.     fig, ax = plt.subplots()
1163. 
1164.     ax.plot(dates, np.arange(len(dates)))
1165.     fig.canvas.draw()
1166.     assert ax.get_xticklabels()[0].get_text() == 'Jan 10 2020'
1167.     assert ax.get_xticklabels()[1].get_text() == 'Jan 24 2020'
1168. 
1169.     plt.rcParams['date.interval_multiples'] = 'True'
1170.     fig, ax = plt.subplots()
1171. 
1172.     ax.plot(dates, np.arange(len(dates)))
1173.     fig.canvas.draw()
1174.     assert ax.get_xticklabels()[0].get_text() == 'Jan 15 2020'
1175.     assert ax.get_xticklabels()[1].get_text() == 'Feb 01 2020'
1176. 
1177. 
1178. def test_epoch2num():
1179.     with _api.suppress_matplotlib_deprecation_warning():
1180.         mdates._reset_epoch_test_example()
1181.         mdates.set_epoch('0000-12-31')
1182.         assert mdates.epoch2num(86400) == 719164.0
1183.         assert mdates.num2epoch(719165.0) == 86400 * 2
1184.         # set back to the default
1185.         mdates._reset_epoch_test_example()
1186.         mdates.set_epoch('1970-01-01T00:00:00')
1187.         assert mdates.epoch2num(86400) == 1.0
1188.         assert mdates.num2epoch(2.0) == 86400 * 2
1189. 
1190. 
1191. def test_julian2num():
1192.     mdates._reset_epoch_test_example()
1193.     mdates.set_epoch('0000-12-31')
1194.     # 2440587.5 is julian date for 1970-01-01T00:00:00
1195.     # https://en.wikipedia.org/wiki/Julian_day
1196.     assert mdates.julian2num(2440588.5) == 719164.0
1197.     assert mdates.num2julian(719165.0) == 2440589.5
1198.     # set back to the default
1199.     mdates._reset_epoch_test_example()
1200.     mdates.set_epoch('1970-01-01T00:00:00')
1201.     assert mdates.julian2num(2440588.5) == 1.0
1202.     assert mdates.num2julian(2.0) == 2440589.5

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 23:24:34,920 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.\n2. Extended relevance:\n   - This context block contains numerous test cases for date handling in matplotlib, including tests for `ConciseDateFormatter`, timezone-aware dates, and various date locators. It directly fulfills the user's primary request.", relative_path='lib/matplotlib/tests/test_dates.py', start_line=501, end_line=1202), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's stated purpose is to find test cases related to datetime formatting with `usetex` enabled.\n   - This context provides the test function `test_date_formatter_usetex`, which directly tests the `AutoDateFormatter` with `usetex=True`.\n2. Extended relevance:\n   - This is a highly relevant test case that directly addresses the user's need to understand how `usetex` is tested with date formatters.", relative_path='lib/matplotlib/tests/test_dates.py', start_line=324, end_line=341), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's purpose is to find test cases for datetime formatting with `usetex` enabled.\n   - This context defines `test_concise_formatter_usetex`, which specifically tests the `ConciseDateFormatter` with `usetex=True`.\n2. Extended relevance:\n   - This provides a second, different example of a `usetex` date formatting test, which is valuable for the user's goal. It also falls within the line range (501-end) that the user requested.", relative_path='lib/matplotlib/tests/test_dates.py', start_line=603, end_line=634)]
2025-12-23 23:24:34,926 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.
2025-12-23 23:24:34,926 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 23:24:34,926 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 23:24:34,927 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 1 existing contexts
2025-12-23 23:24:34,928 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 1 duplicates)
2025-12-23 23:24:34,929 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   └── check_wheel_licenses.py
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   └── 21026-DS.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   └── 21415-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       └── 20990-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.5.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   ├── installing_faq.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   ├── index.rst
|       |   └── installing_source.rst
|       ├── next_whats_new
|       |   ├── README.rst
|       |   ├── extending_MarkerStyle.rst
|       |   └── marker_none.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   └── whats_new_3.5.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── frontpage
|   |   ├── 3D.py
|   |   ├── README.txt
|   |   ├── contour_frontpage.py
|   |   ├── histogram.py
|   |   └── membrane.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── markevery_prop_cycle.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_piecharts.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_symbol.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── cursor_demo.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── load_converter.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── log_test.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── date_index_formatter.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc_sgskip.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_index_formatter2.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   └── ticklabels_rotation.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _enums.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_pickle
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── inset_locator.py
|   |   |   └── parasite_axes.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _contour.cpp
|   ├── _contour_wrapper.cpp
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   ├── qhull_wrap.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── gridspec.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   ├── sample_plots.py
    |   └── usage.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: Datetime axis with usetex is unclear

Description: ### Bug summary

The spacing for a datetime axis when using `usetex=True` is unclear in matplotlib version 3.4 when comparing it to 3.3.

### Code for reproduction

```python
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

np.random.seed(1)
matplotlib.rcParams["text.usetex"] = True

dates = pd.date_range("2020-01-01 00:00:00", end="2020-01-01 00:10:00", periods=100)
data = np.random.rand(100)

fig, ax = plt.subplots(constrained_layout=True)
ax.plot(dates, data)
plt.savefig(matplotlib.__version__ + ".png")
```


### Actual outcome

Example of how it look in 3.3.4:
![3 3 4](https://user-images.githubusercontent.com/19758978/139711077-e4fd7727-1e8b-4225-b399-ddad2307f754.png)

Example of how it look in 3.4.3:
![3 4 3](https://user-images.githubusercontent.com/19758978/139711070-2859fd7a-70b2-449e-a3b0-d48e50184077.png)

### Expected outcome

The ideal case would be to have the spacing from version 3.3 in a tex format.

### Operating system

Windows

### Matplotlib Version

3.4.3

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Other libraries

_No response_

### Installation

conda

### Conda channel

conda-forge

Patch information:
diff --git a/lib/matplotlib/dates.py b/lib/matplotlib/dates.py
index 0766156d64..f3fbc6600b 100644
--- a/lib/matplotlib/dates.py
+++ b/lib/matplotlib/dates.py
@@ -596,7 +596,7 @@ def _wrap_in_tex(text):
     ret_text = re.sub(p, r'}$\1$\\mathdefault{', text)
 
     # Braces ensure dashes are not spaced like binary operators.
-    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}')+'}$'
+    ret_text = '$\\mathdefault{'+ret_text.replace('-', '{-}').replace(':', '\\mathord{:}')+'}$'
     ret_text = ret_text.replace('$\\mathdefault{}$', '')
     return ret_text
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of lib/matplotlib/tests/test_dates.py
Extra Requirements: 
Purpose: I need to find relevant test cases for a bug involving datetime axis formatting with `usetex`.

Previous refined query 2:
Essential Query: Please provide the content of `lib/matplotlib/tests/test_dates.py` from line 501 to the end of the file.
Extra Requirements: If the file is shorter than 501 lines, please indicate that.
Purpose: I need to find two more relevant test cases, ideally image comparison tests, that test datetime formatting with `usetex` enabled to fully address the user's request.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_dates.py
Line number range: 1 - 500
Content:
1. import datetime
2. 
3. import dateutil.tz
4. import dateutil.rrule
5. import functools
6. import numpy as np
7. import pytest
8. 
9. from matplotlib import rc_context
10. import matplotlib.dates as mdates
11. import matplotlib.pyplot as plt
12. from matplotlib.testing.decorators import image_comparison
13. import matplotlib.ticker as mticker
14. import matplotlib._api as _api
15. 
16. 
17. def test_date_numpyx():
18.     # test that numpy dates work properly...
19.     base = datetime.datetime(2017, 1, 1)
20.     time = [base + datetime.timedelta(days=x) for x in range(0, 3)]
21.     timenp = np.array(time, dtype='datetime64[ns]')
22.     data = np.array([0., 2., 1.])
23.     fig = plt.figure(figsize=(10, 2))
24.     ax = fig.add_subplot(1, 1, 1)
25.     h, = ax.plot(time, data)
26.     hnp, = ax.plot(timenp, data)
27.     np.testing.assert_equal(h.get_xdata(orig=False), hnp.get_xdata(orig=False))
28.     fig = plt.figure(figsize=(10, 2))
29.     ax = fig.add_subplot(1, 1, 1)
30.     h, = ax.plot(data, time)
31.     hnp, = ax.plot(data, timenp)
32.     np.testing.assert_equal(h.get_ydata(orig=False), hnp.get_ydata(orig=False))
33. 
34. 
35. @pytest.mark.parametrize('t0', [datetime.datetime(2017, 1, 1, 0, 1, 1),
36. 
37.                                 [datetime.datetime(2017, 1, 1, 0, 1, 1),
38.                                  datetime.datetime(2017, 1, 1, 1, 1, 1)],
39. 
40.                                 [[datetime.datetime(2017, 1, 1, 0, 1, 1),
41.                                   datetime.datetime(2017, 1, 1, 1, 1, 1)],
42.                                  [datetime.datetime(2017, 1, 1, 2, 1, 1),
43.                                   datetime.datetime(2017, 1, 1, 3, 1, 1)]]])
44. @pytest.mark.parametrize('dtype', ['datetime64[s]',
45.                                    'datetime64[us]',
46.                                    'datetime64[ms]',
47.                                    'datetime64[ns]'])
48. def test_date_date2num_numpy(t0, dtype):
49.     time = mdates.date2num(t0)
50.     tnp = np.array(t0, dtype=dtype)
51.     nptime = mdates.date2num(tnp)
52.     np.testing.assert_equal(time, nptime)
53. 
54. 
55. @pytest.mark.parametrize('dtype', ['datetime64[s]',
56.                                    'datetime64[us]',
57.                                    'datetime64[ms]',
58.                                    'datetime64[ns]'])
59. def test_date2num_NaT(dtype):
60.     t0 = datetime.datetime(2017, 1, 1, 0, 1, 1)
61.     tmpl = [mdates.date2num(t0), np.nan]
62.     tnp = np.array([t0, 'NaT'], dtype=dtype)
63.     nptime = mdates.date2num(tnp)
64.     np.testing.assert_array_equal(tmpl, nptime)
65. 
66. 
67. @pytest.mark.parametrize('units', ['s', 'ms', 'us', 'ns'])
68. def test_date2num_NaT_scalar(units):
69.     tmpl = mdates.date2num(np.datetime64('NaT', units))
70.     assert np.isnan(tmpl)
71. 
72. 
73. def test_date_empty():
74.     # make sure we do the right thing when told to plot dates even
75.     # if no date data has been presented, cf
76.     # http://sourceforge.net/tracker/?func=detail&aid=2850075&group_id=80706&atid=560720
77.     fig, ax = plt.subplots()
78.     ax.xaxis_date()
79.     fig.draw_without_rendering()
80.     np.testing.assert_allclose(ax.get_xlim(),
81.                                [mdates.date2num(np.datetime64('2000-01-01')),
82.                                 mdates.date2num(np.datetime64('2010-01-01'))])
83. 
84.     mdates._reset_epoch_test_example()
85.     mdates.set_epoch('0000-12-31')
86.     fig, ax = plt.subplots()
87.     ax.xaxis_date()
88.     fig.draw_without_rendering()
89.     np.testing.assert_allclose(ax.get_xlim(),
90.                                [mdates.date2num(np.datetime64('2000-01-01')),
91.                                 mdates.date2num(np.datetime64('2010-01-01'))])
92.     mdates._reset_epoch_test_example()
93. 
94. 
95. def test_date_not_empty():
96.     fig = plt.figure()
97.     ax = fig.add_subplot()
98. 
99.     ax.plot([50, 70], [1, 2])
100.     ax.xaxis.axis_date()
101.     np.testing.assert_allclose(ax.get_xlim(), [50, 70])
102. 
103. 
104. def test_axhline():
105.     # make sure that axhline doesn't set the xlimits...
106.     fig, ax = plt.subplots()
107.     ax.axhline(1.5)
108.     ax.plot([np.datetime64('2016-01-01'), np.datetime64('2016-01-02')], [1, 2])
109.     np.testing.assert_allclose(ax.get_xlim(),
110.                                [mdates.date2num(np.datetime64('2016-01-01')),
111.                                 mdates.date2num(np.datetime64('2016-01-02'))])
112. 
113.     mdates._reset_epoch_test_example()
114.     mdates.set_epoch('0000-12-31')
115.     fig, ax = plt.subplots()
116.     ax.axhline(1.5)
117.     ax.plot([np.datetime64('2016-01-01'), np.datetime64('2016-01-02')], [1, 2])
118.     np.testing.assert_allclose(ax.get_xlim(),
119.                                [mdates.date2num(np.datetime64('2016-01-01')),
120.                                 mdates.date2num(np.datetime64('2016-01-02'))])
121.     mdates._reset_epoch_test_example()
122. 
123. 
124. @image_comparison(['date_axhspan.png'])
125. def test_date_axhspan():
126.     # test axhspan with date inputs
127.     t0 = datetime.datetime(2009, 1, 20)
128.     tf = datetime.datetime(2009, 1, 21)
129.     fig, ax = plt.subplots()
130.     ax.axhspan(t0, tf, facecolor="blue", alpha=0.25)
131.     ax.set_ylim(t0 - datetime.timedelta(days=5),
132.                 tf + datetime.timedelta(days=5))
133.     fig.subplots_adjust(left=0.25)
134. 
135. 
136. @image_comparison(['date_axvspan.png'])
137. def test_date_axvspan():
138.     # test axvspan with date inputs
139.     t0 = datetime.datetime(2000, 1, 20)
140.     tf = datetime.datetime(2010, 1, 21)
141.     fig, ax = plt.subplots()
142.     ax.axvspan(t0, tf, facecolor="blue", alpha=0.25)
143.     ax.set_xlim(t0 - datetime.timedelta(days=720),
144.                 tf + datetime.timedelta(days=720))
145.     fig.autofmt_xdate()
146. 
147. 
148. @image_comparison(['date_axhline.png'])
149. def test_date_axhline():
150.     # test axhline with date inputs
151.     t0 = datetime.datetime(2009, 1, 20)
152.     tf = datetime.datetime(2009, 1, 31)
153.     fig, ax = plt.subplots()
154.     ax.axhline(t0, color="blue", lw=3)
155.     ax.set_ylim(t0 - datetime.timedelta(days=5),
156.                 tf + datetime.timedelta(days=5))
157.     fig.subplots_adjust(left=0.25)
158. 
159. 
160. @image_comparison(['date_axvline.png'])
161. def test_date_axvline():
162.     # test axvline with date inputs
163.     t0 = datetime.datetime(2000, 1, 20)
164.     tf = datetime.datetime(2000, 1, 21)
165.     fig, ax = plt.subplots()
166.     ax.axvline(t0, color="red", lw=3)
167.     ax.set_xlim(t0 - datetime.timedelta(days=5),
168.                 tf + datetime.timedelta(days=5))
169.     fig.autofmt_xdate()
170. 
171. 
172. def test_too_many_date_ticks(caplog):
173.     # Attempt to test SF 2715172, see
174.     # https://sourceforge.net/tracker/?func=detail&aid=2715172&group_id=80706&atid=560720
175.     # setting equal datetimes triggers and expander call in
176.     # transforms.nonsingular which results in too many ticks in the
177.     # DayLocator.  This should emit a log at WARNING level.
178.     caplog.set_level("WARNING")
179.     t0 = datetime.datetime(2000, 1, 20)
180.     tf = datetime.datetime(2000, 1, 20)
181.     fig, ax = plt.subplots()
182.     with pytest.warns(UserWarning) as rec:
183.         ax.set_xlim((t0, tf), auto=True)
184.         assert len(rec) == 1
185.         assert \
186.             'Attempting to set identical left == right' in str(rec[0].message)
187.     ax.plot([], [])
188.     ax.xaxis.set_major_locator(mdates.DayLocator())
189.     v = ax.xaxis.get_major_locator()()
190.     assert len(v) > 1000
191.     # The warning is emitted multiple times because the major locator is also
192.     # called both when placing the minor ticks (for overstriking detection) and
193.     # during tick label positioning.
194.     assert caplog.records and all(
195.         record.name == "matplotlib.ticker" and record.levelname == "WARNING"
196.         for record in caplog.records)
197.     assert len(caplog.records) > 0
198. 
199. 
200. def _new_epoch_decorator(thefunc):
201.     @functools.wraps(thefunc)
202.     def wrapper():
203.         mdates._reset_epoch_test_example()
204.         mdates.set_epoch('2000-01-01')
205.         thefunc()
206.         mdates._reset_epoch_test_example()
207.     return wrapper
208. 
209. 
210. @image_comparison(['RRuleLocator_bounds.png'])
211. def test_RRuleLocator():
212.     import matplotlib.testing.jpl_units as units
213.     units.register()
214.     # This will cause the RRuleLocator to go out of bounds when it tries
215.     # to add padding to the limits, so we make sure it caps at the correct
216.     # boundary values.
217.     t0 = datetime.datetime(1000, 1, 1)
218.     tf = datetime.datetime(6000, 1, 1)
219. 
220.     fig = plt.figure()
221.     ax = plt.subplot()
222.     ax.set_autoscale_on(True)
223.     ax.plot([t0, tf], [0.0, 1.0], marker='o')
224. 
225.     rrule = mdates.rrulewrapper(dateutil.rrule.YEARLY, interval=500)
226.     locator = mdates.RRuleLocator(rrule)
227.     ax.xaxis.set_major_locator(locator)
228.     ax.xaxis.set_major_formatter(mdates.AutoDateFormatter(locator))
229. 
230.     ax.autoscale_view()
231.     fig.autofmt_xdate()
232. 
233. 
234. def test_RRuleLocator_dayrange():
235.     loc = mdates.DayLocator()
236.     x1 = datetime.datetime(year=1, month=1, day=1, tzinfo=mdates.UTC)
237.     y1 = datetime.datetime(year=1, month=1, day=16, tzinfo=mdates.UTC)
238.     loc.tick_values(x1, y1)
239.     # On success, no overflow error shall be thrown
240. 
241. 
242. def test_RRuleLocator_close_minmax():
243.     # if d1 and d2 are very close together, rrule cannot create
244.     # reasonable tick intervals; ensure that this is handled properly
245.     rrule = mdates.rrulewrapper(dateutil.rrule.SECONDLY, interval=5)
246.     loc = mdates.RRuleLocator(rrule)
247.     d1 = datetime.datetime(year=2020, month=1, day=1)
248.     d2 = datetime.datetime(year=2020, month=1, day=1, microsecond=1)
249.     expected = ['2020-01-01 00:00:00+00:00',
250.                 '2020-01-01 00:00:00.000001+00:00']
251.     assert list(map(str, mdates.num2date(loc.tick_values(d1, d2)))) == expected
252. 
253. 
254. @image_comparison(['DateFormatter_fractionalSeconds.png'])
255. def test_DateFormatter():
256.     import matplotlib.testing.jpl_units as units
257.     units.register()
258. 
259.     # Lets make sure that DateFormatter will allow us to have tick marks
260.     # at intervals of fractional seconds.
261. 
262.     t0 = datetime.datetime(2001, 1, 1, 0, 0, 0)
263.     tf = datetime.datetime(2001, 1, 1, 0, 0, 1)
264. 
265.     fig = plt.figure()
266.     ax = plt.subplot()
267.     ax.set_autoscale_on(True)
268.     ax.plot([t0, tf], [0.0, 1.0], marker='o')
269. 
270.     # rrule = mpldates.rrulewrapper( dateutil.rrule.YEARLY, interval=500 )
271.     # locator = mpldates.RRuleLocator( rrule )
272.     # ax.xaxis.set_major_locator( locator )
273.     # ax.xaxis.set_major_formatter( mpldates.AutoDateFormatter(locator) )
274. 
275.     ax.autoscale_view()
276.     fig.autofmt_xdate()
277. 
278. 
279. def test_locator_set_formatter():
280.     """
281.     Test if setting the locator only will update the AutoDateFormatter to use
282.     the new locator.
283.     """
284.     plt.rcParams["date.autoformatter.minute"] = "%d %H:%M"
285.     t = [datetime.datetime(2018, 9, 30, 8, 0),
286.          datetime.datetime(2018, 9, 30, 8, 59),
287.          datetime.datetime(2018, 9, 30, 10, 30)]
288.     x = [2, 3, 1]
289. 
290.     fig, ax = plt.subplots()
291.     ax.plot(t, x)
292.     ax.xaxis.set_major_locator(mdates.MinuteLocator((0, 30)))
293.     fig.canvas.draw()
294.     ticklabels = [tl.get_text() for tl in ax.get_xticklabels()]
295.     expected = ['30 08:00', '30 08:30', '30 09:00',
296.                 '30 09:30', '30 10:00', '30 10:30']
297.     assert ticklabels == expected
298. 
299.     ax.xaxis.set_major_locator(mticker.NullLocator())
300.     ax.xaxis.set_minor_locator(mdates.MinuteLocator((5, 55)))
301.     decoy_loc = mdates.MinuteLocator((12, 27))
302.     ax.xaxis.set_minor_formatter(mdates.AutoDateFormatter(decoy_loc))
303. 
304.     ax.xaxis.set_minor_locator(mdates.MinuteLocator((15, 45)))
305.     fig.canvas.draw()
306.     ticklabels = [tl.get_text() for tl in ax.get_xticklabels(which="minor")]
307.     expected = ['30 08:15', '30 08:45', '30 09:15', '30 09:45', '30 10:15']
308.     assert ticklabels == expected
309. 
310. 
311. def test_date_formatter_callable():
312. 
313.     class _Locator:
314.         def _get_unit(self): return -11
315. 
316.     def callable_formatting_function(dates, _):
317.         return [dt.strftime('%d-%m//%Y') for dt in dates]
318. 
319.     formatter = mdates.AutoDateFormatter(_Locator())
320.     formatter.scaled[-10] = callable_formatting_function
321.     assert formatter([datetime.datetime(2014, 12, 25)]) == ['25-12//2014']
322. 
323. 
324. @pytest.mark.parametrize('delta, expected', [
325.     (datetime.timedelta(weeks=52 * 200),
326.      [r'$\mathdefault{%d}$' % (year,) for year in range(1990, 2171, 20)]),
327.     (datetime.timedelta(days=30),
328.      [r'Jan$\mathdefault{ %02d 1990}$' % (day,) for day in range(1, 32, 3)]),
329.     (datetime.timedelta(hours=20),
330.      [r'$\mathdefault{%02d:00:00}$' % (hour,) for hour in range(0, 21, 2)]),
331. ])
332. def test_date_formatter_usetex(delta, expected):
333.     d1 = datetime.datetime(1990, 1, 1)
334.     d2 = d1 + delta
335. 
336.     locator = mdates.AutoDateLocator(interval_multiples=False)
337.     locator.create_dummy_axis()
338.     locator.axis.set_view_interval(mdates.date2num(d1), mdates.date2num(d2))
339. 
340.     formatter = mdates.AutoDateFormatter(locator, usetex=True)
341.     assert [formatter(loc) for loc in locator()] == expected
342. 
343. 
344. def test_drange():
345.     """
346.     This test should check if drange works as expected, and if all the
347.     rounding errors are fixed
348.     """
349.     start = datetime.datetime(2011, 1, 1, tzinfo=mdates.UTC)
350.     end = datetime.datetime(2011, 1, 2, tzinfo=mdates.UTC)
351.     delta = datetime.timedelta(hours=1)
352.     # We expect 24 values in drange(start, end, delta), because drange returns
353.     # dates from an half open interval [start, end)
354.     assert len(mdates.drange(start, end, delta)) == 24
355. 
356.     # if end is a little bit later, we expect the range to contain one element
357.     # more
358.     end = end + datetime.timedelta(microseconds=1)
359.     assert len(mdates.drange(start, end, delta)) == 25
360. 
361.     # reset end
362.     end = datetime.datetime(2011, 1, 2, tzinfo=mdates.UTC)
363. 
364.     # and tst drange with "complicated" floats:
365.     # 4 hours = 1/6 day, this is an "dangerous" float
366.     delta = datetime.timedelta(hours=4)
367.     daterange = mdates.drange(start, end, delta)
368.     assert len(daterange) == 6
369.     assert mdates.num2date(daterange[-1]) == (end - delta)
370. 
371. 
372. @_new_epoch_decorator
373. def test_auto_date_locator():
374.     def _create_auto_date_locator(date1, date2):
375.         locator = mdates.AutoDateLocator(interval_multiples=False)
376.         locator.create_dummy_axis()
377.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
378.         return locator
379. 
380.     d1 = datetime.datetime(1990, 1, 1)
381.     results = ([datetime.timedelta(weeks=52 * 200),
382.                 ['1990-01-01 00:00:00+00:00', '2010-01-01 00:00:00+00:00',
383.                  '2030-01-01 00:00:00+00:00', '2050-01-01 00:00:00+00:00',
384.                  '2070-01-01 00:00:00+00:00', '2090-01-01 00:00:00+00:00',
385.                  '2110-01-01 00:00:00+00:00', '2130-01-01 00:00:00+00:00',
386.                  '2150-01-01 00:00:00+00:00', '2170-01-01 00:00:00+00:00']
387.                 ],
388.                [datetime.timedelta(weeks=52),
389.                 ['1990-01-01 00:00:00+00:00', '1990-02-01 00:00:00+00:00',
390.                  '1990-03-01 00:00:00+00:00', '1990-04-01 00:00:00+00:00',
391.                  '1990-05-01 00:00:00+00:00', '1990-06-01 00:00:00+00:00',
392.                  '1990-07-01 00:00:00+00:00', '1990-08-01 00:00:00+00:00',
393.                  '1990-09-01 00:00:00+00:00', '1990-10-01 00:00:00+00:00',
394.                  '1990-11-01 00:00:00+00:00', '1990-12-01 00:00:00+00:00']
395.                 ],
396.                [datetime.timedelta(days=141),
397.                 ['1990-01-05 00:00:00+00:00', '1990-01-26 00:00:00+00:00',
398.                  '1990-02-16 00:00:00+00:00', '1990-03-09 00:00:00+00:00',
399.                  '1990-03-30 00:00:00+00:00', '1990-04-20 00:00:00+00:00',
400.                  '1990-05-11 00:00:00+00:00']
401.                 ],
402.                [datetime.timedelta(days=40),
403.                 ['1990-01-03 00:00:00+00:00', '1990-01-10 00:00:00+00:00',
404.                  '1990-01-17 00:00:00+00:00', '1990-01-24 00:00:00+00:00',
405.                  '1990-01-31 00:00:00+00:00', '1990-02-07 00:00:00+00:00']
406.                 ],
407.                [datetime.timedelta(hours=40),
408.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 04:00:00+00:00',
409.                  '1990-01-01 08:00:00+00:00', '1990-01-01 12:00:00+00:00',
410.                  '1990-01-01 16:00:00+00:00', '1990-01-01 20:00:00+00:00',
411.                  '1990-01-02 00:00:00+00:00', '1990-01-02 04:00:00+00:00',
412.                  '1990-01-02 08:00:00+00:00', '1990-01-02 12:00:00+00:00',
413.                  '1990-01-02 16:00:00+00:00']
414.                 ],
415.                [datetime.timedelta(minutes=20),
416.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 00:05:00+00:00',
417.                  '1990-01-01 00:10:00+00:00', '1990-01-01 00:15:00+00:00',
418.                  '1990-01-01 00:20:00+00:00']
419.                 ],
420.                [datetime.timedelta(seconds=40),
421.                 ['1990-01-01 00:00:00+00:00', '1990-01-01 00:00:05+00:00',
422.                  '1990-01-01 00:00:10+00:00', '1990-01-01 00:00:15+00:00',
423.                  '1990-01-01 00:00:20+00:00', '1990-01-01 00:00:25+00:00',
424.                  '1990-01-01 00:00:30+00:00', '1990-01-01 00:00:35+00:00',
425.                  '1990-01-01 00:00:40+00:00']
426.                 ],
427.                [datetime.timedelta(microseconds=1500),
428.                 ['1989-12-31 23:59:59.999500+00:00',
429.                  '1990-01-01 00:00:00+00:00',
430.                  '1990-01-01 00:00:00.000500+00:00',
431.                  '1990-01-01 00:00:00.001000+00:00',
432.                  '1990-01-01 00:00:00.001500+00:00',
433.                  '1990-01-01 00:00:00.002000+00:00']
434.                 ],
435.                )
436. 
437.     for t_delta, expected in results:
438.         d2 = d1 + t_delta
439.         locator = _create_auto_date_locator(d1, d2)
440.         assert list(map(str, mdates.num2date(locator()))) == expected
441. 
442. 
443. @_new_epoch_decorator
444. def test_auto_date_locator_intmult():
445.     def _create_auto_date_locator(date1, date2):
446.         locator = mdates.AutoDateLocator(interval_multiples=True)
447.         locator.create_dummy_axis()
448.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
449.         return locator
450. 
451.     results = ([datetime.timedelta(weeks=52 * 200),
452.                 ['1980-01-01 00:00:00+00:00', '2000-01-01 00:00:00+00:00',
453.                  '2020-01-01 00:00:00+00:00', '2040-01-01 00:00:00+00:00',
454.                  '2060-01-01 00:00:00+00:00', '2080-01-01 00:00:00+00:00',
455.                  '2100-01-01 00:00:00+00:00', '2120-01-01 00:00:00+00:00',
456.                  '2140-01-01 00:00:00+00:00', '2160-01-01 00:00:00+00:00',
457.                  '2180-01-01 00:00:00+00:00', '2200-01-01 00:00:00+00:00']
458.                 ],
459.                [datetime.timedelta(weeks=52),
460.                 ['1997-01-01 00:00:00+00:00', '1997-02-01 00:00:00+00:00',
461.                  '1997-03-01 00:00:00+00:00', '1997-04-01 00:00:00+00:00',
462.                  '1997-05-01 00:00:00+00:00', '1997-06-01 00:00:00+00:00',
463.                  '1997-07-01 00:00:00+00:00', '1997-08-01 00:00:00+00:00',
464.                  '1997-09-01 00:00:00+00:00', '1997-10-01 00:00:00+00:00',
465.                  '1997-11-01 00:00:00+00:00', '1997-12-01 00:00:00+00:00']
466.                 ],
467.                [datetime.timedelta(days=141),
468.                 ['1997-01-01 00:00:00+00:00', '1997-01-15 00:00:00+00:00',
469.                  '1997-02-01 00:00:00+00:00', '1997-02-15 00:00:00+00:00',
470.                  '1997-03-01 00:00:00+00:00', '1997-03-15 00:00:00+00:00',
471.                  '1997-04-01 00:00:00+00:00', '1997-04-15 00:00:00+00:00',
472.                  '1997-05-01 00:00:00+00:00', '1997-05-15 00:00:00+00:00']
473.                 ],
474.                [datetime.timedelta(days=40),
475.                 ['1997-01-01 00:00:00+00:00', '1997-01-05 00:00:00+00:00',
476.                  '1997-01-09 00:00:00+00:00', '1997-01-13 00:00:00+00:00',
477.                  '1997-01-17 00:00:00+00:00', '1997-01-21 00:00:00+00:00',
478.                  '1997-01-25 00:00:00+00:00', '1997-01-29 00:00:00+00:00',
479.                  '1997-02-01 00:00:00+00:00', '1997-02-05 00:00:00+00:00',
480.                  '1997-02-09 00:00:00+00:00']
481.                 ],
482.                [datetime.timedelta(hours=40),
483.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 04:00:00+00:00',
484.                  '1997-01-01 08:00:00+00:00', '1997-01-01 12:00:00+00:00',
485.                  '1997-01-01 16:00:00+00:00', '1997-01-01 20:00:00+00:00',
486.                  '1997-01-02 00:00:00+00:00', '1997-01-02 04:00:00+00:00',
487.                  '1997-01-02 08:00:00+00:00', '1997-01-02 12:00:00+00:00',
488.                  '1997-01-02 16:00:00+00:00']
489.                 ],
490.                [datetime.timedelta(minutes=20),
491.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 00:05:00+00:00',
492.                  '1997-01-01 00:10:00+00:00', '1997-01-01 00:15:00+00:00',
493.                  '1997-01-01 00:20:00+00:00']
494.                 ],
495.                [datetime.timedelta(seconds=40),
496.                 ['1997-01-01 00:00:00+00:00', '1997-01-01 00:00:05+00:00',
497.                  '1997-01-01 00:00:10+00:00', '1997-01-01 00:00:15+00:00',
498.                  '1997-01-01 00:00:20+00:00', '1997-01-01 00:00:25+00:00',
499.                  '1997-01-01 00:00:30+00:00', '1997-01-01 00:00:35+00:00',
500.                  '1997-01-01 00:00:40+00:00']


File: lib/matplotlib/tests/test_dates.py
Line number range: 501 - 1202
Content:
501.                 ],
502.                [datetime.timedelta(microseconds=1500),
503.                 ['1996-12-31 23:59:59.999500+00:00',
504.                  '1997-01-01 00:00:00+00:00',
505.                  '1997-01-01 00:00:00.000500+00:00',
506.                  '1997-01-01 00:00:00.001000+00:00',
507.                  '1997-01-01 00:00:00.001500+00:00',
508.                  '1997-01-01 00:00:00.002000+00:00']
509.                 ],
510.                )
511. 
512.     d1 = datetime.datetime(1997, 1, 1)
513.     for t_delta, expected in results:
514.         d2 = d1 + t_delta
515.         locator = _create_auto_date_locator(d1, d2)
516.         assert list(map(str, mdates.num2date(locator()))) == expected
517. 
518. 
519. def test_concise_formatter_subsecond():
520.     locator = mdates.AutoDateLocator(interval_multiples=True)
521.     formatter = mdates.ConciseDateFormatter(locator)
522.     year_1996 = 9861.0
523.     strings = formatter.format_ticks([
524.         year_1996,
525.         year_1996 + 500 / mdates.MUSECONDS_PER_DAY,
526.         year_1996 + 900 / mdates.MUSECONDS_PER_DAY])
527.     assert strings == ['00:00', '00.0005', '00.0009']
528. 
529. 
530. def test_concise_formatter():
531.     def _create_auto_date_locator(date1, date2):
532.         fig, ax = plt.subplots()
533. 
534.         locator = mdates.AutoDateLocator(interval_multiples=True)
535.         formatter = mdates.ConciseDateFormatter(locator)
536.         ax.yaxis.set_major_locator(locator)
537.         ax.yaxis.set_major_formatter(formatter)
538.         ax.set_ylim(date1, date2)
539.         fig.canvas.draw()
540.         sts = [st.get_text() for st in ax.get_yticklabels()]
541.         return sts
542. 
543.     d1 = datetime.datetime(1997, 1, 1)
544.     results = ([datetime.timedelta(weeks=52 * 200),
545.                 [str(t) for t in range(1980, 2201, 20)]
546.                 ],
547.                [datetime.timedelta(weeks=52),
548.                 ['1997', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
549.                  'Sep', 'Oct', 'Nov', 'Dec']
550.                 ],
551.                [datetime.timedelta(days=141),
552.                 ['Jan', '15', 'Feb', '15', 'Mar', '15', 'Apr', '15',
553.                  'May', '15']
554.                 ],
555.                [datetime.timedelta(days=40),
556.                 ['Jan', '05', '09', '13', '17', '21', '25', '29', 'Feb',
557.                  '05', '09']
558.                 ],
559.                [datetime.timedelta(hours=40),
560.                 ['Jan-01', '04:00', '08:00', '12:00', '16:00', '20:00',
561.                  'Jan-02', '04:00', '08:00', '12:00', '16:00']
562.                 ],
563.                [datetime.timedelta(minutes=20),
564.                 ['00:00', '00:05', '00:10', '00:15', '00:20']
565.                 ],
566.                [datetime.timedelta(seconds=40),
567.                 ['00:00', '05', '10', '15', '20', '25', '30', '35', '40']
568.                 ],
569.                [datetime.timedelta(seconds=2),
570.                 ['59.5', '00:00', '00.5', '01.0', '01.5', '02.0', '02.5']
571.                 ],
572.                )
573.     for t_delta, expected in results:
574.         d2 = d1 + t_delta
575.         strings = _create_auto_date_locator(d1, d2)
576.         assert strings == expected
577. 
578. 
579. @pytest.mark.parametrize('t_delta, expected', [
580.     (datetime.timedelta(seconds=0.01), '1997-Jan-01 00:00'),
581.     (datetime.timedelta(minutes=1), '1997-Jan-01 00:01'),
582.     (datetime.timedelta(hours=1), '1997-Jan-01'),
583.     (datetime.timedelta(days=1), '1997-Jan-02'),
584.     (datetime.timedelta(weeks=1), '1997-Jan'),
585.     (datetime.timedelta(weeks=26), ''),
586.     (datetime.timedelta(weeks=520), '')
587. ])
588. def test_concise_formatter_show_offset(t_delta, expected):
589.     d1 = datetime.datetime(1997, 1, 1)
590.     d2 = d1 + t_delta
591. 
592.     fig, ax = plt.subplots()
593.     locator = mdates.AutoDateLocator()
594.     formatter = mdates.ConciseDateFormatter(locator)
595.     ax.xaxis.set_major_locator(locator)
596.     ax.xaxis.set_major_formatter(formatter)
597. 
598.     ax.plot([d1, d2], [0, 0])
599.     fig.canvas.draw()
600.     assert formatter.get_offset() == expected
601. 
602. 
603. @pytest.mark.parametrize('t_delta, expected', [
604.     (datetime.timedelta(weeks=52 * 200),
605.      ['$\\mathdefault{%d}$' % (t, ) for t in range(1980, 2201, 20)]),
606.     (datetime.timedelta(days=40),
607.      ['Jan', '$\\mathdefault{05}$', '$\\mathdefault{09}$',
608.       '$\\mathdefault{13}$', '$\\mathdefault{17}$', '$\\mathdefault{21}$',
609.       '$\\mathdefault{25}$', '$\\mathdefault{29}$', 'Feb',
610.       '$\\mathdefault{05}$', '$\\mathdefault{09}$']),
611.     (datetime.timedelta(hours=40),
612.      ['Jan$\\mathdefault{{-}01}$', '$\\mathdefault{04:00}$',
613.       '$\\mathdefault{08:00}$', '$\\mathdefault{12:00}$',
614.       '$\\mathdefault{16:00}$', '$\\mathdefault{20:00}$',
615.       'Jan$\\mathdefault{{-}02}$', '$\\mathdefault{04:00}$',
616.       '$\\mathdefault{08:00}$', '$\\mathdefault{12:00}$',
617.       '$\\mathdefault{16:00}$']),
618.     (datetime.timedelta(seconds=2),
619.      ['$\\mathdefault{59.5}$', '$\\mathdefault{00:00}$',
620.       '$\\mathdefault{00.5}$', '$\\mathdefault{01.0}$',
621.       '$\\mathdefault{01.5}$', '$\\mathdefault{02.0}$',
622.       '$\\mathdefault{02.5}$']),
623. ])
624. def test_concise_formatter_usetex(t_delta, expected):
625.     d1 = datetime.datetime(1997, 1, 1)
626.     d2 = d1 + t_delta
627. 
628.     locator = mdates.AutoDateLocator(interval_multiples=True)
629.     locator.create_dummy_axis()
630.     locator.axis.set_view_interval(mdates.date2num(d1), mdates.date2num(d2))
631. 
632.     formatter = mdates.ConciseDateFormatter(locator, usetex=True)
633.     assert formatter.format_ticks(locator()) == expected
634. 
635. 
636. def test_concise_formatter_formats():
637.     formats = ['%Y', '%m/%Y', 'day: %d',
638.                '%H hr %M min', '%H hr %M min', '%S.%f sec']
639. 
640.     def _create_auto_date_locator(date1, date2):
641.         fig, ax = plt.subplots()
642. 
643.         locator = mdates.AutoDateLocator(interval_multiples=True)
644.         formatter = mdates.ConciseDateFormatter(locator, formats=formats)
645.         ax.yaxis.set_major_locator(locator)
646.         ax.yaxis.set_major_formatter(formatter)
647.         ax.set_ylim(date1, date2)
648.         fig.canvas.draw()
649.         sts = [st.get_text() for st in ax.get_yticklabels()]
650.         return sts
651. 
652.     d1 = datetime.datetime(1997, 1, 1)
653.     results = (
654.         [datetime.timedelta(weeks=52 * 200), [str(t) for t in range(1980,
655.          2201, 20)]],
656.         [datetime.timedelta(weeks=52), [
657.             '1997', '02/1997', '03/1997', '04/1997', '05/1997', '06/1997',
658.             '07/1997', '08/1997', '09/1997', '10/1997', '11/1997', '12/1997',
659.             ]],
660.         [datetime.timedelta(days=141), [
661.             '01/1997', 'day: 15', '02/1997', 'day: 15', '03/1997', 'day: 15',
662.             '04/1997', 'day: 15', '05/1997', 'day: 15',
663.             ]],
664.         [datetime.timedelta(days=40), [
665.             '01/1997', 'day: 05', 'day: 09', 'day: 13', 'day: 17', 'day: 21',
666.             'day: 25', 'day: 29', '02/1997', 'day: 05', 'day: 09',
667.             ]],
668.         [datetime.timedelta(hours=40), [
669.             'day: 01', '04 hr 00 min', '08 hr 00 min', '12 hr 00 min',
670.             '16 hr 00 min', '20 hr 00 min', 'day: 02', '04 hr 00 min',
671.             '08 hr 00 min', '12 hr 00 min', '16 hr 00 min',
672.             ]],
673.         [datetime.timedelta(minutes=20), ['00 hr 00 min', '00 hr 05 min',
674.          '00 hr 10 min', '00 hr 15 min', '00 hr 20 min']],
675.         [datetime.timedelta(seconds=40), [
676.             '00 hr 00 min', '05.000000 sec', '10.000000 sec',
677.             '15.000000 sec', '20.000000 sec', '25.000000 sec',
678.             '30.000000 sec', '35.000000 sec', '40.000000 sec',
679.             ]],
680.         [datetime.timedelta(seconds=2), [
681.             '59.500000 sec', '00 hr 00 min', '00.500000 sec', '01.000000 sec',
682.             '01.500000 sec', '02.000000 sec', '02.500000 sec',
683.             ]],
684.         )
685.     for t_delta, expected in results:
686.         d2 = d1 + t_delta
687.         strings = _create_auto_date_locator(d1, d2)
688.         assert strings == expected
689. 
690. 
691. def test_concise_formatter_zformats():
692.     zero_formats = ['', "'%y", '%B', '%m-%d', '%S', '%S.%f']
693. 
694.     def _create_auto_date_locator(date1, date2):
695.         fig, ax = plt.subplots()
696. 
697.         locator = mdates.AutoDateLocator(interval_multiples=True)
698.         formatter = mdates.ConciseDateFormatter(
699.             locator, zero_formats=zero_formats)
700.         ax.yaxis.set_major_locator(locator)
701.         ax.yaxis.set_major_formatter(formatter)
702.         ax.set_ylim(date1, date2)
703.         fig.canvas.draw()
704.         sts = [st.get_text() for st in ax.get_yticklabels()]
705.         return sts
706. 
707.     d1 = datetime.datetime(1997, 1, 1)
708.     results = ([datetime.timedelta(weeks=52 * 200),
709.                 [str(t) for t in range(1980, 2201, 20)]
710.                 ],
711.                [datetime.timedelta(weeks=52),
712.                 ["'97", 'Feb', 'Mar', 'Apr', 'May', 'Jun',
713.                     'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
714.                 ],
715.                [datetime.timedelta(days=141),
716.                 ['January', '15', 'February', '15', 'March',
717.                     '15', 'April', '15', 'May', '15']
718.                 ],
719.                [datetime.timedelta(days=40),
720.                 ['January', '05', '09', '13', '17', '21',
721.                     '25', '29', 'February', '05', '09']
722.                 ],
723.                [datetime.timedelta(hours=40),
724.                 ['01-01', '04:00', '08:00', '12:00', '16:00', '20:00',
725.                     '01-02', '04:00', '08:00', '12:00', '16:00']
726.                 ],
727.                [datetime.timedelta(minutes=20),
728.                 ['00', '00:05', '00:10', '00:15', '00:20']
729.                 ],
730.                [datetime.timedelta(seconds=40),
731.                 ['00', '05', '10', '15', '20', '25', '30', '35', '40']
732.                 ],
733.                [datetime.timedelta(seconds=2),
734.                 ['59.5', '00.0', '00.5', '01.0', '01.5', '02.0', '02.5']
735.                 ],
736.                )
737.     for t_delta, expected in results:
738.         d2 = d1 + t_delta
739.         strings = _create_auto_date_locator(d1, d2)
740.         assert strings == expected
741. 
742. 
743. def test_concise_formatter_tz():
744.     def _create_auto_date_locator(date1, date2, tz):
745.         fig, ax = plt.subplots()
746. 
747.         locator = mdates.AutoDateLocator(interval_multiples=True)
748.         formatter = mdates.ConciseDateFormatter(locator, tz=tz)
749.         ax.yaxis.set_major_locator(locator)
750.         ax.yaxis.set_major_formatter(formatter)
751.         ax.set_ylim(date1, date2)
752.         fig.canvas.draw()
753.         sts = [st.get_text() for st in ax.get_yticklabels()]
754.         return sts, ax.yaxis.get_offset_text().get_text()
755. 
756.     d1 = datetime.datetime(1997, 1, 1).replace(tzinfo=datetime.timezone.utc)
757.     results = ([datetime.timedelta(hours=40),
758.                 ['03:00', '07:00', '11:00', '15:00', '19:00', '23:00',
759.                  '03:00', '07:00', '11:00', '15:00', '19:00'],
760.                 "1997-Jan-02"
761.                 ],
762.                [datetime.timedelta(minutes=20),
763.                 ['03:00', '03:05', '03:10', '03:15', '03:20'],
764.                 "1997-Jan-01"
765.                 ],
766.                [datetime.timedelta(seconds=40),
767.                 ['03:00', '05', '10', '15', '20', '25', '30', '35', '40'],
768.                 "1997-Jan-01 03:00"
769.                 ],
770.                [datetime.timedelta(seconds=2),
771.                 ['59.5', '03:00', '00.5', '01.0', '01.5', '02.0', '02.5'],
772.                 "1997-Jan-01 03:00"
773.                 ],
774.                )
775. 
776.     new_tz = datetime.timezone(datetime.timedelta(hours=3))
777.     for t_delta, expected_strings, expected_offset in results:
778.         d2 = d1 + t_delta
779.         strings, offset = _create_auto_date_locator(d1, d2, new_tz)
780.         assert strings == expected_strings
781.         assert offset == expected_offset
782. 
783. 
784. def test_auto_date_locator_intmult_tz():
785.     def _create_auto_date_locator(date1, date2, tz):
786.         locator = mdates.AutoDateLocator(interval_multiples=True, tz=tz)
787.         locator.create_dummy_axis()
788.         locator.axis.set_view_interval(*mdates.date2num([date1, date2]))
789.         return locator
790. 
791.     results = ([datetime.timedelta(weeks=52*200),
792.                 ['1980-01-01 00:00:00-08:00', '2000-01-01 00:00:00-08:00',
793.                  '2020-01-01 00:00:00-08:00', '2040-01-01 00:00:00-08:00',
794.                  '2060-01-01 00:00:00-08:00', '2080-01-01 00:00:00-08:00',
795.                  '2100-01-01 00:00:00-08:00', '2120-01-01 00:00:00-08:00',
796.                  '2140-01-01 00:00:00-08:00', '2160-01-01 00:00:00-08:00',
797.                  '2180-01-01 00:00:00-08:00', '2200-01-01 00:00:00-08:00']
798.                 ],
799.                [datetime.timedelta(weeks=52),
800.                 ['1997-01-01 00:00:00-08:00', '1997-02-01 00:00:00-08:00',
801.                  '1997-03-01 00:00:00-08:00', '1997-04-01 00:00:00-08:00',
802.                  '1997-05-01 00:00:00-07:00', '1997-06-01 00:00:00-07:00',
803.                  '1997-07-01 00:00:00-07:00', '1997-08-01 00:00:00-07:00',
804.                  '1997-09-01 00:00:00-07:00', '1997-10-01 00:00:00-07:00',
805.                  '1997-11-01 00:00:00-08:00', '1997-12-01 00:00:00-08:00']
806.                 ],
807.                [datetime.timedelta(days=141),
808.                 ['1997-01-01 00:00:00-08:00', '1997-01-15 00:00:00-08:00',
809.                  '1997-02-01 00:00:00-08:00', '1997-02-15 00:00:00-08:00',
810.                  '1997-03-01 00:00:00-08:00', '1997-03-15 00:00:00-08:00',
811.                  '1997-04-01 00:00:00-08:00', '1997-04-15 00:00:00-07:00',
812.                  '1997-05-01 00:00:00-07:00', '1997-05-15 00:00:00-07:00']
813.                 ],
814.                [datetime.timedelta(days=40),
815.                 ['1997-01-01 00:00:00-08:00', '1997-01-05 00:00:00-08:00',
816.                  '1997-01-09 00:00:00-08:00', '1997-01-13 00:00:00-08:00',
817.                  '1997-01-17 00:00:00-08:00', '1997-01-21 00:00:00-08:00',
818.                  '1997-01-25 00:00:00-08:00', '1997-01-29 00:00:00-08:00',
819.                  '1997-02-01 00:00:00-08:00', '1997-02-05 00:00:00-08:00',
820.                  '1997-02-09 00:00:00-08:00']
821.                 ],
822.                [datetime.timedelta(hours=40),
823.                 ['1997-01-01 00:00:00-08:00', '1997-01-01 04:00:00-08:00',
824.                  '1997-01-01 08:00:00-08:00', '1997-01-01 12:00:00-08:00',
825.                  '1997-01-01 16:00:00-08:00', '1997-01-01 20:00:00-08:00',
826.                  '1997-01-02 00:00:00-08:00', '1997-01-02 04:00:00-08:00',
827.                  '1997-01-02 08:00:00-08:00', '1997-01-02 12:00:00-08:00',
828.                  '1997-01-02 16:00:00-08:00']
829.                 ],
830.                [datetime.timedelta(minutes=20),
831.                 ['1997-01-01 00:00:00-08:00', '1997-01-01 00:05:00-08:00',
832.                  '1997-01-01 00:10:00-08:00', '1997-01-01 00:15:00-08:00',
833.                  '1997-01-01 00:20:00-08:00']
834.                 ],
835.                [datetime.timedelta(seconds=40),
836.                 ['1997-01-01 00:00:00-08:00', '1997-01-01 00:00:05-08:00',
837.                  '1997-01-01 00:00:10-08:00', '1997-01-01 00:00:15-08:00',
838.                  '1997-01-01 00:00:20-08:00', '1997-01-01 00:00:25-08:00',
839.                  '1997-01-01 00:00:30-08:00', '1997-01-01 00:00:35-08:00',
840.                  '1997-01-01 00:00:40-08:00']
841.                 ]
842.                )
843. 
844.     tz = dateutil.tz.gettz('Canada/Pacific')
845.     d1 = datetime.datetime(1997, 1, 1, tzinfo=tz)
846.     for t_delta, expected in results:
847.         with rc_context({'_internal.classic_mode': False}):
848.             d2 = d1 + t_delta
849.             locator = _create_auto_date_locator(d1, d2, tz)
850.             st = list(map(str, mdates.num2date(locator(), tz=tz)))
851.             assert st == expected
852. 
853. 
854. @image_comparison(['date_inverted_limit.png'])
855. def test_date_inverted_limit():
856.     # test ax hline with date inputs
857.     t0 = datetime.datetime(2009, 1, 20)
858.     tf = datetime.datetime(2009, 1, 31)
859.     fig, ax = plt.subplots()
860.     ax.axhline(t0, color="blue", lw=3)
861.     ax.set_ylim(t0 - datetime.timedelta(days=5),
862.                 tf + datetime.timedelta(days=5))
863.     ax.invert_yaxis()
864.     fig.subplots_adjust(left=0.25)
865. 
866. 
867. def _test_date2num_dst(date_range, tz_convert):
868.     # Timezones
869. 
870.     BRUSSELS = dateutil.tz.gettz('Europe/Brussels')
871.     UTC = mdates.UTC
872. 
873.     # Create a list of timezone-aware datetime objects in UTC
874.     # Interval is 0b0.0000011 days, to prevent float rounding issues
875.     dtstart = datetime.datetime(2014, 3, 30, 0, 0, tzinfo=UTC)
876.     interval = datetime.timedelta(minutes=33, seconds=45)
877.     interval_days = 0.0234375   # 2025 / 86400 seconds
878.     N = 8
879. 
880.     dt_utc = date_range(start=dtstart, freq=interval, periods=N)
881.     dt_bxl = tz_convert(dt_utc, BRUSSELS)
882.     t0 = 735322.0 + mdates.date2num(np.datetime64('0000-12-31'))
883.     expected_ordinalf = [t0 + (i * interval_days) for i in range(N)]
884.     actual_ordinalf = list(mdates.date2num(dt_bxl))
885. 
886.     assert actual_ordinalf == expected_ordinalf
887. 
888. 
889. def test_date2num_dst():
890.     # Test for github issue #3896, but in date2num around DST transitions
891.     # with a timezone-aware pandas date_range object.
892. 
893.     class dt_tzaware(datetime.datetime):
894.         """
895.         This bug specifically occurs because of the normalization behavior of
896.         pandas Timestamp objects, so in order to replicate it, we need a
897.         datetime-like object that applies timezone normalization after
898.         subtraction.
899.         """
900. 
901.         def __sub__(self, other):
902.             r = super().__sub__(other)
903.             tzinfo = getattr(r, 'tzinfo', None)
904. 
905.             if tzinfo is not None:
906.                 localizer = getattr(tzinfo, 'normalize', None)
907.                 if localizer is not None:
908.                     r = tzinfo.normalize(r)
909. 
910.             if isinstance(r, datetime.datetime):
911.                 r = self.mk_tzaware(r)
912. 
913.             return r
914. 
915.         def __add__(self, other):
916.             return self.mk_tzaware(super().__add__(other))
917. 
918.         def astimezone(self, tzinfo):
919.             dt = super().astimezone(tzinfo)
920.             return self.mk_tzaware(dt)
921. 
922.         @classmethod
923.         def mk_tzaware(cls, datetime_obj):
924.             kwargs = {}
925.             attrs = ('year',
926.                      'month',
927.                      'day',
928.                      'hour',
929.                      'minute',
930.                      'second',
931.                      'microsecond',
932.                      'tzinfo')
933. 
934.             for attr in attrs:
935.                 val = getattr(datetime_obj, attr, None)
936.                 if val is not None:
937.                     kwargs[attr] = val
938. 
939.             return cls(**kwargs)
940. 
941.     # Define a date_range function similar to pandas.date_range
942.     def date_range(start, freq, periods):
943.         dtstart = dt_tzaware.mk_tzaware(start)
944. 
945.         return [dtstart + (i * freq) for i in range(periods)]
946. 
947.     # Define a tz_convert function that converts a list to a new time zone.
948.     def tz_convert(dt_list, tzinfo):
949.         return [d.astimezone(tzinfo) for d in dt_list]
950. 
951.     _test_date2num_dst(date_range, tz_convert)
952. 
953. 
954. def test_date2num_dst_pandas(pd):
955.     # Test for github issue #3896, but in date2num around DST transitions
956.     # with a timezone-aware pandas date_range object.
957. 
958.     def tz_convert(*args):
959.         return pd.DatetimeIndex.tz_convert(*args).astype(object)
960. 
961.     _test_date2num_dst(pd.date_range, tz_convert)
962. 
963. 
964. def _test_rrulewrapper(attach_tz, get_tz):
965.     SYD = get_tz('Australia/Sydney')
966. 
967.     dtstart = attach_tz(datetime.datetime(2017, 4, 1, 0), SYD)
968.     dtend = attach_tz(datetime.datetime(2017, 4, 4, 0), SYD)
969. 
970.     rule = mdates.rrulewrapper(freq=dateutil.rrule.DAILY, dtstart=dtstart)
971. 
972.     act = rule.between(dtstart, dtend)
973.     exp = [datetime.datetime(2017, 4, 1, 13, tzinfo=dateutil.tz.tzutc()),
974.            datetime.datetime(2017, 4, 2, 14, tzinfo=dateutil.tz.tzutc())]
975. 
976.     assert act == exp
977. 
978. 
979. def test_rrulewrapper():
980.     def attach_tz(dt, zi):
981.         return dt.replace(tzinfo=zi)
982. 
983.     _test_rrulewrapper(attach_tz, dateutil.tz.gettz)
984. 
985. 
986. @pytest.mark.pytz
987. def test_rrulewrapper_pytz():
988.     # Test to make sure pytz zones are supported in rrules
989.     pytz = pytest.importorskip("pytz")
990. 
991.     def attach_tz(dt, zi):
992.         return zi.localize(dt)
993. 
994.     _test_rrulewrapper(attach_tz, pytz.timezone)
995. 
996. 
997. @pytest.mark.pytz
998. def test_yearlocator_pytz():
999.     pytz = pytest.importorskip("pytz")
1000. 
1001.     tz = pytz.timezone('America/New_York')
1002.     x = [tz.localize(datetime.datetime(2010, 1, 1))
1003.          + datetime.timedelta(i) for i in range(2000)]
1004.     locator = mdates.AutoDateLocator(interval_multiples=True, tz=tz)
1005.     locator.create_dummy_axis()
1006.     locator.axis.set_view_interval(mdates.date2num(x[0])-1.0,
1007.                                    mdates.date2num(x[-1])+1.0)
1008.     t = np.array([733408.208333, 733773.208333, 734138.208333,
1009.                   734503.208333, 734869.208333, 735234.208333, 735599.208333])
1010.     # convert to new epoch from old...
1011.     t = t + mdates.date2num(np.datetime64('0000-12-31'))
1012.     np.testing.assert_allclose(t, locator())
1013.     expected = ['2009-01-01 00:00:00-05:00',
1014.                 '2010-01-01 00:00:00-05:00', '2011-01-01 00:00:00-05:00',
1015.                 '2012-01-01 00:00:00-05:00', '2013-01-01 00:00:00-05:00',
1016.                 '2014-01-01 00:00:00-05:00', '2015-01-01 00:00:00-05:00']
1017.     st = list(map(str, mdates.num2date(locator(), tz=tz)))
1018.     assert st == expected
1019. 
1020. 
1021. def test_YearLocator():
1022.     def _create_year_locator(date1, date2, **kwargs):
1023.         locator = mdates.YearLocator(**kwargs)
1024.         locator.create_dummy_axis()
1025.         locator.axis.set_view_interval(mdates.date2num(date1),
1026.                                        mdates.date2num(date2))
1027.         return locator
1028. 
1029.     d1 = datetime.datetime(1990, 1, 1)
1030.     results = ([datetime.timedelta(weeks=52 * 200),
1031.                 {'base': 20, 'month': 1, 'day': 1},
1032.                 ['1980-01-01 00:00:00+00:00', '2000-01-01 00:00:00+00:00',
1033.                  '2020-01-01 00:00:00+00:00', '2040-01-01 00:00:00+00:00',
1034.                  '2060-01-01 00:00:00+00:00', '2080-01-01 00:00:00+00:00',
1035.                  '2100-01-01 00:00:00+00:00', '2120-01-01 00:00:00+00:00',
1036.                  '2140-01-01 00:00:00+00:00', '2160-01-01 00:00:00+00:00',
1037.                  '2180-01-01 00:00:00+00:00', '2200-01-01 00:00:00+00:00']
1038.                 ],
1039.                [datetime.timedelta(weeks=52 * 200),
1040.                 {'base': 20, 'month': 5, 'day': 16},
1041.                 ['1980-05-16 00:00:00+00:00', '2000-05-16 00:00:00+00:00',
1042.                  '2020-05-16 00:00:00+00:00', '2040-05-16 00:00:00+00:00',
1043.                  '2060-05-16 00:00:00+00:00', '2080-05-16 00:00:00+00:00',
1044.                  '2100-05-16 00:00:00+00:00', '2120-05-16 00:00:00+00:00',
1045.                  '2140-05-16 00:00:00+00:00', '2160-05-16 00:00:00+00:00',
1046.                  '2180-05-16 00:00:00+00:00', '2200-05-16 00:00:00+00:00']
1047.                 ],
1048.                [datetime.timedelta(weeks=52 * 5),
1049.                 {'base': 20, 'month': 9, 'day': 25},
1050.                 ['1980-09-25 00:00:00+00:00', '2000-09-25 00:00:00+00:00']
1051.                 ],
1052.                )
1053. 
1054.     for delta, arguments, expected in results:
1055.         d2 = d1 + delta
1056.         locator = _create_year_locator(d1, d2, **arguments)
1057.         assert list(map(str, mdates.num2date(locator()))) == expected
1058. 
1059. 
1060. def test_DayLocator():
1061.     with pytest.raises(ValueError):
1062.         mdates.DayLocator(interval=-1)
1063.     with pytest.raises(ValueError):
1064.         mdates.DayLocator(interval=-1.5)
1065.     with pytest.raises(ValueError):
1066.         mdates.DayLocator(interval=0)
1067.     with pytest.raises(ValueError):
1068.         mdates.DayLocator(interval=1.3)
1069.     mdates.DayLocator(interval=1.0)
1070. 
1071. 
1072. def test_tz_utc():
1073.     dt = datetime.datetime(1970, 1, 1, tzinfo=mdates.UTC)
1074.     dt.tzname()
1075. 
1076. 
1077. @pytest.mark.parametrize("x, tdelta",
1078.                          [(1, datetime.timedelta(days=1)),
1079.                           ([1, 1.5], [datetime.timedelta(days=1),
1080.                                       datetime.timedelta(days=1.5)])])
1081. def test_num2timedelta(x, tdelta):
1082.     dt = mdates.num2timedelta(x)
1083.     assert dt == tdelta
1084. 
1085. 
1086. def test_datetime64_in_list():
1087.     dt = [np.datetime64('2000-01-01'), np.datetime64('2001-01-01')]
1088.     dn = mdates.date2num(dt)
1089.     # convert fixed values from old to new epoch
1090.     t = (np.array([730120.,  730486.]) +
1091.          mdates.date2num(np.datetime64('0000-12-31')))
1092.     np.testing.assert_equal(dn, t)
1093. 
1094. 
1095. def test_change_epoch():
1096.     date = np.datetime64('2000-01-01')
1097. 
1098.     # use private method to clear the epoch and allow it to be set...
1099.     mdates._reset_epoch_test_example()
1100.     mdates.get_epoch()  # Set default.
1101. 
1102.     with pytest.raises(RuntimeError):
1103.         # this should fail here because there is a sentinel on the epoch
1104.         # if the epoch has been used then it cannot be set.
1105.         mdates.set_epoch('0000-01-01')
1106. 
1107.     mdates._reset_epoch_test_example()
1108.     mdates.set_epoch('1970-01-01')
1109.     dt = (date - np.datetime64('1970-01-01')).astype('datetime64[D]')
1110.     dt = dt.astype('int')
1111.     np.testing.assert_equal(mdates.date2num(date), float(dt))
1112. 
1113.     mdates._reset_epoch_test_example()
1114.     mdates.set_epoch('0000-12-31')
1115.     np.testing.assert_equal(mdates.date2num(date), 730120.0)
1116. 
1117.     mdates._reset_epoch_test_example()
1118.     mdates.set_epoch('1970-01-01T01:00:00')
1119.     np.testing.assert_allclose(mdates.date2num(date), dt - 1./24.)
1120.     mdates._reset_epoch_test_example()
1121.     mdates.set_epoch('1970-01-01T00:00:00')
1122.     np.testing.assert_allclose(
1123.         mdates.date2num(np.datetime64('1970-01-01T12:00:00')),
1124.         0.5)
1125. 
1126. 
1127. def test_warn_notintervals():
1128.     dates = np.arange('2001-01-10', '2001-03-04', dtype='datetime64[D]')
1129.     locator = mdates.AutoDateLocator(interval_multiples=False)
1130.     locator.intervald[3] = [2]
1131.     locator.create_dummy_axis()
1132.     locator.axis.set_view_interval(mdates.date2num(dates[0]),
1133.                                    mdates.date2num(dates[-1]))
1134.     with pytest.warns(UserWarning, match="AutoDateLocator was unable") as rec:
1135.         locs = locator()
1136. 
1137. 
1138. def test_change_converter():
1139.     plt.rcParams['date.converter'] = 'concise'
1140.     dates = np.arange('2020-01-01', '2020-05-01', dtype='datetime64[D]')
1141.     fig, ax = plt.subplots()
1142. 
1143.     ax.plot(dates, np.arange(len(dates)))
1144.     fig.canvas.draw()
1145.     assert ax.get_xticklabels()[0].get_text() == 'Jan'
1146.     assert ax.get_xticklabels()[1].get_text() == '15'
1147. 
1148.     plt.rcParams['date.converter'] = 'auto'
1149.     fig, ax = plt.subplots()
1150. 
1151.     ax.plot(dates, np.arange(len(dates)))
1152.     fig.canvas.draw()
1153.     assert ax.get_xticklabels()[0].get_text() == 'Jan 01 2020'
1154.     assert ax.get_xticklabels()[1].get_text() == 'Jan 15 2020'
1155.     with pytest.raises(ValueError):
1156.         plt.rcParams['date.converter'] = 'boo'
1157. 
1158. 
1159. def test_change_interval_multiples():
1160.     plt.rcParams['date.interval_multiples'] = False
1161.     dates = np.arange('2020-01-10', '2020-05-01', dtype='datetime64[D]')
1162.     fig, ax = plt.subplots()
1163. 
1164.     ax.plot(dates, np.arange(len(dates)))
1165.     fig.canvas.draw()
1166.     assert ax.get_xticklabels()[0].get_text() == 'Jan 10 2020'
1167.     assert ax.get_xticklabels()[1].get_text() == 'Jan 24 2020'
1168. 
1169.     plt.rcParams['date.interval_multiples'] = 'True'
1170.     fig, ax = plt.subplots()
1171. 
1172.     ax.plot(dates, np.arange(len(dates)))
1173.     fig.canvas.draw()
1174.     assert ax.get_xticklabels()[0].get_text() == 'Jan 15 2020'
1175.     assert ax.get_xticklabels()[1].get_text() == 'Feb 01 2020'
1176. 
1177. 
1178. def test_epoch2num():
1179.     with _api.suppress_matplotlib_deprecation_warning():
1180.         mdates._reset_epoch_test_example()
1181.         mdates.set_epoch('0000-12-31')
1182.         assert mdates.epoch2num(86400) == 719164.0
1183.         assert mdates.num2epoch(719165.0) == 86400 * 2
1184.         # set back to the default
1185.         mdates._reset_epoch_test_example()
1186.         mdates.set_epoch('1970-01-01T00:00:00')
1187.         assert mdates.epoch2num(86400) == 1.0
1188.         assert mdates.num2epoch(2.0) == 86400 * 2
1189. 
1190. 
1191. def test_julian2num():
1192.     mdates._reset_epoch_test_example()
1193.     mdates.set_epoch('0000-12-31')
1194.     # 2440587.5 is julian date for 1970-01-01T00:00:00
1195.     # https://en.wikipedia.org/wiki/Julian_day
1196.     assert mdates.julian2num(2440588.5) == 719164.0
1197.     assert mdates.num2julian(719165.0) == 2440589.5
1198.     # set back to the default
1199.     mdates._reset_epoch_test_example()
1200.     mdates.set_epoch('1970-01-01T00:00:00')
1201.     assert mdates.julian2num(2440588.5) == 1.0
1202.     assert mdates.num2julian(2.0) == 2440589.5

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 23:25:02,824 - thread-136502599202496.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='I have the complete content of `lib/matplotlib/tests/test_dates.py`. This file contains test cases related to date formatting, including tests that specifically use `usetex=True`. I have identified two such tests (`test_date_formatter_usetex` and `test_concise_formatter_usetex`) that check the string output of date formatters with `usetex`. I have also found image comparison tests that, while not using `usetex`, demonstrate how to test the visual output of date-based plots. This is sufficient to select three relevant test cases as requested by the user.' query='' extra_requirements='' purpose=''
2025-12-23 23:25:02,826 - thread-136502599202496.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
