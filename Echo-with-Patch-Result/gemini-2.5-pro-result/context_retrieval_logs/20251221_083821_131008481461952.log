2025-12-21 08:38:21,260 - thread-131008481461952.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: [ENH]: Add get/set_antialiased to Text objects

Description: ### Problem

Currently, Text objects always retrieve their antialiasing state via the global rcParams["text.antialias"], unlike other artists for which this can be configured on a per-artist basis via `set_antialiased` (and read via `set_antialiased`).

### Proposed solution

Add similar getters/setters on Text objects (also adjusting Annotations accordingly, if needed) and use that info in the drawing stage.

Should be relatively easy to implement, except that the slight fiddling needed with backends requires some understanding of backend code (I think we need to replace the access to `rcParams["text.antialiased"]` by going through the GraphicsContext state).

Patch information:
diff --git a/lib/matplotlib/backends/backend_agg.py b/lib/matplotlib/backends/backend_agg.py
index 7d038a998f..1e43736fd9 100644
--- a/lib/matplotlib/backends/backend_agg.py
+++ b/lib/matplotlib/backends/backend_agg.py
@@ -206,7 +206,7 @@ class RendererAgg(RendererBase):
         # space) in the following call to draw_text_image).
         font.set_text(s, 0, flags=get_hinting_flag())
         font.draw_glyphs_to_bitmap(
-            antialiased=mpl.rcParams['text.antialiased'])
+            antialiased=bool(gc.get_antialiased()))
         d = font.get_descent() / 64.0
         # The descent needs to be adjusted for the angle.
         xo, yo = font.get_bitmap_offset()
diff --git a/lib/matplotlib/backends/backend_cairo.py b/lib/matplotlib/backends/backend_cairo.py
index 9ccadcdf1c..7f1888b4dd 100644
--- a/lib/matplotlib/backends/backend_cairo.py
+++ b/lib/matplotlib/backends/backend_cairo.py
@@ -205,7 +205,7 @@ class RendererCairo(RendererBase):
             ctx.set_font_size(self.points_to_pixels(prop.get_size_in_points()))
             opts = cairo.FontOptions()
             opts.set_antialias(
-                cairo.ANTIALIAS_DEFAULT if mpl.rcParams["text.antialiased"]
+                cairo.ANTIALIAS_DEFAULT if gc.get_antialiased()
                 else cairo.ANTIALIAS_NONE)
             ctx.set_font_options(opts)
             if angle:
diff --git a/lib/matplotlib/text.py b/lib/matplotlib/text.py
index 4591316cf9..285d06960f 100644
--- a/lib/matplotlib/text.py
+++ b/lib/matplotlib/text.py
@@ -167,6 +167,7 @@ class Text(Artist):
         transform_rotates_text=False,
         linespacing=None,
         rotation_mode=None,
+        antialiased=None,
     ):
         self.set_text(text)
         self.set_color(
@@ -187,6 +188,7 @@ class Text(Artist):
             linespacing = 1.2  # Maybe use rcParam later.
         self.set_linespacing(linespacing)
         self.set_rotation_mode(rotation_mode)
+        self.set_antialiased(antialiased)
 
     def update(self, kwargs):
         # docstring inherited
@@ -309,6 +311,24 @@ class Text(Artist):
         """Return the text rotation mode."""
         return self._rotation_mode
 
+    def get_antialiased(self):
+        """Return whether antialiasing is used for drawing text."""
+        return self._antialiased
+
+    def set_antialiased(self, aa):
+        """
+        Set whether to use antialiased rendering for this text.
+
+        Parameters
+        ----------
+        aa : bool or None
+            If None, defaults to rcParams['text.antialiased'].
+        """
+        if aa is None:
+            aa = mpl.rcParams['text.antialiased']
+        self._antialiased = aa
+        self.stale = True
+
     def update_from(self, other):
         # docstring inherited
         super().update_from(other)
@@ -736,6 +756,7 @@ class Text(Artist):
             gc = renderer.new_gc()
             gc.set_foreground(self.get_color())
             gc.set_alpha(self.get_alpha())
+            gc.set_antialiased(self.get_antialiased())
             gc.set_url(self._url)
             self._set_gc_clip(gc)
 


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

2025-12-21 08:38:21,333 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── good-first-issue.yml
|       ├── mypy-stubtest.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       ├── stale.yml
|       └── tests.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   ├── codespell-ignore-words.txt
|   ├── export_sdist_name.py
|   └── mypy-stubtest-allowlist.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24531-DOS.rst
|   |   |   |   ├── 24661-AAMW.rst
|   |   |   |   ├── 25044-YI.rst
|   |   |   |   ├── 25061-DS.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25112-GG.rst
|   |   |   |   ├── 25192-DS.rst
|   |   |   |   ├── 25255-RR.rst
|   |   |   |   ├── 25456-AL.rst
|   |   |   |   └── 25697-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23200-OG.rst
|   |   |   |   ├── 24312-AL.rst
|   |   |   |   ├── 24913-AL.rst
|   |   |   |   ├── 24985-OG.rst
|   |   |   |   ├── 24990-OG.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25138-AL.rst
|   |   |   |   ├── 25282-AL.rst
|   |   |   |   ├── 25352-GL.rst
|   |   |   |   ├── 25427-AL.rst
|   |   |   |   ├── 25469-AL.rst
|   |   |   |   ├── 25484-AL.rst
|   |   |   |   ├── 25557-AL.rst
|   |   |   |   ├── 25559-AL.rst
|   |   |   |   ├── 25584-KS.rst
|   |   |   |   ├── 25588-KS.rst
|   |   |   |   ├── 25651-REC.rst
|   |   |   |   ├── 25708-AL.rst
|   |   |   |   ├── 25728-OG.rst
|   |   |   |   ├── 25742-ES.rst
|   |   |   |   ├── 25774-AL.rst
|   |   |   |   ├── 25781-AL.rst
|   |   |   |   ├── 25841-AL.rst
|   |   |   |   ├── 25859-ES.rst
|   |   |   |   └── 25889-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24531-DOS.rst
|   |   |   |   ├── 24919-KS.rst
|   |   |   |   ├── 24976-KS.rst
|   |   |   |   └── 25475-ES.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24923-ES.rst
|   |   |       ├── 24984-OG.rst
|   |   |       ├── 24XXX-OG.rst
|   |   |       ├── 25456-AL.rst
|   |   |       ├── 25584-KS.rst
|   |   |       └── 25648-TS.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.6.0.rst
|   |   |   ├── api_changes_3.6.1.rst
|   |   |   ├── api_changes_3.7.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.7.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── typing_api.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plots_shareview.rst
|       |   ├── README.rst
|       |   ├── auto_minor_tick.rst
|       |   ├── ecdf.rst
|       |   ├── get_suptitle.rst
|       |   ├── mathtext_supports_text.rst
|       |   ├── new_color_spec_tuple.rst
|       |   ├── pie_hatch.rst
|       |   ├── pie_shadow_control.rst
|       |   ├── savefig_bbox_layout.rst
|       |   ├── shadow_shade.rst
|       |   ├── spinesproxyset.rst
|       |   ├── tick_labelfont_param.rst
|       |   ├── updated_mathtext.rst
|       |   └── widget_button_styling.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── github_stats_3.6.0.rst
|       |   ├── github_stats_3.6.1.rst
|       |   ├── github_stats_3.6.2.rst
|       |   ├── github_stats_3.6.3.rst
|       |   ├── github_stats_3.7.0.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   ├── whats_new_3.6.0.rst
|       |   └── whats_new_3.7.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── galleries
|   ├── examples
|   |   ├── README.txt
|   |   ├── animation
|   |   |   ├── README.txt
|   |   |   ├── animate_decay.py
|   |   |   ├── animated_histogram.py
|   |   |   ├── animation_demo.py
|   |   |   ├── bayes_update.py
|   |   |   ├── double_pendulum.py
|   |   |   ├── dynamic_image.py
|   |   |   ├── frame_grabbing_sgskip.py
|   |   |   ├── multiple_axes.py
|   |   |   ├── pause_resume.py
|   |   |   ├── rain.py
|   |   |   ├── random_walk.py
|   |   |   ├── simple_anim.py
|   |   |   ├── simple_scatter.py
|   |   |   ├── strip_chart.py
|   |   |   └── unchained.py
|   |   ├── axes_grid1
|   |   |   ├── README.txt
|   |   |   ├── demo_anchored_direction_arrows.py
|   |   |   ├── demo_axes_divider.py
|   |   |   ├── demo_axes_grid.py
|   |   |   ├── demo_axes_grid2.py
|   |   |   ├── demo_axes_hbox_divider.py
|   |   |   ├── demo_axes_rgb.py
|   |   |   ├── demo_colorbar_of_inset_axes.py
|   |   |   ├── demo_colorbar_with_axes_divider.py
|   |   |   ├── demo_colorbar_with_inset_locator.py
|   |   |   ├── demo_edge_colorbar.py
|   |   |   ├── demo_fixed_size_axes.py
|   |   |   ├── demo_imagegrid_aspect.py
|   |   |   ├── inset_locator_demo.py
|   |   |   ├── inset_locator_demo2.py
|   |   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   |   ├── parasite_simple.py
|   |   |   ├── parasite_simple2.py
|   |   |   ├── scatter_hist_locatable_axes.py
|   |   |   ├── simple_anchored_artists.py
|   |   |   ├── simple_axes_divider1.py
|   |   |   ├── simple_axes_divider3.py
|   |   |   ├── simple_axesgrid.py
|   |   |   ├── simple_axesgrid2.py
|   |   |   ├── simple_axisline4.py
|   |   |   └── simple_colorbar.py
|   |   ├── axisartist
|   |   |   ├── README.txt
|   |   |   ├── axis_direction.py
|   |   |   ├── demo_axis_direction.py
|   |   |   ├── demo_axisline_style.py
|   |   |   ├── demo_curvelinear_grid.py
|   |   |   ├── demo_curvelinear_grid2.py
|   |   |   ├── demo_floating_axes.py
|   |   |   ├── demo_floating_axis.py
|   |   |   ├── demo_parasite_axes.py
|   |   |   ├── demo_parasite_axes2.py
|   |   |   ├── demo_ticklabel_alignment.py
|   |   |   ├── demo_ticklabel_direction.py
|   |   |   ├── simple_axis_direction01.py
|   |   |   ├── simple_axis_direction03.py
|   |   |   ├── simple_axis_pad.py
|   |   |   ├── simple_axisartist1.py
|   |   |   ├── simple_axisline.py
|   |   |   └── simple_axisline3.py
|   |   ├── color
|   |   |   ├── README.txt
|   |   |   ├── color_by_yvalue.py
|   |   |   ├── color_cycle_default.py
|   |   |   ├── color_demo.py
|   |   |   ├── colorbar_basics.py
|   |   |   ├── colormap_reference.py
|   |   |   ├── custom_cmap.py
|   |   |   ├── named_colors.py
|   |   |   └── set_alpha.py
|   |   ├── event_handling
|   |   |   ├── README.txt
|   |   |   ├── close_event.py
|   |   |   ├── coords_demo.py
|   |   |   ├── cursor_demo.py
|   |   |   ├── data_browser.py
|   |   |   ├── figure_axes_enter_leave.py
|   |   |   ├── ginput_manual_clabel_sgskip.py
|   |   |   ├── image_slices_viewer.py
|   |   |   ├── keypress_demo.py
|   |   |   ├── lasso_demo.py
|   |   |   ├── legend_picking.py
|   |   |   ├── looking_glass.py
|   |   |   ├── path_editor.py
|   |   |   ├── pick_event_demo.py
|   |   |   ├── pick_event_demo2.py
|   |   |   ├── poly_editor.py
|   |   |   ├── pong_sgskip.py
|   |   |   ├── resample.py
|   |   |   ├── timers.py
|   |   |   ├── trifinder_event_demo.py
|   |   |   ├── viewlims.py
|   |   |   └── zoom_window.py
|   |   ├── images_contours_and_fields
|   |   |   ├── README.txt
|   |   |   ├── affine_image.py
|   |   |   ├── barb_demo.py
|   |   |   ├── barcode_demo.py
|   |   |   ├── colormap_interactive_adjustment.py
|   |   |   ├── colormap_normalizations.py
|   |   |   ├── colormap_normalizations_symlognorm.py
|   |   |   ├── contour_corner_mask.py
|   |   |   ├── contour_demo.py
|   |   |   ├── contour_image.py
|   |   |   ├── contour_label_demo.py
|   |   |   ├── contourf_demo.py
|   |   |   ├── contourf_hatching.py
|   |   |   ├── contourf_log.py
|   |   |   ├── contours_in_optimization_demo.py
|   |   |   ├── demo_bboximage.py
|   |   |   ├── figimage_demo.py
|   |   |   ├── image_annotated_heatmap.py
|   |   |   ├── image_antialiasing.py
|   |   |   ├── image_clip_path.py
|   |   |   ├── image_demo.py
|   |   |   ├── image_masked.py
|   |   |   ├── image_nonuniform.py
|   |   |   ├── image_transparency_blend.py
|   |   |   ├── image_zcoord.py
|   |   |   ├── interpolation_methods.py
|   |   |   ├── irregulardatagrid.py
|   |   |   ├── layer_images.py
|   |   |   ├── matshow.py
|   |   |   ├── multi_image.py
|   |   |   ├── pcolor_demo.py
|   |   |   ├── pcolormesh_grids.py
|   |   |   ├── pcolormesh_levels.py
|   |   |   ├── plot_streamplot.py
|   |   |   ├── quadmesh_demo.py
|   |   |   ├── quiver_demo.py
|   |   |   ├── quiver_simple_demo.py
|   |   |   ├── shading_example.py
|   |   |   ├── specgram_demo.py
|   |   |   ├── spy_demos.py
|   |   |   ├── tricontour_demo.py
|   |   |   ├── tricontour_smooth_delaunay.py
|   |   |   ├── tricontour_smooth_user.py
|   |   |   ├── trigradient_demo.py
|   |   |   ├── triinterp_demo.py
|   |   |   ├── tripcolor_demo.py
|   |   |   ├── triplot_demo.py
|   |   |   └── watermark_image.py
|   |   ├── lines_bars_and_markers
|   |   |   ├── README.txt
|   |   |   ├── bar_colors.py
|   |   |   ├── bar_label_demo.py
|   |   |   ├── bar_stacked.py
|   |   |   ├── barchart.py
|   |   |   ├── barh.py
|   |   |   ├── broken_barh.py
|   |   |   ├── capstyle.py
|   |   |   ├── categorical_variables.py
|   |   |   ├── cohere.py
|   |   |   ├── csd_demo.py
|   |   |   ├── curve_error_band.py
|   |   |   ├── errorbar_limits_simple.py
|   |   |   ├── errorbar_subsample.py
|   |   |   ├── eventcollection_demo.py
|   |   |   ├── eventplot_demo.py
|   |   |   ├── fill.py
|   |   |   ├── fill_between_alpha.py
|   |   |   ├── fill_between_demo.py
|   |   |   ├── fill_betweenx_demo.py
|   |   |   ├── filled_step.py
|   |   |   ├── gradient_bar.py
|   |   |   ├── hat_graph.py
|   |   |   ├── horizontal_barchart_distribution.py
|   |   |   ├── joinstyle.py
|   |   |   ├── line_demo_dash_control.py
|   |   |   ├── lines_with_ticks_demo.py
|   |   |   ├── linestyles.py
|   |   |   ├── marker_reference.py
|   |   |   ├── markevery_demo.py
|   |   |   ├── masked_demo.py
|   |   |   ├── multicolored_line.py
|   |   |   ├── multivariate_marker_plot.py
|   |   |   ├── psd_demo.py
|   |   |   ├── scatter_demo2.py
|   |   |   ├── scatter_hist.py
|   |   |   ├── scatter_masked.py
|   |   |   ├── scatter_star_poly.py
|   |   |   ├── scatter_with_legend.py
|   |   |   ├── simple_plot.py
|   |   |   ├── span_regions.py
|   |   |   ├── spectrum_demo.py
|   |   |   ├── stackplot_demo.py
|   |   |   ├── stairs_demo.py
|   |   |   ├── stem_plot.py
|   |   |   ├── step_demo.py
|   |   |   ├── timeline.py
|   |   |   ├── vline_hline_demo.py
|   |   |   └── xcorr_acorr_demo.py
|   |   ├── misc
|   |   |   ├── README.txt
|   |   |   ├── anchored_artists.py
|   |   |   ├── bbox_intersect.py
|   |   |   ├── contour_manual.py
|   |   |   ├── coords_report.py
|   |   |   ├── custom_projection.py
|   |   |   ├── customize_rc.py
|   |   |   ├── demo_agg_filter.py
|   |   |   ├── demo_ribbon_box.py
|   |   |   ├── fig_x.py
|   |   |   ├── fill_spiral.py
|   |   |   ├── findobj_demo.py
|   |   |   ├── font_indexing.py
|   |   |   ├── ftface_props.py
|   |   |   ├── histogram_path.py
|   |   |   ├── hyperlinks_sgskip.py
|   |   |   ├── image_thumbnail_sgskip.py
|   |   |   ├── keyword_plotting.py
|   |   |   ├── logos2.py
|   |   |   ├── multipage_pdf.py
|   |   |   ├── multiprocess_sgskip.py
|   |   |   ├── packed_bubbles.py
|   |   |   ├── patheffect_demo.py
|   |   |   ├── print_stdout_sgskip.py
|   |   |   ├── rasterization_demo.py
|   |   |   ├── set_and_get.py
|   |   |   ├── svg_filter_line.py
|   |   |   ├── svg_filter_pie.py
|   |   |   ├── table_demo.py
|   |   |   ├── tickedstroke_demo.py
|   |   |   ├── transoffset.py
|   |   |   └── zorder_demo.py
|   |   ├── mplot3d
|   |   |   ├── 2dcollections3d.py
|   |   |   ├── 3d_bars.py
|   |   |   ├── README.txt
|   |   |   ├── bars3d.py
|   |   |   ├── box3d.py
|   |   |   ├── contour3d.py
|   |   |   ├── contour3d_2.py
|   |   |   ├── contour3d_3.py
|   |   |   ├── contourf3d.py
|   |   |   ├── contourf3d_2.py
|   |   |   ├── custom_shaded_3d_surface.py
|   |   |   ├── errorbar3d.py
|   |   |   ├── hist3d.py
|   |   |   ├── lines3d.py
|   |   |   ├── lorenz_attractor.py
|   |   |   ├── mixed_subplots.py
|   |   |   ├── offset.py
|   |   |   ├── pathpatch3d.py
|   |   |   ├── polys3d.py
|   |   |   ├── projections.py
|   |   |   ├── quiver3d.py
|   |   |   ├── rotate_axes3d_sgskip.py
|   |   |   ├── scatter3d.py
|   |   |   ├── stem3d_demo.py
|   |   |   ├── subplot3d.py
|   |   |   ├── surface3d.py
|   |   |   ├── surface3d_2.py
|   |   |   ├── surface3d_3.py
|   |   |   ├── surface3d_radial.py
|   |   |   ├── text3d.py
|   |   |   ├── tricontour3d.py
|   |   |   ├── tricontourf3d.py
|   |   |   ├── trisurf3d.py
|   |   |   ├── trisurf3d_2.py
|   |   |   ├── view_planes_3d.py
|   |   |   ├── voxels.py
|   |   |   ├── voxels_numpy_logo.py
|   |   |   ├── voxels_rgb.py
|   |   |   ├── voxels_torus.py
|   |   |   ├── wire3d.py
|   |   |   ├── wire3d_animation_sgskip.py
|   |   |   └── wire3d_zero_stride.py
|   |   ├── pie_and_polar_charts
|   |   |   ├── README.txt
|   |   |   ├── bar_of_pie.py
|   |   |   ├── nested_pie.py
|   |   |   ├── pie_and_donut_labels.py
|   |   |   ├── pie_features.py
|   |   |   ├── polar_bar.py
|   |   |   ├── polar_demo.py
|   |   |   ├── polar_error_caps.py
|   |   |   ├── polar_legend.py
|   |   |   └── polar_scatter.py
|   |   ├── pyplots
|   |   |   ├── README.txt
|   |   |   ├── axline.py
|   |   |   ├── pyplot_simple.py
|   |   |   ├── pyplot_text.py
|   |   |   ├── pyplot_three.py
|   |   |   └── pyplot_two_subplots.py
|   |   ├── scales
|   |   |   ├── README.txt
|   |   |   ├── asinh_demo.py
|   |   |   ├── aspect_loglog.py
|   |   |   ├── custom_scale.py
|   |   |   ├── log_bar.py
|   |   |   ├── log_demo.py
|   |   |   ├── logit_demo.py
|   |   |   ├── power_norm.py
|   |   |   ├── scales.py
|   |   |   ├── semilogx_demo.py
|   |   |   └── symlog_demo.py
|   |   ├── shapes_and_collections
|   |   |   ├── README.txt
|   |   |   ├── arrow_guide.py
|   |   |   ├── artist_reference.py
|   |   |   ├── collections.py
|   |   |   ├── compound_path.py
|   |   |   ├── dolphin.py
|   |   |   ├── donut.py
|   |   |   ├── ellipse_collection.py
|   |   |   ├── ellipse_demo.py
|   |   |   ├── fancybox_demo.py
|   |   |   ├── hatch_demo.py
|   |   |   ├── hatch_style_reference.py
|   |   |   ├── line_collection.py
|   |   |   ├── patch_collection.py
|   |   |   ├── path_patch.py
|   |   |   ├── quad_bezier.py
|   |   |   └── scatter.py
|   |   ├── showcase
|   |   |   ├── README.txt
|   |   |   ├── anatomy.py
|   |   |   ├── firefox.py
|   |   |   ├── integral.py
|   |   |   ├── mandelbrot.py
|   |   |   ├── stock_prices.py
|   |   |   └── xkcd.py
|   |   ├── specialty_plots
|   |   |   ├── README.txt
|   |   |   ├── advanced_hillshading.py
|   |   |   ├── anscombe.py
|   |   |   ├── hinton_demo.py
|   |   |   ├── leftventricle_bullseye.py
|   |   |   ├── mri_demo.py
|   |   |   ├── mri_with_eeg.py
|   |   |   ├── radar_chart.py
|   |   |   ├── sankey_basics.py
|   |   |   ├── sankey_links.py
|   |   |   ├── sankey_rankine.py
|   |   |   ├── skewt.py
|   |   |   └── topographic_hillshading.py
|   |   ├── spines
|   |   |   ├── README.txt
|   |   |   ├── centered_spines_with_arrows.py
|   |   |   ├── multiple_yaxis_with_spines.py
|   |   |   ├── spine_placement_demo.py
|   |   |   ├── spines.py
|   |   |   └── spines_dropped.py
|   |   ├── statistics
|   |   |   ├── README.txt
|   |   |   ├── barchart_demo.py
|   |   |   ├── boxplot.py
|   |   |   ├── boxplot_color.py
|   |   |   ├── boxplot_demo.py
|   |   |   ├── boxplot_vs_violin.py
|   |   |   ├── bxp.py
|   |   |   ├── confidence_ellipse.py
|   |   |   ├── customized_violin.py
|   |   |   ├── errorbar.py
|   |   |   ├── errorbar_features.py
|   |   |   ├── errorbar_limits.py
|   |   |   ├── errorbars_and_boxes.py
|   |   |   ├── hexbin_demo.py
|   |   |   ├── hist.py
|   |   |   ├── histogram_cumulative.py
|   |   |   ├── histogram_features.py
|   |   |   ├── histogram_histtypes.py
|   |   |   ├── histogram_multihist.py
|   |   |   ├── multiple_histograms_side_by_side.py
|   |   |   ├── time_series_histogram.py
|   |   |   └── violinplot.py
|   |   ├── style_sheets
|   |   |   ├── README.txt
|   |   |   ├── bmh.py
|   |   |   ├── dark_background.py
|   |   |   ├── fivethirtyeight.py
|   |   |   ├── ggplot.py
|   |   |   ├── grayscale.py
|   |   |   ├── plot_solarizedlight2.py
|   |   |   └── style_sheets_reference.py
|   |   ├── subplots_axes_and_figures
|   |   |   ├── README.txt
|   |   |   ├── align_labels_demo.py
|   |   |   ├── auto_subplots_adjust.py
|   |   |   ├── axes_box_aspect.py
|   |   |   ├── axes_demo.py
|   |   |   ├── axes_margins.py
|   |   |   ├── axes_props.py
|   |   |   ├── axes_zoom_effect.py
|   |   |   ├── axhspan_demo.py
|   |   |   ├── axis_equal_demo.py
|   |   |   ├── axis_labels_demo.py
|   |   |   ├── broken_axis.py
|   |   |   ├── custom_figure_class.py
|   |   |   ├── demo_constrained_layout.py
|   |   |   ├── demo_tight_layout.py
|   |   |   ├── fahrenheit_celsius_scales.py
|   |   |   ├── figure_size_units.py
|   |   |   ├── figure_title.py
|   |   |   ├── ganged_plots.py
|   |   |   ├── geo_demo.py
|   |   |   ├── gridspec_and_subplots.py
|   |   |   ├── gridspec_multicolumn.py
|   |   |   ├── gridspec_nested.py
|   |   |   ├── invert_axes.py
|   |   |   ├── multiple_figs_demo.py
|   |   |   ├── secondary_axis.py
|   |   |   ├── share_axis_lims_views.py
|   |   |   ├── shared_axis_demo.py
|   |   |   ├── subfigures.py
|   |   |   ├── subplot.py
|   |   |   ├── subplots_adjust.py
|   |   |   ├── subplots_demo.py
|   |   |   ├── two_scales.py
|   |   |   └── zoom_inset_axes.py
|   |   ├── text_labels_and_annotations
|   |   |   ├── README.txt
|   |   |   ├── accented_text.py
|   |   |   ├── align_ylabels.py
|   |   |   ├── angle_annotation.py
|   |   |   ├── angles_on_bracket_arrows.py
|   |   |   ├── annotate_transform.py
|   |   |   ├── annotation_basic.py
|   |   |   ├── annotation_demo.py
|   |   |   ├── annotation_polar.py
|   |   |   ├── arrow_demo.py
|   |   |   ├── autowrap.py
|   |   |   ├── custom_legends.py
|   |   |   ├── date.py
|   |   |   ├── demo_annotation_box.py
|   |   |   ├── demo_text_path.py
|   |   |   ├── demo_text_rotation_mode.py
|   |   |   ├── dfrac_demo.py
|   |   |   ├── engineering_formatter.py
|   |   |   ├── fancyarrow_demo.py
|   |   |   ├── fancytextbox_demo.py
|   |   |   ├── figlegend_demo.py
|   |   |   ├── font_family_rc.py
|   |   |   ├── font_file.py
|   |   |   ├── font_table.py
|   |   |   ├── fonts_demo.py
|   |   |   ├── fonts_demo_kw.py
|   |   |   ├── label_subplots.py
|   |   |   ├── legend.py
|   |   |   ├── legend_demo.py
|   |   |   ├── line_with_text.py
|   |   |   ├── mathtext_asarray.py
|   |   |   ├── mathtext_demo.py
|   |   |   ├── mathtext_examples.py
|   |   |   ├── mathtext_fontfamily_example.py
|   |   |   ├── multiline.py
|   |   |   ├── placing_text_boxes.py
|   |   |   ├── rainbow_text.py
|   |   |   ├── stix_fonts_demo.py
|   |   |   ├── tex_demo.py
|   |   |   ├── text_alignment.py
|   |   |   ├── text_commands.py
|   |   |   ├── text_fontdict.py
|   |   |   ├── text_rotation_relative_to_line.py
|   |   |   ├── titles_demo.py
|   |   |   ├── unicode_minus.py
|   |   |   ├── usetex_baseline_test.py
|   |   |   ├── usetex_fonteffects.py
|   |   |   └── watermark_text.py
|   |   ├── ticks
|   |   |   ├── README.txt
|   |   |   ├── auto_ticks.py
|   |   |   ├── centered_ticklabels.py
|   |   |   ├── colorbar_tick_labelling_demo.py
|   |   |   ├── custom_ticker1.py
|   |   |   ├── date_concise_formatter.py
|   |   |   ├── date_demo_convert.py
|   |   |   ├── date_demo_rrule.py
|   |   |   ├── date_formatters_locators.py
|   |   |   ├── date_index_formatter.py
|   |   |   ├── date_precision_and_epochs.py
|   |   |   ├── dollar_ticks.py
|   |   |   ├── fig_axes_customize_simple.py
|   |   |   ├── major_minor_demo.py
|   |   |   ├── scalarformatter.py
|   |   |   ├── tick-formatters.py
|   |   |   ├── tick-locators.py
|   |   |   ├── tick_label_right.py
|   |   |   ├── tick_labels_from_values.py
|   |   |   ├── tick_xlabel_top.py
|   |   |   ├── ticklabels_rotation.py
|   |   |   └── ticks_too_many.py
|   |   ├── units
|   |   |   ├── README.txt
|   |   |   ├── annotate_with_units.py
|   |   |   ├── artist_tests.py
|   |   |   ├── bar_demo2.py
|   |   |   ├── bar_unit_demo.py
|   |   |   ├── basic_units.py
|   |   |   ├── ellipse_with_units.py
|   |   |   ├── evans_test.py
|   |   |   ├── radian_demo.py
|   |   |   ├── units_sample.py
|   |   |   └── units_scatter.py
|   |   ├── user_interfaces
|   |   |   ├── README.txt
|   |   |   ├── canvasagg.py
|   |   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk3_sgskip.py
|   |   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk4_sgskip.py
|   |   |   ├── embedding_in_qt_sgskip.py
|   |   |   ├── embedding_in_tk_sgskip.py
|   |   |   ├── embedding_in_wx2_sgskip.py
|   |   |   ├── embedding_in_wx3_sgskip.py
|   |   |   ├── embedding_in_wx4_sgskip.py
|   |   |   ├── embedding_in_wx5_sgskip.py
|   |   |   ├── embedding_webagg_sgskip.py
|   |   |   ├── fourier_demo_wx_sgskip.py
|   |   |   ├── gtk3_spreadsheet_sgskip.py
|   |   |   ├── gtk4_spreadsheet_sgskip.py
|   |   |   ├── images
|   |   |   ├── mathtext_wx_sgskip.py
|   |   |   ├── mpl_with_glade3_sgskip.py
|   |   |   ├── mplcvd.py
|   |   |   ├── pylab_with_gtk3_sgskip.py
|   |   |   ├── pylab_with_gtk4_sgskip.py
|   |   |   ├── svg_histogram_sgskip.py
|   |   |   ├── svg_tooltip_sgskip.py
|   |   |   ├── toolmanager_sgskip.py
|   |   |   ├── web_application_server_sgskip.py
|   |   |   └── wxcursor_demo_sgskip.py
|   |   ├── userdemo
|   |   |   ├── README.txt
|   |   |   ├── annotate_explain.py
|   |   |   ├── annotate_simple_coord02.py
|   |   |   ├── annotate_text_arrow.py
|   |   |   ├── connect_simple01.py
|   |   |   ├── connectionstyle_demo.py
|   |   |   ├── custom_boxstyle01.py
|   |   |   ├── demo_gridspec01.py
|   |   |   ├── demo_gridspec03.py
|   |   |   ├── demo_gridspec06.py
|   |   |   ├── pgf_fonts.py
|   |   |   ├── pgf_preamble_sgskip.py
|   |   |   ├── pgf_texsystem.py
|   |   |   ├── simple_annotate01.py
|   |   |   ├── simple_legend01.py
|   |   |   └── simple_legend02.py
|   |   └── widgets
|   |       ├── README.txt
|   |       ├── annotated_cursor.py
|   |       ├── buttons.py
|   |       ├── check_buttons.py
|   |       ├── cursor.py
|   |       ├── lasso_selector_demo_sgskip.py
|   |       ├── menu.py
|   |       ├── mouse_cursor.py
|   |       ├── multicursor.py
|   |       ├── polygon_selector_demo.py
|   |       ├── polygon_selector_simple.py
|   |       ├── radio_buttons.py
|   |       ├── range_slider.py
|   |       ├── rectangle_selector.py
|   |       ├── slider_demo.py
|   |       ├── slider_snap_demo.py
|   |       ├── span_selector.py
|   |       └── textbox.py
|   ├── plot_types
|   |   ├── 3D
|   |   |   ├── README.rst
|   |   |   ├── scatter3d_simple.py
|   |   |   ├── surface3d_simple.py
|   |   |   ├── trisurf3d_simple.py
|   |   |   ├── voxels_simple.py
|   |   |   └── wire3d_simple.py
|   |   ├── README.rst
|   |   ├── arrays
|   |   |   ├── README.rst
|   |   |   ├── barbs.py
|   |   |   ├── contour.py
|   |   |   ├── contourf.py
|   |   |   ├── imshow.py
|   |   |   ├── pcolormesh.py
|   |   |   ├── quiver.py
|   |   |   └── streamplot.py
|   |   ├── basic
|   |   |   ├── README.rst
|   |   |   ├── bar.py
|   |   |   ├── fill_between.py
|   |   |   ├── plot.py
|   |   |   ├── scatter_plot.py
|   |   |   ├── stackplot.py
|   |   |   ├── stem.py
|   |   |   └── step.py
|   |   ├── stats
|   |   |   ├── README.rst
|   |   |   ├── boxplot_plot.py
|   |   |   ├── ecdf.py
|   |   |   ├── errorbar_plot.py
|   |   |   ├── eventplot.py
|   |   |   ├── hexbin.py
|   |   |   ├── hist2d.py
|   |   |   ├── hist_plot.py
|   |   |   ├── pie.py
|   |   |   └── violin.py
|   |   └── unstructured
|   |       ├── README.rst
|   |       ├── tricontour.py
|   |       ├── tricontourf.py
|   |       ├── tripcolor.py
|   |       └── triplot.py
|   ├── tutorials
|   |   ├── artists.py
|   |   ├── images.py
|   |   ├── index.rst
|   |   ├── lifecycle.py
|   |   └── pyplot.py
|   └── users_explain
|       ├── animations
|       |   ├── README.txt
|       |   ├── animations.py
|       |   └── blitting.py
|       ├── artists
|       |   ├── color_cycle.py
|       |   ├── imshow_extent.py
|       |   ├── index.rst
|       |   ├── patheffects_guide.py
|       |   ├── paths.py
|       |   ├── performance.rst
|       |   └── transforms_tutorial.py
|       ├── axes
|       |   ├── arranging_axes.py
|       |   ├── autoscale.py
|       |   ├── colorbar_placement.py
|       |   ├── constrainedlayout_guide.py
|       |   ├── index.rst
|       |   ├── legend_guide.py
|       |   ├── mosaic.py
|       |   └── tight_layout_guide.py
|       ├── axis
|       |   └── index.rst
|       ├── colors
|       |   ├── README.txt
|       |   ├── colorbar_only.py
|       |   ├── colormap-manipulation.py
|       |   ├── colormapnorms.py
|       |   ├── colormaps.py
|       |   └── colors.py
|       ├── customizing.py
|       ├── figure
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── index.rst
|       ├── quick_start.py
|       ├── text
|       |   ├── README.txt
|       |   ├── annotations.py
|       |   ├── fonts.py
|       |   ├── mathtext.py
|       |   ├── pgf.py
|       |   ├── text_intro.py
|       |   ├── text_props.py
|       |   └── usetex.py
|       └── toolkits
|           ├── axes_grid.rst
|           ├── axisartist.rst
|           ├── index.rst
|           └── mplot3d.rst
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── typing.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       ├── minver.txt
|       └── mypy.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
└── tools
    ├── README.txt
    ├── boilerplate.py
    ├── cache_zenodo_svg.py
    ├── check_typehints.py
    ├── create_DejaVuDisplay.sh
    ├── embed_js.py
    ├── gh_api.py
    ├── github_stats.py
    ├── make_icons.py
    ├── memleak.py
    ├── run_examples.py
    ├── subset.py
    ├── triage_tests.py
    └── visualize_tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [ENH]: Add get/set_antialiased to Text objects

Description: ### Problem

Currently, Text objects always retrieve their antialiasing state via the global rcParams["text.antialias"], unlike other artists for which this can be configured on a per-artist basis via `set_antialiased` (and read via `set_antialiased`).

### Proposed solution

Add similar getters/setters on Text objects (also adjusting Annotations accordingly, if needed) and use that info in the drawing stage.

Should be relatively easy to implement, except that the slight fiddling needed with backends requires some understanding of backend code (I think we need to replace the access to `rcParams["text.antialiased"]` by going through the GraphicsContext state).

Patch information:
diff --git a/lib/matplotlib/backends/backend_agg.py b/lib/matplotlib/backends/backend_agg.py
index 7d038a998f..1e43736fd9 100644
--- a/lib/matplotlib/backends/backend_agg.py
+++ b/lib/matplotlib/backends/backend_agg.py
@@ -206,7 +206,7 @@ class RendererAgg(RendererBase):
         # space) in the following call to draw_text_image).
         font.set_text(s, 0, flags=get_hinting_flag())
         font.draw_glyphs_to_bitmap(
-            antialiased=mpl.rcParams['text.antialiased'])
+            antialiased=bool(gc.get_antialiased()))
         d = font.get_descent() / 64.0
         # The descent needs to be adjusted for the angle.
         xo, yo = font.get_bitmap_offset()
diff --git a/lib/matplotlib/backends/backend_cairo.py b/lib/matplotlib/backends/backend_cairo.py
index 9ccadcdf1c..7f1888b4dd 100644
--- a/lib/matplotlib/backends/backend_cairo.py
+++ b/lib/matplotlib/backends/backend_cairo.py
@@ -205,7 +205,7 @@ class RendererCairo(RendererBase):
             ctx.set_font_size(self.points_to_pixels(prop.get_size_in_points()))
             opts = cairo.FontOptions()
             opts.set_antialias(
-                cairo.ANTIALIAS_DEFAULT if mpl.rcParams["text.antialiased"]
+                cairo.ANTIALIAS_DEFAULT if gc.get_antialiased()
                 else cairo.ANTIALIAS_NONE)
             ctx.set_font_options(opts)
             if angle:
diff --git a/lib/matplotlib/text.py b/lib/matplotlib/text.py
index 4591316cf9..285d06960f 100644
--- a/lib/matplotlib/text.py
+++ b/lib/matplotlib/text.py
@@ -167,6 +167,7 @@ class Text(Artist):
         transform_rotates_text=False,
         linespacing=None,
         rotation_mode=None,
+        antialiased=None,
     ):
         self.set_text(text)
         self.set_color(
@@ -187,6 +188,7 @@ class Text(Artist):
             linespacing = 1.2  # Maybe use rcParam later.
         self.set_linespacing(linespacing)
         self.set_rotation_mode(rotation_mode)
+        self.set_antialiased(antialiased)
 
     def update(self, kwargs):
         # docstring inherited
@@ -309,6 +311,24 @@ class Text(Artist):
         """Return the text rotation mode."""
         return self._rotation_mode
 
+    def get_antialiased(self):
+        """Return whether antialiasing is used for drawing text."""
+        return self._antialiased
+
+    def set_antialiased(self, aa):
+        """
+        Set whether to use antialiased rendering for this text.
+
+        Parameters
+        ----------
+        aa : bool or None
+            If None, defaults to rcParams['text.antialiased'].
+        """
+        if aa is None:
+            aa = mpl.rcParams['text.antialiased']
+        self._antialiased = aa
+        self.stale = True
+
     def update_from(self, other):
         # docstring inherited
         super().update_from(other)
@@ -736,6 +756,7 @@ class Text(Artist):
             gc = renderer.new_gc()
             gc.set_foreground(self.get_color())
             gc.set_alpha(self.get_alpha())
+            gc.set_antialiased(self.get_antialiased())
             gc.set_url(self._url)
             self._set_gc_clip(gc)
 


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:38:59,759 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to add `get/set_antialiased` methods to `Text` objects. The provided patch modifies backend renderers to use `gc.get_antialiased()`. To understand how this graphics context property works, I need the definition of the `GraphicsContextBase` class. This, along with the `RendererBase` class which defines the `draw_text` interface, is located in `lib/matplotlib/backend_bases.py`. This file is crucial for understanding the communication between artists and backends.' query='Please provide the full content of the file `lib/matplotlib/backend_bases.py`.' extra_requirements='' purpose='I need this file to understand the definitions of `GraphicsContextBase` and `RendererBase`, which are essential for implementing the per-artist antialiasing feature correctly across different backends.'
2025-12-21 08:38:59,761 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `lib/matplotlib/backend_bases.py`.
2025-12-21 08:38:59,761 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:38:59,762 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:38:59,762 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:38:59,762 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `lib/matplotlib/backend_bases.py`.
Purpose: I need this file to understand the definitions of `GraphicsContextBase` and `RendererBase`, which are essential for implementing the per-artist antialiasing feature correctly across different backends.
2025-12-21 08:39:02,001 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of `lib/matplotlib/backend_bases.py`. This file contains the definitions for `GraphicsContextBase` and `RendererBase`, which will be instrumental in implementing the per-artist antialiasing feature across various backends.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/backend_bases.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2156, 'candidates_token_count': 76, 'total_token_count': 2321, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2156}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 89, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10266324720884624, 'model_name': 'gemini-2.5-pro'} id='run--4a18e0b3-c29d-46a5-ab5c-6777da01af28-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/backend_bases.py'}, 'id': '01b24328-356a-4711-a8d3-0217369048fa', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2156, 'output_tokens': 76, 'total_tokens': 2321, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 89}}
2025-12-21 08:39:05,575 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have fetched the complete content of `lib/matplotlib/backend_bases.py` as you requested. This file provides the foundational definitions for `GraphicsContextBase` and `RendererBase`. These base classes are crucial for your work on the per-artist antialiasing feature, as they define the drawing and rendering operations that backends must implement.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9342, 'candidates_token_count': 71, 'total_token_count': 9649, 'cached_content_token_count': 1829, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9342}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1829}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 71}], 'thoughts_token_count': 236}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5489058158767055, 'model_name': 'gemini-2.5-pro'} id='run--5cb25f8d-6f96-47f8-9ac1-9f3410f5eca8-0' usage_metadata={'input_tokens': 9342, 'output_tokens': 71, 'total_tokens': 9649, 'input_token_details': {'cache_read': 1829}, 'output_token_details': {'reasoning': 236}}
2025-12-21 08:39:05,577 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `lib/matplotlib/backend_bases.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need this file to understand the definitions of `GraphicsContextBase` and `RendererBase`, which are essential for implementing the per-artist antialiasing feature correctly across different backends.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/backend_bases.py
Line number range: 1 - 500
Content:
1. """
2. Abstract base classes define the primitives that renderers and
3. graphics contexts must implement to serve as a Matplotlib backend.
4. 
5. `RendererBase`
6.     An abstract base class to handle drawing/rendering operations.
7. 
8. `FigureCanvasBase`
9.     The abstraction layer that separates the `.Figure` from the backend
10.     specific details like a user interface drawing area.
11. 
12. `GraphicsContextBase`
13.     An abstract base class that provides color, line styles, etc.
14. 
15. `Event`
16.     The base class for all of the Matplotlib event handling.  Derived classes
17.     such as `KeyEvent` and `MouseEvent` store the meta data like keys and
18.     buttons pressed, x and y locations in pixel and `~.axes.Axes` coordinates.
19. 
20. `ShowBase`
21.     The base class for the ``Show`` class of each interactive backend; the
22.     'show' callable is then set to ``Show.__call__``.
23. 
24. `ToolContainerBase`
25.     The base class for the Toolbar class of each interactive backend.
26. """
27. 
28. from collections import namedtuple
29. from contextlib import ExitStack, contextmanager, nullcontext
30. from enum import Enum, IntEnum
31. import functools
32. import importlib
33. import inspect
34. import io
35. import itertools
36. import logging
37. import os
38. import sys
39. import time
40. import weakref
41. from weakref import WeakKeyDictionary
42. 
43. import numpy as np
44. 
45. import matplotlib as mpl
46. from matplotlib import (
47.     _api, backend_tools as tools, cbook, colors, _docstring, text,
48.     _tight_bbox, transforms, widgets, get_backend, is_interactive, rcParams)
49. from matplotlib._pylab_helpers import Gcf
50. from matplotlib.backend_managers import ToolManager
51. from matplotlib.cbook import _setattr_cm
52. from matplotlib.layout_engine import ConstrainedLayoutEngine
53. from matplotlib.path import Path
54. from matplotlib.texmanager import TexManager
55. from matplotlib.transforms import Affine2D
56. from matplotlib._enums import JoinStyle, CapStyle
57. 
58. 
59. _log = logging.getLogger(__name__)
60. _default_filetypes = {
61.     'eps': 'Encapsulated Postscript',
62.     'jpg': 'Joint Photographic Experts Group',
63.     'jpeg': 'Joint Photographic Experts Group',
64.     'pdf': 'Portable Document Format',
65.     'pgf': 'PGF code for LaTeX',
66.     'png': 'Portable Network Graphics',
67.     'ps': 'Postscript',
68.     'raw': 'Raw RGBA bitmap',
69.     'rgba': 'Raw RGBA bitmap',
70.     'svg': 'Scalable Vector Graphics',
71.     'svgz': 'Scalable Vector Graphics',
72.     'tif': 'Tagged Image File Format',
73.     'tiff': 'Tagged Image File Format',
74.     'webp': 'WebP Image Format',
75. }
76. _default_backends = {
77.     'eps': 'matplotlib.backends.backend_ps',
78.     'jpg': 'matplotlib.backends.backend_agg',
79.     'jpeg': 'matplotlib.backends.backend_agg',
80.     'pdf': 'matplotlib.backends.backend_pdf',
81.     'pgf': 'matplotlib.backends.backend_pgf',
82.     'png': 'matplotlib.backends.backend_agg',
83.     'ps': 'matplotlib.backends.backend_ps',
84.     'raw': 'matplotlib.backends.backend_agg',
85.     'rgba': 'matplotlib.backends.backend_agg',
86.     'svg': 'matplotlib.backends.backend_svg',
87.     'svgz': 'matplotlib.backends.backend_svg',
88.     'tif': 'matplotlib.backends.backend_agg',
89.     'tiff': 'matplotlib.backends.backend_agg',
90.     'webp': 'matplotlib.backends.backend_agg',
91. }
92. 
93. 
94. def _safe_pyplot_import():
95.     """
96.     Import and return ``pyplot``, correctly setting the backend if one is
97.     already forced.
98.     """
99.     try:
100.         import matplotlib.pyplot as plt
101.     except ImportError:  # Likely due to a framework mismatch.
102.         current_framework = cbook._get_running_interactive_framework()
103.         if current_framework is None:
104.             raise  # No, something else went wrong, likely with the install...
105.         backend_mapping = {
106.             'qt': 'qtagg',
107.             'gtk3': 'gtk3agg',
108.             'gtk4': 'gtk4agg',
109.             'wx': 'wxagg',
110.             'tk': 'tkagg',
111.             'macosx': 'macosx',
112.             'headless': 'agg',
113.         }
114.         backend = backend_mapping[current_framework]
115.         rcParams["backend"] = mpl.rcParamsOrig["backend"] = backend
116.         import matplotlib.pyplot as plt  # Now this should succeed.
117.     return plt
118. 
119. 
120. def register_backend(format, backend, description=None):
121.     """
122.     Register a backend for saving to a given file format.
123. 
124.     Parameters
125.     ----------
126.     format : str
127.         File extension
128.     backend : module string or canvas class
129.         Backend for handling file output
130.     description : str, default: ""
131.         Description of the file type.
132.     """
133.     if description is None:
134.         description = ''
135.     _default_backends[format] = backend
136.     _default_filetypes[format] = description
137. 
138. 
139. def get_registered_canvas_class(format):
140.     """
141.     Return the registered default canvas for given file format.
142.     Handles deferred import of required backend.
143.     """
144.     if format not in _default_backends:
145.         return None
146.     backend_class = _default_backends[format]
147.     if isinstance(backend_class, str):
148.         backend_class = importlib.import_module(backend_class).FigureCanvas
149.         _default_backends[format] = backend_class
150.     return backend_class
151. 
152. 
153. class RendererBase:
154.     """
155.     An abstract base class to handle drawing/rendering operations.
156. 
157.     The following methods must be implemented in the backend for full
158.     functionality (though just implementing `draw_path` alone would give a
159.     highly capable backend):
160. 
161.     * `draw_path`
162.     * `draw_image`
163.     * `draw_gouraud_triangles`
164. 
165.     The following methods *should* be implemented in the backend for
166.     optimization reasons:
167. 
168.     * `draw_text`
169.     * `draw_markers`
170.     * `draw_path_collection`
171.     * `draw_quad_mesh`
172.     """
173. 
174.     def __init__(self):
175.         super().__init__()
176.         self._texmanager = None
177.         self._text2path = text.TextToPath()
178.         self._raster_depth = 0
179.         self._rasterizing = False
180. 
181.     def open_group(self, s, gid=None):
182.         """
183.         Open a grouping element with label *s* and *gid* (if set) as id.
184. 
185.         Only used by the SVG renderer.
186.         """
187. 
188.     def close_group(self, s):
189.         """
190.         Close a grouping element with label *s*.
191. 
192.         Only used by the SVG renderer.
193.         """
194. 
195.     def draw_path(self, gc, path, transform, rgbFace=None):
196.         """Draw a `~.path.Path` instance using the given affine transform."""
197.         raise NotImplementedError
198. 
199.     def draw_markers(self, gc, marker_path, marker_trans, path,
200.                      trans, rgbFace=None):
201.         """
202.         Draw a marker at each of *path*'s vertices (excluding control points).
203. 
204.         The base (fallback) implementation makes multiple calls to `draw_path`.
205.         Backends may want to override this method in order to draw the marker
206.         only once and reuse it multiple times.
207. 
208.         Parameters
209.         ----------
210.         gc : `.GraphicsContextBase`
211.             The graphics context.
212.         marker_trans : `matplotlib.transforms.Transform`
213.             An affine transform applied to the marker.
214.         trans : `matplotlib.transforms.Transform`
215.             An affine transform applied to the path.
216.         """
217.         for vertices, codes in path.iter_segments(trans, simplify=False):
218.             if len(vertices):
219.                 x, y = vertices[-2:]
220.                 self.draw_path(gc, marker_path,
221.                                marker_trans +
222.                                transforms.Affine2D().translate(x, y),
223.                                rgbFace)
224. 
225.     def draw_path_collection(self, gc, master_transform, paths, all_transforms,
226.                              offsets, offset_trans, facecolors, edgecolors,
227.                              linewidths, linestyles, antialiaseds, urls,
228.                              offset_position):
229.         """
230.         Draw a collection of *paths*.
231. 
232.         Each path is first transformed by the corresponding entry
233.         in *all_transforms* (a list of (3, 3) matrices) and then by
234.         *master_transform*.  They are then translated by the corresponding
235.         entry in *offsets*, which has been first transformed by *offset_trans*.
236. 
237.         *facecolors*, *edgecolors*, *linewidths*, *linestyles*, and
238.         *antialiased* are lists that set the corresponding properties.
239. 
240.         *offset_position* is unused now, but the argument is kept for
241.         backwards compatibility.
242. 
243.         The base (fallback) implementation makes multiple calls to `draw_path`.
244.         Backends may want to override this in order to render each set of
245.         path data only once, and then reference that path multiple times with
246.         the different offsets, colors, styles etc.  The generator methods
247.         `_iter_collection_raw_paths` and `_iter_collection` are provided to
248.         help with (and standardize) the implementation across backends.  It
249.         is highly recommended to use those generators, so that changes to the
250.         behavior of `draw_path_collection` can be made globally.
251.         """
252.         path_ids = self._iter_collection_raw_paths(master_transform,
253.                                                    paths, all_transforms)
254. 
255.         for xo, yo, path_id, gc0, rgbFace in self._iter_collection(
256.                 gc, list(path_ids), offsets, offset_trans,
257.                 facecolors, edgecolors, linewidths, linestyles,
258.                 antialiaseds, urls, offset_position):
259.             path, transform = path_id
260.             # Only apply another translation if we have an offset, else we
261.             # reuse the initial transform.
262.             if xo != 0 or yo != 0:
263.                 # The transformation can be used by multiple paths. Since
264.                 # translate is a inplace operation, we need to copy the
265.                 # transformation by .frozen() before applying the translation.
266.                 transform = transform.frozen()
267.                 transform.translate(xo, yo)
268.             self.draw_path(gc0, path, transform, rgbFace)
269. 
270.     def draw_quad_mesh(self, gc, master_transform, meshWidth, meshHeight,
271.                        coordinates, offsets, offsetTrans, facecolors,
272.                        antialiased, edgecolors):
273.         """
274.         Draw a quadmesh.
275. 
276.         The base (fallback) implementation converts the quadmesh to paths and
277.         then calls `draw_path_collection`.
278.         """
279. 
280.         from matplotlib.collections import QuadMesh
281.         paths = QuadMesh._convert_mesh_to_paths(coordinates)
282. 
283.         if edgecolors is None:
284.             edgecolors = facecolors
285.         linewidths = np.array([gc.get_linewidth()], float)
286. 
287.         return self.draw_path_collection(
288.             gc, master_transform, paths, [], offsets, offsetTrans, facecolors,
289.             edgecolors, linewidths, [], [antialiased], [None], 'screen')
290. 
291.     @_api.deprecated("3.7", alternative="draw_gouraud_triangles")
292.     def draw_gouraud_triangle(self, gc, points, colors, transform):
293.         """
294.         Draw a Gouraud-shaded triangle.
295. 
296.         Parameters
297.         ----------
298.         gc : `.GraphicsContextBase`
299.             The graphics context.
300.         points : (3, 2) array-like
301.             Array of (x, y) points for the triangle.
302.         colors : (3, 4) array-like
303.             RGBA colors for each point of the triangle.
304.         transform : `matplotlib.transforms.Transform`
305.             An affine transform to apply to the points.
306.         """
307.         raise NotImplementedError
308. 
309.     def draw_gouraud_triangles(self, gc, triangles_array, colors_array,
310.                                transform):
311.         """
312.         Draw a series of Gouraud triangles.
313. 
314.         Parameters
315.         ----------
316.         gc : `.GraphicsContextBase`
317.             The graphics context.
318.         triangles_array : (N, 3, 2) array-like
319.             Array of *N* (x, y) points for the triangles.
320.         colors_array : (N, 3, 4) array-like
321.             Array of *N* RGBA colors for each point of the triangles.
322.         transform : `matplotlib.transforms.Transform`
323.             An affine transform to apply to the points.
324.         """
325.         raise NotImplementedError
326. 
327.     def _iter_collection_raw_paths(self, master_transform, paths,
328.                                    all_transforms):
329.         """
330.         Helper method (along with `_iter_collection`) to implement
331.         `draw_path_collection` in a memory-efficient manner.
332. 
333.         This method yields all of the base path/transform combinations, given a
334.         master transform, a list of paths and list of transforms.
335. 
336.         The arguments should be exactly what is passed in to
337.         `draw_path_collection`.
338. 
339.         The backend should take each yielded path and transform and create an
340.         object that can be referenced (reused) later.
341.         """
342.         Npaths = len(paths)
343.         Ntransforms = len(all_transforms)
344.         N = max(Npaths, Ntransforms)
345. 
346.         if Npaths == 0:
347.             return
348. 
349.         transform = transforms.IdentityTransform()
350.         for i in range(N):
351.             path = paths[i % Npaths]
352.             if Ntransforms:
353.                 transform = Affine2D(all_transforms[i % Ntransforms])
354.             yield path, transform + master_transform
355. 
356.     def _iter_collection_uses_per_path(self, paths, all_transforms,
357.                                        offsets, facecolors, edgecolors):
358.         """
359.         Compute how many times each raw path object returned by
360.         `_iter_collection_raw_paths` would be used when calling
361.         `_iter_collection`. This is intended for the backend to decide
362.         on the tradeoff between using the paths in-line and storing
363.         them once and reusing. Rounds up in case the number of uses
364.         is not the same for every path.
365.         """
366.         Npaths = len(paths)
367.         if Npaths == 0 or len(facecolors) == len(edgecolors) == 0:
368.             return 0
369.         Npath_ids = max(Npaths, len(all_transforms))
370.         N = max(Npath_ids, len(offsets))
371.         return (N + Npath_ids - 1) // Npath_ids
372. 
373.     def _iter_collection(self, gc, path_ids, offsets, offset_trans, facecolors,
374.                          edgecolors, linewidths, linestyles,
375.                          antialiaseds, urls, offset_position):
376.         """
377.         Helper method (along with `_iter_collection_raw_paths`) to implement
378.         `draw_path_collection` in a memory-efficient manner.
379. 
380.         This method yields all of the path, offset and graphics context
381.         combinations to draw the path collection.  The caller should already
382.         have looped over the results of `_iter_collection_raw_paths` to draw
383.         this collection.
384. 
385.         The arguments should be the same as that passed into
386.         `draw_path_collection`, with the exception of *path_ids*, which is a
387.         list of arbitrary objects that the backend will use to reference one of
388.         the paths created in the `_iter_collection_raw_paths` stage.
389. 
390.         Each yielded result is of the form::
391. 
392.            xo, yo, path_id, gc, rgbFace
393. 
394.         where *xo*, *yo* is an offset; *path_id* is one of the elements of
395.         *path_ids*; *gc* is a graphics context and *rgbFace* is a color to
396.         use for filling the path.
397.         """
398.         Npaths = len(path_ids)
399.         Noffsets = len(offsets)
400.         N = max(Npaths, Noffsets)
401.         Nfacecolors = len(facecolors)
402.         Nedgecolors = len(edgecolors)
403.         Nlinewidths = len(linewidths)
404.         Nlinestyles = len(linestyles)
405.         Nurls = len(urls)
406. 
407.         if (Nfacecolors == 0 and Nedgecolors == 0) or Npaths == 0:
408.             return
409. 
410.         gc0 = self.new_gc()
411.         gc0.copy_properties(gc)
412. 
413.         def cycle_or_default(seq, default=None):
414.             # Cycle over *seq* if it is not empty; else always yield *default*.
415.             return (itertools.cycle(seq) if len(seq)
416.                     else itertools.repeat(default))
417. 
418.         pathids = cycle_or_default(path_ids)
419.         toffsets = cycle_or_default(offset_trans.transform(offsets), (0, 0))
420.         fcs = cycle_or_default(facecolors)
421.         ecs = cycle_or_default(edgecolors)
422.         lws = cycle_or_default(linewidths)
423.         lss = cycle_or_default(linestyles)
424.         aas = cycle_or_default(antialiaseds)
425.         urls = cycle_or_default(urls)
426. 
427.         if Nedgecolors == 0:
428.             gc0.set_linewidth(0.0)
429. 
430.         for pathid, (xo, yo), fc, ec, lw, ls, aa, url in itertools.islice(
431.                 zip(pathids, toffsets, fcs, ecs, lws, lss, aas, urls), N):
432.             if not (np.isfinite(xo) and np.isfinite(yo)):
433.                 continue
434.             if Nedgecolors:
435.                 if Nlinewidths:
436.                     gc0.set_linewidth(lw)
437.                 if Nlinestyles:
438.                     gc0.set_dashes(*ls)
439.                 if len(ec) == 4 and ec[3] == 0.0:
440.                     gc0.set_linewidth(0)
441.                 else:
442.                     gc0.set_foreground(ec)
443.             if fc is not None and len(fc) == 4 and fc[3] == 0:
444.                 fc = None
445.             gc0.set_antialiased(aa)
446.             if Nurls:
447.                 gc0.set_url(url)
448.             yield xo, yo, pathid, gc0, fc
449.         gc0.restore()
450. 
451.     def get_image_magnification(self):
452.         """
453.         Get the factor by which to magnify images passed to `draw_image`.
454.         Allows a backend to have images at a different resolution to other
455.         artists.
456.         """
457.         return 1.0
458. 
459.     def draw_image(self, gc, x, y, im, transform=None):
460.         """
461.         Draw an RGBA image.
462. 
463.         Parameters
464.         ----------
465.         gc : `.GraphicsContextBase`
466.             A graphics context with clipping information.
467. 
468.         x : scalar
469.             The distance in physical units (i.e., dots or pixels) from the left
470.             hand side of the canvas.
471. 
472.         y : scalar
473.             The distance in physical units (i.e., dots or pixels) from the
474.             bottom side of the canvas.
475. 
476.         im : (N, M, 4) array of `numpy.uint8`
477.             An array of RGBA pixels.
478. 
479.         transform : `~matplotlib.transforms.Affine2DBase`
480.             If and only if the concrete backend is written such that
481.             `option_scale_image` returns ``True``, an affine transformation
482.             (i.e., an `.Affine2DBase`) *may* be passed to `draw_image`.  The
483.             translation vector of the transformation is given in physical units
484.             (i.e., dots or pixels). Note that the transformation does not
485.             override *x* and *y*, and has to be applied *before* translating
486.             the result by *x* and *y* (this can be accomplished by adding *x*
487.             and *y* to the translation vector defined by *transform*).
488.         """
489.         raise NotImplementedError
490. 
491.     def option_image_nocomposite(self):
492.         """
493.         Return whether image composition by Matplotlib should be skipped.
494. 
495.         Raster backends should usually return False (letting the C-level
496.         rasterizer take care of image composition); vector backends should
497.         usually return ``not rcParams["image.composite_image"]``.
498.         """
499.         return False
500.

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:39:13,457 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly asks for the full content of the file `lib/matplotlib/backend_bases.py`.\n2. Extended relevance:\n   - The provided context is the content of `lib/matplotlib/backend_bases.py` from line 1 to 500. This directly addresses the user's request by providing the file content they asked for. The purpose mentions needing `GraphicsContextBase` and `RendererBase`, and this file contains the definition for `RendererBase` and is the correct location for `GraphicsContextBase`.", relative_path='lib/matplotlib/backend_bases.py', start_line=1, end_line=500)]
2025-12-21 08:39:13,459 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `lib/matplotlib/backend_bases.py`.
2025-12-21 08:39:13,459 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:39:13,459 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:39:13,460 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 08:39:13,460 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 08:39:13,460 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── good-first-issue.yml
|       ├── mypy-stubtest.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       ├── stale.yml
|       └── tests.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   ├── codespell-ignore-words.txt
|   ├── export_sdist_name.py
|   └── mypy-stubtest-allowlist.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24531-DOS.rst
|   |   |   |   ├── 24661-AAMW.rst
|   |   |   |   ├── 25044-YI.rst
|   |   |   |   ├── 25061-DS.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25112-GG.rst
|   |   |   |   ├── 25192-DS.rst
|   |   |   |   ├── 25255-RR.rst
|   |   |   |   ├── 25456-AL.rst
|   |   |   |   └── 25697-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23200-OG.rst
|   |   |   |   ├── 24312-AL.rst
|   |   |   |   ├── 24913-AL.rst
|   |   |   |   ├── 24985-OG.rst
|   |   |   |   ├── 24990-OG.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25138-AL.rst
|   |   |   |   ├── 25282-AL.rst
|   |   |   |   ├── 25352-GL.rst
|   |   |   |   ├── 25427-AL.rst
|   |   |   |   ├── 25469-AL.rst
|   |   |   |   ├── 25484-AL.rst
|   |   |   |   ├── 25557-AL.rst
|   |   |   |   ├── 25559-AL.rst
|   |   |   |   ├── 25584-KS.rst
|   |   |   |   ├── 25588-KS.rst
|   |   |   |   ├── 25651-REC.rst
|   |   |   |   ├── 25708-AL.rst
|   |   |   |   ├── 25728-OG.rst
|   |   |   |   ├── 25742-ES.rst
|   |   |   |   ├── 25774-AL.rst
|   |   |   |   ├── 25781-AL.rst
|   |   |   |   ├── 25841-AL.rst
|   |   |   |   ├── 25859-ES.rst
|   |   |   |   └── 25889-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24531-DOS.rst
|   |   |   |   ├── 24919-KS.rst
|   |   |   |   ├── 24976-KS.rst
|   |   |   |   └── 25475-ES.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24923-ES.rst
|   |   |       ├── 24984-OG.rst
|   |   |       ├── 24XXX-OG.rst
|   |   |       ├── 25456-AL.rst
|   |   |       ├── 25584-KS.rst
|   |   |       └── 25648-TS.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.6.0.rst
|   |   |   ├── api_changes_3.6.1.rst
|   |   |   ├── api_changes_3.7.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.7.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── typing_api.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plots_shareview.rst
|       |   ├── README.rst
|       |   ├── auto_minor_tick.rst
|       |   ├── ecdf.rst
|       |   ├── get_suptitle.rst
|       |   ├── mathtext_supports_text.rst
|       |   ├── new_color_spec_tuple.rst
|       |   ├── pie_hatch.rst
|       |   ├── pie_shadow_control.rst
|       |   ├── savefig_bbox_layout.rst
|       |   ├── shadow_shade.rst
|       |   ├── spinesproxyset.rst
|       |   ├── tick_labelfont_param.rst
|       |   ├── updated_mathtext.rst
|       |   └── widget_button_styling.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── github_stats_3.6.0.rst
|       |   ├── github_stats_3.6.1.rst
|       |   ├── github_stats_3.6.2.rst
|       |   ├── github_stats_3.6.3.rst
|       |   ├── github_stats_3.7.0.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   ├── whats_new_3.6.0.rst
|       |   └── whats_new_3.7.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── galleries
|   ├── examples
|   |   ├── README.txt
|   |   ├── animation
|   |   |   ├── README.txt
|   |   |   ├── animate_decay.py
|   |   |   ├── animated_histogram.py
|   |   |   ├── animation_demo.py
|   |   |   ├── bayes_update.py
|   |   |   ├── double_pendulum.py
|   |   |   ├── dynamic_image.py
|   |   |   ├── frame_grabbing_sgskip.py
|   |   |   ├── multiple_axes.py
|   |   |   ├── pause_resume.py
|   |   |   ├── rain.py
|   |   |   ├── random_walk.py
|   |   |   ├── simple_anim.py
|   |   |   ├── simple_scatter.py
|   |   |   ├── strip_chart.py
|   |   |   └── unchained.py
|   |   ├── axes_grid1
|   |   |   ├── README.txt
|   |   |   ├── demo_anchored_direction_arrows.py
|   |   |   ├── demo_axes_divider.py
|   |   |   ├── demo_axes_grid.py
|   |   |   ├── demo_axes_grid2.py
|   |   |   ├── demo_axes_hbox_divider.py
|   |   |   ├── demo_axes_rgb.py
|   |   |   ├── demo_colorbar_of_inset_axes.py
|   |   |   ├── demo_colorbar_with_axes_divider.py
|   |   |   ├── demo_colorbar_with_inset_locator.py
|   |   |   ├── demo_edge_colorbar.py
|   |   |   ├── demo_fixed_size_axes.py
|   |   |   ├── demo_imagegrid_aspect.py
|   |   |   ├── inset_locator_demo.py
|   |   |   ├── inset_locator_demo2.py
|   |   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   |   ├── parasite_simple.py
|   |   |   ├── parasite_simple2.py
|   |   |   ├── scatter_hist_locatable_axes.py
|   |   |   ├── simple_anchored_artists.py
|   |   |   ├── simple_axes_divider1.py
|   |   |   ├── simple_axes_divider3.py
|   |   |   ├── simple_axesgrid.py
|   |   |   ├── simple_axesgrid2.py
|   |   |   ├── simple_axisline4.py
|   |   |   └── simple_colorbar.py
|   |   ├── axisartist
|   |   |   ├── README.txt
|   |   |   ├── axis_direction.py
|   |   |   ├── demo_axis_direction.py
|   |   |   ├── demo_axisline_style.py
|   |   |   ├── demo_curvelinear_grid.py
|   |   |   ├── demo_curvelinear_grid2.py
|   |   |   ├── demo_floating_axes.py
|   |   |   ├── demo_floating_axis.py
|   |   |   ├── demo_parasite_axes.py
|   |   |   ├── demo_parasite_axes2.py
|   |   |   ├── demo_ticklabel_alignment.py
|   |   |   ├── demo_ticklabel_direction.py
|   |   |   ├── simple_axis_direction01.py
|   |   |   ├── simple_axis_direction03.py
|   |   |   ├── simple_axis_pad.py
|   |   |   ├── simple_axisartist1.py
|   |   |   ├── simple_axisline.py
|   |   |   └── simple_axisline3.py
|   |   ├── color
|   |   |   ├── README.txt
|   |   |   ├── color_by_yvalue.py
|   |   |   ├── color_cycle_default.py
|   |   |   ├── color_demo.py
|   |   |   ├── colorbar_basics.py
|   |   |   ├── colormap_reference.py
|   |   |   ├── custom_cmap.py
|   |   |   ├── named_colors.py
|   |   |   └── set_alpha.py
|   |   ├── event_handling
|   |   |   ├── README.txt
|   |   |   ├── close_event.py
|   |   |   ├── coords_demo.py
|   |   |   ├── cursor_demo.py
|   |   |   ├── data_browser.py
|   |   |   ├── figure_axes_enter_leave.py
|   |   |   ├── ginput_manual_clabel_sgskip.py
|   |   |   ├── image_slices_viewer.py
|   |   |   ├── keypress_demo.py
|   |   |   ├── lasso_demo.py
|   |   |   ├── legend_picking.py
|   |   |   ├── looking_glass.py
|   |   |   ├── path_editor.py
|   |   |   ├── pick_event_demo.py
|   |   |   ├── pick_event_demo2.py
|   |   |   ├── poly_editor.py
|   |   |   ├── pong_sgskip.py
|   |   |   ├── resample.py
|   |   |   ├── timers.py
|   |   |   ├── trifinder_event_demo.py
|   |   |   ├── viewlims.py
|   |   |   └── zoom_window.py
|   |   ├── images_contours_and_fields
|   |   |   ├── README.txt
|   |   |   ├── affine_image.py
|   |   |   ├── barb_demo.py
|   |   |   ├── barcode_demo.py
|   |   |   ├── colormap_interactive_adjustment.py
|   |   |   ├── colormap_normalizations.py
|   |   |   ├── colormap_normalizations_symlognorm.py
|   |   |   ├── contour_corner_mask.py
|   |   |   ├── contour_demo.py
|   |   |   ├── contour_image.py
|   |   |   ├── contour_label_demo.py
|   |   |   ├── contourf_demo.py
|   |   |   ├── contourf_hatching.py
|   |   |   ├── contourf_log.py
|   |   |   ├── contours_in_optimization_demo.py
|   |   |   ├── demo_bboximage.py
|   |   |   ├── figimage_demo.py
|   |   |   ├── image_annotated_heatmap.py
|   |   |   ├── image_antialiasing.py
|   |   |   ├── image_clip_path.py
|   |   |   ├── image_demo.py
|   |   |   ├── image_masked.py
|   |   |   ├── image_nonuniform.py
|   |   |   ├── image_transparency_blend.py
|   |   |   ├── image_zcoord.py
|   |   |   ├── interpolation_methods.py
|   |   |   ├── irregulardatagrid.py
|   |   |   ├── layer_images.py
|   |   |   ├── matshow.py
|   |   |   ├── multi_image.py
|   |   |   ├── pcolor_demo.py
|   |   |   ├── pcolormesh_grids.py
|   |   |   ├── pcolormesh_levels.py
|   |   |   ├── plot_streamplot.py
|   |   |   ├── quadmesh_demo.py
|   |   |   ├── quiver_demo.py
|   |   |   ├── quiver_simple_demo.py
|   |   |   ├── shading_example.py
|   |   |   ├── specgram_demo.py
|   |   |   ├── spy_demos.py
|   |   |   ├── tricontour_demo.py
|   |   |   ├── tricontour_smooth_delaunay.py
|   |   |   ├── tricontour_smooth_user.py
|   |   |   ├── trigradient_demo.py
|   |   |   ├── triinterp_demo.py
|   |   |   ├── tripcolor_demo.py
|   |   |   ├── triplot_demo.py
|   |   |   └── watermark_image.py
|   |   ├── lines_bars_and_markers
|   |   |   ├── README.txt
|   |   |   ├── bar_colors.py
|   |   |   ├── bar_label_demo.py
|   |   |   ├── bar_stacked.py
|   |   |   ├── barchart.py
|   |   |   ├── barh.py
|   |   |   ├── broken_barh.py
|   |   |   ├── capstyle.py
|   |   |   ├── categorical_variables.py
|   |   |   ├── cohere.py
|   |   |   ├── csd_demo.py
|   |   |   ├── curve_error_band.py
|   |   |   ├── errorbar_limits_simple.py
|   |   |   ├── errorbar_subsample.py
|   |   |   ├── eventcollection_demo.py
|   |   |   ├── eventplot_demo.py
|   |   |   ├── fill.py
|   |   |   ├── fill_between_alpha.py
|   |   |   ├── fill_between_demo.py
|   |   |   ├── fill_betweenx_demo.py
|   |   |   ├── filled_step.py
|   |   |   ├── gradient_bar.py
|   |   |   ├── hat_graph.py
|   |   |   ├── horizontal_barchart_distribution.py
|   |   |   ├── joinstyle.py
|   |   |   ├── line_demo_dash_control.py
|   |   |   ├── lines_with_ticks_demo.py
|   |   |   ├── linestyles.py
|   |   |   ├── marker_reference.py
|   |   |   ├── markevery_demo.py
|   |   |   ├── masked_demo.py
|   |   |   ├── multicolored_line.py
|   |   |   ├── multivariate_marker_plot.py
|   |   |   ├── psd_demo.py
|   |   |   ├── scatter_demo2.py
|   |   |   ├── scatter_hist.py
|   |   |   ├── scatter_masked.py
|   |   |   ├── scatter_star_poly.py
|   |   |   ├── scatter_with_legend.py
|   |   |   ├── simple_plot.py
|   |   |   ├── span_regions.py
|   |   |   ├── spectrum_demo.py
|   |   |   ├── stackplot_demo.py
|   |   |   ├── stairs_demo.py
|   |   |   ├── stem_plot.py
|   |   |   ├── step_demo.py
|   |   |   ├── timeline.py
|   |   |   ├── vline_hline_demo.py
|   |   |   └── xcorr_acorr_demo.py
|   |   ├── misc
|   |   |   ├── README.txt
|   |   |   ├── anchored_artists.py
|   |   |   ├── bbox_intersect.py
|   |   |   ├── contour_manual.py
|   |   |   ├── coords_report.py
|   |   |   ├── custom_projection.py
|   |   |   ├── customize_rc.py
|   |   |   ├── demo_agg_filter.py
|   |   |   ├── demo_ribbon_box.py
|   |   |   ├── fig_x.py
|   |   |   ├── fill_spiral.py
|   |   |   ├── findobj_demo.py
|   |   |   ├── font_indexing.py
|   |   |   ├── ftface_props.py
|   |   |   ├── histogram_path.py
|   |   |   ├── hyperlinks_sgskip.py
|   |   |   ├── image_thumbnail_sgskip.py
|   |   |   ├── keyword_plotting.py
|   |   |   ├── logos2.py
|   |   |   ├── multipage_pdf.py
|   |   |   ├── multiprocess_sgskip.py
|   |   |   ├── packed_bubbles.py
|   |   |   ├── patheffect_demo.py
|   |   |   ├── print_stdout_sgskip.py
|   |   |   ├── rasterization_demo.py
|   |   |   ├── set_and_get.py
|   |   |   ├── svg_filter_line.py
|   |   |   ├── svg_filter_pie.py
|   |   |   ├── table_demo.py
|   |   |   ├── tickedstroke_demo.py
|   |   |   ├── transoffset.py
|   |   |   └── zorder_demo.py
|   |   ├── mplot3d
|   |   |   ├── 2dcollections3d.py
|   |   |   ├── 3d_bars.py
|   |   |   ├── README.txt
|   |   |   ├── bars3d.py
|   |   |   ├── box3d.py
|   |   |   ├── contour3d.py
|   |   |   ├── contour3d_2.py
|   |   |   ├── contour3d_3.py
|   |   |   ├── contourf3d.py
|   |   |   ├── contourf3d_2.py
|   |   |   ├── custom_shaded_3d_surface.py
|   |   |   ├── errorbar3d.py
|   |   |   ├── hist3d.py
|   |   |   ├── lines3d.py
|   |   |   ├── lorenz_attractor.py
|   |   |   ├── mixed_subplots.py
|   |   |   ├── offset.py
|   |   |   ├── pathpatch3d.py
|   |   |   ├── polys3d.py
|   |   |   ├── projections.py
|   |   |   ├── quiver3d.py
|   |   |   ├── rotate_axes3d_sgskip.py
|   |   |   ├── scatter3d.py
|   |   |   ├── stem3d_demo.py
|   |   |   ├── subplot3d.py
|   |   |   ├── surface3d.py
|   |   |   ├── surface3d_2.py
|   |   |   ├── surface3d_3.py
|   |   |   ├── surface3d_radial.py
|   |   |   ├── text3d.py
|   |   |   ├── tricontour3d.py
|   |   |   ├── tricontourf3d.py
|   |   |   ├── trisurf3d.py
|   |   |   ├── trisurf3d_2.py
|   |   |   ├── view_planes_3d.py
|   |   |   ├── voxels.py
|   |   |   ├── voxels_numpy_logo.py
|   |   |   ├── voxels_rgb.py
|   |   |   ├── voxels_torus.py
|   |   |   ├── wire3d.py
|   |   |   ├── wire3d_animation_sgskip.py
|   |   |   └── wire3d_zero_stride.py
|   |   ├── pie_and_polar_charts
|   |   |   ├── README.txt
|   |   |   ├── bar_of_pie.py
|   |   |   ├── nested_pie.py
|   |   |   ├── pie_and_donut_labels.py
|   |   |   ├── pie_features.py
|   |   |   ├── polar_bar.py
|   |   |   ├── polar_demo.py
|   |   |   ├── polar_error_caps.py
|   |   |   ├── polar_legend.py
|   |   |   └── polar_scatter.py
|   |   ├── pyplots
|   |   |   ├── README.txt
|   |   |   ├── axline.py
|   |   |   ├── pyplot_simple.py
|   |   |   ├── pyplot_text.py
|   |   |   ├── pyplot_three.py
|   |   |   └── pyplot_two_subplots.py
|   |   ├── scales
|   |   |   ├── README.txt
|   |   |   ├── asinh_demo.py
|   |   |   ├── aspect_loglog.py
|   |   |   ├── custom_scale.py
|   |   |   ├── log_bar.py
|   |   |   ├── log_demo.py
|   |   |   ├── logit_demo.py
|   |   |   ├── power_norm.py
|   |   |   ├── scales.py
|   |   |   ├── semilogx_demo.py
|   |   |   └── symlog_demo.py
|   |   ├── shapes_and_collections
|   |   |   ├── README.txt
|   |   |   ├── arrow_guide.py
|   |   |   ├── artist_reference.py
|   |   |   ├── collections.py
|   |   |   ├── compound_path.py
|   |   |   ├── dolphin.py
|   |   |   ├── donut.py
|   |   |   ├── ellipse_collection.py
|   |   |   ├── ellipse_demo.py
|   |   |   ├── fancybox_demo.py
|   |   |   ├── hatch_demo.py
|   |   |   ├── hatch_style_reference.py
|   |   |   ├── line_collection.py
|   |   |   ├── patch_collection.py
|   |   |   ├── path_patch.py
|   |   |   ├── quad_bezier.py
|   |   |   └── scatter.py
|   |   ├── showcase
|   |   |   ├── README.txt
|   |   |   ├── anatomy.py
|   |   |   ├── firefox.py
|   |   |   ├── integral.py
|   |   |   ├── mandelbrot.py
|   |   |   ├── stock_prices.py
|   |   |   └── xkcd.py
|   |   ├── specialty_plots
|   |   |   ├── README.txt
|   |   |   ├── advanced_hillshading.py
|   |   |   ├── anscombe.py
|   |   |   ├── hinton_demo.py
|   |   |   ├── leftventricle_bullseye.py
|   |   |   ├── mri_demo.py
|   |   |   ├── mri_with_eeg.py
|   |   |   ├── radar_chart.py
|   |   |   ├── sankey_basics.py
|   |   |   ├── sankey_links.py
|   |   |   ├── sankey_rankine.py
|   |   |   ├── skewt.py
|   |   |   └── topographic_hillshading.py
|   |   ├── spines
|   |   |   ├── README.txt
|   |   |   ├── centered_spines_with_arrows.py
|   |   |   ├── multiple_yaxis_with_spines.py
|   |   |   ├── spine_placement_demo.py
|   |   |   ├── spines.py
|   |   |   └── spines_dropped.py
|   |   ├── statistics
|   |   |   ├── README.txt
|   |   |   ├── barchart_demo.py
|   |   |   ├── boxplot.py
|   |   |   ├── boxplot_color.py
|   |   |   ├── boxplot_demo.py
|   |   |   ├── boxplot_vs_violin.py
|   |   |   ├── bxp.py
|   |   |   ├── confidence_ellipse.py
|   |   |   ├── customized_violin.py
|   |   |   ├── errorbar.py
|   |   |   ├── errorbar_features.py
|   |   |   ├── errorbar_limits.py
|   |   |   ├── errorbars_and_boxes.py
|   |   |   ├── hexbin_demo.py
|   |   |   ├── hist.py
|   |   |   ├── histogram_cumulative.py
|   |   |   ├── histogram_features.py
|   |   |   ├── histogram_histtypes.py
|   |   |   ├── histogram_multihist.py
|   |   |   ├── multiple_histograms_side_by_side.py
|   |   |   ├── time_series_histogram.py
|   |   |   └── violinplot.py
|   |   ├── style_sheets
|   |   |   ├── README.txt
|   |   |   ├── bmh.py
|   |   |   ├── dark_background.py
|   |   |   ├── fivethirtyeight.py
|   |   |   ├── ggplot.py
|   |   |   ├── grayscale.py
|   |   |   ├── plot_solarizedlight2.py
|   |   |   └── style_sheets_reference.py
|   |   ├── subplots_axes_and_figures
|   |   |   ├── README.txt
|   |   |   ├── align_labels_demo.py
|   |   |   ├── auto_subplots_adjust.py
|   |   |   ├── axes_box_aspect.py
|   |   |   ├── axes_demo.py
|   |   |   ├── axes_margins.py
|   |   |   ├── axes_props.py
|   |   |   ├── axes_zoom_effect.py
|   |   |   ├── axhspan_demo.py
|   |   |   ├── axis_equal_demo.py
|   |   |   ├── axis_labels_demo.py
|   |   |   ├── broken_axis.py
|   |   |   ├── custom_figure_class.py
|   |   |   ├── demo_constrained_layout.py
|   |   |   ├── demo_tight_layout.py
|   |   |   ├── fahrenheit_celsius_scales.py
|   |   |   ├── figure_size_units.py
|   |   |   ├── figure_title.py
|   |   |   ├── ganged_plots.py
|   |   |   ├── geo_demo.py
|   |   |   ├── gridspec_and_subplots.py
|   |   |   ├── gridspec_multicolumn.py
|   |   |   ├── gridspec_nested.py
|   |   |   ├── invert_axes.py
|   |   |   ├── multiple_figs_demo.py
|   |   |   ├── secondary_axis.py
|   |   |   ├── share_axis_lims_views.py
|   |   |   ├── shared_axis_demo.py
|   |   |   ├── subfigures.py
|   |   |   ├── subplot.py
|   |   |   ├── subplots_adjust.py
|   |   |   ├── subplots_demo.py
|   |   |   ├── two_scales.py
|   |   |   └── zoom_inset_axes.py
|   |   ├── text_labels_and_annotations
|   |   |   ├── README.txt
|   |   |   ├── accented_text.py
|   |   |   ├── align_ylabels.py
|   |   |   ├── angle_annotation.py
|   |   |   ├── angles_on_bracket_arrows.py
|   |   |   ├── annotate_transform.py
|   |   |   ├── annotation_basic.py
|   |   |   ├── annotation_demo.py
|   |   |   ├── annotation_polar.py
|   |   |   ├── arrow_demo.py
|   |   |   ├── autowrap.py
|   |   |   ├── custom_legends.py
|   |   |   ├── date.py
|   |   |   ├── demo_annotation_box.py
|   |   |   ├── demo_text_path.py
|   |   |   ├── demo_text_rotation_mode.py
|   |   |   ├── dfrac_demo.py
|   |   |   ├── engineering_formatter.py
|   |   |   ├── fancyarrow_demo.py
|   |   |   ├── fancytextbox_demo.py
|   |   |   ├── figlegend_demo.py
|   |   |   ├── font_family_rc.py
|   |   |   ├── font_file.py
|   |   |   ├── font_table.py
|   |   |   ├── fonts_demo.py
|   |   |   ├── fonts_demo_kw.py
|   |   |   ├── label_subplots.py
|   |   |   ├── legend.py
|   |   |   ├── legend_demo.py
|   |   |   ├── line_with_text.py
|   |   |   ├── mathtext_asarray.py
|   |   |   ├── mathtext_demo.py
|   |   |   ├── mathtext_examples.py
|   |   |   ├── mathtext_fontfamily_example.py
|   |   |   ├── multiline.py
|   |   |   ├── placing_text_boxes.py
|   |   |   ├── rainbow_text.py
|   |   |   ├── stix_fonts_demo.py
|   |   |   ├── tex_demo.py
|   |   |   ├── text_alignment.py
|   |   |   ├── text_commands.py
|   |   |   ├── text_fontdict.py
|   |   |   ├── text_rotation_relative_to_line.py
|   |   |   ├── titles_demo.py
|   |   |   ├── unicode_minus.py
|   |   |   ├── usetex_baseline_test.py
|   |   |   ├── usetex_fonteffects.py
|   |   |   └── watermark_text.py
|   |   ├── ticks
|   |   |   ├── README.txt
|   |   |   ├── auto_ticks.py
|   |   |   ├── centered_ticklabels.py
|   |   |   ├── colorbar_tick_labelling_demo.py
|   |   |   ├── custom_ticker1.py
|   |   |   ├── date_concise_formatter.py
|   |   |   ├── date_demo_convert.py
|   |   |   ├── date_demo_rrule.py
|   |   |   ├── date_formatters_locators.py
|   |   |   ├── date_index_formatter.py
|   |   |   ├── date_precision_and_epochs.py
|   |   |   ├── dollar_ticks.py
|   |   |   ├── fig_axes_customize_simple.py
|   |   |   ├── major_minor_demo.py
|   |   |   ├── scalarformatter.py
|   |   |   ├── tick-formatters.py
|   |   |   ├── tick-locators.py
|   |   |   ├── tick_label_right.py
|   |   |   ├── tick_labels_from_values.py
|   |   |   ├── tick_xlabel_top.py
|   |   |   ├── ticklabels_rotation.py
|   |   |   └── ticks_too_many.py
|   |   ├── units
|   |   |   ├── README.txt
|   |   |   ├── annotate_with_units.py
|   |   |   ├── artist_tests.py
|   |   |   ├── bar_demo2.py
|   |   |   ├── bar_unit_demo.py
|   |   |   ├── basic_units.py
|   |   |   ├── ellipse_with_units.py
|   |   |   ├── evans_test.py
|   |   |   ├── radian_demo.py
|   |   |   ├── units_sample.py
|   |   |   └── units_scatter.py
|   |   ├── user_interfaces
|   |   |   ├── README.txt
|   |   |   ├── canvasagg.py
|   |   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk3_sgskip.py
|   |   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk4_sgskip.py
|   |   |   ├── embedding_in_qt_sgskip.py
|   |   |   ├── embedding_in_tk_sgskip.py
|   |   |   ├── embedding_in_wx2_sgskip.py
|   |   |   ├── embedding_in_wx3_sgskip.py
|   |   |   ├── embedding_in_wx4_sgskip.py
|   |   |   ├── embedding_in_wx5_sgskip.py
|   |   |   ├── embedding_webagg_sgskip.py
|   |   |   ├── fourier_demo_wx_sgskip.py
|   |   |   ├── gtk3_spreadsheet_sgskip.py
|   |   |   ├── gtk4_spreadsheet_sgskip.py
|   |   |   ├── images
|   |   |   ├── mathtext_wx_sgskip.py
|   |   |   ├── mpl_with_glade3_sgskip.py
|   |   |   ├── mplcvd.py
|   |   |   ├── pylab_with_gtk3_sgskip.py
|   |   |   ├── pylab_with_gtk4_sgskip.py
|   |   |   ├── svg_histogram_sgskip.py
|   |   |   ├── svg_tooltip_sgskip.py
|   |   |   ├── toolmanager_sgskip.py
|   |   |   ├── web_application_server_sgskip.py
|   |   |   └── wxcursor_demo_sgskip.py
|   |   ├── userdemo
|   |   |   ├── README.txt
|   |   |   ├── annotate_explain.py
|   |   |   ├── annotate_simple_coord02.py
|   |   |   ├── annotate_text_arrow.py
|   |   |   ├── connect_simple01.py
|   |   |   ├── connectionstyle_demo.py
|   |   |   ├── custom_boxstyle01.py
|   |   |   ├── demo_gridspec01.py
|   |   |   ├── demo_gridspec03.py
|   |   |   ├── demo_gridspec06.py
|   |   |   ├── pgf_fonts.py
|   |   |   ├── pgf_preamble_sgskip.py
|   |   |   ├── pgf_texsystem.py
|   |   |   ├── simple_annotate01.py
|   |   |   ├── simple_legend01.py
|   |   |   └── simple_legend02.py
|   |   └── widgets
|   |       ├── README.txt
|   |       ├── annotated_cursor.py
|   |       ├── buttons.py
|   |       ├── check_buttons.py
|   |       ├── cursor.py
|   |       ├── lasso_selector_demo_sgskip.py
|   |       ├── menu.py
|   |       ├── mouse_cursor.py
|   |       ├── multicursor.py
|   |       ├── polygon_selector_demo.py
|   |       ├── polygon_selector_simple.py
|   |       ├── radio_buttons.py
|   |       ├── range_slider.py
|   |       ├── rectangle_selector.py
|   |       ├── slider_demo.py
|   |       ├── slider_snap_demo.py
|   |       ├── span_selector.py
|   |       └── textbox.py
|   ├── plot_types
|   |   ├── 3D
|   |   |   ├── README.rst
|   |   |   ├── scatter3d_simple.py
|   |   |   ├── surface3d_simple.py
|   |   |   ├── trisurf3d_simple.py
|   |   |   ├── voxels_simple.py
|   |   |   └── wire3d_simple.py
|   |   ├── README.rst
|   |   ├── arrays
|   |   |   ├── README.rst
|   |   |   ├── barbs.py
|   |   |   ├── contour.py
|   |   |   ├── contourf.py
|   |   |   ├── imshow.py
|   |   |   ├── pcolormesh.py
|   |   |   ├── quiver.py
|   |   |   └── streamplot.py
|   |   ├── basic
|   |   |   ├── README.rst
|   |   |   ├── bar.py
|   |   |   ├── fill_between.py
|   |   |   ├── plot.py
|   |   |   ├── scatter_plot.py
|   |   |   ├── stackplot.py
|   |   |   ├── stem.py
|   |   |   └── step.py
|   |   ├── stats
|   |   |   ├── README.rst
|   |   |   ├── boxplot_plot.py
|   |   |   ├── ecdf.py
|   |   |   ├── errorbar_plot.py
|   |   |   ├── eventplot.py
|   |   |   ├── hexbin.py
|   |   |   ├── hist2d.py
|   |   |   ├── hist_plot.py
|   |   |   ├── pie.py
|   |   |   └── violin.py
|   |   └── unstructured
|   |       ├── README.rst
|   |       ├── tricontour.py
|   |       ├── tricontourf.py
|   |       ├── tripcolor.py
|   |       └── triplot.py
|   ├── tutorials
|   |   ├── artists.py
|   |   ├── images.py
|   |   ├── index.rst
|   |   ├── lifecycle.py
|   |   └── pyplot.py
|   └── users_explain
|       ├── animations
|       |   ├── README.txt
|       |   ├── animations.py
|       |   └── blitting.py
|       ├── artists
|       |   ├── color_cycle.py
|       |   ├── imshow_extent.py
|       |   ├── index.rst
|       |   ├── patheffects_guide.py
|       |   ├── paths.py
|       |   ├── performance.rst
|       |   └── transforms_tutorial.py
|       ├── axes
|       |   ├── arranging_axes.py
|       |   ├── autoscale.py
|       |   ├── colorbar_placement.py
|       |   ├── constrainedlayout_guide.py
|       |   ├── index.rst
|       |   ├── legend_guide.py
|       |   ├── mosaic.py
|       |   └── tight_layout_guide.py
|       ├── axis
|       |   └── index.rst
|       ├── colors
|       |   ├── README.txt
|       |   ├── colorbar_only.py
|       |   ├── colormap-manipulation.py
|       |   ├── colormapnorms.py
|       |   ├── colormaps.py
|       |   └── colors.py
|       ├── customizing.py
|       ├── figure
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── index.rst
|       ├── quick_start.py
|       ├── text
|       |   ├── README.txt
|       |   ├── annotations.py
|       |   ├── fonts.py
|       |   ├── mathtext.py
|       |   ├── pgf.py
|       |   ├── text_intro.py
|       |   ├── text_props.py
|       |   └── usetex.py
|       └── toolkits
|           ├── axes_grid.rst
|           ├── axisartist.rst
|           ├── index.rst
|           └── mplot3d.rst
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── typing.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       ├── minver.txt
|       └── mypy.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
└── tools
    ├── README.txt
    ├── boilerplate.py
    ├── cache_zenodo_svg.py
    ├── check_typehints.py
    ├── create_DejaVuDisplay.sh
    ├── embed_js.py
    ├── gh_api.py
    ├── github_stats.py
    ├── make_icons.py
    ├── memleak.py
    ├── run_examples.py
    ├── subset.py
    ├── triage_tests.py
    └── visualize_tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [ENH]: Add get/set_antialiased to Text objects

Description: ### Problem

Currently, Text objects always retrieve their antialiasing state via the global rcParams["text.antialias"], unlike other artists for which this can be configured on a per-artist basis via `set_antialiased` (and read via `set_antialiased`).

### Proposed solution

Add similar getters/setters on Text objects (also adjusting Annotations accordingly, if needed) and use that info in the drawing stage.

Should be relatively easy to implement, except that the slight fiddling needed with backends requires some understanding of backend code (I think we need to replace the access to `rcParams["text.antialiased"]` by going through the GraphicsContext state).

Patch information:
diff --git a/lib/matplotlib/backends/backend_agg.py b/lib/matplotlib/backends/backend_agg.py
index 7d038a998f..1e43736fd9 100644
--- a/lib/matplotlib/backends/backend_agg.py
+++ b/lib/matplotlib/backends/backend_agg.py
@@ -206,7 +206,7 @@ class RendererAgg(RendererBase):
         # space) in the following call to draw_text_image).
         font.set_text(s, 0, flags=get_hinting_flag())
         font.draw_glyphs_to_bitmap(
-            antialiased=mpl.rcParams['text.antialiased'])
+            antialiased=bool(gc.get_antialiased()))
         d = font.get_descent() / 64.0
         # The descent needs to be adjusted for the angle.
         xo, yo = font.get_bitmap_offset()
diff --git a/lib/matplotlib/backends/backend_cairo.py b/lib/matplotlib/backends/backend_cairo.py
index 9ccadcdf1c..7f1888b4dd 100644
--- a/lib/matplotlib/backends/backend_cairo.py
+++ b/lib/matplotlib/backends/backend_cairo.py
@@ -205,7 +205,7 @@ class RendererCairo(RendererBase):
             ctx.set_font_size(self.points_to_pixels(prop.get_size_in_points()))
             opts = cairo.FontOptions()
             opts.set_antialias(
-                cairo.ANTIALIAS_DEFAULT if mpl.rcParams["text.antialiased"]
+                cairo.ANTIALIAS_DEFAULT if gc.get_antialiased()
                 else cairo.ANTIALIAS_NONE)
             ctx.set_font_options(opts)
             if angle:
diff --git a/lib/matplotlib/text.py b/lib/matplotlib/text.py
index 4591316cf9..285d06960f 100644
--- a/lib/matplotlib/text.py
+++ b/lib/matplotlib/text.py
@@ -167,6 +167,7 @@ class Text(Artist):
         transform_rotates_text=False,
         linespacing=None,
         rotation_mode=None,
+        antialiased=None,
     ):
         self.set_text(text)
         self.set_color(
@@ -187,6 +188,7 @@ class Text(Artist):
             linespacing = 1.2  # Maybe use rcParam later.
         self.set_linespacing(linespacing)
         self.set_rotation_mode(rotation_mode)
+        self.set_antialiased(antialiased)
 
     def update(self, kwargs):
         # docstring inherited
@@ -309,6 +311,24 @@ class Text(Artist):
         """Return the text rotation mode."""
         return self._rotation_mode
 
+    def get_antialiased(self):
+        """Return whether antialiasing is used for drawing text."""
+        return self._antialiased
+
+    def set_antialiased(self, aa):
+        """
+        Set whether to use antialiased rendering for this text.
+
+        Parameters
+        ----------
+        aa : bool or None
+            If None, defaults to rcParams['text.antialiased'].
+        """
+        if aa is None:
+            aa = mpl.rcParams['text.antialiased']
+        self._antialiased = aa
+        self.stale = True
+
     def update_from(self, other):
         # docstring inherited
         super().update_from(other)
@@ -736,6 +756,7 @@ class Text(Artist):
             gc = renderer.new_gc()
             gc.set_foreground(self.get_color())
             gc.set_alpha(self.get_alpha())
+            gc.set_antialiased(self.get_antialiased())
             gc.set_url(self._url)
             self._set_gc_clip(gc)
 


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `lib/matplotlib/backend_bases.py`.
Extra Requirements: 
Purpose: I need this file to understand the definitions of `GraphicsContextBase` and `RendererBase`, which are essential for implementing the per-artist antialiasing feature correctly across different backends.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/backend_bases.py
Line number range: 1 - 500
Content:
1. """
2. Abstract base classes define the primitives that renderers and
3. graphics contexts must implement to serve as a Matplotlib backend.
4. 
5. `RendererBase`
6.     An abstract base class to handle drawing/rendering operations.
7. 
8. `FigureCanvasBase`
9.     The abstraction layer that separates the `.Figure` from the backend
10.     specific details like a user interface drawing area.
11. 
12. `GraphicsContextBase`
13.     An abstract base class that provides color, line styles, etc.
14. 
15. `Event`
16.     The base class for all of the Matplotlib event handling.  Derived classes
17.     such as `KeyEvent` and `MouseEvent` store the meta data like keys and
18.     buttons pressed, x and y locations in pixel and `~.axes.Axes` coordinates.
19. 
20. `ShowBase`
21.     The base class for the ``Show`` class of each interactive backend; the
22.     'show' callable is then set to ``Show.__call__``.
23. 
24. `ToolContainerBase`
25.     The base class for the Toolbar class of each interactive backend.
26. """
27. 
28. from collections import namedtuple
29. from contextlib import ExitStack, contextmanager, nullcontext
30. from enum import Enum, IntEnum
31. import functools
32. import importlib
33. import inspect
34. import io
35. import itertools
36. import logging
37. import os
38. import sys
39. import time
40. import weakref
41. from weakref import WeakKeyDictionary
42. 
43. import numpy as np
44. 
45. import matplotlib as mpl
46. from matplotlib import (
47.     _api, backend_tools as tools, cbook, colors, _docstring, text,
48.     _tight_bbox, transforms, widgets, get_backend, is_interactive, rcParams)
49. from matplotlib._pylab_helpers import Gcf
50. from matplotlib.backend_managers import ToolManager
51. from matplotlib.cbook import _setattr_cm
52. from matplotlib.layout_engine import ConstrainedLayoutEngine
53. from matplotlib.path import Path
54. from matplotlib.texmanager import TexManager
55. from matplotlib.transforms import Affine2D
56. from matplotlib._enums import JoinStyle, CapStyle
57. 
58. 
59. _log = logging.getLogger(__name__)
60. _default_filetypes = {
61.     'eps': 'Encapsulated Postscript',
62.     'jpg': 'Joint Photographic Experts Group',
63.     'jpeg': 'Joint Photographic Experts Group',
64.     'pdf': 'Portable Document Format',
65.     'pgf': 'PGF code for LaTeX',
66.     'png': 'Portable Network Graphics',
67.     'ps': 'Postscript',
68.     'raw': 'Raw RGBA bitmap',
69.     'rgba': 'Raw RGBA bitmap',
70.     'svg': 'Scalable Vector Graphics',
71.     'svgz': 'Scalable Vector Graphics',
72.     'tif': 'Tagged Image File Format',
73.     'tiff': 'Tagged Image File Format',
74.     'webp': 'WebP Image Format',
75. }
76. _default_backends = {
77.     'eps': 'matplotlib.backends.backend_ps',
78.     'jpg': 'matplotlib.backends.backend_agg',
79.     'jpeg': 'matplotlib.backends.backend_agg',
80.     'pdf': 'matplotlib.backends.backend_pdf',
81.     'pgf': 'matplotlib.backends.backend_pgf',
82.     'png': 'matplotlib.backends.backend_agg',
83.     'ps': 'matplotlib.backends.backend_ps',
84.     'raw': 'matplotlib.backends.backend_agg',
85.     'rgba': 'matplotlib.backends.backend_agg',
86.     'svg': 'matplotlib.backends.backend_svg',
87.     'svgz': 'matplotlib.backends.backend_svg',
88.     'tif': 'matplotlib.backends.backend_agg',
89.     'tiff': 'matplotlib.backends.backend_agg',
90.     'webp': 'matplotlib.backends.backend_agg',
91. }
92. 
93. 
94. def _safe_pyplot_import():
95.     """
96.     Import and return ``pyplot``, correctly setting the backend if one is
97.     already forced.
98.     """
99.     try:
100.         import matplotlib.pyplot as plt
101.     except ImportError:  # Likely due to a framework mismatch.
102.         current_framework = cbook._get_running_interactive_framework()
103.         if current_framework is None:
104.             raise  # No, something else went wrong, likely with the install...
105.         backend_mapping = {
106.             'qt': 'qtagg',
107.             'gtk3': 'gtk3agg',
108.             'gtk4': 'gtk4agg',
109.             'wx': 'wxagg',
110.             'tk': 'tkagg',
111.             'macosx': 'macosx',
112.             'headless': 'agg',
113.         }
114.         backend = backend_mapping[current_framework]
115.         rcParams["backend"] = mpl.rcParamsOrig["backend"] = backend
116.         import matplotlib.pyplot as plt  # Now this should succeed.
117.     return plt
118. 
119. 
120. def register_backend(format, backend, description=None):
121.     """
122.     Register a backend for saving to a given file format.
123. 
124.     Parameters
125.     ----------
126.     format : str
127.         File extension
128.     backend : module string or canvas class
129.         Backend for handling file output
130.     description : str, default: ""
131.         Description of the file type.
132.     """
133.     if description is None:
134.         description = ''
135.     _default_backends[format] = backend
136.     _default_filetypes[format] = description
137. 
138. 
139. def get_registered_canvas_class(format):
140.     """
141.     Return the registered default canvas for given file format.
142.     Handles deferred import of required backend.
143.     """
144.     if format not in _default_backends:
145.         return None
146.     backend_class = _default_backends[format]
147.     if isinstance(backend_class, str):
148.         backend_class = importlib.import_module(backend_class).FigureCanvas
149.         _default_backends[format] = backend_class
150.     return backend_class
151. 
152. 
153. class RendererBase:
154.     """
155.     An abstract base class to handle drawing/rendering operations.
156. 
157.     The following methods must be implemented in the backend for full
158.     functionality (though just implementing `draw_path` alone would give a
159.     highly capable backend):
160. 
161.     * `draw_path`
162.     * `draw_image`
163.     * `draw_gouraud_triangles`
164. 
165.     The following methods *should* be implemented in the backend for
166.     optimization reasons:
167. 
168.     * `draw_text`
169.     * `draw_markers`
170.     * `draw_path_collection`
171.     * `draw_quad_mesh`
172.     """
173. 
174.     def __init__(self):
175.         super().__init__()
176.         self._texmanager = None
177.         self._text2path = text.TextToPath()
178.         self._raster_depth = 0
179.         self._rasterizing = False
180. 
181.     def open_group(self, s, gid=None):
182.         """
183.         Open a grouping element with label *s* and *gid* (if set) as id.
184. 
185.         Only used by the SVG renderer.
186.         """
187. 
188.     def close_group(self, s):
189.         """
190.         Close a grouping element with label *s*.
191. 
192.         Only used by the SVG renderer.
193.         """
194. 
195.     def draw_path(self, gc, path, transform, rgbFace=None):
196.         """Draw a `~.path.Path` instance using the given affine transform."""
197.         raise NotImplementedError
198. 
199.     def draw_markers(self, gc, marker_path, marker_trans, path,
200.                      trans, rgbFace=None):
201.         """
202.         Draw a marker at each of *path*'s vertices (excluding control points).
203. 
204.         The base (fallback) implementation makes multiple calls to `draw_path`.
205.         Backends may want to override this method in order to draw the marker
206.         only once and reuse it multiple times.
207. 
208.         Parameters
209.         ----------
210.         gc : `.GraphicsContextBase`
211.             The graphics context.
212.         marker_trans : `matplotlib.transforms.Transform`
213.             An affine transform applied to the marker.
214.         trans : `matplotlib.transforms.Transform`
215.             An affine transform applied to the path.
216.         """
217.         for vertices, codes in path.iter_segments(trans, simplify=False):
218.             if len(vertices):
219.                 x, y = vertices[-2:]
220.                 self.draw_path(gc, marker_path,
221.                                marker_trans +
222.                                transforms.Affine2D().translate(x, y),
223.                                rgbFace)
224. 
225.     def draw_path_collection(self, gc, master_transform, paths, all_transforms,
226.                              offsets, offset_trans, facecolors, edgecolors,
227.                              linewidths, linestyles, antialiaseds, urls,
228.                              offset_position):
229.         """
230.         Draw a collection of *paths*.
231. 
232.         Each path is first transformed by the corresponding entry
233.         in *all_transforms* (a list of (3, 3) matrices) and then by
234.         *master_transform*.  They are then translated by the corresponding
235.         entry in *offsets*, which has been first transformed by *offset_trans*.
236. 
237.         *facecolors*, *edgecolors*, *linewidths*, *linestyles*, and
238.         *antialiased* are lists that set the corresponding properties.
239. 
240.         *offset_position* is unused now, but the argument is kept for
241.         backwards compatibility.
242. 
243.         The base (fallback) implementation makes multiple calls to `draw_path`.
244.         Backends may want to override this in order to render each set of
245.         path data only once, and then reference that path multiple times with
246.         the different offsets, colors, styles etc.  The generator methods
247.         `_iter_collection_raw_paths` and `_iter_collection` are provided to
248.         help with (and standardize) the implementation across backends.  It
249.         is highly recommended to use those generators, so that changes to the
250.         behavior of `draw_path_collection` can be made globally.
251.         """
252.         path_ids = self._iter_collection_raw_paths(master_transform,
253.                                                    paths, all_transforms)
254. 
255.         for xo, yo, path_id, gc0, rgbFace in self._iter_collection(
256.                 gc, list(path_ids), offsets, offset_trans,
257.                 facecolors, edgecolors, linewidths, linestyles,
258.                 antialiaseds, urls, offset_position):
259.             path, transform = path_id
260.             # Only apply another translation if we have an offset, else we
261.             # reuse the initial transform.
262.             if xo != 0 or yo != 0:
263.                 # The transformation can be used by multiple paths. Since
264.                 # translate is a inplace operation, we need to copy the
265.                 # transformation by .frozen() before applying the translation.
266.                 transform = transform.frozen()
267.                 transform.translate(xo, yo)
268.             self.draw_path(gc0, path, transform, rgbFace)
269. 
270.     def draw_quad_mesh(self, gc, master_transform, meshWidth, meshHeight,
271.                        coordinates, offsets, offsetTrans, facecolors,
272.                        antialiased, edgecolors):
273.         """
274.         Draw a quadmesh.
275. 
276.         The base (fallback) implementation converts the quadmesh to paths and
277.         then calls `draw_path_collection`.
278.         """
279. 
280.         from matplotlib.collections import QuadMesh
281.         paths = QuadMesh._convert_mesh_to_paths(coordinates)
282. 
283.         if edgecolors is None:
284.             edgecolors = facecolors
285.         linewidths = np.array([gc.get_linewidth()], float)
286. 
287.         return self.draw_path_collection(
288.             gc, master_transform, paths, [], offsets, offsetTrans, facecolors,
289.             edgecolors, linewidths, [], [antialiased], [None], 'screen')
290. 
291.     @_api.deprecated("3.7", alternative="draw_gouraud_triangles")
292.     def draw_gouraud_triangle(self, gc, points, colors, transform):
293.         """
294.         Draw a Gouraud-shaded triangle.
295. 
296.         Parameters
297.         ----------
298.         gc : `.GraphicsContextBase`
299.             The graphics context.
300.         points : (3, 2) array-like
301.             Array of (x, y) points for the triangle.
302.         colors : (3, 4) array-like
303.             RGBA colors for each point of the triangle.
304.         transform : `matplotlib.transforms.Transform`
305.             An affine transform to apply to the points.
306.         """
307.         raise NotImplementedError
308. 
309.     def draw_gouraud_triangles(self, gc, triangles_array, colors_array,
310.                                transform):
311.         """
312.         Draw a series of Gouraud triangles.
313. 
314.         Parameters
315.         ----------
316.         gc : `.GraphicsContextBase`
317.             The graphics context.
318.         triangles_array : (N, 3, 2) array-like
319.             Array of *N* (x, y) points for the triangles.
320.         colors_array : (N, 3, 4) array-like
321.             Array of *N* RGBA colors for each point of the triangles.
322.         transform : `matplotlib.transforms.Transform`
323.             An affine transform to apply to the points.
324.         """
325.         raise NotImplementedError
326. 
327.     def _iter_collection_raw_paths(self, master_transform, paths,
328.                                    all_transforms):
329.         """
330.         Helper method (along with `_iter_collection`) to implement
331.         `draw_path_collection` in a memory-efficient manner.
332. 
333.         This method yields all of the base path/transform combinations, given a
334.         master transform, a list of paths and list of transforms.
335. 
336.         The arguments should be exactly what is passed in to
337.         `draw_path_collection`.
338. 
339.         The backend should take each yielded path and transform and create an
340.         object that can be referenced (reused) later.
341.         """
342.         Npaths = len(paths)
343.         Ntransforms = len(all_transforms)
344.         N = max(Npaths, Ntransforms)
345. 
346.         if Npaths == 0:
347.             return
348. 
349.         transform = transforms.IdentityTransform()
350.         for i in range(N):
351.             path = paths[i % Npaths]
352.             if Ntransforms:
353.                 transform = Affine2D(all_transforms[i % Ntransforms])
354.             yield path, transform + master_transform
355. 
356.     def _iter_collection_uses_per_path(self, paths, all_transforms,
357.                                        offsets, facecolors, edgecolors):
358.         """
359.         Compute how many times each raw path object returned by
360.         `_iter_collection_raw_paths` would be used when calling
361.         `_iter_collection`. This is intended for the backend to decide
362.         on the tradeoff between using the paths in-line and storing
363.         them once and reusing. Rounds up in case the number of uses
364.         is not the same for every path.
365.         """
366.         Npaths = len(paths)
367.         if Npaths == 0 or len(facecolors) == len(edgecolors) == 0:
368.             return 0
369.         Npath_ids = max(Npaths, len(all_transforms))
370.         N = max(Npath_ids, len(offsets))
371.         return (N + Npath_ids - 1) // Npath_ids
372. 
373.     def _iter_collection(self, gc, path_ids, offsets, offset_trans, facecolors,
374.                          edgecolors, linewidths, linestyles,
375.                          antialiaseds, urls, offset_position):
376.         """
377.         Helper method (along with `_iter_collection_raw_paths`) to implement
378.         `draw_path_collection` in a memory-efficient manner.
379. 
380.         This method yields all of the path, offset and graphics context
381.         combinations to draw the path collection.  The caller should already
382.         have looped over the results of `_iter_collection_raw_paths` to draw
383.         this collection.
384. 
385.         The arguments should be the same as that passed into
386.         `draw_path_collection`, with the exception of *path_ids*, which is a
387.         list of arbitrary objects that the backend will use to reference one of
388.         the paths created in the `_iter_collection_raw_paths` stage.
389. 
390.         Each yielded result is of the form::
391. 
392.            xo, yo, path_id, gc, rgbFace
393. 
394.         where *xo*, *yo* is an offset; *path_id* is one of the elements of
395.         *path_ids*; *gc* is a graphics context and *rgbFace* is a color to
396.         use for filling the path.
397.         """
398.         Npaths = len(path_ids)
399.         Noffsets = len(offsets)
400.         N = max(Npaths, Noffsets)
401.         Nfacecolors = len(facecolors)
402.         Nedgecolors = len(edgecolors)
403.         Nlinewidths = len(linewidths)
404.         Nlinestyles = len(linestyles)
405.         Nurls = len(urls)
406. 
407.         if (Nfacecolors == 0 and Nedgecolors == 0) or Npaths == 0:
408.             return
409. 
410.         gc0 = self.new_gc()
411.         gc0.copy_properties(gc)
412. 
413.         def cycle_or_default(seq, default=None):
414.             # Cycle over *seq* if it is not empty; else always yield *default*.
415.             return (itertools.cycle(seq) if len(seq)
416.                     else itertools.repeat(default))
417. 
418.         pathids = cycle_or_default(path_ids)
419.         toffsets = cycle_or_default(offset_trans.transform(offsets), (0, 0))
420.         fcs = cycle_or_default(facecolors)
421.         ecs = cycle_or_default(edgecolors)
422.         lws = cycle_or_default(linewidths)
423.         lss = cycle_or_default(linestyles)
424.         aas = cycle_or_default(antialiaseds)
425.         urls = cycle_or_default(urls)
426. 
427.         if Nedgecolors == 0:
428.             gc0.set_linewidth(0.0)
429. 
430.         for pathid, (xo, yo), fc, ec, lw, ls, aa, url in itertools.islice(
431.                 zip(pathids, toffsets, fcs, ecs, lws, lss, aas, urls), N):
432.             if not (np.isfinite(xo) and np.isfinite(yo)):
433.                 continue
434.             if Nedgecolors:
435.                 if Nlinewidths:
436.                     gc0.set_linewidth(lw)
437.                 if Nlinestyles:
438.                     gc0.set_dashes(*ls)
439.                 if len(ec) == 4 and ec[3] == 0.0:
440.                     gc0.set_linewidth(0)
441.                 else:
442.                     gc0.set_foreground(ec)
443.             if fc is not None and len(fc) == 4 and fc[3] == 0:
444.                 fc = None
445.             gc0.set_antialiased(aa)
446.             if Nurls:
447.                 gc0.set_url(url)
448.             yield xo, yo, pathid, gc0, fc
449.         gc0.restore()
450. 
451.     def get_image_magnification(self):
452.         """
453.         Get the factor by which to magnify images passed to `draw_image`.
454.         Allows a backend to have images at a different resolution to other
455.         artists.
456.         """
457.         return 1.0
458. 
459.     def draw_image(self, gc, x, y, im, transform=None):
460.         """
461.         Draw an RGBA image.
462. 
463.         Parameters
464.         ----------
465.         gc : `.GraphicsContextBase`
466.             A graphics context with clipping information.
467. 
468.         x : scalar
469.             The distance in physical units (i.e., dots or pixels) from the left
470.             hand side of the canvas.
471. 
472.         y : scalar
473.             The distance in physical units (i.e., dots or pixels) from the
474.             bottom side of the canvas.
475. 
476.         im : (N, M, 4) array of `numpy.uint8`
477.             An array of RGBA pixels.
478. 
479.         transform : `~matplotlib.transforms.Affine2DBase`
480.             If and only if the concrete backend is written such that
481.             `option_scale_image` returns ``True``, an affine transformation
482.             (i.e., an `.Affine2DBase`) *may* be passed to `draw_image`.  The
483.             translation vector of the transformation is given in physical units
484.             (i.e., dots or pixels). Note that the transformation does not
485.             override *x* and *y*, and has to be applied *before* translating
486.             the result by *x* and *y* (this can be accomplished by adding *x*
487.             and *y* to the translation vector defined by *transform*).
488.         """
489.         raise NotImplementedError
490. 
491.     def option_image_nocomposite(self):
492.         """
493.         Return whether image composition by Matplotlib should be skipped.
494. 
495.         Raster backends should usually return False (letting the C-level
496.         rasterizer take care of image composition); vector backends should
497.         usually return ``not rcParams["image.composite_image"]``.
498.         """
499.         return False
500. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:40:25,777 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to add `get/set_antialiased` to `Text` objects. The provided patch modifies `text.py` to use `gc.set_antialiased()` and backend renderers to use `gc.get_antialiased()`. The `GraphicsContextBase` class, which should define these methods, is missing from the provided context of `lib/matplotlib/backend_bases.py`. To understand how the antialiasing state is managed in the graphics context, I need the definition of `GraphicsContextBase`. I also need to see the default `draw_text` implementation in `RendererBase` to understand the behavior of backends that don't provide a custom one." query='Please provide the full class definition of `GraphicsContextBase` and the `draw_text` method from `RendererBase` from the file `lib/matplotlib/backend_bases.py`.' extra_requirements='' purpose='I need to understand the implementation of `get/set_antialiased` on the graphics context and the default text rendering implementation to verify the correctness of the proposed patch.'
2025-12-21 08:40:25,778 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full class definition of `GraphicsContextBase` and the `draw_text` method from `RendererBase` from the file `lib/matplotlib/backend_bases.py`.
2025-12-21 08:40:25,778 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:40:25,778 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:40:25,779 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:40:25,779 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full class definition of `GraphicsContextBase` and the `draw_text` method from `RendererBase` from the file `lib/matplotlib/backend_bases.py`.
Purpose: I need to understand the implementation of `get/set_antialiased` on the graphics context and the default text rendering implementation to verify the correctness of the proposed patch.
2025-12-21 08:40:37,268 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the file `lib/matplotlib/backend_bases.py` and identified the `GraphicsContextBase` class and the `draw_text` method within the `RendererBase` class. I will now retrieve the full class definition for `GraphicsContextBase` and the `draw_text` method definition. This will provide the necessary context to understand the implementation of `get/set_antialiased` and the default text rendering behavior.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1233.0, "relative_path": "lib/matplotlib/backend_bases.py", "end_line": 1262.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2173, 'candidates_token_count': 150, 'total_token_count': 3605, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2173}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 150}], 'thoughts_token_count': 1282, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7385659281412761, 'model_name': 'gemini-2.5-pro'} id='run--7d53bf01-db71-4f15-b563-6e83a5c72f17-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 781.0, 'relative_path': 'lib/matplotlib/backend_bases.py', 'end_line': 919.0}, 'id': '8d9b4767-41e2-4bb4-9f6d-abf24280ff52', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 1233.0, 'relative_path': 'lib/matplotlib/backend_bases.py', 'end_line': 1262.0}, 'id': 'a98e157e-6a67-42fc-b459-15a57bf4814a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2173, 'output_tokens': 150, 'total_tokens': 3605, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1282}}
2025-12-21 08:40:56,383 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the requested code snippets. I will first find the `RendererBase` class to identify the `draw_text` method's location and then extract the relevant code for both the `GraphicsContextBase` class and the `draw_text` method. This will allow for a complete analysis of the anti-aliasing and text rendering implementations." additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"type": "class_definition", "relative_path": "lib/matplotlib/backend_bases.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4687, 'candidates_token_count': 107, 'total_token_count': 6327, 'cached_content_token_count': 1677, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4687}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1677}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 107}], 'thoughts_token_count': 1533}, 'finish_reason': 'STOP', 'avg_logprobs': -1.9340857389931367, 'model_name': 'gemini-2.5-pro'} id='run--5935397a-66f9-4ecd-8918-69eb83ceb545-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'type': 'class_definition', 'relative_path': 'lib/matplotlib/backend_bases.py'}, 'id': 'af77026f-e845-4feb-8613-46759b7912dd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4687, 'output_tokens': 107, 'total_tokens': 6327, 'input_token_details': {'cache_read': 1677}, 'output_token_details': {'reasoning': 1533}}
2025-12-21 08:40:59,338 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located and retrieved the required code from `lib/matplotlib/backend_bases.py`. Specifically, I have extracted the complete class definition of `GraphicsContextBase` and the `draw_text` method from the `RendererBase` class. This information should be sufficient to analyze the `get/set_antialiased` implementation and the default text rendering process.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5561, 'candidates_token_count': 77, 'total_token_count': 5813, 'cached_content_token_count': 3380, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5561}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3380}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 77}], 'thoughts_token_count': 175}, 'finish_reason': 'STOP', 'avg_logprobs': -0.30369245851194704, 'model_name': 'gemini-2.5-pro'} id='run--baf6d716-578a-4e1f-96f5-0e36592b3a08-0' usage_metadata={'input_tokens': 5561, 'output_tokens': 77, 'total_tokens': 5813, 'input_token_details': {'cache_read': 3380}, 'output_token_details': {'reasoning': 175}}
2025-12-21 08:40:59,340 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full class definition of `GraphicsContextBase` and the `draw_text` method from `RendererBase` from the file `lib/matplotlib/backend_bases.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to understand the implementation of `get/set_antialiased` on the graphics context and the default text rendering implementation to verify the correctness of the proposed patch.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/backend_bases.py
Line number range: 781 - 919
Content:
781. 
782.     def copy_properties(self, gc):
783.         """Copy properties from *gc* to self."""
784.         self._alpha = gc._alpha
785.         self._forced_alpha = gc._forced_alpha
786.         self._antialiased = gc._antialiased
787.         self._capstyle = gc._capstyle
788.         self._cliprect = gc._cliprect
789.         self._clippath = gc._clippath
790.         self._dashes = gc._dashes
791.         self._joinstyle = gc._joinstyle
792.         self._linestyle = gc._linestyle
793.         self._linewidth = gc._linewidth
794.         self._rgb = gc._rgb
795.         self._hatch = gc._hatch
796.         self._hatch_color = gc._hatch_color
797.         self._hatch_linewidth = gc._hatch_linewidth
798.         self._url = gc._url
799.         self._gid = gc._gid
800.         self._snap = gc._snap
801.         self._sketch = gc._sketch
802. 
803.     def restore(self):
804.         """
805.         Restore the graphics context from the stack - needed only
806.         for backends that save graphics contexts on a stack.
807.         """
808. 
809.     def get_alpha(self):
810.         """
811.         Return the alpha value used for blending - not supported on all
812.         backends.
813.         """
814.         return self._alpha
815. 
816.     def get_antialiased(self):
817.         """Return whether the object should try to do antialiased rendering."""
818.         return self._antialiased
819. 
820.     def get_capstyle(self):
821.         """Return the `.CapStyle`."""
822.         return self._capstyle.name
823. 
824.     def get_clip_rectangle(self):
825.         """
826.         Return the clip rectangle as a `~matplotlib.transforms.Bbox` instance.
827.         """
828.         return self._cliprect
829. 
830.     def get_clip_path(self):
831.         """
832.         Return the clip path in the form (path, transform), where path
833.         is a `~.path.Path` instance, and transform is
834.         an affine transform to apply to the path before clipping.
835.         """
836.         if self._clippath is not None:
837.             tpath, tr = self._clippath.get_transformed_path_and_affine()
838.             if np.all(np.isfinite(tpath.vertices)):
839.                 return tpath, tr
840.             else:
841.                 _log.warning("Ill-defined clip_path detected. Returning None.")
842.                 return None, None
843.         return None, None
844. 
845.     def get_dashes(self):
846.         """
847.         Return the dash style as an (offset, dash-list) pair.
848. 
849.         See `.set_dashes` for details.
850. 
851.         Default value is (None, None).
852.         """
853.         return self._dashes
854. 
855.     def get_forced_alpha(self):
856.         """
857.         Return whether the value given by get_alpha() should be used to
858.         override any other alpha-channel values.
859.         """
860.         return self._forced_alpha
861. 
862.     def get_joinstyle(self):
863.         """Return the `.JoinStyle`."""
864.         return self._joinstyle.name
865. 
866.     def get_linewidth(self):
867.         """Return the line width in points."""
868.         return self._linewidth
869. 
870.     def get_rgb(self):
871.         """Return a tuple of three or four floats from 0-1."""
872.         return self._rgb
873. 
874.     def get_url(self):
875.         """Return a url if one is set, None otherwise."""
876.         return self._url
877. 
878.     def get_gid(self):
879.         """Return the object identifier if one is set, None otherwise."""
880.         return self._gid
881. 
882.     def get_snap(self):
883.         """
884.         Return the snap setting, which can be:
885. 
886.         * True: snap vertices to the nearest pixel center
887.         * False: leave vertices as-is
888.         * None: (auto) If the path contains only rectilinear line segments,
889.           round to the nearest pixel center
890.         """
891.         return self._snap
892. 
893.     def set_alpha(self, alpha):
894.         """
895.         Set the alpha value used for blending - not supported on all backends.
896. 
897.         If ``alpha=None`` (the default), the alpha components of the
898.         foreground and fill colors will be used to set their respective
899.         transparencies (where applicable); otherwise, ``alpha`` will override
900.         them.
901.         """
902.         if alpha is not None:
903.             self._alpha = alpha
904.             self._forced_alpha = True
905.         else:
906.             self._alpha = 1.0
907.             self._forced_alpha = False
908.         self.set_foreground(self._rgb, isRGBA=True)
909. 
910.     def set_antialiased(self, b):
911.         """Set whether object should be drawn with antialiased rendering."""
912.         # Use ints to make life easier on extension code trying to read the gc.
913.         self._antialiased = int(bool(b))
914. 
915.     @_docstring.interpd
916.     def set_capstyle(self, cs):
917.         """
918.         Set how to draw endpoints of lines.


File: lib/matplotlib/backend_bases.py
Line number range: 1233 - 1262
Content:
1233.             # https://docs.python.org/3/library/stdtypes.html#boolean-values
1234.             if ret == 0:
1235.                 self.callbacks.remove((func, args, kwargs))
1236. 
1237.         if len(self.callbacks) == 0:
1238.             self.stop()
1239. 
1240. 
1241. class Event:
1242.     """
1243.     A Matplotlib event.
1244. 
1245.     The following attributes are defined and shown with their default values.
1246.     Subclasses may define additional attributes.
1247. 
1248.     Attributes
1249.     ----------
1250.     name : str
1251.         The event name.
1252.     canvas : `FigureCanvasBase`
1253.         The backend-specific canvas instance generating the event.
1254.     guiEvent
1255.         The GUI event that triggered the Matplotlib event.
1256.     """
1257. 
1258.     def __init__(self, name, canvas, guiEvent=None):
1259.         self.name = name
1260.         self.canvas = canvas
1261.         self._guiEvent = guiEvent
1262.         self._guiEvent_deleted = False


File: lib/matplotlib/backend_bases.py
Line number range: 1330 - 1331
Content:
class CloseEvent(Event):
    """An event triggered by a figure being closed."""


File: lib/matplotlib/backend_bases.py
Line number range: 1396 - 1401
Content:
class MouseButton(IntEnum):
    LEFT = 1
    MIDDLE = 2
    RIGHT = 3
    BACK = 8
    FORWARD = 9


File: lib/matplotlib/backend_bases.py
Line number range: 2561 - 2563
Content:
class NonGuiException(Exception):
    """Raised when trying show a figure in a non-GUI backend."""
    pass


File: lib/matplotlib/backend_bases.py
Line number range: 2767 - 2777
Content:
class _Mode(str, Enum):
    NONE = ""
    PAN = "pan/zoom"
    ZOOM = "zoom rect"

    def __str__(self):
        return self.value

    @property
    def _navigate_mode(self):
        return self.name if self is not _Mode.NONE else None


File: lib/matplotlib/backend_bases.py
Line number range: 3462 - 3470
Content:
class ShowBase(_Backend):
    """
    Simple base class to generate a ``show()`` function in backends.

    Subclass must override ``mainloop()`` method.
    """

    def __call__(self, block=None):
        return self.show(block=block)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:41:46,636 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The query asks for the full class definition of `GraphicsContextBase`.\n   - The purpose mentions understanding `get/set_antialiased`.\n2. Extended relevance:\n   - The context from lines 781-919 contains a large portion of the methods for `GraphicsContextBase`, including `get_antialiased` and `set_antialiased`.\n   - While not the complete definition, this is the most relevant and substantial piece of context available to satisfy the user's request regarding `GraphicsContextBase`.", relative_path='lib/matplotlib/backend_bases.py', start_line=781, end_line=919)]
2025-12-21 08:41:46,638 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full class definition of `GraphicsContextBase` and the `draw_text` method from `RendererBase` from the file `lib/matplotlib/backend_bases.py`.
2025-12-21 08:41:46,638 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:41:46,638 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:41:46,638 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-21 08:41:46,639 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 08:41:46,639 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── good-first-issue.yml
|       ├── mypy-stubtest.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       ├── stale.yml
|       └── tests.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   ├── codespell-ignore-words.txt
|   ├── export_sdist_name.py
|   └── mypy-stubtest-allowlist.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24531-DOS.rst
|   |   |   |   ├── 24661-AAMW.rst
|   |   |   |   ├── 25044-YI.rst
|   |   |   |   ├── 25061-DS.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25112-GG.rst
|   |   |   |   ├── 25192-DS.rst
|   |   |   |   ├── 25255-RR.rst
|   |   |   |   ├── 25456-AL.rst
|   |   |   |   └── 25697-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23200-OG.rst
|   |   |   |   ├── 24312-AL.rst
|   |   |   |   ├── 24913-AL.rst
|   |   |   |   ├── 24985-OG.rst
|   |   |   |   ├── 24990-OG.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25138-AL.rst
|   |   |   |   ├── 25282-AL.rst
|   |   |   |   ├── 25352-GL.rst
|   |   |   |   ├── 25427-AL.rst
|   |   |   |   ├── 25469-AL.rst
|   |   |   |   ├── 25484-AL.rst
|   |   |   |   ├── 25557-AL.rst
|   |   |   |   ├── 25559-AL.rst
|   |   |   |   ├── 25584-KS.rst
|   |   |   |   ├── 25588-KS.rst
|   |   |   |   ├── 25651-REC.rst
|   |   |   |   ├── 25708-AL.rst
|   |   |   |   ├── 25728-OG.rst
|   |   |   |   ├── 25742-ES.rst
|   |   |   |   ├── 25774-AL.rst
|   |   |   |   ├── 25781-AL.rst
|   |   |   |   ├── 25841-AL.rst
|   |   |   |   ├── 25859-ES.rst
|   |   |   |   └── 25889-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24531-DOS.rst
|   |   |   |   ├── 24919-KS.rst
|   |   |   |   ├── 24976-KS.rst
|   |   |   |   └── 25475-ES.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24923-ES.rst
|   |   |       ├── 24984-OG.rst
|   |   |       ├── 24XXX-OG.rst
|   |   |       ├── 25456-AL.rst
|   |   |       ├── 25584-KS.rst
|   |   |       └── 25648-TS.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.6.0.rst
|   |   |   ├── api_changes_3.6.1.rst
|   |   |   ├── api_changes_3.7.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.7.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── typing_api.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plots_shareview.rst
|       |   ├── README.rst
|       |   ├── auto_minor_tick.rst
|       |   ├── ecdf.rst
|       |   ├── get_suptitle.rst
|       |   ├── mathtext_supports_text.rst
|       |   ├── new_color_spec_tuple.rst
|       |   ├── pie_hatch.rst
|       |   ├── pie_shadow_control.rst
|       |   ├── savefig_bbox_layout.rst
|       |   ├── shadow_shade.rst
|       |   ├── spinesproxyset.rst
|       |   ├── tick_labelfont_param.rst
|       |   ├── updated_mathtext.rst
|       |   └── widget_button_styling.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── github_stats_3.6.0.rst
|       |   ├── github_stats_3.6.1.rst
|       |   ├── github_stats_3.6.2.rst
|       |   ├── github_stats_3.6.3.rst
|       |   ├── github_stats_3.7.0.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   ├── whats_new_3.6.0.rst
|       |   └── whats_new_3.7.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── galleries
|   ├── examples
|   |   ├── README.txt
|   |   ├── animation
|   |   |   ├── README.txt
|   |   |   ├── animate_decay.py
|   |   |   ├── animated_histogram.py
|   |   |   ├── animation_demo.py
|   |   |   ├── bayes_update.py
|   |   |   ├── double_pendulum.py
|   |   |   ├── dynamic_image.py
|   |   |   ├── frame_grabbing_sgskip.py
|   |   |   ├── multiple_axes.py
|   |   |   ├── pause_resume.py
|   |   |   ├── rain.py
|   |   |   ├── random_walk.py
|   |   |   ├── simple_anim.py
|   |   |   ├── simple_scatter.py
|   |   |   ├── strip_chart.py
|   |   |   └── unchained.py
|   |   ├── axes_grid1
|   |   |   ├── README.txt
|   |   |   ├── demo_anchored_direction_arrows.py
|   |   |   ├── demo_axes_divider.py
|   |   |   ├── demo_axes_grid.py
|   |   |   ├── demo_axes_grid2.py
|   |   |   ├── demo_axes_hbox_divider.py
|   |   |   ├── demo_axes_rgb.py
|   |   |   ├── demo_colorbar_of_inset_axes.py
|   |   |   ├── demo_colorbar_with_axes_divider.py
|   |   |   ├── demo_colorbar_with_inset_locator.py
|   |   |   ├── demo_edge_colorbar.py
|   |   |   ├── demo_fixed_size_axes.py
|   |   |   ├── demo_imagegrid_aspect.py
|   |   |   ├── inset_locator_demo.py
|   |   |   ├── inset_locator_demo2.py
|   |   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   |   ├── parasite_simple.py
|   |   |   ├── parasite_simple2.py
|   |   |   ├── scatter_hist_locatable_axes.py
|   |   |   ├── simple_anchored_artists.py
|   |   |   ├── simple_axes_divider1.py
|   |   |   ├── simple_axes_divider3.py
|   |   |   ├── simple_axesgrid.py
|   |   |   ├── simple_axesgrid2.py
|   |   |   ├── simple_axisline4.py
|   |   |   └── simple_colorbar.py
|   |   ├── axisartist
|   |   |   ├── README.txt
|   |   |   ├── axis_direction.py
|   |   |   ├── demo_axis_direction.py
|   |   |   ├── demo_axisline_style.py
|   |   |   ├── demo_curvelinear_grid.py
|   |   |   ├── demo_curvelinear_grid2.py
|   |   |   ├── demo_floating_axes.py
|   |   |   ├── demo_floating_axis.py
|   |   |   ├── demo_parasite_axes.py
|   |   |   ├── demo_parasite_axes2.py
|   |   |   ├── demo_ticklabel_alignment.py
|   |   |   ├── demo_ticklabel_direction.py
|   |   |   ├── simple_axis_direction01.py
|   |   |   ├── simple_axis_direction03.py
|   |   |   ├── simple_axis_pad.py
|   |   |   ├── simple_axisartist1.py
|   |   |   ├── simple_axisline.py
|   |   |   └── simple_axisline3.py
|   |   ├── color
|   |   |   ├── README.txt
|   |   |   ├── color_by_yvalue.py
|   |   |   ├── color_cycle_default.py
|   |   |   ├── color_demo.py
|   |   |   ├── colorbar_basics.py
|   |   |   ├── colormap_reference.py
|   |   |   ├── custom_cmap.py
|   |   |   ├── named_colors.py
|   |   |   └── set_alpha.py
|   |   ├── event_handling
|   |   |   ├── README.txt
|   |   |   ├── close_event.py
|   |   |   ├── coords_demo.py
|   |   |   ├── cursor_demo.py
|   |   |   ├── data_browser.py
|   |   |   ├── figure_axes_enter_leave.py
|   |   |   ├── ginput_manual_clabel_sgskip.py
|   |   |   ├── image_slices_viewer.py
|   |   |   ├── keypress_demo.py
|   |   |   ├── lasso_demo.py
|   |   |   ├── legend_picking.py
|   |   |   ├── looking_glass.py
|   |   |   ├── path_editor.py
|   |   |   ├── pick_event_demo.py
|   |   |   ├── pick_event_demo2.py
|   |   |   ├── poly_editor.py
|   |   |   ├── pong_sgskip.py
|   |   |   ├── resample.py
|   |   |   ├── timers.py
|   |   |   ├── trifinder_event_demo.py
|   |   |   ├── viewlims.py
|   |   |   └── zoom_window.py
|   |   ├── images_contours_and_fields
|   |   |   ├── README.txt
|   |   |   ├── affine_image.py
|   |   |   ├── barb_demo.py
|   |   |   ├── barcode_demo.py
|   |   |   ├── colormap_interactive_adjustment.py
|   |   |   ├── colormap_normalizations.py
|   |   |   ├── colormap_normalizations_symlognorm.py
|   |   |   ├── contour_corner_mask.py
|   |   |   ├── contour_demo.py
|   |   |   ├── contour_image.py
|   |   |   ├── contour_label_demo.py
|   |   |   ├── contourf_demo.py
|   |   |   ├── contourf_hatching.py
|   |   |   ├── contourf_log.py
|   |   |   ├── contours_in_optimization_demo.py
|   |   |   ├── demo_bboximage.py
|   |   |   ├── figimage_demo.py
|   |   |   ├── image_annotated_heatmap.py
|   |   |   ├── image_antialiasing.py
|   |   |   ├── image_clip_path.py
|   |   |   ├── image_demo.py
|   |   |   ├── image_masked.py
|   |   |   ├── image_nonuniform.py
|   |   |   ├── image_transparency_blend.py
|   |   |   ├── image_zcoord.py
|   |   |   ├── interpolation_methods.py
|   |   |   ├── irregulardatagrid.py
|   |   |   ├── layer_images.py
|   |   |   ├── matshow.py
|   |   |   ├── multi_image.py
|   |   |   ├── pcolor_demo.py
|   |   |   ├── pcolormesh_grids.py
|   |   |   ├── pcolormesh_levels.py
|   |   |   ├── plot_streamplot.py
|   |   |   ├── quadmesh_demo.py
|   |   |   ├── quiver_demo.py
|   |   |   ├── quiver_simple_demo.py
|   |   |   ├── shading_example.py
|   |   |   ├── specgram_demo.py
|   |   |   ├── spy_demos.py
|   |   |   ├── tricontour_demo.py
|   |   |   ├── tricontour_smooth_delaunay.py
|   |   |   ├── tricontour_smooth_user.py
|   |   |   ├── trigradient_demo.py
|   |   |   ├── triinterp_demo.py
|   |   |   ├── tripcolor_demo.py
|   |   |   ├── triplot_demo.py
|   |   |   └── watermark_image.py
|   |   ├── lines_bars_and_markers
|   |   |   ├── README.txt
|   |   |   ├── bar_colors.py
|   |   |   ├── bar_label_demo.py
|   |   |   ├── bar_stacked.py
|   |   |   ├── barchart.py
|   |   |   ├── barh.py
|   |   |   ├── broken_barh.py
|   |   |   ├── capstyle.py
|   |   |   ├── categorical_variables.py
|   |   |   ├── cohere.py
|   |   |   ├── csd_demo.py
|   |   |   ├── curve_error_band.py
|   |   |   ├── errorbar_limits_simple.py
|   |   |   ├── errorbar_subsample.py
|   |   |   ├── eventcollection_demo.py
|   |   |   ├── eventplot_demo.py
|   |   |   ├── fill.py
|   |   |   ├── fill_between_alpha.py
|   |   |   ├── fill_between_demo.py
|   |   |   ├── fill_betweenx_demo.py
|   |   |   ├── filled_step.py
|   |   |   ├── gradient_bar.py
|   |   |   ├── hat_graph.py
|   |   |   ├── horizontal_barchart_distribution.py
|   |   |   ├── joinstyle.py
|   |   |   ├── line_demo_dash_control.py
|   |   |   ├── lines_with_ticks_demo.py
|   |   |   ├── linestyles.py
|   |   |   ├── marker_reference.py
|   |   |   ├── markevery_demo.py
|   |   |   ├── masked_demo.py
|   |   |   ├── multicolored_line.py
|   |   |   ├── multivariate_marker_plot.py
|   |   |   ├── psd_demo.py
|   |   |   ├── scatter_demo2.py
|   |   |   ├── scatter_hist.py
|   |   |   ├── scatter_masked.py
|   |   |   ├── scatter_star_poly.py
|   |   |   ├── scatter_with_legend.py
|   |   |   ├── simple_plot.py
|   |   |   ├── span_regions.py
|   |   |   ├── spectrum_demo.py
|   |   |   ├── stackplot_demo.py
|   |   |   ├── stairs_demo.py
|   |   |   ├── stem_plot.py
|   |   |   ├── step_demo.py
|   |   |   ├── timeline.py
|   |   |   ├── vline_hline_demo.py
|   |   |   └── xcorr_acorr_demo.py
|   |   ├── misc
|   |   |   ├── README.txt
|   |   |   ├── anchored_artists.py
|   |   |   ├── bbox_intersect.py
|   |   |   ├── contour_manual.py
|   |   |   ├── coords_report.py
|   |   |   ├── custom_projection.py
|   |   |   ├── customize_rc.py
|   |   |   ├── demo_agg_filter.py
|   |   |   ├── demo_ribbon_box.py
|   |   |   ├── fig_x.py
|   |   |   ├── fill_spiral.py
|   |   |   ├── findobj_demo.py
|   |   |   ├── font_indexing.py
|   |   |   ├── ftface_props.py
|   |   |   ├── histogram_path.py
|   |   |   ├── hyperlinks_sgskip.py
|   |   |   ├── image_thumbnail_sgskip.py
|   |   |   ├── keyword_plotting.py
|   |   |   ├── logos2.py
|   |   |   ├── multipage_pdf.py
|   |   |   ├── multiprocess_sgskip.py
|   |   |   ├── packed_bubbles.py
|   |   |   ├── patheffect_demo.py
|   |   |   ├── print_stdout_sgskip.py
|   |   |   ├── rasterization_demo.py
|   |   |   ├── set_and_get.py
|   |   |   ├── svg_filter_line.py
|   |   |   ├── svg_filter_pie.py
|   |   |   ├── table_demo.py
|   |   |   ├── tickedstroke_demo.py
|   |   |   ├── transoffset.py
|   |   |   └── zorder_demo.py
|   |   ├── mplot3d
|   |   |   ├── 2dcollections3d.py
|   |   |   ├── 3d_bars.py
|   |   |   ├── README.txt
|   |   |   ├── bars3d.py
|   |   |   ├── box3d.py
|   |   |   ├── contour3d.py
|   |   |   ├── contour3d_2.py
|   |   |   ├── contour3d_3.py
|   |   |   ├── contourf3d.py
|   |   |   ├── contourf3d_2.py
|   |   |   ├── custom_shaded_3d_surface.py
|   |   |   ├── errorbar3d.py
|   |   |   ├── hist3d.py
|   |   |   ├── lines3d.py
|   |   |   ├── lorenz_attractor.py
|   |   |   ├── mixed_subplots.py
|   |   |   ├── offset.py
|   |   |   ├── pathpatch3d.py
|   |   |   ├── polys3d.py
|   |   |   ├── projections.py
|   |   |   ├── quiver3d.py
|   |   |   ├── rotate_axes3d_sgskip.py
|   |   |   ├── scatter3d.py
|   |   |   ├── stem3d_demo.py
|   |   |   ├── subplot3d.py
|   |   |   ├── surface3d.py
|   |   |   ├── surface3d_2.py
|   |   |   ├── surface3d_3.py
|   |   |   ├── surface3d_radial.py
|   |   |   ├── text3d.py
|   |   |   ├── tricontour3d.py
|   |   |   ├── tricontourf3d.py
|   |   |   ├── trisurf3d.py
|   |   |   ├── trisurf3d_2.py
|   |   |   ├── view_planes_3d.py
|   |   |   ├── voxels.py
|   |   |   ├── voxels_numpy_logo.py
|   |   |   ├── voxels_rgb.py
|   |   |   ├── voxels_torus.py
|   |   |   ├── wire3d.py
|   |   |   ├── wire3d_animation_sgskip.py
|   |   |   └── wire3d_zero_stride.py
|   |   ├── pie_and_polar_charts
|   |   |   ├── README.txt
|   |   |   ├── bar_of_pie.py
|   |   |   ├── nested_pie.py
|   |   |   ├── pie_and_donut_labels.py
|   |   |   ├── pie_features.py
|   |   |   ├── polar_bar.py
|   |   |   ├── polar_demo.py
|   |   |   ├── polar_error_caps.py
|   |   |   ├── polar_legend.py
|   |   |   └── polar_scatter.py
|   |   ├── pyplots
|   |   |   ├── README.txt
|   |   |   ├── axline.py
|   |   |   ├── pyplot_simple.py
|   |   |   ├── pyplot_text.py
|   |   |   ├── pyplot_three.py
|   |   |   └── pyplot_two_subplots.py
|   |   ├── scales
|   |   |   ├── README.txt
|   |   |   ├── asinh_demo.py
|   |   |   ├── aspect_loglog.py
|   |   |   ├── custom_scale.py
|   |   |   ├── log_bar.py
|   |   |   ├── log_demo.py
|   |   |   ├── logit_demo.py
|   |   |   ├── power_norm.py
|   |   |   ├── scales.py
|   |   |   ├── semilogx_demo.py
|   |   |   └── symlog_demo.py
|   |   ├── shapes_and_collections
|   |   |   ├── README.txt
|   |   |   ├── arrow_guide.py
|   |   |   ├── artist_reference.py
|   |   |   ├── collections.py
|   |   |   ├── compound_path.py
|   |   |   ├── dolphin.py
|   |   |   ├── donut.py
|   |   |   ├── ellipse_collection.py
|   |   |   ├── ellipse_demo.py
|   |   |   ├── fancybox_demo.py
|   |   |   ├── hatch_demo.py
|   |   |   ├── hatch_style_reference.py
|   |   |   ├── line_collection.py
|   |   |   ├── patch_collection.py
|   |   |   ├── path_patch.py
|   |   |   ├── quad_bezier.py
|   |   |   └── scatter.py
|   |   ├── showcase
|   |   |   ├── README.txt
|   |   |   ├── anatomy.py
|   |   |   ├── firefox.py
|   |   |   ├── integral.py
|   |   |   ├── mandelbrot.py
|   |   |   ├── stock_prices.py
|   |   |   └── xkcd.py
|   |   ├── specialty_plots
|   |   |   ├── README.txt
|   |   |   ├── advanced_hillshading.py
|   |   |   ├── anscombe.py
|   |   |   ├── hinton_demo.py
|   |   |   ├── leftventricle_bullseye.py
|   |   |   ├── mri_demo.py
|   |   |   ├── mri_with_eeg.py
|   |   |   ├── radar_chart.py
|   |   |   ├── sankey_basics.py
|   |   |   ├── sankey_links.py
|   |   |   ├── sankey_rankine.py
|   |   |   ├── skewt.py
|   |   |   └── topographic_hillshading.py
|   |   ├── spines
|   |   |   ├── README.txt
|   |   |   ├── centered_spines_with_arrows.py
|   |   |   ├── multiple_yaxis_with_spines.py
|   |   |   ├── spine_placement_demo.py
|   |   |   ├── spines.py
|   |   |   └── spines_dropped.py
|   |   ├── statistics
|   |   |   ├── README.txt
|   |   |   ├── barchart_demo.py
|   |   |   ├── boxplot.py
|   |   |   ├── boxplot_color.py
|   |   |   ├── boxplot_demo.py
|   |   |   ├── boxplot_vs_violin.py
|   |   |   ├── bxp.py
|   |   |   ├── confidence_ellipse.py
|   |   |   ├── customized_violin.py
|   |   |   ├── errorbar.py
|   |   |   ├── errorbar_features.py
|   |   |   ├── errorbar_limits.py
|   |   |   ├── errorbars_and_boxes.py
|   |   |   ├── hexbin_demo.py
|   |   |   ├── hist.py
|   |   |   ├── histogram_cumulative.py
|   |   |   ├── histogram_features.py
|   |   |   ├── histogram_histtypes.py
|   |   |   ├── histogram_multihist.py
|   |   |   ├── multiple_histograms_side_by_side.py
|   |   |   ├── time_series_histogram.py
|   |   |   └── violinplot.py
|   |   ├── style_sheets
|   |   |   ├── README.txt
|   |   |   ├── bmh.py
|   |   |   ├── dark_background.py
|   |   |   ├── fivethirtyeight.py
|   |   |   ├── ggplot.py
|   |   |   ├── grayscale.py
|   |   |   ├── plot_solarizedlight2.py
|   |   |   └── style_sheets_reference.py
|   |   ├── subplots_axes_and_figures
|   |   |   ├── README.txt
|   |   |   ├── align_labels_demo.py
|   |   |   ├── auto_subplots_adjust.py
|   |   |   ├── axes_box_aspect.py
|   |   |   ├── axes_demo.py
|   |   |   ├── axes_margins.py
|   |   |   ├── axes_props.py
|   |   |   ├── axes_zoom_effect.py
|   |   |   ├── axhspan_demo.py
|   |   |   ├── axis_equal_demo.py
|   |   |   ├── axis_labels_demo.py
|   |   |   ├── broken_axis.py
|   |   |   ├── custom_figure_class.py
|   |   |   ├── demo_constrained_layout.py
|   |   |   ├── demo_tight_layout.py
|   |   |   ├── fahrenheit_celsius_scales.py
|   |   |   ├── figure_size_units.py
|   |   |   ├── figure_title.py
|   |   |   ├── ganged_plots.py
|   |   |   ├── geo_demo.py
|   |   |   ├── gridspec_and_subplots.py
|   |   |   ├── gridspec_multicolumn.py
|   |   |   ├── gridspec_nested.py
|   |   |   ├── invert_axes.py
|   |   |   ├── multiple_figs_demo.py
|   |   |   ├── secondary_axis.py
|   |   |   ├── share_axis_lims_views.py
|   |   |   ├── shared_axis_demo.py
|   |   |   ├── subfigures.py
|   |   |   ├── subplot.py
|   |   |   ├── subplots_adjust.py
|   |   |   ├── subplots_demo.py
|   |   |   ├── two_scales.py
|   |   |   └── zoom_inset_axes.py
|   |   ├── text_labels_and_annotations
|   |   |   ├── README.txt
|   |   |   ├── accented_text.py
|   |   |   ├── align_ylabels.py
|   |   |   ├── angle_annotation.py
|   |   |   ├── angles_on_bracket_arrows.py
|   |   |   ├── annotate_transform.py
|   |   |   ├── annotation_basic.py
|   |   |   ├── annotation_demo.py
|   |   |   ├── annotation_polar.py
|   |   |   ├── arrow_demo.py
|   |   |   ├── autowrap.py
|   |   |   ├── custom_legends.py
|   |   |   ├── date.py
|   |   |   ├── demo_annotation_box.py
|   |   |   ├── demo_text_path.py
|   |   |   ├── demo_text_rotation_mode.py
|   |   |   ├── dfrac_demo.py
|   |   |   ├── engineering_formatter.py
|   |   |   ├── fancyarrow_demo.py
|   |   |   ├── fancytextbox_demo.py
|   |   |   ├── figlegend_demo.py
|   |   |   ├── font_family_rc.py
|   |   |   ├── font_file.py
|   |   |   ├── font_table.py
|   |   |   ├── fonts_demo.py
|   |   |   ├── fonts_demo_kw.py
|   |   |   ├── label_subplots.py
|   |   |   ├── legend.py
|   |   |   ├── legend_demo.py
|   |   |   ├── line_with_text.py
|   |   |   ├── mathtext_asarray.py
|   |   |   ├── mathtext_demo.py
|   |   |   ├── mathtext_examples.py
|   |   |   ├── mathtext_fontfamily_example.py
|   |   |   ├── multiline.py
|   |   |   ├── placing_text_boxes.py
|   |   |   ├── rainbow_text.py
|   |   |   ├── stix_fonts_demo.py
|   |   |   ├── tex_demo.py
|   |   |   ├── text_alignment.py
|   |   |   ├── text_commands.py
|   |   |   ├── text_fontdict.py
|   |   |   ├── text_rotation_relative_to_line.py
|   |   |   ├── titles_demo.py
|   |   |   ├── unicode_minus.py
|   |   |   ├── usetex_baseline_test.py
|   |   |   ├── usetex_fonteffects.py
|   |   |   └── watermark_text.py
|   |   ├── ticks
|   |   |   ├── README.txt
|   |   |   ├── auto_ticks.py
|   |   |   ├── centered_ticklabels.py
|   |   |   ├── colorbar_tick_labelling_demo.py
|   |   |   ├── custom_ticker1.py
|   |   |   ├── date_concise_formatter.py
|   |   |   ├── date_demo_convert.py
|   |   |   ├── date_demo_rrule.py
|   |   |   ├── date_formatters_locators.py
|   |   |   ├── date_index_formatter.py
|   |   |   ├── date_precision_and_epochs.py
|   |   |   ├── dollar_ticks.py
|   |   |   ├── fig_axes_customize_simple.py
|   |   |   ├── major_minor_demo.py
|   |   |   ├── scalarformatter.py
|   |   |   ├── tick-formatters.py
|   |   |   ├── tick-locators.py
|   |   |   ├── tick_label_right.py
|   |   |   ├── tick_labels_from_values.py
|   |   |   ├── tick_xlabel_top.py
|   |   |   ├── ticklabels_rotation.py
|   |   |   └── ticks_too_many.py
|   |   ├── units
|   |   |   ├── README.txt
|   |   |   ├── annotate_with_units.py
|   |   |   ├── artist_tests.py
|   |   |   ├── bar_demo2.py
|   |   |   ├── bar_unit_demo.py
|   |   |   ├── basic_units.py
|   |   |   ├── ellipse_with_units.py
|   |   |   ├── evans_test.py
|   |   |   ├── radian_demo.py
|   |   |   ├── units_sample.py
|   |   |   └── units_scatter.py
|   |   ├── user_interfaces
|   |   |   ├── README.txt
|   |   |   ├── canvasagg.py
|   |   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk3_sgskip.py
|   |   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk4_sgskip.py
|   |   |   ├── embedding_in_qt_sgskip.py
|   |   |   ├── embedding_in_tk_sgskip.py
|   |   |   ├── embedding_in_wx2_sgskip.py
|   |   |   ├── embedding_in_wx3_sgskip.py
|   |   |   ├── embedding_in_wx4_sgskip.py
|   |   |   ├── embedding_in_wx5_sgskip.py
|   |   |   ├── embedding_webagg_sgskip.py
|   |   |   ├── fourier_demo_wx_sgskip.py
|   |   |   ├── gtk3_spreadsheet_sgskip.py
|   |   |   ├── gtk4_spreadsheet_sgskip.py
|   |   |   ├── images
|   |   |   ├── mathtext_wx_sgskip.py
|   |   |   ├── mpl_with_glade3_sgskip.py
|   |   |   ├── mplcvd.py
|   |   |   ├── pylab_with_gtk3_sgskip.py
|   |   |   ├── pylab_with_gtk4_sgskip.py
|   |   |   ├── svg_histogram_sgskip.py
|   |   |   ├── svg_tooltip_sgskip.py
|   |   |   ├── toolmanager_sgskip.py
|   |   |   ├── web_application_server_sgskip.py
|   |   |   └── wxcursor_demo_sgskip.py
|   |   ├── userdemo
|   |   |   ├── README.txt
|   |   |   ├── annotate_explain.py
|   |   |   ├── annotate_simple_coord02.py
|   |   |   ├── annotate_text_arrow.py
|   |   |   ├── connect_simple01.py
|   |   |   ├── connectionstyle_demo.py
|   |   |   ├── custom_boxstyle01.py
|   |   |   ├── demo_gridspec01.py
|   |   |   ├── demo_gridspec03.py
|   |   |   ├── demo_gridspec06.py
|   |   |   ├── pgf_fonts.py
|   |   |   ├── pgf_preamble_sgskip.py
|   |   |   ├── pgf_texsystem.py
|   |   |   ├── simple_annotate01.py
|   |   |   ├── simple_legend01.py
|   |   |   └── simple_legend02.py
|   |   └── widgets
|   |       ├── README.txt
|   |       ├── annotated_cursor.py
|   |       ├── buttons.py
|   |       ├── check_buttons.py
|   |       ├── cursor.py
|   |       ├── lasso_selector_demo_sgskip.py
|   |       ├── menu.py
|   |       ├── mouse_cursor.py
|   |       ├── multicursor.py
|   |       ├── polygon_selector_demo.py
|   |       ├── polygon_selector_simple.py
|   |       ├── radio_buttons.py
|   |       ├── range_slider.py
|   |       ├── rectangle_selector.py
|   |       ├── slider_demo.py
|   |       ├── slider_snap_demo.py
|   |       ├── span_selector.py
|   |       └── textbox.py
|   ├── plot_types
|   |   ├── 3D
|   |   |   ├── README.rst
|   |   |   ├── scatter3d_simple.py
|   |   |   ├── surface3d_simple.py
|   |   |   ├── trisurf3d_simple.py
|   |   |   ├── voxels_simple.py
|   |   |   └── wire3d_simple.py
|   |   ├── README.rst
|   |   ├── arrays
|   |   |   ├── README.rst
|   |   |   ├── barbs.py
|   |   |   ├── contour.py
|   |   |   ├── contourf.py
|   |   |   ├── imshow.py
|   |   |   ├── pcolormesh.py
|   |   |   ├── quiver.py
|   |   |   └── streamplot.py
|   |   ├── basic
|   |   |   ├── README.rst
|   |   |   ├── bar.py
|   |   |   ├── fill_between.py
|   |   |   ├── plot.py
|   |   |   ├── scatter_plot.py
|   |   |   ├── stackplot.py
|   |   |   ├── stem.py
|   |   |   └── step.py
|   |   ├── stats
|   |   |   ├── README.rst
|   |   |   ├── boxplot_plot.py
|   |   |   ├── ecdf.py
|   |   |   ├── errorbar_plot.py
|   |   |   ├── eventplot.py
|   |   |   ├── hexbin.py
|   |   |   ├── hist2d.py
|   |   |   ├── hist_plot.py
|   |   |   ├── pie.py
|   |   |   └── violin.py
|   |   └── unstructured
|   |       ├── README.rst
|   |       ├── tricontour.py
|   |       ├── tricontourf.py
|   |       ├── tripcolor.py
|   |       └── triplot.py
|   ├── tutorials
|   |   ├── artists.py
|   |   ├── images.py
|   |   ├── index.rst
|   |   ├── lifecycle.py
|   |   └── pyplot.py
|   └── users_explain
|       ├── animations
|       |   ├── README.txt
|       |   ├── animations.py
|       |   └── blitting.py
|       ├── artists
|       |   ├── color_cycle.py
|       |   ├── imshow_extent.py
|       |   ├── index.rst
|       |   ├── patheffects_guide.py
|       |   ├── paths.py
|       |   ├── performance.rst
|       |   └── transforms_tutorial.py
|       ├── axes
|       |   ├── arranging_axes.py
|       |   ├── autoscale.py
|       |   ├── colorbar_placement.py
|       |   ├── constrainedlayout_guide.py
|       |   ├── index.rst
|       |   ├── legend_guide.py
|       |   ├── mosaic.py
|       |   └── tight_layout_guide.py
|       ├── axis
|       |   └── index.rst
|       ├── colors
|       |   ├── README.txt
|       |   ├── colorbar_only.py
|       |   ├── colormap-manipulation.py
|       |   ├── colormapnorms.py
|       |   ├── colormaps.py
|       |   └── colors.py
|       ├── customizing.py
|       ├── figure
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── index.rst
|       ├── quick_start.py
|       ├── text
|       |   ├── README.txt
|       |   ├── annotations.py
|       |   ├── fonts.py
|       |   ├── mathtext.py
|       |   ├── pgf.py
|       |   ├── text_intro.py
|       |   ├── text_props.py
|       |   └── usetex.py
|       └── toolkits
|           ├── axes_grid.rst
|           ├── axisartist.rst
|           ├── index.rst
|           └── mplot3d.rst
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── typing.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       ├── minver.txt
|       └── mypy.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
└── tools
    ├── README.txt
    ├── boilerplate.py
    ├── cache_zenodo_svg.py
    ├── check_typehints.py
    ├── create_DejaVuDisplay.sh
    ├── embed_js.py
    ├── gh_api.py
    ├── github_stats.py
    ├── make_icons.py
    ├── memleak.py
    ├── run_examples.py
    ├── subset.py
    ├── triage_tests.py
    └── visualize_tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [ENH]: Add get/set_antialiased to Text objects

Description: ### Problem

Currently, Text objects always retrieve their antialiasing state via the global rcParams["text.antialias"], unlike other artists for which this can be configured on a per-artist basis via `set_antialiased` (and read via `set_antialiased`).

### Proposed solution

Add similar getters/setters on Text objects (also adjusting Annotations accordingly, if needed) and use that info in the drawing stage.

Should be relatively easy to implement, except that the slight fiddling needed with backends requires some understanding of backend code (I think we need to replace the access to `rcParams["text.antialiased"]` by going through the GraphicsContext state).

Patch information:
diff --git a/lib/matplotlib/backends/backend_agg.py b/lib/matplotlib/backends/backend_agg.py
index 7d038a998f..1e43736fd9 100644
--- a/lib/matplotlib/backends/backend_agg.py
+++ b/lib/matplotlib/backends/backend_agg.py
@@ -206,7 +206,7 @@ class RendererAgg(RendererBase):
         # space) in the following call to draw_text_image).
         font.set_text(s, 0, flags=get_hinting_flag())
         font.draw_glyphs_to_bitmap(
-            antialiased=mpl.rcParams['text.antialiased'])
+            antialiased=bool(gc.get_antialiased()))
         d = font.get_descent() / 64.0
         # The descent needs to be adjusted for the angle.
         xo, yo = font.get_bitmap_offset()
diff --git a/lib/matplotlib/backends/backend_cairo.py b/lib/matplotlib/backends/backend_cairo.py
index 9ccadcdf1c..7f1888b4dd 100644
--- a/lib/matplotlib/backends/backend_cairo.py
+++ b/lib/matplotlib/backends/backend_cairo.py
@@ -205,7 +205,7 @@ class RendererCairo(RendererBase):
             ctx.set_font_size(self.points_to_pixels(prop.get_size_in_points()))
             opts = cairo.FontOptions()
             opts.set_antialias(
-                cairo.ANTIALIAS_DEFAULT if mpl.rcParams["text.antialiased"]
+                cairo.ANTIALIAS_DEFAULT if gc.get_antialiased()
                 else cairo.ANTIALIAS_NONE)
             ctx.set_font_options(opts)
             if angle:
diff --git a/lib/matplotlib/text.py b/lib/matplotlib/text.py
index 4591316cf9..285d06960f 100644
--- a/lib/matplotlib/text.py
+++ b/lib/matplotlib/text.py
@@ -167,6 +167,7 @@ class Text(Artist):
         transform_rotates_text=False,
         linespacing=None,
         rotation_mode=None,
+        antialiased=None,
     ):
         self.set_text(text)
         self.set_color(
@@ -187,6 +188,7 @@ class Text(Artist):
             linespacing = 1.2  # Maybe use rcParam later.
         self.set_linespacing(linespacing)
         self.set_rotation_mode(rotation_mode)
+        self.set_antialiased(antialiased)
 
     def update(self, kwargs):
         # docstring inherited
@@ -309,6 +311,24 @@ class Text(Artist):
         """Return the text rotation mode."""
         return self._rotation_mode
 
+    def get_antialiased(self):
+        """Return whether antialiasing is used for drawing text."""
+        return self._antialiased
+
+    def set_antialiased(self, aa):
+        """
+        Set whether to use antialiased rendering for this text.
+
+        Parameters
+        ----------
+        aa : bool or None
+            If None, defaults to rcParams['text.antialiased'].
+        """
+        if aa is None:
+            aa = mpl.rcParams['text.antialiased']
+        self._antialiased = aa
+        self.stale = True
+
     def update_from(self, other):
         # docstring inherited
         super().update_from(other)
@@ -736,6 +756,7 @@ class Text(Artist):
             gc = renderer.new_gc()
             gc.set_foreground(self.get_color())
             gc.set_alpha(self.get_alpha())
+            gc.set_antialiased(self.get_antialiased())
             gc.set_url(self._url)
             self._set_gc_clip(gc)
 


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `lib/matplotlib/backend_bases.py`.
Extra Requirements: 
Purpose: I need this file to understand the definitions of `GraphicsContextBase` and `RendererBase`, which are essential for implementing the per-artist antialiasing feature correctly across different backends.

Previous refined query 2:
Essential Query: Please provide the full class definition of `GraphicsContextBase` and the `draw_text` method from `RendererBase` from the file `lib/matplotlib/backend_bases.py`.
Extra Requirements: 
Purpose: I need to understand the implementation of `get/set_antialiased` on the graphics context and the default text rendering implementation to verify the correctness of the proposed patch.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/backend_bases.py
Line number range: 1 - 500
Content:
1. """
2. Abstract base classes define the primitives that renderers and
3. graphics contexts must implement to serve as a Matplotlib backend.
4. 
5. `RendererBase`
6.     An abstract base class to handle drawing/rendering operations.
7. 
8. `FigureCanvasBase`
9.     The abstraction layer that separates the `.Figure` from the backend
10.     specific details like a user interface drawing area.
11. 
12. `GraphicsContextBase`
13.     An abstract base class that provides color, line styles, etc.
14. 
15. `Event`
16.     The base class for all of the Matplotlib event handling.  Derived classes
17.     such as `KeyEvent` and `MouseEvent` store the meta data like keys and
18.     buttons pressed, x and y locations in pixel and `~.axes.Axes` coordinates.
19. 
20. `ShowBase`
21.     The base class for the ``Show`` class of each interactive backend; the
22.     'show' callable is then set to ``Show.__call__``.
23. 
24. `ToolContainerBase`
25.     The base class for the Toolbar class of each interactive backend.
26. """
27. 
28. from collections import namedtuple
29. from contextlib import ExitStack, contextmanager, nullcontext
30. from enum import Enum, IntEnum
31. import functools
32. import importlib
33. import inspect
34. import io
35. import itertools
36. import logging
37. import os
38. import sys
39. import time
40. import weakref
41. from weakref import WeakKeyDictionary
42. 
43. import numpy as np
44. 
45. import matplotlib as mpl
46. from matplotlib import (
47.     _api, backend_tools as tools, cbook, colors, _docstring, text,
48.     _tight_bbox, transforms, widgets, get_backend, is_interactive, rcParams)
49. from matplotlib._pylab_helpers import Gcf
50. from matplotlib.backend_managers import ToolManager
51. from matplotlib.cbook import _setattr_cm
52. from matplotlib.layout_engine import ConstrainedLayoutEngine
53. from matplotlib.path import Path
54. from matplotlib.texmanager import TexManager
55. from matplotlib.transforms import Affine2D
56. from matplotlib._enums import JoinStyle, CapStyle
57. 
58. 
59. _log = logging.getLogger(__name__)
60. _default_filetypes = {
61.     'eps': 'Encapsulated Postscript',
62.     'jpg': 'Joint Photographic Experts Group',
63.     'jpeg': 'Joint Photographic Experts Group',
64.     'pdf': 'Portable Document Format',
65.     'pgf': 'PGF code for LaTeX',
66.     'png': 'Portable Network Graphics',
67.     'ps': 'Postscript',
68.     'raw': 'Raw RGBA bitmap',
69.     'rgba': 'Raw RGBA bitmap',
70.     'svg': 'Scalable Vector Graphics',
71.     'svgz': 'Scalable Vector Graphics',
72.     'tif': 'Tagged Image File Format',
73.     'tiff': 'Tagged Image File Format',
74.     'webp': 'WebP Image Format',
75. }
76. _default_backends = {
77.     'eps': 'matplotlib.backends.backend_ps',
78.     'jpg': 'matplotlib.backends.backend_agg',
79.     'jpeg': 'matplotlib.backends.backend_agg',
80.     'pdf': 'matplotlib.backends.backend_pdf',
81.     'pgf': 'matplotlib.backends.backend_pgf',
82.     'png': 'matplotlib.backends.backend_agg',
83.     'ps': 'matplotlib.backends.backend_ps',
84.     'raw': 'matplotlib.backends.backend_agg',
85.     'rgba': 'matplotlib.backends.backend_agg',
86.     'svg': 'matplotlib.backends.backend_svg',
87.     'svgz': 'matplotlib.backends.backend_svg',
88.     'tif': 'matplotlib.backends.backend_agg',
89.     'tiff': 'matplotlib.backends.backend_agg',
90.     'webp': 'matplotlib.backends.backend_agg',
91. }
92. 
93. 
94. def _safe_pyplot_import():
95.     """
96.     Import and return ``pyplot``, correctly setting the backend if one is
97.     already forced.
98.     """
99.     try:
100.         import matplotlib.pyplot as plt
101.     except ImportError:  # Likely due to a framework mismatch.
102.         current_framework = cbook._get_running_interactive_framework()
103.         if current_framework is None:
104.             raise  # No, something else went wrong, likely with the install...
105.         backend_mapping = {
106.             'qt': 'qtagg',
107.             'gtk3': 'gtk3agg',
108.             'gtk4': 'gtk4agg',
109.             'wx': 'wxagg',
110.             'tk': 'tkagg',
111.             'macosx': 'macosx',
112.             'headless': 'agg',
113.         }
114.         backend = backend_mapping[current_framework]
115.         rcParams["backend"] = mpl.rcParamsOrig["backend"] = backend
116.         import matplotlib.pyplot as plt  # Now this should succeed.
117.     return plt
118. 
119. 
120. def register_backend(format, backend, description=None):
121.     """
122.     Register a backend for saving to a given file format.
123. 
124.     Parameters
125.     ----------
126.     format : str
127.         File extension
128.     backend : module string or canvas class
129.         Backend for handling file output
130.     description : str, default: ""
131.         Description of the file type.
132.     """
133.     if description is None:
134.         description = ''
135.     _default_backends[format] = backend
136.     _default_filetypes[format] = description
137. 
138. 
139. def get_registered_canvas_class(format):
140.     """
141.     Return the registered default canvas for given file format.
142.     Handles deferred import of required backend.
143.     """
144.     if format not in _default_backends:
145.         return None
146.     backend_class = _default_backends[format]
147.     if isinstance(backend_class, str):
148.         backend_class = importlib.import_module(backend_class).FigureCanvas
149.         _default_backends[format] = backend_class
150.     return backend_class
151. 
152. 
153. class RendererBase:
154.     """
155.     An abstract base class to handle drawing/rendering operations.
156. 
157.     The following methods must be implemented in the backend for full
158.     functionality (though just implementing `draw_path` alone would give a
159.     highly capable backend):
160. 
161.     * `draw_path`
162.     * `draw_image`
163.     * `draw_gouraud_triangles`
164. 
165.     The following methods *should* be implemented in the backend for
166.     optimization reasons:
167. 
168.     * `draw_text`
169.     * `draw_markers`
170.     * `draw_path_collection`
171.     * `draw_quad_mesh`
172.     """
173. 
174.     def __init__(self):
175.         super().__init__()
176.         self._texmanager = None
177.         self._text2path = text.TextToPath()
178.         self._raster_depth = 0
179.         self._rasterizing = False
180. 
181.     def open_group(self, s, gid=None):
182.         """
183.         Open a grouping element with label *s* and *gid* (if set) as id.
184. 
185.         Only used by the SVG renderer.
186.         """
187. 
188.     def close_group(self, s):
189.         """
190.         Close a grouping element with label *s*.
191. 
192.         Only used by the SVG renderer.
193.         """
194. 
195.     def draw_path(self, gc, path, transform, rgbFace=None):
196.         """Draw a `~.path.Path` instance using the given affine transform."""
197.         raise NotImplementedError
198. 
199.     def draw_markers(self, gc, marker_path, marker_trans, path,
200.                      trans, rgbFace=None):
201.         """
202.         Draw a marker at each of *path*'s vertices (excluding control points).
203. 
204.         The base (fallback) implementation makes multiple calls to `draw_path`.
205.         Backends may want to override this method in order to draw the marker
206.         only once and reuse it multiple times.
207. 
208.         Parameters
209.         ----------
210.         gc : `.GraphicsContextBase`
211.             The graphics context.
212.         marker_trans : `matplotlib.transforms.Transform`
213.             An affine transform applied to the marker.
214.         trans : `matplotlib.transforms.Transform`
215.             An affine transform applied to the path.
216.         """
217.         for vertices, codes in path.iter_segments(trans, simplify=False):
218.             if len(vertices):
219.                 x, y = vertices[-2:]
220.                 self.draw_path(gc, marker_path,
221.                                marker_trans +
222.                                transforms.Affine2D().translate(x, y),
223.                                rgbFace)
224. 
225.     def draw_path_collection(self, gc, master_transform, paths, all_transforms,
226.                              offsets, offset_trans, facecolors, edgecolors,
227.                              linewidths, linestyles, antialiaseds, urls,
228.                              offset_position):
229.         """
230.         Draw a collection of *paths*.
231. 
232.         Each path is first transformed by the corresponding entry
233.         in *all_transforms* (a list of (3, 3) matrices) and then by
234.         *master_transform*.  They are then translated by the corresponding
235.         entry in *offsets*, which has been first transformed by *offset_trans*.
236. 
237.         *facecolors*, *edgecolors*, *linewidths*, *linestyles*, and
238.         *antialiased* are lists that set the corresponding properties.
239. 
240.         *offset_position* is unused now, but the argument is kept for
241.         backwards compatibility.
242. 
243.         The base (fallback) implementation makes multiple calls to `draw_path`.
244.         Backends may want to override this in order to render each set of
245.         path data only once, and then reference that path multiple times with
246.         the different offsets, colors, styles etc.  The generator methods
247.         `_iter_collection_raw_paths` and `_iter_collection` are provided to
248.         help with (and standardize) the implementation across backends.  It
249.         is highly recommended to use those generators, so that changes to the
250.         behavior of `draw_path_collection` can be made globally.
251.         """
252.         path_ids = self._iter_collection_raw_paths(master_transform,
253.                                                    paths, all_transforms)
254. 
255.         for xo, yo, path_id, gc0, rgbFace in self._iter_collection(
256.                 gc, list(path_ids), offsets, offset_trans,
257.                 facecolors, edgecolors, linewidths, linestyles,
258.                 antialiaseds, urls, offset_position):
259.             path, transform = path_id
260.             # Only apply another translation if we have an offset, else we
261.             # reuse the initial transform.
262.             if xo != 0 or yo != 0:
263.                 # The transformation can be used by multiple paths. Since
264.                 # translate is a inplace operation, we need to copy the
265.                 # transformation by .frozen() before applying the translation.
266.                 transform = transform.frozen()
267.                 transform.translate(xo, yo)
268.             self.draw_path(gc0, path, transform, rgbFace)
269. 
270.     def draw_quad_mesh(self, gc, master_transform, meshWidth, meshHeight,
271.                        coordinates, offsets, offsetTrans, facecolors,
272.                        antialiased, edgecolors):
273.         """
274.         Draw a quadmesh.
275. 
276.         The base (fallback) implementation converts the quadmesh to paths and
277.         then calls `draw_path_collection`.
278.         """
279. 
280.         from matplotlib.collections import QuadMesh
281.         paths = QuadMesh._convert_mesh_to_paths(coordinates)
282. 
283.         if edgecolors is None:
284.             edgecolors = facecolors
285.         linewidths = np.array([gc.get_linewidth()], float)
286. 
287.         return self.draw_path_collection(
288.             gc, master_transform, paths, [], offsets, offsetTrans, facecolors,
289.             edgecolors, linewidths, [], [antialiased], [None], 'screen')
290. 
291.     @_api.deprecated("3.7", alternative="draw_gouraud_triangles")
292.     def draw_gouraud_triangle(self, gc, points, colors, transform):
293.         """
294.         Draw a Gouraud-shaded triangle.
295. 
296.         Parameters
297.         ----------
298.         gc : `.GraphicsContextBase`
299.             The graphics context.
300.         points : (3, 2) array-like
301.             Array of (x, y) points for the triangle.
302.         colors : (3, 4) array-like
303.             RGBA colors for each point of the triangle.
304.         transform : `matplotlib.transforms.Transform`
305.             An affine transform to apply to the points.
306.         """
307.         raise NotImplementedError
308. 
309.     def draw_gouraud_triangles(self, gc, triangles_array, colors_array,
310.                                transform):
311.         """
312.         Draw a series of Gouraud triangles.
313. 
314.         Parameters
315.         ----------
316.         gc : `.GraphicsContextBase`
317.             The graphics context.
318.         triangles_array : (N, 3, 2) array-like
319.             Array of *N* (x, y) points for the triangles.
320.         colors_array : (N, 3, 4) array-like
321.             Array of *N* RGBA colors for each point of the triangles.
322.         transform : `matplotlib.transforms.Transform`
323.             An affine transform to apply to the points.
324.         """
325.         raise NotImplementedError
326. 
327.     def _iter_collection_raw_paths(self, master_transform, paths,
328.                                    all_transforms):
329.         """
330.         Helper method (along with `_iter_collection`) to implement
331.         `draw_path_collection` in a memory-efficient manner.
332. 
333.         This method yields all of the base path/transform combinations, given a
334.         master transform, a list of paths and list of transforms.
335. 
336.         The arguments should be exactly what is passed in to
337.         `draw_path_collection`.
338. 
339.         The backend should take each yielded path and transform and create an
340.         object that can be referenced (reused) later.
341.         """
342.         Npaths = len(paths)
343.         Ntransforms = len(all_transforms)
344.         N = max(Npaths, Ntransforms)
345. 
346.         if Npaths == 0:
347.             return
348. 
349.         transform = transforms.IdentityTransform()
350.         for i in range(N):
351.             path = paths[i % Npaths]
352.             if Ntransforms:
353.                 transform = Affine2D(all_transforms[i % Ntransforms])
354.             yield path, transform + master_transform
355. 
356.     def _iter_collection_uses_per_path(self, paths, all_transforms,
357.                                        offsets, facecolors, edgecolors):
358.         """
359.         Compute how many times each raw path object returned by
360.         `_iter_collection_raw_paths` would be used when calling
361.         `_iter_collection`. This is intended for the backend to decide
362.         on the tradeoff between using the paths in-line and storing
363.         them once and reusing. Rounds up in case the number of uses
364.         is not the same for every path.
365.         """
366.         Npaths = len(paths)
367.         if Npaths == 0 or len(facecolors) == len(edgecolors) == 0:
368.             return 0
369.         Npath_ids = max(Npaths, len(all_transforms))
370.         N = max(Npath_ids, len(offsets))
371.         return (N + Npath_ids - 1) // Npath_ids
372. 
373.     def _iter_collection(self, gc, path_ids, offsets, offset_trans, facecolors,
374.                          edgecolors, linewidths, linestyles,
375.                          antialiaseds, urls, offset_position):
376.         """
377.         Helper method (along with `_iter_collection_raw_paths`) to implement
378.         `draw_path_collection` in a memory-efficient manner.
379. 
380.         This method yields all of the path, offset and graphics context
381.         combinations to draw the path collection.  The caller should already
382.         have looped over the results of `_iter_collection_raw_paths` to draw
383.         this collection.
384. 
385.         The arguments should be the same as that passed into
386.         `draw_path_collection`, with the exception of *path_ids*, which is a
387.         list of arbitrary objects that the backend will use to reference one of
388.         the paths created in the `_iter_collection_raw_paths` stage.
389. 
390.         Each yielded result is of the form::
391. 
392.            xo, yo, path_id, gc, rgbFace
393. 
394.         where *xo*, *yo* is an offset; *path_id* is one of the elements of
395.         *path_ids*; *gc* is a graphics context and *rgbFace* is a color to
396.         use for filling the path.
397.         """
398.         Npaths = len(path_ids)
399.         Noffsets = len(offsets)
400.         N = max(Npaths, Noffsets)
401.         Nfacecolors = len(facecolors)
402.         Nedgecolors = len(edgecolors)
403.         Nlinewidths = len(linewidths)
404.         Nlinestyles = len(linestyles)
405.         Nurls = len(urls)
406. 
407.         if (Nfacecolors == 0 and Nedgecolors == 0) or Npaths == 0:
408.             return
409. 
410.         gc0 = self.new_gc()
411.         gc0.copy_properties(gc)
412. 
413.         def cycle_or_default(seq, default=None):
414.             # Cycle over *seq* if it is not empty; else always yield *default*.
415.             return (itertools.cycle(seq) if len(seq)
416.                     else itertools.repeat(default))
417. 
418.         pathids = cycle_or_default(path_ids)
419.         toffsets = cycle_or_default(offset_trans.transform(offsets), (0, 0))
420.         fcs = cycle_or_default(facecolors)
421.         ecs = cycle_or_default(edgecolors)
422.         lws = cycle_or_default(linewidths)
423.         lss = cycle_or_default(linestyles)
424.         aas = cycle_or_default(antialiaseds)
425.         urls = cycle_or_default(urls)
426. 
427.         if Nedgecolors == 0:
428.             gc0.set_linewidth(0.0)
429. 
430.         for pathid, (xo, yo), fc, ec, lw, ls, aa, url in itertools.islice(
431.                 zip(pathids, toffsets, fcs, ecs, lws, lss, aas, urls), N):
432.             if not (np.isfinite(xo) and np.isfinite(yo)):
433.                 continue
434.             if Nedgecolors:
435.                 if Nlinewidths:
436.                     gc0.set_linewidth(lw)
437.                 if Nlinestyles:
438.                     gc0.set_dashes(*ls)
439.                 if len(ec) == 4 and ec[3] == 0.0:
440.                     gc0.set_linewidth(0)
441.                 else:
442.                     gc0.set_foreground(ec)
443.             if fc is not None and len(fc) == 4 and fc[3] == 0:
444.                 fc = None
445.             gc0.set_antialiased(aa)
446.             if Nurls:
447.                 gc0.set_url(url)
448.             yield xo, yo, pathid, gc0, fc
449.         gc0.restore()
450. 
451.     def get_image_magnification(self):
452.         """
453.         Get the factor by which to magnify images passed to `draw_image`.
454.         Allows a backend to have images at a different resolution to other
455.         artists.
456.         """
457.         return 1.0
458. 
459.     def draw_image(self, gc, x, y, im, transform=None):
460.         """
461.         Draw an RGBA image.
462. 
463.         Parameters
464.         ----------
465.         gc : `.GraphicsContextBase`
466.             A graphics context with clipping information.
467. 
468.         x : scalar
469.             The distance in physical units (i.e., dots or pixels) from the left
470.             hand side of the canvas.
471. 
472.         y : scalar
473.             The distance in physical units (i.e., dots or pixels) from the
474.             bottom side of the canvas.
475. 
476.         im : (N, M, 4) array of `numpy.uint8`
477.             An array of RGBA pixels.
478. 
479.         transform : `~matplotlib.transforms.Affine2DBase`
480.             If and only if the concrete backend is written such that
481.             `option_scale_image` returns ``True``, an affine transformation
482.             (i.e., an `.Affine2DBase`) *may* be passed to `draw_image`.  The
483.             translation vector of the transformation is given in physical units
484.             (i.e., dots or pixels). Note that the transformation does not
485.             override *x* and *y*, and has to be applied *before* translating
486.             the result by *x* and *y* (this can be accomplished by adding *x*
487.             and *y* to the translation vector defined by *transform*).
488.         """
489.         raise NotImplementedError
490. 
491.     def option_image_nocomposite(self):
492.         """
493.         Return whether image composition by Matplotlib should be skipped.
494. 
495.         Raster backends should usually return False (letting the C-level
496.         rasterizer take care of image composition); vector backends should
497.         usually return ``not rcParams["image.composite_image"]``.
498.         """
499.         return False
500. 


File: lib/matplotlib/backend_bases.py
Line number range: 781 - 919
Content:
781. 
782.     def copy_properties(self, gc):
783.         """Copy properties from *gc* to self."""
784.         self._alpha = gc._alpha
785.         self._forced_alpha = gc._forced_alpha
786.         self._antialiased = gc._antialiased
787.         self._capstyle = gc._capstyle
788.         self._cliprect = gc._cliprect
789.         self._clippath = gc._clippath
790.         self._dashes = gc._dashes
791.         self._joinstyle = gc._joinstyle
792.         self._linestyle = gc._linestyle
793.         self._linewidth = gc._linewidth
794.         self._rgb = gc._rgb
795.         self._hatch = gc._hatch
796.         self._hatch_color = gc._hatch_color
797.         self._hatch_linewidth = gc._hatch_linewidth
798.         self._url = gc._url
799.         self._gid = gc._gid
800.         self._snap = gc._snap
801.         self._sketch = gc._sketch
802. 
803.     def restore(self):
804.         """
805.         Restore the graphics context from the stack - needed only
806.         for backends that save graphics contexts on a stack.
807.         """
808. 
809.     def get_alpha(self):
810.         """
811.         Return the alpha value used for blending - not supported on all
812.         backends.
813.         """
814.         return self._alpha
815. 
816.     def get_antialiased(self):
817.         """Return whether the object should try to do antialiased rendering."""
818.         return self._antialiased
819. 
820.     def get_capstyle(self):
821.         """Return the `.CapStyle`."""
822.         return self._capstyle.name
823. 
824.     def get_clip_rectangle(self):
825.         """
826.         Return the clip rectangle as a `~matplotlib.transforms.Bbox` instance.
827.         """
828.         return self._cliprect
829. 
830.     def get_clip_path(self):
831.         """
832.         Return the clip path in the form (path, transform), where path
833.         is a `~.path.Path` instance, and transform is
834.         an affine transform to apply to the path before clipping.
835.         """
836.         if self._clippath is not None:
837.             tpath, tr = self._clippath.get_transformed_path_and_affine()
838.             if np.all(np.isfinite(tpath.vertices)):
839.                 return tpath, tr
840.             else:
841.                 _log.warning("Ill-defined clip_path detected. Returning None.")
842.                 return None, None
843.         return None, None
844. 
845.     def get_dashes(self):
846.         """
847.         Return the dash style as an (offset, dash-list) pair.
848. 
849.         See `.set_dashes` for details.
850. 
851.         Default value is (None, None).
852.         """
853.         return self._dashes
854. 
855.     def get_forced_alpha(self):
856.         """
857.         Return whether the value given by get_alpha() should be used to
858.         override any other alpha-channel values.
859.         """
860.         return self._forced_alpha
861. 
862.     def get_joinstyle(self):
863.         """Return the `.JoinStyle`."""
864.         return self._joinstyle.name
865. 
866.     def get_linewidth(self):
867.         """Return the line width in points."""
868.         return self._linewidth
869. 
870.     def get_rgb(self):
871.         """Return a tuple of three or four floats from 0-1."""
872.         return self._rgb
873. 
874.     def get_url(self):
875.         """Return a url if one is set, None otherwise."""
876.         return self._url
877. 
878.     def get_gid(self):
879.         """Return the object identifier if one is set, None otherwise."""
880.         return self._gid
881. 
882.     def get_snap(self):
883.         """
884.         Return the snap setting, which can be:
885. 
886.         * True: snap vertices to the nearest pixel center
887.         * False: leave vertices as-is
888.         * None: (auto) If the path contains only rectilinear line segments,
889.           round to the nearest pixel center
890.         """
891.         return self._snap
892. 
893.     def set_alpha(self, alpha):
894.         """
895.         Set the alpha value used for blending - not supported on all backends.
896. 
897.         If ``alpha=None`` (the default), the alpha components of the
898.         foreground and fill colors will be used to set their respective
899.         transparencies (where applicable); otherwise, ``alpha`` will override
900.         them.
901.         """
902.         if alpha is not None:
903.             self._alpha = alpha
904.             self._forced_alpha = True
905.         else:
906.             self._alpha = 1.0
907.             self._forced_alpha = False
908.         self.set_foreground(self._rgb, isRGBA=True)
909. 
910.     def set_antialiased(self, b):
911.         """Set whether object should be drawn with antialiased rendering."""
912.         # Use ints to make life easier on extension code trying to read the gc.
913.         self._antialiased = int(bool(b))
914. 
915.     @_docstring.interpd
916.     def set_capstyle(self, cs):
917.         """
918.         Set how to draw endpoints of lines.
919. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 08:42:31,554 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to understand a patch that adds `get/set_antialiased` to `Text` objects. The issue description explicitly mentions that `Annotation` objects, which are subclasses of `Text`, might also need adjustments. The provided patch for `lib/matplotlib/text.py` only shows the changes to the `Text` class. To determine if the fix is complete, I need to examine the definition of the `Annotation` class, particularly its `__init__` method, to see if it properly handles the new `antialiased` parameter. The full file will also clarify how the `GraphicsContext` is used in the `Text.draw` method, which is not clear from the diff.' query='Please provide the full content of the file `lib/matplotlib/text.py`.' extra_requirements='' purpose='I need this file to check whether the `Annotation` class requires changes to support the new `antialiased` property and to understand the full implementation of the `Text.draw` method.'
2025-12-21 08:42:31,555 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `lib/matplotlib/text.py`.
2025-12-21 08:42:31,555 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 08:42:31,556 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 08:42:31,556 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 08:42:31,556 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `lib/matplotlib/text.py`.
Purpose: I need this file to check whether the `Annotation` class requires changes to support the new `antialiased` property and to understand the full implementation of the `Text.draw` method.
2025-12-21 08:42:34,963 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `lib/matplotlib/text.py`. This will allow you to examine the `Annotation` class and the `Text.draw` method to determine if any changes are needed to support the new `antialiased` property.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/text.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2155, 'candidates_token_count': 76, 'total_token_count': 2448, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2155}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 217, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15774431981538473, 'model_name': 'gemini-2.5-pro'} id='run--d535b1a7-e491-4ca6-92b1-469d57aa680b-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/text.py'}, 'id': 'a3936fb2-2711-4353-834c-df2a5229c87a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2155, 'output_tokens': 76, 'total_tokens': 2448, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 217}}
2025-12-21 08:42:38,087 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 501.0, "relative_path": "lib/matplotlib/text.py", "end_line": 1001.0}'}, '__gemini_function_call_thought_signatures__': {'9b0b4330-7e55-4013-9e8d-67260aee4e14': 'CtYFAY89a19VxbjrHWPMWteCErM+LhnUfslnblZJw/aX29NvGFvUlnE75WiOny6CFcoC5l+A/G/ls0YtrMIVGM2/gD6HnjVHI/2VR4HZ7pgZsoXd9kcn01HpuJYRIN8xZoOyd+m/IUrJX7mL4EEj4IJjictiattCBp6a52ziKmZVbzIcA+HFPS0dzaVmzaNau5TuzKMMcFiHZ2tb3ueDkrkmWuJIwKjTBxSypnUYvvZaOP6n5e1i2mfkAQC5Gs9CuIi7zMAoh6zgZDRIRLU0fJ1cTcr3WUPF0tFonah4M4Gm/lpO453eV6toZofVY8AoFGZ7JjTfib7unL1o87LDfEpONerPE+lpVPF2daDPBX9RgKpx1V4fe4ViXA3Nz/yCED7VBRGmHD76HEAdjyml6lO5PzwyTRRDHu6jObEq59vPZ4e+NfLVSrp4HD3nEce2VxrAP2oQaYF/agwoGunQvQLVVw1f14QmG/rD/sVef3mvPW4cpX1GWXbThU41lG76xsQwrfQFZ03fF4Xxp0qBCUNPl6fXLJyWvYco2W2OhO09npqnAubWLBGGwDmWEefTHA8szVuXf9O2OgA+fhquu+WEUNOKYPPAT1j/i/mDMZRLaU+eOvCEZmYFOf+v9iNPpSMAdaX4Fw+spmJu4prSh68qkcsV8AVBTU2+ceDwHGMz1HXmFVCWq5Rn+pjjmGQyuo+GeOL5JoiIYOcGckePUoIp7P+hOXJ6d8/yJhniTLlPPtLNooBCf4rbHhp+iHNCWEkHsJON4yfzRa9dAcYLLu7/PX7U4OHunCsG2xYx1N/qxkSOdDFO1JxiV8HLYyKZrkGDI+rxArFdebmNwO1dnKP0ep1v0xYw1zwxTfaXdrx4SOjTIlHE9Mfk9aVbBZooeGa5MN+iL9nJjiMhQf1RRvD58a0f/+52KuOR4ACyfrgSi0s1VLZ9iQuQda1agdTQu+pM22uTKsxm'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9294, 'candidates_token_count': 27, 'total_token_count': 9535, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9294}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 214, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7781564218026621, 'model_name': 'gemini-2.5-pro'} id='run--8a64eaec-ef1b-4784-a828-935e8eba18c8-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 501.0, 'relative_path': 'lib/matplotlib/text.py', 'end_line': 1001.0}, 'id': '9b0b4330-7e55-4013-9e8d-67260aee4e14', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9294, 'output_tokens': 27, 'total_tokens': 9535, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 214}}
2025-12-21 08:42:39,951 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1002.0, "relative_path": "lib/matplotlib/text.py", "end_line": 1502.0}'}, '__gemini_function_call_thought_signatures__': {'46b5d1aa-2f81-41cc-b570-b261946eeec7': 'CqsBAY89a19gWWsjer64ilbj7juU6havphjh8GQdBi1lms32u3h/HZnE3JCYeLKRiqAP+KfATdwE+VuAkgn30/IJhsUYAN6gatzF+vyXv7MvkyrHUppZ2ekZeJ5Q4DIE1wQPWROHswAwzCMAtQsz6o9ZincInOKTQcIm0N1j63GH8/HARf/wgUnXJIlyArTls+pw+Q1azNuOy/a5nDZEMiB6CzYKbTVoUJT/YtVi'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16321, 'candidates_token_count': 27, 'total_token_count': 16401, 'cached_content_token_count': 9462, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16535}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9462}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 53}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0813999264328568, 'model_name': 'gemini-2.5-pro'} id='run--7ba56809-509e-40f6-926c-fd627fcc5ced-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1002.0, 'relative_path': 'lib/matplotlib/text.py', 'end_line': 1502.0}, 'id': '46b5d1aa-2f81-41cc-b570-b261946eeec7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 16321, 'output_tokens': 27, 'total_tokens': 16401, 'input_token_details': {'cache_read': 9462}, 'output_token_details': {'reasoning': 53}}
2025-12-21 08:42:41,580 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1503.0, "relative_path": "lib/matplotlib/text.py", "end_line": 2003.0}'}, '__gemini_function_call_thought_signatures__': {'a8864799-4b80-4af9-95b3-0f5f37cde316': 'CqsBAY89a19J/zYn3RTeXu57CMRixcUSFptjv7mQ1VvSdupMQtHFxf4uJt5e4GAcfhV6TeJS7c7yQ093RijHXQEAAKulKskhqBQM9xJSuEixd3VxZBPsK6wqEE1DygBFAYbxIQk6VklwDoBZmm3G++qOE/CiDWYLL+swr8gZqFscAVmUSs5KgM0bGtPBAM+kR3ljxLpKBOeLoGhb72uPFAzjkzjP6QqUzg1WyzS6'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 23423, 'candidates_token_count': 27, 'total_token_count': 23503, 'cached_content_token_count': 15289, 'prompt_tokens_details': [{'modality': 1, 'token_count': 23690}], 'cache_tokens_details': [{'modality': 1, 'token_count': 15289}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 53}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0009431947298623898, 'model_name': 'gemini-2.5-pro'} id='run--a8022001-8524-4b38-be74-57a7aed78722-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1503.0, 'relative_path': 'lib/matplotlib/text.py', 'end_line': 2003.0}, 'id': 'a8864799-4b80-4af9-95b3-0f5f37cde316', 'type': 'tool_call'}] usage_metadata={'input_tokens': 23423, 'output_tokens': 27, 'total_tokens': 23503, 'input_token_details': {'cache_read': 15289}, 'output_token_details': {'reasoning': 53}}
2025-12-21 08:42:43,608 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 2004.0, "relative_path": "lib/matplotlib/text.py", "end_line": 2504.0}'}, '__gemini_function_call_thought_signatures__': {'d2621e79-beed-4e57-8727-ce2ca1c448d7': 'CrABAY89a18oU8VQpsIkZ7vD0CEVvMJC4BWUlmD2rx00QdPmFDkYtFcSMwjomYwvG456n1sJ+Sfmtg5RvpFOb7OP9J9LgDAaCMNtuDQlKIWTb8lR3tVmYmUDfjNdR/vAKtIg9adAfjX6G5BhVHMaNvAr6qpyANO30aK0XayhqzsCniW89sT77J6SWm0JK6DY9lrp58csTJbZfphqEcy2Fu4SDT8ppJ8bl1skGGiAj7wPV/M='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 31229, 'candidates_token_count': 27, 'total_token_count': 31306, 'cached_content_token_count': 23159, 'prompt_tokens_details': [{'modality': 1, 'token_count': 31549}], 'cache_tokens_details': [{'modality': 1, 'token_count': 23159}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 50}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09172638257344563, 'model_name': 'gemini-2.5-pro'} id='run--f6eedf46-3dd5-477c-b52d-7c9d97efdade-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 2004.0, 'relative_path': 'lib/matplotlib/text.py', 'end_line': 2504.0}, 'id': 'd2621e79-beed-4e57-8727-ce2ca1c448d7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 31229, 'output_tokens': 27, 'total_tokens': 31306, 'input_token_details': {'cache_read': 23159}, 'output_token_details': {'reasoning': 50}}
2025-12-21 08:42:46,835 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the file `lib/matplotlib/text.py` by reading it in sequential chunks. You can now use this content to analyze the `Annotation` class and the `Text.draw` method as you intended.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 31340, 'candidates_token_count': 51, 'total_token_count': 31588, 'cached_content_token_count': 30833, 'prompt_tokens_details': [{'modality': 1, 'token_count': 31710}], 'cache_tokens_details': [{'modality': 1, 'token_count': 30833}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 51}], 'thoughts_token_count': 197}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5350440904205921, 'model_name': 'gemini-2.5-pro'} id='run--2f824f5e-6676-4ae5-8ba1-4a6bd7744f26-0' usage_metadata={'input_tokens': 31340, 'output_tokens': 51, 'total_tokens': 31588, 'input_token_details': {'cache_read': 30833}, 'output_token_details': {'reasoning': 197}}
2025-12-21 08:42:46,837 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `lib/matplotlib/text.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need this file to check whether the `Annotation` class requires changes to support the new `antialiased` property and to understand the full implementation of the `Text.draw` method.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/text.py
Line number range: 1 - 500
Content:
1. """
2. Classes for including text in a figure.
3. """
4. 
5. import functools
6. import logging
7. import math
8. from numbers import Real
9. import weakref
10. 
11. import numpy as np
12. 
13. import matplotlib as mpl
14. from . import _api, artist, cbook, _docstring
15. from .artist import Artist
16. from .font_manager import FontProperties
17. from .patches import FancyArrowPatch, FancyBboxPatch, Rectangle
18. from .textpath import TextPath, TextToPath  # noqa # Logically located here
19. from .transforms import (
20.     Affine2D, Bbox, BboxBase, BboxTransformTo, IdentityTransform, Transform)
21. 
22. 
23. _log = logging.getLogger(__name__)
24. 
25. 
26. def _get_textbox(text, renderer):
27.     """
28.     Calculate the bounding box of the text.
29. 
30.     The bbox position takes text rotation into account, but the width and
31.     height are those of the unrotated box (unlike `.Text.get_window_extent`).
32.     """
33.     # TODO : This function may move into the Text class as a method. As a
34.     # matter of fact, the information from the _get_textbox function
35.     # should be available during the Text._get_layout() call, which is
36.     # called within the _get_textbox. So, it would better to move this
37.     # function as a method with some refactoring of _get_layout method.
38. 
39.     projected_xs = []
40.     projected_ys = []
41. 
42.     theta = np.deg2rad(text.get_rotation())
43.     tr = Affine2D().rotate(-theta)
44. 
45.     _, parts, d = text._get_layout(renderer)
46. 
47.     for t, wh, x, y in parts:
48.         w, h = wh
49. 
50.         xt1, yt1 = tr.transform((x, y))
51.         yt1 -= d
52.         xt2, yt2 = xt1 + w, yt1 + h
53. 
54.         projected_xs.extend([xt1, xt2])
55.         projected_ys.extend([yt1, yt2])
56. 
57.     xt_box, yt_box = min(projected_xs), min(projected_ys)
58.     w_box, h_box = max(projected_xs) - xt_box, max(projected_ys) - yt_box
59. 
60.     x_box, y_box = Affine2D().rotate(theta).transform((xt_box, yt_box))
61. 
62.     return x_box, y_box, w_box, h_box
63. 
64. 
65. def _get_text_metrics_with_cache(renderer, text, fontprop, ismath, dpi):
66.     """Call ``renderer.get_text_width_height_descent``, caching the results."""
67.     # Cached based on a copy of fontprop so that later in-place mutations of
68.     # the passed-in argument do not mess up the cache.
69.     return _get_text_metrics_with_cache_impl(
70.         weakref.ref(renderer), text, fontprop.copy(), ismath, dpi)
71. 
72. 
73. @functools.lru_cache(4096)
74. def _get_text_metrics_with_cache_impl(
75.         renderer_ref, text, fontprop, ismath, dpi):
76.     # dpi is unused, but participates in cache invalidation (via the renderer).
77.     return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)
78. 
79. 
80. @_docstring.interpd
81. @_api.define_aliases({
82.     "color": ["c"],
83.     "fontfamily": ["family"],
84.     "fontproperties": ["font", "font_properties"],
85.     "horizontalalignment": ["ha"],
86.     "multialignment": ["ma"],
87.     "fontname": ["name"],
88.     "fontsize": ["size"],
89.     "fontstretch": ["stretch"],
90.     "fontstyle": ["style"],
91.     "fontvariant": ["variant"],
92.     "verticalalignment": ["va"],
93.     "fontweight": ["weight"],
94. })
95. class Text(Artist):
96.     """Handle storing and drawing of text in window or data coordinates."""
97. 
98.     zorder = 3
99.     _charsize_cache = dict()
100. 
101.     def __repr__(self):
102.         return f"Text({self._x}, {self._y}, {self._text!r})"
103. 
104.     def __init__(self,
105.                  x=0, y=0, text='', *,
106.                  color=None,           # defaults to rc params
107.                  verticalalignment='baseline',
108.                  horizontalalignment='left',
109.                  multialignment=None,
110.                  fontproperties=None,  # defaults to FontProperties()
111.                  rotation=None,
112.                  linespacing=None,
113.                  rotation_mode=None,
114.                  usetex=None,          # defaults to rcParams['text.usetex']
115.                  wrap=False,
116.                  transform_rotates_text=False,
117.                  parse_math=None,    # defaults to rcParams['text.parse_math']
118.                  **kwargs
119.                  ):
120.         """
121.         Create a `.Text` instance at *x*, *y* with string *text*.
122. 
123.         The text is aligned relative to the anchor point (*x*, *y*) according
124.         to ``horizontalalignment`` (default: 'left') and ``verticalalignment``
125.         (default: 'bottom'). See also
126.         :doc:`/gallery/text_labels_and_annotations/text_alignment`.
127. 
128.         While Text accepts the 'label' keyword argument, by default it is not
129.         added to the handles of a legend.
130. 
131.         Valid keyword arguments are:
132. 
133.         %(Text:kwdoc)s
134.         """
135.         super().__init__()
136.         self._x, self._y = x, y
137.         self._text = ''
138.         self._reset_visual_defaults(
139.             text=text,
140.             color=color,
141.             fontproperties=fontproperties,
142.             usetex=usetex,
143.             parse_math=parse_math,
144.             wrap=wrap,
145.             verticalalignment=verticalalignment,
146.             horizontalalignment=horizontalalignment,
147.             multialignment=multialignment,
148.             rotation=rotation,
149.             transform_rotates_text=transform_rotates_text,
150.             linespacing=linespacing,
151.             rotation_mode=rotation_mode,
152.         )
153.         self.update(kwargs)
154. 
155.     def _reset_visual_defaults(
156.         self,
157.         text='',
158.         color=None,
159.         fontproperties=None,
160.         usetex=None,
161.         parse_math=None,
162.         wrap=False,
163.         verticalalignment='baseline',
164.         horizontalalignment='left',
165.         multialignment=None,
166.         rotation=None,
167.         transform_rotates_text=False,
168.         linespacing=None,
169.         rotation_mode=None,
170.     ):
171.         self.set_text(text)
172.         self.set_color(
173.             color if color is not None else mpl.rcParams["text.color"])
174.         self.set_fontproperties(fontproperties)
175.         self.set_usetex(usetex)
176.         self.set_parse_math(parse_math if parse_math is not None else
177.                             mpl.rcParams['text.parse_math'])
178.         self.set_wrap(wrap)
179.         self.set_verticalalignment(verticalalignment)
180.         self.set_horizontalalignment(horizontalalignment)
181.         self._multialignment = multialignment
182.         self.set_rotation(rotation)
183.         self._transform_rotates_text = transform_rotates_text
184.         self._bbox_patch = None  # a FancyBboxPatch instance
185.         self._renderer = None
186.         if linespacing is None:
187.             linespacing = 1.2  # Maybe use rcParam later.
188.         self.set_linespacing(linespacing)
189.         self.set_rotation_mode(rotation_mode)
190. 
191.     def update(self, kwargs):
192.         # docstring inherited
193.         kwargs = cbook.normalize_kwargs(kwargs, Text)
194.         sentinel = object()  # bbox can be None, so use another sentinel.
195.         # Update fontproperties first, as it has lowest priority.
196.         fontproperties = kwargs.pop("fontproperties", sentinel)
197.         if fontproperties is not sentinel:
198.             self.set_fontproperties(fontproperties)
199.         # Update bbox last, as it depends on font properties.
200.         bbox = kwargs.pop("bbox", sentinel)
201.         super().update(kwargs)
202.         if bbox is not sentinel:
203.             self.set_bbox(bbox)
204. 
205.     def __getstate__(self):
206.         d = super().__getstate__()
207.         # remove the cached _renderer (if it exists)
208.         d['_renderer'] = None
209.         return d
210. 
211.     def contains(self, mouseevent):
212.         """
213.         Return whether the mouse event occurred inside the axis-aligned
214.         bounding-box of the text.
215.         """
216.         if (self._different_canvas(mouseevent) or not self.get_visible()
217.                 or self._renderer is None):
218.             return False, {}
219.         # Explicitly use Text.get_window_extent(self) and not
220.         # self.get_window_extent() so that Annotation.contains does not
221.         # accidentally cover the entire annotation bounding box.
222.         bbox = Text.get_window_extent(self)
223.         inside = (bbox.x0 <= mouseevent.x <= bbox.x1
224.                   and bbox.y0 <= mouseevent.y <= bbox.y1)
225.         cattr = {}
226.         # if the text has a surrounding patch, also check containment for it,
227.         # and merge the results with the results for the text.
228.         if self._bbox_patch:
229.             patch_inside, patch_cattr = self._bbox_patch.contains(mouseevent)
230.             inside = inside or patch_inside
231.             cattr["bbox_patch"] = patch_cattr
232.         return inside, cattr
233. 
234.     def _get_xy_display(self):
235.         """
236.         Get the (possibly unit converted) transformed x, y in display coords.
237.         """
238.         x, y = self.get_unitless_position()
239.         return self.get_transform().transform((x, y))
240. 
241.     def _get_multialignment(self):
242.         if self._multialignment is not None:
243.             return self._multialignment
244.         else:
245.             return self._horizontalalignment
246. 
247.     def _char_index_at(self, x):
248.         """
249.         Calculate the index closest to the coordinate x in display space.
250. 
251.         The position of text[index] is assumed to be the sum of the widths
252.         of all preceding characters text[:index].
253. 
254.         This works only on single line texts.
255.         """
256.         if not self._text:
257.             return 0
258. 
259.         text = self._text
260. 
261.         fontproperties = str(self._fontproperties)
262.         if fontproperties not in Text._charsize_cache:
263.             Text._charsize_cache[fontproperties] = dict()
264. 
265.         charsize_cache = Text._charsize_cache[fontproperties]
266.         for char in set(text):
267.             if char not in charsize_cache:
268.                 self.set_text(char)
269.                 bb = self.get_window_extent()
270.                 charsize_cache[char] = bb.x1 - bb.x0
271. 
272.         self.set_text(text)
273.         bb = self.get_window_extent()
274. 
275.         size_accum = np.cumsum([0] + [charsize_cache[x] for x in text])
276.         std_x = x - bb.x0
277.         return (np.abs(size_accum - std_x)).argmin()
278. 
279.     def get_rotation(self):
280.         """Return the text angle in degrees between 0 and 360."""
281.         if self.get_transform_rotates_text():
282.             return self.get_transform().transform_angles(
283.                 [self._rotation], [self.get_unitless_position()]).item(0)
284.         else:
285.             return self._rotation
286. 
287.     def get_transform_rotates_text(self):
288.         """
289.         Return whether rotations of the transform affect the text direction.
290.         """
291.         return self._transform_rotates_text
292. 
293.     def set_rotation_mode(self, m):
294.         """
295.         Set text rotation mode.
296. 
297.         Parameters
298.         ----------
299.         m : {None, 'default', 'anchor'}
300.             If ``None`` or ``"default"``, the text will be first rotated, then
301.             aligned according to their horizontal and vertical alignments.  If
302.             ``"anchor"``, then alignment occurs before rotation.
303.         """
304.         _api.check_in_list(["anchor", "default", None], rotation_mode=m)
305.         self._rotation_mode = m
306.         self.stale = True
307. 
308.     def get_rotation_mode(self):
309.         """Return the text rotation mode."""
310.         return self._rotation_mode
311. 
312.     def update_from(self, other):
313.         # docstring inherited
314.         super().update_from(other)
315.         self._color = other._color
316.         self._multialignment = other._multialignment
317.         self._verticalalignment = other._verticalalignment
318.         self._horizontalalignment = other._horizontalalignment
319.         self._fontproperties = other._fontproperties.copy()
320.         self._usetex = other._usetex
321.         self._rotation = other._rotation
322.         self._transform_rotates_text = other._transform_rotates_text
323.         self._picker = other._picker
324.         self._linespacing = other._linespacing
325.         self.stale = True
326. 
327.     def _get_layout(self, renderer):
328.         """
329.         Return the extent (bbox) of the text together with
330.         multiple-alignment information. Note that it returns an extent
331.         of a rotated text when necessary.
332.         """
333.         thisx, thisy = 0.0, 0.0
334.         lines = self._get_wrapped_text().split("\n")  # Ensures lines is not empty.
335. 
336.         ws = []
337.         hs = []
338.         xs = []
339.         ys = []
340. 
341.         # Full vertical extent of font, including ascenders and descenders:
342.         _, lp_h, lp_d = _get_text_metrics_with_cache(
343.             renderer, "lp", self._fontproperties,
344.             ismath="TeX" if self.get_usetex() else False, dpi=self.figure.dpi)
345.         min_dy = (lp_h - lp_d) * self._linespacing
346. 
347.         for i, line in enumerate(lines):
348.             clean_line, ismath = self._preprocess_math(line)
349.             if clean_line:
350.                 w, h, d = _get_text_metrics_with_cache(
351.                     renderer, clean_line, self._fontproperties,
352.                     ismath=ismath, dpi=self.figure.dpi)
353.             else:
354.                 w = h = d = 0
355. 
356.             # For multiline text, increase the line spacing when the text
357.             # net-height (excluding baseline) is larger than that of a "l"
358.             # (e.g., use of superscripts), which seems what TeX does.
359.             h = max(h, lp_h)
360.             d = max(d, lp_d)
361. 
362.             ws.append(w)
363.             hs.append(h)
364. 
365.             # Metrics of the last line that are needed later:
366.             baseline = (h - d) - thisy
367. 
368.             if i == 0:
369.                 # position at baseline
370.                 thisy = -(h - d)
371.             else:
372.                 # put baseline a good distance from bottom of previous line
373.                 thisy -= max(min_dy, (h - d) * self._linespacing)
374. 
375.             xs.append(thisx)  # == 0.
376.             ys.append(thisy)
377. 
378.             thisy -= d
379. 
380.         # Metrics of the last line that are needed later:
381.         descent = d
382. 
383.         # Bounding box definition:
384.         width = max(ws)
385.         xmin = 0
386.         xmax = width
387.         ymax = 0
388.         ymin = ys[-1] - descent  # baseline of last line minus its descent
389. 
390.         # get the rotation matrix
391.         M = Affine2D().rotate_deg(self.get_rotation())
392. 
393.         # now offset the individual text lines within the box
394.         malign = self._get_multialignment()
395.         if malign == 'left':
396.             offset_layout = [(x, y) for x, y in zip(xs, ys)]
397.         elif malign == 'center':
398.             offset_layout = [(x + width / 2 - w / 2, y)
399.                              for x, y, w in zip(xs, ys, ws)]
400.         elif malign == 'right':
401.             offset_layout = [(x + width - w, y)
402.                              for x, y, w in zip(xs, ys, ws)]
403. 
404.         # the corners of the unrotated bounding box
405.         corners_horiz = np.array(
406.             [(xmin, ymin), (xmin, ymax), (xmax, ymax), (xmax, ymin)])
407. 
408.         # now rotate the bbox
409.         corners_rotated = M.transform(corners_horiz)
410.         # compute the bounds of the rotated box
411.         xmin = corners_rotated[:, 0].min()
412.         xmax = corners_rotated[:, 0].max()
413.         ymin = corners_rotated[:, 1].min()
414.         ymax = corners_rotated[:, 1].max()
415.         width = xmax - xmin
416.         height = ymax - ymin
417. 
418.         # Now move the box to the target position offset the display
419.         # bbox by alignment
420.         halign = self._horizontalalignment
421.         valign = self._verticalalignment
422. 
423.         rotation_mode = self.get_rotation_mode()
424.         if rotation_mode != "anchor":
425.             # compute the text location in display coords and the offsets
426.             # necessary to align the bbox with that location
427.             if halign == 'center':
428.                 offsetx = (xmin + xmax) / 2
429.             elif halign == 'right':
430.                 offsetx = xmax
431.             else:
432.                 offsetx = xmin
433. 
434.             if valign == 'center':
435.                 offsety = (ymin + ymax) / 2
436.             elif valign == 'top':
437.                 offsety = ymax
438.             elif valign == 'baseline':
439.                 offsety = ymin + descent
440.             elif valign == 'center_baseline':
441.                 offsety = ymin + height - baseline / 2.0
442.             else:
443.                 offsety = ymin
444.         else:
445.             xmin1, ymin1 = corners_horiz[0]
446.             xmax1, ymax1 = corners_horiz[2]
447. 
448.             if halign == 'center':
449.                 offsetx = (xmin1 + xmax1) / 2.0
450.             elif halign == 'right':
451.                 offsetx = xmax1
452.             else:
453.                 offsetx = xmin1
454. 
455.             if valign == 'center':
456.                 offsety = (ymin1 + ymax1) / 2.0
457.             elif valign == 'top':
458.                 offsety = ymax1
459.             elif valign == 'baseline':
460.                 offsety = ymax1 - baseline
461.             elif valign == 'center_baseline':
462.                 offsety = ymax1 - baseline / 2.0
463.             else:
464.                 offsety = ymin1
465. 
466.             offsetx, offsety = M.transform((offsetx, offsety))
467. 
468.         xmin -= offsetx
469.         ymin -= offsety
470. 
471.         bbox = Bbox.from_bounds(xmin, ymin, width, height)
472. 
473.         # now rotate the positions around the first (x, y) position
474.         xys = M.transform(offset_layout) - (offsetx, offsety)
475. 
476.         return bbox, list(zip(lines, zip(ws, hs), *xys.T)), descent
477. 
478.     def set_bbox(self, rectprops):
479.         """
480.         Draw a bounding box around self.
481. 
482.         Parameters
483.         ----------
484.         rectprops : dict with properties for `.patches.FancyBboxPatch`
485.              The default boxstyle is 'square'. The mutation
486.              scale of the `.patches.FancyBboxPatch` is set to the fontsize.
487. 
488.         Examples
489.         --------
490.         ::
491. 
492.             t.set_bbox(dict(facecolor='red', alpha=0.5))
493.         """
494. 
495.         if rectprops is not None:
496.             props = rectprops.copy()
497.             boxstyle = props.pop("boxstyle", None)
498.             pad = props.pop("pad", None)
499.             if boxstyle is None:
500.                 boxstyle = "square"


File: lib/matplotlib/text.py
Line number range: 501 - 1001
Content:
501.                 if pad is None:
502.                     pad = 4  # points
503.                 pad /= self.get_size()  # to fraction of font size
504.             else:
505.                 if pad is None:
506.                     pad = 0.3
507.             # boxstyle could be a callable or a string
508.             if isinstance(boxstyle, str) and "pad" not in boxstyle:
509.                 boxstyle += ",pad=%0.2f" % pad
510.             self._bbox_patch = FancyBboxPatch(
511.                 (0, 0), 1, 1,
512.                 boxstyle=boxstyle, transform=IdentityTransform(), **props)
513.         else:
514.             self._bbox_patch = None
515. 
516.         self._update_clip_properties()
517. 
518.     def get_bbox_patch(self):
519.         """
520.         Return the bbox Patch, or None if the `.patches.FancyBboxPatch`
521.         is not made.
522.         """
523.         return self._bbox_patch
524. 
525.     def update_bbox_position_size(self, renderer):
526.         """
527.         Update the location and the size of the bbox.
528. 
529.         This method should be used when the position and size of the bbox needs
530.         to be updated before actually drawing the bbox.
531.         """
532.         if self._bbox_patch:
533.             # don't use self.get_unitless_position here, which refers to text
534.             # position in Text:
535.             posx = float(self.convert_xunits(self._x))
536.             posy = float(self.convert_yunits(self._y))
537.             posx, posy = self.get_transform().transform((posx, posy))
538. 
539.             x_box, y_box, w_box, h_box = _get_textbox(self, renderer)
540.             self._bbox_patch.set_bounds(0., 0., w_box, h_box)
541.             self._bbox_patch.set_transform(
542.                 Affine2D()
543.                 .rotate_deg(self.get_rotation())
544.                 .translate(posx + x_box, posy + y_box))
545.             fontsize_in_pixel = renderer.points_to_pixels(self.get_size())
546.             self._bbox_patch.set_mutation_scale(fontsize_in_pixel)
547. 
548.     def _update_clip_properties(self):
549.         clipprops = dict(clip_box=self.clipbox,
550.                          clip_path=self._clippath,
551.                          clip_on=self._clipon)
552.         if self._bbox_patch:
553.             self._bbox_patch.update(clipprops)
554. 
555.     def set_clip_box(self, clipbox):
556.         # docstring inherited.
557.         super().set_clip_box(clipbox)
558.         self._update_clip_properties()
559. 
560.     def set_clip_path(self, path, transform=None):
561.         # docstring inherited.
562.         super().set_clip_path(path, transform)
563.         self._update_clip_properties()
564. 
565.     def set_clip_on(self, b):
566.         # docstring inherited.
567.         super().set_clip_on(b)
568.         self._update_clip_properties()
569. 
570.     def get_wrap(self):
571.         """Return whether the text can be wrapped."""
572.         return self._wrap
573. 
574.     def set_wrap(self, wrap):
575.         """
576.         Set whether the text can be wrapped.
577. 
578.         Parameters
579.         ----------
580.         wrap : bool
581. 
582.         Notes
583.         -----
584.         Wrapping does not work together with
585.         ``savefig(..., bbox_inches='tight')`` (which is also used internally
586.         by ``%matplotlib inline`` in IPython/Jupyter). The 'tight' setting
587.         rescales the canvas to accommodate all content and happens before
588.         wrapping.
589.         """
590.         self._wrap = wrap
591. 
592.     def _get_wrap_line_width(self):
593.         """
594.         Return the maximum line width for wrapping text based on the current
595.         orientation.
596.         """
597.         x0, y0 = self.get_transform().transform(self.get_position())
598.         figure_box = self.get_figure().get_window_extent()
599. 
600.         # Calculate available width based on text alignment
601.         alignment = self.get_horizontalalignment()
602.         self.set_rotation_mode('anchor')
603.         rotation = self.get_rotation()
604. 
605.         left = self._get_dist_to_box(rotation, x0, y0, figure_box)
606.         right = self._get_dist_to_box(
607.             (180 + rotation) % 360, x0, y0, figure_box)
608. 
609.         if alignment == 'left':
610.             line_width = left
611.         elif alignment == 'right':
612.             line_width = right
613.         else:
614.             line_width = 2 * min(left, right)
615. 
616.         return line_width
617. 
618.     def _get_dist_to_box(self, rotation, x0, y0, figure_box):
619.         """
620.         Return the distance from the given points to the boundaries of a
621.         rotated box, in pixels.
622.         """
623.         if rotation > 270:
624.             quad = rotation - 270
625.             h1 = y0 / math.cos(math.radians(quad))
626.             h2 = (figure_box.x1 - x0) / math.cos(math.radians(90 - quad))
627.         elif rotation > 180:
628.             quad = rotation - 180
629.             h1 = x0 / math.cos(math.radians(quad))
630.             h2 = y0 / math.cos(math.radians(90 - quad))
631.         elif rotation > 90:
632.             quad = rotation - 90
633.             h1 = (figure_box.y1 - y0) / math.cos(math.radians(quad))
634.             h2 = x0 / math.cos(math.radians(90 - quad))
635.         else:
636.             h1 = (figure_box.x1 - x0) / math.cos(math.radians(rotation))
637.             h2 = (figure_box.y1 - y0) / math.cos(math.radians(90 - rotation))
638. 
639.         return min(h1, h2)
640. 
641.     def _get_rendered_text_width(self, text):
642.         """
643.         Return the width of a given text string, in pixels.
644.         """
645. 
646.         w, h, d = self._renderer.get_text_width_height_descent(
647.             text,
648.             self.get_fontproperties(),
649.             cbook.is_math_text(text))
650.         return math.ceil(w)
651. 
652.     def _get_wrapped_text(self):
653.         """
654.         Return a copy of the text string with new lines added so that the text
655.         is wrapped relative to the parent figure (if `get_wrap` is True).
656.         """
657.         if not self.get_wrap():
658.             return self.get_text()
659. 
660.         # Not fit to handle breaking up latex syntax correctly, so
661.         # ignore latex for now.
662.         if self.get_usetex():
663.             return self.get_text()
664. 
665.         # Build the line incrementally, for a more accurate measure of length
666.         line_width = self._get_wrap_line_width()
667.         wrapped_lines = []
668. 
669.         # New lines in the user's text force a split
670.         unwrapped_lines = self.get_text().split('\n')
671. 
672.         # Now wrap each individual unwrapped line
673.         for unwrapped_line in unwrapped_lines:
674. 
675.             sub_words = unwrapped_line.split(' ')
676.             # Remove items from sub_words as we go, so stop when empty
677.             while len(sub_words) > 0:
678.                 if len(sub_words) == 1:
679.                     # Only one word, so just add it to the end
680.                     wrapped_lines.append(sub_words.pop(0))
681.                     continue
682. 
683.                 for i in range(2, len(sub_words) + 1):
684.                     # Get width of all words up to and including here
685.                     line = ' '.join(sub_words[:i])
686.                     current_width = self._get_rendered_text_width(line)
687. 
688.                     # If all these words are too wide, append all not including
689.                     # last word
690.                     if current_width > line_width:
691.                         wrapped_lines.append(' '.join(sub_words[:i - 1]))
692.                         sub_words = sub_words[i - 1:]
693.                         break
694. 
695.                     # Otherwise if all words fit in the width, append them all
696.                     elif i == len(sub_words):
697.                         wrapped_lines.append(' '.join(sub_words[:i]))
698.                         sub_words = []
699.                         break
700. 
701.         return '\n'.join(wrapped_lines)
702. 
703.     @artist.allow_rasterization
704.     def draw(self, renderer):
705.         # docstring inherited
706. 
707.         if renderer is not None:
708.             self._renderer = renderer
709.         if not self.get_visible():
710.             return
711.         if self.get_text() == '':
712.             return
713. 
714.         renderer.open_group('text', self.get_gid())
715. 
716.         with self._cm_set(text=self._get_wrapped_text()):
717.             bbox, info, descent = self._get_layout(renderer)
718.             trans = self.get_transform()
719. 
720.             # don't use self.get_position here, which refers to text
721.             # position in Text:
722.             posx = float(self.convert_xunits(self._x))
723.             posy = float(self.convert_yunits(self._y))
724.             posx, posy = trans.transform((posx, posy))
725.             if not np.isfinite(posx) or not np.isfinite(posy):
726.                 _log.warning("posx and posy should be finite values")
727.                 return
728.             canvasw, canvash = renderer.get_canvas_width_height()
729. 
730.             # Update the location and size of the bbox
731.             # (`.patches.FancyBboxPatch`), and draw it.
732.             if self._bbox_patch:
733.                 self.update_bbox_position_size(renderer)
734.                 self._bbox_patch.draw(renderer)
735. 
736.             gc = renderer.new_gc()
737.             gc.set_foreground(self.get_color())
738.             gc.set_alpha(self.get_alpha())
739.             gc.set_url(self._url)
740.             self._set_gc_clip(gc)
741. 
742.             angle = self.get_rotation()
743. 
744.             for line, wh, x, y in info:
745. 
746.                 mtext = self if len(info) == 1 else None
747.                 x = x + posx
748.                 y = y + posy
749.                 if renderer.flipy():
750.                     y = canvash - y
751.                 clean_line, ismath = self._preprocess_math(line)
752. 
753.                 if self.get_path_effects():
754.                     from matplotlib.patheffects import PathEffectRenderer
755.                     textrenderer = PathEffectRenderer(
756.                         self.get_path_effects(), renderer)
757.                 else:
758.                     textrenderer = renderer
759. 
760.                 if self.get_usetex():
761.                     textrenderer.draw_tex(gc, x, y, clean_line,
762.                                           self._fontproperties, angle,
763.                                           mtext=mtext)
764.                 else:
765.                     textrenderer.draw_text(gc, x, y, clean_line,
766.                                            self._fontproperties, angle,
767.                                            ismath=ismath, mtext=mtext)
768. 
769.         gc.restore()
770.         renderer.close_group('text')
771.         self.stale = False
772. 
773.     def get_color(self):
774.         """Return the color of the text."""
775.         return self._color
776. 
777.     def get_fontproperties(self):
778.         """Return the `.font_manager.FontProperties`."""
779.         return self._fontproperties
780. 
781.     def get_fontfamily(self):
782.         """
783.         Return the list of font families used for font lookup.
784. 
785.         See Also
786.         --------
787.         .font_manager.FontProperties.get_family
788.         """
789.         return self._fontproperties.get_family()
790. 
791.     def get_fontname(self):
792.         """
793.         Return the font name as a string.
794. 
795.         See Also
796.         --------
797.         .font_manager.FontProperties.get_name
798.         """
799.         return self._fontproperties.get_name()
800. 
801.     def get_fontstyle(self):
802.         """
803.         Return the font style as a string.
804. 
805.         See Also
806.         --------
807.         .font_manager.FontProperties.get_style
808.         """
809.         return self._fontproperties.get_style()
810. 
811.     def get_fontsize(self):
812.         """
813.         Return the font size as an integer.
814. 
815.         See Also
816.         --------
817.         .font_manager.FontProperties.get_size_in_points
818.         """
819.         return self._fontproperties.get_size_in_points()
820. 
821.     def get_fontvariant(self):
822.         """
823.         Return the font variant as a string.
824. 
825.         See Also
826.         --------
827.         .font_manager.FontProperties.get_variant
828.         """
829.         return self._fontproperties.get_variant()
830. 
831.     def get_fontweight(self):
832.         """
833.         Return the font weight as a string or a number.
834. 
835.         See Also
836.         --------
837.         .font_manager.FontProperties.get_weight
838.         """
839.         return self._fontproperties.get_weight()
840. 
841.     def get_stretch(self):
842.         """
843.         Return the font stretch as a string or a number.
844. 
845.         See Also
846.         --------
847.         .font_manager.FontProperties.get_stretch
848.         """
849.         return self._fontproperties.get_stretch()
850. 
851.     def get_horizontalalignment(self):
852.         """
853.         Return the horizontal alignment as a string.  Will be one of
854.         'left', 'center' or 'right'.
855.         """
856.         return self._horizontalalignment
857. 
858.     def get_unitless_position(self):
859.         """Return the (x, y) unitless position of the text."""
860.         # This will get the position with all unit information stripped away.
861.         # This is here for convenience since it is done in several locations.
862.         x = float(self.convert_xunits(self._x))
863.         y = float(self.convert_yunits(self._y))
864.         return x, y
865. 
866.     def get_position(self):
867.         """Return the (x, y) position of the text."""
868.         # This should return the same data (possible unitized) as was
869.         # specified with 'set_x' and 'set_y'.
870.         return self._x, self._y
871. 
872.     def get_text(self):
873.         """Return the text string."""
874.         return self._text
875. 
876.     def get_verticalalignment(self):
877.         """
878.         Return the vertical alignment as a string.  Will be one of
879.         'top', 'center', 'bottom', 'baseline' or 'center_baseline'.
880.         """
881.         return self._verticalalignment
882. 
883.     def get_window_extent(self, renderer=None, dpi=None):
884.         """
885.         Return the `.Bbox` bounding the text, in display units.
886. 
887.         In addition to being used internally, this is useful for specifying
888.         clickable regions in a png file on a web page.
889. 
890.         Parameters
891.         ----------
892.         renderer : Renderer, optional
893.             A renderer is needed to compute the bounding box.  If the artist
894.             has already been drawn, the renderer is cached; thus, it is only
895.             necessary to pass this argument when calling `get_window_extent`
896.             before the first draw.  In practice, it is usually easier to
897.             trigger a draw first, e.g. by calling
898.             `~.Figure.draw_without_rendering` or ``plt.show()``.
899. 
900.         dpi : float, optional
901.             The dpi value for computing the bbox, defaults to
902.             ``self.figure.dpi`` (*not* the renderer dpi); should be set e.g. if
903.             to match regions with a figure saved with a custom dpi value.
904.         """
905.         if not self.get_visible():
906.             return Bbox.unit()
907.         if dpi is None:
908.             dpi = self.figure.dpi
909.         if self.get_text() == '':
910.             with cbook._setattr_cm(self.figure, dpi=dpi):
911.                 tx, ty = self._get_xy_display()
912.                 return Bbox.from_bounds(tx, ty, 0, 0)
913. 
914.         if renderer is not None:
915.             self._renderer = renderer
916.         if self._renderer is None:
917.             self._renderer = self.figure._get_renderer()
918.         if self._renderer is None:
919.             raise RuntimeError(
920.                 "Cannot get window extent of text w/o renderer. You likely "
921.                 "want to call 'figure.draw_without_rendering()' first.")
922. 
923.         with cbook._setattr_cm(self.figure, dpi=dpi):
924.             bbox, info, descent = self._get_layout(self._renderer)
925.             x, y = self.get_unitless_position()
926.             x, y = self.get_transform().transform((x, y))
927.             bbox = bbox.translated(x, y)
928.             return bbox
929. 
930.     def set_backgroundcolor(self, color):
931.         """
932.         Set the background color of the text by updating the bbox.
933. 
934.         Parameters
935.         ----------
936.         color : color
937. 
938.         See Also
939.         --------
940.         .set_bbox : To change the position of the bounding box
941.         """
942.         if self._bbox_patch is None:
943.             self.set_bbox(dict(facecolor=color, edgecolor=color))
944.         else:
945.             self._bbox_patch.update(dict(facecolor=color))
946. 
947.         self._update_clip_properties()
948.         self.stale = True
949. 
950.     def set_color(self, color):
951.         """
952.         Set the foreground color of the text
953. 
954.         Parameters
955.         ----------
956.         color : color
957.         """
958.         # "auto" is only supported by axisartist, but we can just let it error
959.         # out at draw time for simplicity.
960.         if not cbook._str_equal(color, "auto"):
961.             mpl.colors._check_color_like(color=color)
962.         self._color = color
963.         self.stale = True
964. 
965.     def set_horizontalalignment(self, align):
966.         """
967.         Set the horizontal alignment relative to the anchor point.
968. 
969.         See also :doc:`/gallery/text_labels_and_annotations/text_alignment`.
970. 
971.         Parameters
972.         ----------
973.         align : {'left', 'center', 'right'}
974.         """
975.         _api.check_in_list(['center', 'right', 'left'], align=align)
976.         self._horizontalalignment = align
977.         self.stale = True
978. 
979.     def set_multialignment(self, align):
980.         """
981.         Set the text alignment for multiline texts.
982. 
983.         The layout of the bounding box of all the lines is determined by the
984.         horizontalalignment and verticalalignment properties. This property
985.         controls the alignment of the text lines within that box.
986. 
987.         Parameters
988.         ----------
989.         align : {'left', 'right', 'center'}
990.         """
991.         _api.check_in_list(['center', 'right', 'left'], align=align)
992.         self._multialignment = align
993.         self.stale = True
994. 
995.     def set_linespacing(self, spacing):
996.         """
997.         Set the line spacing as a multiple of the font size.
998. 
999.         The default line spacing is 1.2.
1000. 
1001.         Parameters


File: lib/matplotlib/text.py
Line number range: 1002 - 1502
Content:
1002.         ----------
1003.         spacing : float (multiple of font size)
1004.         """
1005.         _api.check_isinstance(Real, spacing=spacing)
1006.         self._linespacing = spacing
1007.         self.stale = True
1008. 
1009.     def set_fontfamily(self, fontname):
1010.         """
1011.         Set the font family.  Can be either a single string, or a list of
1012.         strings in decreasing priority.  Each string may be either a real font
1013.         name or a generic font class name.  If the latter, the specific font
1014.         names will be looked up in the corresponding rcParams.
1015. 
1016.         If a `Text` instance is constructed with ``fontfamily=None``, then the
1017.         font is set to :rc:`font.family`, and the
1018.         same is done when `set_fontfamily()` is called on an existing
1019.         `Text` instance.
1020. 
1021.         Parameters
1022.         ----------
1023.         fontname : {FONTNAME, 'serif', 'sans-serif', 'cursive', 'fantasy', \
1024. 'monospace'}
1025. 
1026.         See Also
1027.         --------
1028.         .font_manager.FontProperties.set_family
1029.         """
1030.         self._fontproperties.set_family(fontname)
1031.         self.stale = True
1032. 
1033.     def set_fontvariant(self, variant):
1034.         """
1035.         Set the font variant.
1036. 
1037.         Parameters
1038.         ----------
1039.         variant : {'normal', 'small-caps'}
1040. 
1041.         See Also
1042.         --------
1043.         .font_manager.FontProperties.set_variant
1044.         """
1045.         self._fontproperties.set_variant(variant)
1046.         self.stale = True
1047. 
1048.     def set_fontstyle(self, fontstyle):
1049.         """
1050.         Set the font style.
1051. 
1052.         Parameters
1053.         ----------
1054.         fontstyle : {'normal', 'italic', 'oblique'}
1055. 
1056.         See Also
1057.         --------
1058.         .font_manager.FontProperties.set_style
1059.         """
1060.         self._fontproperties.set_style(fontstyle)
1061.         self.stale = True
1062. 
1063.     def set_fontsize(self, fontsize):
1064.         """
1065.         Set the font size.
1066. 
1067.         Parameters
1068.         ----------
1069.         fontsize : float or {'xx-small', 'x-small', 'small', 'medium', \
1070. 'large', 'x-large', 'xx-large'}
1071.             If a float, the fontsize in points. The string values denote sizes
1072.             relative to the default font size.
1073. 
1074.         See Also
1075.         --------
1076.         .font_manager.FontProperties.set_size
1077.         """
1078.         self._fontproperties.set_size(fontsize)
1079.         self.stale = True
1080. 
1081.     def get_math_fontfamily(self):
1082.         """
1083.         Return the font family name for math text rendered by Matplotlib.
1084. 
1085.         The default value is :rc:`mathtext.fontset`.
1086. 
1087.         See Also
1088.         --------
1089.         set_math_fontfamily
1090.         """
1091.         return self._fontproperties.get_math_fontfamily()
1092. 
1093.     def set_math_fontfamily(self, fontfamily):
1094.         """
1095.         Set the font family for math text rendered by Matplotlib.
1096. 
1097.         This does only affect Matplotlib's own math renderer. It has no effect
1098.         when rendering with TeX (``usetex=True``).
1099. 
1100.         Parameters
1101.         ----------
1102.         fontfamily : str
1103.             The name of the font family.
1104. 
1105.             Available font families are defined in the
1106.             :ref:`default matplotlibrc file
1107.             <customizing-with-matplotlibrc-files>`.
1108. 
1109.         See Also
1110.         --------
1111.         get_math_fontfamily
1112.         """
1113.         self._fontproperties.set_math_fontfamily(fontfamily)
1114. 
1115.     def set_fontweight(self, weight):
1116.         """
1117.         Set the font weight.
1118. 
1119.         Parameters
1120.         ----------
1121.         weight : {a numeric value in range 0-1000, 'ultralight', 'light', \
1122. 'normal', 'regular', 'book', 'medium', 'roman', 'semibold', 'demibold', \
1123. 'demi', 'bold', 'heavy', 'extra bold', 'black'}
1124. 
1125.         See Also
1126.         --------
1127.         .font_manager.FontProperties.set_weight
1128.         """
1129.         self._fontproperties.set_weight(weight)
1130.         self.stale = True
1131. 
1132.     def set_fontstretch(self, stretch):
1133.         """
1134.         Set the font stretch (horizontal condensation or expansion).
1135. 
1136.         Parameters
1137.         ----------
1138.         stretch : {a numeric value in range 0-1000, 'ultra-condensed', \
1139. 'extra-condensed', 'condensed', 'semi-condensed', 'normal', 'semi-expanded', \
1140. 'expanded', 'extra-expanded', 'ultra-expanded'}
1141. 
1142.         See Also
1143.         --------
1144.         .font_manager.FontProperties.set_stretch
1145.         """
1146.         self._fontproperties.set_stretch(stretch)
1147.         self.stale = True
1148. 
1149.     def set_position(self, xy):
1150.         """
1151.         Set the (*x*, *y*) position of the text.
1152. 
1153.         Parameters
1154.         ----------
1155.         xy : (float, float)
1156.         """
1157.         self.set_x(xy[0])
1158.         self.set_y(xy[1])
1159. 
1160.     def set_x(self, x):
1161.         """
1162.         Set the *x* position of the text.
1163. 
1164.         Parameters
1165.         ----------
1166.         x : float
1167.         """
1168.         self._x = x
1169.         self.stale = True
1170. 
1171.     def set_y(self, y):
1172.         """
1173.         Set the *y* position of the text.
1174. 
1175.         Parameters
1176.         ----------
1177.         y : float
1178.         """
1179.         self._y = y
1180.         self.stale = True
1181. 
1182.     def set_rotation(self, s):
1183.         """
1184.         Set the rotation of the text.
1185. 
1186.         Parameters
1187.         ----------
1188.         s : float or {'vertical', 'horizontal'}
1189.             The rotation angle in degrees in mathematically positive direction
1190.             (counterclockwise). 'horizontal' equals 0, 'vertical' equals 90.
1191.         """
1192.         if isinstance(s, Real):
1193.             self._rotation = float(s) % 360
1194.         elif cbook._str_equal(s, 'horizontal') or s is None:
1195.             self._rotation = 0.
1196.         elif cbook._str_equal(s, 'vertical'):
1197.             self._rotation = 90.
1198.         else:
1199.             raise ValueError("rotation must be 'vertical', 'horizontal' or "
1200.                              f"a number, not {s}")
1201.         self.stale = True
1202. 
1203.     def set_transform_rotates_text(self, t):
1204.         """
1205.         Whether rotations of the transform affect the text direction.
1206. 
1207.         Parameters
1208.         ----------
1209.         t : bool
1210.         """
1211.         self._transform_rotates_text = t
1212.         self.stale = True
1213. 
1214.     def set_verticalalignment(self, align):
1215.         """
1216.         Set the vertical alignment relative to the anchor point.
1217. 
1218.         See also :doc:`/gallery/text_labels_and_annotations/text_alignment`.
1219. 
1220.         Parameters
1221.         ----------
1222.         align : {'bottom', 'baseline', 'center', 'center_baseline', 'top'}
1223.         """
1224.         _api.check_in_list(
1225.             ['top', 'bottom', 'center', 'baseline', 'center_baseline'],
1226.             align=align)
1227.         self._verticalalignment = align
1228.         self.stale = True
1229. 
1230.     def set_text(self, s):
1231.         r"""
1232.         Set the text string *s*.
1233. 
1234.         It may contain newlines (``\n``) or math in LaTeX syntax.
1235. 
1236.         Parameters
1237.         ----------
1238.         s : object
1239.             Any object gets converted to its `str` representation, except for
1240.             ``None`` which is converted to an empty string.
1241.         """
1242.         if s is None:
1243.             s = ''
1244.         if s != self._text:
1245.             self._text = str(s)
1246.             self.stale = True
1247. 
1248.     def _preprocess_math(self, s):
1249.         """
1250.         Return the string *s* after mathtext preprocessing, and the kind of
1251.         mathtext support needed.
1252. 
1253.         - If *self* is configured to use TeX, return *s* unchanged except that
1254.           a single space gets escaped, and the flag "TeX".
1255.         - Otherwise, if *s* is mathtext (has an even number of unescaped dollar
1256.           signs) and ``parse_math`` is not set to False, return *s* and the
1257.           flag True.
1258.         - Otherwise, return *s* with dollar signs unescaped, and the flag
1259.           False.
1260.         """
1261.         if self.get_usetex():
1262.             if s == " ":
1263.                 s = r"\ "
1264.             return s, "TeX"
1265.         elif not self.get_parse_math():
1266.             return s, False
1267.         elif cbook.is_math_text(s):
1268.             return s, True
1269.         else:
1270.             return s.replace(r"\$", "$"), False
1271. 
1272.     def set_fontproperties(self, fp):
1273.         """
1274.         Set the font properties that control the text.
1275. 
1276.         Parameters
1277.         ----------
1278.         fp : `.font_manager.FontProperties` or `str` or `pathlib.Path`
1279.             If a `str`, it is interpreted as a fontconfig pattern parsed by
1280.             `.FontProperties`.  If a `pathlib.Path`, it is interpreted as the
1281.             absolute path to a font file.
1282.         """
1283.         self._fontproperties = FontProperties._from_any(fp).copy()
1284.         self.stale = True
1285. 
1286.     def set_usetex(self, usetex):
1287.         """
1288.         Parameters
1289.         ----------
1290.         usetex : bool or None
1291.             Whether to render using TeX, ``None`` means to use
1292.             :rc:`text.usetex`.
1293.         """
1294.         if usetex is None:
1295.             self._usetex = mpl.rcParams['text.usetex']
1296.         else:
1297.             self._usetex = bool(usetex)
1298.         self.stale = True
1299. 
1300.     def get_usetex(self):
1301.         """Return whether this `Text` object uses TeX for rendering."""
1302.         return self._usetex
1303. 
1304.     def set_parse_math(self, parse_math):
1305.         """
1306.         Override switch to disable any mathtext parsing for this `Text`.
1307. 
1308.         Parameters
1309.         ----------
1310.         parse_math : bool
1311.             If False, this `Text` will never use mathtext.  If True, mathtext
1312.             will be used if there is an even number of unescaped dollar signs.
1313.         """
1314.         self._parse_math = bool(parse_math)
1315. 
1316.     def get_parse_math(self):
1317.         """Return whether mathtext parsing is considered for this `Text`."""
1318.         return self._parse_math
1319. 
1320.     def set_fontname(self, fontname):
1321.         """
1322.         Alias for `set_family`.
1323. 
1324.         One-way alias only: the getter differs.
1325. 
1326.         Parameters
1327.         ----------
1328.         fontname : {FONTNAME, 'serif', 'sans-serif', 'cursive', 'fantasy', \
1329. 'monospace'}
1330. 
1331.         See Also
1332.         --------
1333.         .font_manager.FontProperties.set_family
1334. 
1335.         """
1336.         return self.set_family(fontname)
1337. 
1338. 
1339. class OffsetFrom:
1340.     """Callable helper class for working with `Annotation`."""
1341. 
1342.     def __init__(self, artist, ref_coord, unit="points"):
1343.         """
1344.         Parameters
1345.         ----------
1346.         artist : `.Artist` or `.BboxBase` or `.Transform`
1347.             The object to compute the offset from.
1348. 
1349.         ref_coord : (float, float)
1350.             If *artist* is an `.Artist` or `.BboxBase`, this values is
1351.             the location to of the offset origin in fractions of the
1352.             *artist* bounding box.
1353. 
1354.             If *artist* is a transform, the offset origin is the
1355.             transform applied to this value.
1356. 
1357.         unit : {'points, 'pixels'}, default: 'points'
1358.             The screen units to use (pixels or points) for the offset input.
1359.         """
1360.         self._artist = artist
1361.         self._ref_coord = ref_coord
1362.         self.set_unit(unit)
1363. 
1364.     def set_unit(self, unit):
1365.         """
1366.         Set the unit for input to the transform used by ``__call__``.
1367. 
1368.         Parameters
1369.         ----------
1370.         unit : {'points', 'pixels'}
1371.         """
1372.         _api.check_in_list(["points", "pixels"], unit=unit)
1373.         self._unit = unit
1374. 
1375.     def get_unit(self):
1376.         """Return the unit for input to the transform used by ``__call__``."""
1377.         return self._unit
1378. 
1379.     def _get_scale(self, renderer):
1380.         unit = self.get_unit()
1381.         if unit == "pixels":
1382.             return 1.
1383.         else:
1384.             return renderer.points_to_pixels(1.)
1385. 
1386.     def __call__(self, renderer):
1387.         """
1388.         Return the offset transform.
1389. 
1390.         Parameters
1391.         ----------
1392.         renderer : `RendererBase`
1393.             The renderer to use to compute the offset
1394. 
1395.         Returns
1396.         -------
1397.         `Transform`
1398.             Maps (x, y) in pixel or point units to screen units
1399.             relative to the given artist.
1400.         """
1401.         if isinstance(self._artist, Artist):
1402.             bbox = self._artist.get_window_extent(renderer)
1403.             xf, yf = self._ref_coord
1404.             x = bbox.x0 + bbox.width * xf
1405.             y = bbox.y0 + bbox.height * yf
1406.         elif isinstance(self._artist, BboxBase):
1407.             bbox = self._artist
1408.             xf, yf = self._ref_coord
1409.             x = bbox.x0 + bbox.width * xf
1410.             y = bbox.y0 + bbox.height * yf
1411.         elif isinstance(self._artist, Transform):
1412.             x, y = self._artist.transform(self._ref_coord)
1413.         else:
1414.             _api.check_isinstance((Artist, BboxBase, Transform), artist=self._artist)
1415. 
1416.         sc = self._get_scale(renderer)
1417.         tr = Affine2D().scale(sc).translate(x, y)
1418. 
1419.         return tr
1420. 
1421. 
1422. class _AnnotationBase:
1423.     def __init__(self,
1424.                  xy,
1425.                  xycoords='data',
1426.                  annotation_clip=None):
1427. 
1428.         self.xy = xy
1429.         self.xycoords = xycoords
1430.         self.set_annotation_clip(annotation_clip)
1431. 
1432.         self._draggable = None
1433. 
1434.     def _get_xy(self, renderer, xy, coords):
1435.         x, y = xy
1436.         xcoord, ycoord = coords if isinstance(coords, tuple) else (coords, coords)
1437.         if xcoord == 'data':
1438.             x = float(self.convert_xunits(x))
1439.         if ycoord == 'data':
1440.             y = float(self.convert_yunits(y))
1441.         return self._get_xy_transform(renderer, coords).transform((x, y))
1442. 
1443.     def _get_xy_transform(self, renderer, coords):
1444. 
1445.         if isinstance(coords, tuple):
1446.             xcoord, ycoord = coords
1447.             from matplotlib.transforms import blended_transform_factory
1448.             tr1 = self._get_xy_transform(renderer, xcoord)
1449.             tr2 = self._get_xy_transform(renderer, ycoord)
1450.             return blended_transform_factory(tr1, tr2)
1451.         elif callable(coords):
1452.             tr = coords(renderer)
1453.             if isinstance(tr, BboxBase):
1454.                 return BboxTransformTo(tr)
1455.             elif isinstance(tr, Transform):
1456.                 return tr
1457.             else:
1458.                 raise TypeError(
1459.                     f"xycoords callable must return a BboxBase or Transform, not a "
1460.                     f"{type(tr).__name__}")
1461.         elif isinstance(coords, Artist):
1462.             bbox = coords.get_window_extent(renderer)
1463.             return BboxTransformTo(bbox)
1464.         elif isinstance(coords, BboxBase):
1465.             return BboxTransformTo(coords)
1466.         elif isinstance(coords, Transform):
1467.             return coords
1468.         elif not isinstance(coords, str):
1469.             raise TypeError(
1470.                 f"'xycoords' must be an instance of str, tuple[str, str], Artist, "
1471.                 f"Transform, or Callable, not a {type(coords).__name__}")
1472. 
1473.         if coords == 'data':
1474.             return self.axes.transData
1475.         elif coords == 'polar':
1476.             from matplotlib.projections import PolarAxes
1477.             tr = PolarAxes.PolarTransform()
1478.             trans = tr + self.axes.transData
1479.             return trans
1480. 
1481.         try:
1482.             bbox_name, unit = coords.split()
1483.         except ValueError:  # i.e. len(coords.split()) != 2.
1484.             raise ValueError(f"{coords!r} is not a valid coordinate") from None
1485. 
1486.         bbox0, xy0 = None, None
1487. 
1488.         # if unit is offset-like
1489.         if bbox_name == "figure":
1490.             bbox0 = self.figure.figbbox
1491.         elif bbox_name == "subfigure":
1492.             bbox0 = self.figure.bbox
1493.         elif bbox_name == "axes":
1494.             bbox0 = self.axes.bbox
1495. 
1496.         # reference x, y in display coordinate
1497.         if bbox0 is not None:
1498.             xy0 = bbox0.p0
1499.         elif bbox_name == "offset":
1500.             xy0 = self._get_position_xy(renderer)
1501.         else:
1502.             raise ValueError(f"{coords!r} is not a valid coordinate")


File: lib/matplotlib/text.py
Line number range: 1503 - 2003
Content:
1503. 
1504.         if unit == "points":
1505.             tr = Affine2D().scale(self.figure.dpi / 72)  # dpi/72 dots per point
1506.         elif unit == "pixels":
1507.             tr = Affine2D()
1508.         elif unit == "fontsize":
1509.             tr = Affine2D().scale(self.get_size() * self.figure.dpi / 72)
1510.         elif unit == "fraction":
1511.             tr = Affine2D().scale(*bbox0.size)
1512.         else:
1513.             raise ValueError(f"{unit!r} is not a recognized unit")
1514. 
1515.         return tr.translate(*xy0)
1516. 
1517.     def set_annotation_clip(self, b):
1518.         """
1519.         Set the annotation's clipping behavior.
1520. 
1521.         Parameters
1522.         ----------
1523.         b : bool or None
1524.             - True: The annotation will be clipped when ``self.xy`` is
1525.               outside the axes.
1526.             - False: The annotation will always be drawn.
1527.             - None: The annotation will be clipped when ``self.xy`` is
1528.               outside the axes and ``self.xycoords == "data"``.
1529.         """
1530.         self._annotation_clip = b
1531. 
1532.     def get_annotation_clip(self):
1533.         """
1534.         Return the annotation's clipping behavior.
1535. 
1536.         See `set_annotation_clip` for the meaning of return values.
1537.         """
1538.         return self._annotation_clip
1539. 
1540.     def _get_position_xy(self, renderer):
1541.         """Return the pixel position of the annotated point."""
1542.         return self._get_xy(renderer, self.xy, self.xycoords)
1543. 
1544.     def _check_xy(self, renderer=None):
1545.         """Check whether the annotation at *xy_pixel* should be drawn."""
1546.         if renderer is None:
1547.             renderer = self.figure._get_renderer()
1548.         b = self.get_annotation_clip()
1549.         if b or (b is None and self.xycoords == "data"):
1550.             # check if self.xy is inside the axes.
1551.             xy_pixel = self._get_position_xy(renderer)
1552.             return self.axes.contains_point(xy_pixel)
1553.         return True
1554. 
1555.     def draggable(self, state=None, use_blit=False):
1556.         """
1557.         Set whether the annotation is draggable with the mouse.
1558. 
1559.         Parameters
1560.         ----------
1561.         state : bool or None
1562.             - True or False: set the draggability.
1563.             - None: toggle the draggability.
1564.         use_blit : bool, default: False
1565.             Use blitting for faster image composition. For details see
1566.             :ref:`func-animation`.
1567. 
1568.         Returns
1569.         -------
1570.         DraggableAnnotation or None
1571.             If the annotation is draggable, the corresponding
1572.             `.DraggableAnnotation` helper is returned.
1573.         """
1574.         from matplotlib.offsetbox import DraggableAnnotation
1575.         is_draggable = self._draggable is not None
1576. 
1577.         # if state is None we'll toggle
1578.         if state is None:
1579.             state = not is_draggable
1580. 
1581.         if state:
1582.             if self._draggable is None:
1583.                 self._draggable = DraggableAnnotation(self, use_blit)
1584.         else:
1585.             if self._draggable is not None:
1586.                 self._draggable.disconnect()
1587.             self._draggable = None
1588. 
1589.         return self._draggable
1590. 
1591. 
1592. class Annotation(Text, _AnnotationBase):
1593.     """
1594.     An `.Annotation` is a `.Text` that can refer to a specific position *xy*.
1595.     Optionally an arrow pointing from the text to *xy* can be drawn.
1596. 
1597.     Attributes
1598.     ----------
1599.     xy
1600.         The annotated position.
1601.     xycoords
1602.         The coordinate system for *xy*.
1603.     arrow_patch
1604.         A `.FancyArrowPatch` to point from *xytext* to *xy*.
1605.     """
1606. 
1607.     def __str__(self):
1608.         return f"Annotation({self.xy[0]:g}, {self.xy[1]:g}, {self._text!r})"
1609. 
1610.     def __init__(self, text, xy,
1611.                  xytext=None,
1612.                  xycoords='data',
1613.                  textcoords=None,
1614.                  arrowprops=None,
1615.                  annotation_clip=None,
1616.                  **kwargs):
1617.         """
1618.         Annotate the point *xy* with text *text*.
1619. 
1620.         In the simplest form, the text is placed at *xy*.
1621. 
1622.         Optionally, the text can be displayed in another position *xytext*.
1623.         An arrow pointing from the text to the annotated point *xy* can then
1624.         be added by defining *arrowprops*.
1625. 
1626.         Parameters
1627.         ----------
1628.         text : str
1629.             The text of the annotation.
1630. 
1631.         xy : (float, float)
1632.             The point *(x, y)* to annotate. The coordinate system is determined
1633.             by *xycoords*.
1634. 
1635.         xytext : (float, float), default: *xy*
1636.             The position *(x, y)* to place the text at. The coordinate system
1637.             is determined by *textcoords*.
1638. 
1639.         xycoords : single or two-tuple of str or `.Artist` or `.Transform` or \
1640. callable, default: 'data'
1641. 
1642.             The coordinate system that *xy* is given in. The following types
1643.             of values are supported:
1644. 
1645.             - One of the following strings:
1646. 
1647.               ==================== ============================================
1648.               Value                Description
1649.               ==================== ============================================
1650.               'figure points'      Points from the lower left of the figure
1651.               'figure pixels'      Pixels from the lower left of the figure
1652.               'figure fraction'    Fraction of figure from lower left
1653.               'subfigure points'   Points from the lower left of the subfigure
1654.               'subfigure pixels'   Pixels from the lower left of the subfigure
1655.               'subfigure fraction' Fraction of subfigure from lower left
1656.               'axes points'        Points from lower left corner of axes
1657.               'axes pixels'        Pixels from lower left corner of axes
1658.               'axes fraction'      Fraction of axes from lower left
1659.               'data'               Use the coordinate system of the object
1660.                                    being annotated (default)
1661.               'polar'              *(theta, r)* if not native 'data'
1662.                                    coordinates
1663.               ==================== ============================================
1664. 
1665.               Note that 'subfigure pixels' and 'figure pixels' are the same
1666.               for the parent figure, so users who want code that is usable in
1667.               a subfigure can use 'subfigure pixels'.
1668. 
1669.             - An `.Artist`: *xy* is interpreted as a fraction of the artist's
1670.               `~matplotlib.transforms.Bbox`. E.g. *(0, 0)* would be the lower
1671.               left corner of the bounding box and *(0.5, 1)* would be the
1672.               center top of the bounding box.
1673. 
1674.             - A `.Transform` to transform *xy* to screen coordinates.
1675. 
1676.             - A function with one of the following signatures::
1677. 
1678.                 def transform(renderer) -> Bbox
1679.                 def transform(renderer) -> Transform
1680. 
1681.               where *renderer* is a `.RendererBase` subclass.
1682. 
1683.               The result of the function is interpreted like the `.Artist` and
1684.               `.Transform` cases above.
1685. 
1686.             - A tuple *(xcoords, ycoords)* specifying separate coordinate
1687.               systems for *x* and *y*. *xcoords* and *ycoords* must each be
1688.               of one of the above described types.
1689. 
1690.             See :ref:`plotting-guide-annotation` for more details.
1691. 
1692.         textcoords : single or two-tuple of str or `.Artist` or `.Transform` \
1693. or callable, default: value of *xycoords*
1694.             The coordinate system that *xytext* is given in.
1695. 
1696.             All *xycoords* values are valid as well as the following strings:
1697. 
1698.             =================   =================================================
1699.             Value               Description
1700.             =================   =================================================
1701.             'offset points'     Offset, in points, from the *xy* value
1702.             'offset pixels'     Offset, in pixels, from the *xy* value
1703.             'offset fontsize'   Offset, relative to fontsize, from the *xy* value
1704.             =================   =================================================
1705. 
1706.         arrowprops : dict, optional
1707.             The properties used to draw a `.FancyArrowPatch` arrow between the
1708.             positions *xy* and *xytext*.  Defaults to None, i.e. no arrow is
1709.             drawn.
1710. 
1711.             For historical reasons there are two different ways to specify
1712.             arrows, "simple" and "fancy":
1713. 
1714.             **Simple arrow:**
1715. 
1716.             If *arrowprops* does not contain the key 'arrowstyle' the
1717.             allowed keys are:
1718. 
1719.             ==========   ======================================================
1720.             Key          Description
1721.             ==========   ======================================================
1722.             width        The width of the arrow in points
1723.             headwidth    The width of the base of the arrow head in points
1724.             headlength   The length of the arrow head in points
1725.             shrink       Fraction of total length to shrink from both ends
1726.             ?            Any key to :class:`matplotlib.patches.FancyArrowPatch`
1727.             ==========   ======================================================
1728. 
1729.             The arrow is attached to the edge of the text box, the exact
1730.             position (corners or centers) depending on where it's pointing to.
1731. 
1732.             **Fancy arrow:**
1733. 
1734.             This is used if 'arrowstyle' is provided in the *arrowprops*.
1735. 
1736.             Valid keys are the following `~matplotlib.patches.FancyArrowPatch`
1737.             parameters:
1738. 
1739.             ===============  ==================================================
1740.             Key              Description
1741.             ===============  ==================================================
1742.             arrowstyle       the arrow style
1743.             connectionstyle  the connection style
1744.             relpos           see below; default is (0.5, 0.5)
1745.             patchA           default is bounding box of the text
1746.             patchB           default is None
1747.             shrinkA          default is 2 points
1748.             shrinkB          default is 2 points
1749.             mutation_scale   default is text size (in points)
1750.             mutation_aspect  default is 1.
1751.             ?                any key for :class:`matplotlib.patches.PathPatch`
1752.             ===============  ==================================================
1753. 
1754.             The exact starting point position of the arrow is defined by
1755.             *relpos*. It's a tuple of relative coordinates of the text box,
1756.             where (0, 0) is the lower left corner and (1, 1) is the upper
1757.             right corner. Values <0 and >1 are supported and specify points
1758.             outside the text box. By default (0.5, 0.5), so the starting point
1759.             is centered in the text box.
1760. 
1761.         annotation_clip : bool or None, default: None
1762.             Whether to clip (i.e. not draw) the annotation when the annotation
1763.             point *xy* is outside the axes area.
1764. 
1765.             - If *True*, the annotation will be clipped when *xy* is outside
1766.               the axes.
1767.             - If *False*, the annotation will always be drawn.
1768.             - If *None*, the annotation will be clipped when *xy* is outside
1769.               the axes and *xycoords* is 'data'.
1770. 
1771.         **kwargs
1772.             Additional kwargs are passed to `~matplotlib.text.Text`.
1773. 
1774.         Returns
1775.         -------
1776.         `.Annotation`
1777. 
1778.         See Also
1779.         --------
1780.         :ref:`plotting-guide-annotation`
1781. 
1782.         """
1783.         _AnnotationBase.__init__(self,
1784.                                  xy,
1785.                                  xycoords=xycoords,
1786.                                  annotation_clip=annotation_clip)
1787.         # warn about wonky input data
1788.         if (xytext is None and
1789.                 textcoords is not None and
1790.                 textcoords != xycoords):
1791.             _api.warn_external("You have used the `textcoords` kwarg, but "
1792.                                "not the `xytext` kwarg.  This can lead to "
1793.                                "surprising results.")
1794. 
1795.         # clean up textcoords and assign default
1796.         if textcoords is None:
1797.             textcoords = self.xycoords
1798.         self._textcoords = textcoords
1799. 
1800.         # cleanup xytext defaults
1801.         if xytext is None:
1802.             xytext = self.xy
1803.         x, y = xytext
1804. 
1805.         self.arrowprops = arrowprops
1806.         if arrowprops is not None:
1807.             arrowprops = arrowprops.copy()
1808.             if "arrowstyle" in arrowprops:
1809.                 self._arrow_relpos = arrowprops.pop("relpos", (0.5, 0.5))
1810.             else:
1811.                 # modified YAArrow API to be used with FancyArrowPatch
1812.                 for key in [
1813.                         'width', 'headwidth', 'headlength', 'shrink', 'frac']:
1814.                     arrowprops.pop(key, None)
1815.             self.arrow_patch = FancyArrowPatch((0, 0), (1, 1), **arrowprops)
1816.         else:
1817.             self.arrow_patch = None
1818. 
1819.         # Must come last, as some kwargs may be propagated to arrow_patch.
1820.         Text.__init__(self, x, y, text, **kwargs)
1821. 
1822.     @_api.rename_parameter("3.8", "event", "mouseevent")
1823.     def contains(self, mouseevent):
1824.         if self._different_canvas(mouseevent):
1825.             return False, {}
1826.         contains, tinfo = Text.contains(self, mouseevent)
1827.         if self.arrow_patch is not None:
1828.             in_patch, _ = self.arrow_patch.contains(mouseevent)
1829.             contains = contains or in_patch
1830.         return contains, tinfo
1831. 
1832.     @property
1833.     def xycoords(self):
1834.         return self._xycoords
1835. 
1836.     @xycoords.setter
1837.     def xycoords(self, xycoords):
1838.         def is_offset(s):
1839.             return isinstance(s, str) and s.startswith("offset")
1840. 
1841.         if (isinstance(xycoords, tuple) and any(map(is_offset, xycoords))
1842.                 or is_offset(xycoords)):
1843.             raise ValueError("xycoords cannot be an offset coordinate")
1844.         self._xycoords = xycoords
1845. 
1846.     @property
1847.     def xyann(self):
1848.         """
1849.         The text position.
1850. 
1851.         See also *xytext* in `.Annotation`.
1852.         """
1853.         return self.get_position()
1854. 
1855.     @xyann.setter
1856.     def xyann(self, xytext):
1857.         self.set_position(xytext)
1858. 
1859.     def get_anncoords(self):
1860.         """
1861.         Return the coordinate system to use for `.Annotation.xyann`.
1862. 
1863.         See also *xycoords* in `.Annotation`.
1864.         """
1865.         return self._textcoords
1866. 
1867.     def set_anncoords(self, coords):
1868.         """
1869.         Set the coordinate system to use for `.Annotation.xyann`.
1870. 
1871.         See also *xycoords* in `.Annotation`.
1872.         """
1873.         self._textcoords = coords
1874. 
1875.     anncoords = property(get_anncoords, set_anncoords, doc="""
1876.         The coordinate system to use for `.Annotation.xyann`.""")
1877. 
1878.     def set_figure(self, fig):
1879.         # docstring inherited
1880.         if self.arrow_patch is not None:
1881.             self.arrow_patch.set_figure(fig)
1882.         Artist.set_figure(self, fig)
1883. 
1884.     def update_positions(self, renderer):
1885.         """
1886.         Update the pixel positions of the annotation text and the arrow patch.
1887.         """
1888.         # generate transformation
1889.         self.set_transform(self._get_xy_transform(renderer, self.anncoords))
1890. 
1891.         arrowprops = self.arrowprops
1892.         if arrowprops is None:
1893.             return
1894. 
1895.         bbox = Text.get_window_extent(self, renderer)
1896. 
1897.         arrow_end = x1, y1 = self._get_position_xy(renderer)  # Annotated pos.
1898. 
1899.         ms = arrowprops.get("mutation_scale", self.get_size())
1900.         self.arrow_patch.set_mutation_scale(ms)
1901. 
1902.         if "arrowstyle" not in arrowprops:
1903.             # Approximately simulate the YAArrow.
1904.             shrink = arrowprops.get('shrink', 0.0)
1905.             width = arrowprops.get('width', 4)
1906.             headwidth = arrowprops.get('headwidth', 12)
1907.             if 'frac' in arrowprops:
1908.                 _api.warn_external(
1909.                     "'frac' option in 'arrowprops' is no longer supported;"
1910.                     " use 'headlength' to set the head length in points.")
1911.             headlength = arrowprops.get('headlength', 12)
1912. 
1913.             # NB: ms is in pts
1914.             stylekw = dict(head_length=headlength / ms,
1915.                            head_width=headwidth / ms,
1916.                            tail_width=width / ms)
1917. 
1918.             self.arrow_patch.set_arrowstyle('simple', **stylekw)
1919. 
1920.             # using YAArrow style:
1921.             # pick the corner of the text bbox closest to annotated point.
1922.             xpos = [(bbox.x0, 0), ((bbox.x0 + bbox.x1) / 2, 0.5), (bbox.x1, 1)]
1923.             ypos = [(bbox.y0, 0), ((bbox.y0 + bbox.y1) / 2, 0.5), (bbox.y1, 1)]
1924.             x, relposx = min(xpos, key=lambda v: abs(v[0] - x1))
1925.             y, relposy = min(ypos, key=lambda v: abs(v[0] - y1))
1926.             self._arrow_relpos = (relposx, relposy)
1927.             r = np.hypot(y - y1, x - x1)
1928.             shrink_pts = shrink * r / renderer.points_to_pixels(1)
1929.             self.arrow_patch.shrinkA = self.arrow_patch.shrinkB = shrink_pts
1930. 
1931.         # adjust the starting point of the arrow relative to the textbox.
1932.         # TODO : Rotation needs to be accounted.
1933.         arrow_begin = bbox.p0 + bbox.size * self._arrow_relpos
1934.         # The arrow is drawn from arrow_begin to arrow_end.  It will be first
1935.         # clipped by patchA and patchB.  Then it will be shrunk by shrinkA and
1936.         # shrinkB (in points).  If patchA is not set, self.bbox_patch is used.
1937.         self.arrow_patch.set_positions(arrow_begin, arrow_end)
1938. 
1939.         if "patchA" in arrowprops:
1940.             patchA = arrowprops["patchA"]
1941.         elif self._bbox_patch:
1942.             patchA = self._bbox_patch
1943.         elif self.get_text() == "":
1944.             patchA = None
1945.         else:
1946.             pad = renderer.points_to_pixels(4)
1947.             patchA = Rectangle(
1948.                 xy=(bbox.x0 - pad / 2, bbox.y0 - pad / 2),
1949.                 width=bbox.width + pad, height=bbox.height + pad,
1950.                 transform=IdentityTransform(), clip_on=False)
1951.         self.arrow_patch.set_patchA(patchA)
1952. 
1953.     @artist.allow_rasterization
1954.     def draw(self, renderer):
1955.         # docstring inherited
1956.         if renderer is not None:
1957.             self._renderer = renderer
1958.         if not self.get_visible() or not self._check_xy(renderer):
1959.             return
1960.         # Update text positions before `Text.draw` would, so that the
1961.         # FancyArrowPatch is correctly positioned.
1962.         self.update_positions(renderer)
1963.         self.update_bbox_position_size(renderer)
1964.         if self.arrow_patch is not None:  # FancyArrowPatch
1965.             if self.arrow_patch.figure is None and self.figure is not None:
1966.                 self.arrow_patch.figure = self.figure
1967.             self.arrow_patch.draw(renderer)
1968.         # Draw text, including FancyBboxPatch, after FancyArrowPatch.
1969.         # Otherwise, a wedge arrowstyle can land partly on top of the Bbox.
1970.         Text.draw(self, renderer)
1971. 
1972.     def get_window_extent(self, renderer=None):
1973.         # docstring inherited
1974.         # This block is the same as in Text.get_window_extent, but we need to
1975.         # set the renderer before calling update_positions().
1976.         if not self.get_visible() or not self._check_xy(renderer):
1977.             return Bbox.unit()
1978.         if renderer is not None:
1979.             self._renderer = renderer
1980.         if self._renderer is None:
1981.             self._renderer = self.figure._get_renderer()
1982.         if self._renderer is None:
1983.             raise RuntimeError('Cannot get window extent without renderer')
1984. 
1985.         self.update_positions(self._renderer)
1986. 
1987.         text_bbox = Text.get_window_extent(self)
1988.         bboxes = [text_bbox]
1989. 
1990.         if self.arrow_patch is not None:
1991.             bboxes.append(self.arrow_patch.get_window_extent())
1992. 
1993.         return Bbox.union(bboxes)
1994. 
1995.     def get_tightbbox(self, renderer=None):
1996.         # docstring inherited
1997.         if not self._check_xy(renderer):
1998.             return Bbox.null()
1999.         return super().get_tightbbox(renderer)
2000. 
2001. 
2002. _docstring.interpd.update(Annotation=Annotation.__init__.__doc__)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 08:42:51,406 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user has requested the full content of the file `lib/matplotlib/text.py`. This context block includes the entire file as provided in the context.', relative_path='lib/matplotlib/text.py', start_line=1, end_line=2003)]
2025-12-21 08:42:51,409 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `lib/matplotlib/text.py`.
2025-12-21 08:42:51,409 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 08:42:51,409 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 08:42:51,410 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 2 existing contexts
2025-12-21 08:42:51,410 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-21 08:42:51,411 - thread-131008481461952.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-21 08:42:51,411 - thread-131008481461952.prometheus_context_collector - INFO - Successfully retrieved 3 context snippets
