2025-12-21 01:05:48,999 - thread-131294958716608.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: cla(), clf() should unset the `.axes` and `.figure` attributes of deparented artists

Description: mpl2.0b3: Removing an artist from its axes unsets its `.axes` attribute, but clearing the axes does not do so.

```
In [11]: f, a = plt.subplots(); l, = a.plot([1, 2]); l.remove(); print(l.axes)
None

In [12]: f, a = plt.subplots(); l, = a.plot([1, 2]); a.cla(); print(l.axes)
Axes(0.125,0.11;0.775x0.77)
```


Patch information:
diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py
index 90b0bf117e..781bbc5b96 100644
--- a/lib/matplotlib/axes/_base.py
+++ b/lib/matplotlib/axes/_base.py
@@ -1308,6 +1308,37 @@ class _AxesBase(martist.Artist):
         self._get_patches_for_fill = _process_plot_var_args(self, 'fill')
 
         self._gridOn = mpl.rcParams['axes.grid']
+        # Detach and deparent existing child artists so their .axes/.figure are unset.
+        for _artist in list(self._children):
+            try:
+                _artist.remove()
+            except Exception:
+                try:
+                    # Fallback: manually decouple the artist from this Axes/Figure.
+                    if hasattr(_artist, "axes") and _artist.axes is self:
+                        self._mouseover_set.discard(_artist)
+                        _artist.axes = None
+                    if getattr(_artist, "figure", None) is self.figure:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
+        # Also remove any existing legend artist explicitly if present.
+        if getattr(self, "legend_", None) is not None:
+            try:
+                self.legend_.remove()
+            except Exception:
+                try:
+                    if hasattr(self.legend_, "axes") and self.legend_.axes is self:
+                        self._mouseover_set.discard(self.legend_)
+                        self.legend_.axes = None
+                    if getattr(self.legend_, "figure", None) is self.figure:
+                        self.legend_.figure = None
+                    self.legend_.stale_callback = None
+                    self.legend_._remove_method = None
+                except Exception:
+                    pass
         self._children = []
         self._mouseover_set = _OrderedSet()
         self.child_axes = []
diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py
index 6c18ba1a64..92ab8887e8 100644
--- a/lib/matplotlib/figure.py
+++ b/lib/matplotlib/figure.py
@@ -949,6 +949,18 @@ default: %(va)s
             ax.clear()
             self.delaxes(ax)  # Remove ax from self._axstack.
 
+        # Detach and deparent any artists directly added to the Figure
+        # so their .figure attribute is unset, consistent with Artist.remove().
+        for _alist in (self.artists, self.lines, self.patches,
+                       self.texts, self.images, self.legends):
+            for _artist in list(_alist):
+                try:
+                    if getattr(_artist, "figure", None) is self:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
         self.artists = []
         self.lines = []
         self.patches = []


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 01:05:49,075 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   ├── 24189-JB.rst
|   |   |   |   └── 24570-GL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   ├── 24455-AL.rst
|   |   |   |   └── 24577-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   └── 24257-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       ├── 24356-OG.rst
|   |   |       └── 24624-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── rgba_pcolormesh.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   └── view_current_axis_format.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           └── test_axes3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: cla(), clf() should unset the `.axes` and `.figure` attributes of deparented artists

Description: mpl2.0b3: Removing an artist from its axes unsets its `.axes` attribute, but clearing the axes does not do so.

```
In [11]: f, a = plt.subplots(); l, = a.plot([1, 2]); l.remove(); print(l.axes)
None

In [12]: f, a = plt.subplots(); l, = a.plot([1, 2]); a.cla(); print(l.axes)
Axes(0.125,0.11;0.775x0.77)
```


Patch information:
diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py
index 90b0bf117e..781bbc5b96 100644
--- a/lib/matplotlib/axes/_base.py
+++ b/lib/matplotlib/axes/_base.py
@@ -1308,6 +1308,37 @@ class _AxesBase(martist.Artist):
         self._get_patches_for_fill = _process_plot_var_args(self, 'fill')
 
         self._gridOn = mpl.rcParams['axes.grid']
+        # Detach and deparent existing child artists so their .axes/.figure are unset.
+        for _artist in list(self._children):
+            try:
+                _artist.remove()
+            except Exception:
+                try:
+                    # Fallback: manually decouple the artist from this Axes/Figure.
+                    if hasattr(_artist, "axes") and _artist.axes is self:
+                        self._mouseover_set.discard(_artist)
+                        _artist.axes = None
+                    if getattr(_artist, "figure", None) is self.figure:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
+        # Also remove any existing legend artist explicitly if present.
+        if getattr(self, "legend_", None) is not None:
+            try:
+                self.legend_.remove()
+            except Exception:
+                try:
+                    if hasattr(self.legend_, "axes") and self.legend_.axes is self:
+                        self._mouseover_set.discard(self.legend_)
+                        self.legend_.axes = None
+                    if getattr(self.legend_, "figure", None) is self.figure:
+                        self.legend_.figure = None
+                    self.legend_.stale_callback = None
+                    self.legend_._remove_method = None
+                except Exception:
+                    pass
         self._children = []
         self._mouseover_set = _OrderedSet()
         self.child_axes = []
diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py
index 6c18ba1a64..92ab8887e8 100644
--- a/lib/matplotlib/figure.py
+++ b/lib/matplotlib/figure.py
@@ -949,6 +949,18 @@ default: %(va)s
             ax.clear()
             self.delaxes(ax)  # Remove ax from self._axstack.
 
+        # Detach and deparent any artists directly added to the Figure
+        # so their .figure attribute is unset, consistent with Artist.remove().
+        for _alist in (self.artists, self.lines, self.patches,
+                       self.texts, self.images, self.legends):
+            for _artist in list(_alist):
+                try:
+                    if getattr(_artist, "figure", None) is self:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
         self.artists = []
         self.lines = []
         self.patches = []


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 01:06:10,817 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find existing test cases related to a bug where `cla()` and `clf()` do not correctly deparent artists. The patch modifies methods in `_base.py` and `figure.py`, so the most relevant test files are `test_axes.py` and `test_figure.py`. I need the content of these files to find tests that check artist properties after clearing.' query='Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.' extra_requirements='If the files are too large, please provide tests that contain calls to `.cla()` or `.clear()` on axes objects, and `.clf()` or `.clear()` on figure objects.' purpose='I need to inspect these files to find three relevant test cases that cover the described bug.'
2025-12-21 01:06:10,818 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.
2025-12-21 01:06:10,818 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 01:06:10,818 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 01:06:10,819 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 01:06:10,819 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.
Extra requirements: If the files are too large, please provide tests that contain calls to `.cla()` or `.clear()` on axes objects, and `.clf()` or `.clear()` on figure objects.
Purpose: I need to inspect these files to find three relevant test cases that cover the described bug.
2025-12-21 01:06:14,678 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will begin by attempting to read the entire contents of `lib/matplotlib/tests/test_axes.py` to provide you with the full file. If the file is too large to be read at once, I will then search for tests within that file that contain calls to `.cla()` or `.clear()` on axes objects. I will then repeat this process for `lib/matplotlib/tests/test_figure.py`, looking for `.clf()` or `.clear()` calls on figure objects if the file is too large.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_axes.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2180, 'candidates_token_count': 133, 'total_token_count': 2544, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2180}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 133}], 'thoughts_token_count': 231, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15518703317283689, 'model_name': 'gemini-2.5-pro'} id='run--6ef29bcb-27ca-498a-929d-e02c8f3c2bed-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_axes.py'}, 'id': '60c36e5b-1a0a-4559-8e7d-d0b57e50cf09', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2180, 'output_tokens': 133, 'total_tokens': 2544, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 231}}
2025-12-21 01:06:19,897 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully read the first 500 lines of `lib/matplotlib/tests/test_axes.py`. Since the file is larger than 500 lines, I will now search for tests within this file that contain calls to `.cla()` or `.clear()` on axes objects as you requested. After that, I will proceed to read `lib/matplotlib/tests/test_figure.py` and apply the same logic.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_figure.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10262, 'candidates_token_count': 170, 'total_token_count': 10743, 'cached_content_token_count': 1852, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10262}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1852}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 170}], 'thoughts_token_count': 311}, 'finish_reason': 'STOP', 'avg_logprobs': -0.19022162942325369, 'model_name': 'gemini-2.5-pro'} id='run--5c8558ab-f0ff-4f70-a18b-b682d4330610-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': '.cla()', 'basename': 'test_axes.py'}, 'id': '02cdf02f-07a9-4be1-b858-d67bfe1658e0', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'basename': 'test_axes.py', 'text': '.clear()'}, 'id': 'cd987a13-5907-4a12-b093-c1dd31d4bbb4', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_figure.py'}, 'id': '7445723c-4ca4-4482-9151-92e100160122', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10262, 'output_tokens': 170, 'total_tokens': 10743, 'input_token_details': {'cache_read': 1852}, 'output_token_details': {'reasoning': 311}}
2025-12-21 01:06:23,275 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have gathered information from the codebase as you requested. I started by reading the beginning of `lib/matplotlib/tests/test_axes.py` and then specifically searched for tests that use `.cla()` or `.clear()` on axes objects, providing you with the relevant code snippets. I then did the same for `lib/matplotlib/tests/test_figure.py`, reading the beginning of the file and then proceeding to find tests that use `.clf()` or `.clear()`.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"basename": "test_figure.py", "text": ".clear()"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20802, 'candidates_token_count': 153, 'total_token_count': 21047, 'cached_content_token_count': 9528, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20802}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9528}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 153}], 'thoughts_token_count': 92}, 'finish_reason': 'STOP', 'avg_logprobs': -0.165618148504519, 'model_name': 'gemini-2.5-pro'} id='run--9010acdd-bb6f-4d78-991b-85b093a6745a-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': '.clf()', 'basename': 'test_figure.py'}, 'id': 'd4ffbc25-d850-455e-85bd-47a4c0d67992', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'basename': 'test_figure.py', 'text': '.clear()'}, 'id': 'b9f9a042-937d-4493-8a50-af085f0cfd18', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20802, 'output_tokens': 153, 'total_tokens': 21047, 'input_token_details': {'cache_read': 9528}, 'output_token_details': {'reasoning': 92}}
2025-12-21 01:06:27,304 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully gathered the information you requested. I began by reading the initial 500 lines of both `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`. Since both files were larger than that, I proceeded to search for the specific keywords you mentioned, providing you with the test functions that contain calls to `.cla()` or `.clear()` for axes objects and `.clf()` or `.clear()` for figure objects.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22033, 'candidates_token_count': 100, 'total_token_count': 22383, 'cached_content_token_count': 19065, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22033}], 'cache_tokens_details': [{'modality': 1, 'token_count': 19065}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 100}], 'thoughts_token_count': 250}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2090608024597168, 'model_name': 'gemini-2.5-pro'} id='run--b255f7d3-32a8-415c-b964-c6356eb205bb-0' usage_metadata={'input_tokens': 22033, 'output_tokens': 100, 'total_tokens': 22383, 'input_token_details': {'cache_read': 19065}, 'output_token_details': {'reasoning': 250}}
2025-12-21 01:06:27,306 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the files are too large, please provide tests that contain calls to `.cla()` or `.clear()` on axes objects, and `.clf()` or `.clear()` on figure objects.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to inspect these files to find three relevant test cases that cover the described bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_axes.py
Line number range: 1 - 500
Content:
1. import contextlib
2. from collections import namedtuple
3. import datetime
4. from decimal import Decimal
5. from functools import partial
6. import inspect
7. import io
8. from itertools import product
9. import platform
10. from types import SimpleNamespace
11. 
12. import dateutil.tz
13. 
14. import numpy as np
15. from numpy import ma
16. from cycler import cycler
17. import pytest
18. 
19. import matplotlib
20. import matplotlib as mpl
21. from matplotlib import rc_context
22. from matplotlib._api import MatplotlibDeprecationWarning
23. import matplotlib.colors as mcolors
24. import matplotlib.dates as mdates
25. from matplotlib.figure import Figure
26. from matplotlib.axes import Axes
27. import matplotlib.font_manager as mfont_manager
28. import matplotlib.markers as mmarkers
29. import matplotlib.patches as mpatches
30. import matplotlib.path as mpath
31. from matplotlib.projections.geo import HammerAxes
32. from matplotlib.projections.polar import PolarAxes
33. import matplotlib.pyplot as plt
34. import matplotlib.text as mtext
35. import matplotlib.ticker as mticker
36. import matplotlib.transforms as mtransforms
37. import mpl_toolkits.axisartist as AA
38. from numpy.testing import (
39.     assert_allclose, assert_array_equal, assert_array_almost_equal)
40. from matplotlib.testing.decorators import (
41.     image_comparison, check_figures_equal, remove_ticks_and_titles)
42. 
43. # Note: Some test cases are run twice: once normally and once with labeled data
44. #       These two must be defined in the same test function or need to have
45. #       different baseline images to prevent race conditions when pytest runs
46. #       the tests with multiple threads.
47. 
48. 
49. @check_figures_equal(extensions=["png"])
50. def test_invisible_axes(fig_test, fig_ref):
51.     ax = fig_test.subplots()
52.     ax.set_visible(False)
53. 
54. 
55. def test_get_labels():
56.     fig, ax = plt.subplots()
57.     ax.set_xlabel('x label')
58.     ax.set_ylabel('y label')
59.     assert ax.get_xlabel() == 'x label'
60.     assert ax.get_ylabel() == 'y label'
61. 
62. 
63. def test_repr():
64.     fig, ax = plt.subplots()
65.     ax.set_label('label')
66.     ax.set_title('title')
67.     ax.set_xlabel('x')
68.     ax.set_ylabel('y')
69.     assert repr(ax) == (
70.         "<Axes: "
71.         "label='label', title={'center': 'title'}, xlabel='x', ylabel='y'>")
72. 
73. 
74. @check_figures_equal()
75. def test_label_loc_vertical(fig_test, fig_ref):
76.     ax = fig_test.subplots()
77.     sc = ax.scatter([1, 2], [1, 2], c=[1, 2], label='scatter')
78.     ax.legend()
79.     ax.set_ylabel('Y Label', loc='top')
80.     ax.set_xlabel('X Label', loc='right')
81.     cbar = fig_test.colorbar(sc)
82.     cbar.set_label("Z Label", loc='top')
83. 
84.     ax = fig_ref.subplots()
85.     sc = ax.scatter([1, 2], [1, 2], c=[1, 2], label='scatter')
86.     ax.legend()
87.     ax.set_ylabel('Y Label', y=1, ha='right')
88.     ax.set_xlabel('X Label', x=1, ha='right')
89.     cbar = fig_ref.colorbar(sc)
90.     cbar.set_label("Z Label", y=1, ha='right')
91. 
92. 
93. @check_figures_equal()
94. def test_label_loc_horizontal(fig_test, fig_ref):
95.     ax = fig_test.subplots()
96.     sc = ax.scatter([1, 2], [1, 2], c=[1, 2], label='scatter')
97.     ax.legend()
98.     ax.set_ylabel('Y Label', loc='bottom')
99.     ax.set_xlabel('X Label', loc='left')
100.     cbar = fig_test.colorbar(sc, orientation='horizontal')
101.     cbar.set_label("Z Label", loc='left')
102. 
103.     ax = fig_ref.subplots()
104.     sc = ax.scatter([1, 2], [1, 2], c=[1, 2], label='scatter')
105.     ax.legend()
106.     ax.set_ylabel('Y Label', y=0, ha='left')
107.     ax.set_xlabel('X Label', x=0, ha='left')
108.     cbar = fig_ref.colorbar(sc, orientation='horizontal')
109.     cbar.set_label("Z Label", x=0, ha='left')
110. 
111. 
112. @check_figures_equal()
113. def test_label_loc_rc(fig_test, fig_ref):
114.     with matplotlib.rc_context({"xaxis.labellocation": "right",
115.                                 "yaxis.labellocation": "top"}):
116.         ax = fig_test.subplots()
117.         sc = ax.scatter([1, 2], [1, 2], c=[1, 2], label='scatter')
118.         ax.legend()
119.         ax.set_ylabel('Y Label')
120.         ax.set_xlabel('X Label')
121.         cbar = fig_test.colorbar(sc, orientation='horizontal')
122.         cbar.set_label("Z Label")
123. 
124.     ax = fig_ref.subplots()
125.     sc = ax.scatter([1, 2], [1, 2], c=[1, 2], label='scatter')
126.     ax.legend()
127.     ax.set_ylabel('Y Label', y=1, ha='right')
128.     ax.set_xlabel('X Label', x=1, ha='right')
129.     cbar = fig_ref.colorbar(sc, orientation='horizontal')
130.     cbar.set_label("Z Label", x=1, ha='right')
131. 
132. 
133. def test_label_shift():
134.     fig, ax = plt.subplots()
135. 
136.     # Test label re-centering on x-axis
137.     ax.set_xlabel("Test label", loc="left")
138.     ax.set_xlabel("Test label", loc="center")
139.     assert ax.xaxis.get_label().get_horizontalalignment() == "center"
140.     ax.set_xlabel("Test label", loc="right")
141.     assert ax.xaxis.get_label().get_horizontalalignment() == "right"
142.     ax.set_xlabel("Test label", loc="center")
143.     assert ax.xaxis.get_label().get_horizontalalignment() == "center"
144. 
145.     # Test label re-centering on y-axis
146.     ax.set_ylabel("Test label", loc="top")
147.     ax.set_ylabel("Test label", loc="center")
148.     assert ax.yaxis.get_label().get_horizontalalignment() == "center"
149.     ax.set_ylabel("Test label", loc="bottom")
150.     assert ax.yaxis.get_label().get_horizontalalignment() == "left"
151.     ax.set_ylabel("Test label", loc="center")
152.     assert ax.yaxis.get_label().get_horizontalalignment() == "center"
153. 
154. 
155. @check_figures_equal(extensions=["png"])
156. def test_acorr(fig_test, fig_ref):
157.     np.random.seed(19680801)
158.     Nx = 512
159.     x = np.random.normal(0, 1, Nx).cumsum()
160.     maxlags = Nx-1
161. 
162.     ax_test = fig_test.subplots()
163.     ax_test.acorr(x, maxlags=maxlags)
164. 
165.     ax_ref = fig_ref.subplots()
166.     # Normalized autocorrelation
167.     norm_auto_corr = np.correlate(x, x, mode="full")/np.dot(x, x)
168.     lags = np.arange(-maxlags, maxlags+1)
169.     norm_auto_corr = norm_auto_corr[Nx-1-maxlags:Nx+maxlags]
170.     ax_ref.vlines(lags, [0], norm_auto_corr)
171.     ax_ref.axhline(y=0, xmin=0, xmax=1)
172. 
173. 
174. @check_figures_equal(extensions=["png"])
175. def test_spy(fig_test, fig_ref):
176.     np.random.seed(19680801)
177.     a = np.ones(32 * 32)
178.     a[:16 * 32] = 0
179.     np.random.shuffle(a)
180.     a = a.reshape((32, 32))
181. 
182.     axs_test = fig_test.subplots(2)
183.     axs_test[0].spy(a)
184.     axs_test[1].spy(a, marker=".", origin="lower")
185. 
186.     axs_ref = fig_ref.subplots(2)
187.     axs_ref[0].imshow(a, cmap="gray_r", interpolation="nearest")
188.     axs_ref[0].xaxis.tick_top()
189.     axs_ref[1].plot(*np.nonzero(a)[::-1], ".", markersize=10)
190.     axs_ref[1].set(
191.         aspect=1, xlim=axs_ref[0].get_xlim(), ylim=axs_ref[0].get_ylim()[::-1])
192.     for ax in axs_ref:
193.         ax.xaxis.set_ticks_position("both")
194. 
195. 
196. def test_spy_invalid_kwargs():
197.     fig, ax = plt.subplots()
198.     for unsupported_kw in [{'interpolation': 'nearest'},
199.                            {'marker': 'o', 'linestyle': 'solid'}]:
200.         with pytest.raises(TypeError):
201.             ax.spy(np.eye(3, 3), **unsupported_kw)
202. 
203. 
204. @check_figures_equal(extensions=["png"])
205. def test_matshow(fig_test, fig_ref):
206.     mpl.style.use("mpl20")
207.     a = np.random.rand(32, 32)
208.     fig_test.add_subplot().matshow(a)
209.     ax_ref = fig_ref.add_subplot()
210.     ax_ref.imshow(a)
211.     ax_ref.xaxis.tick_top()
212.     ax_ref.xaxis.set_ticks_position('both')
213. 
214. 
215. @image_comparison(['formatter_ticker_001',
216.                    'formatter_ticker_002',
217.                    'formatter_ticker_003',
218.                    'formatter_ticker_004',
219.                    'formatter_ticker_005',
220.                    ])
221. def test_formatter_ticker():
222.     import matplotlib.testing.jpl_units as units
223.     units.register()
224. 
225.     # This should affect the tick size.  (Tests issue #543)
226.     matplotlib.rcParams['lines.markeredgewidth'] = 30
227. 
228.     # This essentially test to see if user specified labels get overwritten
229.     # by the auto labeler functionality of the axes.
230.     xdata = [x*units.sec for x in range(10)]
231.     ydata1 = [(1.5*y - 0.5)*units.km for y in range(10)]
232.     ydata2 = [(1.75*y - 1.0)*units.km for y in range(10)]
233. 
234.     ax = plt.figure().subplots()
235.     ax.set_xlabel("x-label 001")
236. 
237.     ax = plt.figure().subplots()
238.     ax.set_xlabel("x-label 001")
239.     ax.plot(xdata, ydata1, color='blue', xunits="sec")
240. 
241.     ax = plt.figure().subplots()
242.     ax.set_xlabel("x-label 001")
243.     ax.plot(xdata, ydata1, color='blue', xunits="sec")
244.     ax.set_xlabel("x-label 003")
245. 
246.     ax = plt.figure().subplots()
247.     ax.plot(xdata, ydata1, color='blue', xunits="sec")
248.     ax.plot(xdata, ydata2, color='green', xunits="hour")
249.     ax.set_xlabel("x-label 004")
250. 
251.     # See SF bug 2846058
252.     # https://sourceforge.net/tracker/?func=detail&aid=2846058&group_id=80706&atid=560720
253.     ax = plt.figure().subplots()
254.     ax.plot(xdata, ydata1, color='blue', xunits="sec")
255.     ax.plot(xdata, ydata2, color='green', xunits="hour")
256.     ax.set_xlabel("x-label 005")
257.     ax.autoscale_view()
258. 
259. 
260. def test_funcformatter_auto_formatter():
261.     def _formfunc(x, pos):
262.         return ''
263. 
264.     ax = plt.figure().subplots()
265. 
266.     assert ax.xaxis.isDefault_majfmt
267.     assert ax.xaxis.isDefault_minfmt
268.     assert ax.yaxis.isDefault_majfmt
269.     assert ax.yaxis.isDefault_minfmt
270. 
271.     ax.xaxis.set_major_formatter(_formfunc)
272. 
273.     assert not ax.xaxis.isDefault_majfmt
274.     assert ax.xaxis.isDefault_minfmt
275.     assert ax.yaxis.isDefault_majfmt
276.     assert ax.yaxis.isDefault_minfmt
277. 
278.     targ_funcformatter = mticker.FuncFormatter(_formfunc)
279. 
280.     assert isinstance(ax.xaxis.get_major_formatter(),
281.                       mticker.FuncFormatter)
282. 
283.     assert ax.xaxis.get_major_formatter().func == targ_funcformatter.func
284. 
285. 
286. def test_strmethodformatter_auto_formatter():
287.     formstr = '{x}_{pos}'
288. 
289.     ax = plt.figure().subplots()
290. 
291.     assert ax.xaxis.isDefault_majfmt
292.     assert ax.xaxis.isDefault_minfmt
293.     assert ax.yaxis.isDefault_majfmt
294.     assert ax.yaxis.isDefault_minfmt
295. 
296.     ax.yaxis.set_minor_formatter(formstr)
297. 
298.     assert ax.xaxis.isDefault_majfmt
299.     assert ax.xaxis.isDefault_minfmt
300.     assert ax.yaxis.isDefault_majfmt
301.     assert not ax.yaxis.isDefault_minfmt
302. 
303.     targ_strformatter = mticker.StrMethodFormatter(formstr)
304. 
305.     assert isinstance(ax.yaxis.get_minor_formatter(),
306.                       mticker.StrMethodFormatter)
307. 
308.     assert ax.yaxis.get_minor_formatter().fmt == targ_strformatter.fmt
309. 
310. 
311. @image_comparison(["twin_axis_locators_formatters"])
312. def test_twin_axis_locators_formatters():
313.     vals = np.linspace(0, 1, num=5, endpoint=True)
314.     locs = np.sin(np.pi * vals / 2.0)
315. 
316.     majl = plt.FixedLocator(locs)
317.     minl = plt.FixedLocator([0.1, 0.2, 0.3])
318. 
319.     fig = plt.figure()
320.     ax1 = fig.add_subplot(1, 1, 1)
321.     ax1.plot([0.1, 100], [0, 1])
322.     ax1.yaxis.set_major_locator(majl)
323.     ax1.yaxis.set_minor_locator(minl)
324.     ax1.yaxis.set_major_formatter(plt.FormatStrFormatter('%08.2lf'))
325.     ax1.yaxis.set_minor_formatter(plt.FixedFormatter(['tricks', 'mind',
326.                                                       'jedi']))
327. 
328.     ax1.xaxis.set_major_locator(plt.LinearLocator())
329.     ax1.xaxis.set_minor_locator(plt.FixedLocator([15, 35, 55, 75]))
330.     ax1.xaxis.set_major_formatter(plt.FormatStrFormatter('%05.2lf'))
331.     ax1.xaxis.set_minor_formatter(plt.FixedFormatter(['c', '3', 'p', 'o']))
332.     ax1.twiny()
333.     ax1.twinx()
334. 
335. 
336. def test_twinx_cla():
337.     fig, ax = plt.subplots()
338.     ax2 = ax.twinx()
339.     ax3 = ax2.twiny()
340.     plt.draw()
341.     assert not ax2.xaxis.get_visible()
342.     assert not ax2.patch.get_visible()
343.     ax2.cla()
344.     ax3.cla()
345. 
346.     assert not ax2.xaxis.get_visible()
347.     assert not ax2.patch.get_visible()
348.     assert ax2.yaxis.get_visible()
349. 
350.     assert ax3.xaxis.get_visible()
351.     assert not ax3.patch.get_visible()
352.     assert not ax3.yaxis.get_visible()
353. 
354.     assert ax.xaxis.get_visible()
355.     assert ax.patch.get_visible()
356.     assert ax.yaxis.get_visible()
357. 
358. 
359. @pytest.mark.parametrize('twin', ('x', 'y'))
360. @check_figures_equal(extensions=['png'], tol=0.19)
361. def test_twin_logscale(fig_test, fig_ref, twin):
362.     twin_func = f'twin{twin}'  # test twinx or twiny
363.     set_scale = f'set_{twin}scale'
364.     x = np.arange(1, 100)
365. 
366.     # Change scale after twinning.
367.     ax_test = fig_test.add_subplot(2, 1, 1)
368.     ax_twin = getattr(ax_test, twin_func)()
369.     getattr(ax_test, set_scale)('log')
370.     ax_twin.plot(x, x)
371. 
372.     # Twin after changing scale.
373.     ax_test = fig_test.add_subplot(2, 1, 2)
374.     getattr(ax_test, set_scale)('log')
375.     ax_twin = getattr(ax_test, twin_func)()
376.     ax_twin.plot(x, x)
377. 
378.     for i in [1, 2]:
379.         ax_ref = fig_ref.add_subplot(2, 1, i)
380.         getattr(ax_ref, set_scale)('log')
381.         ax_ref.plot(x, x)
382. 
383.         # This is a hack because twinned Axes double-draw the frame.
384.         # Remove this when that is fixed.
385.         Path = matplotlib.path.Path
386.         fig_ref.add_artist(
387.             matplotlib.patches.PathPatch(
388.                 Path([[0, 0], [0, 1],
389.                       [0, 1], [1, 1],
390.                       [1, 1], [1, 0],
391.                       [1, 0], [0, 0]],
392.                      [Path.MOVETO, Path.LINETO] * 4),
393.                 transform=ax_ref.transAxes,
394.                 facecolor='none',
395.                 edgecolor=mpl.rcParams['axes.edgecolor'],
396.                 linewidth=mpl.rcParams['axes.linewidth'],
397.                 capstyle='projecting'))
398. 
399.     remove_ticks_and_titles(fig_test)
400.     remove_ticks_and_titles(fig_ref)
401. 
402. 
403. @image_comparison(['twin_autoscale.png'])
404. def test_twinx_axis_scales():
405.     x = np.array([0, 0.5, 1])
406.     y = 0.5 * x
407.     x2 = np.array([0, 1, 2])
408.     y2 = 2 * x2
409. 
410.     fig = plt.figure()
411.     ax = fig.add_axes((0, 0, 1, 1), autoscalex_on=False, autoscaley_on=False)
412.     ax.plot(x, y, color='blue', lw=10)
413. 
414.     ax2 = plt.twinx(ax)
415.     ax2.plot(x2, y2, 'r--', lw=5)
416. 
417.     ax.margins(0, 0)
418.     ax2.margins(0, 0)
419. 
420. 
421. def test_twin_inherit_autoscale_setting():
422.     fig, ax = plt.subplots()
423.     ax_x_on = ax.twinx()
424.     ax.set_autoscalex_on(False)
425.     ax_x_off = ax.twinx()
426. 
427.     assert ax_x_on.get_autoscalex_on()
428.     assert not ax_x_off.get_autoscalex_on()
429. 
430.     ax_y_on = ax.twiny()
431.     ax.set_autoscaley_on(False)
432.     ax_y_off = ax.twiny()
433. 
434.     assert ax_y_on.get_autoscaley_on()
435.     assert not ax_y_off.get_autoscaley_on()
436. 
437. 
438. def test_inverted_cla():
439.     # GitHub PR #5450. Setting autoscale should reset
440.     # axes to be non-inverted.
441.     # plotting an image, then 1d graph, axis is now down
442.     fig = plt.figure(0)
443.     ax = fig.gca()
444.     # 1. test that a new axis is not inverted per default
445.     assert not ax.xaxis_inverted()
446.     assert not ax.yaxis_inverted()
447.     img = np.random.random((100, 100))
448.     ax.imshow(img)
449.     # 2. test that a image axis is inverted
450.     assert not ax.xaxis_inverted()
451.     assert ax.yaxis_inverted()
452.     # 3. test that clearing and plotting a line, axes are
453.     # not inverted
454.     ax.cla()
455.     x = np.linspace(0, 2*np.pi, 100)
456.     ax.plot(x, np.cos(x))
457.     assert not ax.xaxis_inverted()
458.     assert not ax.yaxis_inverted()
459. 
460.     # 4. autoscaling should not bring back axes to normal
461.     ax.cla()
462.     ax.imshow(img)
463.     plt.autoscale()
464.     assert not ax.xaxis_inverted()
465.     assert ax.yaxis_inverted()
466. 
467.     for ax in fig.axes:
468.         ax.remove()
469.     # 5. two shared axes. Inverting the leader axis should invert the shared
470.     # axes; clearing the leader axis should bring axes in shared
471.     # axes back to normal.
472.     ax0 = plt.subplot(211)
473.     ax1 = plt.subplot(212, sharey=ax0)
474.     ax0.yaxis.set_inverted(True)
475.     assert ax1.yaxis_inverted()
476.     ax1.plot(x, np.cos(x))
477.     ax0.cla()
478.     assert not ax1.yaxis_inverted()
479.     ax1.cla()
480.     # 6. clearing the follower should not touch limits
481.     ax0.imshow(img)
482.     ax1.plot(x, np.cos(x))
483.     ax1.cla()
484.     assert ax.yaxis_inverted()
485. 
486.     # clean up
487.     plt.close(fig)
488. 
489. 
490. def test_subclass_clear_cla():
491.     # Ensure that subclasses of Axes call cla/clear correctly.
492.     # Note, we cannot use mocking here as we want to be sure that the
493.     # superclass fallback does not recurse.
494. 
495.     with pytest.warns(PendingDeprecationWarning,
496.                       match='Overriding `Axes.cla`'):
497.         class ClaAxes(Axes):
498.             def cla(self):
499.                 nonlocal called
500.                 called = True


File: lib/matplotlib/tests/test_axes.py
Line number range: 490 - 538
Content:
def test_subclass_clear_cla():
    # Ensure that subclasses of Axes call cla/clear correctly.
    # Note, we cannot use mocking here as we want to be sure that the
    # superclass fallback does not recurse.

    with pytest.warns(PendingDeprecationWarning,
                      match='Overriding `Axes.cla`'):
        class ClaAxes(Axes):
            def cla(self):
                nonlocal called
                called = True

    with pytest.warns(PendingDeprecationWarning,
                      match='Overriding `Axes.cla`'):
        class ClaSuperAxes(Axes):
            def cla(self):
                nonlocal called
                called = True
                super().cla()

    class SubClaAxes(ClaAxes):
        pass

    class ClearAxes(Axes):
        def clear(self):
            nonlocal called
            called = True

    class ClearSuperAxes(Axes):
        def clear(self):
            nonlocal called
            called = True
            super().clear()

    class SubClearAxes(ClearAxes):
        pass

    fig = Figure()
    for axes_class in [ClaAxes, ClaSuperAxes, SubClaAxes,
                       ClearAxes, ClearSuperAxes, SubClearAxes]:
        called = False
        ax = axes_class(fig, [0, 0, 1, 1])
        # Axes.__init__ has already called clear (which aliases to cla or is in
        # the subclass).
        assert called

        called = False
        ax.cla()
        assert called


File: lib/matplotlib/tests/test_axes.py
Line number range: 5344 - 5354
Content:
def test_reset_grid():
    fig, ax = plt.subplots()
    ax.tick_params(reset=True, which='major', labelsize=10)
    assert not ax.xaxis.majorTicks[0].gridline.get_visible()
    ax.grid(color='red')  # enables grid
    assert ax.xaxis.majorTicks[0].gridline.get_visible()

    with plt.rc_context({'axes.grid': True}):
        ax.clear()
        ax.tick_params(reset=True, which='major', labelsize=10)
        assert ax.xaxis.majorTicks[0].gridline.get_visible()


File: lib/matplotlib/tests/test_axes.py
Line number range: 7782 - 7794
Content:
@check_figures_equal(extensions=['png'])
def test_shared_axes_clear(fig_test, fig_ref):
    x = np.arange(0.0, 2*np.pi, 0.01)
    y = np.sin(x)

    axs = fig_ref.subplots(2, 2, sharex=True, sharey=True)
    for ax in axs.flat:
        ax.plot(x, y)

    axs = fig_test.subplots(2, 2, sharex=True, sharey=True)
    for ax in axs.flat:
        ax.clear()
        ax.plot(x, y)


File: lib/matplotlib/tests/test_figure.py
Line number range: 1 - 500
Content:
1. import copy
2. from datetime import datetime
3. import io
4. from pathlib import Path
5. import pickle
6. import platform
7. from threading import Timer
8. from types import SimpleNamespace
9. import warnings
10. 
11. import numpy as np
12. import pytest
13. from PIL import Image
14. 
15. import matplotlib as mpl
16. from matplotlib import gridspec
17. from matplotlib.testing.decorators import image_comparison, check_figures_equal
18. from matplotlib.axes import Axes
19. from matplotlib.figure import Figure, FigureBase
20. from matplotlib.layout_engine import (ConstrainedLayoutEngine,
21.                                       TightLayoutEngine,
22.                                       PlaceHolderLayoutEngine)
23. from matplotlib.ticker import AutoMinorLocator, FixedFormatter, ScalarFormatter
24. import matplotlib.pyplot as plt
25. import matplotlib.dates as mdates
26. 
27. 
28. @image_comparison(['figure_align_labels'], extensions=['png', 'svg'],
29.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
30. def test_align_labels():
31.     fig = plt.figure(layout='tight')
32.     gs = gridspec.GridSpec(3, 3)
33. 
34.     ax = fig.add_subplot(gs[0, :2])
35.     ax.plot(np.arange(0, 1e6, 1000))
36.     ax.set_ylabel('Ylabel0 0')
37.     ax = fig.add_subplot(gs[0, -1])
38.     ax.plot(np.arange(0, 1e4, 100))
39. 
40.     for i in range(3):
41.         ax = fig.add_subplot(gs[1, i])
42.         ax.set_ylabel('YLabel1 %d' % i)
43.         ax.set_xlabel('XLabel1 %d' % i)
44.         if i in [0, 2]:
45.             ax.xaxis.set_label_position("top")
46.             ax.xaxis.tick_top()
47.         if i == 0:
48.             for tick in ax.get_xticklabels():
49.                 tick.set_rotation(90)
50.         if i == 2:
51.             ax.yaxis.set_label_position("right")
52.             ax.yaxis.tick_right()
53. 
54.     for i in range(3):
55.         ax = fig.add_subplot(gs[2, i])
56.         ax.set_xlabel(f'XLabel2 {i}')
57.         ax.set_ylabel(f'YLabel2 {i}')
58. 
59.         if i == 2:
60.             ax.plot(np.arange(0, 1e4, 10))
61.             ax.yaxis.set_label_position("right")
62.             ax.yaxis.tick_right()
63.             for tick in ax.get_xticklabels():
64.                 tick.set_rotation(90)
65. 
66.     fig.align_labels()
67. 
68. 
69. def test_align_labels_stray_axes():
70.     fig, axs = plt.subplots(2, 2)
71.     for nn, ax in enumerate(axs.flat):
72.         ax.set_xlabel('Boo')
73.         ax.set_xlabel('Who')
74.         ax.plot(np.arange(4)**nn, np.arange(4)**nn)
75.     fig.align_ylabels()
76.     fig.align_xlabels()
77.     fig.draw_without_rendering()
78.     xn = np.zeros(4)
79.     yn = np.zeros(4)
80.     for nn, ax in enumerate(axs.flat):
81.         yn[nn] = ax.xaxis.label.get_position()[1]
82.         xn[nn] = ax.yaxis.label.get_position()[0]
83.     np.testing.assert_allclose(xn[:2], xn[2:])
84.     np.testing.assert_allclose(yn[::2], yn[1::2])
85. 
86.     fig, axs = plt.subplots(2, 2, constrained_layout=True)
87.     for nn, ax in enumerate(axs.flat):
88.         ax.set_xlabel('Boo')
89.         ax.set_xlabel('Who')
90.         pc = ax.pcolormesh(np.random.randn(10, 10))
91.     fig.colorbar(pc, ax=ax)
92.     fig.align_ylabels()
93.     fig.align_xlabels()
94.     fig.draw_without_rendering()
95.     xn = np.zeros(4)
96.     yn = np.zeros(4)
97.     for nn, ax in enumerate(axs.flat):
98.         yn[nn] = ax.xaxis.label.get_position()[1]
99.         xn[nn] = ax.yaxis.label.get_position()[0]
100.     np.testing.assert_allclose(xn[:2], xn[2:])
101.     np.testing.assert_allclose(yn[::2], yn[1::2])
102. 
103. 
104. def test_figure_label():
105.     # pyplot figure creation, selection, and closing with label/number/instance
106.     plt.close('all')
107.     fig_today = plt.figure('today')
108.     plt.figure(3)
109.     plt.figure('tomorrow')
110.     plt.figure()
111.     plt.figure(0)
112.     plt.figure(1)
113.     plt.figure(3)
114.     assert plt.get_fignums() == [0, 1, 3, 4, 5]
115.     assert plt.get_figlabels() == ['', 'today', '', 'tomorrow', '']
116.     plt.close(10)
117.     plt.close()
118.     plt.close(5)
119.     plt.close('tomorrow')
120.     assert plt.get_fignums() == [0, 1]
121.     assert plt.get_figlabels() == ['', 'today']
122.     plt.figure(fig_today)
123.     assert plt.gcf() == fig_today
124.     with pytest.raises(ValueError):
125.         plt.figure(Figure())
126. 
127. 
128. def test_fignum_exists():
129.     # pyplot figure creation, selection and closing with fignum_exists
130.     plt.figure('one')
131.     plt.figure(2)
132.     plt.figure('three')
133.     plt.figure()
134.     assert plt.fignum_exists('one')
135.     assert plt.fignum_exists(2)
136.     assert plt.fignum_exists('three')
137.     assert plt.fignum_exists(4)
138.     plt.close('one')
139.     plt.close(4)
140.     assert not plt.fignum_exists('one')
141.     assert not plt.fignum_exists(4)
142. 
143. 
144. def test_clf_keyword():
145.     # test if existing figure is cleared with figure() and subplots()
146.     text1 = 'A fancy plot'
147.     text2 = 'Really fancy!'
148. 
149.     fig0 = plt.figure(num=1)
150.     fig0.suptitle(text1)
151.     assert [t.get_text() for t in fig0.texts] == [text1]
152. 
153.     fig1 = plt.figure(num=1, clear=False)
154.     fig1.text(0.5, 0.5, text2)
155.     assert fig0 is fig1
156.     assert [t.get_text() for t in fig1.texts] == [text1, text2]
157. 
158.     fig2, ax2 = plt.subplots(2, 1, num=1, clear=True)
159.     assert fig0 is fig2
160.     assert [t.get_text() for t in fig2.texts] == []
161. 
162. 
163. @image_comparison(['figure_today'])
164. def test_figure():
165.     # named figure support
166.     fig = plt.figure('today')
167.     ax = fig.add_subplot()
168.     ax.set_title(fig.get_label())
169.     ax.plot(np.arange(5))
170.     # plot red line in a different figure.
171.     plt.figure('tomorrow')
172.     plt.plot([0, 1], [1, 0], 'r')
173.     # Return to the original; make sure the red line is not there.
174.     plt.figure('today')
175.     plt.close('tomorrow')
176. 
177. 
178. @image_comparison(['figure_legend'])
179. def test_figure_legend():
180.     fig, axs = plt.subplots(2)
181.     axs[0].plot([0, 1], [1, 0], label='x', color='g')
182.     axs[0].plot([0, 1], [0, 1], label='y', color='r')
183.     axs[0].plot([0, 1], [0.5, 0.5], label='y', color='k')
184. 
185.     axs[1].plot([0, 1], [1, 0], label='_y', color='r')
186.     axs[1].plot([0, 1], [0, 1], label='z', color='b')
187.     fig.legend()
188. 
189. 
190. def test_gca():
191.     fig = plt.figure()
192. 
193.     # test that gca() picks up Axes created via add_axes()
194.     ax0 = fig.add_axes([0, 0, 1, 1])
195.     assert fig.gca() is ax0
196. 
197.     # test that gca() picks up Axes created via add_subplot()
198.     ax1 = fig.add_subplot(111)
199.     assert fig.gca() is ax1
200. 
201.     # add_axes on an existing Axes should not change stored order, but will
202.     # make it current.
203.     fig.add_axes(ax0)
204.     assert fig.axes == [ax0, ax1]
205.     assert fig.gca() is ax0
206. 
207.     # sca() should not change stored order of Axes, which is order added.
208.     fig.sca(ax0)
209.     assert fig.axes == [ax0, ax1]
210. 
211.     # add_subplot on an existing Axes should not change stored order, but will
212.     # make it current.
213.     fig.add_subplot(ax1)
214.     assert fig.axes == [ax0, ax1]
215.     assert fig.gca() is ax1
216. 
217. 
218. def test_add_subplot_subclass():
219.     fig = plt.figure()
220.     fig.add_subplot(axes_class=Axes)
221.     with pytest.raises(ValueError):
222.         fig.add_subplot(axes_class=Axes, projection="3d")
223.     with pytest.raises(ValueError):
224.         fig.add_subplot(axes_class=Axes, polar=True)
225.     with pytest.raises(ValueError):
226.         fig.add_subplot(projection="3d", polar=True)
227.     with pytest.raises(TypeError):
228.         fig.add_subplot(projection=42)
229. 
230. 
231. def test_add_subplot_invalid():
232.     fig = plt.figure()
233.     with pytest.raises(ValueError,
234.                        match='Number of columns must be a positive integer'):
235.         fig.add_subplot(2, 0, 1)
236.     with pytest.raises(ValueError,
237.                        match='Number of rows must be a positive integer'):
238.         fig.add_subplot(0, 2, 1)
239.     with pytest.raises(ValueError, match='num must be 1 <= num <= 4'):
240.         fig.add_subplot(2, 2, 0)
241.     with pytest.raises(ValueError, match='num must be 1 <= num <= 4'):
242.         fig.add_subplot(2, 2, 5)
243. 
244.     with pytest.raises(ValueError, match='must be a three-digit integer'):
245.         fig.add_subplot(42)
246.     with pytest.raises(ValueError, match='must be a three-digit integer'):
247.         fig.add_subplot(1000)
248. 
249.     with pytest.raises(TypeError, match='takes 1 or 3 positional arguments '
250.                                         'but 2 were given'):
251.         fig.add_subplot(2, 2)
252.     with pytest.raises(TypeError, match='takes 1 or 3 positional arguments '
253.                                         'but 4 were given'):
254.         fig.add_subplot(1, 2, 3, 4)
255.     with pytest.raises(ValueError,
256.                        match="Number of rows must be a positive integer, "
257.                              "not '2'"):
258.         fig.add_subplot('2', 2, 1)
259.     with pytest.raises(ValueError,
260.                        match='Number of columns must be a positive integer, '
261.                              'not 2.0'):
262.         fig.add_subplot(2, 2.0, 1)
263.     _, ax = plt.subplots()
264.     with pytest.raises(ValueError,
265.                        match='The Axes must have been created in the '
266.                              'present figure'):
267.         fig.add_subplot(ax)
268. 
269. 
270. @image_comparison(['figure_suptitle'])
271. def test_suptitle():
272.     fig, _ = plt.subplots()
273.     fig.suptitle('hello', color='r')
274.     fig.suptitle('title', color='g', rotation=30)
275. 
276. 
277. def test_suptitle_fontproperties():
278.     fig, ax = plt.subplots()
279.     fps = mpl.font_manager.FontProperties(size='large', weight='bold')
280.     txt = fig.suptitle('fontprops title', fontproperties=fps)
281.     assert txt.get_fontsize() == fps.get_size_in_points()
282.     assert txt.get_weight() == fps.get_weight()
283. 
284. 
285. @image_comparison(['alpha_background'],
286.                   # only test png and svg. The PDF output appears correct,
287.                   # but Ghostscript does not preserve the background color.
288.                   extensions=['png', 'svg'],
289.                   savefig_kwarg={'facecolor': (0, 1, 0.4),
290.                                  'edgecolor': 'none'})
291. def test_alpha():
292.     # We want an image which has a background color and an alpha of 0.4.
293.     fig = plt.figure(figsize=[2, 1])
294.     fig.set_facecolor((0, 1, 0.4))
295.     fig.patch.set_alpha(0.4)
296.     fig.patches.append(mpl.patches.CirclePolygon(
297.         [20, 20], radius=15, alpha=0.6, facecolor='red'))
298. 
299. 
300. def test_too_many_figures():
301.     with pytest.warns(RuntimeWarning):
302.         for i in range(mpl.rcParams['figure.max_open_warning'] + 1):
303.             plt.figure()
304. 
305. 
306. def test_iterability_axes_argument():
307. 
308.     # This is a regression test for matplotlib/matplotlib#3196. If one of the
309.     # arguments returned by _as_mpl_axes defines __getitem__ but is not
310.     # iterable, this would raise an exception. This is because we check
311.     # whether the arguments are iterable, and if so we try and convert them
312.     # to a tuple. However, the ``iterable`` function returns True if
313.     # __getitem__ is present, but some classes can define __getitem__ without
314.     # being iterable. The tuple conversion is now done in a try...except in
315.     # case it fails.
316. 
317.     class MyAxes(Axes):
318.         def __init__(self, *args, myclass=None, **kwargs):
319.             Axes.__init__(self, *args, **kwargs)
320. 
321.     class MyClass:
322. 
323.         def __getitem__(self, item):
324.             if item != 'a':
325.                 raise ValueError("item should be a")
326. 
327.         def _as_mpl_axes(self):
328.             return MyAxes, {'myclass': self}
329. 
330.     fig = plt.figure()
331.     fig.add_subplot(1, 1, 1, projection=MyClass())
332.     plt.close(fig)
333. 
334. 
335. def test_set_fig_size():
336.     fig = plt.figure()
337. 
338.     # check figwidth
339.     fig.set_figwidth(5)
340.     assert fig.get_figwidth() == 5
341. 
342.     # check figheight
343.     fig.set_figheight(1)
344.     assert fig.get_figheight() == 1
345. 
346.     # check using set_size_inches
347.     fig.set_size_inches(2, 4)
348.     assert fig.get_figwidth() == 2
349.     assert fig.get_figheight() == 4
350. 
351.     # check using tuple to first argument
352.     fig.set_size_inches((1, 3))
353.     assert fig.get_figwidth() == 1
354.     assert fig.get_figheight() == 3
355. 
356. 
357. def test_axes_remove():
358.     fig, axs = plt.subplots(2, 2)
359.     axs[-1, -1].remove()
360.     for ax in axs.ravel()[:-1]:
361.         assert ax in fig.axes
362.     assert axs[-1, -1] not in fig.axes
363.     assert len(fig.axes) == 3
364. 
365. 
366. def test_figaspect():
367.     w, h = plt.figaspect(np.float64(2) / np.float64(1))
368.     assert h / w == 2
369.     w, h = plt.figaspect(2)
370.     assert h / w == 2
371.     w, h = plt.figaspect(np.zeros((1, 2)))
372.     assert h / w == 0.5
373.     w, h = plt.figaspect(np.zeros((2, 2)))
374.     assert h / w == 1
375. 
376. 
377. @pytest.mark.parametrize('which', ['both', 'major', 'minor'])
378. def test_autofmt_xdate(which):
379.     date = ['3 Jan 2013', '4 Jan 2013', '5 Jan 2013', '6 Jan 2013',
380.             '7 Jan 2013', '8 Jan 2013', '9 Jan 2013', '10 Jan 2013',
381.             '11 Jan 2013', '12 Jan 2013', '13 Jan 2013', '14 Jan 2013']
382. 
383.     time = ['16:44:00', '16:45:00', '16:46:00', '16:47:00', '16:48:00',
384.             '16:49:00', '16:51:00', '16:52:00', '16:53:00', '16:55:00',
385.             '16:56:00', '16:57:00']
386. 
387.     angle = 60
388.     minors = [1, 2, 3, 4, 5, 6, 7]
389. 
390.     x = mdates.datestr2num(date)
391.     y = mdates.datestr2num(time)
392. 
393.     fig, ax = plt.subplots()
394. 
395.     ax.plot(x, y)
396.     ax.yaxis_date()
397.     ax.xaxis_date()
398. 
399.     ax.xaxis.set_minor_locator(AutoMinorLocator(2))
400.     with warnings.catch_warnings():
401.         warnings.filterwarnings(
402.             'ignore',
403.             'FixedFormatter should only be used together with FixedLocator')
404.         ax.xaxis.set_minor_formatter(FixedFormatter(minors))
405. 
406.     fig.autofmt_xdate(0.2, angle, 'right', which)
407. 
408.     if which in ('both', 'major'):
409.         for label in fig.axes[0].get_xticklabels(False, 'major'):
410.             assert int(label.get_rotation()) == angle
411. 
412.     if which in ('both', 'minor'):
413.         for label in fig.axes[0].get_xticklabels(True, 'minor'):
414.             assert int(label.get_rotation()) == angle
415. 
416. 
417. @mpl.style.context('default')
418. def test_change_dpi():
419.     fig = plt.figure(figsize=(4, 4))
420.     fig.draw_without_rendering()
421.     assert fig.canvas.renderer.height == 400
422.     assert fig.canvas.renderer.width == 400
423.     fig.dpi = 50
424.     fig.draw_without_rendering()
425.     assert fig.canvas.renderer.height == 200
426.     assert fig.canvas.renderer.width == 200
427. 
428. 
429. @pytest.mark.parametrize('width, height', [
430.     (1, np.nan),
431.     (-1, 1),
432.     (np.inf, 1)
433. ])
434. def test_invalid_figure_size(width, height):
435.     with pytest.raises(ValueError):
436.         plt.figure(figsize=(width, height))
437. 
438.     fig = plt.figure()
439.     with pytest.raises(ValueError):
440.         fig.set_size_inches(width, height)
441. 
442. 
443. def test_invalid_figure_add_axes():
444.     fig = plt.figure()
445.     with pytest.raises(TypeError,
446.                        match="missing 1 required positional argument: 'rect'"):
447.         fig.add_axes()
448. 
449.     with pytest.raises(ValueError):
450.         fig.add_axes((.1, .1, .5, np.nan))
451. 
452.     with pytest.raises(TypeError, match="multiple values for argument 'rect'"):
453.         fig.add_axes([0, 0, 1, 1], rect=[0, 0, 1, 1])
454. 
455.     _, ax = plt.subplots()
456.     with pytest.raises(ValueError,
457.                        match="The Axes must have been created in the present "
458.                              "figure"):
459.         fig.add_axes(ax)
460. 
461. 
462. def test_subplots_shareax_loglabels():
463.     fig, axs = plt.subplots(2, 2, sharex=True, sharey=True, squeeze=False)
464.     for ax in axs.flat:
465.         ax.plot([10, 20, 30], [10, 20, 30])
466. 
467.     ax.set_yscale("log")
468.     ax.set_xscale("log")
469. 
470.     for ax in axs[0, :]:
471.         assert 0 == len(ax.xaxis.get_ticklabels(which='both'))
472. 
473.     for ax in axs[1, :]:
474.         assert 0 < len(ax.xaxis.get_ticklabels(which='both'))
475. 
476.     for ax in axs[:, 1]:
477.         assert 0 == len(ax.yaxis.get_ticklabels(which='both'))
478. 
479.     for ax in axs[:, 0]:
480.         assert 0 < len(ax.yaxis.get_ticklabels(which='both'))
481. 
482. 
483. def test_savefig():
484.     fig = plt.figure()
485.     msg = r"savefig\(\) takes 2 positional arguments but 3 were given"
486.     with pytest.raises(TypeError, match=msg):
487.         fig.savefig("fname1.png", "fname2.png")
488. 
489. 
490. def test_savefig_warns():
491.     fig = plt.figure()
492.     for format in ['png', 'pdf', 'svg', 'tif', 'jpg']:
493.         with pytest.raises(TypeError):
494.             fig.savefig(io.BytesIO(), format=format, non_existent_kwarg=True)
495. 
496. 
497. def test_savefig_backend():
498.     fig = plt.figure()
499.     # Intentionally use an invalid module name.
500.     with pytest.raises(ModuleNotFoundError, match="No module named '@absent'"):


File: lib/matplotlib/tests/test_figure.py
Line number range: 690 - 769
Content:
@pytest.mark.parametrize('clear_meth', ['clear', 'clf'])
def test_figure_clear(clear_meth):
    # we test the following figure clearing scenarios:
    fig = plt.figure()

    # a) an empty figure
    fig.clear()
    assert fig.axes == []

    # b) a figure with a single unnested axes
    ax = fig.add_subplot(111)
    getattr(fig, clear_meth)()
    assert fig.axes == []

    # c) a figure multiple unnested axes
    axes = [fig.add_subplot(2, 1, i+1) for i in range(2)]
    getattr(fig, clear_meth)()
    assert fig.axes == []

    # d) a figure with a subfigure
    gs = fig.add_gridspec(ncols=2, nrows=1)
    subfig = fig.add_subfigure(gs[0])
    subaxes = subfig.add_subplot(111)
    getattr(fig, clear_meth)()
    assert subfig not in fig.subfigs
    assert fig.axes == []

    # e) a figure with a subfigure and a subplot
    subfig = fig.add_subfigure(gs[0])
    subaxes = subfig.add_subplot(111)
    mainaxes = fig.add_subplot(gs[1])

    # e.1) removing just the axes leaves the subplot
    mainaxes.remove()
    assert fig.axes == [subaxes]

    # e.2) removing just the subaxes leaves the subplot
    # and subfigure
    mainaxes = fig.add_subplot(gs[1])
    subaxes.remove()
    assert fig.axes == [mainaxes]
    assert subfig in fig.subfigs

    # e.3) clearing the subfigure leaves the subplot
    subaxes = subfig.add_subplot(111)
    assert mainaxes in fig.axes
    assert subaxes in fig.axes
    getattr(subfig, clear_meth)()
    assert subfig in fig.subfigs
    assert subaxes not in subfig.axes
    assert subaxes not in fig.axes
    assert mainaxes in fig.axes

    # e.4) clearing the whole thing
    subaxes = subfig.add_subplot(111)
    getattr(fig, clear_meth)()
    assert fig.axes == []
    assert fig.subfigs == []

    # f) multiple subfigures
    subfigs = [fig.add_subfigure(gs[i]) for i in [0, 1]]
    subaxes = [sfig.add_subplot(111) for sfig in subfigs]
    assert all(ax in fig.axes for ax in subaxes)
    assert all(sfig in fig.subfigs for sfig in subfigs)

    # f.1) clearing only one subfigure
    getattr(subfigs[0], clear_meth)()
    assert subaxes[0] not in fig.axes
    assert subaxes[1] in fig.axes
    assert subfigs[1] in fig.subfigs

    # f.2) clearing the whole thing
    getattr(subfigs[1], clear_meth)()
    subfigs = [fig.add_subfigure(gs[i]) for i in [0, 1]]
    subaxes = [sfig.add_subplot(111) for sfig in subfigs]
    assert all(ax in fig.axes for ax in subaxes)
    assert all(sfig in fig.subfigs for sfig in subfigs)
    getattr(fig, clear_meth)()
    assert fig.subfigs == []
    assert fig.axes == []

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 01:06:44,111 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to find tests that contain calls to `.cla()` or `.clear()` on axes objects.\n   - This test case `test_twinx_cla` includes calls to `ax2.cla()` and `ax3.cla()`.\n2. Extended relevance:\n   - This context is relevant as it demonstrates the usage of `cla()` on twinned axes, which is a specific scenario for clearing axes.', relative_path='lib/matplotlib/tests/test_axes.py', start_line=336, end_line=357), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is looking for tests with `.cla()` or `.clear()` calls on axes objects.\n   - The `test_inverted_cla` function contains multiple calls to `ax.cla()`.\n2. Extended relevance:\n   - This test is relevant because it checks the behavior of `cla()` in the context of an inverted axis, which is a non-trivial use case.', relative_path='lib/matplotlib/tests/test_axes.py', start_line=438, end_line=488), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is looking for tests with `.cla()` or `.clear()` calls on axes objects.\n   - The `test_subclass_clear_cla` function explicitly tests the `cla()` and `clear()` methods.\n2. Extended relevance:\n   - This test is highly relevant as it's designed to verify the correct behavior of `cla()` and `clear()` in subclasses of `Axes`, which is important for understanding the clearing mechanism in custom axes.", relative_path='lib/matplotlib/tests/test_axes.py', start_line=490, end_line=538), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to find tests that contain calls to `.cla()` or `.clear()` on axes objects.\n   - The `test_reset_grid` function uses `ax.clear()`.\n2. Extended relevance:\n   - This context is relevant as it shows `ax.clear()` being used to reset axes properties, specifically the grid visibility.', relative_path='lib/matplotlib/tests/test_axes.py', start_line=5344, end_line=5354), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to find tests that contain calls to `.cla()` or `.clear()` on axes objects.\n   - The `test_shared_axes_clear` function uses `ax.clear()`.\n2. Extended relevance:\n   - This test is relevant as it demonstrates the use of `clear()` on shared axes, which is a key aspect of the bug the user is investigating.', relative_path='lib/matplotlib/tests/test_axes.py', start_line=7782, end_line=7794), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is looking for tests with `.clf()` or `.clear()` calls on figure objects.\n   - The `test_clf_keyword` function tests the `clear=True` parameter in `plt.subplots()`, which results in the figure being cleared.\n2. Extended relevance:\n   - This test is relevant as it shows how a figure is cleared implicitly upon creation, which is related to the user's query about `clf()`.", relative_path='lib/matplotlib/tests/test_figure.py', start_line=144, end_line=161), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is looking for tests with `.clf()` or `.clear()` calls on figure objects.\n   - The `test_figure_clear` function is a parameterized test that explicitly calls both `fig.clear()` and `fig.clf()` via `getattr(fig, clear_meth)()`.\n2. Extended relevance:\n   - This is a highly relevant and comprehensive test case that covers various scenarios of clearing a figure, including figures with subplots and subfigures, directly addressing the user's query.", relative_path='lib/matplotlib/tests/test_figure.py', start_line=690, end_line=769)]
2025-12-21 01:06:44,118 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 7 contexts to memory for query: Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.
2025-12-21 01:06:44,118 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 01:06:44,118 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 01:06:44,119 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 7 new contexts to 0 existing contexts
2025-12-21 01:06:44,119 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 7 total contexts (removed 0 duplicates)
2025-12-21 01:06:44,120 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   ├── 24189-JB.rst
|   |   |   |   └── 24570-GL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   ├── 24455-AL.rst
|   |   |   |   └── 24577-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   └── 24257-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       ├── 24356-OG.rst
|   |   |       └── 24624-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── rgba_pcolormesh.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   └── view_current_axis_format.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           └── test_axes3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: cla(), clf() should unset the `.axes` and `.figure` attributes of deparented artists

Description: mpl2.0b3: Removing an artist from its axes unsets its `.axes` attribute, but clearing the axes does not do so.

```
In [11]: f, a = plt.subplots(); l, = a.plot([1, 2]); l.remove(); print(l.axes)
None

In [12]: f, a = plt.subplots(); l, = a.plot([1, 2]); a.cla(); print(l.axes)
Axes(0.125,0.11;0.775x0.77)
```


Patch information:
diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py
index 90b0bf117e..781bbc5b96 100644
--- a/lib/matplotlib/axes/_base.py
+++ b/lib/matplotlib/axes/_base.py
@@ -1308,6 +1308,37 @@ class _AxesBase(martist.Artist):
         self._get_patches_for_fill = _process_plot_var_args(self, 'fill')
 
         self._gridOn = mpl.rcParams['axes.grid']
+        # Detach and deparent existing child artists so their .axes/.figure are unset.
+        for _artist in list(self._children):
+            try:
+                _artist.remove()
+            except Exception:
+                try:
+                    # Fallback: manually decouple the artist from this Axes/Figure.
+                    if hasattr(_artist, "axes") and _artist.axes is self:
+                        self._mouseover_set.discard(_artist)
+                        _artist.axes = None
+                    if getattr(_artist, "figure", None) is self.figure:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
+        # Also remove any existing legend artist explicitly if present.
+        if getattr(self, "legend_", None) is not None:
+            try:
+                self.legend_.remove()
+            except Exception:
+                try:
+                    if hasattr(self.legend_, "axes") and self.legend_.axes is self:
+                        self._mouseover_set.discard(self.legend_)
+                        self.legend_.axes = None
+                    if getattr(self.legend_, "figure", None) is self.figure:
+                        self.legend_.figure = None
+                    self.legend_.stale_callback = None
+                    self.legend_._remove_method = None
+                except Exception:
+                    pass
         self._children = []
         self._mouseover_set = _OrderedSet()
         self.child_axes = []
diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py
index 6c18ba1a64..92ab8887e8 100644
--- a/lib/matplotlib/figure.py
+++ b/lib/matplotlib/figure.py
@@ -949,6 +949,18 @@ default: %(va)s
             ax.clear()
             self.delaxes(ax)  # Remove ax from self._axstack.
 
+        # Detach and deparent any artists directly added to the Figure
+        # so their .figure attribute is unset, consistent with Artist.remove().
+        for _alist in (self.artists, self.lines, self.patches,
+                       self.texts, self.images, self.legends):
+            for _artist in list(_alist):
+                try:
+                    if getattr(_artist, "figure", None) is self:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
         self.artists = []
         self.lines = []
         self.patches = []


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.
Extra Requirements: If the files are too large, please provide tests that contain calls to `.cla()` or `.clear()` on axes objects, and `.clf()` or `.clear()` on figure objects.
Purpose: I need to inspect these files to find three relevant test cases that cover the described bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_axes.py
Line number range: 336 - 357
Content:
336. def test_twinx_cla():
337.     fig, ax = plt.subplots()
338.     ax2 = ax.twinx()
339.     ax3 = ax2.twiny()
340.     plt.draw()
341.     assert not ax2.xaxis.get_visible()
342.     assert not ax2.patch.get_visible()
343.     ax2.cla()
344.     ax3.cla()
345. 
346.     assert not ax2.xaxis.get_visible()
347.     assert not ax2.patch.get_visible()
348.     assert ax2.yaxis.get_visible()
349. 
350.     assert ax3.xaxis.get_visible()
351.     assert not ax3.patch.get_visible()
352.     assert not ax3.yaxis.get_visible()
353. 
354.     assert ax.xaxis.get_visible()
355.     assert ax.patch.get_visible()
356.     assert ax.yaxis.get_visible()
357. 


File: lib/matplotlib/tests/test_axes.py
Line number range: 438 - 488
Content:
438. def test_inverted_cla():
439.     # GitHub PR #5450. Setting autoscale should reset
440.     # axes to be non-inverted.
441.     # plotting an image, then 1d graph, axis is now down
442.     fig = plt.figure(0)
443.     ax = fig.gca()
444.     # 1. test that a new axis is not inverted per default
445.     assert not ax.xaxis_inverted()
446.     assert not ax.yaxis_inverted()
447.     img = np.random.random((100, 100))
448.     ax.imshow(img)
449.     # 2. test that a image axis is inverted
450.     assert not ax.xaxis_inverted()
451.     assert ax.yaxis_inverted()
452.     # 3. test that clearing and plotting a line, axes are
453.     # not inverted
454.     ax.cla()
455.     x = np.linspace(0, 2*np.pi, 100)
456.     ax.plot(x, np.cos(x))
457.     assert not ax.xaxis_inverted()
458.     assert not ax.yaxis_inverted()
459. 
460.     # 4. autoscaling should not bring back axes to normal
461.     ax.cla()
462.     ax.imshow(img)
463.     plt.autoscale()
464.     assert not ax.xaxis_inverted()
465.     assert ax.yaxis_inverted()
466. 
467.     for ax in fig.axes:
468.         ax.remove()
469.     # 5. two shared axes. Inverting the leader axis should invert the shared
470.     # axes; clearing the leader axis should bring axes in shared
471.     # axes back to normal.
472.     ax0 = plt.subplot(211)
473.     ax1 = plt.subplot(212, sharey=ax0)
474.     ax0.yaxis.set_inverted(True)
475.     assert ax1.yaxis_inverted()
476.     ax1.plot(x, np.cos(x))
477.     ax0.cla()
478.     assert not ax1.yaxis_inverted()
479.     ax1.cla()
480.     # 6. clearing the follower should not touch limits
481.     ax0.imshow(img)
482.     ax1.plot(x, np.cos(x))
483.     ax1.cla()
484.     assert ax.yaxis_inverted()
485. 
486.     # clean up
487.     plt.close(fig)
488. 


File: lib/matplotlib/tests/test_axes.py
Line number range: 490 - 538
Content:
490. def test_subclass_clear_cla():
491.     # Ensure that subclasses of Axes call cla/clear correctly.
492.     # Note, we cannot use mocking here as we want to be sure that the
493.     # superclass fallback does not recurse.
494. 
495.     with pytest.warns(PendingDeprecationWarning,
496.                       match='Overriding `Axes.cla`'):
497.         class ClaAxes(Axes):
498.             def cla(self):
499.                 nonlocal called
500.                 called = True
501. 
502.     with pytest.warns(PendingDeprecationWarning,
503.                       match='Overriding `Axes.cla`'):
504.         class ClaSuperAxes(Axes):
505.             def cla(self):
506.                 nonlocal called
507.                 called = True
508.                 super().cla()
509. 
510.     class SubClaAxes(ClaAxes):
511.         pass
512. 
513.     class ClearAxes(Axes):
514.         def clear(self):
515.             nonlocal called
516.             called = True
517. 
518.     class ClearSuperAxes(Axes):
519.         def clear(self):
520.             nonlocal called
521.             called = True
522.             super().clear()
523. 
524.     class SubClearAxes(ClearAxes):
525.         pass
526. 
527.     fig = Figure()
528.     for axes_class in [ClaAxes, ClaSuperAxes, SubClaAxes,
529.                        ClearAxes, ClearSuperAxes, SubClearAxes]:
530.         called = False
531.         ax = axes_class(fig, [0, 0, 1, 1])
532.         # Axes.__init__ has already called clear (which aliases to cla or is in
533.         # the subclass).
534.         assert called
535. 
536.         called = False
537.         ax.cla()
538.         assert called


File: lib/matplotlib/tests/test_axes.py
Line number range: 5344 - 5354
Content:
5344. def test_reset_grid():
5345.     fig, ax = plt.subplots()
5346.     ax.tick_params(reset=True, which='major', labelsize=10)
5347.     assert not ax.xaxis.majorTicks[0].gridline.get_visible()
5348.     ax.grid(color='red')  # enables grid
5349.     assert ax.xaxis.majorTicks[0].gridline.get_visible()
5350. 
5351.     with plt.rc_context({'axes.grid': True}):
5352.         ax.clear()
5353.         ax.tick_params(reset=True, which='major', labelsize=10)
5354.         assert ax.xaxis.majorTicks[0].gridline.get_visible()


File: lib/matplotlib/tests/test_axes.py
Line number range: 7782 - 7794
Content:
7782. @check_figures_equal(extensions=['png'])
7783. def test_shared_axes_clear(fig_test, fig_ref):
7784.     x = np.arange(0.0, 2*np.pi, 0.01)
7785.     y = np.sin(x)
7786. 
7787.     axs = fig_ref.subplots(2, 2, sharex=True, sharey=True)
7788.     for ax in axs.flat:
7789.         ax.plot(x, y)
7790. 
7791.     axs = fig_test.subplots(2, 2, sharex=True, sharey=True)
7792.     for ax in axs.flat:
7793.         ax.clear()
7794.         ax.plot(x, y)


File: lib/matplotlib/tests/test_figure.py
Line number range: 144 - 161
Content:
144. def test_clf_keyword():
145.     # test if existing figure is cleared with figure() and subplots()
146.     text1 = 'A fancy plot'
147.     text2 = 'Really fancy!'
148. 
149.     fig0 = plt.figure(num=1)
150.     fig0.suptitle(text1)
151.     assert [t.get_text() for t in fig0.texts] == [text1]
152. 
153.     fig1 = plt.figure(num=1, clear=False)
154.     fig1.text(0.5, 0.5, text2)
155.     assert fig0 is fig1
156.     assert [t.get_text() for t in fig1.texts] == [text1, text2]
157. 
158.     fig2, ax2 = plt.subplots(2, 1, num=1, clear=True)
159.     assert fig0 is fig2
160.     assert [t.get_text() for t in fig2.texts] == []
161. 


File: lib/matplotlib/tests/test_figure.py
Line number range: 690 - 769
Content:
690. @pytest.mark.parametrize('clear_meth', ['clear', 'clf'])
691. def test_figure_clear(clear_meth):
692.     # we test the following figure clearing scenarios:
693.     fig = plt.figure()
694. 
695.     # a) an empty figure
696.     fig.clear()
697.     assert fig.axes == []
698. 
699.     # b) a figure with a single unnested axes
700.     ax = fig.add_subplot(111)
701.     getattr(fig, clear_meth)()
702.     assert fig.axes == []
703. 
704.     # c) a figure multiple unnested axes
705.     axes = [fig.add_subplot(2, 1, i+1) for i in range(2)]
706.     getattr(fig, clear_meth)()
707.     assert fig.axes == []
708. 
709.     # d) a figure with a subfigure
710.     gs = fig.add_gridspec(ncols=2, nrows=1)
711.     subfig = fig.add_subfigure(gs[0])
712.     subaxes = subfig.add_subplot(111)
713.     getattr(fig, clear_meth)()
714.     assert subfig not in fig.subfigs
715.     assert fig.axes == []
716. 
717.     # e) a figure with a subfigure and a subplot
718.     subfig = fig.add_subfigure(gs[0])
719.     subaxes = subfig.add_subplot(111)
720.     mainaxes = fig.add_subplot(gs[1])
721. 
722.     # e.1) removing just the axes leaves the subplot
723.     mainaxes.remove()
724.     assert fig.axes == [subaxes]
725. 
726.     # e.2) removing just the subaxes leaves the subplot
727.     # and subfigure
728.     mainaxes = fig.add_subplot(gs[1])
729.     subaxes.remove()
730.     assert fig.axes == [mainaxes]
731.     assert subfig in fig.subfigs
732. 
733.     # e.3) clearing the subfigure leaves the subplot
734.     subaxes = subfig.add_subplot(111)
735.     assert mainaxes in fig.axes
736.     assert subaxes in fig.axes
737.     getattr(subfig, clear_meth)()
738.     assert subfig in fig.subfigs
739.     assert subaxes not in subfig.axes
740.     assert subaxes not in fig.axes
741.     assert mainaxes in fig.axes
742. 
743.     # e.4) clearing the whole thing
744.     subaxes = subfig.add_subplot(111)
745.     getattr(fig, clear_meth)()
746.     assert fig.axes == []
747.     assert fig.subfigs == []
748. 
749.     # f) multiple subfigures
750.     subfigs = [fig.add_subfigure(gs[i]) for i in [0, 1]]
751.     subaxes = [sfig.add_subplot(111) for sfig in subfigs]
752.     assert all(ax in fig.axes for ax in subaxes)
753.     assert all(sfig in fig.subfigs for sfig in subfigs)
754. 
755.     # f.1) clearing only one subfigure
756.     getattr(subfigs[0], clear_meth)()
757.     assert subaxes[0] not in fig.axes
758.     assert subaxes[1] in fig.axes
759.     assert subfigs[1] in fig.subfigs
760. 
761.     # f.2) clearing the whole thing
762.     getattr(subfigs[1], clear_meth)()
763.     subfigs = [fig.add_subfigure(gs[i]) for i in [0, 1]]
764.     subaxes = [sfig.add_subplot(111) for sfig in subfigs]
765.     assert all(ax in fig.axes for ax in subaxes)
766.     assert all(sfig in fig.subfigs for sfig in subfigs)
767.     getattr(fig, clear_meth)()
768.     assert fig.subfigs == []
769.     assert fig.axes == []

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 01:07:09,582 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find test cases related to a bug where clearing a figure or axes does not properly deparent artists. The provided context from `test_axes.py` and `test_figure.py` contains tests for `cla()` and `clf()`, but they primarily assert the state of the axes or figure object itself, not the state of the artists that were removed. The bug is fundamentally about the artist's properties (`.axes`, `.figure`) after removal. The `Artist` class and its lifecycle are likely tested in `lib/matplotlib/tests/test_artist.py`. This file has not been provided yet and is the most logical place to find tests that check an artist's state after being removed, which is directly related to the bug and the provided patch that calls `artist.remove()`." query='Please provide the full content of `lib/matplotlib/tests/test_artist.py`.' extra_requirements="If the file is too large, please provide any tests that involve calling an artist's `.remove()` method and then checking the artist's `.axes` or `.figure` attributes." purpose="I need to find test cases that demonstrate the expected behavior of artist removal to find relevant examples for the user's issue."
2025-12-21 01:07:09,583 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `lib/matplotlib/tests/test_artist.py`.
2025-12-21 01:07:09,583 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 01:07:09,583 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 01:07:09,584 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 01:07:09,584 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `lib/matplotlib/tests/test_artist.py`.
Extra requirements: If the file is too large, please provide any tests that involve calling an artist's `.remove()` method and then checking the artist's `.axes` or `.figure` attributes.
Purpose: I need to find test cases that demonstrate the expected behavior of artist removal to find relevant examples for the user's issue.
2025-12-21 01:07:12,751 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I will first look for the specified file to verify its existence and size. If the file is too large to read completely, I will then search for tests that specifically call the `.remove()` method on an artist and subsequently check the artist's `.axes` or `.figure` attributes to find the most relevant examples for your issue." additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_artist.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2174, 'candidates_token_count': 92, 'total_token_count': 2424, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2174}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 92}], 'thoughts_token_count': 158, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1841268954069718, 'model_name': 'gemini-2.5-pro'} id='run--5a465059-2e64-4b58-b197-ea2fffd226a2-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/tests/test_artist.py'}, 'id': '9649f59d-4a5d-4a8a-8586-79447c102997', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2174, 'output_tokens': 92, 'total_tokens': 2424, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 158}}
2025-12-21 01:07:14,423 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have found the file `lib/matplotlib/tests/test_artist.py` and will now attempt to read its full content. If the file is too large, I will proceed with a more targeted search for specific tests related to artist removal as requested.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_artist.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2328, 'candidates_token_count': 78, 'total_token_count': 2444, 'cached_content_token_count': 1487, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2328}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1487}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 38}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09691100854140061, 'model_name': 'gemini-2.5-pro'} id='run--9428827b-97e7-44f5-97ae-b1a9116db09c-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_artist.py'}, 'id': 'ed5c8408-07eb-4652-af8e-23c421dfefe3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2328, 'output_tokens': 78, 'total_tokens': 2444, 'input_token_details': {'cache_read': 1487}, 'output_token_details': {'reasoning': 38}}
2025-12-21 01:07:17,681 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the beginning of `lib/matplotlib/tests/test_artist.py` and found it is a large file. To provide the most relevant information without overwhelming you, I will now search for specific tests within this file that demonstrate the `.remove()` method being used on an artist, as you requested. This will help us quickly locate the exact examples you need.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": ".remove()", "basename": "test_artist.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10333, 'candidates_token_count': 103, 'total_token_count': 10583, 'cached_content_token_count': 1843, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10333}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1843}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 103}], 'thoughts_token_count': 147}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3398221951086544, 'model_name': 'gemini-2.5-pro'} id='run--f879e618-fc6b-4d92-a9fb-db5f6126d0fa-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': '.remove()', 'basename': 'test_artist.py'}, 'id': '2f6ecb0b-d905-414a-b73c-e9463e7d381d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10333, 'output_tokens': 103, 'total_tokens': 10583, 'input_token_details': {'cache_read': 1843}, 'output_token_details': {'reasoning': 147}}
2025-12-21 01:07:25,782 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located the file `lib/matplotlib/tests/test_artist.py`. As you anticipated, the file is quite large, so I have extracted the most relevant test case that demonstrates the behavior of an artist after its `.remove()` method is called. The `test_remove` function first adds an image and a line to the axes, then calls `.remove()` on both. Subsequently, it asserts that the `.axes` and `.figure` attributes of both artists are `None`, which aligns with the behavior you were looking to verify.\n\nHere is the relevant code snippet:\n```python\ndef test_remove():\n    fig, ax = plt.subplots()\n    im = ax.imshow(np.arange(36).reshape(6, 6))\n    ln, = ax.plot(range(5))\n\n    assert fig.stale\n    assert ax.stale\n\n    fig.canvas.draw()\n    assert not fig.stale\n    assert not ax.stale\n    assert not ln.stale\n\n    assert im in ax._mouseover_set\n    assert ln not in ax._mouseover_set\n    assert im.axes is ax\n\n    im.remove()\n    ln.remove()\n\n    for art in [im, ln]:\n        assert art.axes is None\n        assert art.figure is None\n\n    assert im not in ax._mouseover_set\n    assert fig.stale\n    assert ax.stale\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2772, 'end_index': 3337, 'uri': 'https://gitlab-iid.aau.at/se-fundamentals/nn-review/-/blob/Michelle-Review-Kesselbacher/6E_Angabe/6E_Angabe/neural_network/venv/Lib/site-packages/matplotlib/tests/test_artist.py', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 10769, 'candidates_token_count': 314, 'total_token_count': 11601, 'cached_content_token_count': 9214, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10769}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9214}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 314}], 'thoughts_token_count': 518}, 'finish_reason': 'STOP', 'avg_logprobs': -0.24961048782251444, 'model_name': 'gemini-2.5-pro'} id='run--8135b212-ded1-464d-b773-7331a6d1c7ea-0' usage_metadata={'input_tokens': 10769, 'output_tokens': 314, 'total_tokens': 11601, 'input_token_details': {'cache_read': 9214}, 'output_token_details': {'reasoning': 518}}
2025-12-21 01:07:25,784 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `lib/matplotlib/tests/test_artist.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please provide any tests that involve calling an artist's `.remove()` method and then checking the artist's `.axes` or `.figure` attributes.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find test cases that demonstrate the expected behavior of artist removal to find relevant examples for the user's issue.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_artist.py
Line number range: 1 - 500
Content:
1. import io
2. from itertools import chain
3. 
4. import numpy as np
5. 
6. import pytest
7. 
8. import matplotlib.colors as mcolors
9. import matplotlib.pyplot as plt
10. import matplotlib.patches as mpatches
11. import matplotlib.lines as mlines
12. import matplotlib.path as mpath
13. import matplotlib.transforms as mtransforms
14. import matplotlib.collections as mcollections
15. import matplotlib.artist as martist
16. import matplotlib as mpl
17. from matplotlib.testing.decorators import check_figures_equal, image_comparison
18. 
19. 
20. def test_patch_transform_of_none():
21.     # tests the behaviour of patches added to an Axes with various transform
22.     # specifications
23. 
24.     ax = plt.axes()
25.     ax.set_xlim([1, 3])
26.     ax.set_ylim([1, 3])
27. 
28.     # Draw an ellipse over data coord (2, 2) by specifying device coords.
29.     xy_data = (2, 2)
30.     xy_pix = ax.transData.transform(xy_data)
31. 
32.     # Not providing a transform of None puts the ellipse in data coordinates .
33.     e = mpatches.Ellipse(xy_data, width=1, height=1, fc='yellow', alpha=0.5)
34.     ax.add_patch(e)
35.     assert e._transform == ax.transData
36. 
37.     # Providing a transform of None puts the ellipse in device coordinates.
38.     e = mpatches.Ellipse(xy_pix, width=120, height=120, fc='coral',
39.                          transform=None, alpha=0.5)
40.     assert e.is_transform_set()
41.     ax.add_patch(e)
42.     assert isinstance(e._transform, mtransforms.IdentityTransform)
43. 
44.     # Providing an IdentityTransform puts the ellipse in device coordinates.
45.     e = mpatches.Ellipse(xy_pix, width=100, height=100,
46.                          transform=mtransforms.IdentityTransform(), alpha=0.5)
47.     ax.add_patch(e)
48.     assert isinstance(e._transform, mtransforms.IdentityTransform)
49. 
50.     # Not providing a transform, and then subsequently "get_transform" should
51.     # not mean that "is_transform_set".
52.     e = mpatches.Ellipse(xy_pix, width=120, height=120, fc='coral',
53.                          alpha=0.5)
54.     intermediate_transform = e.get_transform()
55.     assert not e.is_transform_set()
56.     ax.add_patch(e)
57.     assert e.get_transform() != intermediate_transform
58.     assert e.is_transform_set()
59.     assert e._transform == ax.transData
60. 
61. 
62. def test_collection_transform_of_none():
63.     # tests the behaviour of collections added to an Axes with various
64.     # transform specifications
65. 
66.     ax = plt.axes()
67.     ax.set_xlim([1, 3])
68.     ax.set_ylim([1, 3])
69. 
70.     # draw an ellipse over data coord (2, 2) by specifying device coords
71.     xy_data = (2, 2)
72.     xy_pix = ax.transData.transform(xy_data)
73. 
74.     # not providing a transform of None puts the ellipse in data coordinates
75.     e = mpatches.Ellipse(xy_data, width=1, height=1)
76.     c = mcollections.PatchCollection([e], facecolor='yellow', alpha=0.5)
77.     ax.add_collection(c)
78.     # the collection should be in data coordinates
79.     assert c.get_offset_transform() + c.get_transform() == ax.transData
80. 
81.     # providing a transform of None puts the ellipse in device coordinates
82.     e = mpatches.Ellipse(xy_pix, width=120, height=120)
83.     c = mcollections.PatchCollection([e], facecolor='coral',
84.                                      alpha=0.5)
85.     c.set_transform(None)
86.     ax.add_collection(c)
87.     assert isinstance(c.get_transform(), mtransforms.IdentityTransform)
88. 
89.     # providing an IdentityTransform puts the ellipse in device coordinates
90.     e = mpatches.Ellipse(xy_pix, width=100, height=100)
91.     c = mcollections.PatchCollection([e],
92.                                      transform=mtransforms.IdentityTransform(),
93.                                      alpha=0.5)
94.     ax.add_collection(c)
95.     assert isinstance(c.get_offset_transform(), mtransforms.IdentityTransform)
96. 
97. 
98. @image_comparison(["clip_path_clipping"], remove_text=True)
99. def test_clipping():
100.     exterior = mpath.Path.unit_rectangle().deepcopy()
101.     exterior.vertices *= 4
102.     exterior.vertices -= 2
103.     interior = mpath.Path.unit_circle().deepcopy()
104.     interior.vertices = interior.vertices[::-1]
105.     clip_path = mpath.Path.make_compound_path(exterior, interior)
106. 
107.     star = mpath.Path.unit_regular_star(6).deepcopy()
108.     star.vertices *= 2.6
109. 
110.     fig, (ax1, ax2) = plt.subplots(1, 2, sharex=True, sharey=True)
111. 
112.     col = mcollections.PathCollection([star], lw=5, edgecolor='blue',
113.                                       facecolor='red', alpha=0.7, hatch='*')
114.     col.set_clip_path(clip_path, ax1.transData)
115.     ax1.add_collection(col)
116. 
117.     patch = mpatches.PathPatch(star, lw=5, edgecolor='blue', facecolor='red',
118.                                alpha=0.7, hatch='*')
119.     patch.set_clip_path(clip_path, ax2.transData)
120.     ax2.add_patch(patch)
121. 
122.     ax1.set_xlim([-3, 3])
123.     ax1.set_ylim([-3, 3])
124. 
125. 
126. @check_figures_equal(extensions=['png'])
127. def test_clipping_zoom(fig_test, fig_ref):
128.     # This test places the Axes and sets its limits such that the clip path is
129.     # outside the figure entirely. This should not break the clip path.
130.     ax_test = fig_test.add_axes([0, 0, 1, 1])
131.     l, = ax_test.plot([-3, 3], [-3, 3])
132.     # Explicit Path instead of a Rectangle uses clip path processing, instead
133.     # of a clip box optimization.
134.     p = mpath.Path([[0, 0], [1, 0], [1, 1], [0, 1], [0, 0]])
135.     p = mpatches.PathPatch(p, transform=ax_test.transData)
136.     l.set_clip_path(p)
137. 
138.     ax_ref = fig_ref.add_axes([0, 0, 1, 1])
139.     ax_ref.plot([-3, 3], [-3, 3])
140. 
141.     ax_ref.set(xlim=(0.5, 0.75), ylim=(0.5, 0.75))
142.     ax_test.set(xlim=(0.5, 0.75), ylim=(0.5, 0.75))
143. 
144. 
145. def test_cull_markers():
146.     x = np.random.random(20000)
147.     y = np.random.random(20000)
148. 
149.     fig, ax = plt.subplots()
150.     ax.plot(x, y, 'k.')
151.     ax.set_xlim(2, 3)
152. 
153.     pdf = io.BytesIO()
154.     fig.savefig(pdf, format="pdf")
155.     assert len(pdf.getvalue()) < 8000
156. 
157.     svg = io.BytesIO()
158.     fig.savefig(svg, format="svg")
159.     assert len(svg.getvalue()) < 20000
160. 
161. 
162. @image_comparison(['hatching'], remove_text=True, style='default')
163. def test_hatching():
164.     fig, ax = plt.subplots(1, 1)
165. 
166.     # Default hatch color.
167.     rect1 = mpatches.Rectangle((0, 0), 3, 4, hatch='/')
168.     ax.add_patch(rect1)
169. 
170.     rect2 = mcollections.RegularPolyCollection(
171.         4, sizes=[16000], offsets=[(1.5, 6.5)], offset_transform=ax.transData,
172.         hatch='/')
173.     ax.add_collection(rect2)
174. 
175.     # Ensure edge color is not applied to hatching.
176.     rect3 = mpatches.Rectangle((4, 0), 3, 4, hatch='/', edgecolor='C1')
177.     ax.add_patch(rect3)
178. 
179.     rect4 = mcollections.RegularPolyCollection(
180.         4, sizes=[16000], offsets=[(5.5, 6.5)], offset_transform=ax.transData,
181.         hatch='/', edgecolor='C1')
182.     ax.add_collection(rect4)
183. 
184.     ax.set_xlim(0, 7)
185.     ax.set_ylim(0, 9)
186. 
187. 
188. def test_remove():
189.     fig, ax = plt.subplots()
190.     im = ax.imshow(np.arange(36).reshape(6, 6))
191.     ln, = ax.plot(range(5))
192. 
193.     assert fig.stale
194.     assert ax.stale
195. 
196.     fig.canvas.draw()
197.     assert not fig.stale
198.     assert not ax.stale
199.     assert not ln.stale
200. 
201.     assert im in ax._mouseover_set
202.     assert ln not in ax._mouseover_set
203.     assert im.axes is ax
204. 
205.     im.remove()
206.     ln.remove()
207. 
208.     for art in [im, ln]:
209.         assert art.axes is None
210.         assert art.figure is None
211. 
212.     assert im not in ax._mouseover_set
213.     assert fig.stale
214.     assert ax.stale
215. 
216. 
217. @image_comparison(["default_edges.png"], remove_text=True, style='default')
218. def test_default_edges():
219.     # Remove this line when this test image is regenerated.
220.     plt.rcParams['text.kerning_factor'] = 6
221. 
222.     fig, [[ax1, ax2], [ax3, ax4]] = plt.subplots(2, 2)
223. 
224.     ax1.plot(np.arange(10), np.arange(10), 'x',
225.              np.arange(10) + 1, np.arange(10), 'o')
226.     ax2.bar(np.arange(10), np.arange(10), align='edge')
227.     ax3.text(0, 0, "BOX", size=24, bbox=dict(boxstyle='sawtooth'))
228.     ax3.set_xlim((-1, 1))
229.     ax3.set_ylim((-1, 1))
230.     pp1 = mpatches.PathPatch(
231.         mpath.Path([(0, 0), (1, 0), (1, 1), (0, 0)],
232.                    [mpath.Path.MOVETO, mpath.Path.CURVE3,
233.                     mpath.Path.CURVE3, mpath.Path.CLOSEPOLY]),
234.         fc="none", transform=ax4.transData)
235.     ax4.add_patch(pp1)
236. 
237. 
238. def test_properties():
239.     ln = mlines.Line2D([], [])
240.     ln.properties()  # Check that no warning is emitted.
241. 
242. 
243. def test_setp():
244.     # Check empty list
245.     plt.setp([])
246.     plt.setp([[]])
247. 
248.     # Check arbitrary iterables
249.     fig, ax = plt.subplots()
250.     lines1 = ax.plot(range(3))
251.     lines2 = ax.plot(range(3))
252.     martist.setp(chain(lines1, lines2), 'lw', 5)
253.     plt.setp(ax.spines.values(), color='green')
254. 
255.     # Check *file* argument
256.     sio = io.StringIO()
257.     plt.setp(lines1, 'zorder', file=sio)
258.     assert sio.getvalue() == '  zorder: float\n'
259. 
260. 
261. def test_None_zorder():
262.     fig, ax = plt.subplots()
263.     ln, = ax.plot(range(5), zorder=None)
264.     assert ln.get_zorder() == mlines.Line2D.zorder
265.     ln.set_zorder(123456)
266.     assert ln.get_zorder() == 123456
267.     ln.set_zorder(None)
268.     assert ln.get_zorder() == mlines.Line2D.zorder
269. 
270. 
271. @pytest.mark.parametrize('accept_clause, expected', [
272.     ('', 'unknown'),
273.     ("ACCEPTS: [ '-' | '--' | '-.' ]", "[ '-' | '--' | '-.' ]"),
274.     ('ACCEPTS: Some description.', 'Some description.'),
275.     ('.. ACCEPTS: Some description.', 'Some description.'),
276.     ('arg : int', 'int'),
277.     ('*arg : int', 'int'),
278.     ('arg : int\nACCEPTS: Something else.', 'Something else. '),
279. ])
280. def test_artist_inspector_get_valid_values(accept_clause, expected):
281.     class TestArtist(martist.Artist):
282.         def set_f(self, arg):
283.             pass
284. 
285.     TestArtist.set_f.__doc__ = """
286.     Some text.
287. 
288.     %s
289.     """ % accept_clause
290.     valid_values = martist.ArtistInspector(TestArtist).get_valid_values('f')
291.     assert valid_values == expected
292. 
293. 
294. def test_artist_inspector_get_aliases():
295.     # test the correct format and type of get_aliases method
296.     ai = martist.ArtistInspector(mlines.Line2D)
297.     aliases = ai.get_aliases()
298.     assert aliases["linewidth"] == {"lw"}
299. 
300. 
301. def test_set_alpha():
302.     art = martist.Artist()
303.     with pytest.raises(TypeError, match='^alpha must be numeric or None'):
304.         art.set_alpha('string')
305.     with pytest.raises(TypeError, match='^alpha must be numeric or None'):
306.         art.set_alpha([1, 2, 3])
307.     with pytest.raises(ValueError, match="outside 0-1 range"):
308.         art.set_alpha(1.1)
309.     with pytest.raises(ValueError, match="outside 0-1 range"):
310.         art.set_alpha(np.nan)
311. 
312. 
313. def test_set_alpha_for_array():
314.     art = martist.Artist()
315.     with pytest.raises(TypeError, match='^alpha must be numeric or None'):
316.         art._set_alpha_for_array('string')
317.     with pytest.raises(ValueError, match="outside 0-1 range"):
318.         art._set_alpha_for_array(1.1)
319.     with pytest.raises(ValueError, match="outside 0-1 range"):
320.         art._set_alpha_for_array(np.nan)
321.     with pytest.raises(ValueError, match="alpha must be between 0 and 1"):
322.         art._set_alpha_for_array([0.5, 1.1])
323.     with pytest.raises(ValueError, match="alpha must be between 0 and 1"):
324.         art._set_alpha_for_array([0.5, np.nan])
325. 
326. 
327. def test_callbacks():
328.     def func(artist):
329.         func.counter += 1
330. 
331.     func.counter = 0
332. 
333.     art = martist.Artist()
334.     oid = art.add_callback(func)
335.     assert func.counter == 0
336.     art.pchanged()  # must call the callback
337.     assert func.counter == 1
338.     art.set_zorder(10)  # setting a property must also call the callback
339.     assert func.counter == 2
340.     art.remove_callback(oid)
341.     art.pchanged()  # must not call the callback anymore
342.     assert func.counter == 2
343. 
344. 
345. def test_set_signature():
346.     """Test autogenerated ``set()`` for Artist subclasses."""
347.     class MyArtist1(martist.Artist):
348.         def set_myparam1(self, val):
349.             pass
350. 
351.     assert hasattr(MyArtist1.set, '_autogenerated_signature')
352.     assert 'myparam1' in MyArtist1.set.__doc__
353. 
354.     class MyArtist2(MyArtist1):
355.         def set_myparam2(self, val):
356.             pass
357. 
358.     assert hasattr(MyArtist2.set, '_autogenerated_signature')
359.     assert 'myparam1' in MyArtist2.set.__doc__
360.     assert 'myparam2' in MyArtist2.set.__doc__
361. 
362. 
363. def test_set_is_overwritten():
364.     """set() defined in Artist subclasses should not be overwritten."""
365.     class MyArtist3(martist.Artist):
366. 
367.         def set(self, **kwargs):
368.             """Not overwritten."""
369. 
370.     assert not hasattr(MyArtist3.set, '_autogenerated_signature')
371.     assert MyArtist3.set.__doc__ == "Not overwritten."
372. 
373.     class MyArtist4(MyArtist3):
374.         pass
375. 
376.     assert MyArtist4.set is MyArtist3.set
377. 
378. 
379. def test_format_cursor_data_BoundaryNorm():
380.     """Test if cursor data is correct when using BoundaryNorm."""
381.     X = np.empty((3, 3))
382.     X[0, 0] = 0.9
383.     X[0, 1] = 0.99
384.     X[0, 2] = 0.999
385.     X[1, 0] = -1
386.     X[1, 1] = 0
387.     X[1, 2] = 1
388.     X[2, 0] = 0.09
389.     X[2, 1] = 0.009
390.     X[2, 2] = 0.0009
391. 
392.     # map range -1..1 to 0..256 in 0.1 steps
393.     fig, ax = plt.subplots()
394.     fig.suptitle("-1..1 to 0..256 in 0.1")
395.     norm = mcolors.BoundaryNorm(np.linspace(-1, 1, 20), 256)
396.     img = ax.imshow(X, cmap='RdBu_r', norm=norm)
397. 
398.     labels_list = [
399.         "[0.9]",
400.         "[1.]",
401.         "[1.]",
402.         "[-1.0]",
403.         "[0.0]",
404.         "[1.0]",
405.         "[0.09]",
406.         "[0.009]",
407.         "[0.0009]",
408.     ]
409.     for v, label in zip(X.flat, labels_list):
410.         # label = "[{:-#.{}g}]".format(v, cbook._g_sig_digits(v, 0.1))
411.         assert img.format_cursor_data(v) == label
412. 
413.     plt.close()
414. 
415.     # map range -1..1 to 0..256 in 0.01 steps
416.     fig, ax = plt.subplots()
417.     fig.suptitle("-1..1 to 0..256 in 0.01")
418.     cmap = mpl.colormaps['RdBu_r'].resampled(200)
419.     norm = mcolors.BoundaryNorm(np.linspace(-1, 1, 200), 200)
420.     img = ax.imshow(X, cmap=cmap, norm=norm)
421. 
422.     labels_list = [
423.         "[0.90]",
424.         "[0.99]",
425.         "[1.0]",
426.         "[-1.00]",
427.         "[0.00]",
428.         "[1.00]",
429.         "[0.09]",
430.         "[0.009]",
431.         "[0.0009]",
432.     ]
433.     for v, label in zip(X.flat, labels_list):
434.         # label = "[{:-#.{}g}]".format(v, cbook._g_sig_digits(v, 0.01))
435.         assert img.format_cursor_data(v) == label
436. 
437.     plt.close()
438. 
439.     # map range -1..1 to 0..256 in 0.01 steps
440.     fig, ax = plt.subplots()
441.     fig.suptitle("-1..1 to 0..256 in 0.001")
442.     cmap = mpl.colormaps['RdBu_r'].resampled(2000)
443.     norm = mcolors.BoundaryNorm(np.linspace(-1, 1, 2000), 2000)
444.     img = ax.imshow(X, cmap=cmap, norm=norm)
445. 
446.     labels_list = [
447.         "[0.900]",
448.         "[0.990]",
449.         "[0.999]",
450.         "[-1.000]",
451.         "[0.000]",
452.         "[1.000]",
453.         "[0.090]",
454.         "[0.009]",
455.         "[0.0009]",
456.     ]
457.     for v, label in zip(X.flat, labels_list):
458.         # label = "[{:-#.{}g}]".format(v, cbook._g_sig_digits(v, 0.001))
459.         assert img.format_cursor_data(v) == label
460. 
461.     plt.close()
462. 
463.     # different testing data set with
464.     # out of bounds values for 0..1 range
465.     X = np.empty((7, 1))
466.     X[0] = -1.0
467.     X[1] = 0.0
468.     X[2] = 0.1
469.     X[3] = 0.5
470.     X[4] = 0.9
471.     X[5] = 1.0
472.     X[6] = 2.0
473. 
474.     labels_list = [
475.         "[-1.0]",
476.         "[0.0]",
477.         "[0.1]",
478.         "[0.5]",
479.         "[0.9]",
480.         "[1.0]",
481.         "[2.0]",
482.     ]
483. 
484.     fig, ax = plt.subplots()
485.     fig.suptitle("noclip, neither")
486.     norm = mcolors.BoundaryNorm(
487.         np.linspace(0, 1, 4, endpoint=True), 256, clip=False, extend='neither')
488.     img = ax.imshow(X, cmap='RdBu_r', norm=norm)
489.     for v, label in zip(X.flat, labels_list):
490.         # label = "[{:-#.{}g}]".format(v, cbook._g_sig_digits(v, 0.33))
491.         assert img.format_cursor_data(v) == label
492. 
493.     plt.close()
494. 
495.     fig, ax = plt.subplots()
496.     fig.suptitle("noclip, min")
497.     norm = mcolors.BoundaryNorm(
498.         np.linspace(0, 1, 4, endpoint=True), 256, clip=False, extend='min')
499.     img = ax.imshow(X, cmap='RdBu_r', norm=norm)
500.     for v, label in zip(X.flat, labels_list):

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 01:07:33,429 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is looking for test cases involving the `.remove()` method of an artist.\n   - Specifically, they are interested in what happens to the `.axes` and `.figure` attributes after the artist is removed.\n\n2. Extended relevance:\n   - The `test_remove` function directly demonstrates the requested behavior.\n   - It creates two different types of artists (an `AxesImage` and a `Line2D`).\n   - It calls the `remove()` method on both artists.\n   - It then explicitly asserts that `art.axes` is `None` and `art.figure` is `None` for each removed artist, which is exactly what the user is looking for.', relative_path='lib/matplotlib/tests/test_artist.py', start_line=188, end_line=215)]
2025-12-21 01:07:33,431 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `lib/matplotlib/tests/test_artist.py`.
2025-12-21 01:07:33,431 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 01:07:33,431 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 01:07:33,431 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 7 existing contexts
2025-12-21 01:07:33,432 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 8 total contexts (removed 0 duplicates)
2025-12-21 01:07:33,432 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   ├── 24189-JB.rst
|   |   |   |   └── 24570-GL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   ├── 24455-AL.rst
|   |   |   |   └── 24577-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   └── 24257-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       ├── 24356-OG.rst
|   |   |       └── 24624-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── rgba_pcolormesh.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   └── view_current_axis_format.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           └── test_axes3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: cla(), clf() should unset the `.axes` and `.figure` attributes of deparented artists

Description: mpl2.0b3: Removing an artist from its axes unsets its `.axes` attribute, but clearing the axes does not do so.

```
In [11]: f, a = plt.subplots(); l, = a.plot([1, 2]); l.remove(); print(l.axes)
None

In [12]: f, a = plt.subplots(); l, = a.plot([1, 2]); a.cla(); print(l.axes)
Axes(0.125,0.11;0.775x0.77)
```


Patch information:
diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py
index 90b0bf117e..781bbc5b96 100644
--- a/lib/matplotlib/axes/_base.py
+++ b/lib/matplotlib/axes/_base.py
@@ -1308,6 +1308,37 @@ class _AxesBase(martist.Artist):
         self._get_patches_for_fill = _process_plot_var_args(self, 'fill')
 
         self._gridOn = mpl.rcParams['axes.grid']
+        # Detach and deparent existing child artists so their .axes/.figure are unset.
+        for _artist in list(self._children):
+            try:
+                _artist.remove()
+            except Exception:
+                try:
+                    # Fallback: manually decouple the artist from this Axes/Figure.
+                    if hasattr(_artist, "axes") and _artist.axes is self:
+                        self._mouseover_set.discard(_artist)
+                        _artist.axes = None
+                    if getattr(_artist, "figure", None) is self.figure:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
+        # Also remove any existing legend artist explicitly if present.
+        if getattr(self, "legend_", None) is not None:
+            try:
+                self.legend_.remove()
+            except Exception:
+                try:
+                    if hasattr(self.legend_, "axes") and self.legend_.axes is self:
+                        self._mouseover_set.discard(self.legend_)
+                        self.legend_.axes = None
+                    if getattr(self.legend_, "figure", None) is self.figure:
+                        self.legend_.figure = None
+                    self.legend_.stale_callback = None
+                    self.legend_._remove_method = None
+                except Exception:
+                    pass
         self._children = []
         self._mouseover_set = _OrderedSet()
         self.child_axes = []
diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py
index 6c18ba1a64..92ab8887e8 100644
--- a/lib/matplotlib/figure.py
+++ b/lib/matplotlib/figure.py
@@ -949,6 +949,18 @@ default: %(va)s
             ax.clear()
             self.delaxes(ax)  # Remove ax from self._axstack.
 
+        # Detach and deparent any artists directly added to the Figure
+        # so their .figure attribute is unset, consistent with Artist.remove().
+        for _alist in (self.artists, self.lines, self.patches,
+                       self.texts, self.images, self.legends):
+            for _artist in list(_alist):
+                try:
+                    if getattr(_artist, "figure", None) is self:
+                        _artist.figure = None
+                    _artist.stale_callback = None
+                    _artist._remove_method = None
+                except Exception:
+                    pass
         self.artists = []
         self.lines = []
         self.patches = []


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `lib/matplotlib/tests/test_axes.py` and `lib/matplotlib/tests/test_figure.py`.
Extra Requirements: If the files are too large, please provide tests that contain calls to `.cla()` or `.clear()` on axes objects, and `.clf()` or `.clear()` on figure objects.
Purpose: I need to inspect these files to find three relevant test cases that cover the described bug.

Previous refined query 2:
Essential Query: Please provide the full content of `lib/matplotlib/tests/test_artist.py`.
Extra Requirements: If the file is too large, please provide any tests that involve calling an artist's `.remove()` method and then checking the artist's `.axes` or `.figure` attributes.
Purpose: I need to find test cases that demonstrate the expected behavior of artist removal to find relevant examples for the user's issue.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_artist.py
Line number range: 188 - 215
Content:
188. def test_remove():
189.     fig, ax = plt.subplots()
190.     im = ax.imshow(np.arange(36).reshape(6, 6))
191.     ln, = ax.plot(range(5))
192. 
193.     assert fig.stale
194.     assert ax.stale
195. 
196.     fig.canvas.draw()
197.     assert not fig.stale
198.     assert not ax.stale
199.     assert not ln.stale
200. 
201.     assert im in ax._mouseover_set
202.     assert ln not in ax._mouseover_set
203.     assert im.axes is ax
204. 
205.     im.remove()
206.     ln.remove()
207. 
208.     for art in [im, ln]:
209.         assert art.axes is None
210.         assert art.figure is None
211. 
212.     assert im not in ax._mouseover_set
213.     assert fig.stale
214.     assert ax.stale
215. 


File: lib/matplotlib/tests/test_axes.py
Line number range: 336 - 357
Content:
336. def test_twinx_cla():
337.     fig, ax = plt.subplots()
338.     ax2 = ax.twinx()
339.     ax3 = ax2.twiny()
340.     plt.draw()
341.     assert not ax2.xaxis.get_visible()
342.     assert not ax2.patch.get_visible()
343.     ax2.cla()
344.     ax3.cla()
345. 
346.     assert not ax2.xaxis.get_visible()
347.     assert not ax2.patch.get_visible()
348.     assert ax2.yaxis.get_visible()
349. 
350.     assert ax3.xaxis.get_visible()
351.     assert not ax3.patch.get_visible()
352.     assert not ax3.yaxis.get_visible()
353. 
354.     assert ax.xaxis.get_visible()
355.     assert ax.patch.get_visible()
356.     assert ax.yaxis.get_visible()
357. 


File: lib/matplotlib/tests/test_axes.py
Line number range: 438 - 488
Content:
438. def test_inverted_cla():
439.     # GitHub PR #5450. Setting autoscale should reset
440.     # axes to be non-inverted.
441.     # plotting an image, then 1d graph, axis is now down
442.     fig = plt.figure(0)
443.     ax = fig.gca()
444.     # 1. test that a new axis is not inverted per default
445.     assert not ax.xaxis_inverted()
446.     assert not ax.yaxis_inverted()
447.     img = np.random.random((100, 100))
448.     ax.imshow(img)
449.     # 2. test that a image axis is inverted
450.     assert not ax.xaxis_inverted()
451.     assert ax.yaxis_inverted()
452.     # 3. test that clearing and plotting a line, axes are
453.     # not inverted
454.     ax.cla()
455.     x = np.linspace(0, 2*np.pi, 100)
456.     ax.plot(x, np.cos(x))
457.     assert not ax.xaxis_inverted()
458.     assert not ax.yaxis_inverted()
459. 
460.     # 4. autoscaling should not bring back axes to normal
461.     ax.cla()
462.     ax.imshow(img)
463.     plt.autoscale()
464.     assert not ax.xaxis_inverted()
465.     assert ax.yaxis_inverted()
466. 
467.     for ax in fig.axes:
468.         ax.remove()
469.     # 5. two shared axes. Inverting the leader axis should invert the shared
470.     # axes; clearing the leader axis should bring axes in shared
471.     # axes back to normal.
472.     ax0 = plt.subplot(211)
473.     ax1 = plt.subplot(212, sharey=ax0)
474.     ax0.yaxis.set_inverted(True)
475.     assert ax1.yaxis_inverted()
476.     ax1.plot(x, np.cos(x))
477.     ax0.cla()
478.     assert not ax1.yaxis_inverted()
479.     ax1.cla()
480.     # 6. clearing the follower should not touch limits
481.     ax0.imshow(img)
482.     ax1.plot(x, np.cos(x))
483.     ax1.cla()
484.     assert ax.yaxis_inverted()
485. 
486.     # clean up
487.     plt.close(fig)
488. 


File: lib/matplotlib/tests/test_axes.py
Line number range: 490 - 538
Content:
490. def test_subclass_clear_cla():
491.     # Ensure that subclasses of Axes call cla/clear correctly.
492.     # Note, we cannot use mocking here as we want to be sure that the
493.     # superclass fallback does not recurse.
494. 
495.     with pytest.warns(PendingDeprecationWarning,
496.                       match='Overriding `Axes.cla`'):
497.         class ClaAxes(Axes):
498.             def cla(self):
499.                 nonlocal called
500.                 called = True
501. 
502.     with pytest.warns(PendingDeprecationWarning,
503.                       match='Overriding `Axes.cla`'):
504.         class ClaSuperAxes(Axes):
505.             def cla(self):
506.                 nonlocal called
507.                 called = True
508.                 super().cla()
509. 
510.     class SubClaAxes(ClaAxes):
511.         pass
512. 
513.     class ClearAxes(Axes):
514.         def clear(self):
515.             nonlocal called
516.             called = True
517. 
518.     class ClearSuperAxes(Axes):
519.         def clear(self):
520.             nonlocal called
521.             called = True
522.             super().clear()
523. 
524.     class SubClearAxes(ClearAxes):
525.         pass
526. 
527.     fig = Figure()
528.     for axes_class in [ClaAxes, ClaSuperAxes, SubClaAxes,
529.                        ClearAxes, ClearSuperAxes, SubClearAxes]:
530.         called = False
531.         ax = axes_class(fig, [0, 0, 1, 1])
532.         # Axes.__init__ has already called clear (which aliases to cla or is in
533.         # the subclass).
534.         assert called
535. 
536.         called = False
537.         ax.cla()
538.         assert called


File: lib/matplotlib/tests/test_axes.py
Line number range: 5344 - 5354
Content:
5344. def test_reset_grid():
5345.     fig, ax = plt.subplots()
5346.     ax.tick_params(reset=True, which='major', labelsize=10)
5347.     assert not ax.xaxis.majorTicks[0].gridline.get_visible()
5348.     ax.grid(color='red')  # enables grid
5349.     assert ax.xaxis.majorTicks[0].gridline.get_visible()
5350. 
5351.     with plt.rc_context({'axes.grid': True}):
5352.         ax.clear()
5353.         ax.tick_params(reset=True, which='major', labelsize=10)
5354.         assert ax.xaxis.majorTicks[0].gridline.get_visible()


File: lib/matplotlib/tests/test_axes.py
Line number range: 7782 - 7794
Content:
7782. @check_figures_equal(extensions=['png'])
7783. def test_shared_axes_clear(fig_test, fig_ref):
7784.     x = np.arange(0.0, 2*np.pi, 0.01)
7785.     y = np.sin(x)
7786. 
7787.     axs = fig_ref.subplots(2, 2, sharex=True, sharey=True)
7788.     for ax in axs.flat:
7789.         ax.plot(x, y)
7790. 
7791.     axs = fig_test.subplots(2, 2, sharex=True, sharey=True)
7792.     for ax in axs.flat:
7793.         ax.clear()
7794.         ax.plot(x, y)


File: lib/matplotlib/tests/test_figure.py
Line number range: 144 - 161
Content:
144. def test_clf_keyword():
145.     # test if existing figure is cleared with figure() and subplots()
146.     text1 = 'A fancy plot'
147.     text2 = 'Really fancy!'
148. 
149.     fig0 = plt.figure(num=1)
150.     fig0.suptitle(text1)
151.     assert [t.get_text() for t in fig0.texts] == [text1]
152. 
153.     fig1 = plt.figure(num=1, clear=False)
154.     fig1.text(0.5, 0.5, text2)
155.     assert fig0 is fig1
156.     assert [t.get_text() for t in fig1.texts] == [text1, text2]
157. 
158.     fig2, ax2 = plt.subplots(2, 1, num=1, clear=True)
159.     assert fig0 is fig2
160.     assert [t.get_text() for t in fig2.texts] == []
161. 


File: lib/matplotlib/tests/test_figure.py
Line number range: 690 - 769
Content:
690. @pytest.mark.parametrize('clear_meth', ['clear', 'clf'])
691. def test_figure_clear(clear_meth):
692.     # we test the following figure clearing scenarios:
693.     fig = plt.figure()
694. 
695.     # a) an empty figure
696.     fig.clear()
697.     assert fig.axes == []
698. 
699.     # b) a figure with a single unnested axes
700.     ax = fig.add_subplot(111)
701.     getattr(fig, clear_meth)()
702.     assert fig.axes == []
703. 
704.     # c) a figure multiple unnested axes
705.     axes = [fig.add_subplot(2, 1, i+1) for i in range(2)]
706.     getattr(fig, clear_meth)()
707.     assert fig.axes == []
708. 
709.     # d) a figure with a subfigure
710.     gs = fig.add_gridspec(ncols=2, nrows=1)
711.     subfig = fig.add_subfigure(gs[0])
712.     subaxes = subfig.add_subplot(111)
713.     getattr(fig, clear_meth)()
714.     assert subfig not in fig.subfigs
715.     assert fig.axes == []
716. 
717.     # e) a figure with a subfigure and a subplot
718.     subfig = fig.add_subfigure(gs[0])
719.     subaxes = subfig.add_subplot(111)
720.     mainaxes = fig.add_subplot(gs[1])
721. 
722.     # e.1) removing just the axes leaves the subplot
723.     mainaxes.remove()
724.     assert fig.axes == [subaxes]
725. 
726.     # e.2) removing just the subaxes leaves the subplot
727.     # and subfigure
728.     mainaxes = fig.add_subplot(gs[1])
729.     subaxes.remove()
730.     assert fig.axes == [mainaxes]
731.     assert subfig in fig.subfigs
732. 
733.     # e.3) clearing the subfigure leaves the subplot
734.     subaxes = subfig.add_subplot(111)
735.     assert mainaxes in fig.axes
736.     assert subaxes in fig.axes
737.     getattr(subfig, clear_meth)()
738.     assert subfig in fig.subfigs
739.     assert subaxes not in subfig.axes
740.     assert subaxes not in fig.axes
741.     assert mainaxes in fig.axes
742. 
743.     # e.4) clearing the whole thing
744.     subaxes = subfig.add_subplot(111)
745.     getattr(fig, clear_meth)()
746.     assert fig.axes == []
747.     assert fig.subfigs == []
748. 
749.     # f) multiple subfigures
750.     subfigs = [fig.add_subfigure(gs[i]) for i in [0, 1]]
751.     subaxes = [sfig.add_subplot(111) for sfig in subfigs]
752.     assert all(ax in fig.axes for ax in subaxes)
753.     assert all(sfig in fig.subfigs for sfig in subfigs)
754. 
755.     # f.1) clearing only one subfigure
756.     getattr(subfigs[0], clear_meth)()
757.     assert subaxes[0] not in fig.axes
758.     assert subaxes[1] in fig.axes
759.     assert subfigs[1] in fig.subfigs
760. 
761.     # f.2) clearing the whole thing
762.     getattr(subfigs[1], clear_meth)()
763.     subfigs = [fig.add_subfigure(gs[i]) for i in [0, 1]]
764.     subaxes = [sfig.add_subplot(111) for sfig in subfigs]
765.     assert all(ax in fig.axes for ax in subaxes)
766.     assert all(sfig in fig.subfigs for sfig in subfigs)
767.     getattr(fig, clear_meth)()
768.     assert fig.subfigs == []
769.     assert fig.axes == []

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 01:08:34,593 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user requires three test cases. The current context provides one highly relevant test, `test_remove` in `test_artist.py`, which demonstrates the expected state of a removed artist. However, the provided tests for `cla()` and `clf()` in `test_axes.py` and `test_figure.py` are not ideal, as they check the state of the parent Axes/Figure rather than the deparented artists. The patch specifically adds handling for legends when `Axes.cla()` is called, suggesting that tests involving legends and `cla()` would be very relevant. The file `lib/matplotlib/tests/test_legend.py` has not been provided and is the most likely place to find such a test.' query='Please provide the full content of `lib/matplotlib/tests/test_legend.py`.' extra_requirements='If the file is too large, please provide any tests that involve creating a legend and then calling `cla()` or `clear()` on the parent axes.' purpose="I need to find a test case that checks the behavior of legends when an axes is cleared, as this is a specific case handled in the user's patch and would serve as a relevant example."
2025-12-21 01:08:34,594 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `lib/matplotlib/tests/test_legend.py`.
2025-12-21 01:08:34,594 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 01:08:34,594 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 01:08:34,595 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 01:08:34,595 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `lib/matplotlib/tests/test_legend.py`.
Extra requirements: If the file is too large, please provide any tests that involve creating a legend and then calling `cla()` or `clear()` on the parent axes.
Purpose: I need to find a test case that checks the behavior of legends when an axes is cleared, as this is a specific case handled in the user's patch and would serve as a relevant example.
2025-12-21 01:08:37,348 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will first attempt to read the entire file `lib/matplotlib/tests/test_legend.py` to provide you with its full content. If the file is too large to be read at once, I will then search for specific tests within that file that involve creating a legend and subsequently clearing the axes, as you requested.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_legend.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2182, 'candidates_token_count': 92, 'total_token_count': 2407, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2182}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 92}], 'thoughts_token_count': 133, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1147548945053764, 'model_name': 'gemini-2.5-pro'} id='run--103f940c-f976-4684-870f-f903d4a6a89b-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_legend.py'}, 'id': 'ad35a6fc-2329-4d4f-a34b-a7922f16d712', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2182, 'output_tokens': 92, 'total_tokens': 2407, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 133}}
2025-12-21 01:08:41,403 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the initial 500 lines of `lib/matplotlib/tests/test_legend.py`. Since the file is quite large, I will now proceed to search within it for tests that specifically involve the use of `cla()` or `clear()` after a legend has been created. This will help us pinpoint the exact test cases you are interested in.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_legend.py", "text": "cla()"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11233, 'candidates_token_count': 112, 'total_token_count': 11510, 'cached_content_token_count': 1862, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11233}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1862}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 112}], 'thoughts_token_count': 165}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12689238786697388, 'model_name': 'gemini-2.5-pro'} id='run--13b2aacc-ad4f-4cef-82e4-38f9415c2021-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/tests/test_legend.py', 'text': 'cla()'}, 'id': '8dc89f70-e834-4dab-89c9-68acef107dd9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11233, 'output_tokens': 112, 'total_tokens': 11510, 'input_token_details': {'cache_read': 1862}, 'output_token_details': {'reasoning': 165}}
2025-12-21 01:08:43,937 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have searched for `cla()` within the file and found no occurrences. I will now broaden my search to include `clear()` to see if that yields any relevant test cases.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_legend.py", "text": "clear()"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11377, 'candidates_token_count': 72, 'total_token_count': 11569, 'cached_content_token_count': 11157, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11377}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11157}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 72}], 'thoughts_token_count': 120}, 'finish_reason': 'STOP', 'avg_logprobs': -0.23377757602267796, 'model_name': 'gemini-2.5-pro'} id='run--7c572d94-9cd2-4d96-b807-bae5eb3b066f-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/tests/test_legend.py', 'text': 'clear()'}, 'id': '0b4425d2-2923-4652-8122-319ec12746e2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11377, 'output_tokens': 72, 'total_tokens': 11569, 'input_token_details': {'cache_read': 11157}, 'output_token_details': {'reasoning': 120}}
2025-12-21 01:09:09,721 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have searched for both `cla()` and `clear()` within the file and found no occurrences. It seems there are no tests that explicitly call these methods after creating a legend. However, I can still provide you with the full content of the file if you'd like to examine it yourself." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 10000.0, "start_line": 1.0, "relative_path": "lib/matplotlib/tests/test_legend.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11481, 'candidates_token_count': 91, 'total_token_count': 12323, 'cached_content_token_count': 11135, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11481}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11135}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 91}], 'thoughts_token_count': 751}, 'finish_reason': 'STOP', 'avg_logprobs': -1.5055421263307005, 'model_name': 'gemini-2.5-pro'} id='run--81333b32-459e-43e4-ad05-790a2b30d305-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 10000.0, 'start_line': 1.0, 'relative_path': 'lib/matplotlib/tests/test_legend.py'}, 'id': '1a50ad2f-30b6-4cdc-a0d2-59d743b1321c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11481, 'output_tokens': 91, 'total_tokens': 12323, 'input_token_details': {'cache_read': 11135}, 'output_token_details': {'reasoning': 751}}
2025-12-21 01:09:16,027 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of `lib/matplotlib/tests/test_legend.py` for you. My search for tests containing `cla()` or `clear()` within the file did not yield any results, suggesting that there are no explicit tests for this specific scenario. You can now review the full file content to find the most relevant examples for your needs.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 31367, 'candidates_token_count': 75, 'total_token_count': 31916, 'cached_content_token_count': 11632, 'prompt_tokens_details': [{'modality': 1, 'token_count': 31367}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11632}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 75}], 'thoughts_token_count': 474}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8443529764811198, 'model_name': 'gemini-2.5-pro'} id='run--c79f20e6-9aef-450e-80ac-e789e13b08f0-0' usage_metadata={'input_tokens': 31367, 'output_tokens': 75, 'total_tokens': 31916, 'input_token_details': {'cache_read': 11632}, 'output_token_details': {'reasoning': 474}}
2025-12-21 01:09:16,028 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `lib/matplotlib/tests/test_legend.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please provide any tests that involve creating a legend and then calling `cla()` or `clear()` on the parent axes.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find a test case that checks the behavior of legends when an axes is cleared, as this is a specific case handled in the user's patch and would serve as a relevant example.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_legend.py
Line number range: 1 - 10000
Content:
1. import collections
2. import platform
3. from unittest import mock
4. import warnings
5. 
6. import numpy as np
7. import pytest
8. 
9. from matplotlib.testing.decorators import check_figures_equal, image_comparison
10. from matplotlib.testing._markers import needs_usetex
11. import matplotlib.pyplot as plt
12. import matplotlib as mpl
13. import matplotlib.transforms as mtransforms
14. import matplotlib.collections as mcollections
15. import matplotlib.lines as mlines
16. from matplotlib.legend_handler import HandlerTuple
17. import matplotlib.legend as mlegend
18. from matplotlib import rc_context
19. from matplotlib.font_manager import FontProperties
20. 
21. 
22. def test_legend_ordereddict():
23.     # smoketest that ordereddict inputs work...
24. 
25.     X = np.random.randn(10)
26.     Y = np.random.randn(10)
27.     labels = ['a'] * 5 + ['b'] * 5
28.     colors = ['r'] * 5 + ['g'] * 5
29. 
30.     fig, ax = plt.subplots()
31.     for x, y, label, color in zip(X, Y, labels, colors):
32.         ax.scatter(x, y, label=label, c=color)
33. 
34.     handles, labels = ax.get_legend_handles_labels()
35.     legend = collections.OrderedDict(zip(labels, handles))
36.     ax.legend(legend.values(), legend.keys(),
37.               loc='center left', bbox_to_anchor=(1, .5))
38. 
39. 
40. @image_comparison(['legend_auto1'], remove_text=True)
41. def test_legend_auto1():
42.     """Test automatic legend placement"""
43.     fig, ax = plt.subplots()
44.     x = np.arange(100)
45.     ax.plot(x, 50 - x, 'o', label='y=1')
46.     ax.plot(x, x - 50, 'o', label='y=-1')
47.     ax.legend(loc='best')
48. 
49. 
50. @image_comparison(['legend_auto2'], remove_text=True)
51. def test_legend_auto2():
52.     """Test automatic legend placement"""
53.     fig, ax = plt.subplots()
54.     x = np.arange(100)
55.     b1 = ax.bar(x, x, align='edge', color='m')
56.     b2 = ax.bar(x, x[::-1], align='edge', color='g')
57.     ax.legend([b1[0], b2[0]], ['up', 'down'], loc='best')
58. 
59. 
60. @image_comparison(['legend_auto3'])
61. def test_legend_auto3():
62.     """Test automatic legend placement"""
63.     fig, ax = plt.subplots()
64.     x = [0.9, 0.1, 0.1, 0.9, 0.9, 0.5]
65.     y = [0.95, 0.95, 0.05, 0.05, 0.5, 0.5]
66.     ax.plot(x, y, 'o-', label='line')
67.     ax.set_xlim(0.0, 1.0)
68.     ax.set_ylim(0.0, 1.0)
69.     ax.legend(loc='best')
70. 
71. 
72. @image_comparison(['legend_various_labels'], remove_text=True)
73. def test_various_labels():
74.     # tests all sorts of label types
75.     fig = plt.figure()
76.     ax = fig.add_subplot(121)
77.     ax.plot(np.arange(4), 'o', label=1)
78.     ax.plot(np.linspace(4, 4.1), 'o', label='Développés')
79.     ax.plot(np.arange(4, 1, -1), 'o', label='__nolegend__')
80.     ax.legend(numpoints=1, loc='best')
81. 
82. 
83. def test_legend_label_with_leading_underscore():
84.     """
85.     Test that artists with labels starting with an underscore are not added to
86.     the legend, and that a warning is issued if one tries to add them
87.     explicitly.
88.     """
89.     fig, ax = plt.subplots()
90.     line, = ax.plot([0, 1], label='_foo')
91.     with pytest.warns(UserWarning,
92.                       match=r"starts with '_'.*excluded from the legend."):
93.         legend = ax.legend(handles=[line])
94.     assert len(legend.legendHandles) == 0
95. 
96. 
97. @image_comparison(['legend_labels_first.png'], remove_text=True)
98. def test_labels_first():
99.     # test labels to left of markers
100.     fig, ax = plt.subplots()
101.     ax.plot(np.arange(10), '-o', label=1)
102.     ax.plot(np.ones(10)*5, ':x', label="x")
103.     ax.plot(np.arange(20, 10, -1), 'd', label="diamond")
104.     ax.legend(loc='best', markerfirst=False)
105. 
106. 
107. @image_comparison(['legend_multiple_keys.png'], remove_text=True)
108. def test_multiple_keys():
109.     # test legend entries with multiple keys
110.     fig, ax = plt.subplots()
111.     p1, = ax.plot([1, 2, 3], '-o')
112.     p2, = ax.plot([2, 3, 4], '-x')
113.     p3, = ax.plot([3, 4, 5], '-d')
114.     ax.legend([(p1, p2), (p2, p1), p3], ['two keys', 'pad=0', 'one key'],
115.               numpoints=1,
116.               handler_map={(p1, p2): HandlerTuple(ndivide=None),
117.                            (p2, p1): HandlerTuple(ndivide=None, pad=0)})
118. 
119. 
120. @image_comparison(['rgba_alpha.png'], remove_text=True,
121.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
122. def test_alpha_rgba():
123.     fig, ax = plt.subplots()
124.     ax.plot(range(10), lw=5)
125.     leg = plt.legend(['Longlabel that will go away'], loc='center')
126.     leg.legendPatch.set_facecolor([1, 0, 0, 0.5])
127. 
128. 
129. @image_comparison(['rcparam_alpha.png'], remove_text=True,
130.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
131. def test_alpha_rcparam():
132.     fig, ax = plt.subplots()
133.     ax.plot(range(10), lw=5)
134.     with mpl.rc_context(rc={'legend.framealpha': .75}):
135.         leg = plt.legend(['Longlabel that will go away'], loc='center')
136.         # this alpha is going to be over-ridden by the rcparam with
137.         # sets the alpha of the patch to be non-None which causes the alpha
138.         # value of the face color to be discarded.  This behavior may not be
139.         # ideal, but it is what it is and we should keep track of it changing
140.         leg.legendPatch.set_facecolor([1, 0, 0, 0.5])
141. 
142. 
143. @image_comparison(['fancy'], remove_text=True)
144. def test_fancy():
145.     # using subplot triggers some offsetbox functionality untested elsewhere
146.     plt.subplot(121)
147.     plt.plot([5] * 10, 'o--', label='XX')
148.     plt.scatter(np.arange(10), np.arange(10, 0, -1), label='XX\nXX')
149.     plt.errorbar(np.arange(10), np.arange(10), xerr=0.5,
150.                  yerr=0.5, label='XX')
151.     plt.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
152.                ncols=2, shadow=True, title="My legend", numpoints=1)
153. 
154. 
155. @image_comparison(['framealpha'], remove_text=True,
156.                   tol=0 if platform.machine() == 'x86_64' else 0.02)
157. def test_framealpha():
158.     x = np.linspace(1, 100, 100)
159.     y = x
160.     plt.plot(x, y, label='mylabel', lw=10)
161.     plt.legend(framealpha=0.5)
162. 
163. 
164. @image_comparison(['scatter_rc3', 'scatter_rc1'], remove_text=True)
165. def test_rc():
166.     # using subplot triggers some offsetbox functionality untested elsewhere
167.     plt.figure()
168.     ax = plt.subplot(121)
169.     ax.scatter(np.arange(10), np.arange(10, 0, -1), label='three')
170.     ax.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
171.               title="My legend")
172. 
173.     mpl.rcParams['legend.scatterpoints'] = 1
174.     plt.figure()
175.     ax = plt.subplot(121)
176.     ax.scatter(np.arange(10), np.arange(10, 0, -1), label='one')
177.     ax.legend(loc="center left", bbox_to_anchor=[1.0, 0.5],
178.               title="My legend")
179. 
180. 
181. @image_comparison(['legend_expand'], remove_text=True)
182. def test_legend_expand():
183.     """Test expand mode"""
184.     legend_modes = [None, "expand"]
185.     fig, axs = plt.subplots(len(legend_modes), 1)
186.     x = np.arange(100)
187.     for ax, mode in zip(axs, legend_modes):
188.         ax.plot(x, 50 - x, 'o', label='y=1')
189.         l1 = ax.legend(loc='upper left', mode=mode)
190.         ax.add_artist(l1)
191.         ax.plot(x, x - 50, 'o', label='y=-1')
192.         l2 = ax.legend(loc='right', mode=mode)
193.         ax.add_artist(l2)
194.         ax.legend(loc='lower left', mode=mode, ncols=2)
195. 
196. 
197. @image_comparison(['hatching'], remove_text=True, style='default')
198. def test_hatching():
199.     # Remove this line when this test image is regenerated.
200.     plt.rcParams['text.kerning_factor'] = 6
201. 
202.     fig, ax = plt.subplots()
203. 
204.     # Patches
205.     patch = plt.Rectangle((0, 0), 0.3, 0.3, hatch='xx',
206.                           label='Patch\ndefault color\nfilled')
207.     ax.add_patch(patch)
208.     patch = plt.Rectangle((0.33, 0), 0.3, 0.3, hatch='||', edgecolor='C1',
209.                           label='Patch\nexplicit color\nfilled')
210.     ax.add_patch(patch)
211.     patch = plt.Rectangle((0, 0.4), 0.3, 0.3, hatch='xx', fill=False,
212.                           label='Patch\ndefault color\nunfilled')
213.     ax.add_patch(patch)
214.     patch = plt.Rectangle((0.33, 0.4), 0.3, 0.3, hatch='||', fill=False,
215.                           edgecolor='C1',
216.                           label='Patch\nexplicit color\nunfilled')
217.     ax.add_patch(patch)
218. 
219.     # Paths
220.     ax.fill_between([0, .15, .3], [.8, .8, .8], [.9, 1.0, .9],
221.                     hatch='+', label='Path\ndefault color')
222.     ax.fill_between([.33, .48, .63], [.8, .8, .8], [.9, 1.0, .9],
223.                     hatch='+', edgecolor='C2', label='Path\nexplicit color')
224. 
225.     ax.set_xlim(-0.01, 1.1)
226.     ax.set_ylim(-0.01, 1.1)
227.     ax.legend(handlelength=4, handleheight=4)
228. 
229. 
230. def test_legend_remove():
231.     fig, ax = plt.subplots()
232.     lines = ax.plot(range(10))
233.     leg = fig.legend(lines, "test")
234.     leg.remove()
235.     assert fig.legends == []
236.     leg = ax.legend("test")
237.     leg.remove()
238.     assert ax.get_legend() is None
239. 
240. 
241. class TestLegendFunction:
242.     # Tests the legend function on the Axes and pyplot.
243.     def test_legend_no_args(self):
244.         lines = plt.plot(range(10), label='hello world')
245.         with mock.patch('matplotlib.legend.Legend') as Legend:
246.             plt.legend()
247.         Legend.assert_called_with(plt.gca(), lines, ['hello world'])
248. 
249.     def test_legend_positional_handles_labels(self):
250.         lines = plt.plot(range(10))
251.         with mock.patch('matplotlib.legend.Legend') as Legend:
252.             plt.legend(lines, ['hello world'])
253.         Legend.assert_called_with(plt.gca(), lines, ['hello world'])
254. 
255.     def test_legend_positional_handles_only(self):
256.         lines = plt.plot(range(10))
257.         with pytest.raises(TypeError, match='but found an Artist'):
258.             # a single arg is interpreted as labels
259.             # it's a common error to just pass handles
260.             plt.legend(lines)
261. 
262.     def test_legend_positional_labels_only(self):
263.         lines = plt.plot(range(10), label='hello world')
264.         with mock.patch('matplotlib.legend.Legend') as Legend:
265.             plt.legend(['foobar'])
266.         Legend.assert_called_with(plt.gca(), lines, ['foobar'])
267. 
268.     def test_legend_three_args(self):
269.         lines = plt.plot(range(10), label='hello world')
270.         with mock.patch('matplotlib.legend.Legend') as Legend:
271.             plt.legend(lines, ['foobar'], loc='right')
272.         Legend.assert_called_with(plt.gca(), lines, ['foobar'], loc='right')
273. 
274.     def test_legend_handler_map(self):
275.         lines = plt.plot(range(10), label='hello world')
276.         with mock.patch('matplotlib.legend.'
277.                         '_get_legend_handles_labels') as handles_labels:
278.             handles_labels.return_value = lines, ['hello world']
279.             plt.legend(handler_map={'1': 2})
280.         handles_labels.assert_called_with([plt.gca()], {'1': 2})
281. 
282.     def test_legend_kwargs_handles_only(self):
283.         fig, ax = plt.subplots()
284.         x = np.linspace(0, 1, 11)
285.         ln1, = ax.plot(x, x, label='x')
286.         ln2, = ax.plot(x, 2*x, label='2x')
287.         ln3, = ax.plot(x, 3*x, label='3x')
288.         with mock.patch('matplotlib.legend.Legend') as Legend:
289.             ax.legend(handles=[ln3, ln2])  # reversed and not ln1
290.         Legend.assert_called_with(ax, [ln3, ln2], ['3x', '2x'])
291. 
292.     def test_legend_kwargs_labels_only(self):
293.         fig, ax = plt.subplots()
294.         x = np.linspace(0, 1, 11)
295.         ln1, = ax.plot(x, x)
296.         ln2, = ax.plot(x, 2*x)
297.         with mock.patch('matplotlib.legend.Legend') as Legend:
298.             ax.legend(labels=['x', '2x'])
299.         Legend.assert_called_with(ax, [ln1, ln2], ['x', '2x'])
300. 
301.     def test_legend_kwargs_handles_labels(self):
302.         fig, ax = plt.subplots()
303.         th = np.linspace(0, 2*np.pi, 1024)
304.         lns, = ax.plot(th, np.sin(th), label='sin')
305.         lnc, = ax.plot(th, np.cos(th), label='cos')
306.         with mock.patch('matplotlib.legend.Legend') as Legend:
307.             # labels of lns, lnc are overwritten with explicit ('a', 'b')
308.             ax.legend(labels=('a', 'b'), handles=(lnc, lns))
309.         Legend.assert_called_with(ax, (lnc, lns), ('a', 'b'))
310. 
311.     def test_warn_mixed_args_and_kwargs(self):
312.         fig, ax = plt.subplots()
313.         th = np.linspace(0, 2*np.pi, 1024)
314.         lns, = ax.plot(th, np.sin(th), label='sin')
315.         lnc, = ax.plot(th, np.cos(th), label='cos')
316.         with pytest.warns(UserWarning) as record:
317.             ax.legend((lnc, lns), labels=('a', 'b'))
318.         assert len(record) == 1
319.         assert str(record[0].message) == (
320.             "You have mixed positional and keyword arguments, some input may "
321.             "be discarded.")
322. 
323.     def test_parasite(self):
324.         from mpl_toolkits.axes_grid1 import host_subplot
325. 
326.         host = host_subplot(111)
327.         par = host.twinx()
328. 
329.         p1, = host.plot([0, 1, 2], [0, 1, 2], label="Density")
330.         p2, = par.plot([0, 1, 2], [0, 3, 2], label="Temperature")
331. 
332.         with mock.patch('matplotlib.legend.Legend') as Legend:
333.             plt.legend()
334.         Legend.assert_called_with(host, [p1, p2], ['Density', 'Temperature'])
335. 
336. 
337. class TestLegendFigureFunction:
338.     # Tests the legend function for figure
339.     def test_legend_handle_label(self):
340.         fig, ax = plt.subplots()
341.         lines = ax.plot(range(10))
342.         with mock.patch('matplotlib.legend.Legend') as Legend:
343.             fig.legend(lines, ['hello world'])
344.         Legend.assert_called_with(fig, lines, ['hello world'],
345.                                   bbox_transform=fig.transFigure)
346. 
347.     def test_legend_no_args(self):
348.         fig, ax = plt.subplots()
349.         lines = ax.plot(range(10), label='hello world')
350.         with mock.patch('matplotlib.legend.Legend') as Legend:
351.             fig.legend()
352.         Legend.assert_called_with(fig, lines, ['hello world'],
353.                                   bbox_transform=fig.transFigure)
354. 
355.     def test_legend_label_arg(self):
356.         fig, ax = plt.subplots()
357.         lines = ax.plot(range(10))
358.         with mock.patch('matplotlib.legend.Legend') as Legend:
359.             fig.legend(['foobar'])
360.         Legend.assert_called_with(fig, lines, ['foobar'],
361.                                   bbox_transform=fig.transFigure)
362. 
363.     def test_legend_label_three_args(self):
364.         fig, ax = plt.subplots()
365.         lines = ax.plot(range(10))
366.         with mock.patch('matplotlib.legend.Legend') as Legend:
367.             fig.legend(lines, ['foobar'], 'right')
368.         Legend.assert_called_with(fig, lines, ['foobar'], 'right',
369.                                   bbox_transform=fig.transFigure)
370. 
371.     def test_legend_label_three_args_pluskw(self):
372.         # test that third argument and loc=  called together give
373.         # Exception
374.         fig, ax = plt.subplots()
375.         lines = ax.plot(range(10))
376.         with pytest.raises(Exception):
377.             fig.legend(lines, ['foobar'], 'right', loc='left')
378. 
379.     def test_legend_kw_args(self):
380.         fig, axs = plt.subplots(1, 2)
381.         lines = axs[0].plot(range(10))
382.         lines2 = axs[1].plot(np.arange(10) * 2.)
383.         with mock.patch('matplotlib.legend.Legend') as Legend:
384.             fig.legend(loc='right', labels=('a', 'b'), handles=(lines, lines2))
385.         Legend.assert_called_with(
386.             fig, (lines, lines2), ('a', 'b'), loc='right',
387.             bbox_transform=fig.transFigure)
388. 
389.     def test_warn_args_kwargs(self):
390.         fig, axs = plt.subplots(1, 2)
391.         lines = axs[0].plot(range(10))
392.         lines2 = axs[1].plot(np.arange(10) * 2.)
393.         with pytest.warns(UserWarning) as record:
394.             fig.legend((lines, lines2), labels=('a', 'b'))
395.         assert len(record) == 1
396.         assert str(record[0].message) == (
397.             "You have mixed positional and keyword arguments, some input may "
398.             "be discarded.")
399. 
400. 
401. @image_comparison(['legend_stackplot.png'])
402. def test_legend_stackplot():
403.     """Test legend for PolyCollection using stackplot."""
404.     # related to #1341, #1943, and PR #3303
405.     fig, ax = plt.subplots()
406.     x = np.linspace(0, 10, 10)
407.     y1 = 1.0 * x
408.     y2 = 2.0 * x + 1
409.     y3 = 3.0 * x + 2
410.     ax.stackplot(x, y1, y2, y3, labels=['y1', 'y2', 'y3'])
411.     ax.set_xlim((0, 10))
412.     ax.set_ylim((0, 70))
413.     ax.legend(loc='best')
414. 
415. 
416. def test_cross_figure_patch_legend():
417.     fig, ax = plt.subplots()
418.     fig2, ax2 = plt.subplots()
419. 
420.     brs = ax.bar(range(3), range(3))
421.     fig2.legend(brs, 'foo')
422. 
423. 
424. def test_nanscatter():
425.     fig, ax = plt.subplots()
426. 
427.     h = ax.scatter([np.nan], [np.nan], marker="o",
428.                    facecolor="r", edgecolor="r", s=3)
429. 
430.     ax.legend([h], ["scatter"])
431. 
432.     fig, ax = plt.subplots()
433.     for color in ['red', 'green', 'blue']:
434.         n = 750
435.         x, y = np.random.rand(2, n)
436.         scale = 200.0 * np.random.rand(n)
437.         ax.scatter(x, y, c=color, s=scale, label=color,
438.                    alpha=0.3, edgecolors='none')
439. 
440.     ax.legend()
441.     ax.grid(True)
442. 
443. 
444. def test_legend_repeatcheckok():
445.     fig, ax = plt.subplots()
446.     ax.scatter(0.0, 1.0, color='k', marker='o', label='test')
447.     ax.scatter(0.5, 0.0, color='r', marker='v', label='test')
448.     ax.legend()
449.     hand, lab = mlegend._get_legend_handles_labels([ax])
450.     assert len(lab) == 2
451.     fig, ax = plt.subplots()
452.     ax.scatter(0.0, 1.0, color='k', marker='o', label='test')
453.     ax.scatter(0.5, 0.0, color='k', marker='v', label='test')
454.     ax.legend()
455.     hand, lab = mlegend._get_legend_handles_labels([ax])
456.     assert len(lab) == 2
457. 
458. 
459. @image_comparison(['not_covering_scatter.png'])
460. def test_not_covering_scatter():
461.     colors = ['b', 'g', 'r']
462. 
463.     for n in range(3):
464.         plt.scatter([n], [n], color=colors[n])
465. 
466.     plt.legend(['foo', 'foo', 'foo'], loc='best')
467.     plt.gca().set_xlim(-0.5, 2.2)
468.     plt.gca().set_ylim(-0.5, 2.2)
469. 
470. 
471. @image_comparison(['not_covering_scatter_transform.png'])
472. def test_not_covering_scatter_transform():
473.     # Offsets point to top left, the default auto position
474.     offset = mtransforms.Affine2D().translate(-20, 20)
475.     x = np.linspace(0, 30, 1000)
476.     plt.plot(x, x)
477. 
478.     plt.scatter([20], [10], transform=offset + plt.gca().transData)
479. 
480.     plt.legend(['foo', 'bar'], loc='best')
481. 
482. 
483. def test_linecollection_scaled_dashes():
484.     lines1 = [[(0, .5), (.5, 1)], [(.3, .6), (.2, .2)]]
485.     lines2 = [[[0.7, .2], [.8, .4]], [[.5, .7], [.6, .1]]]
486.     lines3 = [[[0.6, .2], [.8, .4]], [[.5, .7], [.1, .1]]]
487.     lc1 = mcollections.LineCollection(lines1, linestyles="--", lw=3)
488.     lc2 = mcollections.LineCollection(lines2, linestyles="-.")
489.     lc3 = mcollections.LineCollection(lines3, linestyles=":", lw=.5)
490. 
491.     fig, ax = plt.subplots()
492.     ax.add_collection(lc1)
493.     ax.add_collection(lc2)
494.     ax.add_collection(lc3)
495. 
496.     leg = ax.legend([lc1, lc2, lc3], ["line1", "line2", 'line 3'])
497.     h1, h2, h3 = leg.legendHandles
498. 
499.     for oh, lh in zip((lc1, lc2, lc3), (h1, h2, h3)):
500.         assert oh.get_linestyles()[0] == lh._dash_pattern
501. 
502. 
503. def test_handler_numpoints():
504.     """Test legend handler with numpoints <= 1."""
505.     # related to #6921 and PR #8478
506.     fig, ax = plt.subplots()
507.     ax.plot(range(5), label='test')
508.     ax.legend(numpoints=0.5)
509. 
510. 
511. def test_text_nohandler_warning():
512.     """Test that Text artists with labels raise a warning"""
513.     fig, ax = plt.subplots()
514.     ax.text(x=0, y=0, s="text", label="label")
515.     with pytest.warns(UserWarning) as record:
516.         ax.legend()
517.     assert len(record) == 1
518. 
519.     # this should _not_ warn:
520.     f, ax = plt.subplots()
521.     ax.pcolormesh(np.random.uniform(0, 1, (10, 10)))
522.     with warnings.catch_warnings():
523.         warnings.simplefilter("error")
524.         ax.get_legend_handles_labels()
525. 
526. 
527. def test_empty_bar_chart_with_legend():
528.     """Test legend when bar chart is empty with a label."""
529.     # related to issue #13003. Calling plt.legend() should not
530.     # raise an IndexError.
531.     plt.bar([], [], label='test')
532.     plt.legend()
533. 
534. 
535. def test_shadow_framealpha():
536.     # Test if framealpha is activated when shadow is True
537.     # and framealpha is not explicitly passed'''
538.     fig, ax = plt.subplots()
539.     ax.plot(range(100), label="test")
540.     leg = ax.legend(shadow=True, facecolor='w')
541.     assert leg.get_frame().get_alpha() == 1
542. 
543. 
544. def test_legend_title_empty():
545.     # test that if we don't set the legend title, that
546.     # it comes back as an empty string, and that it is not
547.     # visible:
548.     fig, ax = plt.subplots()
549.     ax.plot(range(10))
550.     leg = ax.legend()
551.     assert leg.get_title().get_text() == ""
552.     assert not leg.get_title().get_visible()
553. 
554. 
555. def test_legend_proper_window_extent():
556.     # test that legend returns the expected extent under various dpi...
557.     fig, ax = plt.subplots(dpi=100)
558.     ax.plot(range(10), label='Aardvark')
559.     leg = ax.legend()
560.     x01 = leg.get_window_extent(fig.canvas.get_renderer()).x0
561. 
562.     fig, ax = plt.subplots(dpi=200)
563.     ax.plot(range(10), label='Aardvark')
564.     leg = ax.legend()
565.     x02 = leg.get_window_extent(fig.canvas.get_renderer()).x0
566.     assert pytest.approx(x01*2, 0.1) == x02
567. 
568. 
569. def test_window_extent_cached_renderer():
570.     fig, ax = plt.subplots(dpi=100)
571.     ax.plot(range(10), label='Aardvark')
572.     leg = ax.legend()
573.     leg2 = fig.legend()
574.     fig.canvas.draw()
575.     # check that get_window_extent will use the cached renderer
576.     leg.get_window_extent()
577.     leg2.get_window_extent()
578. 
579. 
580. def test_legend_title_fontprop_fontsize():
581.     # test the title_fontsize kwarg
582.     plt.plot(range(10))
583.     with pytest.raises(ValueError):
584.         plt.legend(title='Aardvark', title_fontsize=22,
585.                    title_fontproperties={'family': 'serif', 'size': 22})
586. 
587.     leg = plt.legend(title='Aardvark', title_fontproperties=FontProperties(
588.                                        family='serif', size=22))
589.     assert leg.get_title().get_size() == 22
590. 
591.     fig, axes = plt.subplots(2, 3, figsize=(10, 6))
592.     axes = axes.flat
593.     axes[0].plot(range(10))
594.     leg0 = axes[0].legend(title='Aardvark', title_fontsize=22)
595.     assert leg0.get_title().get_fontsize() == 22
596.     axes[1].plot(range(10))
597.     leg1 = axes[1].legend(title='Aardvark',
598.                           title_fontproperties={'family': 'serif', 'size': 22})
599.     assert leg1.get_title().get_fontsize() == 22
600.     axes[2].plot(range(10))
601.     mpl.rcParams['legend.title_fontsize'] = None
602.     leg2 = axes[2].legend(title='Aardvark',
603.                           title_fontproperties={'family': 'serif'})
604.     assert leg2.get_title().get_fontsize() == mpl.rcParams['font.size']
605.     axes[3].plot(range(10))
606.     leg3 = axes[3].legend(title='Aardvark')
607.     assert leg3.get_title().get_fontsize() == mpl.rcParams['font.size']
608.     axes[4].plot(range(10))
609.     mpl.rcParams['legend.title_fontsize'] = 20
610.     leg4 = axes[4].legend(title='Aardvark',
611.                           title_fontproperties={'family': 'serif'})
612.     assert leg4.get_title().get_fontsize() == 20
613.     axes[5].plot(range(10))
614.     leg5 = axes[5].legend(title='Aardvark')
615.     assert leg5.get_title().get_fontsize() == 20
616. 
617. 
618. @pytest.mark.parametrize('alignment', ('center', 'left', 'right'))
619. def test_legend_alignment(alignment):
620.     fig, ax = plt.subplots()
621.     ax.plot(range(10), label='test')
622.     leg = ax.legend(title="Aardvark", alignment=alignment)
623.     assert leg.get_children()[0].align == alignment
624.     assert leg.get_alignment() == alignment
625. 
626. 
627. @pytest.mark.parametrize('alignment', ('center', 'left', 'right'))
628. def test_legend_set_alignment(alignment):
629.     fig, ax = plt.subplots()
630.     ax.plot(range(10), label='test')
631.     leg = ax.legend()
632.     leg.set_alignment(alignment)
633.     assert leg.get_children()[0].align == alignment
634.     assert leg.get_alignment() == alignment
635. 
636. 
637. @pytest.mark.parametrize('color', ('red', 'none', (.5, .5, .5)))
638. def test_legend_labelcolor_single(color):
639.     # test labelcolor for a single color
640.     fig, ax = plt.subplots()
641.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
642.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
643.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
644. 
645.     leg = ax.legend(labelcolor=color)
646.     for text in leg.get_texts():
647.         assert mpl.colors.same_color(text.get_color(), color)
648. 
649. 
650. def test_legend_labelcolor_list():
651.     # test labelcolor for a list of colors
652.     fig, ax = plt.subplots()
653.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
654.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
655.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
656. 
657.     leg = ax.legend(labelcolor=['r', 'g', 'b'])
658.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
659.         assert mpl.colors.same_color(text.get_color(), color)
660. 
661. 
662. def test_legend_labelcolor_linecolor():
663.     # test the labelcolor for labelcolor='linecolor'
664.     fig, ax = plt.subplots()
665.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', color='r')
666.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', color='g')
667.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', color='b')
668. 
669.     leg = ax.legend(labelcolor='linecolor')
670.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
671.         assert mpl.colors.same_color(text.get_color(), color)
672. 
673. 
674. def test_legend_pathcollection_labelcolor_linecolor():
675.     # test the labelcolor for labelcolor='linecolor' on PathCollection
676.     fig, ax = plt.subplots()
677.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c='r')
678.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', c='g')
679.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', c='b')
680. 
681.     leg = ax.legend(labelcolor='linecolor')
682.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
683.         assert mpl.colors.same_color(text.get_color(), color)
684. 
685. 
686. def test_legend_pathcollection_labelcolor_linecolor_iterable():
687.     # test the labelcolor for labelcolor='linecolor' on PathCollection
688.     # with iterable colors
689.     fig, ax = plt.subplots()
690.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
691.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c=colors)
692. 
693.     leg = ax.legend(labelcolor='linecolor')
694.     text, = leg.get_texts()
695.     assert mpl.colors.same_color(text.get_color(), 'black')
696. 
697. 
698. def test_legend_pathcollection_labelcolor_linecolor_cmap():
699.     # test the labelcolor for labelcolor='linecolor' on PathCollection
700.     # with a colormap
701.     fig, ax = plt.subplots()
702.     ax.scatter(np.arange(10), np.arange(10), c=np.arange(10), label='#1')
703. 
704.     leg = ax.legend(labelcolor='linecolor')
705.     text, = leg.get_texts()
706.     assert mpl.colors.same_color(text.get_color(), 'black')
707. 
708. 
709. def test_legend_labelcolor_markeredgecolor():
710.     # test the labelcolor for labelcolor='markeredgecolor'
711.     fig, ax = plt.subplots()
712.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
713.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
714.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
715. 
716.     leg = ax.legend(labelcolor='markeredgecolor')
717.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
718.         assert mpl.colors.same_color(text.get_color(), color)
719. 
720. 
721. def test_legend_pathcollection_labelcolor_markeredgecolor():
722.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
723.     fig, ax = plt.subplots()
724.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor='r')
725.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', edgecolor='g')
726.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', edgecolor='b')
727. 
728.     leg = ax.legend(labelcolor='markeredgecolor')
729.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
730.         assert mpl.colors.same_color(text.get_color(), color)
731. 
732. 
733. def test_legend_pathcollection_labelcolor_markeredgecolor_iterable():
734.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
735.     # with iterable colors
736.     fig, ax = plt.subplots()
737.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
738.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor=colors)
739. 
740.     leg = ax.legend(labelcolor='markeredgecolor')
741.     for text, color in zip(leg.get_texts(), ['k']):
742.         assert mpl.colors.same_color(text.get_color(), color)
743. 
744. 
745. def test_legend_pathcollection_labelcolor_markeredgecolor_cmap():
746.     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection
747.     # with a colormap
748.     fig, ax = plt.subplots()
749.     edgecolors = mpl.cm.viridis(np.random.rand(10))
750.     ax.scatter(
751.         np.arange(10),
752.         np.arange(10),
753.         label='#1',
754.         c=np.arange(10),
755.         edgecolor=edgecolors,
756.         cmap="Reds"
757.     )
758. 
759.     leg = ax.legend(labelcolor='markeredgecolor')
760.     for text, color in zip(leg.get_texts(), ['k']):
761.         assert mpl.colors.same_color(text.get_color(), color)
762. 
763. 
764. def test_legend_labelcolor_markerfacecolor():
765.     # test the labelcolor for labelcolor='markerfacecolor'
766.     fig, ax = plt.subplots()
767.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
768.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
769.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
770. 
771.     leg = ax.legend(labelcolor='markerfacecolor')
772.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
773.         assert mpl.colors.same_color(text.get_color(), color)
774. 
775. 
776. def test_legend_pathcollection_labelcolor_markerfacecolor():
777.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
778.     fig, ax = plt.subplots()
779.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor='r')
780.     ax.scatter(np.arange(10), np.arange(10)*2, label='#2', facecolor='g')
781.     ax.scatter(np.arange(10), np.arange(10)*3, label='#3', facecolor='b')
782. 
783.     leg = ax.legend(labelcolor='markerfacecolor')
784.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
785.         assert mpl.colors.same_color(text.get_color(), color)
786. 
787. 
788. def test_legend_pathcollection_labelcolor_markerfacecolor_iterable():
789.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
790.     # with iterable colors
791.     fig, ax = plt.subplots()
792.     colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)
793.     ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor=colors)
794. 
795.     leg = ax.legend(labelcolor='markerfacecolor')
796.     for text, color in zip(leg.get_texts(), ['k']):
797.         assert mpl.colors.same_color(text.get_color(), color)
798. 
799. 
800. def test_legend_pathcollection_labelcolor_markfacecolor_cmap():
801.     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection
802.     # with colormaps
803.     fig, ax = plt.subplots()
804.     facecolors = mpl.cm.viridis(np.random.rand(10))
805.     ax.scatter(
806.         np.arange(10),
807.         np.arange(10),
808.         label='#1',
809.         c=np.arange(10),
810.         facecolor=facecolors
811.     )
812. 
813.     leg = ax.legend(labelcolor='markerfacecolor')
814.     for text, color in zip(leg.get_texts(), ['k']):
815.         assert mpl.colors.same_color(text.get_color(), color)
816. 
817. 
818. @pytest.mark.parametrize('color', ('red', 'none', (.5, .5, .5)))
819. def test_legend_labelcolor_rcparam_single(color):
820.     # test the rcParams legend.labelcolor for a single color
821.     fig, ax = plt.subplots()
822.     ax.plot(np.arange(10), np.arange(10)*1, label='#1')
823.     ax.plot(np.arange(10), np.arange(10)*2, label='#2')
824.     ax.plot(np.arange(10), np.arange(10)*3, label='#3')
825. 
826.     mpl.rcParams['legend.labelcolor'] = color
827.     leg = ax.legend()
828.     for text in leg.get_texts():
829.         assert mpl.colors.same_color(text.get_color(), color)
830. 
831. 
832. def test_legend_labelcolor_rcparam_linecolor():
833.     # test the rcParams legend.labelcolor for a linecolor
834.     fig, ax = plt.subplots()
835.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', color='r')
836.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', color='g')
837.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', color='b')
838. 
839.     mpl.rcParams['legend.labelcolor'] = 'linecolor'
840.     leg = ax.legend()
841.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
842.         assert mpl.colors.same_color(text.get_color(), color)
843. 
844. 
845. def test_legend_labelcolor_rcparam_markeredgecolor():
846.     # test the labelcolor for labelcolor='markeredgecolor'
847.     fig, ax = plt.subplots()
848.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
849.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
850.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
851. 
852.     mpl.rcParams['legend.labelcolor'] = 'markeredgecolor'
853.     leg = ax.legend()
854.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
855.         assert mpl.colors.same_color(text.get_color(), color)
856. 
857. 
858. def test_legend_labelcolor_rcparam_markeredgecolor_short():
859.     # test the labelcolor for labelcolor='markeredgecolor'
860.     fig, ax = plt.subplots()
861.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markeredgecolor='r')
862.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markeredgecolor='g')
863.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markeredgecolor='b')
864. 
865.     mpl.rcParams['legend.labelcolor'] = 'mec'
866.     leg = ax.legend()
867.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
868.         assert mpl.colors.same_color(text.get_color(), color)
869. 
870. 
871. def test_legend_labelcolor_rcparam_markerfacecolor():
872.     # test the labelcolor for labelcolor='markeredgecolor'
873.     fig, ax = plt.subplots()
874.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
875.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
876.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
877. 
878.     mpl.rcParams['legend.labelcolor'] = 'markerfacecolor'
879.     leg = ax.legend()
880.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
881.         assert mpl.colors.same_color(text.get_color(), color)
882. 
883. 
884. def test_legend_labelcolor_rcparam_markerfacecolor_short():
885.     # test the labelcolor for labelcolor='markeredgecolor'
886.     fig, ax = plt.subplots()
887.     ax.plot(np.arange(10), np.arange(10)*1, label='#1', markerfacecolor='r')
888.     ax.plot(np.arange(10), np.arange(10)*2, label='#2', markerfacecolor='g')
889.     ax.plot(np.arange(10), np.arange(10)*3, label='#3', markerfacecolor='b')
890. 
891.     mpl.rcParams['legend.labelcolor'] = 'mfc'
892.     leg = ax.legend()
893.     for text, color in zip(leg.get_texts(), ['r', 'g', 'b']):
894.         assert mpl.colors.same_color(text.get_color(), color)
895. 
896. 
897. def test_get_set_draggable():
898.     legend = plt.legend()
899.     assert not legend.get_draggable()
900.     legend.set_draggable(True)
901.     assert legend.get_draggable()
902.     legend.set_draggable(False)
903.     assert not legend.get_draggable()
904. 
905. 
906. @pytest.mark.parametrize('draggable', (True, False))
907. def test_legend_draggable(draggable):
908.     fig, ax = plt.subplots()
909.     ax.plot(range(10), label='shabnams')
910.     leg = ax.legend(draggable=draggable)
911.     assert leg.get_draggable() is draggable
912. 
913. 
914. def test_alpha_handles():
915.     x, n, hh = plt.hist([1, 2, 3], alpha=0.25, label='data', color='red')
916.     legend = plt.legend()
917.     for lh in legend.legendHandles:
918.         lh.set_alpha(1.0)
919.     assert lh.get_facecolor()[:-1] == hh[1].get_facecolor()[:-1]
920.     assert lh.get_edgecolor()[:-1] == hh[1].get_edgecolor()[:-1]
921. 
922. 
923. @needs_usetex
924. def test_usetex_no_warn(caplog):
925.     mpl.rcParams['font.family'] = 'serif'
926.     mpl.rcParams['font.serif'] = 'Computer Modern'
927.     mpl.rcParams['text.usetex'] = True
928. 
929.     fig, ax = plt.subplots()
930.     ax.plot(0, 0, label='input')
931.     ax.legend(title="My legend")
932. 
933.     fig.canvas.draw()
934.     assert "Font family ['serif'] not found." not in caplog.text
935. 
936. 
937. def test_warn_big_data_best_loc():
938.     fig, ax = plt.subplots()
939.     fig.canvas.draw()  # So that we can call draw_artist later.
940.     for idx in range(1000):
941.         ax.plot(np.arange(5000), label=idx)
942.     with rc_context({'legend.loc': 'best'}):
943.         legend = ax.legend()
944.     with pytest.warns(UserWarning) as records:
945.         fig.draw_artist(legend)  # Don't bother drawing the lines -- it's slow.
946.     # The _find_best_position method of Legend is called twice, duplicating
947.     # the warning message.
948.     assert len(records) == 2
949.     for record in records:
950.         assert str(record.message) == (
951.             'Creating legend with loc="best" can be slow with large '
952.             'amounts of data.')
953. 
954. 
955. def test_no_warn_big_data_when_loc_specified():
956.     fig, ax = plt.subplots()
957.     fig.canvas.draw()
958.     for idx in range(1000):
959.         ax.plot(np.arange(5000), label=idx)
960.     legend = ax.legend('best')
961.     fig.draw_artist(legend)  # Check that no warning is emitted.
962. 
963. 
964. @pytest.mark.parametrize('label_array', [['low', 'high'],
965.                                          ('low', 'high'),
966.                                          np.array(['low', 'high'])])
967. def test_plot_multiple_input_multiple_label(label_array):
968.     # test ax.plot() with multidimensional input
969.     # and multiple labels
970.     x = [1, 2, 3]
971.     y = [[1, 2],
972.          [2, 5],
973.          [4, 9]]
974. 
975.     fig, ax = plt.subplots()
976.     ax.plot(x, y, label=label_array)
977.     leg = ax.legend()
978.     legend_texts = [entry.get_text() for entry in leg.get_texts()]
979.     assert legend_texts == ['low', 'high']
980. 
981. 
982. @pytest.mark.parametrize('label', ['one', 1, int])
983. def test_plot_multiple_input_single_label(label):
984.     # test ax.plot() with multidimensional input
985.     # and single label
986.     x = [1, 2, 3]
987.     y = [[1, 2],
988.          [2, 5],
989.          [4, 9]]
990. 
991.     fig, ax = plt.subplots()
992.     ax.plot(x, y, label=label)
993.     leg = ax.legend()
994.     legend_texts = [entry.get_text() for entry in leg.get_texts()]
995.     assert legend_texts == [str(label)] * 2
996. 
997. 
998. @pytest.mark.parametrize('label_array', [['low', 'high'],
999.                                          ('low', 'high'),
1000.                                          np.array(['low', 'high'])])
1001. def test_plot_single_input_multiple_label(label_array):
1002.     # test ax.plot() with 1D array like input
1003.     # and iterable label
1004.     x = [1, 2, 3]
1005.     y = [2, 5, 6]
1006.     fig, ax = plt.subplots()
1007.     ax.plot(x, y, label=label_array)
1008.     leg = ax.legend()
1009.     assert len(leg.get_texts()) == 1
1010.     assert leg.get_texts()[0].get_text() == str(label_array)
1011. 
1012. 
1013. def test_plot_multiple_label_incorrect_length_exception():
1014.     # check that exception is raised if multiple labels
1015.     # are given, but number of on labels != number of lines
1016.     with pytest.raises(ValueError):
1017.         x = [1, 2, 3]
1018.         y = [[1, 2],
1019.              [2, 5],
1020.              [4, 9]]
1021.         label = ['high', 'low', 'medium']
1022.         fig, ax = plt.subplots()
1023.         ax.plot(x, y, label=label)
1024. 
1025. 
1026. def test_legend_face_edgecolor():
1027.     # Smoke test for PolyCollection legend handler with 'face' edgecolor.
1028.     fig, ax = plt.subplots()
1029.     ax.fill_between([0, 1, 2], [1, 2, 3], [2, 3, 4],
1030.                     facecolor='r', edgecolor='face', label='Fill')
1031.     ax.legend()
1032. 
1033. 
1034. def test_legend_text_axes():
1035.     fig, ax = plt.subplots()
1036.     ax.plot([1, 2], [3, 4], label='line')
1037.     leg = ax.legend()
1038. 
1039.     assert leg.axes is ax
1040.     assert leg.get_texts()[0].axes is ax
1041. 
1042. 
1043. def test_handlerline2d():
1044.     # Test marker consistency for monolithic Line2D legend handler (#11357).
1045.     fig, ax = plt.subplots()
1046.     ax.scatter([0, 1], [0, 1], marker="v")
1047.     handles = [mlines.Line2D([0], [0], marker="v")]
1048.     leg = ax.legend(handles, ["Aardvark"], numpoints=1)
1049.     assert handles[0].get_marker() == leg.legendHandles[0].get_marker()
1050. 
1051. 
1052. def test_subfigure_legend():
1053.     # Test that legend can be added to subfigure (#20723)
1054.     subfig = plt.figure().subfigures()
1055.     ax = subfig.subplots()
1056.     ax.plot([0, 1], [0, 1], label="line")
1057.     leg = subfig.legend()
1058.     assert leg.figure is subfig
1059. 
1060. 
1061. def test_setting_alpha_keeps_polycollection_color():
1062.     pc = plt.fill_between([0, 1], [2, 3], color='#123456', label='label')
1063.     patch = plt.legend().get_patches()[0]
1064.     patch.set_alpha(0.5)
1065.     assert patch.get_facecolor()[:3] == tuple(pc.get_facecolor()[0][:3])
1066.     assert patch.get_edgecolor()[:3] == tuple(pc.get_edgecolor()[0][:3])
1067. 
1068. 
1069. def test_legend_markers_from_line2d():
1070.     # Test that markers can be copied for legend lines (#17960)
1071.     _markers = ['.', '*', 'v']
1072.     fig, ax = plt.subplots()
1073.     lines = [mlines.Line2D([0], [0], ls='None', marker=mark)
1074.              for mark in _markers]
1075.     labels = ["foo", "bar", "xyzzy"]
1076.     markers = [line.get_marker() for line in lines]
1077.     legend = ax.legend(lines, labels)
1078. 
1079.     new_markers = [line.get_marker() for line in legend.get_lines()]
1080.     new_labels = [text.get_text() for text in legend.get_texts()]
1081. 
1082.     assert markers == new_markers == _markers
1083.     assert labels == new_labels
1084. 
1085. 
1086. @check_figures_equal()
1087. def test_ncol_ncols(fig_test, fig_ref):
1088.     # Test that both ncol and ncols work
1089.     strings = ["a", "b", "c", "d", "e", "f"]
1090.     ncols = 3
1091.     fig_test.legend(strings, ncol=ncols)
1092.     fig_ref.legend(strings, ncols=ncols)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 01:10:01,416 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is looking for test cases within `lib/matplotlib/tests/test_legend.py` that involve creating a legend and then clearing the parent axes using `cla()` or `clear()`.\n   - This is to understand the behavior of legends when an axes is cleared.\n\n2. Context evaluation:\n   - A direct search for `cla()` or `clear()` within the provided file content shows no occurrences. Therefore, there are no tests that exactly match the user's description.\n   - However, the `test_legend_remove` function is highly relevant. When an axes is cleared (e.g., via `ax.cla()`), it calls the `remove()` method on the legend artist associated with it.\n   - This test specifically covers the `remove()` functionality for a legend and asserts that the legend is properly detached from the axes (`ax.get_legend() is None`), which is the core of the behavior the user wants to investigate.", relative_path='lib/matplotlib/tests/test_legend.py', start_line=230, end_line=239)]
2025-12-21 01:10:01,417 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `lib/matplotlib/tests/test_legend.py`.
2025-12-21 01:10:01,417 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 01:10:01,417 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 01:10:01,418 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 8 existing contexts
2025-12-21 01:10:01,418 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 9 total contexts (removed 0 duplicates)
2025-12-21 01:10:01,418 - thread-131294958716608.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-21 01:10:01,419 - thread-131294958716608.prometheus_context_collector - INFO - Successfully retrieved 9 context snippets
