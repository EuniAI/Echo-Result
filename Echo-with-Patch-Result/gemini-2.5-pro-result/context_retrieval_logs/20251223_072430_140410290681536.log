2025-12-23 07:24:30,590 - thread-140410290681536.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: linkcheck could also check local (internal) links

Description: Subject: linkcheck currently doesn't check local (internal) links, but this would be useful.

<!--
  Important: This is a list of issues for Sphinx, not a forum.
  If you'd like to post a question, please move to sphinx-users group.
  https://groups.google.com/forum/#!forum/sphinx-users

  Thanks,
-->

### Problem
See above.

#### Procedure to reproduce the problem
Create a template project with sphinx-quickstart, put the following in index.rst
```
broken external-link_
broken local-link_

.. _external-link: https://lkfqhlkghflkhs
.. _local-link: doesntexist
```

Run `make linkcheck`

#### Error logs / results
```
Running Sphinx v1.7.6
making output directory...
loading pickled environment... done
building [mo]: targets for 0 po files that are out of date
building [linkcheck]: targets for 1 source files that are out of date
updating environment: 0 added, 0 changed, 0 removed
looking for now-outdated files... none found
preparing documents... done
writing output... [100%] index                                                                   
(line   14) -local-   doesntexist
(line   14) broken    https://lkfqhlkghflkhs - HTTPSConnectionPool(host='lkfqhlkghflkhs', port=443): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x7faed7ddfc88>: Failed to establish a new connection: [Errno -2] Name or service not known',))

build finished with problems.
make: *** [Makefile:20: linkcheck] Error 1
```

#### Expected results
Also a check for the local link.

### Reproducible project / your project
N/A

### Environment info
- OS: Arch Linux
- Python version: 3.6
- Sphinx version: 1.7.6


Patch information:
diff --git a/doc/usage/builders/index.rst b/doc/usage/builders/index.rst
index db6706944..c860a2517 100644
--- a/doc/usage/builders/index.rst
+++ b/doc/usage/builders/index.rst
@@ -428,9 +428,11 @@ name is ``rinoh``. Refer to the `rinohtype manual`_ for details.
 .. module:: sphinx.builders.linkcheck
 .. class:: CheckExternalLinksBuilder
 
-   This builder scans all documents for external links, tries to open them with
-   ``requests``, and writes an overview which ones are broken and redirected to
-   standard output and to :file:`output.txt` in the output directory.
+   This builder scans all documents for external HTTP(S) links and local
+   links. External links are tried to open with ``requests`` while local
+   links are checked for existence on disk. It writes an overview which
+   ones are broken and redirected to standard output and to :file:`output.txt`
+   in the output directory.
 
    .. autoattribute:: name
 
diff --git a/sphinx/builders/linkcheck.py b/sphinx/builders/linkcheck.py
index dd5317087..c159b273f 100644
--- a/sphinx/builders/linkcheck.py
+++ b/sphinx/builders/linkcheck.py
@@ -77,7 +77,11 @@ def check_anchor(response: requests.requests.Response, anchor: str) -> bool:
 
 class CheckExternalLinksBuilder(Builder):
     """
-    Checks for broken external links.
+    Checks for broken links.
+
+    This builder scans all documents for external HTTP(S) links and local
+    (internal) links. External links are validated via HTTP requests, and
+    local links are checked for existence on disk.
     """
     name = 'linkcheck'
     epilog = __('Look for any errors in the above output or in '
@@ -213,7 +217,17 @@ class CheckExternalLinksBuilder(Builder):
             if len(uri) == 0 or uri.startswith(('#', 'mailto:', 'ftp:')):
                 return 'unchecked', '', 0
             elif not uri.startswith(('http:', 'https:')):
-                return 'local', '', 0
+                # Check local (internal) links by resolving against the document path
+                local_uri = uri.split('#', 1)[0] if '#' in uri else uri
+                try:
+                    rel_fn, abs_fn = self.env.relfn2path(local_uri, docname)
+                except Exception:
+                    # If resolution fails, consider as broken
+                    return 'broken', __("Local path could not be resolved: %s") % local_uri, 0
+                if path.exists(abs_fn):
+                    return 'working', '', 0
+                else:
+                    return 'broken', __("Local path not found: %s") % rel_fn, 0
             elif uri in self.good:
                 return 'working', 'old', 0
             elif uri in self.broken:
@@ -324,7 +338,7 @@ class CheckExternalLinksBuilder(Builder):
         # image nodes
         for imgnode in doctree.traverse(nodes.image):
             uri = imgnode['candidates'].get('?')
-            if uri and '://' in uri:
+            if uri:
                 lineno = get_node_line(imgnode)
                 self.wqueue.put((uri, docname, lineno), False)
                 n += 1


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 07:24:30,705 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── lint.yml
|       └── main.yml
├── .travis.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   └── themes
|   |       └── fullsize
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── develop.rst
|   ├── development
|   |   ├── index.rst
|   |   └── tutorials
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   ├── theming.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── applehelp.py
|   |   ├── changes.py
|   |   ├── devhelp.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── htmlhelp.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── qthelp.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── indexentries.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── jsmath.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── jssplitter.py
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.3.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── jsonimpl.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── conftest.py
|   ├── js
|   |   └── doctools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── semicolon.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── bound_method.py
|   |   |       ├── callable.py
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── enum.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── genericalias.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── methods.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_pycompat.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   └── typing_test_data.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    ├── checks.py
    ├── doclinter.py
    └── jssplitter_generator.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: linkcheck could also check local (internal) links

Description: Subject: linkcheck currently doesn't check local (internal) links, but this would be useful.

<!--
  Important: This is a list of issues for Sphinx, not a forum.
  If you'd like to post a question, please move to sphinx-users group.
  https://groups.google.com/forum/#!forum/sphinx-users

  Thanks,
-->

### Problem
See above.

#### Procedure to reproduce the problem
Create a template project with sphinx-quickstart, put the following in index.rst
```
broken external-link_
broken local-link_

.. _external-link: https://lkfqhlkghflkhs
.. _local-link: doesntexist
```

Run `make linkcheck`

#### Error logs / results
```
Running Sphinx v1.7.6
making output directory...
loading pickled environment... done
building [mo]: targets for 0 po files that are out of date
building [linkcheck]: targets for 1 source files that are out of date
updating environment: 0 added, 0 changed, 0 removed
looking for now-outdated files... none found
preparing documents... done
writing output... [100%] index                                                                   
(line   14) -local-   doesntexist
(line   14) broken    https://lkfqhlkghflkhs - HTTPSConnectionPool(host='lkfqhlkghflkhs', port=443): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x7faed7ddfc88>: Failed to establish a new connection: [Errno -2] Name or service not known',))

build finished with problems.
make: *** [Makefile:20: linkcheck] Error 1
```

#### Expected results
Also a check for the local link.

### Reproducible project / your project
N/A

### Environment info
- OS: Arch Linux
- Python version: 3.6
- Sphinx version: 1.7.6


Patch information:
diff --git a/doc/usage/builders/index.rst b/doc/usage/builders/index.rst
index db6706944..c860a2517 100644
--- a/doc/usage/builders/index.rst
+++ b/doc/usage/builders/index.rst
@@ -428,9 +428,11 @@ name is ``rinoh``. Refer to the `rinohtype manual`_ for details.
 .. module:: sphinx.builders.linkcheck
 .. class:: CheckExternalLinksBuilder
 
-   This builder scans all documents for external links, tries to open them with
-   ``requests``, and writes an overview which ones are broken and redirected to
-   standard output and to :file:`output.txt` in the output directory.
+   This builder scans all documents for external HTTP(S) links and local
+   links. External links are tried to open with ``requests`` while local
+   links are checked for existence on disk. It writes an overview which
+   ones are broken and redirected to standard output and to :file:`output.txt`
+   in the output directory.
 
    .. autoattribute:: name
 
diff --git a/sphinx/builders/linkcheck.py b/sphinx/builders/linkcheck.py
index dd5317087..c159b273f 100644
--- a/sphinx/builders/linkcheck.py
+++ b/sphinx/builders/linkcheck.py
@@ -77,7 +77,11 @@ def check_anchor(response: requests.requests.Response, anchor: str) -> bool:
 
 class CheckExternalLinksBuilder(Builder):
     """
-    Checks for broken external links.
+    Checks for broken links.
+
+    This builder scans all documents for external HTTP(S) links and local
+    (internal) links. External links are validated via HTTP requests, and
+    local links are checked for existence on disk.
     """
     name = 'linkcheck'
     epilog = __('Look for any errors in the above output or in '
@@ -213,7 +217,17 @@ class CheckExternalLinksBuilder(Builder):
             if len(uri) == 0 or uri.startswith(('#', 'mailto:', 'ftp:')):
                 return 'unchecked', '', 0
             elif not uri.startswith(('http:', 'https:')):
-                return 'local', '', 0
+                # Check local (internal) links by resolving against the document path
+                local_uri = uri.split('#', 1)[0] if '#' in uri else uri
+                try:
+                    rel_fn, abs_fn = self.env.relfn2path(local_uri, docname)
+                except Exception:
+                    # If resolution fails, consider as broken
+                    return 'broken', __("Local path could not be resolved: %s") % local_uri, 0
+                if path.exists(abs_fn):
+                    return 'working', '', 0
+                else:
+                    return 'broken', __("Local path not found: %s") % rel_fn, 0
             elif uri in self.good:
                 return 'working', 'old', 0
             elif uri in self.broken:
@@ -324,7 +338,7 @@ class CheckExternalLinksBuilder(Builder):
         # image nodes
         for imgnode in doctree.traverse(nodes.image):
             uri = imgnode['candidates'].get('?')
-            if uri and '://' in uri:
+            if uri:
                 lineno = get_node_line(imgnode)
                 self.wqueue.put((uri, docname, lineno), False)
                 n += 1


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 07:24:52,862 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='To find relevant test cases for the `linkcheck` builder, I need to examine its existing tests. The primary test file is `tests/test_build_linkcheck.py`, and its corresponding test data is in `tests/roots/test-linkcheck/`. I need the content of these files to understand the test structure, inputs, and assertions, which are currently missing from the context.' query='Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.' extra_requirements='' purpose='This information is necessary to identify existing test cases that are relevant to the bug report concerning the checking of local links.'
2025-12-23 07:24:52,863 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.
2025-12-23 07:24:52,863 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 07:24:52,864 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 07:24:52,864 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 07:24:52,865 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.
Purpose: This information is necessary to identify existing test cases that are relevant to the bug report concerning the checking of local links.
2025-12-23 07:24:56,166 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/roots/test-linkcheck/conf.py"}'}, '__gemini_function_call_thought_signatures__': {'db8577bd-3bc1-4a38-910c-5b63355b8824': 'CrkEAY89a19F87HTmZAXF7FzNehcUa+0Ao+58Ct68P2LolFcEhJtVOTRRBsW0gv7IaMdfyobKutELeaL7qgjp+VHiiftqqBvWP03ePRgcNPuBeWa5budrvoxpuYVIIWKUAlEncXyXW8Rioul6CsoO/YcJreukIBGEJteLyy1O9/t5fPcB8M0KIqTXPegtIdcx55y72ivCam63FoRAegb7aOsen0/dBukov2EG/pwM2O8sR0cb+fix2KSbRVkeNxUtMcZQ1pWBYcw8L6KPzt3Vj+2jZ2BI+S+PF5X0LC6p+dFlt2ZyGsGp/yz2QHslKGWfU+qG7zn8a1PGmYeZxI4aYanmymTCdAe/Zt4RlzSca7CIJT3mZaZ7oKDo7sHn1cfPL0wvOl0OidvLFmJBLNeP2Me/Zu/lZI+2tYhEuAo7V+xmZRXJTyL4wdzWTm/80A5i+Z//Z5p4vi5flH5wBcAeEEcoR31Kqz4iOp02d/Zuy/8ZJInSLhcwQAhTw1h03zmyVbS00l9JQjYp8v9hG/u4NoREGR38Ymve19E+PJXHLwbXKBgTSbz1W6db9OwUyyOfioB5PQ/UnvdaTvNre6PyA4BI07zORPtQ0gLOZv3FXmi0PqWRlkVpXuAaA2/u3xnO3ZOmqyh8CSdXItSEWgSjhgVkx6WO0pAgpSYfKPxpxlxqDzOR52U4Kl9+HvwlnYvV10rEx0vGPjENOn0Rkb/CKB7dcmV6/7oBcTxJj5O1nT0rtBEcbS1WGEe0KIKIgGPPWtfUF/+oemFj8S99Cryl6tejXcgX68ICDlId0FbdqM='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2105, 'candidates_token_count': 76, 'total_token_count': 2363, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2105}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 182, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.028184755852347927, 'model_name': 'gemini-2.5-pro'} id='run--24977154-10dc-4eaa-afbd-4c2da8bc28fd-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_build_linkcheck.py'}, 'id': 'db8577bd-3bc1-4a38-910c-5b63355b8824', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-linkcheck/links.txt'}, 'id': 'e0bc49be-6679-4453-af80-df8a4f72e1d5', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-linkcheck/conf.py'}, 'id': '08f00d94-f112-43ee-8197-7f748506e78c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2105, 'output_tokens': 76, 'total_tokens': 2363, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 182}}
2025-12-23 07:24:58,497 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of the three requested test files: `tests/test_build_linkcheck.py`, `tests/roots/test-linkcheck/links.txt`, and `tests/roots/test-linkcheck/conf.py`. These files provide context on existing test cases for the link-checking functionality, which will be useful for addressing the bug report about local link checking.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5325, 'candidates_token_count': 82, 'total_token_count': 5468, 'cached_content_token_count': 1701, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5507}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1701}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 61}, 'finish_reason': 'STOP', 'avg_logprobs': -0.05442036070474764, 'model_name': 'gemini-2.5-pro'} id='run--00dbaeaa-54e9-46a4-93b2-f5f58f19aa23-0' usage_metadata={'input_tokens': 5325, 'output_tokens': 82, 'total_tokens': 5468, 'input_token_details': {'cache_read': 1701}, 'output_token_details': {'reasoning': 61}}
2025-12-23 07:24:58,498 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This information is necessary to identify existing test cases that are relevant to the bug report concerning the checking of local links.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/roots/test-linkcheck/conf.py
Line number range: 1 - 4
Content:
1. master_doc = 'links'
2. source_suffix = '.txt'
3. exclude_patterns = ['_build']
4. linkcheck_anchors = True


File: tests/roots/test-linkcheck/links.txt
Line number range: 1 - 16
Content:
1. This is from CPython documentation.
2. 
3. * Also, if there is a `default namespace <https://www.w3.org/TR/2006/REC-xml-names-20060816/#defaulting>`__, that full URI gets prepended to all of the non-prefixed tags.
4. 
5. * The URL having anchor: `http://www.sphinx-doc.org/en/1.4.8/tutorial.html#install-sphinx`_
6. 
7. Some additional anchors to exercise ignore code
8. 
9. * `Example Bar invalid <https://www.google.com/#!bar>`_
10. * `Example Bar invalid <https://www.google.com#!bar>`_ tests that default ignore anchor of #! does not need to be prefixed with /
11. * `Example Bar invalid <https://www.google.com/#top>`_
12. * `Example anchor invalid <http://www.sphinx-doc.org/en/1.7/intro.html#does-not-exist>`_
13. * `Complete nonsense <https://localhost:7777/doesnotexist>`_
14. 
15. .. image:: https://www.google.com/image.png
16. .. figure:: https://www.google.com/image2.png


File: tests/test_build_linkcheck.py
Line number range: 1 - 159
Content:
1. """
2.     test_build_linkcheck
3.     ~~~~~~~~~~~~~~~~~~~~
4. 
5.     Test the build process with manpage builder with the test root.
6. 
7.     :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import json
12. import re
13. from unittest import mock
14. import pytest
15. 
16. 
17. @pytest.mark.sphinx('linkcheck', testroot='linkcheck', freshenv=True)
18. def test_defaults(app, status, warning):
19.     app.builder.build_all()
20. 
21.     assert (app.outdir / 'output.txt').exists()
22.     content = (app.outdir / 'output.txt').read_text()
23. 
24.     print(content)
25.     # looking for '#top' and '#does-not-exist' not found should fail
26.     assert "Anchor 'top' not found" in content
27.     assert "Anchor 'does-not-exist' not found" in content
28.     # looking for non-existent URL should fail
29.     assert " Max retries exceeded with url: /doesnotexist" in content
30.     # images should fail
31.     assert "Not Found for url: https://www.google.com/image.png" in content
32.     assert "Not Found for url: https://www.google.com/image2.png" in content
33.     assert len(content.splitlines()) == 5
34. 
35. 
36. @pytest.mark.sphinx('linkcheck', testroot='linkcheck', freshenv=True)
37. def test_defaults_json(app, status, warning):
38.     app.builder.build_all()
39. 
40.     assert (app.outdir / 'output.json').exists()
41.     content = (app.outdir / 'output.json').read_text()
42.     print(content)
43. 
44.     rows = [json.loads(x) for x in content.splitlines()]
45.     row = rows[0]
46.     for attr in ["filename", "lineno", "status", "code", "uri",
47.                  "info"]:
48.         assert attr in row
49. 
50.     assert len(content.splitlines()) == 8
51.     assert len(rows) == 8
52.     # the output order of the rows is not stable
53.     # due to possible variance in network latency
54.     rowsby = {row["uri"]:row for row in rows}
55.     assert rowsby["https://www.google.com#!bar"] == {
56.         'filename': 'links.txt',
57.         'lineno': 10,
58.         'status': 'working',
59.         'code': 0,
60.         'uri': 'https://www.google.com#!bar',
61.         'info': ''
62.     }
63.     # looking for non-existent URL should fail
64.     dnerow = rowsby['https://localhost:7777/doesnotexist']
65.     assert dnerow['filename'] == 'links.txt'
66.     assert dnerow['lineno'] == 13
67.     assert dnerow['status'] == 'broken'
68.     assert dnerow['code'] == 0
69.     assert dnerow['uri'] == 'https://localhost:7777/doesnotexist'
70.     assert rowsby['https://www.google.com/image2.png'] == {
71.         'filename': 'links.txt',
72.         'lineno': 16,
73.         'status': 'broken',
74.         'code': 0,
75.         'uri': 'https://www.google.com/image2.png',
76.         'info': '404 Client Error: Not Found for url: https://www.google.com/image2.png'
77.     }
78.     # looking for '#top' and '#does-not-exist' not found should fail
79.     assert "Anchor 'top' not found" == \
80.         rowsby["https://www.google.com/#top"]["info"]
81.     assert "Anchor 'does-not-exist' not found" == \
82.         rowsby["http://www.sphinx-doc.org/en/1.7/intro.html#does-not-exist"]["info"]
83.     # images should fail
84.     assert "Not Found for url: https://www.google.com/image.png" in \
85.         rowsby["https://www.google.com/image.png"]["info"]
86. 
87. 
88. @pytest.mark.sphinx(
89.     'linkcheck', testroot='linkcheck', freshenv=True,
90.     confoverrides={'linkcheck_anchors_ignore': ["^!", "^top$"],
91.                    'linkcheck_ignore': [
92.                        'https://localhost:7777/doesnotexist',
93.                        'http://www.sphinx-doc.org/en/1.7/intro.html#',
94.                        'https://www.google.com/image.png',
95.                        'https://www.google.com/image2.png']
96.                    })
97. def test_anchors_ignored(app, status, warning):
98.     app.builder.build_all()
99. 
100.     assert (app.outdir / 'output.txt').exists()
101.     content = (app.outdir / 'output.txt').read_text()
102. 
103.     # expect all ok when excluding #top
104.     assert not content
105. 
106. 
107. @pytest.mark.sphinx(
108.     'linkcheck', testroot='linkcheck', freshenv=True,
109.     confoverrides={'linkcheck_auth': [
110.                         (r'.+google\.com/image.+', 'authinfo1'),
111.                         (r'.+google\.com.+', 'authinfo2'),
112.                    ]
113.                   })
114. def test_auth(app, status, warning):
115.     mock_req = mock.MagicMock()
116.     mock_req.return_value = 'fake-response'
117. 
118.     with mock.patch.multiple('requests', get=mock_req, head=mock_req):
119.         app.builder.build_all()
120.         for c_args, c_kwargs in mock_req.call_args_list:
121.             if 'google.com/image' in c_args[0]:
122.                 assert c_kwargs['auth'] == 'authinfo1'
123.             elif 'google.com' in c_args[0]:
124.                 assert c_kwargs['auth'] == 'authinfo2'
125.             else:
126.                 assert not c_kwargs['auth']
127. 
128. 
129. @pytest.mark.sphinx(
130.     'linkcheck', testroot='linkcheck', freshenv=True,
131.     confoverrides={'linkcheck_request_headers': {
132.         "https://localhost:7777/": {
133.             "Accept": "text/html",
134.         },
135.         "http://www.sphinx-doc.org": {  # no slash at the end
136.             "Accept": "application/json",
137.         },
138.         "*": {
139.             "X-Secret": "open sesami",
140.         }
141.     }})
142. def test_linkcheck_request_headers(app, status, warning):
143.     mock_req = mock.MagicMock()
144.     mock_req.return_value = 'fake-response'
145. 
146.     with mock.patch.multiple('requests', get=mock_req, head=mock_req):
147.         app.builder.build_all()
148.         for args, kwargs in mock_req.call_args_list:
149.             url = args[0]
150.             headers = kwargs.get('headers', {})
151.             if "https://localhost:7777" in url:
152.                 assert headers["Accept"] == "text/html"
153.             elif 'http://www.sphinx-doc.org' in url:
154.                 assert headers["Accept"] == "application/json"
155.             elif 'https://www.google.com' in url:
156.                 assert headers["Accept"] == "text/html,application/xhtml+xml;q=0.9,*/*;q=0.8"
157.                 assert headers["X-Secret"] == "open sesami"
158.             else:
159.                 assert headers["Accept"] == "text/html,application/xhtml+xml;q=0.9,*/*;q=0.8"

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 07:25:06,850 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user query explicitly asks for the full content of `tests/test_build_linkcheck.py`.\n2. Extended relevance:\n   - This file is a primary test file for the linkcheck builder and contains various test cases that are directly relevant to understanding how link checking is tested in the codebase.', relative_path='tests/test_build_linkcheck.py', start_line=1, end_line=159), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user query explicitly asks for the full content of `tests/roots/test-linkcheck/links.txt`.\n2. Extended relevance:\n   - This file is a test dependency for `tests/test_build_linkcheck.py`. It provides the source document with the links that are tested, which is essential for understanding the test cases.', relative_path='tests/roots/test-linkcheck/links.txt', start_line=1, end_line=16), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user query explicitly asks for the full content of `tests/roots/test-linkcheck/conf.py`.\n2. Extended relevance:\n   - This file provides the configuration for the Sphinx project used in the `test-linkcheck` tests. This configuration is essential for understanding the environment and settings under which the link checking tests are run.', relative_path='tests/roots/test-linkcheck/conf.py', start_line=1, end_line=4)]
2025-12-23 07:25:06,852 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.
2025-12-23 07:25:06,852 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 07:25:06,852 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 07:25:06,853 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 0 existing contexts
2025-12-23 07:25:06,853 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-23 07:25:06,853 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── lint.yml
|       └── main.yml
├── .travis.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   └── themes
|   |       └── fullsize
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── develop.rst
|   ├── development
|   |   ├── index.rst
|   |   └── tutorials
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   ├── theming.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── applehelp.py
|   |   ├── changes.py
|   |   ├── devhelp.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── htmlhelp.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── qthelp.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── indexentries.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── jsmath.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── jssplitter.py
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.3.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── jsonimpl.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── conftest.py
|   ├── js
|   |   └── doctools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── semicolon.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── bound_method.py
|   |   |       ├── callable.py
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── enum.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── genericalias.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── methods.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_pycompat.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   └── typing_test_data.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    ├── checks.py
    ├── doclinter.py
    └── jssplitter_generator.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: linkcheck could also check local (internal) links

Description: Subject: linkcheck currently doesn't check local (internal) links, but this would be useful.

<!--
  Important: This is a list of issues for Sphinx, not a forum.
  If you'd like to post a question, please move to sphinx-users group.
  https://groups.google.com/forum/#!forum/sphinx-users

  Thanks,
-->

### Problem
See above.

#### Procedure to reproduce the problem
Create a template project with sphinx-quickstart, put the following in index.rst
```
broken external-link_
broken local-link_

.. _external-link: https://lkfqhlkghflkhs
.. _local-link: doesntexist
```

Run `make linkcheck`

#### Error logs / results
```
Running Sphinx v1.7.6
making output directory...
loading pickled environment... done
building [mo]: targets for 0 po files that are out of date
building [linkcheck]: targets for 1 source files that are out of date
updating environment: 0 added, 0 changed, 0 removed
looking for now-outdated files... none found
preparing documents... done
writing output... [100%] index                                                                   
(line   14) -local-   doesntexist
(line   14) broken    https://lkfqhlkghflkhs - HTTPSConnectionPool(host='lkfqhlkghflkhs', port=443): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x7faed7ddfc88>: Failed to establish a new connection: [Errno -2] Name or service not known',))

build finished with problems.
make: *** [Makefile:20: linkcheck] Error 1
```

#### Expected results
Also a check for the local link.

### Reproducible project / your project
N/A

### Environment info
- OS: Arch Linux
- Python version: 3.6
- Sphinx version: 1.7.6


Patch information:
diff --git a/doc/usage/builders/index.rst b/doc/usage/builders/index.rst
index db6706944..c860a2517 100644
--- a/doc/usage/builders/index.rst
+++ b/doc/usage/builders/index.rst
@@ -428,9 +428,11 @@ name is ``rinoh``. Refer to the `rinohtype manual`_ for details.
 .. module:: sphinx.builders.linkcheck
 .. class:: CheckExternalLinksBuilder
 
-   This builder scans all documents for external links, tries to open them with
-   ``requests``, and writes an overview which ones are broken and redirected to
-   standard output and to :file:`output.txt` in the output directory.
+   This builder scans all documents for external HTTP(S) links and local
+   links. External links are tried to open with ``requests`` while local
+   links are checked for existence on disk. It writes an overview which
+   ones are broken and redirected to standard output and to :file:`output.txt`
+   in the output directory.
 
    .. autoattribute:: name
 
diff --git a/sphinx/builders/linkcheck.py b/sphinx/builders/linkcheck.py
index dd5317087..c159b273f 100644
--- a/sphinx/builders/linkcheck.py
+++ b/sphinx/builders/linkcheck.py
@@ -77,7 +77,11 @@ def check_anchor(response: requests.requests.Response, anchor: str) -> bool:
 
 class CheckExternalLinksBuilder(Builder):
     """
-    Checks for broken external links.
+    Checks for broken links.
+
+    This builder scans all documents for external HTTP(S) links and local
+    (internal) links. External links are validated via HTTP requests, and
+    local links are checked for existence on disk.
     """
     name = 'linkcheck'
     epilog = __('Look for any errors in the above output or in '
@@ -213,7 +217,17 @@ class CheckExternalLinksBuilder(Builder):
             if len(uri) == 0 or uri.startswith(('#', 'mailto:', 'ftp:')):
                 return 'unchecked', '', 0
             elif not uri.startswith(('http:', 'https:')):
-                return 'local', '', 0
+                # Check local (internal) links by resolving against the document path
+                local_uri = uri.split('#', 1)[0] if '#' in uri else uri
+                try:
+                    rel_fn, abs_fn = self.env.relfn2path(local_uri, docname)
+                except Exception:
+                    # If resolution fails, consider as broken
+                    return 'broken', __("Local path could not be resolved: %s") % local_uri, 0
+                if path.exists(abs_fn):
+                    return 'working', '', 0
+                else:
+                    return 'broken', __("Local path not found: %s") % rel_fn, 0
             elif uri in self.good:
                 return 'working', 'old', 0
             elif uri in self.broken:
@@ -324,7 +338,7 @@ class CheckExternalLinksBuilder(Builder):
         # image nodes
         for imgnode in doctree.traverse(nodes.image):
             uri = imgnode['candidates'].get('?')
-            if uri and '://' in uri:
+            if uri:
                 lineno = get_node_line(imgnode)
                 self.wqueue.put((uri, docname, lineno), False)
                 n += 1


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.
Extra Requirements: 
Purpose: This information is necessary to identify existing test cases that are relevant to the bug report concerning the checking of local links.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/roots/test-linkcheck/conf.py
Line number range: 1 - 4
Content:
1. master_doc = 'links'
2. source_suffix = '.txt'
3. exclude_patterns = ['_build']
4. linkcheck_anchors = True


File: tests/roots/test-linkcheck/links.txt
Line number range: 1 - 16
Content:
1. This is from CPython documentation.
2. 
3. * Also, if there is a `default namespace <https://www.w3.org/TR/2006/REC-xml-names-20060816/#defaulting>`__, that full URI gets prepended to all of the non-prefixed tags.
4. 
5. * The URL having anchor: `http://www.sphinx-doc.org/en/1.4.8/tutorial.html#install-sphinx`_
6. 
7. Some additional anchors to exercise ignore code
8. 
9. * `Example Bar invalid <https://www.google.com/#!bar>`_
10. * `Example Bar invalid <https://www.google.com#!bar>`_ tests that default ignore anchor of #! does not need to be prefixed with /
11. * `Example Bar invalid <https://www.google.com/#top>`_
12. * `Example anchor invalid <http://www.sphinx-doc.org/en/1.7/intro.html#does-not-exist>`_
13. * `Complete nonsense <https://localhost:7777/doesnotexist>`_
14. 
15. .. image:: https://www.google.com/image.png
16. .. figure:: https://www.google.com/image2.png


File: tests/test_build_linkcheck.py
Line number range: 1 - 159
Content:
1. """
2.     test_build_linkcheck
3.     ~~~~~~~~~~~~~~~~~~~~
4. 
5.     Test the build process with manpage builder with the test root.
6. 
7.     :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import json
12. import re
13. from unittest import mock
14. import pytest
15. 
16. 
17. @pytest.mark.sphinx('linkcheck', testroot='linkcheck', freshenv=True)
18. def test_defaults(app, status, warning):
19.     app.builder.build_all()
20. 
21.     assert (app.outdir / 'output.txt').exists()
22.     content = (app.outdir / 'output.txt').read_text()
23. 
24.     print(content)
25.     # looking for '#top' and '#does-not-exist' not found should fail
26.     assert "Anchor 'top' not found" in content
27.     assert "Anchor 'does-not-exist' not found" in content
28.     # looking for non-existent URL should fail
29.     assert " Max retries exceeded with url: /doesnotexist" in content
30.     # images should fail
31.     assert "Not Found for url: https://www.google.com/image.png" in content
32.     assert "Not Found for url: https://www.google.com/image2.png" in content
33.     assert len(content.splitlines()) == 5
34. 
35. 
36. @pytest.mark.sphinx('linkcheck', testroot='linkcheck', freshenv=True)
37. def test_defaults_json(app, status, warning):
38.     app.builder.build_all()
39. 
40.     assert (app.outdir / 'output.json').exists()
41.     content = (app.outdir / 'output.json').read_text()
42.     print(content)
43. 
44.     rows = [json.loads(x) for x in content.splitlines()]
45.     row = rows[0]
46.     for attr in ["filename", "lineno", "status", "code", "uri",
47.                  "info"]:
48.         assert attr in row
49. 
50.     assert len(content.splitlines()) == 8
51.     assert len(rows) == 8
52.     # the output order of the rows is not stable
53.     # due to possible variance in network latency
54.     rowsby = {row["uri"]:row for row in rows}
55.     assert rowsby["https://www.google.com#!bar"] == {
56.         'filename': 'links.txt',
57.         'lineno': 10,
58.         'status': 'working',
59.         'code': 0,
60.         'uri': 'https://www.google.com#!bar',
61.         'info': ''
62.     }
63.     # looking for non-existent URL should fail
64.     dnerow = rowsby['https://localhost:7777/doesnotexist']
65.     assert dnerow['filename'] == 'links.txt'
66.     assert dnerow['lineno'] == 13
67.     assert dnerow['status'] == 'broken'
68.     assert dnerow['code'] == 0
69.     assert dnerow['uri'] == 'https://localhost:7777/doesnotexist'
70.     assert rowsby['https://www.google.com/image2.png'] == {
71.         'filename': 'links.txt',
72.         'lineno': 16,
73.         'status': 'broken',
74.         'code': 0,
75.         'uri': 'https://www.google.com/image2.png',
76.         'info': '404 Client Error: Not Found for url: https://www.google.com/image2.png'
77.     }
78.     # looking for '#top' and '#does-not-exist' not found should fail
79.     assert "Anchor 'top' not found" == \
80.         rowsby["https://www.google.com/#top"]["info"]
81.     assert "Anchor 'does-not-exist' not found" == \
82.         rowsby["http://www.sphinx-doc.org/en/1.7/intro.html#does-not-exist"]["info"]
83.     # images should fail
84.     assert "Not Found for url: https://www.google.com/image.png" in \
85.         rowsby["https://www.google.com/image.png"]["info"]
86. 
87. 
88. @pytest.mark.sphinx(
89.     'linkcheck', testroot='linkcheck', freshenv=True,
90.     confoverrides={'linkcheck_anchors_ignore': ["^!", "^top$"],
91.                    'linkcheck_ignore': [
92.                        'https://localhost:7777/doesnotexist',
93.                        'http://www.sphinx-doc.org/en/1.7/intro.html#',
94.                        'https://www.google.com/image.png',
95.                        'https://www.google.com/image2.png']
96.                    })
97. def test_anchors_ignored(app, status, warning):
98.     app.builder.build_all()
99. 
100.     assert (app.outdir / 'output.txt').exists()
101.     content = (app.outdir / 'output.txt').read_text()
102. 
103.     # expect all ok when excluding #top
104.     assert not content
105. 
106. 
107. @pytest.mark.sphinx(
108.     'linkcheck', testroot='linkcheck', freshenv=True,
109.     confoverrides={'linkcheck_auth': [
110.                         (r'.+google\.com/image.+', 'authinfo1'),
111.                         (r'.+google\.com.+', 'authinfo2'),
112.                    ]
113.                   })
114. def test_auth(app, status, warning):
115.     mock_req = mock.MagicMock()
116.     mock_req.return_value = 'fake-response'
117. 
118.     with mock.patch.multiple('requests', get=mock_req, head=mock_req):
119.         app.builder.build_all()
120.         for c_args, c_kwargs in mock_req.call_args_list:
121.             if 'google.com/image' in c_args[0]:
122.                 assert c_kwargs['auth'] == 'authinfo1'
123.             elif 'google.com' in c_args[0]:
124.                 assert c_kwargs['auth'] == 'authinfo2'
125.             else:
126.                 assert not c_kwargs['auth']
127. 
128. 
129. @pytest.mark.sphinx(
130.     'linkcheck', testroot='linkcheck', freshenv=True,
131.     confoverrides={'linkcheck_request_headers': {
132.         "https://localhost:7777/": {
133.             "Accept": "text/html",
134.         },
135.         "http://www.sphinx-doc.org": {  # no slash at the end
136.             "Accept": "application/json",
137.         },
138.         "*": {
139.             "X-Secret": "open sesami",
140.         }
141.     }})
142. def test_linkcheck_request_headers(app, status, warning):
143.     mock_req = mock.MagicMock()
144.     mock_req.return_value = 'fake-response'
145. 
146.     with mock.patch.multiple('requests', get=mock_req, head=mock_req):
147.         app.builder.build_all()
148.         for args, kwargs in mock_req.call_args_list:
149.             url = args[0]
150.             headers = kwargs.get('headers', {})
151.             if "https://localhost:7777" in url:
152.                 assert headers["Accept"] == "text/html"
153.             elif 'http://www.sphinx-doc.org' in url:
154.                 assert headers["Accept"] == "application/json"
155.             elif 'https://www.google.com' in url:
156.                 assert headers["Accept"] == "text/html,application/xhtml+xml;q=0.9,*/*;q=0.8"
157.                 assert headers["X-Secret"] == "open sesami"
158.             else:
159.                 assert headers["Accept"] == "text/html,application/xhtml+xml;q=0.9,*/*;q=0.8"

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 07:25:57,934 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The current context is insufficient as it only contains tests for external links, while the user's request is about adding functionality to check local links. The provided patch explicitly modifies the handling of image links to include local paths. Therefore, to find relevant test cases, I need to examine how local images are tested in other parts of the codebase. The tests for the HTML builder, which handles local images, are the most relevant source of examples." query='Please provide the full content of `tests/test_build_html.py` and the complete contents of the `tests/roots/test-images` directory.' extra_requirements='' purpose="This will provide examples of how local image paths are tested within a builder, which is directly applicable to creating new tests for the linkcheck builder's local link validation feature."
2025-12-23 07:25:57,935 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/test_build_html.py` and the complete contents of the `tests/roots/test-images` directory.
2025-12-23 07:25:57,936 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 07:25:57,936 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 07:25:57,937 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 07:25:57,937 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/test_build_html.py` and the complete contents of the `tests/roots/test-images` directory.
Purpose: This will provide examples of how local image paths are tested within a builder, which is directly applicable to creating new tests for the linkcheck builder's local link validation feature.
2025-12-23 07:26:01,472 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have started by reading the entire content of the `tests/test_build_html.py` file to understand its structure and testing patterns. Next, I will examine the contents of the `tests/roots/test-images` directory to see the image files used in the tests. This will help me understand how local image paths are handled in the existing test suite.' additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "tests/roots/test-images"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2099, 'candidates_token_count': 120, 'total_token_count': 2383, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2099}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 120}], 'thoughts_token_count': 164, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10680271784464518, 'model_name': 'gemini-2.5-pro'} id='run--d0a8cda7-1e8e-4663-b1ee-9006ed37e695-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_build_html.py'}, 'id': 'c3c26731-0762-4e74-abad-a680075c0e17', 'type': 'tool_call'}, {'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'tests/roots/test-images'}, 'id': 'f6e4cb1e-8b48-4257-ba7f-1a932dc50aee', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2099, 'output_tokens': 120, 'total_tokens': 2383, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 164}}
2025-12-23 07:26:07,315 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have examined the `tests/test_build_html.py` file and the `tests/roots/test-images` directory. I will now proceed to read the image files referenced in the test file to understand how they are used. This will provide the necessary context for creating new tests for the linkcheck builder.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/roots/test-images"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12139, 'candidates_token_count': 87, 'total_token_count': 12607, 'cached_content_token_count': 1786, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12139}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1786}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 381}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6717559551370555, 'model_name': 'gemini-2.5-pro'} id='run--b5043eb0-8371-4d33-bc0b-2732dfa80064-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images'}, 'id': '77adb53d-ad17-4ab6-9440-63874f880756', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12139, 'output_tokens': 87, 'total_tokens': 12607, 'input_token_details': {'cache_read': 1786}, 'output_token_details': {'reasoning': 381}}
2025-12-23 07:26:09,173 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the content of `tests/test_build_html.py` and confirmed the existence of the `tests/roots/test-images` directory. My attempt to read the directory as a file resulted in an error, which is expected. I will now list the files within that directory to understand the available test images.' additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "tests/roots/test-images"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12260, 'candidates_token_count': 90, 'total_token_count': 12350, 'cached_content_token_count': 10706, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12260}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10706}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 90}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1025947782728407, 'model_name': 'gemini-2.5-pro'} id='run--a73e9124-d570-4564-96d7-4be0fddacd53-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'tests/roots/test-images'}, 'id': 'fda5ae61-c3f4-4b99-8136-d3d82d35a7da', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12260, 'output_tokens': 90, 'total_tokens': 12350, 'input_token_details': {'cache_read': 10706}}
2025-12-23 07:26:25,596 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed the `tests/test_build_html.py` file and identified the image files referenced within the tests. To provide the complete contents of the `tests/roots/test-images` directory as requested, I will now read each of these image files to confirm their existence and provide their content.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/roots/test-images/rimg.png"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12406, 'candidates_token_count': 193, 'total_token_count': 14028, 'cached_content_token_count': 10694, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12406}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10694}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 193}], 'thoughts_token_count': 1429}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9556377193470693, 'model_name': 'gemini-2.5-pro'} id='run--992ffb9c-3a99-4bf1-9f65-1d98d4b4cfbd-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images/img.png'}, 'id': 'de2b3cfe-cd05-479e-b8a9-02211b85e086', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images/img1.png'}, 'id': '54e62f2e-a7fa-4b77-b250-53ed1c5d95b5', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images/simg.png'}, 'id': '03c74693-64f2-471a-bec4-85c07aeb36c9', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images/svgimg.svg'}, 'id': '05c6061d-025f-4164-a282-4642cdfc14c9', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images/rimg.png'}, 'id': '6c6ae14a-d677-408b-9e45-d77f4e861159', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12406, 'output_tokens': 193, 'total_tokens': 14028, 'input_token_details': {'cache_read': 10694}, 'output_token_details': {'reasoning': 1429}}
2025-12-23 07:26:52,726 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the `tests/test_build_html.py` file to understand how image paths are tested. I tried to read the image files directly, but they were not found at the expected location. I will now try to locate and read the `index.rst` file within the `tests/roots/test-images` directory to understand how the images are referenced in the documentation source. This will help me locate the image files and provide the complete contents of the directory as requested.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/roots/test-images/index.rst"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12748, 'candidates_token_count': 126, 'total_token_count': 15558, 'cached_content_token_count': 10649, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12748}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10649}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 126}], 'thoughts_token_count': 2684}, 'finish_reason': 'STOP', 'avg_logprobs': -3.4382677835131448, 'model_name': 'gemini-2.5-pro'} id='run--7a6d08b9-dec7-413c-9a21-a0a84b53c1e1-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-images/index.rst'}, 'id': 'cb623621-c03f-4a1d-81b2-dc14ac8ab030', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12748, 'output_tokens': 126, 'total_tokens': 15558, 'input_token_details': {'cache_read': 10649}, 'output_token_details': {'reasoning': 2684}}
2025-12-23 07:26:58,187 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have examined the `tests/test_build_html.py` file and the `index.rst` file from the `tests/roots/test-images` directory. It appears the image files referenced in the tests are not present in the `tests/roots/test-images` directory. To resolve this, I will now search for the `test_html5_output` function within `tests/test_build_html.py` to understand how the test environment is configured and where the image files are sourced from during the test.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "tests/test_build_html.py", "text": "def test_html5_output"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13226, 'candidates_token_count': 152, 'total_token_count': 13687, 'cached_content_token_count': 10667, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13226}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10667}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 152}], 'thoughts_token_count': 309}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3700946255734092, 'model_name': 'gemini-2.5-pro'} id='run--1cd91239-7736-4035-995c-7ad5946d2d4a-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'tests/test_build_html.py', 'text': 'def test_html5_output'}, 'id': 'e93f4644-7e89-4694-91f3-893e22ffcaf3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13226, 'output_tokens': 152, 'total_tokens': 13687, 'input_token_details': {'cache_read': 10667}, 'output_token_details': {'reasoning': 309}}
2025-12-23 07:27:06,696 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed the `test_html5_output` function in `tests/test_build_html.py` and the `index.rst` file in `tests/roots/test-images`. It appears the image files are not directly within the `tests/roots/test-images` directory but are instead sourced from a different test root directory during the build process. To provide the complete contents of the `tests/roots/test-images` directory, I will now search for the `images.rst` file to identify the correct test root and locate the image files.' additional_kwargs={'function_call': {'name': 'find_file_node_with_basename', 'arguments': '{"basename": "images.rst"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18749, 'candidates_token_count': 133, 'total_token_count': 19508, 'cached_content_token_count': 12526, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18749}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12526}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 133}], 'thoughts_token_count': 626}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8363368098897145, 'model_name': 'gemini-2.5-pro'} id='run--ad0a5303-809a-44a4-886c-a49b31eadaf6-0' tool_calls=[{'name': 'find_file_node_with_basename', 'args': {'basename': 'images.rst'}, 'id': '6c704628-f17c-4555-9064-722845a44a81', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18749, 'output_tokens': 133, 'total_tokens': 19508, 'input_token_details': {'cache_read': 12526}, 'output_token_details': {'reasoning': 626}}
2025-12-23 07:27:24,948 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have thoroughly investigated the `tests/test_build_html.py` file and the associated test data. My analysis shows that the `test_html5_output` function, which is responsible for testing image handling, does not use the `tests/roots/test-images` directory as its test root. Instead, the test setup implies a different source for the image files. Since I was unable to locate the image files in the expected directory or by searching for related `rst` files, I will now search for the `build_html` directory within `tests/roots`, as this is the likely test root based on pytest conventions. This will help me find the actual image files and fulfill your request.' additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "tests/roots/build_html"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18904, 'candidates_token_count': 167, 'total_token_count': 20705, 'cached_content_token_count': 17887, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18904}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17887}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 167}], 'thoughts_token_count': 1634}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4080163647314745, 'model_name': 'gemini-2.5-pro'} id='run--bc2e3d4b-86b5-4e75-972a-a021e7d51d28-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'tests/roots/build_html'}, 'id': '00bd8ee2-6eb7-4b0f-ba76-e5b17766cef6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18904, 'output_tokens': 167, 'total_tokens': 20705, 'input_token_details': {'cache_read': 17887}, 'output_token_details': {'reasoning': 1634}}
2025-12-23 07:27:47,200 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed `tests/test_build_html.py` and the `tests/roots/test-images` directory. It appears the image files are not located in the `tests/roots/test-images` directory as expected. To find the images, I will now search for the `rimg.png` and `testimäge.png` files globally within the project. This will help me determine the correct location of the image files and provide the complete contents of the `tests/roots/test-images` directory.' additional_kwargs={'function_call': {'name': 'find_file_node_with_basename', 'arguments': '{"basename": "testim\\u00e4ge.png"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19095, 'candidates_token_count': 142, 'total_token_count': 21419, 'cached_content_token_count': 17883, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19095}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17883}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 142}], 'thoughts_token_count': 2182}, 'finish_reason': 'STOP', 'avg_logprobs': -2.475062410596391, 'model_name': 'gemini-2.5-pro'} id='run--b55c8384-3e6d-42a5-b2ea-50d337662133-0' tool_calls=[{'name': 'find_file_node_with_basename', 'args': {'basename': 'rimg.png'}, 'id': '0b503e23-d73f-4b19-8076-f8cc7a12dedd', 'type': 'tool_call'}, {'name': 'find_file_node_with_basename', 'args': {'basename': 'testimäge.png'}, 'id': 'dc4c9aa4-0499-44bc-81ec-a28c1bbc94c5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 19095, 'output_tokens': 142, 'total_tokens': 21419, 'input_token_details': {'cache_read': 17883}, 'output_token_details': {'reasoning': 2182}}
2025-12-23 07:28:11,194 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have thoroughly investigated the user's request. I have successfully provided the full content of `tests/test_build_html.py`.\n\nRegarding the `tests/roots/test-images` directory, I found and read the `index.rst` file within it. However, my investigation revealed that the image files referenced in both `tests/test_build_html.py` and `tests/roots/test-images/index.rst` (such as `rimg.png` and `testimäge.png`) do not exist in the provided codebase. I performed multiple searches, both in the specific directory and globally, and was unable to locate them. Therefore, the only content I can provide from that directory is the `index.rst` file itself." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19281, 'candidates_token_count': 161, 'total_token_count': 21751, 'cached_content_token_count': 17863, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19281}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17863}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 161}], 'thoughts_token_count': 2309}, 'finish_reason': 'STOP', 'avg_logprobs': -1.7032224287897904, 'model_name': 'gemini-2.5-pro'} id='run--6300edbb-b5ee-498d-9cf8-36a7f01a6672-0' usage_metadata={'input_tokens': 19281, 'output_tokens': 161, 'total_tokens': 21751, 'input_token_details': {'cache_read': 17863}, 'output_token_details': {'reasoning': 2309}}
2025-12-23 07:28:11,197 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/test_build_html.py` and the complete contents of the `tests/roots/test-images` directory.
--- END QUERY ---



--- BEGIN PURPOSE ---
This will provide examples of how local image paths are tested within a builder, which is directly applicable to creating new tests for the linkcheck builder's local link validation feature.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/roots/test-images/index.rst
Line number range: 1 - 29
Content:
1. test-image
2. ==========
3. 
4. .. image:: rimg.png
5. 
6. .. figure:: rimg.png
7. 
8.    The caption of pic
9. 
10. .. image:: img.*
11. 
12. .. figure:: img.*
13. 
14.    The caption of img
15. 
16. .. image:: testimäge.png
17. 
18. .. image:: rimg.png
19.    :target: https://www.sphinx-doc.org/
20. 
21. .. image:: rimg.png
22.    :align: center
23.    :target: https://www.python.org/
24. 
25. .. a remote image
26. .. image:: https://www.python.org/static/img/python-logo.png
27. 
28. .. non-exist remote image
29. .. image:: https://www.google.com/NOT_EXIST.PNG


File: tests/test_build_html.py
Line number range: 1 - 500
Content:
1. """
2.     test_build_html
3.     ~~~~~~~~~~~~~~~
4. 
5.     Test the HTML builder and check output against XPath.
6. 
7.     :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import os
12. import re
13. from itertools import cycle, chain
14. 
15. import pytest
16. from html5lib import HTMLParser
17. 
18. from sphinx.builders.html import validate_html_extra_path, validate_html_static_path
19. from sphinx.errors import ConfigError
20. from sphinx.testing.util import strip_escseq
21. from sphinx.util import docutils, md5
22. from sphinx.util.inventory import InventoryFile
23. 
24. 
25. ENV_WARNINGS = """\
26. %(root)s/autodoc_fodder.py:docstring of autodoc_fodder.MarkupError:\\d+: \
27. WARNING: Explicit markup ends without a blank line; unexpected unindent.
28. %(root)s/index.rst:\\d+: WARNING: Encoding 'utf-8-sig' used for reading included \
29. file '%(root)s/wrongenc.inc' seems to be wrong, try giving an :encoding: option
30. %(root)s/index.rst:\\d+: WARNING: invalid single index entry ''
31. %(root)s/index.rst:\\d+: WARNING: image file not readable: foo.png
32. %(root)s/index.rst:\\d+: WARNING: download file not readable: %(root)s/nonexisting.png
33. %(root)s/undecodable.rst:\\d+: WARNING: undecodable source characters, replacing \
34. with "\\?": b?'here: >>>(\\\\|/)xbb<<<((\\\\|/)r)?'
35. """
36. 
37. HTML_WARNINGS = ENV_WARNINGS + """\
38. %(root)s/index.rst:\\d+: WARNING: unknown option: &option
39. %(root)s/index.rst:\\d+: WARNING: citation not found: missing
40. %(root)s/index.rst:\\d+: WARNING: a suitable image for html builder not found: foo.\\*
41. %(root)s/index.rst:\\d+: WARNING: Could not lex literal_block as "c". Highlighting skipped.
42. """
43. 
44. 
45. etree_cache = {}
46. 
47. 
48. @pytest.fixture(scope='module')
49. def cached_etree_parse():
50.     def parse(fname):
51.         if fname in etree_cache:
52.             return etree_cache[fname]
53.         with (fname).open('rb') as fp:
54.             etree = HTMLParser(namespaceHTMLElements=False).parse(fp)
55.             etree_cache.clear()
56.             etree_cache[fname] = etree
57.             return etree
58.     yield parse
59.     etree_cache.clear()
60. 
61. 
62. def flat_dict(d):
63.     return chain.from_iterable(
64.         [
65.             zip(cycle([fname]), values)
66.             for fname, values in d.items()
67.         ]
68.     )
69. 
70. 
71. def tail_check(check):
72.     rex = re.compile(check)
73. 
74.     def checker(nodes):
75.         for node in nodes:
76.             if node.tail and rex.search(node.tail):
77.                 return True
78.         assert False, '%r not found in tail of any nodes %s' % (check, nodes)
79.     return checker
80. 
81. 
82. def check_xpath(etree, fname, path, check, be_found=True):
83.     nodes = list(etree.findall(path))
84.     if check is None:
85.         assert nodes == [], ('found any nodes matching xpath '
86.                              '%r in file %s' % (path, fname))
87.         return
88.     else:
89.         assert nodes != [], ('did not find any node matching xpath '
90.                              '%r in file %s' % (path, fname))
91.     if hasattr(check, '__call__'):
92.         check(nodes)
93.     elif not check:
94.         # only check for node presence
95.         pass
96.     else:
97.         def get_text(node):
98.             if node.text is not None:
99.                 # the node has only one text
100.                 return node.text
101.             else:
102.                 # the node has tags and text; gather texts just under the node
103.                 return ''.join(n.tail or '' for n in node)
104. 
105.         rex = re.compile(check)
106.         if be_found:
107.             if any(rex.search(get_text(node)) for node in nodes):
108.                 return
109.         else:
110.             if all(not rex.search(get_text(node)) for node in nodes):
111.                 return
112. 
113.         assert False, ('%r not found in any node matching '
114.                        'path %s in %s: %r' % (check, path, fname,
115.                                               [node.text for node in nodes]))
116. 
117. 
118. @pytest.mark.sphinx('html', testroot='warnings')
119. def test_html_warnings(app, warning):
120.     app.build()
121.     html_warnings = strip_escseq(re.sub(re.escape(os.sep) + '{1,2}', '/', warning.getvalue()))
122.     html_warnings_exp = HTML_WARNINGS % {
123.         'root': re.escape(app.srcdir.replace(os.sep, '/'))}
124.     assert re.match(html_warnings_exp + '$', html_warnings), \
125.         'Warnings don\'t match:\n' + \
126.         '--- Expected (regex):\n' + html_warnings_exp + \
127.         '--- Got:\n' + html_warnings
128. 
129. 
130. @pytest.mark.sphinx('html', confoverrides={'html4_writer': True})
131. def test_html4_output(app, status, warning):
132.     app.build()
133. 
134. 
135. @pytest.mark.parametrize("fname,expect", flat_dict({
136.     'images.html': [
137.         (".//img[@src='_images/img.png']", ''),
138.         (".//img[@src='_images/img1.png']", ''),
139.         (".//img[@src='_images/simg.png']", ''),
140.         (".//img[@src='_images/svgimg.svg']", ''),
141.         (".//a[@href='_sources/images.txt']", ''),
142.     ],
143.     'subdir/images.html': [
144.         (".//img[@src='../_images/img1.png']", ''),
145.         (".//img[@src='../_images/rimg.png']", ''),
146.     ],
147.     'subdir/includes.html': [
148.         (".//a[@class='reference download internal']", ''),
149.         (".//img[@src='../_images/img.png']", ''),
150.         (".//p", 'This is an include file.'),
151.         (".//pre/span", 'line 1'),
152.         (".//pre/span", 'line 2'),
153.     ],
154.     'includes.html': [
155.         (".//pre", 'Max Strauß'),
156.         (".//a[@class='reference download internal']", ''),
157.         (".//pre/span", '"quotes"'),
158.         (".//pre/span", "'included'"),
159.         (".//pre/span[@class='s2']", 'üöä'),
160.         (".//div[@class='inc-pyobj1 highlight-text notranslate']//pre",
161.          r'^class Foo:\n    pass\n\s*$'),
162.         (".//div[@class='inc-pyobj2 highlight-text notranslate']//pre",
163.          r'^    def baz\(\):\n        pass\n\s*$'),
164.         (".//div[@class='inc-lines highlight-text notranslate']//pre",
165.          r'^class Foo:\n    pass\nclass Bar:\n$'),
166.         (".//div[@class='inc-startend highlight-text notranslate']//pre",
167.          '^foo = "Including Unicode characters: üöä"\\n$'),
168.         (".//div[@class='inc-preappend highlight-text notranslate']//pre",
169.          r'(?m)^START CODE$'),
170.         (".//div[@class='inc-pyobj-dedent highlight-python notranslate']//span",
171.          r'def'),
172.         (".//div[@class='inc-tab3 highlight-text notranslate']//pre",
173.          r'-| |-'),
174.         (".//div[@class='inc-tab8 highlight-python notranslate']//pre/span",
175.          r'-|      |-'),
176.     ],
177.     'autodoc.html': [
178.         (".//dl[@class='py class']/dt[@id='autodoc_target.Class']", ''),
179.         (".//dl[@class='py function']/dt[@id='autodoc_target.function']/em/span", r'\*\*'),
180.         (".//dl[@class='py function']/dt[@id='autodoc_target.function']/em/span", r'kwds'),
181.         (".//dd/p", r'Return spam\.'),
182.     ],
183.     'extapi.html': [
184.         (".//strong", 'from class: Bar'),
185.     ],
186.     'markup.html': [
187.         (".//title", 'set by title directive'),
188.         (".//p/em", 'Section author: Georg Brandl'),
189.         (".//p/em", 'Module author: Georg Brandl'),
190.         # created by the meta directive
191.         (".//meta[@name='author'][@content='Me']", ''),
192.         (".//meta[@name='keywords'][@content='docs, sphinx']", ''),
193.         # a label created by ``.. _label:``
194.         (".//div[@id='label']", ''),
195.         # code with standard code blocks
196.         (".//pre", '^some code$'),
197.         # an option list
198.         (".//span[@class='option']", '--help'),
199.         # admonitions
200.         (".//p[@class='admonition-title']", 'My Admonition'),
201.         (".//div[@class='admonition note']/p", 'Note text.'),
202.         (".//div[@class='admonition warning']/p", 'Warning text.'),
203.         # inline markup
204.         (".//li/p/strong", r'^command\\n$'),
205.         (".//li/p/strong", r'^program\\n$'),
206.         (".//li/p/em", r'^dfn\\n$'),
207.         (".//li/p/kbd", r'^kbd\\n$'),
208.         (".//li/p/span", 'File \N{TRIANGULAR BULLET} Close'),
209.         (".//li/p/code/span[@class='pre']", '^a/$'),
210.         (".//li/p/code/em/span[@class='pre']", '^varpart$'),
211.         (".//li/p/code/em/span[@class='pre']", '^i$'),
212.         (".//a[@href='https://www.python.org/dev/peps/pep-0008']"
213.          "[@class='pep reference external']/strong", 'PEP 8'),
214.         (".//a[@href='https://www.python.org/dev/peps/pep-0008']"
215.          "[@class='pep reference external']/strong",
216.          'Python Enhancement Proposal #8'),
217.         (".//a[@href='https://tools.ietf.org/html/rfc1.html']"
218.          "[@class='rfc reference external']/strong", 'RFC 1'),
219.         (".//a[@href='https://tools.ietf.org/html/rfc1.html']"
220.          "[@class='rfc reference external']/strong", 'Request for Comments #1'),
221.         (".//a[@href='objects.html#envvar-HOME']"
222.          "[@class='reference internal']/code/span[@class='pre']", 'HOME'),
223.         (".//a[@href='#with']"
224.          "[@class='reference internal']/code/span[@class='pre']", '^with$'),
225.         (".//a[@href='#grammar-token-try_stmt']"
226.          "[@class='reference internal']/code/span", '^statement$'),
227.         (".//a[@href='#some-label'][@class='reference internal']/span", '^here$'),
228.         (".//a[@href='#some-label'][@class='reference internal']/span", '^there$'),
229.         (".//a[@href='subdir/includes.html']"
230.          "[@class='reference internal']/span", 'Including in subdir'),
231.         (".//a[@href='objects.html#cmdoption-python-c']"
232.          "[@class='reference internal']/code/span[@class='pre']", '-c'),
233.         # abbreviations
234.         (".//abbr[@title='abbreviation']", '^abbr$'),
235.         # version stuff
236.         (".//div[@class='versionadded']/p/span", 'New in version 0.6: '),
237.         (".//div[@class='versionadded']/p/span",
238.          tail_check('First paragraph of versionadded')),
239.         (".//div[@class='versionchanged']/p/span",
240.          tail_check('First paragraph of versionchanged')),
241.         (".//div[@class='versionchanged']/p",
242.          'Second paragraph of versionchanged'),
243.         # footnote reference
244.         (".//a[@class='footnote-reference brackets']", r'1'),
245.         # created by reference lookup
246.         (".//a[@href='index.html#ref1']", ''),
247.         # ``seealso`` directive
248.         (".//div/p[@class='admonition-title']", 'See also'),
249.         # a ``hlist`` directive
250.         (".//table[@class='hlist']/tbody/tr/td/ul/li/p", '^This$'),
251.         # a ``centered`` directive
252.         (".//p[@class='centered']/strong", 'LICENSE'),
253.         # a glossary
254.         (".//dl/dt[@id='term-boson']", 'boson'),
255.         # a production list
256.         (".//pre/strong", 'try_stmt'),
257.         (".//pre/a[@href='#grammar-token-try1_stmt']/code/span", 'try1_stmt'),
258.         # tests for ``only`` directive
259.         (".//p", 'A global substitution.'),
260.         (".//p", 'In HTML.'),
261.         (".//p", 'In both.'),
262.         (".//p", 'Always present'),
263.         # tests for ``any`` role
264.         (".//a[@href='#with']/span", 'headings'),
265.         (".//a[@href='objects.html#func_without_body']/code/span", 'objects'),
266.         # tests for numeric labels
267.         (".//a[@href='#id1'][@class='reference internal']/span", 'Testing various markup'),
268.         # tests for smartypants
269.         (".//li/p", 'Smart “quotes” in English ‘text’.'),
270.         (".//li/p", 'Smart — long and – short dashes.'),
271.         (".//li/p", 'Ellipsis…'),
272.         (".//li/p/code/span[@class='pre']", 'foo--"bar"...'),
273.         (".//p", 'Этот «абзац» должен использовать „русские“ кавычки.'),
274.         (".//p", 'Il dit : « C’est “super” ! »'),
275.     ],
276.     'objects.html': [
277.         (".//dt[@id='mod.Cls.meth1']", ''),
278.         (".//dt[@id='errmod.Error']", ''),
279.         (".//dt/code", r'long\(parameter,\s* list\)'),
280.         (".//dt/code", 'another one'),
281.         (".//a[@href='#mod.Cls'][@class='reference internal']", ''),
282.         (".//dl[@class='std userdesc']", ''),
283.         (".//dt[@id='userdesc-myobj']", ''),
284.         (".//a[@href='#userdesc-myobj'][@class='reference internal']", ''),
285.         # docfields
286.         (".//a[@class='reference internal'][@href='#TimeInt']/em", 'TimeInt'),
287.         (".//a[@class='reference internal'][@href='#Time']", 'Time'),
288.         (".//a[@class='reference internal'][@href='#errmod.Error']/strong", 'Error'),
289.         # C references
290.         (".//span[@class='pre']", 'CFunction()'),
291.         (".//a[@href='#c.Sphinx_DoSomething']", ''),
292.         (".//a[@href='#c.SphinxStruct.member']", ''),
293.         (".//a[@href='#c.SPHINX_USE_PYTHON']", ''),
294.         (".//a[@href='#c.SphinxType']", ''),
295.         (".//a[@href='#c.sphinx_global']", ''),
296.         # test global TOC created by toctree()
297.         (".//ul[@class='current']/li[@class='toctree-l1 current']/a[@href='#']",
298.          'Testing object descriptions'),
299.         (".//li[@class='toctree-l1']/a[@href='markup.html']",
300.          'Testing various markup'),
301.         # test unknown field names
302.         (".//dt[@class='field-odd']", 'Field_name'),
303.         (".//dt[@class='field-even']", 'Field_name all lower'),
304.         (".//dt[@class='field-odd']", 'FIELD_NAME'),
305.         (".//dt[@class='field-even']", 'FIELD_NAME ALL CAPS'),
306.         (".//dt[@class='field-odd']", 'Field_Name'),
307.         (".//dt[@class='field-even']", 'Field_Name All Word Caps'),
308.         (".//dt[@class='field-odd']", 'Field_name'),
309.         (".//dt[@class='field-even']", 'Field_name First word cap'),
310.         (".//dt[@class='field-odd']", 'FIELd_name'),
311.         (".//dt[@class='field-even']", 'FIELd_name PARTial caps'),
312.         # custom sidebar
313.         (".//h4", 'Custom sidebar'),
314.         # docfields
315.         (".//dd[@class='field-odd']/p/strong", '^moo$'),
316.         (".//dd[@class='field-odd']/p/strong", tail_check(r'\(Moo\) .* Moo')),
317.         (".//dd[@class='field-odd']/ul/li/p/strong", '^hour$'),
318.         (".//dd[@class='field-odd']/ul/li/p/em", '^DuplicateType$'),
319.         (".//dd[@class='field-odd']/ul/li/p/em", tail_check(r'.* Some parameter')),
320.         # others
321.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-p']/code/span",
322.          'perl'),
323.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-p']/code/span",
324.          '\\+p'),
325.         (".//a[@class='reference internal'][@href='#cmdoption-perl-ObjC']/code/span",
326.          '--ObjC\\+\\+'),
327.         (".//a[@class='reference internal'][@href='#cmdoption-perl-plugin.option']/code/span",
328.          '--plugin.option'),
329.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-create-auth-token']"
330.          "/code/span",
331.          'create-auth-token'),
332.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-arg']/code/span",
333.          'arg'),
334.         (".//a[@class='reference internal'][@href='#cmdoption-perl-j']/code/span",
335.          '-j'),
336.         (".//a[@class='reference internal'][@href='#cmdoption-hg-arg-commit']/code/span",
337.          'hg'),
338.         (".//a[@class='reference internal'][@href='#cmdoption-hg-arg-commit']/code/span",
339.          'commit'),
340.         (".//a[@class='reference internal'][@href='#cmdoption-git-commit-p']/code/span",
341.          'git'),
342.         (".//a[@class='reference internal'][@href='#cmdoption-git-commit-p']/code/span",
343.          'commit'),
344.         (".//a[@class='reference internal'][@href='#cmdoption-git-commit-p']/code/span",
345.          '-p'),
346.     ],
347.     'index.html': [
348.         (".//meta[@name='hc'][@content='hcval']", ''),
349.         (".//meta[@name='hc_co'][@content='hcval_co']", ''),
350.         (".//dt[@class='label']/span[@class='brackets']", r'Ref1'),
351.         (".//dt[@class='label']", ''),
352.         (".//li[@class='toctree-l1']/a", 'Testing various markup'),
353.         (".//li[@class='toctree-l2']/a", 'Inline markup'),
354.         (".//title", 'Sphinx <Tests>'),
355.         (".//div[@class='footer']", 'Georg Brandl & Team'),
356.         (".//a[@href='http://python.org/']"
357.          "[@class='reference external']", ''),
358.         (".//li/p/a[@href='genindex.html']/span", 'Index'),
359.         (".//li/p/a[@href='py-modindex.html']/span", 'Module Index'),
360.         # custom sidebar only for contents
361.         (".//h4", 'Contents sidebar'),
362.         # custom JavaScript
363.         (".//script[@src='file://moo.js']", ''),
364.         # URL in contents
365.         (".//a[@class='reference external'][@href='http://sphinx-doc.org/']",
366.          'http://sphinx-doc.org/'),
367.         (".//a[@class='reference external'][@href='http://sphinx-doc.org/latest/']",
368.          'Latest reference'),
369.         # Indirect hyperlink targets across files
370.         (".//a[@href='markup.html#some-label'][@class='reference internal']/span",
371.          '^indirect hyperref$'),
372.     ],
373.     'bom.html': [
374.         (".//title", " File with UTF-8 BOM"),
375.     ],
376.     'extensions.html': [
377.         (".//a[@href='http://python.org/dev/']", "http://python.org/dev/"),
378.         (".//a[@href='http://bugs.python.org/issue1000']", "issue 1000"),
379.         (".//a[@href='http://bugs.python.org/issue1042']", "explicit caption"),
380.     ],
381.     'genindex.html': [
382.         # index entries
383.         (".//a/strong", "Main"),
384.         (".//a/strong", "[1]"),
385.         (".//a/strong", "Other"),
386.         (".//a", "entry"),
387.         (".//li/a", "double"),
388.     ],
389.     'footnote.html': [
390.         (".//a[@class='footnote-reference brackets'][@href='#id9'][@id='id1']", r"1"),
391.         (".//a[@class='footnote-reference brackets'][@href='#id10'][@id='id2']", r"2"),
392.         (".//a[@class='footnote-reference brackets'][@href='#foo'][@id='id3']", r"3"),
393.         (".//a[@class='reference internal'][@href='#bar'][@id='id4']/span", r"\[bar\]"),
394.         (".//a[@class='reference internal'][@href='#baz-qux'][@id='id5']/span", r"\[baz_qux\]"),
395.         (".//a[@class='footnote-reference brackets'][@href='#id11'][@id='id6']", r"4"),
396.         (".//a[@class='footnote-reference brackets'][@href='#id12'][@id='id7']", r"5"),
397.         (".//a[@class='fn-backref'][@href='#id1']", r"1"),
398.         (".//a[@class='fn-backref'][@href='#id2']", r"2"),
399.         (".//a[@class='fn-backref'][@href='#id3']", r"3"),
400.         (".//a[@class='fn-backref'][@href='#id4']", r"bar"),
401.         (".//a[@class='fn-backref'][@href='#id5']", r"baz_qux"),
402.         (".//a[@class='fn-backref'][@href='#id6']", r"4"),
403.         (".//a[@class='fn-backref'][@href='#id7']", r"5"),
404.         (".//a[@class='fn-backref'][@href='#id8']", r"6"),
405.     ],
406.     'otherext.html': [
407.         (".//h1", "Generated section"),
408.         (".//a[@href='_sources/otherext.foo.txt']", ''),
409.     ]
410. }))
411. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
412.                     reason='docutils-0.13 or above is required')
413. @pytest.mark.sphinx('html', tags=['testtag'],
414.                     confoverrides={'html_context.hckey_co': 'hcval_co'})
415. @pytest.mark.test_params(shared_result='test_build_html_output')
416. def test_html5_output(app, cached_etree_parse, fname, expect):
417.     app.build()
418.     print(app.outdir / fname)
419.     check_xpath(cached_etree_parse(app.outdir / fname), fname, *expect)
420. 
421. 
422. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
423.                     reason='docutils-0.13 or above is required')
424. @pytest.mark.sphinx('html')
425. @pytest.mark.test_params(shared_result='test_build_html_output')
426. def test_html_download(app):
427.     app.build()
428. 
429.     # subdir/includes.html
430.     result = (app.outdir / 'subdir' / 'includes.html').read_text()
431.     pattern = ('<a class="reference download internal" download="" '
432.                'href="../(_downloads/.*/img.png)">')
433.     matched = re.search(pattern, result)
434.     assert matched
435.     assert (app.outdir / matched.group(1)).exists()
436.     filename = matched.group(1)
437. 
438.     # includes.html
439.     result = (app.outdir / 'includes.html').read_text()
440.     pattern = ('<a class="reference download internal" download="" '
441.                'href="(_downloads/.*/img.png)">')
442.     matched = re.search(pattern, result)
443.     assert matched
444.     assert (app.outdir / matched.group(1)).exists()
445.     assert matched.group(1) == filename
446. 
447. 
448. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
449.                     reason='docutils-0.13 or above is required')
450. @pytest.mark.sphinx('html', testroot='roles-download')
451. def test_html_download_role(app, status, warning):
452.     app.build()
453.     digest = md5(b'dummy.dat').hexdigest()
454.     assert (app.outdir / '_downloads' / digest / 'dummy.dat').exists()
455.     digest_another = md5(b'another/dummy.dat').hexdigest()
456.     assert (app.outdir / '_downloads' / digest_another / 'dummy.dat').exists()
457. 
458.     content = (app.outdir / 'index.html').read_text()
459.     assert (('<li><p><a class="reference download internal" download="" '
460.              'href="_downloads/%s/dummy.dat">'
461.              '<code class="xref download docutils literal notranslate">'
462.              '<span class="pre">dummy.dat</span></code></a></p></li>' % digest)
463.             in content)
464.     assert (('<li><p><a class="reference download internal" download="" '
465.              'href="_downloads/%s/dummy.dat">'
466.              '<code class="xref download docutils literal notranslate">'
467.              '<span class="pre">another/dummy.dat</span></code></a></p></li>' %
468.              digest_another) in content)
469.     assert ('<li><p><code class="xref download docutils literal notranslate">'
470.             '<span class="pre">not_found.dat</span></code></p></li>' in content)
471.     assert ('<li><p><a class="reference download external" download="" '
472.             'href="http://www.sphinx-doc.org/en/master/_static/sphinxheader.png">'
473.             '<code class="xref download docutils literal notranslate">'
474.             '<span class="pre">Sphinx</span> <span class="pre">logo</span>'
475.             '</code></a></p></li>' in content)
476. 
477. 
478. @pytest.mark.sphinx('html', testroot='build-html-translator')
479. def test_html_translator(app):
480.     app.build()
481.     assert app.builder.docwriter.visitor.depart_with_node == 10
482. 
483. 
484. @pytest.mark.parametrize("fname,expect", flat_dict({
485.     'index.html': [
486.         (".//li[@class='toctree-l3']/a", '1.1.1. Foo A1', True),
487.         (".//li[@class='toctree-l3']/a", '1.2.1. Foo B1', True),
488.         (".//li[@class='toctree-l3']/a", '2.1.1. Bar A1', False),
489.         (".//li[@class='toctree-l3']/a", '2.2.1. Bar B1', False),
490.     ],
491.     'foo.html': [
492.         (".//h1", 'Foo', True),
493.         (".//h2", 'Foo A', True),
494.         (".//h3", 'Foo A1', True),
495.         (".//h2", 'Foo B', True),
496.         (".//h3", 'Foo B1', True),
497. 
498.         (".//h1//span[@class='section-number']", '1. ', True),
499.         (".//h2//span[@class='section-number']", '1.1. ', True),
500.         (".//h3//span[@class='section-number']", '1.1.1. ', True),

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 07:28:18,359 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user explicitly requested the full content of the `tests/test_build_html.py` file.', relative_path='tests/test_build_html.py', start_line=1, end_line=500), ContextOutput(reasoning="The user requested the complete contents of the `tests/roots/test-images` directory. This file is a part of that directory's contents.", relative_path='tests/roots/test-images/index.rst', start_line=1, end_line=29)]
2025-12-23 07:28:18,362 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `tests/test_build_html.py` and the complete contents of the `tests/roots/test-images` directory.
2025-12-23 07:28:18,362 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 07:28:18,362 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 07:28:18,363 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 3 existing contexts
2025-12-23 07:28:18,363 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 5 total contexts (removed 0 duplicates)
2025-12-23 07:28:18,363 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── lint.yml
|       └── main.yml
├── .travis.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   └── themes
|   |       └── fullsize
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── develop.rst
|   ├── development
|   |   ├── index.rst
|   |   └── tutorials
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   ├── theming.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── applehelp.py
|   |   ├── changes.py
|   |   ├── devhelp.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── htmlhelp.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── qthelp.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── indexentries.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── jsmath.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── jssplitter.py
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.3.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── jsonimpl.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── conftest.py
|   ├── js
|   |   └── doctools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── semicolon.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── bound_method.py
|   |   |       ├── callable.py
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── enum.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── genericalias.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── methods.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_pycompat.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   └── typing_test_data.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    ├── checks.py
    ├── doclinter.py
    └── jssplitter_generator.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: linkcheck could also check local (internal) links

Description: Subject: linkcheck currently doesn't check local (internal) links, but this would be useful.

<!--
  Important: This is a list of issues for Sphinx, not a forum.
  If you'd like to post a question, please move to sphinx-users group.
  https://groups.google.com/forum/#!forum/sphinx-users

  Thanks,
-->

### Problem
See above.

#### Procedure to reproduce the problem
Create a template project with sphinx-quickstart, put the following in index.rst
```
broken external-link_
broken local-link_

.. _external-link: https://lkfqhlkghflkhs
.. _local-link: doesntexist
```

Run `make linkcheck`

#### Error logs / results
```
Running Sphinx v1.7.6
making output directory...
loading pickled environment... done
building [mo]: targets for 0 po files that are out of date
building [linkcheck]: targets for 1 source files that are out of date
updating environment: 0 added, 0 changed, 0 removed
looking for now-outdated files... none found
preparing documents... done
writing output... [100%] index                                                                   
(line   14) -local-   doesntexist
(line   14) broken    https://lkfqhlkghflkhs - HTTPSConnectionPool(host='lkfqhlkghflkhs', port=443): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x7faed7ddfc88>: Failed to establish a new connection: [Errno -2] Name or service not known',))

build finished with problems.
make: *** [Makefile:20: linkcheck] Error 1
```

#### Expected results
Also a check for the local link.

### Reproducible project / your project
N/A

### Environment info
- OS: Arch Linux
- Python version: 3.6
- Sphinx version: 1.7.6


Patch information:
diff --git a/doc/usage/builders/index.rst b/doc/usage/builders/index.rst
index db6706944..c860a2517 100644
--- a/doc/usage/builders/index.rst
+++ b/doc/usage/builders/index.rst
@@ -428,9 +428,11 @@ name is ``rinoh``. Refer to the `rinohtype manual`_ for details.
 .. module:: sphinx.builders.linkcheck
 .. class:: CheckExternalLinksBuilder
 
-   This builder scans all documents for external links, tries to open them with
-   ``requests``, and writes an overview which ones are broken and redirected to
-   standard output and to :file:`output.txt` in the output directory.
+   This builder scans all documents for external HTTP(S) links and local
+   links. External links are tried to open with ``requests`` while local
+   links are checked for existence on disk. It writes an overview which
+   ones are broken and redirected to standard output and to :file:`output.txt`
+   in the output directory.
 
    .. autoattribute:: name
 
diff --git a/sphinx/builders/linkcheck.py b/sphinx/builders/linkcheck.py
index dd5317087..c159b273f 100644
--- a/sphinx/builders/linkcheck.py
+++ b/sphinx/builders/linkcheck.py
@@ -77,7 +77,11 @@ def check_anchor(response: requests.requests.Response, anchor: str) -> bool:
 
 class CheckExternalLinksBuilder(Builder):
     """
-    Checks for broken external links.
+    Checks for broken links.
+
+    This builder scans all documents for external HTTP(S) links and local
+    (internal) links. External links are validated via HTTP requests, and
+    local links are checked for existence on disk.
     """
     name = 'linkcheck'
     epilog = __('Look for any errors in the above output or in '
@@ -213,7 +217,17 @@ class CheckExternalLinksBuilder(Builder):
             if len(uri) == 0 or uri.startswith(('#', 'mailto:', 'ftp:')):
                 return 'unchecked', '', 0
             elif not uri.startswith(('http:', 'https:')):
-                return 'local', '', 0
+                # Check local (internal) links by resolving against the document path
+                local_uri = uri.split('#', 1)[0] if '#' in uri else uri
+                try:
+                    rel_fn, abs_fn = self.env.relfn2path(local_uri, docname)
+                except Exception:
+                    # If resolution fails, consider as broken
+                    return 'broken', __("Local path could not be resolved: %s") % local_uri, 0
+                if path.exists(abs_fn):
+                    return 'working', '', 0
+                else:
+                    return 'broken', __("Local path not found: %s") % rel_fn, 0
             elif uri in self.good:
                 return 'working', 'old', 0
             elif uri in self.broken:
@@ -324,7 +338,7 @@ class CheckExternalLinksBuilder(Builder):
         # image nodes
         for imgnode in doctree.traverse(nodes.image):
             uri = imgnode['candidates'].get('?')
-            if uri and '://' in uri:
+            if uri:
                 lineno = get_node_line(imgnode)
                 self.wqueue.put((uri, docname, lineno), False)
                 n += 1


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/test_build_linkcheck.py` and the associated test files `tests/roots/test-linkcheck/links.txt` and `tests/roots/test-linkcheck/conf.py`.
Extra Requirements: 
Purpose: This information is necessary to identify existing test cases that are relevant to the bug report concerning the checking of local links.

Previous refined query 2:
Essential Query: Please provide the full content of `tests/test_build_html.py` and the complete contents of the `tests/roots/test-images` directory.
Extra Requirements: 
Purpose: This will provide examples of how local image paths are tested within a builder, which is directly applicable to creating new tests for the linkcheck builder's local link validation feature.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/roots/test-images/index.rst
Line number range: 1 - 29
Content:
1. test-image
2. ==========
3. 
4. .. image:: rimg.png
5. 
6. .. figure:: rimg.png
7. 
8.    The caption of pic
9. 
10. .. image:: img.*
11. 
12. .. figure:: img.*
13. 
14.    The caption of img
15. 
16. .. image:: testimäge.png
17. 
18. .. image:: rimg.png
19.    :target: https://www.sphinx-doc.org/
20. 
21. .. image:: rimg.png
22.    :align: center
23.    :target: https://www.python.org/
24. 
25. .. a remote image
26. .. image:: https://www.python.org/static/img/python-logo.png
27. 
28. .. non-exist remote image
29. .. image:: https://www.google.com/NOT_EXIST.PNG


File: tests/roots/test-linkcheck/conf.py
Line number range: 1 - 4
Content:
1. master_doc = 'links'
2. source_suffix = '.txt'
3. exclude_patterns = ['_build']
4. linkcheck_anchors = True


File: tests/roots/test-linkcheck/links.txt
Line number range: 1 - 16
Content:
1. This is from CPython documentation.
2. 
3. * Also, if there is a `default namespace <https://www.w3.org/TR/2006/REC-xml-names-20060816/#defaulting>`__, that full URI gets prepended to all of the non-prefixed tags.
4. 
5. * The URL having anchor: `http://www.sphinx-doc.org/en/1.4.8/tutorial.html#install-sphinx`_
6. 
7. Some additional anchors to exercise ignore code
8. 
9. * `Example Bar invalid <https://www.google.com/#!bar>`_
10. * `Example Bar invalid <https://www.google.com#!bar>`_ tests that default ignore anchor of #! does not need to be prefixed with /
11. * `Example Bar invalid <https://www.google.com/#top>`_
12. * `Example anchor invalid <http://www.sphinx-doc.org/en/1.7/intro.html#does-not-exist>`_
13. * `Complete nonsense <https://localhost:7777/doesnotexist>`_
14. 
15. .. image:: https://www.google.com/image.png
16. .. figure:: https://www.google.com/image2.png


File: tests/test_build_html.py
Line number range: 1 - 500
Content:
1. """
2.     test_build_html
3.     ~~~~~~~~~~~~~~~
4. 
5.     Test the HTML builder and check output against XPath.
6. 
7.     :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import os
12. import re
13. from itertools import cycle, chain
14. 
15. import pytest
16. from html5lib import HTMLParser
17. 
18. from sphinx.builders.html import validate_html_extra_path, validate_html_static_path
19. from sphinx.errors import ConfigError
20. from sphinx.testing.util import strip_escseq
21. from sphinx.util import docutils, md5
22. from sphinx.util.inventory import InventoryFile
23. 
24. 
25. ENV_WARNINGS = """\
26. %(root)s/autodoc_fodder.py:docstring of autodoc_fodder.MarkupError:\\d+: \
27. WARNING: Explicit markup ends without a blank line; unexpected unindent.
28. %(root)s/index.rst:\\d+: WARNING: Encoding 'utf-8-sig' used for reading included \
29. file '%(root)s/wrongenc.inc' seems to be wrong, try giving an :encoding: option
30. %(root)s/index.rst:\\d+: WARNING: invalid single index entry ''
31. %(root)s/index.rst:\\d+: WARNING: image file not readable: foo.png
32. %(root)s/index.rst:\\d+: WARNING: download file not readable: %(root)s/nonexisting.png
33. %(root)s/undecodable.rst:\\d+: WARNING: undecodable source characters, replacing \
34. with "\\?": b?'here: >>>(\\\\|/)xbb<<<((\\\\|/)r)?'
35. """
36. 
37. HTML_WARNINGS = ENV_WARNINGS + """\
38. %(root)s/index.rst:\\d+: WARNING: unknown option: &option
39. %(root)s/index.rst:\\d+: WARNING: citation not found: missing
40. %(root)s/index.rst:\\d+: WARNING: a suitable image for html builder not found: foo.\\*
41. %(root)s/index.rst:\\d+: WARNING: Could not lex literal_block as "c". Highlighting skipped.
42. """
43. 
44. 
45. etree_cache = {}
46. 
47. 
48. @pytest.fixture(scope='module')
49. def cached_etree_parse():
50.     def parse(fname):
51.         if fname in etree_cache:
52.             return etree_cache[fname]
53.         with (fname).open('rb') as fp:
54.             etree = HTMLParser(namespaceHTMLElements=False).parse(fp)
55.             etree_cache.clear()
56.             etree_cache[fname] = etree
57.             return etree
58.     yield parse
59.     etree_cache.clear()
60. 
61. 
62. def flat_dict(d):
63.     return chain.from_iterable(
64.         [
65.             zip(cycle([fname]), values)
66.             for fname, values in d.items()
67.         ]
68.     )
69. 
70. 
71. def tail_check(check):
72.     rex = re.compile(check)
73. 
74.     def checker(nodes):
75.         for node in nodes:
76.             if node.tail and rex.search(node.tail):
77.                 return True
78.         assert False, '%r not found in tail of any nodes %s' % (check, nodes)
79.     return checker
80. 
81. 
82. def check_xpath(etree, fname, path, check, be_found=True):
83.     nodes = list(etree.findall(path))
84.     if check is None:
85.         assert nodes == [], ('found any nodes matching xpath '
86.                              '%r in file %s' % (path, fname))
87.         return
88.     else:
89.         assert nodes != [], ('did not find any node matching xpath '
90.                              '%r in file %s' % (path, fname))
91.     if hasattr(check, '__call__'):
92.         check(nodes)
93.     elif not check:
94.         # only check for node presence
95.         pass
96.     else:
97.         def get_text(node):
98.             if node.text is not None:
99.                 # the node has only one text
100.                 return node.text
101.             else:
102.                 # the node has tags and text; gather texts just under the node
103.                 return ''.join(n.tail or '' for n in node)
104. 
105.         rex = re.compile(check)
106.         if be_found:
107.             if any(rex.search(get_text(node)) for node in nodes):
108.                 return
109.         else:
110.             if all(not rex.search(get_text(node)) for node in nodes):
111.                 return
112. 
113.         assert False, ('%r not found in any node matching '
114.                        'path %s in %s: %r' % (check, path, fname,
115.                                               [node.text for node in nodes]))
116. 
117. 
118. @pytest.mark.sphinx('html', testroot='warnings')
119. def test_html_warnings(app, warning):
120.     app.build()
121.     html_warnings = strip_escseq(re.sub(re.escape(os.sep) + '{1,2}', '/', warning.getvalue()))
122.     html_warnings_exp = HTML_WARNINGS % {
123.         'root': re.escape(app.srcdir.replace(os.sep, '/'))}
124.     assert re.match(html_warnings_exp + '$', html_warnings), \
125.         'Warnings don\'t match:\n' + \
126.         '--- Expected (regex):\n' + html_warnings_exp + \
127.         '--- Got:\n' + html_warnings
128. 
129. 
130. @pytest.mark.sphinx('html', confoverrides={'html4_writer': True})
131. def test_html4_output(app, status, warning):
132.     app.build()
133. 
134. 
135. @pytest.mark.parametrize("fname,expect", flat_dict({
136.     'images.html': [
137.         (".//img[@src='_images/img.png']", ''),
138.         (".//img[@src='_images/img1.png']", ''),
139.         (".//img[@src='_images/simg.png']", ''),
140.         (".//img[@src='_images/svgimg.svg']", ''),
141.         (".//a[@href='_sources/images.txt']", ''),
142.     ],
143.     'subdir/images.html': [
144.         (".//img[@src='../_images/img1.png']", ''),
145.         (".//img[@src='../_images/rimg.png']", ''),
146.     ],
147.     'subdir/includes.html': [
148.         (".//a[@class='reference download internal']", ''),
149.         (".//img[@src='../_images/img.png']", ''),
150.         (".//p", 'This is an include file.'),
151.         (".//pre/span", 'line 1'),
152.         (".//pre/span", 'line 2'),
153.     ],
154.     'includes.html': [
155.         (".//pre", 'Max Strauß'),
156.         (".//a[@class='reference download internal']", ''),
157.         (".//pre/span", '"quotes"'),
158.         (".//pre/span", "'included'"),
159.         (".//pre/span[@class='s2']", 'üöä'),
160.         (".//div[@class='inc-pyobj1 highlight-text notranslate']//pre",
161.          r'^class Foo:\n    pass\n\s*$'),
162.         (".//div[@class='inc-pyobj2 highlight-text notranslate']//pre",
163.          r'^    def baz\(\):\n        pass\n\s*$'),
164.         (".//div[@class='inc-lines highlight-text notranslate']//pre",
165.          r'^class Foo:\n    pass\nclass Bar:\n$'),
166.         (".//div[@class='inc-startend highlight-text notranslate']//pre",
167.          '^foo = "Including Unicode characters: üöä"\\n$'),
168.         (".//div[@class='inc-preappend highlight-text notranslate']//pre",
169.          r'(?m)^START CODE$'),
170.         (".//div[@class='inc-pyobj-dedent highlight-python notranslate']//span",
171.          r'def'),
172.         (".//div[@class='inc-tab3 highlight-text notranslate']//pre",
173.          r'-| |-'),
174.         (".//div[@class='inc-tab8 highlight-python notranslate']//pre/span",
175.          r'-|      |-'),
176.     ],
177.     'autodoc.html': [
178.         (".//dl[@class='py class']/dt[@id='autodoc_target.Class']", ''),
179.         (".//dl[@class='py function']/dt[@id='autodoc_target.function']/em/span", r'\*\*'),
180.         (".//dl[@class='py function']/dt[@id='autodoc_target.function']/em/span", r'kwds'),
181.         (".//dd/p", r'Return spam\.'),
182.     ],
183.     'extapi.html': [
184.         (".//strong", 'from class: Bar'),
185.     ],
186.     'markup.html': [
187.         (".//title", 'set by title directive'),
188.         (".//p/em", 'Section author: Georg Brandl'),
189.         (".//p/em", 'Module author: Georg Brandl'),
190.         # created by the meta directive
191.         (".//meta[@name='author'][@content='Me']", ''),
192.         (".//meta[@name='keywords'][@content='docs, sphinx']", ''),
193.         # a label created by ``.. _label:``
194.         (".//div[@id='label']", ''),
195.         # code with standard code blocks
196.         (".//pre", '^some code$'),
197.         # an option list
198.         (".//span[@class='option']", '--help'),
199.         # admonitions
200.         (".//p[@class='admonition-title']", 'My Admonition'),
201.         (".//div[@class='admonition note']/p", 'Note text.'),
202.         (".//div[@class='admonition warning']/p", 'Warning text.'),
203.         # inline markup
204.         (".//li/p/strong", r'^command\\n$'),
205.         (".//li/p/strong", r'^program\\n$'),
206.         (".//li/p/em", r'^dfn\\n$'),
207.         (".//li/p/kbd", r'^kbd\\n$'),
208.         (".//li/p/span", 'File \N{TRIANGULAR BULLET} Close'),
209.         (".//li/p/code/span[@class='pre']", '^a/$'),
210.         (".//li/p/code/em/span[@class='pre']", '^varpart$'),
211.         (".//li/p/code/em/span[@class='pre']", '^i$'),
212.         (".//a[@href='https://www.python.org/dev/peps/pep-0008']"
213.          "[@class='pep reference external']/strong", 'PEP 8'),
214.         (".//a[@href='https://www.python.org/dev/peps/pep-0008']"
215.          "[@class='pep reference external']/strong",
216.          'Python Enhancement Proposal #8'),
217.         (".//a[@href='https://tools.ietf.org/html/rfc1.html']"
218.          "[@class='rfc reference external']/strong", 'RFC 1'),
219.         (".//a[@href='https://tools.ietf.org/html/rfc1.html']"
220.          "[@class='rfc reference external']/strong", 'Request for Comments #1'),
221.         (".//a[@href='objects.html#envvar-HOME']"
222.          "[@class='reference internal']/code/span[@class='pre']", 'HOME'),
223.         (".//a[@href='#with']"
224.          "[@class='reference internal']/code/span[@class='pre']", '^with$'),
225.         (".//a[@href='#grammar-token-try_stmt']"
226.          "[@class='reference internal']/code/span", '^statement$'),
227.         (".//a[@href='#some-label'][@class='reference internal']/span", '^here$'),
228.         (".//a[@href='#some-label'][@class='reference internal']/span", '^there$'),
229.         (".//a[@href='subdir/includes.html']"
230.          "[@class='reference internal']/span", 'Including in subdir'),
231.         (".//a[@href='objects.html#cmdoption-python-c']"
232.          "[@class='reference internal']/code/span[@class='pre']", '-c'),
233.         # abbreviations
234.         (".//abbr[@title='abbreviation']", '^abbr$'),
235.         # version stuff
236.         (".//div[@class='versionadded']/p/span", 'New in version 0.6: '),
237.         (".//div[@class='versionadded']/p/span",
238.          tail_check('First paragraph of versionadded')),
239.         (".//div[@class='versionchanged']/p/span",
240.          tail_check('First paragraph of versionchanged')),
241.         (".//div[@class='versionchanged']/p",
242.          'Second paragraph of versionchanged'),
243.         # footnote reference
244.         (".//a[@class='footnote-reference brackets']", r'1'),
245.         # created by reference lookup
246.         (".//a[@href='index.html#ref1']", ''),
247.         # ``seealso`` directive
248.         (".//div/p[@class='admonition-title']", 'See also'),
249.         # a ``hlist`` directive
250.         (".//table[@class='hlist']/tbody/tr/td/ul/li/p", '^This$'),
251.         # a ``centered`` directive
252.         (".//p[@class='centered']/strong", 'LICENSE'),
253.         # a glossary
254.         (".//dl/dt[@id='term-boson']", 'boson'),
255.         # a production list
256.         (".//pre/strong", 'try_stmt'),
257.         (".//pre/a[@href='#grammar-token-try1_stmt']/code/span", 'try1_stmt'),
258.         # tests for ``only`` directive
259.         (".//p", 'A global substitution.'),
260.         (".//p", 'In HTML.'),
261.         (".//p", 'In both.'),
262.         (".//p", 'Always present'),
263.         # tests for ``any`` role
264.         (".//a[@href='#with']/span", 'headings'),
265.         (".//a[@href='objects.html#func_without_body']/code/span", 'objects'),
266.         # tests for numeric labels
267.         (".//a[@href='#id1'][@class='reference internal']/span", 'Testing various markup'),
268.         # tests for smartypants
269.         (".//li/p", 'Smart “quotes” in English ‘text’.'),
270.         (".//li/p", 'Smart — long and – short dashes.'),
271.         (".//li/p", 'Ellipsis…'),
272.         (".//li/p/code/span[@class='pre']", 'foo--"bar"...'),
273.         (".//p", 'Этот «абзац» должен использовать „русские“ кавычки.'),
274.         (".//p", 'Il dit : « C’est “super” ! »'),
275.     ],
276.     'objects.html': [
277.         (".//dt[@id='mod.Cls.meth1']", ''),
278.         (".//dt[@id='errmod.Error']", ''),
279.         (".//dt/code", r'long\(parameter,\s* list\)'),
280.         (".//dt/code", 'another one'),
281.         (".//a[@href='#mod.Cls'][@class='reference internal']", ''),
282.         (".//dl[@class='std userdesc']", ''),
283.         (".//dt[@id='userdesc-myobj']", ''),
284.         (".//a[@href='#userdesc-myobj'][@class='reference internal']", ''),
285.         # docfields
286.         (".//a[@class='reference internal'][@href='#TimeInt']/em", 'TimeInt'),
287.         (".//a[@class='reference internal'][@href='#Time']", 'Time'),
288.         (".//a[@class='reference internal'][@href='#errmod.Error']/strong", 'Error'),
289.         # C references
290.         (".//span[@class='pre']", 'CFunction()'),
291.         (".//a[@href='#c.Sphinx_DoSomething']", ''),
292.         (".//a[@href='#c.SphinxStruct.member']", ''),
293.         (".//a[@href='#c.SPHINX_USE_PYTHON']", ''),
294.         (".//a[@href='#c.SphinxType']", ''),
295.         (".//a[@href='#c.sphinx_global']", ''),
296.         # test global TOC created by toctree()
297.         (".//ul[@class='current']/li[@class='toctree-l1 current']/a[@href='#']",
298.          'Testing object descriptions'),
299.         (".//li[@class='toctree-l1']/a[@href='markup.html']",
300.          'Testing various markup'),
301.         # test unknown field names
302.         (".//dt[@class='field-odd']", 'Field_name'),
303.         (".//dt[@class='field-even']", 'Field_name all lower'),
304.         (".//dt[@class='field-odd']", 'FIELD_NAME'),
305.         (".//dt[@class='field-even']", 'FIELD_NAME ALL CAPS'),
306.         (".//dt[@class='field-odd']", 'Field_Name'),
307.         (".//dt[@class='field-even']", 'Field_Name All Word Caps'),
308.         (".//dt[@class='field-odd']", 'Field_name'),
309.         (".//dt[@class='field-even']", 'Field_name First word cap'),
310.         (".//dt[@class='field-odd']", 'FIELd_name'),
311.         (".//dt[@class='field-even']", 'FIELd_name PARTial caps'),
312.         # custom sidebar
313.         (".//h4", 'Custom sidebar'),
314.         # docfields
315.         (".//dd[@class='field-odd']/p/strong", '^moo$'),
316.         (".//dd[@class='field-odd']/p/strong", tail_check(r'\(Moo\) .* Moo')),
317.         (".//dd[@class='field-odd']/ul/li/p/strong", '^hour$'),
318.         (".//dd[@class='field-odd']/ul/li/p/em", '^DuplicateType$'),
319.         (".//dd[@class='field-odd']/ul/li/p/em", tail_check(r'.* Some parameter')),
320.         # others
321.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-p']/code/span",
322.          'perl'),
323.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-p']/code/span",
324.          '\\+p'),
325.         (".//a[@class='reference internal'][@href='#cmdoption-perl-ObjC']/code/span",
326.          '--ObjC\\+\\+'),
327.         (".//a[@class='reference internal'][@href='#cmdoption-perl-plugin.option']/code/span",
328.          '--plugin.option'),
329.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-create-auth-token']"
330.          "/code/span",
331.          'create-auth-token'),
332.         (".//a[@class='reference internal'][@href='#cmdoption-perl-arg-arg']/code/span",
333.          'arg'),
334.         (".//a[@class='reference internal'][@href='#cmdoption-perl-j']/code/span",
335.          '-j'),
336.         (".//a[@class='reference internal'][@href='#cmdoption-hg-arg-commit']/code/span",
337.          'hg'),
338.         (".//a[@class='reference internal'][@href='#cmdoption-hg-arg-commit']/code/span",
339.          'commit'),
340.         (".//a[@class='reference internal'][@href='#cmdoption-git-commit-p']/code/span",
341.          'git'),
342.         (".//a[@class='reference internal'][@href='#cmdoption-git-commit-p']/code/span",
343.          'commit'),
344.         (".//a[@class='reference internal'][@href='#cmdoption-git-commit-p']/code/span",
345.          '-p'),
346.     ],
347.     'index.html': [
348.         (".//meta[@name='hc'][@content='hcval']", ''),
349.         (".//meta[@name='hc_co'][@content='hcval_co']", ''),
350.         (".//dt[@class='label']/span[@class='brackets']", r'Ref1'),
351.         (".//dt[@class='label']", ''),
352.         (".//li[@class='toctree-l1']/a", 'Testing various markup'),
353.         (".//li[@class='toctree-l2']/a", 'Inline markup'),
354.         (".//title", 'Sphinx <Tests>'),
355.         (".//div[@class='footer']", 'Georg Brandl & Team'),
356.         (".//a[@href='http://python.org/']"
357.          "[@class='reference external']", ''),
358.         (".//li/p/a[@href='genindex.html']/span", 'Index'),
359.         (".//li/p/a[@href='py-modindex.html']/span", 'Module Index'),
360.         # custom sidebar only for contents
361.         (".//h4", 'Contents sidebar'),
362.         # custom JavaScript
363.         (".//script[@src='file://moo.js']", ''),
364.         # URL in contents
365.         (".//a[@class='reference external'][@href='http://sphinx-doc.org/']",
366.          'http://sphinx-doc.org/'),
367.         (".//a[@class='reference external'][@href='http://sphinx-doc.org/latest/']",
368.          'Latest reference'),
369.         # Indirect hyperlink targets across files
370.         (".//a[@href='markup.html#some-label'][@class='reference internal']/span",
371.          '^indirect hyperref$'),
372.     ],
373.     'bom.html': [
374.         (".//title", " File with UTF-8 BOM"),
375.     ],
376.     'extensions.html': [
377.         (".//a[@href='http://python.org/dev/']", "http://python.org/dev/"),
378.         (".//a[@href='http://bugs.python.org/issue1000']", "issue 1000"),
379.         (".//a[@href='http://bugs.python.org/issue1042']", "explicit caption"),
380.     ],
381.     'genindex.html': [
382.         # index entries
383.         (".//a/strong", "Main"),
384.         (".//a/strong", "[1]"),
385.         (".//a/strong", "Other"),
386.         (".//a", "entry"),
387.         (".//li/a", "double"),
388.     ],
389.     'footnote.html': [
390.         (".//a[@class='footnote-reference brackets'][@href='#id9'][@id='id1']", r"1"),
391.         (".//a[@class='footnote-reference brackets'][@href='#id10'][@id='id2']", r"2"),
392.         (".//a[@class='footnote-reference brackets'][@href='#foo'][@id='id3']", r"3"),
393.         (".//a[@class='reference internal'][@href='#bar'][@id='id4']/span", r"\[bar\]"),
394.         (".//a[@class='reference internal'][@href='#baz-qux'][@id='id5']/span", r"\[baz_qux\]"),
395.         (".//a[@class='footnote-reference brackets'][@href='#id11'][@id='id6']", r"4"),
396.         (".//a[@class='footnote-reference brackets'][@href='#id12'][@id='id7']", r"5"),
397.         (".//a[@class='fn-backref'][@href='#id1']", r"1"),
398.         (".//a[@class='fn-backref'][@href='#id2']", r"2"),
399.         (".//a[@class='fn-backref'][@href='#id3']", r"3"),
400.         (".//a[@class='fn-backref'][@href='#id4']", r"bar"),
401.         (".//a[@class='fn-backref'][@href='#id5']", r"baz_qux"),
402.         (".//a[@class='fn-backref'][@href='#id6']", r"4"),
403.         (".//a[@class='fn-backref'][@href='#id7']", r"5"),
404.         (".//a[@class='fn-backref'][@href='#id8']", r"6"),
405.     ],
406.     'otherext.html': [
407.         (".//h1", "Generated section"),
408.         (".//a[@href='_sources/otherext.foo.txt']", ''),
409.     ]
410. }))
411. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
412.                     reason='docutils-0.13 or above is required')
413. @pytest.mark.sphinx('html', tags=['testtag'],
414.                     confoverrides={'html_context.hckey_co': 'hcval_co'})
415. @pytest.mark.test_params(shared_result='test_build_html_output')
416. def test_html5_output(app, cached_etree_parse, fname, expect):
417.     app.build()
418.     print(app.outdir / fname)
419.     check_xpath(cached_etree_parse(app.outdir / fname), fname, *expect)
420. 
421. 
422. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
423.                     reason='docutils-0.13 or above is required')
424. @pytest.mark.sphinx('html')
425. @pytest.mark.test_params(shared_result='test_build_html_output')
426. def test_html_download(app):
427.     app.build()
428. 
429.     # subdir/includes.html
430.     result = (app.outdir / 'subdir' / 'includes.html').read_text()
431.     pattern = ('<a class="reference download internal" download="" '
432.                'href="../(_downloads/.*/img.png)">')
433.     matched = re.search(pattern, result)
434.     assert matched
435.     assert (app.outdir / matched.group(1)).exists()
436.     filename = matched.group(1)
437. 
438.     # includes.html
439.     result = (app.outdir / 'includes.html').read_text()
440.     pattern = ('<a class="reference download internal" download="" '
441.                'href="(_downloads/.*/img.png)">')
442.     matched = re.search(pattern, result)
443.     assert matched
444.     assert (app.outdir / matched.group(1)).exists()
445.     assert matched.group(1) == filename
446. 
447. 
448. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
449.                     reason='docutils-0.13 or above is required')
450. @pytest.mark.sphinx('html', testroot='roles-download')
451. def test_html_download_role(app, status, warning):
452.     app.build()
453.     digest = md5(b'dummy.dat').hexdigest()
454.     assert (app.outdir / '_downloads' / digest / 'dummy.dat').exists()
455.     digest_another = md5(b'another/dummy.dat').hexdigest()
456.     assert (app.outdir / '_downloads' / digest_another / 'dummy.dat').exists()
457. 
458.     content = (app.outdir / 'index.html').read_text()
459.     assert (('<li><p><a class="reference download internal" download="" '
460.              'href="_downloads/%s/dummy.dat">'
461.              '<code class="xref download docutils literal notranslate">'
462.              '<span class="pre">dummy.dat</span></code></a></p></li>' % digest)
463.             in content)
464.     assert (('<li><p><a class="reference download internal" download="" '
465.              'href="_downloads/%s/dummy.dat">'
466.              '<code class="xref download docutils literal notranslate">'
467.              '<span class="pre">another/dummy.dat</span></code></a></p></li>' %
468.              digest_another) in content)
469.     assert ('<li><p><code class="xref download docutils literal notranslate">'
470.             '<span class="pre">not_found.dat</span></code></p></li>' in content)
471.     assert ('<li><p><a class="reference download external" download="" '
472.             'href="http://www.sphinx-doc.org/en/master/_static/sphinxheader.png">'
473.             '<code class="xref download docutils literal notranslate">'
474.             '<span class="pre">Sphinx</span> <span class="pre">logo</span>'
475.             '</code></a></p></li>' in content)
476. 
477. 
478. @pytest.mark.sphinx('html', testroot='build-html-translator')
479. def test_html_translator(app):
480.     app.build()
481.     assert app.builder.docwriter.visitor.depart_with_node == 10
482. 
483. 
484. @pytest.mark.parametrize("fname,expect", flat_dict({
485.     'index.html': [
486.         (".//li[@class='toctree-l3']/a", '1.1.1. Foo A1', True),
487.         (".//li[@class='toctree-l3']/a", '1.2.1. Foo B1', True),
488.         (".//li[@class='toctree-l3']/a", '2.1.1. Bar A1', False),
489.         (".//li[@class='toctree-l3']/a", '2.2.1. Bar B1', False),
490.     ],
491.     'foo.html': [
492.         (".//h1", 'Foo', True),
493.         (".//h2", 'Foo A', True),
494.         (".//h3", 'Foo A1', True),
495.         (".//h2", 'Foo B', True),
496.         (".//h3", 'Foo B1', True),
497. 
498.         (".//h1//span[@class='section-number']", '1. ', True),
499.         (".//h2//span[@class='section-number']", '1.1. ', True),
500.         (".//h3//span[@class='section-number']", '1.1.1. ', True),


File: tests/test_build_linkcheck.py
Line number range: 1 - 159
Content:
1. """
2.     test_build_linkcheck
3.     ~~~~~~~~~~~~~~~~~~~~
4. 
5.     Test the build process with manpage builder with the test root.
6. 
7.     :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import json
12. import re
13. from unittest import mock
14. import pytest
15. 
16. 
17. @pytest.mark.sphinx('linkcheck', testroot='linkcheck', freshenv=True)
18. def test_defaults(app, status, warning):
19.     app.builder.build_all()
20. 
21.     assert (app.outdir / 'output.txt').exists()
22.     content = (app.outdir / 'output.txt').read_text()
23. 
24.     print(content)
25.     # looking for '#top' and '#does-not-exist' not found should fail
26.     assert "Anchor 'top' not found" in content
27.     assert "Anchor 'does-not-exist' not found" in content
28.     # looking for non-existent URL should fail
29.     assert " Max retries exceeded with url: /doesnotexist" in content
30.     # images should fail
31.     assert "Not Found for url: https://www.google.com/image.png" in content
32.     assert "Not Found for url: https://www.google.com/image2.png" in content
33.     assert len(content.splitlines()) == 5
34. 
35. 
36. @pytest.mark.sphinx('linkcheck', testroot='linkcheck', freshenv=True)
37. def test_defaults_json(app, status, warning):
38.     app.builder.build_all()
39. 
40.     assert (app.outdir / 'output.json').exists()
41.     content = (app.outdir / 'output.json').read_text()
42.     print(content)
43. 
44.     rows = [json.loads(x) for x in content.splitlines()]
45.     row = rows[0]
46.     for attr in ["filename", "lineno", "status", "code", "uri",
47.                  "info"]:
48.         assert attr in row
49. 
50.     assert len(content.splitlines()) == 8
51.     assert len(rows) == 8
52.     # the output order of the rows is not stable
53.     # due to possible variance in network latency
54.     rowsby = {row["uri"]:row for row in rows}
55.     assert rowsby["https://www.google.com#!bar"] == {
56.         'filename': 'links.txt',
57.         'lineno': 10,
58.         'status': 'working',
59.         'code': 0,
60.         'uri': 'https://www.google.com#!bar',
61.         'info': ''
62.     }
63.     # looking for non-existent URL should fail
64.     dnerow = rowsby['https://localhost:7777/doesnotexist']
65.     assert dnerow['filename'] == 'links.txt'
66.     assert dnerow['lineno'] == 13
67.     assert dnerow['status'] == 'broken'
68.     assert dnerow['code'] == 0
69.     assert dnerow['uri'] == 'https://localhost:7777/doesnotexist'
70.     assert rowsby['https://www.google.com/image2.png'] == {
71.         'filename': 'links.txt',
72.         'lineno': 16,
73.         'status': 'broken',
74.         'code': 0,
75.         'uri': 'https://www.google.com/image2.png',
76.         'info': '404 Client Error: Not Found for url: https://www.google.com/image2.png'
77.     }
78.     # looking for '#top' and '#does-not-exist' not found should fail
79.     assert "Anchor 'top' not found" == \
80.         rowsby["https://www.google.com/#top"]["info"]
81.     assert "Anchor 'does-not-exist' not found" == \
82.         rowsby["http://www.sphinx-doc.org/en/1.7/intro.html#does-not-exist"]["info"]
83.     # images should fail
84.     assert "Not Found for url: https://www.google.com/image.png" in \
85.         rowsby["https://www.google.com/image.png"]["info"]
86. 
87. 
88. @pytest.mark.sphinx(
89.     'linkcheck', testroot='linkcheck', freshenv=True,
90.     confoverrides={'linkcheck_anchors_ignore': ["^!", "^top$"],
91.                    'linkcheck_ignore': [
92.                        'https://localhost:7777/doesnotexist',
93.                        'http://www.sphinx-doc.org/en/1.7/intro.html#',
94.                        'https://www.google.com/image.png',
95.                        'https://www.google.com/image2.png']
96.                    })
97. def test_anchors_ignored(app, status, warning):
98.     app.builder.build_all()
99. 
100.     assert (app.outdir / 'output.txt').exists()
101.     content = (app.outdir / 'output.txt').read_text()
102. 
103.     # expect all ok when excluding #top
104.     assert not content
105. 
106. 
107. @pytest.mark.sphinx(
108.     'linkcheck', testroot='linkcheck', freshenv=True,
109.     confoverrides={'linkcheck_auth': [
110.                         (r'.+google\.com/image.+', 'authinfo1'),
111.                         (r'.+google\.com.+', 'authinfo2'),
112.                    ]
113.                   })
114. def test_auth(app, status, warning):
115.     mock_req = mock.MagicMock()
116.     mock_req.return_value = 'fake-response'
117. 
118.     with mock.patch.multiple('requests', get=mock_req, head=mock_req):
119.         app.builder.build_all()
120.         for c_args, c_kwargs in mock_req.call_args_list:
121.             if 'google.com/image' in c_args[0]:
122.                 assert c_kwargs['auth'] == 'authinfo1'
123.             elif 'google.com' in c_args[0]:
124.                 assert c_kwargs['auth'] == 'authinfo2'
125.             else:
126.                 assert not c_kwargs['auth']
127. 
128. 
129. @pytest.mark.sphinx(
130.     'linkcheck', testroot='linkcheck', freshenv=True,
131.     confoverrides={'linkcheck_request_headers': {
132.         "https://localhost:7777/": {
133.             "Accept": "text/html",
134.         },
135.         "http://www.sphinx-doc.org": {  # no slash at the end
136.             "Accept": "application/json",
137.         },
138.         "*": {
139.             "X-Secret": "open sesami",
140.         }
141.     }})
142. def test_linkcheck_request_headers(app, status, warning):
143.     mock_req = mock.MagicMock()
144.     mock_req.return_value = 'fake-response'
145. 
146.     with mock.patch.multiple('requests', get=mock_req, head=mock_req):
147.         app.builder.build_all()
148.         for args, kwargs in mock_req.call_args_list:
149.             url = args[0]
150.             headers = kwargs.get('headers', {})
151.             if "https://localhost:7777" in url:
152.                 assert headers["Accept"] == "text/html"
153.             elif 'http://www.sphinx-doc.org' in url:
154.                 assert headers["Accept"] == "application/json"
155.             elif 'https://www.google.com' in url:
156.                 assert headers["Accept"] == "text/html,application/xhtml+xml;q=0.9,*/*;q=0.8"
157.                 assert headers["X-Secret"] == "open sesami"
158.             else:
159.                 assert headers["Accept"] == "text/html,application/xhtml+xml;q=0.9,*/*;q=0.8"

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 07:28:53,078 - thread-140410290681536.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The current context is sufficient to fulfill the user's request. I have identified three relevant test cases: two from `test_build_linkcheck.py` (`test_defaults`, `test_defaults_json`) that show how to test the linkcheck builder, and one from `test_build_html.py` (`test_html_warnings`) that demonstrates testing for missing local file resources, which is conceptually analogous to the user's goal. All necessary code for these tests is present in the aggregated context." query='' extra_requirements='' purpose=''
2025-12-23 07:28:53,079 - thread-140410290681536.prometheus_context_collector - INFO - Successfully retrieved 5 context snippets
