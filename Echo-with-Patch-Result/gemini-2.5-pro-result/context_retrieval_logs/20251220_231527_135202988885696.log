2025-12-20 23:15:27,311 - thread-135202988885696.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Change uuid field to FK does not create dependency

Description: Description
	 
		(last modified by Simon Charette)
	 
Hi! I am new in django community, so please help me, because i really dont know is it really "bug".
I have a django project named "testproject" and two apps: testapp1, testapp2.
It will be simpler to understand, with this example:
# TestApp1(models.py):
class App1(models.Model):
	id = models.UUIDField(primary_key=True, unique=True, default=uuid.uuid4, editable=False, verbose_name=_('identifier'))
	text = models.CharField(max_length=100, verbose_name=_('text'))
	another_app = models.UUIDField(null=True, blank=True, verbose_name=_('another app'))
# TestApp2(models.py):
class App2(models.Model):
	id = models.UUIDField(primary_key=True, unique=True, default=uuid.uuid4, editable=False, verbose_name=_('identifier'))
	text = models.CharField(max_length=100, verbose_name=_('text'))
First model named "App1" has UUID field named "another_app":
 another_app = models.UUIDField(null=True, blank=True, verbose_name=_('another app'))
After some time i change field from UUID to FK, like this: 
another_app = models.ForeignKey(App2, null=True, blank=True, on_delete=models.SET_NULL, verbose_name=_('another app'))
And as result i create new migration, but Migration class was unexpected result, because it does not create any "dependencies" for App2, because of FK.
I think the correct solution will be create dependency for App2.
This project use django version 2.2 and postgresql. Attach archive with sources. Project contains small test, after running him, you will get exception like this: ValueError: Related model 'testapp2.App2' cannot be resolved.
So is it problem in django or maybe i dont understand something ?
Here is my post in django users:
​https://groups.google.com/forum/#!searchin/django-users/Django$20bug$3A$20change$20uuid$20field$20to$20FK$20does$20not$20create$20dependency%7Csort:date/django-users/-h9LZxFomLU/yz-NLi1cDgAJ
Regards, Viktor Lomakin

Patch information:
diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py
index 0dc1c77c53..2b37d483ef 100644
--- a/django/db/migrations/autodetector.py
+++ b/django/db/migrations/autodetector.py
@@ -963,6 +963,16 @@ class MigrationAutodetector:
                             preserve_default = False
                     else:
                         field = new_field
+                    dependencies = []
+                    if getattr(new_field, "remote_field", None) and getattr(new_field.remote_field, "model", None):
+                        dependencies.extend(self._get_dependencies_for_foreign_key(new_field))
+                    dependencies = [dep for dep in dependencies if dep[0] != app_label]
+                    seen = set()
+                    unique_dependencies = []
+                    for dep in dependencies:
+                        if dep not in seen:
+                            unique_dependencies.append(dep)
+                            seen.add(dep)
                     self.add_operation(
                         app_label,
                         operations.AlterField(
@@ -970,7 +980,8 @@ class MigrationAutodetector:
                             name=field_name,
                             field=field,
                             preserve_default=preserve_default,
-                        )
+                        ),
+                        dependencies=unique_dependencies,
                     )
                 else:
                     # We cannot alter between m2m and concrete fields


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-20 23:15:27,403 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── FUNDING.yml
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_remote_user_deprecation.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   ├── test_file_charset.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_deprecated_features.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Change uuid field to FK does not create dependency

Description: Description
	 
		(last modified by Simon Charette)
	 
Hi! I am new in django community, so please help me, because i really dont know is it really "bug".
I have a django project named "testproject" and two apps: testapp1, testapp2.
It will be simpler to understand, with this example:
# TestApp1(models.py):
class App1(models.Model):
	id = models.UUIDField(primary_key=True, unique=True, default=uuid.uuid4, editable=False, verbose_name=_('identifier'))
	text = models.CharField(max_length=100, verbose_name=_('text'))
	another_app = models.UUIDField(null=True, blank=True, verbose_name=_('another app'))
# TestApp2(models.py):
class App2(models.Model):
	id = models.UUIDField(primary_key=True, unique=True, default=uuid.uuid4, editable=False, verbose_name=_('identifier'))
	text = models.CharField(max_length=100, verbose_name=_('text'))
First model named "App1" has UUID field named "another_app":
 another_app = models.UUIDField(null=True, blank=True, verbose_name=_('another app'))
After some time i change field from UUID to FK, like this: 
another_app = models.ForeignKey(App2, null=True, blank=True, on_delete=models.SET_NULL, verbose_name=_('another app'))
And as result i create new migration, but Migration class was unexpected result, because it does not create any "dependencies" for App2, because of FK.
I think the correct solution will be create dependency for App2.
This project use django version 2.2 and postgresql. Attach archive with sources. Project contains small test, after running him, you will get exception like this: ValueError: Related model 'testapp2.App2' cannot be resolved.
So is it problem in django or maybe i dont understand something ?
Here is my post in django users:
​https://groups.google.com/forum/#!searchin/django-users/Django$20bug$3A$20change$20uuid$20field$20to$20FK$20does$20not$20create$20dependency%7Csort:date/django-users/-h9LZxFomLU/yz-NLi1cDgAJ
Regards, Viktor Lomakin

Patch information:
diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py
index 0dc1c77c53..2b37d483ef 100644
--- a/django/db/migrations/autodetector.py
+++ b/django/db/migrations/autodetector.py
@@ -963,6 +963,16 @@ class MigrationAutodetector:
                             preserve_default = False
                     else:
                         field = new_field
+                    dependencies = []
+                    if getattr(new_field, "remote_field", None) and getattr(new_field.remote_field, "model", None):
+                        dependencies.extend(self._get_dependencies_for_foreign_key(new_field))
+                    dependencies = [dep for dep in dependencies if dep[0] != app_label]
+                    seen = set()
+                    unique_dependencies = []
+                    for dep in dependencies:
+                        if dep not in seen:
+                            unique_dependencies.append(dep)
+                            seen.add(dep)
                     self.add_operation(
                         app_label,
                         operations.AlterField(
@@ -970,7 +980,8 @@ class MigrationAutodetector:
                             name=field_name,
                             field=field,
                             preserve_default=preserve_default,
-                        )
+                        ),
+                        dependencies=unique_dependencies,
                     )
                 else:
                     # We cannot alter between m2m and concrete fields


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 23:15:56,214 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a bug in the migration autodetector. The bug is related to changing a field to a ForeignKey and the autodetector not creating a dependency. The patch modifies `django/db/migrations/autodetector.py`, so the most relevant test cases will be in its corresponding test file, `tests/migrations/test_autodetector.py`. I need the content of this file to find the test cases. The current context is empty.' query='Please provide the full content of `tests/migrations/test_autodetector.py`.' extra_requirements='' purpose='I need this file to find test cases that check for the correct creation of dependencies when fields are altered to ForeignKeys.'
2025-12-20 23:15:56,221 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/migrations/test_autodetector.py`.
2025-12-20 23:15:56,226 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 23:15:56,232 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 23:15:56,237 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 23:15:56,237 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/migrations/test_autodetector.py`.
Purpose: I need this file to find test cases that check for the correct creation of dependencies when fields are altered to ForeignKeys.
2025-12-20 23:15:59,249 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of `tests/migrations/test_autodetector.py` to help you find the test cases you are looking for. This will allow you to examine the test suite for checks on the creation of dependencies when fields are altered to ForeignKeys.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/test_autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2099, 'candidates_token_count': 81, 'total_token_count': 2332, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2099}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 81}], 'thoughts_token_count': 152, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.25539188620484904, 'model_name': 'gemini-2.5-pro'} id='run--699014ee-2db9-4813-a733-7530a7c5b893-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_autodetector.py'}, 'id': '7b3ebea9-6372-4b59-a38f-39a9cfea0bdc', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2099, 'output_tokens': 81, 'total_tokens': 2332, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 152}}
2025-12-20 23:16:03,040 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the first 500 lines of the requested file. Since the file is longer, I will now retrieve the remaining content to provide you with the complete file.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 5000.0, "relative_path": "tests/migrations/test_autodetector.py", "start_line": 501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11568, 'candidates_token_count': 67, 'total_token_count': 11789, 'cached_content_token_count': 1828, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11568}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1828}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 67}], 'thoughts_token_count': 154}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2873874778178201, 'model_name': 'gemini-2.5-pro'} id='run--7d582a79-31ed-489c-a588-72a378c96174-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 5000.0, 'relative_path': 'tests/migrations/test_autodetector.py', 'start_line': 501.0}, 'id': '35863d5a-d77d-4e81-a67f-34c346cb0259', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11568, 'output_tokens': 67, 'total_tokens': 11789, 'input_token_details': {'cache_read': 1828}, 'output_token_details': {'reasoning': 154}}
2025-12-20 23:16:31,232 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have successfully retrieved the complete content of `tests/migrations/test_autodetector.py`. After reviewing the file, I have identified several test cases that are highly relevant to your query about checking the creation of dependencies when altering fields to ForeignKeys. Specifically, the tests `test_fk_dependency`, `test_circular_fk_dependency`, and `test_fk_dependency_other_app` directly address the autodetector's ability to correctly establish dependencies when `ForeignKey` relationships are introduced or modified. I have also found tests like `test_replace_string_with_foreignkey` which, while not directly about dependencies, are still very relevant as they test the alteration of a field to a `ForeignKey`." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 765, 'end_index': 1189, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 1057, 'end_index': 1489, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 3052, 'end_index': 3370, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 3235, 'end_index': 3543, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 3406, 'end_index': 3840, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 5042, 'end_index': 5426, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 5287, 'end_index': 5613, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 7528, 'end_index': 7907, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 7771, 'end_index': 8768, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 9728, 'end_index': 10136, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 10070, 'end_index': 10749, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 51013, 'candidates_token_count': 150, 'total_token_count': 54460, 'prompt_tokens_details': [{'modality': 1, 'token_count': 51013}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 150}], 'thoughts_token_count': 3297, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4681275431315104, 'model_name': 'gemini-2.5-pro'} id='run--952a5a68-ca03-458a-b0f5-c0b568da4488-0' usage_metadata={'input_tokens': 51013, 'output_tokens': 150, 'total_tokens': 54460, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 3297}}
2025-12-20 23:16:31,235 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/migrations/test_autodetector.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need this file to find test cases that check for the correct creation of dependencies when fields are altered to ForeignKeys.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/migrations/test_autodetector.py
Line number range: 1 - 500
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("title", models.CharField(max_length=200)),
358.     ])
359.     book_with_author_renamed = ModelState("otherapp", "Book", [
360.         ("id", models.AutoField(primary_key=True)),
361.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_multiple_authors = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("authors", models.ManyToManyField("testapp.Author")),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_indexes = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
382.         ("title", models.CharField(max_length=200)),
383.     ], {
384.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
385.     })
386.     book_unordered_indexes = ModelState("otherapp", "Book", [
387.         ("id", models.AutoField(primary_key=True)),
388.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
389.         ("title", models.CharField(max_length=200)),
390.     ], {
391.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
392.     })
393.     book_foo_together = ModelState("otherapp", "Book", [
394.         ("id", models.AutoField(primary_key=True)),
395.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
396.         ("title", models.CharField(max_length=200)),
397.     ], {
398.         "index_together": {("author", "title")},
399.         "unique_together": {("author", "title")},
400.     })
401.     book_foo_together_2 = ModelState("otherapp", "Book", [
402.         ("id", models.AutoField(primary_key=True)),
403.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
404.         ("title", models.CharField(max_length=200)),
405.     ], {
406.         "index_together": {("title", "author")},
407.         "unique_together": {("title", "author")},
408.     })
409.     book_foo_together_3 = ModelState("otherapp", "Book", [
410.         ("id", models.AutoField(primary_key=True)),
411.         ("newfield", models.IntegerField()),
412.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
413.         ("title", models.CharField(max_length=200)),
414.     ], {
415.         "index_together": {("title", "newfield")},
416.         "unique_together": {("title", "newfield")},
417.     })
418.     book_foo_together_4 = ModelState("otherapp", "Book", [
419.         ("id", models.AutoField(primary_key=True)),
420.         ("newfield2", models.IntegerField()),
421.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
422.         ("title", models.CharField(max_length=200)),
423.     ], {
424.         "index_together": {("title", "newfield2")},
425.         "unique_together": {("title", "newfield2")},
426.     })
427.     attribution = ModelState("otherapp", "Attribution", [
428.         ("id", models.AutoField(primary_key=True)),
429.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
430.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
431.     ])
432.     edition = ModelState("thirdapp", "Edition", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
435.     ])
436.     custom_user = ModelState("thirdapp", "CustomUser", [
437.         ("id", models.AutoField(primary_key=True)),
438.         ("username", models.CharField(max_length=255)),
439.     ], bases=(AbstractBaseUser,))
440.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
441.         ("id", models.AutoField(primary_key=True)),
442.         ("username", models.CharField(max_length=255)),
443.     ])
444.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
445.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
446.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
447.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
448.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
449.     ])
450.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
451.     rabbit = ModelState("eggs", "Rabbit", [
452.         ("id", models.AutoField(primary_key=True)),
453.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
454.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
455.     ], {
456.         "unique_together": {("parent", "knight")},
457.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
458.     })
459. 
460.     def repr_changes(self, changes, include_dependencies=False):
461.         output = ""
462.         for app_label, migrations in sorted(changes.items()):
463.             output += "  %s:\n" % app_label
464.             for migration in migrations:
465.                 output += "    %s\n" % migration.name
466.                 for operation in migration.operations:
467.                     output += "      %s\n" % operation
468.                 if include_dependencies:
469.                     output += "      Dependencies:\n"
470.                     if migration.dependencies:
471.                         for dep in migration.dependencies:
472.                             output += "        %s\n" % (dep,)
473.                     else:
474.                         output += "        None\n"
475.         return output
476. 
477.     def assertNumberMigrations(self, changes, app_label, number):
478.         if len(changes.get(app_label, [])) != number:
479.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
480.                 len(changes.get(app_label, [])),
481.                 app_label,
482.                 number,
483.                 self.repr_changes(changes),
484.             ))
485. 
486.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
487.         if not changes.get(app_label):
488.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
489.         if len(changes[app_label]) < position + 1:
490.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
491.         migration = changes[app_label][position]
492.         if set(migration.dependencies) != set(dependencies):
493.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
494.                 app_label,
495.                 migration.name,
496.                 dependencies,
497.                 self.repr_changes(changes, include_dependencies=True),
498.             ))
499. 
500.     def assertOperationTypes(self, changes, app_label, position, types):


File: tests/migrations/test_autodetector.py
Line number range: 501 - 5000
Content:
501.         if not changes.get(app_label):
502.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
503.         if len(changes[app_label]) < position + 1:
504.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
505.         migration = changes[app_label][position]
506.         real_types = [operation.__class__.__name__ for operation in migration.operations]
507.         if types != real_types:
508.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
509.                 app_label,
510.                 migration.name,
511.                 types,
512.                 self.repr_changes(changes),
513.             ))
514. 
515.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
516.         if not changes.get(app_label):
517.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
518.         if len(changes[app_label]) < position + 1:
519.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
520.         migration = changes[app_label][position]
521.         if len(changes[app_label]) < position + 1:
522.             self.fail("No operation at index %s for %s.%s\n%s" % (
523.                 operation_position,
524.                 app_label,
525.                 migration.name,
526.                 self.repr_changes(changes),
527.             ))
528.         operation = migration.operations[operation_position]
529.         for attr, value in attrs.items():
530.             if getattr(operation, attr, None) != value:
531.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
532.                     app_label,
533.                     migration.name,
534.                     operation_position,
535.                     attr,
536.                     value,
537.                     getattr(operation, attr, None),
538.                     self.repr_changes(changes),
539.                 ))
540. 
541.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
542.         if not changes.get(app_label):
543.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
544.         if len(changes[app_label]) < position + 1:
545.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
546.         migration = changes[app_label][position]
547.         if len(changes[app_label]) < position + 1:
548.             self.fail("No operation at index %s for %s.%s\n%s" % (
549.                 operation_position,
550.                 app_label,
551.                 migration.name,
552.                 self.repr_changes(changes),
553.             ))
554.         operation = migration.operations[operation_position]
555.         if not hasattr(operation, 'field'):
556.             self.fail("No field attribute for %s.%s op #%s." % (
557.                 app_label,
558.                 migration.name,
559.                 operation_position,
560.             ))
561.         field = operation.field
562.         for attr, value in attrs.items():
563.             if getattr(field, attr, None) != value:
564.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
565.                     app_label,
566.                     migration.name,
567.                     operation_position,
568.                     attr,
569.                     value,
570.                     getattr(field, attr, None),
571.                     self.repr_changes(changes),
572.                 ))
573. 
574.     def make_project_state(self, model_states):
575.         "Shortcut to make ProjectStates from lists of predefined models"
576.         project_state = ProjectState()
577.         for model_state in model_states:
578.             project_state.add_model(model_state.clone())
579.         return project_state
580. 
581.     def get_changes(self, before_states, after_states, questioner=None):
582.         return MigrationAutodetector(
583.             self.make_project_state(before_states),
584.             self.make_project_state(after_states),
585.             questioner,
586.         )._detect_changes()
587. 
588.     def test_arrange_for_graph(self):
589.         """Tests auto-naming of migrations for graph matching."""
590.         # Make a fake graph
591.         graph = MigrationGraph()
592.         graph.add_node(("testapp", "0001_initial"), None)
593.         graph.add_node(("testapp", "0002_foobar"), None)
594.         graph.add_node(("otherapp", "0001_initial"), None)
595.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
596.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
597.         # Use project state to make a new migration change set
598.         before = self.make_project_state([])
599.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
600.         autodetector = MigrationAutodetector(before, after)
601.         changes = autodetector._detect_changes()
602.         # Run through arrange_for_graph
603.         changes = autodetector.arrange_for_graph(changes, graph)
604.         # Make sure there's a new name, deps match, etc.
605.         self.assertEqual(changes["testapp"][0].name, "0003_author")
606.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
607.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
608.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
609. 
610.     def test_trim_apps(self):
611.         """
612.         Trim does not remove dependencies but does remove unwanted apps.
613.         """
614.         # Use project state to make a new migration change set
615.         before = self.make_project_state([])
616.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
617.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
618.         changes = autodetector._detect_changes()
619.         # Run through arrange_for_graph
620.         graph = MigrationGraph()
621.         changes = autodetector.arrange_for_graph(changes, graph)
622.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
623.         changes = autodetector._trim_to_apps(changes, {"testapp"})
624.         # Make sure there's the right set of migrations
625.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
626.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
627.         self.assertNotIn("thirdapp", changes)
628. 
629.     def test_custom_migration_name(self):
630.         """Tests custom naming of migrations for graph matching."""
631.         # Make a fake graph
632.         graph = MigrationGraph()
633.         graph.add_node(("testapp", "0001_initial"), None)
634.         graph.add_node(("testapp", "0002_foobar"), None)
635.         graph.add_node(("otherapp", "0001_initial"), None)
636.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
637. 
638.         # Use project state to make a new migration change set
639.         before = self.make_project_state([])
640.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
641.         autodetector = MigrationAutodetector(before, after)
642.         changes = autodetector._detect_changes()
643. 
644.         # Run through arrange_for_graph
645.         migration_name = 'custom_name'
646.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
647. 
648.         # Make sure there's a new name, deps match, etc.
649.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
650.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
651.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
652.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
653. 
654.     def test_new_model(self):
655.         """Tests autodetection of new models."""
656.         changes = self.get_changes([], [self.other_pony_food])
657.         # Right number/type of migrations?
658.         self.assertNumberMigrations(changes, 'otherapp', 1)
659.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
660.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
661.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
662.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
663. 
664.     def test_old_model(self):
665.         """Tests deletion of old models."""
666.         changes = self.get_changes([self.author_empty], [])
667.         # Right number/type of migrations?
668.         self.assertNumberMigrations(changes, 'testapp', 1)
669.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
670.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
671. 
672.     def test_add_field(self):
673.         """Tests autodetection of new fields."""
674.         changes = self.get_changes([self.author_empty], [self.author_name])
675.         # Right number/type of migrations?
676.         self.assertNumberMigrations(changes, 'testapp', 1)
677.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
678.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
679. 
680.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
681.                 side_effect=AssertionError("Should not have prompted for not null addition"))
682.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
683.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
684.         # Right number/type of migrations?
685.         self.assertNumberMigrations(changes, 'testapp', 1)
686.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
687.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
688.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
689.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
690. 
691.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
692.                 side_effect=AssertionError("Should not have prompted for not null addition"))
693.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
694.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
695.         # Right number/type of migrations?
696.         self.assertNumberMigrations(changes, 'testapp', 1)
697.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
698.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
699.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
700.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
701. 
702.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
703.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
704.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
705.         # Right number/type of migrations?
706.         self.assertNumberMigrations(changes, 'testapp', 1)
707.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
708.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
709.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
710.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
711.         self.assertEqual(mocked_ask_method.call_count, 3)
712. 
713.     def test_remove_field(self):
714.         """Tests autodetection of removed fields."""
715.         changes = self.get_changes([self.author_name], [self.author_empty])
716.         # Right number/type of migrations?
717.         self.assertNumberMigrations(changes, 'testapp', 1)
718.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
719.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
720. 
721.     def test_alter_field(self):
722.         """Tests autodetection of new fields."""
723.         changes = self.get_changes([self.author_name], [self.author_name_longer])
724.         # Right number/type of migrations?
725.         self.assertNumberMigrations(changes, 'testapp', 1)
726.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
727.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
728. 
729.     def test_supports_functools_partial(self):
730.         def _content_file_name(instance, filename, key, **kwargs):
731.             return '{}/{}'.format(instance, filename)
732. 
733.         def content_file_name(key, **kwargs):
734.             return functools.partial(_content_file_name, key, **kwargs)
735. 
736.         # An unchanged partial reference.
737.         before = [ModelState("testapp", "Author", [
738.             ("id", models.AutoField(primary_key=True)),
739.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
740.         ])]
741.         after = [ModelState("testapp", "Author", [
742.             ("id", models.AutoField(primary_key=True)),
743.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
744.         ])]
745.         changes = self.get_changes(before, after)
746.         self.assertNumberMigrations(changes, 'testapp', 0)
747. 
748.         # A changed partial reference.
749.         args_changed = [ModelState("testapp", "Author", [
750.             ("id", models.AutoField(primary_key=True)),
751.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
752.         ])]
753.         changes = self.get_changes(before, args_changed)
754.         self.assertNumberMigrations(changes, 'testapp', 1)
755.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
756.         # Can't use assertOperationFieldAttributes because we need the
757.         # deconstructed version, i.e., the exploded func/args/keywords rather
758.         # than the partial: we don't care if it's not the same instance of the
759.         # partial, only if it's the same source function, args, and keywords.
760.         value = changes['testapp'][0].operations[0].field.upload_to
761.         self.assertEqual(
762.             (_content_file_name, ('other-file',), {}),
763.             (value.func, value.args, value.keywords)
764.         )
765. 
766.         kwargs_changed = [ModelState("testapp", "Author", [
767.             ("id", models.AutoField(primary_key=True)),
768.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
769.         ])]
770.         changes = self.get_changes(before, kwargs_changed)
771.         self.assertNumberMigrations(changes, 'testapp', 1)
772.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
773.         value = changes['testapp'][0].operations[0].field.upload_to
774.         self.assertEqual(
775.             (_content_file_name, ('file',), {'spam': 'eggs'}),
776.             (value.func, value.args, value.keywords)
777.         )
778. 
779.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
780.                 side_effect=AssertionError("Should not have prompted for not null addition"))
781.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
782.         """
783.         #23609 - Tests autodetection of nullable to non-nullable alterations.
784.         """
785.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
786.         # Right number/type of migrations?
787.         self.assertNumberMigrations(changes, 'testapp', 1)
788.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
789.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
790.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
791. 
792.     @mock.patch(
793.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
794.         return_value=models.NOT_PROVIDED,
795.     )
796.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
797.         """
798.         #23609 - Tests autodetection of nullable to non-nullable alterations.
799.         """
800.         changes = self.get_changes([self.author_name_null], [self.author_name])
801.         self.assertEqual(mocked_ask_method.call_count, 1)
802.         # Right number/type of migrations?
803.         self.assertNumberMigrations(changes, 'testapp', 1)
804.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
805.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
806.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
807. 
808.     @mock.patch(
809.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
810.         return_value='Some Name',
811.     )
812.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
813.         """
814.         #23609 - Tests autodetection of nullable to non-nullable alterations.
815.         """
816.         changes = self.get_changes([self.author_name_null], [self.author_name])
817.         self.assertEqual(mocked_ask_method.call_count, 1)
818.         # Right number/type of migrations?
819.         self.assertNumberMigrations(changes, 'testapp', 1)
820.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
821.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
822.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
823. 
824.     def test_rename_field(self):
825.         """Tests autodetection of renamed fields."""
826.         changes = self.get_changes(
827.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
828.         )
829.         # Right number/type of migrations?
830.         self.assertNumberMigrations(changes, 'testapp', 1)
831.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
832.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
833. 
834.     def test_rename_field_foreign_key_to_field(self):
835.         before = [
836.             ModelState('app', 'Foo', [
837.                 ('id', models.AutoField(primary_key=True)),
838.                 ('field', models.IntegerField(unique=True)),
839.             ]),
840.             ModelState('app', 'Bar', [
841.                 ('id', models.AutoField(primary_key=True)),
842.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
843.             ]),
844.         ]
845.         after = [
846.             ModelState('app', 'Foo', [
847.                 ('id', models.AutoField(primary_key=True)),
848.                 ('renamed_field', models.IntegerField(unique=True)),
849.             ]),
850.             ModelState('app', 'Bar', [
851.                 ('id', models.AutoField(primary_key=True)),
852.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
853.             ]),
854.         ]
855.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
856.         # Right number/type of migrations?
857.         self.assertNumberMigrations(changes, 'app', 1)
858.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
859.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
860. 
861.     def test_rename_foreign_object_fields(self):
862.         fields = ('first', 'second')
863.         renamed_fields = ('first_renamed', 'second_renamed')
864.         before = [
865.             ModelState('app', 'Foo', [
866.                 ('id', models.AutoField(primary_key=True)),
867.                 ('first', models.IntegerField()),
868.                 ('second', models.IntegerField()),
869.             ], options={'unique_together': {fields}}),
870.             ModelState('app', 'Bar', [
871.                 ('id', models.AutoField(primary_key=True)),
872.                 ('first', models.IntegerField()),
873.                 ('second', models.IntegerField()),
874.                 ('foo', models.ForeignObject(
875.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
876.                 )),
877.             ]),
878.         ]
879.         # Case 1: to_fields renames.
880.         after = [
881.             ModelState('app', 'Foo', [
882.                 ('id', models.AutoField(primary_key=True)),
883.                 ('first_renamed', models.IntegerField()),
884.                 ('second_renamed', models.IntegerField()),
885.             ], options={'unique_together': {renamed_fields}}),
886.             ModelState('app', 'Bar', [
887.                 ('id', models.AutoField(primary_key=True)),
888.                 ('first', models.IntegerField()),
889.                 ('second', models.IntegerField()),
890.                 ('foo', models.ForeignObject(
891.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
892.                 )),
893.             ]),
894.         ]
895.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
896.         self.assertNumberMigrations(changes, 'app', 1)
897.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
898.         self.assertOperationAttributes(
899.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
900.         )
901.         self.assertOperationAttributes(
902.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
903.         )
904.         # Case 2: from_fields renames.
905.         after = [
906.             ModelState('app', 'Foo', [
907.                 ('id', models.AutoField(primary_key=True)),
908.                 ('first', models.IntegerField()),
909.                 ('second', models.IntegerField()),
910.             ], options={'unique_together': {fields}}),
911.             ModelState('app', 'Bar', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first_renamed', models.IntegerField()),
914.                 ('second_renamed', models.IntegerField()),
915.                 ('foo', models.ForeignObject(
916.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
917.                 )),
918.             ]),
919.         ]
920.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
921.         self.assertNumberMigrations(changes, 'app', 1)
922.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
923.         self.assertOperationAttributes(
924.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
925.         )
926.         self.assertOperationAttributes(
927.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
928.         )
929. 
930.     def test_rename_field_preserved_db_column(self):
931.         """
932.         RenameField is used if a field is renamed and db_column equal to the
933.         old field's column is added.
934.         """
935.         before = [
936.             ModelState('app', 'Foo', [
937.                 ('id', models.AutoField(primary_key=True)),
938.                 ('field', models.IntegerField()),
939.             ]),
940.         ]
941.         after = [
942.             ModelState('app', 'Foo', [
943.                 ('id', models.AutoField(primary_key=True)),
944.                 ('renamed_field', models.IntegerField(db_column='field')),
945.             ]),
946.         ]
947.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
948.         self.assertNumberMigrations(changes, 'app', 1)
949.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
950.         self.assertOperationAttributes(
951.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
952.         )
953.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
954.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
955.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
956.         ))
957. 
958.     def test_rename_related_field_preserved_db_column(self):
959.         before = [
960.             ModelState('app', 'Foo', [
961.                 ('id', models.AutoField(primary_key=True)),
962.             ]),
963.             ModelState('app', 'Bar', [
964.                 ('id', models.AutoField(primary_key=True)),
965.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
966.             ]),
967.         ]
968.         after = [
969.             ModelState('app', 'Foo', [
970.                 ('id', models.AutoField(primary_key=True)),
971.             ]),
972.             ModelState('app', 'Bar', [
973.                 ('id', models.AutoField(primary_key=True)),
974.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
975.             ]),
976.         ]
977.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
978.         self.assertNumberMigrations(changes, 'app', 1)
979.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
980.         self.assertOperationAttributes(
981.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
982.         )
983.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
984.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
985.             'renamed_foo',
986.             'django.db.models.ForeignKey',
987.             [],
988.             {'to': 'app.Foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
989.         ))
990. 
991.     def test_rename_model(self):
992.         """Tests autodetection of renamed models."""
993.         changes = self.get_changes(
994.             [self.author_with_book, self.book],
995.             [self.author_renamed_with_book, self.book_with_author_renamed],
996.             MigrationQuestioner({"ask_rename_model": True}),
997.         )
998.         # Right number/type of migrations?
999.         self.assertNumberMigrations(changes, 'testapp', 1)
1000.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1001.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1002.         # Now that RenameModel handles related fields too, there should be
1003.         # no AlterField for the related field.
1004.         self.assertNumberMigrations(changes, 'otherapp', 0)
1005. 
1006.     def test_rename_m2m_through_model(self):
1007.         """
1008.         Tests autodetection of renamed models that are used in M2M relations as
1009.         through models.
1010.         """
1011.         changes = self.get_changes(
1012.             [self.author_with_m2m_through, self.publisher, self.contract],
1013.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1014.             MigrationQuestioner({'ask_rename_model': True})
1015.         )
1016.         # Right number/type of migrations?
1017.         self.assertNumberMigrations(changes, 'testapp', 1)
1018.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1019.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1020. 
1021.     def test_rename_model_with_renamed_rel_field(self):
1022.         """
1023.         Tests autodetection of renamed models while simultaneously renaming one
1024.         of the fields that relate to the renamed model.
1025.         """
1026.         changes = self.get_changes(
1027.             [self.author_with_book, self.book],
1028.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1029.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1030.         )
1031.         # Right number/type of migrations?
1032.         self.assertNumberMigrations(changes, 'testapp', 1)
1033.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1034.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1035.         # Right number/type of migrations for related field rename?
1036.         # Alter is already taken care of.
1037.         self.assertNumberMigrations(changes, 'otherapp', 1)
1038.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1039.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1040. 
1041.     def test_rename_model_with_fks_in_different_position(self):
1042.         """
1043.         #24537 - The order of fields in a model does not influence
1044.         the RenameModel detection.
1045.         """
1046.         before = [
1047.             ModelState("testapp", "EntityA", [
1048.                 ("id", models.AutoField(primary_key=True)),
1049.             ]),
1050.             ModelState("testapp", "EntityB", [
1051.                 ("id", models.AutoField(primary_key=True)),
1052.                 ("some_label", models.CharField(max_length=255)),
1053.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1054.             ]),
1055.         ]
1056.         after = [
1057.             ModelState("testapp", "EntityA", [
1058.                 ("id", models.AutoField(primary_key=True)),
1059.             ]),
1060.             ModelState("testapp", "RenamedEntityB", [
1061.                 ("id", models.AutoField(primary_key=True)),
1062.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1063.                 ("some_label", models.CharField(max_length=255)),
1064.             ]),
1065.         ]
1066.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1067.         self.assertNumberMigrations(changes, "testapp", 1)
1068.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1069.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1070. 
1071.     def test_rename_model_reverse_relation_dependencies(self):
1072.         """
1073.         The migration to rename a model pointed to by a foreign key in another
1074.         app must run after the other app's migration that adds the foreign key
1075.         with model's original name. Therefore, the renaming migration has a
1076.         dependency on that other migration.
1077.         """
1078.         before = [
1079.             ModelState('testapp', 'EntityA', [
1080.                 ('id', models.AutoField(primary_key=True)),
1081.             ]),
1082.             ModelState('otherapp', 'EntityB', [
1083.                 ('id', models.AutoField(primary_key=True)),
1084.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1085.             ]),
1086.         ]
1087.         after = [
1088.             ModelState('testapp', 'RenamedEntityA', [
1089.                 ('id', models.AutoField(primary_key=True)),
1090.             ]),
1091.             ModelState('otherapp', 'EntityB', [
1092.                 ('id', models.AutoField(primary_key=True)),
1093.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1094.             ]),
1095.         ]
1096.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1097.         self.assertNumberMigrations(changes, 'testapp', 1)
1098.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1099.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1100.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1101. 
1102.     def test_fk_dependency(self):
1103.         """Having a ForeignKey automatically adds a dependency."""
1104.         # Note that testapp (author) has no dependencies,
1105.         # otherapp (book) depends on testapp (author),
1106.         # thirdapp (edition) depends on otherapp (book)
1107.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1108.         # Right number/type of migrations?
1109.         self.assertNumberMigrations(changes, 'testapp', 1)
1110.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1111.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1112.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1113.         # Right number/type of migrations?
1114.         self.assertNumberMigrations(changes, 'otherapp', 1)
1115.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1116.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1117.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1118.         # Right number/type of migrations?
1119.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1120.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1121.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1122.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1123. 
1124.     def test_proxy_fk_dependency(self):
1125.         """FK dependencies still work on proxy models."""
1126.         # Note that testapp (author) has no dependencies,
1127.         # otherapp (book) depends on testapp (authorproxy)
1128.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1129.         # Right number/type of migrations?
1130.         self.assertNumberMigrations(changes, 'testapp', 1)
1131.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1132.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1133.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1134.         # Right number/type of migrations?
1135.         self.assertNumberMigrations(changes, 'otherapp', 1)
1136.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1137.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1138.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1139.         # Right number/type of migrations?
1140.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1141.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1142.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1143.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1144. 
1145.     def test_same_app_no_fk_dependency(self):
1146.         """
1147.         A migration with a FK between two models of the same app
1148.         does not have a dependency to itself.
1149.         """
1150.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1151.         # Right number/type of migrations?
1152.         self.assertNumberMigrations(changes, 'testapp', 1)
1153.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1154.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1155.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1156.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1157. 
1158.     def test_circular_fk_dependency(self):
1159.         """
1160.         Having a circular ForeignKey dependency automatically
1161.         resolves the situation into 2 migrations on one side and 1 on the other.
1162.         """
1163.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1164.         # Right number/type of migrations?
1165.         self.assertNumberMigrations(changes, 'testapp', 1)
1166.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1167.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1168.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1169.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1170.         # Right number/type of migrations?
1171.         self.assertNumberMigrations(changes, 'otherapp', 2)
1172.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1173.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1174.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1175.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1176.         # both split migrations should be `initial`
1177.         self.assertTrue(changes['otherapp'][0].initial)
1178.         self.assertTrue(changes['otherapp'][1].initial)
1179. 
1180.     def test_same_app_circular_fk_dependency(self):
1181.         """
1182.         A migration with a FK between two models of the same app does
1183.         not have a dependency to itself.
1184.         """
1185.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1186.         # Right number/type of migrations?
1187.         self.assertNumberMigrations(changes, 'testapp', 1)
1188.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1189.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1190.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1191.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1192.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1193. 
1194.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1195.         """
1196.         #22275 - A migration with circular FK dependency does not try
1197.         to create unique together constraint and indexes before creating all
1198.         required fields first.
1199.         """
1200.         changes = self.get_changes([], [self.knight, self.rabbit])
1201.         # Right number/type of migrations?
1202.         self.assertNumberMigrations(changes, 'eggs', 1)
1203.         self.assertOperationTypes(
1204.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1205.         )
1206.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1207.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1208.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1209. 
1210.     def test_alter_db_table_add(self):
1211.         """Tests detection for adding db_table in model's options."""
1212.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1213.         # Right number/type of migrations?
1214.         self.assertNumberMigrations(changes, 'testapp', 1)
1215.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1216.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1217. 
1218.     def test_alter_db_table_change(self):
1219.         """Tests detection for changing db_table in model's options'."""
1220.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1221.         # Right number/type of migrations?
1222.         self.assertNumberMigrations(changes, 'testapp', 1)
1223.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1224.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1225. 
1226.     def test_alter_db_table_remove(self):
1227.         """Tests detection for removing db_table in model's options."""
1228.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1229.         # Right number/type of migrations?
1230.         self.assertNumberMigrations(changes, 'testapp', 1)
1231.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1232.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1233. 
1234.     def test_alter_db_table_no_changes(self):
1235.         """
1236.         Alter_db_table doesn't generate a migration if no changes have been made.
1237.         """
1238.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1239.         # Right number of migrations?
1240.         self.assertEqual(len(changes), 0)
1241. 
1242.     def test_keep_db_table_with_model_change(self):
1243.         """
1244.         Tests when model changes but db_table stays as-is, autodetector must not
1245.         create more than one operation.
1246.         """
1247.         changes = self.get_changes(
1248.             [self.author_with_db_table_options],
1249.             [self.author_renamed_with_db_table_options],
1250.             MigrationQuestioner({"ask_rename_model": True}),
1251.         )
1252.         # Right number/type of migrations?
1253.         self.assertNumberMigrations(changes, 'testapp', 1)
1254.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1255.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1256. 
1257.     def test_alter_db_table_with_model_change(self):
1258.         """
1259.         Tests when model and db_table changes, autodetector must create two
1260.         operations.
1261.         """
1262.         changes = self.get_changes(
1263.             [self.author_with_db_table_options],
1264.             [self.author_renamed_with_new_db_table_options],
1265.             MigrationQuestioner({"ask_rename_model": True}),
1266.         )
1267.         # Right number/type of migrations?
1268.         self.assertNumberMigrations(changes, 'testapp', 1)
1269.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1270.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1271.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1272. 
1273.     def test_identical_regex_doesnt_alter(self):
1274.         from_state = ModelState(
1275.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1276.                 RegexValidator(
1277.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1278.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1279.                     'invalid'
1280.                 )
1281.             ]))]
1282.         )
1283.         to_state = ModelState(
1284.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1285.         )
1286.         changes = self.get_changes([from_state], [to_state])
1287.         # Right number/type of migrations?
1288.         self.assertNumberMigrations(changes, "testapp", 0)
1289. 
1290.     def test_different_regex_does_alter(self):
1291.         from_state = ModelState(
1292.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1293.                 RegexValidator(
1294.                     re.compile('^[a-z]+\\Z', 32),
1295.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1296.                     'invalid'
1297.                 )
1298.             ]))]
1299.         )
1300.         to_state = ModelState(
1301.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1302.         )
1303.         changes = self.get_changes([from_state], [to_state])
1304.         self.assertNumberMigrations(changes, "testapp", 1)
1305.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1306. 
1307.     def test_empty_foo_together(self):
1308.         """
1309.         #23452 - Empty unique/index_together shouldn't generate a migration.
1310.         """
1311.         # Explicitly testing for not specified, since this is the case after
1312.         # a CreateModel operation w/o any definition on the original model
1313.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1314.         # Explicitly testing for None, since this was the issue in #23452 after
1315.         # an AlterFooTogether operation with e.g. () as value
1316.         model_state_none = ModelState("a", "model", [
1317.             ("id", models.AutoField(primary_key=True))
1318.         ], {
1319.             "index_together": None,
1320.             "unique_together": None,
1321.         })
1322.         # Explicitly testing for the empty set, since we now always have sets.
1323.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1324.         model_state_empty = ModelState("a", "model", [
1325.             ("id", models.AutoField(primary_key=True))
1326.         ], {
1327.             "index_together": set(),
1328.             "unique_together": set(),
1329.         })
1330. 
1331.         def test(from_state, to_state, msg):
1332.             changes = self.get_changes([from_state], [to_state])
1333.             if changes:
1334.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1335.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1336. 
1337.         tests = (
1338.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1339.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1340.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1341.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1342.             (model_state_none, model_state_none, '"None" to "None"'),
1343.             (model_state_none, model_state_empty, '"None" to "empty"'),
1344.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1345.             (model_state_empty, model_state_none, '"empty" to "None"'),
1346.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1347.         )
1348. 
1349.         for t in tests:
1350.             test(*t)
1351. 
1352.     def test_create_model_with_indexes(self):
1353.         """Test creation of new model with indexes already defined."""
1354.         author = ModelState('otherapp', 'Author', [
1355.             ('id', models.AutoField(primary_key=True)),
1356.             ('name', models.CharField(max_length=200)),
1357.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1358.         changes = self.get_changes([], [author])
1359.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1360.         # Right number of migrations?
1361.         self.assertEqual(len(changes['otherapp']), 1)
1362.         # Right number of actions?
1363.         migration = changes['otherapp'][0]
1364.         self.assertEqual(len(migration.operations), 2)
1365.         # Right actions order?
1366.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1367.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1368.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1369. 
1370.     def test_add_indexes(self):
1371.         """Test change detection of new indexes."""
1372.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1373.         self.assertNumberMigrations(changes, 'otherapp', 1)
1374.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1375.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1376.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1377. 
1378.     def test_remove_indexes(self):
1379.         """Test change detection of removed indexes."""
1380.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1381.         # Right number/type of migrations?
1382.         self.assertNumberMigrations(changes, 'otherapp', 1)
1383.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1384.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1385. 
1386.     def test_order_fields_indexes(self):
1387.         """Test change detection of reordering of fields in indexes."""
1388.         changes = self.get_changes(
1389.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1390.         )
1391.         self.assertNumberMigrations(changes, 'otherapp', 1)
1392.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1393.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1394.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1395.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1396. 
1397.     def test_create_model_with_check_constraint(self):
1398.         """Test creation of new model with constraints already defined."""
1399.         author = ModelState('otherapp', 'Author', [
1400.             ('id', models.AutoField(primary_key=True)),
1401.             ('name', models.CharField(max_length=200)),
1402.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1403.         changes = self.get_changes([], [author])
1404.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1405.         # Right number of migrations?
1406.         self.assertEqual(len(changes['otherapp']), 1)
1407.         # Right number of actions?
1408.         migration = changes['otherapp'][0]
1409.         self.assertEqual(len(migration.operations), 2)
1410.         # Right actions order?
1411.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1412.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1413.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1414. 
1415.     def test_add_constraints(self):
1416.         """Test change detection of new constraints."""
1417.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1418.         self.assertNumberMigrations(changes, 'testapp', 1)
1419.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1420.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1421.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1422. 
1423.     def test_remove_constraints(self):
1424.         """Test change detection of removed constraints."""
1425.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1426.         # Right number/type of migrations?
1427.         self.assertNumberMigrations(changes, 'testapp', 1)
1428.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1429.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1430. 
1431.     def test_add_foo_together(self):
1432.         """Tests index/unique_together detection."""
1433.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1434.         # Right number/type of migrations?
1435.         self.assertNumberMigrations(changes, "otherapp", 1)
1436.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1437.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1438.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1439. 
1440.     def test_remove_foo_together(self):
1441.         """Tests index/unique_together detection."""
1442.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1443.         # Right number/type of migrations?
1444.         self.assertNumberMigrations(changes, "otherapp", 1)
1445.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1446.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1447.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1448. 
1449.     def test_foo_together_remove_fk(self):
1450.         """Tests unique_together and field removal detection & ordering"""
1451.         changes = self.get_changes(
1452.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1453.         )
1454.         # Right number/type of migrations?
1455.         self.assertNumberMigrations(changes, "otherapp", 1)
1456.         self.assertOperationTypes(changes, "otherapp", 0, [
1457.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1458.         ])
1459.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1460.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1461.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1462. 
1463.     def test_foo_together_no_changes(self):
1464.         """
1465.         index/unique_together doesn't generate a migration if no
1466.         changes have been made.
1467.         """
1468.         changes = self.get_changes(
1469.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1470.         )
1471.         # Right number of migrations?
1472.         self.assertEqual(len(changes), 0)
1473. 
1474.     def test_foo_together_ordering(self):
1475.         """
1476.         index/unique_together also triggers on ordering changes.
1477.         """
1478.         changes = self.get_changes(
1479.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1480.         )
1481.         # Right number/type of migrations?
1482.         self.assertNumberMigrations(changes, "otherapp", 1)
1483.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1484.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1485.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1486. 
1487.     def test_add_field_and_foo_together(self):
1488.         """
1489.         Added fields will be created before using them in index/unique_together.
1490.         """
1491.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1492.         # Right number/type of migrations?
1493.         self.assertNumberMigrations(changes, "otherapp", 1)
1494.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1495.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1496.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1497. 
1498.     def test_create_model_and_unique_together(self):
1499.         author = ModelState("otherapp", "Author", [
1500.             ("id", models.AutoField(primary_key=True)),
1501.             ("name", models.CharField(max_length=200)),
1502.         ])
1503.         book_with_author = ModelState("otherapp", "Book", [
1504.             ("id", models.AutoField(primary_key=True)),
1505.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1506.             ("title", models.CharField(max_length=200)),
1507.         ], {
1508.             "index_together": {("title", "author")},
1509.             "unique_together": {("title", "author")},
1510.         })
1511.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1512.         # Right number of migrations?
1513.         self.assertEqual(len(changes['otherapp']), 1)
1514.         # Right number of actions?
1515.         migration = changes['otherapp'][0]
1516.         self.assertEqual(len(migration.operations), 4)
1517.         # Right actions order?
1518.         self.assertOperationTypes(
1519.             changes, 'otherapp', 0,
1520.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1521.         )
1522. 
1523.     def test_remove_field_and_foo_together(self):
1524.         """
1525.         Removed fields will be removed after updating index/unique_together.
1526.         """
1527.         changes = self.get_changes(
1528.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1529.         )
1530.         # Right number/type of migrations?
1531.         self.assertNumberMigrations(changes, "otherapp", 1)
1532.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1533.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1534.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1535.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1536. 
1537.     def test_rename_field_and_foo_together(self):
1538.         """
1539.         Removed fields will be removed after updating index/unique_together.
1540.         """
1541.         changes = self.get_changes(
1542.             [self.author_empty, self.book_foo_together_3],
1543.             [self.author_empty, self.book_foo_together_4],
1544.             MigrationQuestioner({"ask_rename": True}),
1545.         )
1546.         # Right number/type of migrations?
1547.         self.assertNumberMigrations(changes, "otherapp", 1)
1548.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1549.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1550.             ("title", "newfield2")
1551.         })
1552.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1553. 
1554.     def test_proxy(self):
1555.         """The autodetector correctly deals with proxy models."""
1556.         # First, we test adding a proxy model
1557.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1558.         # Right number/type of migrations?
1559.         self.assertNumberMigrations(changes, "testapp", 1)
1560.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1561.         self.assertOperationAttributes(
1562.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1563.         )
1564.         # Now, we test turning a proxy model into a non-proxy model
1565.         # It should delete the proxy then make the real one
1566.         changes = self.get_changes(
1567.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1568.         )
1569.         # Right number/type of migrations?
1570.         self.assertNumberMigrations(changes, "testapp", 1)
1571.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1572.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1573.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1574. 
1575.     def test_proxy_custom_pk(self):
1576.         """
1577.         #23415 - The autodetector must correctly deal with custom FK on proxy
1578.         models.
1579.         """
1580.         # First, we test the default pk field name
1581.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1582.         # The field name the FK on the book model points to
1583.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1584.         # Now, we test the custom pk field name
1585.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1586.         # The field name the FK on the book model points to
1587.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1588. 
1589.     def test_proxy_to_mti_with_fk_to_proxy(self):
1590.         # First, test the pk table and field name.
1591.         changes = self.get_changes(
1592.             [],
1593.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1594.         )
1595.         self.assertEqual(
1596.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1597.             'testapp_author',
1598.         )
1599.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1600. 
1601.         # Change AuthorProxy to use MTI.
1602.         changes = self.get_changes(
1603.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1604.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1605.         )
1606.         # Right number/type of migrations for the AuthorProxy model?
1607.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1608.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1609.         # Right number/type of migrations for the Book model with a FK to
1610.         # AuthorProxy?
1611.         self.assertNumberMigrations(changes, 'otherapp', 1)
1612.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1613.         # otherapp should depend on thirdapp.
1614.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1615.         # Now, test the pk table and field name.
1616.         self.assertEqual(
1617.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1618.             'thirdapp_authorproxy',
1619.         )
1620.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1621. 
1622.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1623.         # First, test the pk table and field name.
1624.         changes = self.get_changes(
1625.             [],
1626.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1627.         )
1628.         self.assertEqual(
1629.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1630.             'testapp_author',
1631.         )
1632.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1633. 
1634.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1635.         # a proxy of AuthorProxy.
1636.         changes = self.get_changes(
1637.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1638.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1639.         )
1640.         # Right number/type of migrations for the AuthorProxy model?
1641.         self.assertNumberMigrations(changes, 'testapp', 1)
1642.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1643.         # Right number/type of migrations for the Book model with a FK to
1644.         # AAuthorProxyProxy?
1645.         self.assertNumberMigrations(changes, 'otherapp', 1)
1646.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1647.         # otherapp should depend on testapp.
1648.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1649.         # Now, test the pk table and field name.
1650.         self.assertEqual(
1651.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1652.             'testapp_authorproxy',
1653.         )
1654.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1655. 
1656.     def test_unmanaged_create(self):
1657.         """The autodetector correctly deals with managed models."""
1658.         # First, we test adding an unmanaged model
1659.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1660.         # Right number/type of migrations?
1661.         self.assertNumberMigrations(changes, 'testapp', 1)
1662.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1663.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1664. 
1665.     def test_unmanaged_delete(self):
1666.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1667.         self.assertNumberMigrations(changes, 'testapp', 1)
1668.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1669. 
1670.     def test_unmanaged_to_managed(self):
1671.         # Now, we test turning an unmanaged model into a managed model
1672.         changes = self.get_changes(
1673.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1674.         )
1675.         # Right number/type of migrations?
1676.         self.assertNumberMigrations(changes, 'testapp', 1)
1677.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1678.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1679. 
1680.     def test_managed_to_unmanaged(self):
1681.         # Now, we turn managed to unmanaged.
1682.         changes = self.get_changes(
1683.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1684.         )
1685.         # Right number/type of migrations?
1686.         self.assertNumberMigrations(changes, 'testapp', 1)
1687.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1688.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1689. 
1690.     def test_unmanaged_custom_pk(self):
1691.         """
1692.         #23415 - The autodetector must correctly deal with custom FK on
1693.         unmanaged models.
1694.         """
1695.         # First, we test the default pk field name
1696.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1697.         # The field name the FK on the book model points to
1698.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1699.         # Now, we test the custom pk field name
1700.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1701.         # The field name the FK on the book model points to
1702.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1703. 
1704.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1705.     def test_swappable(self):
1706.         with isolate_lru_cache(apps.get_swappable_settings_name):
1707.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1708.         # Right number/type of migrations?
1709.         self.assertNumberMigrations(changes, 'testapp', 1)
1710.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1711.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1712.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1713. 
1714.     def test_swappable_changed(self):
1715.         with isolate_lru_cache(apps.get_swappable_settings_name):
1716.             before = self.make_project_state([self.custom_user, self.author_with_user])
1717.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1718.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1719.             autodetector = MigrationAutodetector(before, after)
1720.             changes = autodetector._detect_changes()
1721.         # Right number/type of migrations?
1722.         self.assertNumberMigrations(changes, 'testapp', 1)
1723.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1724.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1725.         fk_field = changes['testapp'][0].operations[0].field
1726.         to_model = '%s.%s' % (
1727.             fk_field.remote_field.model._meta.app_label,
1728.             fk_field.remote_field.model._meta.object_name,
1729.         )
1730.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1731. 
1732.     def test_add_field_with_default(self):
1733.         """#22030 - Adding a field with a default should work."""
1734.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1735.         # Right number/type of migrations?
1736.         self.assertNumberMigrations(changes, 'testapp', 1)
1737.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1738.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1739. 
1740.     def test_custom_deconstructible(self):
1741.         """
1742.         Two instances which deconstruct to the same value aren't considered a
1743.         change.
1744.         """
1745.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1746.         # Right number of migrations?
1747.         self.assertEqual(len(changes), 0)
1748. 
1749.     def test_deconstruct_field_kwarg(self):
1750.         """Field instances are handled correctly by nested deconstruction."""
1751.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1752.         self.assertEqual(changes, {})
1753. 
1754.     def test_deconstructible_list(self):
1755.         """Nested deconstruction descends into lists."""
1756.         # When lists contain items that deconstruct to identical values, those lists
1757.         # should be considered equal for the purpose of detecting state changes
1758.         # (even if the original items are unequal).
1759.         changes = self.get_changes(
1760.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1761.         )
1762.         self.assertEqual(changes, {})
1763.         # Legitimate differences within the deconstructed lists should be reported
1764.         # as a change
1765.         changes = self.get_changes(
1766.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1767.         )
1768.         self.assertEqual(len(changes), 1)
1769. 
1770.     def test_deconstructible_tuple(self):
1771.         """Nested deconstruction descends into tuples."""
1772.         # When tuples contain items that deconstruct to identical values, those tuples
1773.         # should be considered equal for the purpose of detecting state changes
1774.         # (even if the original items are unequal).
1775.         changes = self.get_changes(
1776.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1777.         )
1778.         self.assertEqual(changes, {})
1779.         # Legitimate differences within the deconstructed tuples should be reported
1780.         # as a change
1781.         changes = self.get_changes(
1782.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1783.         )
1784.         self.assertEqual(len(changes), 1)
1785. 
1786.     def test_deconstructible_dict(self):
1787.         """Nested deconstruction descends into dict values."""
1788.         # When dicts contain items whose values deconstruct to identical values,
1789.         # those dicts should be considered equal for the purpose of detecting
1790.         # state changes (even if the original values are unequal).
1791.         changes = self.get_changes(
1792.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1793.         )
1794.         self.assertEqual(changes, {})
1795.         # Legitimate differences within the deconstructed dicts should be reported
1796.         # as a change
1797.         changes = self.get_changes(
1798.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1799.         )
1800.         self.assertEqual(len(changes), 1)
1801. 
1802.     def test_nested_deconstructible_objects(self):
1803.         """
1804.         Nested deconstruction is applied recursively to the args/kwargs of
1805.         deconstructed objects.
1806.         """
1807.         # If the items within a deconstructed object's args/kwargs have the same
1808.         # deconstructed values - whether or not the items themselves are different
1809.         # instances - then the object as a whole is regarded as unchanged.
1810.         changes = self.get_changes(
1811.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1812.         )
1813.         self.assertEqual(changes, {})
1814.         # Differences that exist solely within the args list of a deconstructed object
1815.         # should be reported as changes
1816.         changes = self.get_changes(
1817.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1818.         )
1819.         self.assertEqual(len(changes), 1)
1820.         # Additional args should also be reported as a change
1821.         changes = self.get_changes(
1822.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1823.         )
1824.         self.assertEqual(len(changes), 1)
1825.         # Differences that exist solely within the kwargs dict of a deconstructed object
1826.         # should be reported as changes
1827.         changes = self.get_changes(
1828.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1829.         )
1830.         self.assertEqual(len(changes), 1)
1831.         # Additional kwargs should also be reported as a change
1832.         changes = self.get_changes(
1833.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1834.         )
1835.         self.assertEqual(len(changes), 1)
1836. 
1837.     def test_deconstruct_type(self):
1838.         """
1839.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1840.         by deep_deconstruct during serialization.
1841.         """
1842.         author = ModelState(
1843.             "testapp",
1844.             "Author",
1845.             [
1846.                 ("id", models.AutoField(primary_key=True)),
1847.                 ("name", models.CharField(
1848.                     max_length=200,
1849.                     # IntegerField intentionally not instantiated.
1850.                     default=models.IntegerField,
1851.                 ))
1852.             ],
1853.         )
1854.         changes = self.get_changes([], [author])
1855.         # Right number/type of migrations?
1856.         self.assertNumberMigrations(changes, 'testapp', 1)
1857.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1858. 
1859.     def test_replace_string_with_foreignkey(self):
1860.         """
1861.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1862.         work.
1863.         """
1864.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1865.         # Right number/type of migrations?
1866.         self.assertNumberMigrations(changes, 'testapp', 1)
1867.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1868.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1869.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1870.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1871. 
1872.     def test_foreign_key_removed_before_target_model(self):
1873.         """
1874.         Removing an FK and the model it targets in the same change must remove
1875.         the FK field before the model to maintain consistency.
1876.         """
1877.         changes = self.get_changes(
1878.             [self.author_with_publisher, self.publisher], [self.author_name]
1879.         )  # removes both the model and FK
1880.         # Right number/type of migrations?
1881.         self.assertNumberMigrations(changes, 'testapp', 1)
1882.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1883.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1884.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1885. 
1886.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1887.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1888.     def test_add_many_to_many(self, mocked_ask_method):
1889.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1890.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1891.         # Right number/type of migrations?
1892.         self.assertNumberMigrations(changes, 'testapp', 1)
1893.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1894.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1895. 
1896.     def test_alter_many_to_many(self):
1897.         changes = self.get_changes(
1898.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1899.         )
1900.         # Right number/type of migrations?
1901.         self.assertNumberMigrations(changes, 'testapp', 1)
1902.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1903.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1904. 
1905.     def test_create_with_through_model(self):
1906.         """
1907.         Adding a m2m with a through model and the models that use it should be
1908.         ordered correctly.
1909.         """
1910.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1911.         # Right number/type of migrations?
1912.         self.assertNumberMigrations(changes, "testapp", 1)
1913.         self.assertOperationTypes(changes, "testapp", 0, [
1914.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1915.         ])
1916.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1917.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1918.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1919.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1920. 
1921.     def test_many_to_many_removed_before_through_model(self):
1922.         """
1923.         Removing a ManyToManyField and the "through" model in the same change
1924.         must remove the field before the model to maintain consistency.
1925.         """
1926.         changes = self.get_changes(
1927.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1928.             [self.book_with_no_author, self.author_name],
1929.         )
1930.         # Remove both the through model and ManyToMany
1931.         # Right number/type of migrations?
1932.         self.assertNumberMigrations(changes, "otherapp", 1)
1933.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1934.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1935.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1936. 
1937.     def test_many_to_many_removed_before_through_model_2(self):
1938.         """
1939.         Removing a model that contains a ManyToManyField and the "through" model
1940.         in the same change must remove the field before the model to maintain
1941.         consistency.
1942.         """
1943.         changes = self.get_changes(
1944.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1945.             [self.author_name],
1946.         )
1947.         # Remove both the through model and ManyToMany
1948.         # Right number/type of migrations?
1949.         self.assertNumberMigrations(changes, "otherapp", 1)
1950.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
1951.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1952.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1953.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
1954. 
1955.     def test_m2m_w_through_multistep_remove(self):
1956.         """
1957.         A model with a m2m field that specifies a "through" model cannot be
1958.         removed in the same migration as that through model as the schema will
1959.         pass through an inconsistent state. The autodetector should produce two
1960.         migrations to avoid this issue.
1961.         """
1962.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
1963.         # Right number/type of migrations?
1964.         self.assertNumberMigrations(changes, "testapp", 1)
1965.         self.assertOperationTypes(changes, "testapp", 0, [
1966.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
1967.         ])
1968.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
1969.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
1970.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
1971.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
1972. 
1973.     def test_concrete_field_changed_to_many_to_many(self):
1974.         """
1975.         #23938 - Changing a concrete field into a ManyToManyField
1976.         first removes the concrete field and then adds the m2m field.
1977.         """
1978.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
1979.         # Right number/type of migrations?
1980.         self.assertNumberMigrations(changes, "testapp", 1)
1981.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
1982.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
1983.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
1984.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
1985. 
1986.     def test_many_to_many_changed_to_concrete_field(self):
1987.         """
1988.         #23938 - Changing a ManyToManyField into a concrete field
1989.         first removes the m2m field and then adds the concrete field.
1990.         """
1991.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
1992.         # Right number/type of migrations?
1993.         self.assertNumberMigrations(changes, "testapp", 1)
1994.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
1995.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
1996.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
1997.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
1998.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
1999. 
2000.     def test_non_circular_foreignkey_dependency_removal(self):
2001.         """
2002.         If two models with a ForeignKey from one to the other are removed at the
2003.         same time, the autodetector should remove them in the correct order.
2004.         """
2005.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2006.         # Right number/type of migrations?
2007.         self.assertNumberMigrations(changes, "testapp", 1)
2008.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2009.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2010.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2011.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2012. 
2013.     def test_alter_model_options(self):
2014.         """Changing a model's options should make a change."""
2015.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2016.         # Right number/type of migrations?
2017.         self.assertNumberMigrations(changes, "testapp", 1)
2018.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2019.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2020.             "permissions": [('can_hire', 'Can hire')],
2021.             "verbose_name": "Authi",
2022.         })
2023. 
2024.         # Changing them back to empty should also make a change
2025.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2026.         # Right number/type of migrations?
2027.         self.assertNumberMigrations(changes, "testapp", 1)
2028.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2029.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2030. 
2031.     def test_alter_model_options_proxy(self):
2032.         """Changing a proxy model's options should also make a change."""
2033.         changes = self.get_changes(
2034.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2035.         )
2036.         # Right number/type of migrations?
2037.         self.assertNumberMigrations(changes, "testapp", 1)
2038.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2039.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2040.             "verbose_name": "Super Author"
2041.         })
2042. 
2043.     def test_set_alter_order_with_respect_to(self):
2044.         """Setting order_with_respect_to adds a field."""
2045.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2046.         # Right number/type of migrations?
2047.         self.assertNumberMigrations(changes, 'testapp', 1)
2048.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2049.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2050. 
2051.     def test_add_alter_order_with_respect_to(self):
2052.         """
2053.         Setting order_with_respect_to when adding the FK too does
2054.         things in the right order.
2055.         """
2056.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2057.         # Right number/type of migrations?
2058.         self.assertNumberMigrations(changes, 'testapp', 1)
2059.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2060.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2061.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2062. 
2063.     def test_remove_alter_order_with_respect_to(self):
2064.         """
2065.         Removing order_with_respect_to when removing the FK too does
2066.         things in the right order.
2067.         """
2068.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2069.         # Right number/type of migrations?
2070.         self.assertNumberMigrations(changes, 'testapp', 1)
2071.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2072.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2073.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2074. 
2075.     def test_add_model_order_with_respect_to(self):
2076.         """
2077.         Setting order_with_respect_to when adding the whole model
2078.         does things in the right order.
2079.         """
2080.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, 'testapp', 1)
2083.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2084.         self.assertOperationAttributes(
2085.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2086.         )
2087.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2088. 
2089.     def test_alter_model_managers(self):
2090.         """
2091.         Changing the model managers adds a new operation.
2092.         """
2093.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2094.         # Right number/type of migrations?
2095.         self.assertNumberMigrations(changes, 'otherapp', 1)
2096.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2097.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2098.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2099.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2100.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2101.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2102. 
2103.     def test_swappable_first_inheritance(self):
2104.         """Swappable models get their CreateModel first."""
2105.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2106.         # Right number/type of migrations?
2107.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2108.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2109.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2110.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2111. 
2112.     def test_default_related_name_option(self):
2113.         model_state = ModelState('app', 'model', [
2114.             ('id', models.AutoField(primary_key=True)),
2115.         ], options={'default_related_name': 'related_name'})
2116.         changes = self.get_changes([], [model_state])
2117.         self.assertNumberMigrations(changes, 'app', 1)
2118.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2119.         self.assertOperationAttributes(
2120.             changes, 'app', 0, 0, name='model',
2121.             options={'default_related_name': 'related_name'},
2122.         )
2123.         altered_model_state = ModelState('app', 'Model', [
2124.             ('id', models.AutoField(primary_key=True)),
2125.         ])
2126.         changes = self.get_changes([model_state], [altered_model_state])
2127.         self.assertNumberMigrations(changes, 'app', 1)
2128.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2129.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2130. 
2131.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2132.     def test_swappable_first_setting(self):
2133.         """Swappable models get their CreateModel first."""
2134.         with isolate_lru_cache(apps.get_swappable_settings_name):
2135.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2136.         # Right number/type of migrations?
2137.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2138.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2139.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2140.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2141. 
2142.     def test_bases_first(self):
2143.         """Bases of other models come first."""
2144.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2145.         # Right number/type of migrations?
2146.         self.assertNumberMigrations(changes, 'testapp', 1)
2147.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2148.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2149.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2150. 
2151.     def test_multiple_bases(self):
2152.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2153.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2154.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2155.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2156.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2157.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2158.         changes = self.get_changes([], [A, B, C, D, E])
2159.         # Right number/type of migrations?
2160.         self.assertNumberMigrations(changes, "app", 1)
2161.         self.assertOperationTypes(changes, "app", 0, [
2162.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2163.         ])
2164.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2165.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2166.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2167.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2168.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2169. 
2170.     def test_proxy_bases_first(self):
2171.         """Bases of proxies come first."""
2172.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2173.         # Right number/type of migrations?
2174.         self.assertNumberMigrations(changes, 'testapp', 1)
2175.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2176.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2177.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2178.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2179. 
2180.     def test_pk_fk_included(self):
2181.         """
2182.         A relation used as the primary key is kept as part of CreateModel.
2183.         """
2184.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2185.         # Right number/type of migrations?
2186.         self.assertNumberMigrations(changes, 'testapp', 1)
2187.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2188.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2189.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2190. 
2191.     def test_first_dependency(self):
2192.         """
2193.         A dependency to an app with no migrations uses __first__.
2194.         """
2195.         # Load graph
2196.         loader = MigrationLoader(connection)
2197.         before = self.make_project_state([])
2198.         after = self.make_project_state([self.book_migrations_fk])
2199.         after.real_apps = ["migrations"]
2200.         autodetector = MigrationAutodetector(before, after)
2201.         changes = autodetector._detect_changes(graph=loader.graph)
2202.         # Right number/type of migrations?
2203.         self.assertNumberMigrations(changes, 'otherapp', 1)
2204.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2205.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2206.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2207. 
2208.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2209.     def test_last_dependency(self):
2210.         """
2211.         A dependency to an app with existing migrations uses the
2212.         last migration of that app.
2213.         """
2214.         # Load graph
2215.         loader = MigrationLoader(connection)
2216.         before = self.make_project_state([])
2217.         after = self.make_project_state([self.book_migrations_fk])
2218.         after.real_apps = ["migrations"]
2219.         autodetector = MigrationAutodetector(before, after)
2220.         changes = autodetector._detect_changes(graph=loader.graph)
2221.         # Right number/type of migrations?
2222.         self.assertNumberMigrations(changes, 'otherapp', 1)
2223.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2224.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2225.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2226. 
2227.     def test_alter_fk_before_model_deletion(self):
2228.         """
2229.         ForeignKeys are altered _before_ the model they used to
2230.         refer to are deleted.
2231.         """
2232.         changes = self.get_changes(
2233.             [self.author_name, self.publisher_with_author],
2234.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2235.         )
2236.         # Right number/type of migrations?
2237.         self.assertNumberMigrations(changes, 'testapp', 1)
2238.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2239.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2240.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2241.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2242. 
2243.     def test_fk_dependency_other_app(self):
2244.         """
2245.         #23100 - ForeignKeys correctly depend on other apps' models.
2246.         """
2247.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2248.         # Right number/type of migrations?
2249.         self.assertNumberMigrations(changes, 'testapp', 1)
2250.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2251.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2252.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2253. 
2254.     def test_circular_dependency_mixed_addcreate(self):
2255.         """
2256.         #23315 - The dependency resolver knows to put all CreateModel
2257.         before AddField and not become unsolvable.
2258.         """
2259.         address = ModelState("a", "Address", [
2260.             ("id", models.AutoField(primary_key=True)),
2261.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2262.         ])
2263.         person = ModelState("a", "Person", [
2264.             ("id", models.AutoField(primary_key=True)),
2265.         ])
2266.         apackage = ModelState("b", "APackage", [
2267.             ("id", models.AutoField(primary_key=True)),
2268.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2269.         ])
2270.         country = ModelState("b", "DeliveryCountry", [
2271.             ("id", models.AutoField(primary_key=True)),
2272.         ])
2273.         changes = self.get_changes([], [address, person, apackage, country])
2274.         # Right number/type of migrations?
2275.         self.assertNumberMigrations(changes, 'a', 2)
2276.         self.assertNumberMigrations(changes, 'b', 1)
2277.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2278.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2279.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2280. 
2281.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2282.     def test_circular_dependency_swappable(self):
2283.         """
2284.         #23322 - The dependency resolver knows to explicitly resolve
2285.         swappable models.
2286.         """
2287.         with isolate_lru_cache(apps.get_swappable_settings_name):
2288.             tenant = ModelState("a", "Tenant", [
2289.                 ("id", models.AutoField(primary_key=True)),
2290.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2291.                 bases=(AbstractBaseUser,)
2292.             )
2293.             address = ModelState("b", "Address", [
2294.                 ("id", models.AutoField(primary_key=True)),
2295.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2296.             ])
2297.             changes = self.get_changes([], [address, tenant])
2298. 
2299.         # Right number/type of migrations?
2300.         self.assertNumberMigrations(changes, 'a', 2)
2301.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2302.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2303.         self.assertMigrationDependencies(changes, 'a', 0, [])
2304.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2305.         # Right number/type of migrations?
2306.         self.assertNumberMigrations(changes, 'b', 1)
2307.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2308.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2309. 
2310.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2311.     def test_circular_dependency_swappable2(self):
2312.         """
2313.         #23322 - The dependency resolver knows to explicitly resolve
2314.         swappable models but with the swappable not being the first migrated
2315.         model.
2316.         """
2317.         with isolate_lru_cache(apps.get_swappable_settings_name):
2318.             address = ModelState("a", "Address", [
2319.                 ("id", models.AutoField(primary_key=True)),
2320.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2321.             ])
2322.             tenant = ModelState("b", "Tenant", [
2323.                 ("id", models.AutoField(primary_key=True)),
2324.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2325.                 bases=(AbstractBaseUser,)
2326.             )
2327.             changes = self.get_changes([], [address, tenant])
2328.         # Right number/type of migrations?
2329.         self.assertNumberMigrations(changes, 'a', 2)
2330.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2331.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2332.         self.assertMigrationDependencies(changes, 'a', 0, [])
2333.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2334.         # Right number/type of migrations?
2335.         self.assertNumberMigrations(changes, 'b', 1)
2336.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2337.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2338. 
2339.     @override_settings(AUTH_USER_MODEL="a.Person")
2340.     def test_circular_dependency_swappable_self(self):
2341.         """
2342.         #23322 - The dependency resolver knows to explicitly resolve
2343.         swappable models.
2344.         """
2345.         with isolate_lru_cache(apps.get_swappable_settings_name):
2346.             person = ModelState("a", "Person", [
2347.                 ("id", models.AutoField(primary_key=True)),
2348.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2349.             ])
2350.             changes = self.get_changes([], [person])
2351.         # Right number/type of migrations?
2352.         self.assertNumberMigrations(changes, 'a', 1)
2353.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2354.         self.assertMigrationDependencies(changes, 'a', 0, [])
2355. 
2356.     @override_settings(AUTH_USER_MODEL='a.User')
2357.     def test_swappable_circular_multi_mti(self):
2358.         with isolate_lru_cache(apps.get_swappable_settings_name):
2359.             parent = ModelState('a', 'Parent', [
2360.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2361.             ])
2362.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2363.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2364.             changes = self.get_changes([], [parent, child, user])
2365.         self.assertNumberMigrations(changes, 'a', 1)
2366.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2367. 
2368.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2369.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2370.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2371.         """
2372.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2373.         without default should not prompt for a default.
2374.         """
2375.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2376.         # Right number/type of migrations?
2377.         self.assertNumberMigrations(changes, 'testapp', 1)
2378.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2379.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2380. 
2381.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2382.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2383.         """
2384.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2385.         without default should prompt for a default.
2386.         """
2387.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2388.         self.assertEqual(mocked_ask_method.call_count, 2)
2389.         # Right number/type of migrations?
2390.         self.assertNumberMigrations(changes, 'testapp', 1)
2391.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2392.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2393. 
2394.     def test_mti_inheritance_model_removal(self):
2395.         Animal = ModelState('app', 'Animal', [
2396.             ("id", models.AutoField(primary_key=True)),
2397.         ])
2398.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2399.         changes = self.get_changes([Animal, Dog], [Animal])
2400.         self.assertNumberMigrations(changes, 'app', 1)
2401.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2402.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 23:16:40,866 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file `tests/migrations/test_autodetector.py`.\n   - This context block contains the first part of the requested file.\n2. Extended relevance:\n   - This context is essential to fulfill the user's request for the complete file content.", relative_path='tests/migrations/test_autodetector.py', start_line=1, end_line=500), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file `tests/migrations/test_autodetector.py`.\n   - This context block contains the second and final part of the requested file.\n2. Extended relevance:\n   - This context is essential to fulfill the user's request for the complete file content.", relative_path='tests/migrations/test_autodetector.py', start_line=501, end_line=2402)]
2025-12-20 23:16:40,871 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `tests/migrations/test_autodetector.py`.
2025-12-20 23:16:40,871 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 23:16:40,871 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 23:16:40,872 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 0 existing contexts
2025-12-20 23:16:40,872 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-20 23:16:40,873 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── FUNDING.yml
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_remote_user_deprecation.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   └── test_postgresql.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   ├── test_file_charset.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktrans.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_trans.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_deprecated_features.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Change uuid field to FK does not create dependency

Description: Description
	 
		(last modified by Simon Charette)
	 
Hi! I am new in django community, so please help me, because i really dont know is it really "bug".
I have a django project named "testproject" and two apps: testapp1, testapp2.
It will be simpler to understand, with this example:
# TestApp1(models.py):
class App1(models.Model):
	id = models.UUIDField(primary_key=True, unique=True, default=uuid.uuid4, editable=False, verbose_name=_('identifier'))
	text = models.CharField(max_length=100, verbose_name=_('text'))
	another_app = models.UUIDField(null=True, blank=True, verbose_name=_('another app'))
# TestApp2(models.py):
class App2(models.Model):
	id = models.UUIDField(primary_key=True, unique=True, default=uuid.uuid4, editable=False, verbose_name=_('identifier'))
	text = models.CharField(max_length=100, verbose_name=_('text'))
First model named "App1" has UUID field named "another_app":
 another_app = models.UUIDField(null=True, blank=True, verbose_name=_('another app'))
After some time i change field from UUID to FK, like this: 
another_app = models.ForeignKey(App2, null=True, blank=True, on_delete=models.SET_NULL, verbose_name=_('another app'))
And as result i create new migration, but Migration class was unexpected result, because it does not create any "dependencies" for App2, because of FK.
I think the correct solution will be create dependency for App2.
This project use django version 2.2 and postgresql. Attach archive with sources. Project contains small test, after running him, you will get exception like this: ValueError: Related model 'testapp2.App2' cannot be resolved.
So is it problem in django or maybe i dont understand something ?
Here is my post in django users:
​https://groups.google.com/forum/#!searchin/django-users/Django$20bug$3A$20change$20uuid$20field$20to$20FK$20does$20not$20create$20dependency%7Csort:date/django-users/-h9LZxFomLU/yz-NLi1cDgAJ
Regards, Viktor Lomakin

Patch information:
diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py
index 0dc1c77c53..2b37d483ef 100644
--- a/django/db/migrations/autodetector.py
+++ b/django/db/migrations/autodetector.py
@@ -963,6 +963,16 @@ class MigrationAutodetector:
                             preserve_default = False
                     else:
                         field = new_field
+                    dependencies = []
+                    if getattr(new_field, "remote_field", None) and getattr(new_field.remote_field, "model", None):
+                        dependencies.extend(self._get_dependencies_for_foreign_key(new_field))
+                    dependencies = [dep for dep in dependencies if dep[0] != app_label]
+                    seen = set()
+                    unique_dependencies = []
+                    for dep in dependencies:
+                        if dep not in seen:
+                            unique_dependencies.append(dep)
+                            seen.add(dep)
                     self.add_operation(
                         app_label,
                         operations.AlterField(
@@ -970,7 +980,8 @@ class MigrationAutodetector:
                             name=field_name,
                             field=field,
                             preserve_default=preserve_default,
-                        )
+                        ),
+                        dependencies=unique_dependencies,
                     )
                 else:
                     # We cannot alter between m2m and concrete fields


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/migrations/test_autodetector.py`.
Extra Requirements: 
Purpose: I need this file to find test cases that check for the correct creation of dependencies when fields are altered to ForeignKeys.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/migrations/test_autodetector.py
Line number range: 1 - 500
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("title", models.CharField(max_length=200)),
358.     ])
359.     book_with_author_renamed = ModelState("otherapp", "Book", [
360.         ("id", models.AutoField(primary_key=True)),
361.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_multiple_authors = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("authors", models.ManyToManyField("testapp.Author")),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_indexes = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
382.         ("title", models.CharField(max_length=200)),
383.     ], {
384.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
385.     })
386.     book_unordered_indexes = ModelState("otherapp", "Book", [
387.         ("id", models.AutoField(primary_key=True)),
388.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
389.         ("title", models.CharField(max_length=200)),
390.     ], {
391.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
392.     })
393.     book_foo_together = ModelState("otherapp", "Book", [
394.         ("id", models.AutoField(primary_key=True)),
395.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
396.         ("title", models.CharField(max_length=200)),
397.     ], {
398.         "index_together": {("author", "title")},
399.         "unique_together": {("author", "title")},
400.     })
401.     book_foo_together_2 = ModelState("otherapp", "Book", [
402.         ("id", models.AutoField(primary_key=True)),
403.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
404.         ("title", models.CharField(max_length=200)),
405.     ], {
406.         "index_together": {("title", "author")},
407.         "unique_together": {("title", "author")},
408.     })
409.     book_foo_together_3 = ModelState("otherapp", "Book", [
410.         ("id", models.AutoField(primary_key=True)),
411.         ("newfield", models.IntegerField()),
412.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
413.         ("title", models.CharField(max_length=200)),
414.     ], {
415.         "index_together": {("title", "newfield")},
416.         "unique_together": {("title", "newfield")},
417.     })
418.     book_foo_together_4 = ModelState("otherapp", "Book", [
419.         ("id", models.AutoField(primary_key=True)),
420.         ("newfield2", models.IntegerField()),
421.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
422.         ("title", models.CharField(max_length=200)),
423.     ], {
424.         "index_together": {("title", "newfield2")},
425.         "unique_together": {("title", "newfield2")},
426.     })
427.     attribution = ModelState("otherapp", "Attribution", [
428.         ("id", models.AutoField(primary_key=True)),
429.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
430.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
431.     ])
432.     edition = ModelState("thirdapp", "Edition", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
435.     ])
436.     custom_user = ModelState("thirdapp", "CustomUser", [
437.         ("id", models.AutoField(primary_key=True)),
438.         ("username", models.CharField(max_length=255)),
439.     ], bases=(AbstractBaseUser,))
440.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
441.         ("id", models.AutoField(primary_key=True)),
442.         ("username", models.CharField(max_length=255)),
443.     ])
444.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
445.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
446.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
447.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
448.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
449.     ])
450.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
451.     rabbit = ModelState("eggs", "Rabbit", [
452.         ("id", models.AutoField(primary_key=True)),
453.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
454.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
455.     ], {
456.         "unique_together": {("parent", "knight")},
457.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
458.     })
459. 
460.     def repr_changes(self, changes, include_dependencies=False):
461.         output = ""
462.         for app_label, migrations in sorted(changes.items()):
463.             output += "  %s:\n" % app_label
464.             for migration in migrations:
465.                 output += "    %s\n" % migration.name
466.                 for operation in migration.operations:
467.                     output += "      %s\n" % operation
468.                 if include_dependencies:
469.                     output += "      Dependencies:\n"
470.                     if migration.dependencies:
471.                         for dep in migration.dependencies:
472.                             output += "        %s\n" % (dep,)
473.                     else:
474.                         output += "        None\n"
475.         return output
476. 
477.     def assertNumberMigrations(self, changes, app_label, number):
478.         if len(changes.get(app_label, [])) != number:
479.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
480.                 len(changes.get(app_label, [])),
481.                 app_label,
482.                 number,
483.                 self.repr_changes(changes),
484.             ))
485. 
486.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
487.         if not changes.get(app_label):
488.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
489.         if len(changes[app_label]) < position + 1:
490.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
491.         migration = changes[app_label][position]
492.         if set(migration.dependencies) != set(dependencies):
493.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
494.                 app_label,
495.                 migration.name,
496.                 dependencies,
497.                 self.repr_changes(changes, include_dependencies=True),
498.             ))
499. 
500.     def assertOperationTypes(self, changes, app_label, position, types):


File: tests/migrations/test_autodetector.py
Line number range: 501 - 2402
Content:
501.         if not changes.get(app_label):
502.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
503.         if len(changes[app_label]) < position + 1:
504.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
505.         migration = changes[app_label][position]
506.         real_types = [operation.__class__.__name__ for operation in migration.operations]
507.         if types != real_types:
508.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
509.                 app_label,
510.                 migration.name,
511.                 types,
512.                 self.repr_changes(changes),
513.             ))
514. 
515.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
516.         if not changes.get(app_label):
517.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
518.         if len(changes[app_label]) < position + 1:
519.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
520.         migration = changes[app_label][position]
521.         if len(changes[app_label]) < position + 1:
522.             self.fail("No operation at index %s for %s.%s\n%s" % (
523.                 operation_position,
524.                 app_label,
525.                 migration.name,
526.                 self.repr_changes(changes),
527.             ))
528.         operation = migration.operations[operation_position]
529.         for attr, value in attrs.items():
530.             if getattr(operation, attr, None) != value:
531.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
532.                     app_label,
533.                     migration.name,
534.                     operation_position,
535.                     attr,
536.                     value,
537.                     getattr(operation, attr, None),
538.                     self.repr_changes(changes),
539.                 ))
540. 
541.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
542.         if not changes.get(app_label):
543.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
544.         if len(changes[app_label]) < position + 1:
545.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
546.         migration = changes[app_label][position]
547.         if len(changes[app_label]) < position + 1:
548.             self.fail("No operation at index %s for %s.%s\n%s" % (
549.                 operation_position,
550.                 app_label,
551.                 migration.name,
552.                 self.repr_changes(changes),
553.             ))
554.         operation = migration.operations[operation_position]
555.         if not hasattr(operation, 'field'):
556.             self.fail("No field attribute for %s.%s op #%s." % (
557.                 app_label,
558.                 migration.name,
559.                 operation_position,
560.             ))
561.         field = operation.field
562.         for attr, value in attrs.items():
563.             if getattr(field, attr, None) != value:
564.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
565.                     app_label,
566.                     migration.name,
567.                     operation_position,
568.                     attr,
569.                     value,
570.                     getattr(field, attr, None),
571.                     self.repr_changes(changes),
572.                 ))
573. 
574.     def make_project_state(self, model_states):
575.         "Shortcut to make ProjectStates from lists of predefined models"
576.         project_state = ProjectState()
577.         for model_state in model_states:
578.             project_state.add_model(model_state.clone())
579.         return project_state
580. 
581.     def get_changes(self, before_states, after_states, questioner=None):
582.         return MigrationAutodetector(
583.             self.make_project_state(before_states),
584.             self.make_project_state(after_states),
585.             questioner,
586.         )._detect_changes()
587. 
588.     def test_arrange_for_graph(self):
589.         """Tests auto-naming of migrations for graph matching."""
590.         # Make a fake graph
591.         graph = MigrationGraph()
592.         graph.add_node(("testapp", "0001_initial"), None)
593.         graph.add_node(("testapp", "0002_foobar"), None)
594.         graph.add_node(("otherapp", "0001_initial"), None)
595.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
596.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
597.         # Use project state to make a new migration change set
598.         before = self.make_project_state([])
599.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
600.         autodetector = MigrationAutodetector(before, after)
601.         changes = autodetector._detect_changes()
602.         # Run through arrange_for_graph
603.         changes = autodetector.arrange_for_graph(changes, graph)
604.         # Make sure there's a new name, deps match, etc.
605.         self.assertEqual(changes["testapp"][0].name, "0003_author")
606.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
607.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
608.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
609. 
610.     def test_trim_apps(self):
611.         """
612.         Trim does not remove dependencies but does remove unwanted apps.
613.         """
614.         # Use project state to make a new migration change set
615.         before = self.make_project_state([])
616.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
617.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
618.         changes = autodetector._detect_changes()
619.         # Run through arrange_for_graph
620.         graph = MigrationGraph()
621.         changes = autodetector.arrange_for_graph(changes, graph)
622.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
623.         changes = autodetector._trim_to_apps(changes, {"testapp"})
624.         # Make sure there's the right set of migrations
625.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
626.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
627.         self.assertNotIn("thirdapp", changes)
628. 
629.     def test_custom_migration_name(self):
630.         """Tests custom naming of migrations for graph matching."""
631.         # Make a fake graph
632.         graph = MigrationGraph()
633.         graph.add_node(("testapp", "0001_initial"), None)
634.         graph.add_node(("testapp", "0002_foobar"), None)
635.         graph.add_node(("otherapp", "0001_initial"), None)
636.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
637. 
638.         # Use project state to make a new migration change set
639.         before = self.make_project_state([])
640.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
641.         autodetector = MigrationAutodetector(before, after)
642.         changes = autodetector._detect_changes()
643. 
644.         # Run through arrange_for_graph
645.         migration_name = 'custom_name'
646.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
647. 
648.         # Make sure there's a new name, deps match, etc.
649.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
650.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
651.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
652.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
653. 
654.     def test_new_model(self):
655.         """Tests autodetection of new models."""
656.         changes = self.get_changes([], [self.other_pony_food])
657.         # Right number/type of migrations?
658.         self.assertNumberMigrations(changes, 'otherapp', 1)
659.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
660.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
661.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
662.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
663. 
664.     def test_old_model(self):
665.         """Tests deletion of old models."""
666.         changes = self.get_changes([self.author_empty], [])
667.         # Right number/type of migrations?
668.         self.assertNumberMigrations(changes, 'testapp', 1)
669.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
670.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
671. 
672.     def test_add_field(self):
673.         """Tests autodetection of new fields."""
674.         changes = self.get_changes([self.author_empty], [self.author_name])
675.         # Right number/type of migrations?
676.         self.assertNumberMigrations(changes, 'testapp', 1)
677.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
678.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
679. 
680.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
681.                 side_effect=AssertionError("Should not have prompted for not null addition"))
682.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
683.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
684.         # Right number/type of migrations?
685.         self.assertNumberMigrations(changes, 'testapp', 1)
686.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
687.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
688.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
689.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
690. 
691.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
692.                 side_effect=AssertionError("Should not have prompted for not null addition"))
693.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
694.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
695.         # Right number/type of migrations?
696.         self.assertNumberMigrations(changes, 'testapp', 1)
697.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
698.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
699.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
700.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
701. 
702.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
703.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
704.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
705.         # Right number/type of migrations?
706.         self.assertNumberMigrations(changes, 'testapp', 1)
707.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
708.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
709.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
710.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
711.         self.assertEqual(mocked_ask_method.call_count, 3)
712. 
713.     def test_remove_field(self):
714.         """Tests autodetection of removed fields."""
715.         changes = self.get_changes([self.author_name], [self.author_empty])
716.         # Right number/type of migrations?
717.         self.assertNumberMigrations(changes, 'testapp', 1)
718.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
719.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
720. 
721.     def test_alter_field(self):
722.         """Tests autodetection of new fields."""
723.         changes = self.get_changes([self.author_name], [self.author_name_longer])
724.         # Right number/type of migrations?
725.         self.assertNumberMigrations(changes, 'testapp', 1)
726.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
727.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
728. 
729.     def test_supports_functools_partial(self):
730.         def _content_file_name(instance, filename, key, **kwargs):
731.             return '{}/{}'.format(instance, filename)
732. 
733.         def content_file_name(key, **kwargs):
734.             return functools.partial(_content_file_name, key, **kwargs)
735. 
736.         # An unchanged partial reference.
737.         before = [ModelState("testapp", "Author", [
738.             ("id", models.AutoField(primary_key=True)),
739.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
740.         ])]
741.         after = [ModelState("testapp", "Author", [
742.             ("id", models.AutoField(primary_key=True)),
743.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
744.         ])]
745.         changes = self.get_changes(before, after)
746.         self.assertNumberMigrations(changes, 'testapp', 0)
747. 
748.         # A changed partial reference.
749.         args_changed = [ModelState("testapp", "Author", [
750.             ("id", models.AutoField(primary_key=True)),
751.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
752.         ])]
753.         changes = self.get_changes(before, args_changed)
754.         self.assertNumberMigrations(changes, 'testapp', 1)
755.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
756.         # Can't use assertOperationFieldAttributes because we need the
757.         # deconstructed version, i.e., the exploded func/args/keywords rather
758.         # than the partial: we don't care if it's not the same instance of the
759.         # partial, only if it's the same source function, args, and keywords.
760.         value = changes['testapp'][0].operations[0].field.upload_to
761.         self.assertEqual(
762.             (_content_file_name, ('other-file',), {}),
763.             (value.func, value.args, value.keywords)
764.         )
765. 
766.         kwargs_changed = [ModelState("testapp", "Author", [
767.             ("id", models.AutoField(primary_key=True)),
768.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
769.         ])]
770.         changes = self.get_changes(before, kwargs_changed)
771.         self.assertNumberMigrations(changes, 'testapp', 1)
772.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
773.         value = changes['testapp'][0].operations[0].field.upload_to
774.         self.assertEqual(
775.             (_content_file_name, ('file',), {'spam': 'eggs'}),
776.             (value.func, value.args, value.keywords)
777.         )
778. 
779.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
780.                 side_effect=AssertionError("Should not have prompted for not null addition"))
781.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
782.         """
783.         #23609 - Tests autodetection of nullable to non-nullable alterations.
784.         """
785.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
786.         # Right number/type of migrations?
787.         self.assertNumberMigrations(changes, 'testapp', 1)
788.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
789.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
790.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
791. 
792.     @mock.patch(
793.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
794.         return_value=models.NOT_PROVIDED,
795.     )
796.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
797.         """
798.         #23609 - Tests autodetection of nullable to non-nullable alterations.
799.         """
800.         changes = self.get_changes([self.author_name_null], [self.author_name])
801.         self.assertEqual(mocked_ask_method.call_count, 1)
802.         # Right number/type of migrations?
803.         self.assertNumberMigrations(changes, 'testapp', 1)
804.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
805.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
806.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
807. 
808.     @mock.patch(
809.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
810.         return_value='Some Name',
811.     )
812.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
813.         """
814.         #23609 - Tests autodetection of nullable to non-nullable alterations.
815.         """
816.         changes = self.get_changes([self.author_name_null], [self.author_name])
817.         self.assertEqual(mocked_ask_method.call_count, 1)
818.         # Right number/type of migrations?
819.         self.assertNumberMigrations(changes, 'testapp', 1)
820.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
821.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
822.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
823. 
824.     def test_rename_field(self):
825.         """Tests autodetection of renamed fields."""
826.         changes = self.get_changes(
827.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
828.         )
829.         # Right number/type of migrations?
830.         self.assertNumberMigrations(changes, 'testapp', 1)
831.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
832.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
833. 
834.     def test_rename_field_foreign_key_to_field(self):
835.         before = [
836.             ModelState('app', 'Foo', [
837.                 ('id', models.AutoField(primary_key=True)),
838.                 ('field', models.IntegerField(unique=True)),
839.             ]),
840.             ModelState('app', 'Bar', [
841.                 ('id', models.AutoField(primary_key=True)),
842.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
843.             ]),
844.         ]
845.         after = [
846.             ModelState('app', 'Foo', [
847.                 ('id', models.AutoField(primary_key=True)),
848.                 ('renamed_field', models.IntegerField(unique=True)),
849.             ]),
850.             ModelState('app', 'Bar', [
851.                 ('id', models.AutoField(primary_key=True)),
852.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
853.             ]),
854.         ]
855.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
856.         # Right number/type of migrations?
857.         self.assertNumberMigrations(changes, 'app', 1)
858.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
859.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
860. 
861.     def test_rename_foreign_object_fields(self):
862.         fields = ('first', 'second')
863.         renamed_fields = ('first_renamed', 'second_renamed')
864.         before = [
865.             ModelState('app', 'Foo', [
866.                 ('id', models.AutoField(primary_key=True)),
867.                 ('first', models.IntegerField()),
868.                 ('second', models.IntegerField()),
869.             ], options={'unique_together': {fields}}),
870.             ModelState('app', 'Bar', [
871.                 ('id', models.AutoField(primary_key=True)),
872.                 ('first', models.IntegerField()),
873.                 ('second', models.IntegerField()),
874.                 ('foo', models.ForeignObject(
875.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
876.                 )),
877.             ]),
878.         ]
879.         # Case 1: to_fields renames.
880.         after = [
881.             ModelState('app', 'Foo', [
882.                 ('id', models.AutoField(primary_key=True)),
883.                 ('first_renamed', models.IntegerField()),
884.                 ('second_renamed', models.IntegerField()),
885.             ], options={'unique_together': {renamed_fields}}),
886.             ModelState('app', 'Bar', [
887.                 ('id', models.AutoField(primary_key=True)),
888.                 ('first', models.IntegerField()),
889.                 ('second', models.IntegerField()),
890.                 ('foo', models.ForeignObject(
891.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
892.                 )),
893.             ]),
894.         ]
895.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
896.         self.assertNumberMigrations(changes, 'app', 1)
897.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
898.         self.assertOperationAttributes(
899.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
900.         )
901.         self.assertOperationAttributes(
902.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
903.         )
904.         # Case 2: from_fields renames.
905.         after = [
906.             ModelState('app', 'Foo', [
907.                 ('id', models.AutoField(primary_key=True)),
908.                 ('first', models.IntegerField()),
909.                 ('second', models.IntegerField()),
910.             ], options={'unique_together': {fields}}),
911.             ModelState('app', 'Bar', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first_renamed', models.IntegerField()),
914.                 ('second_renamed', models.IntegerField()),
915.                 ('foo', models.ForeignObject(
916.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
917.                 )),
918.             ]),
919.         ]
920.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
921.         self.assertNumberMigrations(changes, 'app', 1)
922.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
923.         self.assertOperationAttributes(
924.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
925.         )
926.         self.assertOperationAttributes(
927.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
928.         )
929. 
930.     def test_rename_field_preserved_db_column(self):
931.         """
932.         RenameField is used if a field is renamed and db_column equal to the
933.         old field's column is added.
934.         """
935.         before = [
936.             ModelState('app', 'Foo', [
937.                 ('id', models.AutoField(primary_key=True)),
938.                 ('field', models.IntegerField()),
939.             ]),
940.         ]
941.         after = [
942.             ModelState('app', 'Foo', [
943.                 ('id', models.AutoField(primary_key=True)),
944.                 ('renamed_field', models.IntegerField(db_column='field')),
945.             ]),
946.         ]
947.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
948.         self.assertNumberMigrations(changes, 'app', 1)
949.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
950.         self.assertOperationAttributes(
951.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
952.         )
953.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
954.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
955.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
956.         ))
957. 
958.     def test_rename_related_field_preserved_db_column(self):
959.         before = [
960.             ModelState('app', 'Foo', [
961.                 ('id', models.AutoField(primary_key=True)),
962.             ]),
963.             ModelState('app', 'Bar', [
964.                 ('id', models.AutoField(primary_key=True)),
965.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
966.             ]),
967.         ]
968.         after = [
969.             ModelState('app', 'Foo', [
970.                 ('id', models.AutoField(primary_key=True)),
971.             ]),
972.             ModelState('app', 'Bar', [
973.                 ('id', models.AutoField(primary_key=True)),
974.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
975.             ]),
976.         ]
977.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
978.         self.assertNumberMigrations(changes, 'app', 1)
979.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
980.         self.assertOperationAttributes(
981.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
982.         )
983.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
984.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
985.             'renamed_foo',
986.             'django.db.models.ForeignKey',
987.             [],
988.             {'to': 'app.Foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
989.         ))
990. 
991.     def test_rename_model(self):
992.         """Tests autodetection of renamed models."""
993.         changes = self.get_changes(
994.             [self.author_with_book, self.book],
995.             [self.author_renamed_with_book, self.book_with_author_renamed],
996.             MigrationQuestioner({"ask_rename_model": True}),
997.         )
998.         # Right number/type of migrations?
999.         self.assertNumberMigrations(changes, 'testapp', 1)
1000.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1001.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1002.         # Now that RenameModel handles related fields too, there should be
1003.         # no AlterField for the related field.
1004.         self.assertNumberMigrations(changes, 'otherapp', 0)
1005. 
1006.     def test_rename_m2m_through_model(self):
1007.         """
1008.         Tests autodetection of renamed models that are used in M2M relations as
1009.         through models.
1010.         """
1011.         changes = self.get_changes(
1012.             [self.author_with_m2m_through, self.publisher, self.contract],
1013.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1014.             MigrationQuestioner({'ask_rename_model': True})
1015.         )
1016.         # Right number/type of migrations?
1017.         self.assertNumberMigrations(changes, 'testapp', 1)
1018.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1019.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1020. 
1021.     def test_rename_model_with_renamed_rel_field(self):
1022.         """
1023.         Tests autodetection of renamed models while simultaneously renaming one
1024.         of the fields that relate to the renamed model.
1025.         """
1026.         changes = self.get_changes(
1027.             [self.author_with_book, self.book],
1028.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1029.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1030.         )
1031.         # Right number/type of migrations?
1032.         self.assertNumberMigrations(changes, 'testapp', 1)
1033.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1034.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1035.         # Right number/type of migrations for related field rename?
1036.         # Alter is already taken care of.
1037.         self.assertNumberMigrations(changes, 'otherapp', 1)
1038.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1039.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1040. 
1041.     def test_rename_model_with_fks_in_different_position(self):
1042.         """
1043.         #24537 - The order of fields in a model does not influence
1044.         the RenameModel detection.
1045.         """
1046.         before = [
1047.             ModelState("testapp", "EntityA", [
1048.                 ("id", models.AutoField(primary_key=True)),
1049.             ]),
1050.             ModelState("testapp", "EntityB", [
1051.                 ("id", models.AutoField(primary_key=True)),
1052.                 ("some_label", models.CharField(max_length=255)),
1053.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1054.             ]),
1055.         ]
1056.         after = [
1057.             ModelState("testapp", "EntityA", [
1058.                 ("id", models.AutoField(primary_key=True)),
1059.             ]),
1060.             ModelState("testapp", "RenamedEntityB", [
1061.                 ("id", models.AutoField(primary_key=True)),
1062.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1063.                 ("some_label", models.CharField(max_length=255)),
1064.             ]),
1065.         ]
1066.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1067.         self.assertNumberMigrations(changes, "testapp", 1)
1068.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1069.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1070. 
1071.     def test_rename_model_reverse_relation_dependencies(self):
1072.         """
1073.         The migration to rename a model pointed to by a foreign key in another
1074.         app must run after the other app's migration that adds the foreign key
1075.         with model's original name. Therefore, the renaming migration has a
1076.         dependency on that other migration.
1077.         """
1078.         before = [
1079.             ModelState('testapp', 'EntityA', [
1080.                 ('id', models.AutoField(primary_key=True)),
1081.             ]),
1082.             ModelState('otherapp', 'EntityB', [
1083.                 ('id', models.AutoField(primary_key=True)),
1084.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1085.             ]),
1086.         ]
1087.         after = [
1088.             ModelState('testapp', 'RenamedEntityA', [
1089.                 ('id', models.AutoField(primary_key=True)),
1090.             ]),
1091.             ModelState('otherapp', 'EntityB', [
1092.                 ('id', models.AutoField(primary_key=True)),
1093.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1094.             ]),
1095.         ]
1096.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1097.         self.assertNumberMigrations(changes, 'testapp', 1)
1098.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1099.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1100.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1101. 
1102.     def test_fk_dependency(self):
1103.         """Having a ForeignKey automatically adds a dependency."""
1104.         # Note that testapp (author) has no dependencies,
1105.         # otherapp (book) depends on testapp (author),
1106.         # thirdapp (edition) depends on otherapp (book)
1107.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1108.         # Right number/type of migrations?
1109.         self.assertNumberMigrations(changes, 'testapp', 1)
1110.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1111.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1112.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1113.         # Right number/type of migrations?
1114.         self.assertNumberMigrations(changes, 'otherapp', 1)
1115.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1116.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1117.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1118.         # Right number/type of migrations?
1119.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1120.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1121.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1122.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1123. 
1124.     def test_proxy_fk_dependency(self):
1125.         """FK dependencies still work on proxy models."""
1126.         # Note that testapp (author) has no dependencies,
1127.         # otherapp (book) depends on testapp (authorproxy)
1128.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1129.         # Right number/type of migrations?
1130.         self.assertNumberMigrations(changes, 'testapp', 1)
1131.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1132.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1133.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1134.         # Right number/type of migrations?
1135.         self.assertNumberMigrations(changes, 'otherapp', 1)
1136.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1137.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1138.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1139.         # Right number/type of migrations?
1140.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1141.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1142.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1143.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1144. 
1145.     def test_same_app_no_fk_dependency(self):
1146.         """
1147.         A migration with a FK between two models of the same app
1148.         does not have a dependency to itself.
1149.         """
1150.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1151.         # Right number/type of migrations?
1152.         self.assertNumberMigrations(changes, 'testapp', 1)
1153.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1154.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1155.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1156.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1157. 
1158.     def test_circular_fk_dependency(self):
1159.         """
1160.         Having a circular ForeignKey dependency automatically
1161.         resolves the situation into 2 migrations on one side and 1 on the other.
1162.         """
1163.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1164.         # Right number/type of migrations?
1165.         self.assertNumberMigrations(changes, 'testapp', 1)
1166.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1167.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1168.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1169.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1170.         # Right number/type of migrations?
1171.         self.assertNumberMigrations(changes, 'otherapp', 2)
1172.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1173.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1174.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1175.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1176.         # both split migrations should be `initial`
1177.         self.assertTrue(changes['otherapp'][0].initial)
1178.         self.assertTrue(changes['otherapp'][1].initial)
1179. 
1180.     def test_same_app_circular_fk_dependency(self):
1181.         """
1182.         A migration with a FK between two models of the same app does
1183.         not have a dependency to itself.
1184.         """
1185.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1186.         # Right number/type of migrations?
1187.         self.assertNumberMigrations(changes, 'testapp', 1)
1188.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1189.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1190.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1191.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1192.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1193. 
1194.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1195.         """
1196.         #22275 - A migration with circular FK dependency does not try
1197.         to create unique together constraint and indexes before creating all
1198.         required fields first.
1199.         """
1200.         changes = self.get_changes([], [self.knight, self.rabbit])
1201.         # Right number/type of migrations?
1202.         self.assertNumberMigrations(changes, 'eggs', 1)
1203.         self.assertOperationTypes(
1204.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1205.         )
1206.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1207.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1208.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1209. 
1210.     def test_alter_db_table_add(self):
1211.         """Tests detection for adding db_table in model's options."""
1212.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1213.         # Right number/type of migrations?
1214.         self.assertNumberMigrations(changes, 'testapp', 1)
1215.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1216.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1217. 
1218.     def test_alter_db_table_change(self):
1219.         """Tests detection for changing db_table in model's options'."""
1220.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1221.         # Right number/type of migrations?
1222.         self.assertNumberMigrations(changes, 'testapp', 1)
1223.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1224.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1225. 
1226.     def test_alter_db_table_remove(self):
1227.         """Tests detection for removing db_table in model's options."""
1228.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1229.         # Right number/type of migrations?
1230.         self.assertNumberMigrations(changes, 'testapp', 1)
1231.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1232.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1233. 
1234.     def test_alter_db_table_no_changes(self):
1235.         """
1236.         Alter_db_table doesn't generate a migration if no changes have been made.
1237.         """
1238.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1239.         # Right number of migrations?
1240.         self.assertEqual(len(changes), 0)
1241. 
1242.     def test_keep_db_table_with_model_change(self):
1243.         """
1244.         Tests when model changes but db_table stays as-is, autodetector must not
1245.         create more than one operation.
1246.         """
1247.         changes = self.get_changes(
1248.             [self.author_with_db_table_options],
1249.             [self.author_renamed_with_db_table_options],
1250.             MigrationQuestioner({"ask_rename_model": True}),
1251.         )
1252.         # Right number/type of migrations?
1253.         self.assertNumberMigrations(changes, 'testapp', 1)
1254.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1255.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1256. 
1257.     def test_alter_db_table_with_model_change(self):
1258.         """
1259.         Tests when model and db_table changes, autodetector must create two
1260.         operations.
1261.         """
1262.         changes = self.get_changes(
1263.             [self.author_with_db_table_options],
1264.             [self.author_renamed_with_new_db_table_options],
1265.             MigrationQuestioner({"ask_rename_model": True}),
1266.         )
1267.         # Right number/type of migrations?
1268.         self.assertNumberMigrations(changes, 'testapp', 1)
1269.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1270.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1271.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1272. 
1273.     def test_identical_regex_doesnt_alter(self):
1274.         from_state = ModelState(
1275.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1276.                 RegexValidator(
1277.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1278.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1279.                     'invalid'
1280.                 )
1281.             ]))]
1282.         )
1283.         to_state = ModelState(
1284.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1285.         )
1286.         changes = self.get_changes([from_state], [to_state])
1287.         # Right number/type of migrations?
1288.         self.assertNumberMigrations(changes, "testapp", 0)
1289. 
1290.     def test_different_regex_does_alter(self):
1291.         from_state = ModelState(
1292.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1293.                 RegexValidator(
1294.                     re.compile('^[a-z]+\\Z', 32),
1295.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1296.                     'invalid'
1297.                 )
1298.             ]))]
1299.         )
1300.         to_state = ModelState(
1301.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1302.         )
1303.         changes = self.get_changes([from_state], [to_state])
1304.         self.assertNumberMigrations(changes, "testapp", 1)
1305.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1306. 
1307.     def test_empty_foo_together(self):
1308.         """
1309.         #23452 - Empty unique/index_together shouldn't generate a migration.
1310.         """
1311.         # Explicitly testing for not specified, since this is the case after
1312.         # a CreateModel operation w/o any definition on the original model
1313.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1314.         # Explicitly testing for None, since this was the issue in #23452 after
1315.         # an AlterFooTogether operation with e.g. () as value
1316.         model_state_none = ModelState("a", "model", [
1317.             ("id", models.AutoField(primary_key=True))
1318.         ], {
1319.             "index_together": None,
1320.             "unique_together": None,
1321.         })
1322.         # Explicitly testing for the empty set, since we now always have sets.
1323.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1324.         model_state_empty = ModelState("a", "model", [
1325.             ("id", models.AutoField(primary_key=True))
1326.         ], {
1327.             "index_together": set(),
1328.             "unique_together": set(),
1329.         })
1330. 
1331.         def test(from_state, to_state, msg):
1332.             changes = self.get_changes([from_state], [to_state])
1333.             if changes:
1334.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1335.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1336. 
1337.         tests = (
1338.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1339.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1340.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1341.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1342.             (model_state_none, model_state_none, '"None" to "None"'),
1343.             (model_state_none, model_state_empty, '"None" to "empty"'),
1344.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1345.             (model_state_empty, model_state_none, '"empty" to "None"'),
1346.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1347.         )
1348. 
1349.         for t in tests:
1350.             test(*t)
1351. 
1352.     def test_create_model_with_indexes(self):
1353.         """Test creation of new model with indexes already defined."""
1354.         author = ModelState('otherapp', 'Author', [
1355.             ('id', models.AutoField(primary_key=True)),
1356.             ('name', models.CharField(max_length=200)),
1357.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1358.         changes = self.get_changes([], [author])
1359.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1360.         # Right number of migrations?
1361.         self.assertEqual(len(changes['otherapp']), 1)
1362.         # Right number of actions?
1363.         migration = changes['otherapp'][0]
1364.         self.assertEqual(len(migration.operations), 2)
1365.         # Right actions order?
1366.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1367.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1368.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1369. 
1370.     def test_add_indexes(self):
1371.         """Test change detection of new indexes."""
1372.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1373.         self.assertNumberMigrations(changes, 'otherapp', 1)
1374.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1375.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1376.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1377. 
1378.     def test_remove_indexes(self):
1379.         """Test change detection of removed indexes."""
1380.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1381.         # Right number/type of migrations?
1382.         self.assertNumberMigrations(changes, 'otherapp', 1)
1383.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1384.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1385. 
1386.     def test_order_fields_indexes(self):
1387.         """Test change detection of reordering of fields in indexes."""
1388.         changes = self.get_changes(
1389.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1390.         )
1391.         self.assertNumberMigrations(changes, 'otherapp', 1)
1392.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1393.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1394.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1395.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1396. 
1397.     def test_create_model_with_check_constraint(self):
1398.         """Test creation of new model with constraints already defined."""
1399.         author = ModelState('otherapp', 'Author', [
1400.             ('id', models.AutoField(primary_key=True)),
1401.             ('name', models.CharField(max_length=200)),
1402.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1403.         changes = self.get_changes([], [author])
1404.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1405.         # Right number of migrations?
1406.         self.assertEqual(len(changes['otherapp']), 1)
1407.         # Right number of actions?
1408.         migration = changes['otherapp'][0]
1409.         self.assertEqual(len(migration.operations), 2)
1410.         # Right actions order?
1411.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1412.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1413.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1414. 
1415.     def test_add_constraints(self):
1416.         """Test change detection of new constraints."""
1417.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1418.         self.assertNumberMigrations(changes, 'testapp', 1)
1419.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1420.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1421.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1422. 
1423.     def test_remove_constraints(self):
1424.         """Test change detection of removed constraints."""
1425.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1426.         # Right number/type of migrations?
1427.         self.assertNumberMigrations(changes, 'testapp', 1)
1428.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1429.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1430. 
1431.     def test_add_foo_together(self):
1432.         """Tests index/unique_together detection."""
1433.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1434.         # Right number/type of migrations?
1435.         self.assertNumberMigrations(changes, "otherapp", 1)
1436.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1437.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1438.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1439. 
1440.     def test_remove_foo_together(self):
1441.         """Tests index/unique_together detection."""
1442.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1443.         # Right number/type of migrations?
1444.         self.assertNumberMigrations(changes, "otherapp", 1)
1445.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1446.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1447.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1448. 
1449.     def test_foo_together_remove_fk(self):
1450.         """Tests unique_together and field removal detection & ordering"""
1451.         changes = self.get_changes(
1452.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1453.         )
1454.         # Right number/type of migrations?
1455.         self.assertNumberMigrations(changes, "otherapp", 1)
1456.         self.assertOperationTypes(changes, "otherapp", 0, [
1457.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1458.         ])
1459.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1460.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1461.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1462. 
1463.     def test_foo_together_no_changes(self):
1464.         """
1465.         index/unique_together doesn't generate a migration if no
1466.         changes have been made.
1467.         """
1468.         changes = self.get_changes(
1469.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1470.         )
1471.         # Right number of migrations?
1472.         self.assertEqual(len(changes), 0)
1473. 
1474.     def test_foo_together_ordering(self):
1475.         """
1476.         index/unique_together also triggers on ordering changes.
1477.         """
1478.         changes = self.get_changes(
1479.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1480.         )
1481.         # Right number/type of migrations?
1482.         self.assertNumberMigrations(changes, "otherapp", 1)
1483.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1484.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1485.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1486. 
1487.     def test_add_field_and_foo_together(self):
1488.         """
1489.         Added fields will be created before using them in index/unique_together.
1490.         """
1491.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1492.         # Right number/type of migrations?
1493.         self.assertNumberMigrations(changes, "otherapp", 1)
1494.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1495.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1496.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1497. 
1498.     def test_create_model_and_unique_together(self):
1499.         author = ModelState("otherapp", "Author", [
1500.             ("id", models.AutoField(primary_key=True)),
1501.             ("name", models.CharField(max_length=200)),
1502.         ])
1503.         book_with_author = ModelState("otherapp", "Book", [
1504.             ("id", models.AutoField(primary_key=True)),
1505.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1506.             ("title", models.CharField(max_length=200)),
1507.         ], {
1508.             "index_together": {("title", "author")},
1509.             "unique_together": {("title", "author")},
1510.         })
1511.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1512.         # Right number of migrations?
1513.         self.assertEqual(len(changes['otherapp']), 1)
1514.         # Right number of actions?
1515.         migration = changes['otherapp'][0]
1516.         self.assertEqual(len(migration.operations), 4)
1517.         # Right actions order?
1518.         self.assertOperationTypes(
1519.             changes, 'otherapp', 0,
1520.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1521.         )
1522. 
1523.     def test_remove_field_and_foo_together(self):
1524.         """
1525.         Removed fields will be removed after updating index/unique_together.
1526.         """
1527.         changes = self.get_changes(
1528.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1529.         )
1530.         # Right number/type of migrations?
1531.         self.assertNumberMigrations(changes, "otherapp", 1)
1532.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1533.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1534.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1535.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1536. 
1537.     def test_rename_field_and_foo_together(self):
1538.         """
1539.         Removed fields will be removed after updating index/unique_together.
1540.         """
1541.         changes = self.get_changes(
1542.             [self.author_empty, self.book_foo_together_3],
1543.             [self.author_empty, self.book_foo_together_4],
1544.             MigrationQuestioner({"ask_rename": True}),
1545.         )
1546.         # Right number/type of migrations?
1547.         self.assertNumberMigrations(changes, "otherapp", 1)
1548.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1549.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1550.             ("title", "newfield2")
1551.         })
1552.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1553. 
1554.     def test_proxy(self):
1555.         """The autodetector correctly deals with proxy models."""
1556.         # First, we test adding a proxy model
1557.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1558.         # Right number/type of migrations?
1559.         self.assertNumberMigrations(changes, "testapp", 1)
1560.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1561.         self.assertOperationAttributes(
1562.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1563.         )
1564.         # Now, we test turning a proxy model into a non-proxy model
1565.         # It should delete the proxy then make the real one
1566.         changes = self.get_changes(
1567.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1568.         )
1569.         # Right number/type of migrations?
1570.         self.assertNumberMigrations(changes, "testapp", 1)
1571.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1572.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1573.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1574. 
1575.     def test_proxy_custom_pk(self):
1576.         """
1577.         #23415 - The autodetector must correctly deal with custom FK on proxy
1578.         models.
1579.         """
1580.         # First, we test the default pk field name
1581.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1582.         # The field name the FK on the book model points to
1583.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1584.         # Now, we test the custom pk field name
1585.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1586.         # The field name the FK on the book model points to
1587.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1588. 
1589.     def test_proxy_to_mti_with_fk_to_proxy(self):
1590.         # First, test the pk table and field name.
1591.         changes = self.get_changes(
1592.             [],
1593.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1594.         )
1595.         self.assertEqual(
1596.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1597.             'testapp_author',
1598.         )
1599.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1600. 
1601.         # Change AuthorProxy to use MTI.
1602.         changes = self.get_changes(
1603.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1604.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1605.         )
1606.         # Right number/type of migrations for the AuthorProxy model?
1607.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1608.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1609.         # Right number/type of migrations for the Book model with a FK to
1610.         # AuthorProxy?
1611.         self.assertNumberMigrations(changes, 'otherapp', 1)
1612.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1613.         # otherapp should depend on thirdapp.
1614.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1615.         # Now, test the pk table and field name.
1616.         self.assertEqual(
1617.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1618.             'thirdapp_authorproxy',
1619.         )
1620.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1621. 
1622.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1623.         # First, test the pk table and field name.
1624.         changes = self.get_changes(
1625.             [],
1626.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1627.         )
1628.         self.assertEqual(
1629.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1630.             'testapp_author',
1631.         )
1632.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1633. 
1634.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1635.         # a proxy of AuthorProxy.
1636.         changes = self.get_changes(
1637.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1638.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1639.         )
1640.         # Right number/type of migrations for the AuthorProxy model?
1641.         self.assertNumberMigrations(changes, 'testapp', 1)
1642.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1643.         # Right number/type of migrations for the Book model with a FK to
1644.         # AAuthorProxyProxy?
1645.         self.assertNumberMigrations(changes, 'otherapp', 1)
1646.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1647.         # otherapp should depend on testapp.
1648.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1649.         # Now, test the pk table and field name.
1650.         self.assertEqual(
1651.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1652.             'testapp_authorproxy',
1653.         )
1654.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1655. 
1656.     def test_unmanaged_create(self):
1657.         """The autodetector correctly deals with managed models."""
1658.         # First, we test adding an unmanaged model
1659.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1660.         # Right number/type of migrations?
1661.         self.assertNumberMigrations(changes, 'testapp', 1)
1662.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1663.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1664. 
1665.     def test_unmanaged_delete(self):
1666.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1667.         self.assertNumberMigrations(changes, 'testapp', 1)
1668.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1669. 
1670.     def test_unmanaged_to_managed(self):
1671.         # Now, we test turning an unmanaged model into a managed model
1672.         changes = self.get_changes(
1673.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1674.         )
1675.         # Right number/type of migrations?
1676.         self.assertNumberMigrations(changes, 'testapp', 1)
1677.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1678.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1679. 
1680.     def test_managed_to_unmanaged(self):
1681.         # Now, we turn managed to unmanaged.
1682.         changes = self.get_changes(
1683.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1684.         )
1685.         # Right number/type of migrations?
1686.         self.assertNumberMigrations(changes, 'testapp', 1)
1687.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1688.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1689. 
1690.     def test_unmanaged_custom_pk(self):
1691.         """
1692.         #23415 - The autodetector must correctly deal with custom FK on
1693.         unmanaged models.
1694.         """
1695.         # First, we test the default pk field name
1696.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1697.         # The field name the FK on the book model points to
1698.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1699.         # Now, we test the custom pk field name
1700.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1701.         # The field name the FK on the book model points to
1702.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1703. 
1704.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1705.     def test_swappable(self):
1706.         with isolate_lru_cache(apps.get_swappable_settings_name):
1707.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1708.         # Right number/type of migrations?
1709.         self.assertNumberMigrations(changes, 'testapp', 1)
1710.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1711.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1712.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1713. 
1714.     def test_swappable_changed(self):
1715.         with isolate_lru_cache(apps.get_swappable_settings_name):
1716.             before = self.make_project_state([self.custom_user, self.author_with_user])
1717.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1718.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1719.             autodetector = MigrationAutodetector(before, after)
1720.             changes = autodetector._detect_changes()
1721.         # Right number/type of migrations?
1722.         self.assertNumberMigrations(changes, 'testapp', 1)
1723.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1724.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1725.         fk_field = changes['testapp'][0].operations[0].field
1726.         to_model = '%s.%s' % (
1727.             fk_field.remote_field.model._meta.app_label,
1728.             fk_field.remote_field.model._meta.object_name,
1729.         )
1730.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1731. 
1732.     def test_add_field_with_default(self):
1733.         """#22030 - Adding a field with a default should work."""
1734.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1735.         # Right number/type of migrations?
1736.         self.assertNumberMigrations(changes, 'testapp', 1)
1737.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1738.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1739. 
1740.     def test_custom_deconstructible(self):
1741.         """
1742.         Two instances which deconstruct to the same value aren't considered a
1743.         change.
1744.         """
1745.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1746.         # Right number of migrations?
1747.         self.assertEqual(len(changes), 0)
1748. 
1749.     def test_deconstruct_field_kwarg(self):
1750.         """Field instances are handled correctly by nested deconstruction."""
1751.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1752.         self.assertEqual(changes, {})
1753. 
1754.     def test_deconstructible_list(self):
1755.         """Nested deconstruction descends into lists."""
1756.         # When lists contain items that deconstruct to identical values, those lists
1757.         # should be considered equal for the purpose of detecting state changes
1758.         # (even if the original items are unequal).
1759.         changes = self.get_changes(
1760.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1761.         )
1762.         self.assertEqual(changes, {})
1763.         # Legitimate differences within the deconstructed lists should be reported
1764.         # as a change
1765.         changes = self.get_changes(
1766.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1767.         )
1768.         self.assertEqual(len(changes), 1)
1769. 
1770.     def test_deconstructible_tuple(self):
1771.         """Nested deconstruction descends into tuples."""
1772.         # When tuples contain items that deconstruct to identical values, those tuples
1773.         # should be considered equal for the purpose of detecting state changes
1774.         # (even if the original items are unequal).
1775.         changes = self.get_changes(
1776.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1777.         )
1778.         self.assertEqual(changes, {})
1779.         # Legitimate differences within the deconstructed tuples should be reported
1780.         # as a change
1781.         changes = self.get_changes(
1782.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1783.         )
1784.         self.assertEqual(len(changes), 1)
1785. 
1786.     def test_deconstructible_dict(self):
1787.         """Nested deconstruction descends into dict values."""
1788.         # When dicts contain items whose values deconstruct to identical values,
1789.         # those dicts should be considered equal for the purpose of detecting
1790.         # state changes (even if the original values are unequal).
1791.         changes = self.get_changes(
1792.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1793.         )
1794.         self.assertEqual(changes, {})
1795.         # Legitimate differences within the deconstructed dicts should be reported
1796.         # as a change
1797.         changes = self.get_changes(
1798.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1799.         )
1800.         self.assertEqual(len(changes), 1)
1801. 
1802.     def test_nested_deconstructible_objects(self):
1803.         """
1804.         Nested deconstruction is applied recursively to the args/kwargs of
1805.         deconstructed objects.
1806.         """
1807.         # If the items within a deconstructed object's args/kwargs have the same
1808.         # deconstructed values - whether or not the items themselves are different
1809.         # instances - then the object as a whole is regarded as unchanged.
1810.         changes = self.get_changes(
1811.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1812.         )
1813.         self.assertEqual(changes, {})
1814.         # Differences that exist solely within the args list of a deconstructed object
1815.         # should be reported as changes
1816.         changes = self.get_changes(
1817.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1818.         )
1819.         self.assertEqual(len(changes), 1)
1820.         # Additional args should also be reported as a change
1821.         changes = self.get_changes(
1822.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1823.         )
1824.         self.assertEqual(len(changes), 1)
1825.         # Differences that exist solely within the kwargs dict of a deconstructed object
1826.         # should be reported as changes
1827.         changes = self.get_changes(
1828.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1829.         )
1830.         self.assertEqual(len(changes), 1)
1831.         # Additional kwargs should also be reported as a change
1832.         changes = self.get_changes(
1833.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1834.         )
1835.         self.assertEqual(len(changes), 1)
1836. 
1837.     def test_deconstruct_type(self):
1838.         """
1839.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1840.         by deep_deconstruct during serialization.
1841.         """
1842.         author = ModelState(
1843.             "testapp",
1844.             "Author",
1845.             [
1846.                 ("id", models.AutoField(primary_key=True)),
1847.                 ("name", models.CharField(
1848.                     max_length=200,
1849.                     # IntegerField intentionally not instantiated.
1850.                     default=models.IntegerField,
1851.                 ))
1852.             ],
1853.         )
1854.         changes = self.get_changes([], [author])
1855.         # Right number/type of migrations?
1856.         self.assertNumberMigrations(changes, 'testapp', 1)
1857.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1858. 
1859.     def test_replace_string_with_foreignkey(self):
1860.         """
1861.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1862.         work.
1863.         """
1864.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1865.         # Right number/type of migrations?
1866.         self.assertNumberMigrations(changes, 'testapp', 1)
1867.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1868.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1869.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1870.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1871. 
1872.     def test_foreign_key_removed_before_target_model(self):
1873.         """
1874.         Removing an FK and the model it targets in the same change must remove
1875.         the FK field before the model to maintain consistency.
1876.         """
1877.         changes = self.get_changes(
1878.             [self.author_with_publisher, self.publisher], [self.author_name]
1879.         )  # removes both the model and FK
1880.         # Right number/type of migrations?
1881.         self.assertNumberMigrations(changes, 'testapp', 1)
1882.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1883.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1884.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1885. 
1886.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1887.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1888.     def test_add_many_to_many(self, mocked_ask_method):
1889.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1890.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1891.         # Right number/type of migrations?
1892.         self.assertNumberMigrations(changes, 'testapp', 1)
1893.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1894.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1895. 
1896.     def test_alter_many_to_many(self):
1897.         changes = self.get_changes(
1898.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1899.         )
1900.         # Right number/type of migrations?
1901.         self.assertNumberMigrations(changes, 'testapp', 1)
1902.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1903.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1904. 
1905.     def test_create_with_through_model(self):
1906.         """
1907.         Adding a m2m with a through model and the models that use it should be
1908.         ordered correctly.
1909.         """
1910.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1911.         # Right number/type of migrations?
1912.         self.assertNumberMigrations(changes, "testapp", 1)
1913.         self.assertOperationTypes(changes, "testapp", 0, [
1914.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1915.         ])
1916.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1917.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1918.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1919.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1920. 
1921.     def test_many_to_many_removed_before_through_model(self):
1922.         """
1923.         Removing a ManyToManyField and the "through" model in the same change
1924.         must remove the field before the model to maintain consistency.
1925.         """
1926.         changes = self.get_changes(
1927.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1928.             [self.book_with_no_author, self.author_name],
1929.         )
1930.         # Remove both the through model and ManyToMany
1931.         # Right number/type of migrations?
1932.         self.assertNumberMigrations(changes, "otherapp", 1)
1933.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1934.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1935.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1936. 
1937.     def test_many_to_many_removed_before_through_model_2(self):
1938.         """
1939.         Removing a model that contains a ManyToManyField and the "through" model
1940.         in the same change must remove the field before the model to maintain
1941.         consistency.
1942.         """
1943.         changes = self.get_changes(
1944.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1945.             [self.author_name],
1946.         )
1947.         # Remove both the through model and ManyToMany
1948.         # Right number/type of migrations?
1949.         self.assertNumberMigrations(changes, "otherapp", 1)
1950.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
1951.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
1952.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
1953.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
1954. 
1955.     def test_m2m_w_through_multistep_remove(self):
1956.         """
1957.         A model with a m2m field that specifies a "through" model cannot be
1958.         removed in the same migration as that through model as the schema will
1959.         pass through an inconsistent state. The autodetector should produce two
1960.         migrations to avoid this issue.
1961.         """
1962.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
1963.         # Right number/type of migrations?
1964.         self.assertNumberMigrations(changes, "testapp", 1)
1965.         self.assertOperationTypes(changes, "testapp", 0, [
1966.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
1967.         ])
1968.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
1969.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
1970.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
1971.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
1972. 
1973.     def test_concrete_field_changed_to_many_to_many(self):
1974.         """
1975.         #23938 - Changing a concrete field into a ManyToManyField
1976.         first removes the concrete field and then adds the m2m field.
1977.         """
1978.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
1979.         # Right number/type of migrations?
1980.         self.assertNumberMigrations(changes, "testapp", 1)
1981.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
1982.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
1983.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
1984.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
1985. 
1986.     def test_many_to_many_changed_to_concrete_field(self):
1987.         """
1988.         #23938 - Changing a ManyToManyField into a concrete field
1989.         first removes the m2m field and then adds the concrete field.
1990.         """
1991.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
1992.         # Right number/type of migrations?
1993.         self.assertNumberMigrations(changes, "testapp", 1)
1994.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
1995.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
1996.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
1997.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
1998.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
1999. 
2000.     def test_non_circular_foreignkey_dependency_removal(self):
2001.         """
2002.         If two models with a ForeignKey from one to the other are removed at the
2003.         same time, the autodetector should remove them in the correct order.
2004.         """
2005.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2006.         # Right number/type of migrations?
2007.         self.assertNumberMigrations(changes, "testapp", 1)
2008.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2009.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2010.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2011.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2012. 
2013.     def test_alter_model_options(self):
2014.         """Changing a model's options should make a change."""
2015.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2016.         # Right number/type of migrations?
2017.         self.assertNumberMigrations(changes, "testapp", 1)
2018.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2019.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2020.             "permissions": [('can_hire', 'Can hire')],
2021.             "verbose_name": "Authi",
2022.         })
2023. 
2024.         # Changing them back to empty should also make a change
2025.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2026.         # Right number/type of migrations?
2027.         self.assertNumberMigrations(changes, "testapp", 1)
2028.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2029.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2030. 
2031.     def test_alter_model_options_proxy(self):
2032.         """Changing a proxy model's options should also make a change."""
2033.         changes = self.get_changes(
2034.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2035.         )
2036.         # Right number/type of migrations?
2037.         self.assertNumberMigrations(changes, "testapp", 1)
2038.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2039.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2040.             "verbose_name": "Super Author"
2041.         })
2042. 
2043.     def test_set_alter_order_with_respect_to(self):
2044.         """Setting order_with_respect_to adds a field."""
2045.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2046.         # Right number/type of migrations?
2047.         self.assertNumberMigrations(changes, 'testapp', 1)
2048.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2049.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2050. 
2051.     def test_add_alter_order_with_respect_to(self):
2052.         """
2053.         Setting order_with_respect_to when adding the FK too does
2054.         things in the right order.
2055.         """
2056.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2057.         # Right number/type of migrations?
2058.         self.assertNumberMigrations(changes, 'testapp', 1)
2059.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2060.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2061.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2062. 
2063.     def test_remove_alter_order_with_respect_to(self):
2064.         """
2065.         Removing order_with_respect_to when removing the FK too does
2066.         things in the right order.
2067.         """
2068.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2069.         # Right number/type of migrations?
2070.         self.assertNumberMigrations(changes, 'testapp', 1)
2071.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2072.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2073.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2074. 
2075.     def test_add_model_order_with_respect_to(self):
2076.         """
2077.         Setting order_with_respect_to when adding the whole model
2078.         does things in the right order.
2079.         """
2080.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, 'testapp', 1)
2083.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2084.         self.assertOperationAttributes(
2085.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2086.         )
2087.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2088. 
2089.     def test_alter_model_managers(self):
2090.         """
2091.         Changing the model managers adds a new operation.
2092.         """
2093.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2094.         # Right number/type of migrations?
2095.         self.assertNumberMigrations(changes, 'otherapp', 1)
2096.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2097.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2098.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2099.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2100.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2101.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2102. 
2103.     def test_swappable_first_inheritance(self):
2104.         """Swappable models get their CreateModel first."""
2105.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2106.         # Right number/type of migrations?
2107.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2108.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2109.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2110.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2111. 
2112.     def test_default_related_name_option(self):
2113.         model_state = ModelState('app', 'model', [
2114.             ('id', models.AutoField(primary_key=True)),
2115.         ], options={'default_related_name': 'related_name'})
2116.         changes = self.get_changes([], [model_state])
2117.         self.assertNumberMigrations(changes, 'app', 1)
2118.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2119.         self.assertOperationAttributes(
2120.             changes, 'app', 0, 0, name='model',
2121.             options={'default_related_name': 'related_name'},
2122.         )
2123.         altered_model_state = ModelState('app', 'Model', [
2124.             ('id', models.AutoField(primary_key=True)),
2125.         ])
2126.         changes = self.get_changes([model_state], [altered_model_state])
2127.         self.assertNumberMigrations(changes, 'app', 1)
2128.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2129.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2130. 
2131.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2132.     def test_swappable_first_setting(self):
2133.         """Swappable models get their CreateModel first."""
2134.         with isolate_lru_cache(apps.get_swappable_settings_name):
2135.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2136.         # Right number/type of migrations?
2137.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2138.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2139.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2140.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2141. 
2142.     def test_bases_first(self):
2143.         """Bases of other models come first."""
2144.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2145.         # Right number/type of migrations?
2146.         self.assertNumberMigrations(changes, 'testapp', 1)
2147.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2148.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2149.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2150. 
2151.     def test_multiple_bases(self):
2152.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2153.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2154.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2155.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2156.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2157.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2158.         changes = self.get_changes([], [A, B, C, D, E])
2159.         # Right number/type of migrations?
2160.         self.assertNumberMigrations(changes, "app", 1)
2161.         self.assertOperationTypes(changes, "app", 0, [
2162.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2163.         ])
2164.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2165.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2166.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2167.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2168.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2169. 
2170.     def test_proxy_bases_first(self):
2171.         """Bases of proxies come first."""
2172.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2173.         # Right number/type of migrations?
2174.         self.assertNumberMigrations(changes, 'testapp', 1)
2175.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2176.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2177.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2178.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2179. 
2180.     def test_pk_fk_included(self):
2181.         """
2182.         A relation used as the primary key is kept as part of CreateModel.
2183.         """
2184.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2185.         # Right number/type of migrations?
2186.         self.assertNumberMigrations(changes, 'testapp', 1)
2187.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2188.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2189.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2190. 
2191.     def test_first_dependency(self):
2192.         """
2193.         A dependency to an app with no migrations uses __first__.
2194.         """
2195.         # Load graph
2196.         loader = MigrationLoader(connection)
2197.         before = self.make_project_state([])
2198.         after = self.make_project_state([self.book_migrations_fk])
2199.         after.real_apps = ["migrations"]
2200.         autodetector = MigrationAutodetector(before, after)
2201.         changes = autodetector._detect_changes(graph=loader.graph)
2202.         # Right number/type of migrations?
2203.         self.assertNumberMigrations(changes, 'otherapp', 1)
2204.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2205.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2206.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2207. 
2208.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2209.     def test_last_dependency(self):
2210.         """
2211.         A dependency to an app with existing migrations uses the
2212.         last migration of that app.
2213.         """
2214.         # Load graph
2215.         loader = MigrationLoader(connection)
2216.         before = self.make_project_state([])
2217.         after = self.make_project_state([self.book_migrations_fk])
2218.         after.real_apps = ["migrations"]
2219.         autodetector = MigrationAutodetector(before, after)
2220.         changes = autodetector._detect_changes(graph=loader.graph)
2221.         # Right number/type of migrations?
2222.         self.assertNumberMigrations(changes, 'otherapp', 1)
2223.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2224.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2225.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2226. 
2227.     def test_alter_fk_before_model_deletion(self):
2228.         """
2229.         ForeignKeys are altered _before_ the model they used to
2230.         refer to are deleted.
2231.         """
2232.         changes = self.get_changes(
2233.             [self.author_name, self.publisher_with_author],
2234.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2235.         )
2236.         # Right number/type of migrations?
2237.         self.assertNumberMigrations(changes, 'testapp', 1)
2238.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2239.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2240.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2241.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2242. 
2243.     def test_fk_dependency_other_app(self):
2244.         """
2245.         #23100 - ForeignKeys correctly depend on other apps' models.
2246.         """
2247.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2248.         # Right number/type of migrations?
2249.         self.assertNumberMigrations(changes, 'testapp', 1)
2250.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2251.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2252.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2253. 
2254.     def test_circular_dependency_mixed_addcreate(self):
2255.         """
2256.         #23315 - The dependency resolver knows to put all CreateModel
2257.         before AddField and not become unsolvable.
2258.         """
2259.         address = ModelState("a", "Address", [
2260.             ("id", models.AutoField(primary_key=True)),
2261.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2262.         ])
2263.         person = ModelState("a", "Person", [
2264.             ("id", models.AutoField(primary_key=True)),
2265.         ])
2266.         apackage = ModelState("b", "APackage", [
2267.             ("id", models.AutoField(primary_key=True)),
2268.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2269.         ])
2270.         country = ModelState("b", "DeliveryCountry", [
2271.             ("id", models.AutoField(primary_key=True)),
2272.         ])
2273.         changes = self.get_changes([], [address, person, apackage, country])
2274.         # Right number/type of migrations?
2275.         self.assertNumberMigrations(changes, 'a', 2)
2276.         self.assertNumberMigrations(changes, 'b', 1)
2277.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2278.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2279.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2280. 
2281.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2282.     def test_circular_dependency_swappable(self):
2283.         """
2284.         #23322 - The dependency resolver knows to explicitly resolve
2285.         swappable models.
2286.         """
2287.         with isolate_lru_cache(apps.get_swappable_settings_name):
2288.             tenant = ModelState("a", "Tenant", [
2289.                 ("id", models.AutoField(primary_key=True)),
2290.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2291.                 bases=(AbstractBaseUser,)
2292.             )
2293.             address = ModelState("b", "Address", [
2294.                 ("id", models.AutoField(primary_key=True)),
2295.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2296.             ])
2297.             changes = self.get_changes([], [address, tenant])
2298. 
2299.         # Right number/type of migrations?
2300.         self.assertNumberMigrations(changes, 'a', 2)
2301.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2302.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2303.         self.assertMigrationDependencies(changes, 'a', 0, [])
2304.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2305.         # Right number/type of migrations?
2306.         self.assertNumberMigrations(changes, 'b', 1)
2307.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2308.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2309. 
2310.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2311.     def test_circular_dependency_swappable2(self):
2312.         """
2313.         #23322 - The dependency resolver knows to explicitly resolve
2314.         swappable models but with the swappable not being the first migrated
2315.         model.
2316.         """
2317.         with isolate_lru_cache(apps.get_swappable_settings_name):
2318.             address = ModelState("a", "Address", [
2319.                 ("id", models.AutoField(primary_key=True)),
2320.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2321.             ])
2322.             tenant = ModelState("b", "Tenant", [
2323.                 ("id", models.AutoField(primary_key=True)),
2324.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2325.                 bases=(AbstractBaseUser,)
2326.             )
2327.             changes = self.get_changes([], [address, tenant])
2328.         # Right number/type of migrations?
2329.         self.assertNumberMigrations(changes, 'a', 2)
2330.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2331.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2332.         self.assertMigrationDependencies(changes, 'a', 0, [])
2333.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2334.         # Right number/type of migrations?
2335.         self.assertNumberMigrations(changes, 'b', 1)
2336.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2337.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2338. 
2339.     @override_settings(AUTH_USER_MODEL="a.Person")
2340.     def test_circular_dependency_swappable_self(self):
2341.         """
2342.         #23322 - The dependency resolver knows to explicitly resolve
2343.         swappable models.
2344.         """
2345.         with isolate_lru_cache(apps.get_swappable_settings_name):
2346.             person = ModelState("a", "Person", [
2347.                 ("id", models.AutoField(primary_key=True)),
2348.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2349.             ])
2350.             changes = self.get_changes([], [person])
2351.         # Right number/type of migrations?
2352.         self.assertNumberMigrations(changes, 'a', 1)
2353.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2354.         self.assertMigrationDependencies(changes, 'a', 0, [])
2355. 
2356.     @override_settings(AUTH_USER_MODEL='a.User')
2357.     def test_swappable_circular_multi_mti(self):
2358.         with isolate_lru_cache(apps.get_swappable_settings_name):
2359.             parent = ModelState('a', 'Parent', [
2360.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2361.             ])
2362.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2363.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2364.             changes = self.get_changes([], [parent, child, user])
2365.         self.assertNumberMigrations(changes, 'a', 1)
2366.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2367. 
2368.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2369.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2370.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2371.         """
2372.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2373.         without default should not prompt for a default.
2374.         """
2375.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2376.         # Right number/type of migrations?
2377.         self.assertNumberMigrations(changes, 'testapp', 1)
2378.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2379.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2380. 
2381.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2382.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2383.         """
2384.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2385.         without default should prompt for a default.
2386.         """
2387.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2388.         self.assertEqual(mocked_ask_method.call_count, 2)
2389.         # Right number/type of migrations?
2390.         self.assertNumberMigrations(changes, 'testapp', 1)
2391.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2392.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2393. 
2394.     def test_mti_inheritance_model_removal(self):
2395.         Animal = ModelState('app', 'Animal', [
2396.             ("id", models.AutoField(primary_key=True)),
2397.         ])
2398.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2399.         changes = self.get_changes([Animal, Dog], [Animal])
2400.         self.assertNumberMigrations(changes, 'app', 1)
2401.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2402.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 23:17:42,590 - thread-135202988885696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have analyzed the provided `tests/migrations/test_autodetector.py` file and found it contains sufficient information to identify three relevant test cases. The file includes tests for `AlterField` operations on `ForeignKey`s and the resulting migration dependencies, which is directly related to the user's bug report. Specifically, I have identified `test_proxy_to_mti_with_fk_to_proxy`, `test_swappable_changed`, and `test_alter_fk_before_model_deletion` as the most relevant examples. All necessary model states and helper functions are present in the file. Therefore, I do not need additional context." query='' extra_requirements='' purpose=''
2025-12-20 23:17:42,591 - thread-135202988885696.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
