2025-12-21 19:48:30,118 - thread-126207454611136.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: units.quantity_input decorator fails for constructors with type hinted return value -> None

Description: ### Summary
I am using the `units.quantity_input` decorator with typing hints for constructors, however when I add the correct return value for the constructor (`None`) then I get an exception, because `None` has no attribute `to`.

### Reproducer
The issue can be reproduced with the following file:
``` Python
import astropy.units as u


class PoC(object):

    @u.quantity_input
    def __init__(self, voltage: u.V) -> None:
        pass


if __name__ == '__main__':
    poc = PoC(1.*u.V)
```
which results in the following error:
```
$ python3 poc.py
Traceback (most recent call last):
  File "poc.py", line 12, in <module>
    poc = PoC(1.*u.V)
  File "/usr/lib64/python3.6/site-packages/astropy/utils/decorators.py", line 868, in __init__
    func = make_function_with_signature(func, name=name, **wrapped_args)
  File "/usr/lib64/python3.6/site-packages/astropy/units/decorators.py", line 225, in wrapper
    return return_.to(wrapped_signature.return_annotation)
AttributeError: 'NoneType' object has no attribute 'to'
```

This has been tested on Fedora 27 with python 3.6.3, astropy 2.0.2 and numpy 1.13.3 all from Fedora's repository.

### Workaround
The issue can be circumvented by not adding the return type typing hint. Unfortunately, then a static type checker cannot infer that this function returns nothing.

### Possible fix
Maybe the decorator could explicitly check whether None is returned and then omit the unit check.

Patch information:
diff --git a/astropy/units/decorators.py b/astropy/units/decorators.py
index 8bece5a850..fc185cb5e0 100644
--- a/astropy/units/decorators.py
+++ b/astropy/units/decorators.py
@@ -221,6 +221,9 @@ class QuantityInput:
             with add_enabled_equivalencies(self.equivalencies):
                 return_ = wrapped_function(*func_args, **func_kwargs)
             if wrapped_signature.return_annotation is not inspect.Signature.empty:
+                # If the return value is None, return it directly without trying to convert units
+                if return_ is None:
+                    return None
                 return return_.to(wrapped_signature.return_annotation)
             else:
                 return return_


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 19:48:30,269 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   ├── yacc.py
|   |   |   └── ygen.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: units.quantity_input decorator fails for constructors with type hinted return value -> None

Description: ### Summary
I am using the `units.quantity_input` decorator with typing hints for constructors, however when I add the correct return value for the constructor (`None`) then I get an exception, because `None` has no attribute `to`.

### Reproducer
The issue can be reproduced with the following file:
``` Python
import astropy.units as u


class PoC(object):

    @u.quantity_input
    def __init__(self, voltage: u.V) -> None:
        pass


if __name__ == '__main__':
    poc = PoC(1.*u.V)
```
which results in the following error:
```
$ python3 poc.py
Traceback (most recent call last):
  File "poc.py", line 12, in <module>
    poc = PoC(1.*u.V)
  File "/usr/lib64/python3.6/site-packages/astropy/utils/decorators.py", line 868, in __init__
    func = make_function_with_signature(func, name=name, **wrapped_args)
  File "/usr/lib64/python3.6/site-packages/astropy/units/decorators.py", line 225, in wrapper
    return return_.to(wrapped_signature.return_annotation)
AttributeError: 'NoneType' object has no attribute 'to'
```

This has been tested on Fedora 27 with python 3.6.3, astropy 2.0.2 and numpy 1.13.3 all from Fedora's repository.

### Workaround
The issue can be circumvented by not adding the return type typing hint. Unfortunately, then a static type checker cannot infer that this function returns nothing.

### Possible fix
Maybe the decorator could explicitly check whether None is returned and then omit the unit check.

Patch information:
diff --git a/astropy/units/decorators.py b/astropy/units/decorators.py
index 8bece5a850..fc185cb5e0 100644
--- a/astropy/units/decorators.py
+++ b/astropy/units/decorators.py
@@ -221,6 +221,9 @@ class QuantityInput:
             with add_enabled_equivalencies(self.equivalencies):
                 return_ = wrapped_function(*func_args, **func_kwargs)
             if wrapped_signature.return_annotation is not inspect.Signature.empty:
+                # If the return value is None, return it directly without trying to convert units
+                if return_ is None:
+                    return None
                 return return_.to(wrapped_signature.return_annotation)
             else:
                 return return_


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:48:58,801 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's bug report concerns the `@quantity_input` decorator in `astropy.units` when used with Python 3 type annotations. To find relevant existing test cases, I need to examine the tests for this decorator. The most relevant files are `astropy/units/tests/test_quantity_decorator.py` (the main test file for the decorator) and `astropy/units/tests/py3_test_quantity_annotations.py` (which specifically tests Python 3 annotation integration)." query='Please provide the full content of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`.' extra_requirements='' purpose='These files are required to find existing test cases that demonstrate the usage of the `@quantity_input` decorator with type annotations, which is necessary to find tests similar to the reported bug.'
2025-12-21 19:48:58,802 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`.
2025-12-21 19:48:58,802 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:48:58,803 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:48:58,804 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:48:58,804 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`.
Purpose: These files are required to find existing test cases that demonstrate the usage of the `@quantity_input` decorator with type annotations, which is necessary to find tests similar to the reported bug.
2025-12-21 19:49:01,762 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the full content of both `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py` to locate existing test cases. This will help identify tests demonstrating the usage of the `@quantity_input` decorator with type annotations, which is relevant to the reported bug.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/units/tests/py3_test_quantity_annotations.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2172, 'candidates_token_count': 137, 'total_token_count': 2474, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2172}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 137}], 'thoughts_token_count': 165, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.05519444751043389, 'model_name': 'gemini-2.5-pro'} id='run--b59abd19-81d0-4c87-8239-7c2f3543637a-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/units/tests/test_quantity_decorator.py'}, 'id': '2e5c8b15-151f-4a29-add8-0fa7f224aa2a', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/units/tests/py3_test_quantity_annotations.py'}, 'id': '2b588494-0cf9-4580-985f-4ea3ba8ecae9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2172, 'output_tokens': 137, 'total_tokens': 2474, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 165}}
2025-12-21 19:49:12,947 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`. The second file, `py3_test_quantity_annotations.py`, is particularly relevant as it contains test cases that use the `@quantity_input` decorator with type annotations. These tests are generated dynamically, which is an important detail for understanding the test structure.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1049, 'end_index': 1485, 'uri': 'https://github.com/arfon/astropy-lambda', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 11575, 'candidates_token_count': 96, 'total_token_count': 12863, 'cached_content_token_count': 1854, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11575}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1854}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 96}], 'thoughts_token_count': 1192}, 'finish_reason': 'STOP', 'avg_logprobs': -1.546196460723877, 'model_name': 'gemini-2.5-pro'} id='run--1a46ec6a-4a3b-49ee-b70b-f212d29caa8e-0' usage_metadata={'input_tokens': 11575, 'output_tokens': 96, 'total_tokens': 12863, 'input_token_details': {'cache_read': 1854}, 'output_token_details': {'reasoning': 1192}}
2025-12-21 19:49:12,955 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
These files are required to find existing test cases that demonstrate the usage of the `@quantity_input` decorator with type annotations, which is necessary to find tests similar to the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/units/tests/py3_test_quantity_annotations.py
Line number range: 1 - 287
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. from functools import wraps
5. from textwrap import dedent
6. 
7. import pytest
8. 
9. from ... import units as u  # pylint: disable=W0611
10. 
11. 
12. def py3only(func):
13.     @wraps(func)
14.     def wrapper(*args, **kwargs):
15.         src = func(*args, **kwargs)
16.         code = compile(dedent(src), __file__, 'exec')
17.         # This uses an unqualified exec statement illegally in Python 2,
18.         # but perfectly allowed in Python 3 so in fact we eval the exec
19.         # call :)
20.         eval('exec(code)')
21. 
22.     return wrapper
23. 
24. 
25. @py3only
26. @pytest.mark.parametrize("solarx_unit,solary_unit", [
27.                          ("u.arcsec", "u.arcsec"),
28.                          ("'angle'", "'angle'")])
29. def test_args3(solarx_unit, solary_unit):
30.     src = """
31.     @u.quantity_input
32.     def myfunc_args(solarx: {0}, solary: {1}):
33.         return solarx, solary
34. 
35.     solarx, solary = myfunc_args(1*u.arcsec, 1*u.arcsec)
36. 
37.     assert isinstance(solarx, u.Quantity)
38.     assert isinstance(solary, u.Quantity)
39. 
40.     assert solarx.unit == u.arcsec
41.     assert solary.unit == u.arcsec
42.     """.format(solarx_unit, solary_unit)
43.     return src
44. 
45. 
46. @py3only
47. @pytest.mark.parametrize("solarx_unit,solary_unit", [
48.                          ("u.arcsec", "u.arcsec"),
49.                          ("'angle'", "'angle'")])
50. def test_args_noconvert3(solarx_unit, solary_unit):
51.     src = """
52.     @u.quantity_input()
53.     def myfunc_args(solarx: {0}, solary: {1}):
54.         return solarx, solary
55. 
56.     solarx, solary = myfunc_args(1*u.deg, 1*u.arcmin)
57. 
58.     assert isinstance(solarx, u.Quantity)
59.     assert isinstance(solary, u.Quantity)
60. 
61.     assert solarx.unit == u.deg
62.     assert solary.unit == u.arcmin
63.     """.format(solarx_unit, solary_unit)
64.     return src
65. 
66. 
67. @py3only
68. @pytest.mark.parametrize("solarx_unit", [
69.                          "u.arcsec", "'angle'"])
70. def test_args_nonquantity3(solarx_unit):
71.     src = """
72.     @u.quantity_input
73.     def myfunc_args(solarx: {0}, solary):
74.         return solarx, solary
75. 
76.     solarx, solary = myfunc_args(1*u.arcsec, 100)
77. 
78.     assert isinstance(solarx, u.Quantity)
79.     assert isinstance(solary, int)
80. 
81.     assert solarx.unit == u.arcsec
82.     """.format(solarx_unit)
83.     return src
84. 
85. 
86. @py3only
87. @pytest.mark.parametrize("solarx_unit,solary_unit", [
88.                          ("u.arcsec", "u.eV"),
89.                          ("'angle'", "'energy'")])
90. def test_arg_equivalencies3(solarx_unit, solary_unit):
91.     src = """
92.     @u.quantity_input(equivalencies=u.mass_energy())
93.     def myfunc_args(solarx: {0}, solary: {1}):
94.         return solarx, solary+(10*u.J)  # Add an energy to check equiv is working
95. 
96.     solarx, solary = myfunc_args(1*u.arcsec, 100*u.gram)
97. 
98.     assert isinstance(solarx, u.Quantity)
99.     assert isinstance(solary, u.Quantity)
100. 
101.     assert solarx.unit == u.arcsec
102.     assert solary.unit == u.gram
103.     """.format(solarx_unit, solary_unit)
104.     return src
105. 
106. 
107. @py3only
108. @pytest.mark.parametrize("solarx_unit,solary_unit", [
109.                          ("u.arcsec", "u.deg"),
110.                          ("'angle'", "'angle'")])
111. def test_wrong_unit3(solarx_unit, solary_unit):
112.     src = """
113.     @u.quantity_input
114.     def myfunc_args(solarx: {0}, solary: {1}):
115.         return solarx, solary
116. 
117.     with pytest.raises(u.UnitsError) as e:
118.         solarx, solary = myfunc_args(1*u.arcsec, 100*u.km)
119. 
120.     str_to = str({1})
121.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' must be in units convertible to '{{0}}'.".format(str_to)
122.     """.format(solarx_unit, solary_unit)
123.     return src
124. 
125. 
126. @py3only
127. @pytest.mark.parametrize("solarx_unit,solary_unit", [
128.                          ("u.arcsec", "u.deg"),
129.                          ("'angle'", "'angle'")])
130. def test_not_quantity3(solarx_unit, solary_unit):
131.     src = """
132.     @u.quantity_input
133.     def myfunc_args(solarx: {0}, solary: {1}):
134.         return solarx, solary
135. 
136.     with pytest.raises(TypeError) as e:
137.         solarx, solary = myfunc_args(1*u.arcsec, 100)
138.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
139.     """.format(solarx_unit, solary_unit)
140.     return src
141. 
142. 
143. @py3only
144. def test_decorator_override():
145.     src = """
146.     @u.quantity_input(solarx=u.arcsec)
147.     def myfunc_args(solarx: u.km, solary: u.arcsec):
148.         return solarx, solary
149. 
150.     solarx, solary = myfunc_args(1*u.arcsec, 1*u.arcsec)
151. 
152.     assert isinstance(solarx, u.Quantity)
153.     assert isinstance(solary, u.Quantity)
154. 
155.     assert solarx.unit == u.arcsec
156.     assert solary.unit == u.arcsec
157.     """
158.     return src
159. 
160. 
161. @py3only
162. @pytest.mark.parametrize("solarx_unit,solary_unit", [
163.                          ("u.arcsec", "u.deg"),
164.                          ("'angle'", "'angle'")])
165. def test_kwargs3(solarx_unit, solary_unit):
166.     src = """
167.     @u.quantity_input
168.     def myfunc_args(solarx: {0}, solary, myk: {1}=1*u.arcsec):
169.         return solarx, solary, myk
170. 
171.     solarx, solary, myk = myfunc_args(1*u.arcsec, 100, myk=100*u.deg)
172. 
173.     assert isinstance(solarx, u.Quantity)
174.     assert isinstance(solary, int)
175.     assert isinstance(myk, u.Quantity)
176. 
177.     assert myk.unit == u.deg
178.     """.format(solarx_unit, solary_unit)
179.     return src
180. 
181. 
182. @py3only
183. @pytest.mark.parametrize("solarx_unit,solary_unit", [
184.                          ("u.arcsec", "u.deg"),
185.                          ("'angle'", "'angle'")])
186. def test_unused_kwargs3(solarx_unit, solary_unit):
187.     src = """
188.     @u.quantity_input
189.     def myfunc_args(solarx: {0}, solary, myk: {1}=1*u.arcsec, myk2=1000):
190.         return solarx, solary, myk, myk2
191. 
192.     solarx, solary, myk, myk2 = myfunc_args(1*u.arcsec, 100, myk=100*u.deg, myk2=10)
193. 
194.     assert isinstance(solarx, u.Quantity)
195.     assert isinstance(solary, int)
196.     assert isinstance(myk, u.Quantity)
197.     assert isinstance(myk2, int)
198. 
199.     assert myk.unit == u.deg
200.     assert myk2 == 10
201.     """.format(solarx_unit, solary_unit)
202.     return src
203. 
204. 
205. @py3only
206. @pytest.mark.parametrize("solarx_unit,energy", [
207.                          ("u.arcsec", "u.eV"),
208.                          ("'angle'", "'energy'")])
209. def test_kwarg_equivalencies3(solarx_unit, energy):
210.     src = """
211.     @u.quantity_input(equivalencies=u.mass_energy())
212.     def myfunc_args(solarx: {0}, energy: {1}=10*u.eV):
213.         return solarx, energy+(10*u.J)  # Add an energy to check equiv is working
214. 
215.     solarx, energy = myfunc_args(1*u.arcsec, 100*u.gram)
216. 
217.     assert isinstance(solarx, u.Quantity)
218.     assert isinstance(energy, u.Quantity)
219. 
220.     assert solarx.unit == u.arcsec
221.     assert energy.unit == u.gram
222.     """.format(solarx_unit, energy)
223.     return src
224. 
225. 
226. @py3only
227. @pytest.mark.parametrize("solarx_unit,solary_unit", [
228.                          ("u.arcsec", "u.deg"),
229.                          ("'angle'", "'angle'")])
230. def test_kwarg_wrong_unit3(solarx_unit, solary_unit):
231.     src = """
232.     @u.quantity_input
233.     def myfunc_args(solarx: {0}, solary: {1}=10*u.deg):
234.         return solarx, solary
235. 
236.     with pytest.raises(u.UnitsError) as e:
237.         solarx, solary = myfunc_args(1*u.arcsec, solary=100*u.km)
238. 
239.     str_to = str({1})
240.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' must be in units convertible to '{{0}}'.".format(str_to)
241.     """.format(solarx_unit, solary_unit)
242.     return src
243. 
244. 
245. @py3only
246. @pytest.mark.parametrize("solarx_unit,solary_unit", [
247.                          ("u.arcsec", "u.deg"),
248.                          ("'angle'", "'angle'")])
249. def test_kwarg_not_quantity3(solarx_unit, solary_unit):
250.     src = """
251.     @u.quantity_input
252.     def myfunc_args(solarx: {0}, solary: {1}=10*u.deg):
253.         return solarx, solary
254. 
255.     with pytest.raises(TypeError) as e:
256.         solarx, solary = myfunc_args(1*u.arcsec, solary=100)
257.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
258.     """.format(solarx_unit, solary_unit)
259.     return src
260. 
261. 
262. @py3only
263. @pytest.mark.parametrize("solarx_unit,solary_unit", [
264.                          ("u.arcsec", "u.deg"),
265.                          ("'angle'", "'angle'")])
266. def test_kwarg_default3(solarx_unit, solary_unit):
267.     src = """
268.     @u.quantity_input
269.     def myfunc_args(solarx: {0}, solary: {1}=10*u.deg):
270.         return solarx, solary
271. 
272.     solarx, solary = myfunc_args(1*u.arcsec)
273.     """.format(solarx_unit, solary_unit)
274.     return src
275. 
276. 
277. @py3only
278. def test_return_annotation():
279.     src = """
280.     @u.quantity_input
281.     def myfunc_args(solarx: u.arcsec) -> u.deg:
282.         return solarx
283. 
284.     solarx = myfunc_args(1*u.arcsec)
285.     assert solarx.unit is u.deg
286.     """
287.     return src


File: astropy/units/tests/test_quantity_decorator.py
Line number range: 1 - 329
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. import pytest
5. 
6. from ... import units as u
7. 
8. from .py3_test_quantity_annotations import *
9. 
10. # list of pairs (target unit/physical type, input unit)
11. x_inputs = [(u.arcsec, u.deg), ('angle', u.deg),
12.             (u.kpc/u.Myr, u.km/u.s), ('speed', u.km/u.s),
13.             ([u.arcsec, u.km], u.deg), ([u.arcsec, u.km], u.km),  # multiple allowed
14.             (['angle', 'length'], u.deg), (['angle', 'length'], u.km)]
15. 
16. y_inputs = [(u.arcsec, u.deg), ('angle', u.deg),
17.             (u.kpc/u.Myr, u.km/u.s), ('speed', u.km/u.s)]
18. 
19. 
20. @pytest.fixture(scope="module",
21.                 params=list(range(len(x_inputs))))
22. def x_input(request):
23.     return x_inputs[request.param]
24. 
25. 
26. @pytest.fixture(scope="module",
27.                 params=list(range(len(y_inputs))))
28. def y_input(request):
29.     return y_inputs[request.param]
30. 
31. # ---- Tests that use the fixtures defined above ----
32. 
33. 
34. def test_args(x_input, y_input):
35.     x_target, x_unit = x_input
36.     y_target, y_unit = y_input
37. 
38.     @u.quantity_input(x=x_target, y=y_target)
39.     def myfunc_args(x, y):
40.         return x, y
41. 
42.     x, y = myfunc_args(1*x_unit, 1*y_unit)
43. 
44.     assert isinstance(x, u.Quantity)
45.     assert isinstance(y, u.Quantity)
46. 
47.     assert x.unit == x_unit
48.     assert y.unit == y_unit
49. 
50. 
51. def test_args_nonquantity(x_input):
52.     x_target, x_unit = x_input
53. 
54.     @u.quantity_input(x=x_target)
55.     def myfunc_args(x, y):
56.         return x, y
57. 
58.     x, y = myfunc_args(1*x_unit, 100)
59. 
60.     assert isinstance(x, u.Quantity)
61.     assert isinstance(y, int)
62. 
63.     assert x.unit == x_unit
64. 
65. 
66. def test_wrong_unit(x_input, y_input):
67.     x_target, x_unit = x_input
68.     y_target, y_unit = y_input
69. 
70.     @u.quantity_input(x=x_target, y=y_target)
71.     def myfunc_args(x, y):
72.         return x, y
73. 
74.     with pytest.raises(u.UnitsError) as e:
75.         x, y = myfunc_args(1*x_unit, 100*u.Joule)  # has to be an unspecified unit
76. 
77.     str_to = str(y_target)
78.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' must be in units convertible to '{0}'.".format(str_to)
79. 
80. 
81. def test_not_quantity(x_input, y_input):
82.     x_target, x_unit = x_input
83.     y_target, y_unit = y_input
84. 
85.     @u.quantity_input(x=x_target, y=y_target)
86.     def myfunc_args(x, y):
87.         return x, y
88. 
89.     with pytest.raises(TypeError) as e:
90.         x, y = myfunc_args(1*x_unit, 100)
91.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
92. 
93. 
94. def test_kwargs(x_input, y_input):
95.     x_target, x_unit = x_input
96.     y_target, y_unit = y_input
97. 
98.     @u.quantity_input(x=x_target, y=y_target)
99.     def myfunc_args(x, my_arg, y=1*y_unit):
100.         return x, my_arg, y
101. 
102.     x, my_arg, y = myfunc_args(1*x_unit, 100, y=100*y_unit)
103. 
104.     assert isinstance(x, u.Quantity)
105.     assert isinstance(my_arg, int)
106.     assert isinstance(y, u.Quantity)
107. 
108.     assert y.unit == y_unit
109. 
110. 
111. def test_unused_kwargs(x_input, y_input):
112.     x_target, x_unit = x_input
113.     y_target, y_unit = y_input
114. 
115.     @u.quantity_input(x=x_target, y=y_target)
116.     def myfunc_args(x, my_arg1, y=y_unit, my_arg2=1000):
117.         return x, my_arg1, y, my_arg2
118. 
119.     x, my_arg1, y, my_arg2 = myfunc_args(1*x_unit, 100,
120.                                          y=100*y_unit, my_arg2=10)
121. 
122.     assert isinstance(x, u.Quantity)
123.     assert isinstance(my_arg1, int)
124.     assert isinstance(y, u.Quantity)
125.     assert isinstance(my_arg2, int)
126. 
127.     assert y.unit == y_unit
128.     assert my_arg2 == 10
129. 
130. 
131. def test_kwarg_wrong_unit(x_input, y_input):
132.     x_target, x_unit = x_input
133.     y_target, y_unit = y_input
134. 
135.     @u.quantity_input(x=x_target, y=y_target)
136.     def myfunc_args(x, y=10*y_unit):
137.         return x, y
138. 
139.     with pytest.raises(u.UnitsError) as e:
140.         x, y = myfunc_args(1*x_unit, y=100*u.Joule)
141. 
142.     str_to = str(y_target)
143.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' must be in units convertible to '{0}'.".format(str_to)
144. 
145. 
146. def test_kwarg_not_quantity(x_input, y_input):
147.     x_target, x_unit = x_input
148.     y_target, y_unit = y_input
149. 
150.     @u.quantity_input(x=x_target, y=y_target)
151.     def myfunc_args(x, y=10*y_unit):
152.         return x, y
153. 
154.     with pytest.raises(TypeError) as e:
155.         x, y = myfunc_args(1*x_unit, y=100)
156.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
157. 
158. 
159. def test_kwarg_default(x_input, y_input):
160.     x_target, x_unit = x_input
161.     y_target, y_unit = y_input
162. 
163.     @u.quantity_input(x=x_target, y=y_target)
164.     def myfunc_args(x, y=10*y_unit):
165.         return x, y
166. 
167.     x, y = myfunc_args(1*x_unit)
168. 
169.     assert isinstance(x, u.Quantity)
170.     assert isinstance(y, u.Quantity)
171. 
172.     assert x.unit == x_unit
173.     assert y.unit == y_unit
174. 
175. 
176. def test_kwargs_input(x_input, y_input):
177.     x_target, x_unit = x_input
178.     y_target, y_unit = y_input
179. 
180.     @u.quantity_input(x=x_target, y=y_target)
181.     def myfunc_args(x=1*x_unit, y=1*y_unit):
182.         return x, y
183. 
184.     kwargs = {'x': 10*x_unit, 'y': 10*y_unit}
185.     x, y = myfunc_args(**kwargs)
186. 
187.     assert isinstance(x, u.Quantity)
188.     assert isinstance(y, u.Quantity)
189. 
190.     assert x.unit == x_unit
191.     assert y.unit == y_unit
192. 
193. 
194. def test_kwargs_extra(x_input):
195.     x_target, x_unit = x_input
196. 
197.     @u.quantity_input(x=x_target)
198.     def myfunc_args(x, **kwargs):
199.         return x
200. 
201.     x = myfunc_args(1*x_unit)
202. 
203.     assert isinstance(x, u.Quantity)
204. 
205.     assert x.unit == x_unit
206. 
207. # ---- Tests that don't used the fixtures ----
208. 
209. 
210. @pytest.mark.parametrize("x_unit,y_unit", [
211.                          (u.arcsec, u.eV),
212.                          ('angle', 'energy')])
213. def test_arg_equivalencies(x_unit, y_unit):
214.     @u.quantity_input(x=x_unit, y=y_unit,
215.                       equivalencies=u.mass_energy())
216.     def myfunc_args(x, y):
217.         return x, y+(10*u.J)  # Add an energy to check equiv is working
218. 
219.     x, y = myfunc_args(1*u.arcsec, 100*u.gram)
220. 
221.     assert isinstance(x, u.Quantity)
222.     assert isinstance(y, u.Quantity)
223. 
224.     assert x.unit == u.arcsec
225.     assert y.unit == u.gram
226. 
227. 
228. @pytest.mark.parametrize("x_unit,energy_unit", [
229.                          (u.arcsec, u.eV),
230.                          ('angle', 'energy')])
231. def test_kwarg_equivalencies(x_unit, energy_unit):
232.     @u.quantity_input(x=x_unit, energy=energy_unit, equivalencies=u.mass_energy())
233.     def myfunc_args(x, energy=10*u.eV):
234.         return x, energy+(10*u.J)  # Add an energy to check equiv is working
235. 
236.     x, energy = myfunc_args(1*u.arcsec, 100*u.gram)
237. 
238.     assert isinstance(x, u.Quantity)
239.     assert isinstance(energy, u.Quantity)
240. 
241.     assert x.unit == u.arcsec
242.     assert energy.unit == u.gram
243. 
244. 
245. def test_no_equivalent():
246.     class test_unit:
247.         pass
248. 
249.     class test_quantity:
250.         unit = test_unit()
251. 
252.     @u.quantity_input(x=u.arcsec)
253.     def myfunc_args(x):
254.         return x
255. 
256.     with pytest.raises(TypeError) as e:
257.         x, y = myfunc_args(test_quantity())
258. 
259.         assert str(e.value) == "Argument 'x' to function 'myfunc_args' has a 'unit' attribute without an 'is_equivalent' method. You may want to pass in an astropy Quantity instead."
260. 
261. 
262. def test_kwarg_invalid_physical_type():
263.     @u.quantity_input(x='angle', y='africanswallow')
264.     def myfunc_args(x, y=10*u.deg):
265.         return x, y
266. 
267.     with pytest.raises(ValueError) as e:
268.         x, y = myfunc_args(1*u.arcsec, y=100*u.deg)
269.     assert str(e.value) == "Invalid unit or physical type 'africanswallow'."
270. 
271. 
272. def test_default_value_check():
273.     x_target = u.deg
274.     x_unit = u.arcsec
275. 
276.     with pytest.raises(TypeError):
277.         @u.quantity_input(x=x_target)
278.         def myfunc_args(x=1.):
279.             return x
280. 
281.         x = myfunc_args()
282. 
283.     x = myfunc_args(1*x_unit)
284.     assert isinstance(x, u.Quantity)
285.     assert x.unit == x_unit
286. 
287. 
288. def test_args_None():
289.     x_target = u.deg
290.     x_unit = u.arcsec
291.     y_target = u.km
292.     y_unit = u.kpc
293. 
294.     @u.quantity_input(x=[x_target, None], y=[None, y_target])
295.     def myfunc_args(x, y):
296.         return x, y
297. 
298.     x, y = myfunc_args(1*x_unit, None)
299.     assert isinstance(x, u.Quantity)
300.     assert x.unit == x_unit
301.     assert y is None
302. 
303.     x, y = myfunc_args(None, 1*y_unit)
304.     assert isinstance(y, u.Quantity)
305.     assert y.unit == y_unit
306.     assert x is None
307. 
308. 
309. def test_args_None_kwarg():
310.     x_target = u.deg
311.     x_unit = u.arcsec
312.     y_target = u.km
313. 
314.     @u.quantity_input(x=x_target, y=y_target)
315.     def myfunc_args(x, y=None):
316.         return x, y
317. 
318.     x, y = myfunc_args(1*x_unit)
319.     assert isinstance(x, u.Quantity)
320.     assert x.unit == x_unit
321.     assert y is None
322. 
323.     x, y = myfunc_args(1*x_unit, None)
324.     assert isinstance(x, u.Quantity)
325.     assert x.unit == x_unit
326.     assert y is None
327. 
328.     with pytest.raises(TypeError):
329.         x, y = myfunc_args(None, None)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:49:18,577 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of `astropy/units/tests/py3_test_quantity_annotations.py`.', relative_path='astropy/units/tests/py3_test_quantity_annotations.py', start_line=1, end_line=287), ContextOutput(reasoning='The user requested the full content of `astropy/units/tests/test_quantity_decorator.py`.', relative_path='astropy/units/tests/test_quantity_decorator.py', start_line=1, end_line=329)]
2025-12-21 19:49:18,579 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`.
2025-12-21 19:49:18,579 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:49:18,579 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:49:18,580 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 0 existing contexts
2025-12-21 19:49:18,580 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 19:49:18,581 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .rtd-environment.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   ├── yacc.py
|   |   |   └── ygen.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── _numpy_hacks.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── py3_test_quantity_annotations.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   └── test_units.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrgsiftp.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   └── index.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   └── index.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── ez_setup.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: units.quantity_input decorator fails for constructors with type hinted return value -> None

Description: ### Summary
I am using the `units.quantity_input` decorator with typing hints for constructors, however when I add the correct return value for the constructor (`None`) then I get an exception, because `None` has no attribute `to`.

### Reproducer
The issue can be reproduced with the following file:
``` Python
import astropy.units as u


class PoC(object):

    @u.quantity_input
    def __init__(self, voltage: u.V) -> None:
        pass


if __name__ == '__main__':
    poc = PoC(1.*u.V)
```
which results in the following error:
```
$ python3 poc.py
Traceback (most recent call last):
  File "poc.py", line 12, in <module>
    poc = PoC(1.*u.V)
  File "/usr/lib64/python3.6/site-packages/astropy/utils/decorators.py", line 868, in __init__
    func = make_function_with_signature(func, name=name, **wrapped_args)
  File "/usr/lib64/python3.6/site-packages/astropy/units/decorators.py", line 225, in wrapper
    return return_.to(wrapped_signature.return_annotation)
AttributeError: 'NoneType' object has no attribute 'to'
```

This has been tested on Fedora 27 with python 3.6.3, astropy 2.0.2 and numpy 1.13.3 all from Fedora's repository.

### Workaround
The issue can be circumvented by not adding the return type typing hint. Unfortunately, then a static type checker cannot infer that this function returns nothing.

### Possible fix
Maybe the decorator could explicitly check whether None is returned and then omit the unit check.

Patch information:
diff --git a/astropy/units/decorators.py b/astropy/units/decorators.py
index 8bece5a850..fc185cb5e0 100644
--- a/astropy/units/decorators.py
+++ b/astropy/units/decorators.py
@@ -221,6 +221,9 @@ class QuantityInput:
             with add_enabled_equivalencies(self.equivalencies):
                 return_ = wrapped_function(*func_args, **func_kwargs)
             if wrapped_signature.return_annotation is not inspect.Signature.empty:
+                # If the return value is None, return it directly without trying to convert units
+                if return_ is None:
+                    return None
                 return return_.to(wrapped_signature.return_annotation)
             else:
                 return return_


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `astropy/units/tests/test_quantity_decorator.py` and `astropy/units/tests/py3_test_quantity_annotations.py`.
Extra Requirements: 
Purpose: These files are required to find existing test cases that demonstrate the usage of the `@quantity_input` decorator with type annotations, which is necessary to find tests similar to the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/units/tests/py3_test_quantity_annotations.py
Line number range: 1 - 287
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. from functools import wraps
5. from textwrap import dedent
6. 
7. import pytest
8. 
9. from ... import units as u  # pylint: disable=W0611
10. 
11. 
12. def py3only(func):
13.     @wraps(func)
14.     def wrapper(*args, **kwargs):
15.         src = func(*args, **kwargs)
16.         code = compile(dedent(src), __file__, 'exec')
17.         # This uses an unqualified exec statement illegally in Python 2,
18.         # but perfectly allowed in Python 3 so in fact we eval the exec
19.         # call :)
20.         eval('exec(code)')
21. 
22.     return wrapper
23. 
24. 
25. @py3only
26. @pytest.mark.parametrize("solarx_unit,solary_unit", [
27.                          ("u.arcsec", "u.arcsec"),
28.                          ("'angle'", "'angle'")])
29. def test_args3(solarx_unit, solary_unit):
30.     src = """
31.     @u.quantity_input
32.     def myfunc_args(solarx: {0}, solary: {1}):
33.         return solarx, solary
34. 
35.     solarx, solary = myfunc_args(1*u.arcsec, 1*u.arcsec)
36. 
37.     assert isinstance(solarx, u.Quantity)
38.     assert isinstance(solary, u.Quantity)
39. 
40.     assert solarx.unit == u.arcsec
41.     assert solary.unit == u.arcsec
42.     """.format(solarx_unit, solary_unit)
43.     return src
44. 
45. 
46. @py3only
47. @pytest.mark.parametrize("solarx_unit,solary_unit", [
48.                          ("u.arcsec", "u.arcsec"),
49.                          ("'angle'", "'angle'")])
50. def test_args_noconvert3(solarx_unit, solary_unit):
51.     src = """
52.     @u.quantity_input()
53.     def myfunc_args(solarx: {0}, solary: {1}):
54.         return solarx, solary
55. 
56.     solarx, solary = myfunc_args(1*u.deg, 1*u.arcmin)
57. 
58.     assert isinstance(solarx, u.Quantity)
59.     assert isinstance(solary, u.Quantity)
60. 
61.     assert solarx.unit == u.deg
62.     assert solary.unit == u.arcmin
63.     """.format(solarx_unit, solary_unit)
64.     return src
65. 
66. 
67. @py3only
68. @pytest.mark.parametrize("solarx_unit", [
69.                          "u.arcsec", "'angle'"])
70. def test_args_nonquantity3(solarx_unit):
71.     src = """
72.     @u.quantity_input
73.     def myfunc_args(solarx: {0}, solary):
74.         return solarx, solary
75. 
76.     solarx, solary = myfunc_args(1*u.arcsec, 100)
77. 
78.     assert isinstance(solarx, u.Quantity)
79.     assert isinstance(solary, int)
80. 
81.     assert solarx.unit == u.arcsec
82.     """.format(solarx_unit)
83.     return src
84. 
85. 
86. @py3only
87. @pytest.mark.parametrize("solarx_unit,solary_unit", [
88.                          ("u.arcsec", "u.eV"),
89.                          ("'angle'", "'energy'")])
90. def test_arg_equivalencies3(solarx_unit, solary_unit):
91.     src = """
92.     @u.quantity_input(equivalencies=u.mass_energy())
93.     def myfunc_args(solarx: {0}, solary: {1}):
94.         return solarx, solary+(10*u.J)  # Add an energy to check equiv is working
95. 
96.     solarx, solary = myfunc_args(1*u.arcsec, 100*u.gram)
97. 
98.     assert isinstance(solarx, u.Quantity)
99.     assert isinstance(solary, u.Quantity)
100. 
101.     assert solarx.unit == u.arcsec
102.     assert solary.unit == u.gram
103.     """.format(solarx_unit, solary_unit)
104.     return src
105. 
106. 
107. @py3only
108. @pytest.mark.parametrize("solarx_unit,solary_unit", [
109.                          ("u.arcsec", "u.deg"),
110.                          ("'angle'", "'angle'")])
111. def test_wrong_unit3(solarx_unit, solary_unit):
112.     src = """
113.     @u.quantity_input
114.     def myfunc_args(solarx: {0}, solary: {1}):
115.         return solarx, solary
116. 
117.     with pytest.raises(u.UnitsError) as e:
118.         solarx, solary = myfunc_args(1*u.arcsec, 100*u.km)
119. 
120.     str_to = str({1})
121.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' must be in units convertible to '{{0}}'.".format(str_to)
122.     """.format(solarx_unit, solary_unit)
123.     return src
124. 
125. 
126. @py3only
127. @pytest.mark.parametrize("solarx_unit,solary_unit", [
128.                          ("u.arcsec", "u.deg"),
129.                          ("'angle'", "'angle'")])
130. def test_not_quantity3(solarx_unit, solary_unit):
131.     src = """
132.     @u.quantity_input
133.     def myfunc_args(solarx: {0}, solary: {1}):
134.         return solarx, solary
135. 
136.     with pytest.raises(TypeError) as e:
137.         solarx, solary = myfunc_args(1*u.arcsec, 100)
138.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
139.     """.format(solarx_unit, solary_unit)
140.     return src
141. 
142. 
143. @py3only
144. def test_decorator_override():
145.     src = """
146.     @u.quantity_input(solarx=u.arcsec)
147.     def myfunc_args(solarx: u.km, solary: u.arcsec):
148.         return solarx, solary
149. 
150.     solarx, solary = myfunc_args(1*u.arcsec, 1*u.arcsec)
151. 
152.     assert isinstance(solarx, u.Quantity)
153.     assert isinstance(solary, u.Quantity)
154. 
155.     assert solarx.unit == u.arcsec
156.     assert solary.unit == u.arcsec
157.     """
158.     return src
159. 
160. 
161. @py3only
162. @pytest.mark.parametrize("solarx_unit,solary_unit", [
163.                          ("u.arcsec", "u.deg"),
164.                          ("'angle'", "'angle'")])
165. def test_kwargs3(solarx_unit, solary_unit):
166.     src = """
167.     @u.quantity_input
168.     def myfunc_args(solarx: {0}, solary, myk: {1}=1*u.arcsec):
169.         return solarx, solary, myk
170. 
171.     solarx, solary, myk = myfunc_args(1*u.arcsec, 100, myk=100*u.deg)
172. 
173.     assert isinstance(solarx, u.Quantity)
174.     assert isinstance(solary, int)
175.     assert isinstance(myk, u.Quantity)
176. 
177.     assert myk.unit == u.deg
178.     """.format(solarx_unit, solary_unit)
179.     return src
180. 
181. 
182. @py3only
183. @pytest.mark.parametrize("solarx_unit,solary_unit", [
184.                          ("u.arcsec", "u.deg"),
185.                          ("'angle'", "'angle'")])
186. def test_unused_kwargs3(solarx_unit, solary_unit):
187.     src = """
188.     @u.quantity_input
189.     def myfunc_args(solarx: {0}, solary, myk: {1}=1*u.arcsec, myk2=1000):
190.         return solarx, solary, myk, myk2
191. 
192.     solarx, solary, myk, myk2 = myfunc_args(1*u.arcsec, 100, myk=100*u.deg, myk2=10)
193. 
194.     assert isinstance(solarx, u.Quantity)
195.     assert isinstance(solary, int)
196.     assert isinstance(myk, u.Quantity)
197.     assert isinstance(myk2, int)
198. 
199.     assert myk.unit == u.deg
200.     assert myk2 == 10
201.     """.format(solarx_unit, solary_unit)
202.     return src
203. 
204. 
205. @py3only
206. @pytest.mark.parametrize("solarx_unit,energy", [
207.                          ("u.arcsec", "u.eV"),
208.                          ("'angle'", "'energy'")])
209. def test_kwarg_equivalencies3(solarx_unit, energy):
210.     src = """
211.     @u.quantity_input(equivalencies=u.mass_energy())
212.     def myfunc_args(solarx: {0}, energy: {1}=10*u.eV):
213.         return solarx, energy+(10*u.J)  # Add an energy to check equiv is working
214. 
215.     solarx, energy = myfunc_args(1*u.arcsec, 100*u.gram)
216. 
217.     assert isinstance(solarx, u.Quantity)
218.     assert isinstance(energy, u.Quantity)
219. 
220.     assert solarx.unit == u.arcsec
221.     assert energy.unit == u.gram
222.     """.format(solarx_unit, energy)
223.     return src
224. 
225. 
226. @py3only
227. @pytest.mark.parametrize("solarx_unit,solary_unit", [
228.                          ("u.arcsec", "u.deg"),
229.                          ("'angle'", "'angle'")])
230. def test_kwarg_wrong_unit3(solarx_unit, solary_unit):
231.     src = """
232.     @u.quantity_input
233.     def myfunc_args(solarx: {0}, solary: {1}=10*u.deg):
234.         return solarx, solary
235. 
236.     with pytest.raises(u.UnitsError) as e:
237.         solarx, solary = myfunc_args(1*u.arcsec, solary=100*u.km)
238. 
239.     str_to = str({1})
240.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' must be in units convertible to '{{0}}'.".format(str_to)
241.     """.format(solarx_unit, solary_unit)
242.     return src
243. 
244. 
245. @py3only
246. @pytest.mark.parametrize("solarx_unit,solary_unit", [
247.                          ("u.arcsec", "u.deg"),
248.                          ("'angle'", "'angle'")])
249. def test_kwarg_not_quantity3(solarx_unit, solary_unit):
250.     src = """
251.     @u.quantity_input
252.     def myfunc_args(solarx: {0}, solary: {1}=10*u.deg):
253.         return solarx, solary
254. 
255.     with pytest.raises(TypeError) as e:
256.         solarx, solary = myfunc_args(1*u.arcsec, solary=100)
257.     assert str(e.value) == "Argument 'solary' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
258.     """.format(solarx_unit, solary_unit)
259.     return src
260. 
261. 
262. @py3only
263. @pytest.mark.parametrize("solarx_unit,solary_unit", [
264.                          ("u.arcsec", "u.deg"),
265.                          ("'angle'", "'angle'")])
266. def test_kwarg_default3(solarx_unit, solary_unit):
267.     src = """
268.     @u.quantity_input
269.     def myfunc_args(solarx: {0}, solary: {1}=10*u.deg):
270.         return solarx, solary
271. 
272.     solarx, solary = myfunc_args(1*u.arcsec)
273.     """.format(solarx_unit, solary_unit)
274.     return src
275. 
276. 
277. @py3only
278. def test_return_annotation():
279.     src = """
280.     @u.quantity_input
281.     def myfunc_args(solarx: u.arcsec) -> u.deg:
282.         return solarx
283. 
284.     solarx = myfunc_args(1*u.arcsec)
285.     assert solarx.unit is u.deg
286.     """
287.     return src


File: astropy/units/tests/test_quantity_decorator.py
Line number range: 1 - 329
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. import pytest
5. 
6. from ... import units as u
7. 
8. from .py3_test_quantity_annotations import *
9. 
10. # list of pairs (target unit/physical type, input unit)
11. x_inputs = [(u.arcsec, u.deg), ('angle', u.deg),
12.             (u.kpc/u.Myr, u.km/u.s), ('speed', u.km/u.s),
13.             ([u.arcsec, u.km], u.deg), ([u.arcsec, u.km], u.km),  # multiple allowed
14.             (['angle', 'length'], u.deg), (['angle', 'length'], u.km)]
15. 
16. y_inputs = [(u.arcsec, u.deg), ('angle', u.deg),
17.             (u.kpc/u.Myr, u.km/u.s), ('speed', u.km/u.s)]
18. 
19. 
20. @pytest.fixture(scope="module",
21.                 params=list(range(len(x_inputs))))
22. def x_input(request):
23.     return x_inputs[request.param]
24. 
25. 
26. @pytest.fixture(scope="module",
27.                 params=list(range(len(y_inputs))))
28. def y_input(request):
29.     return y_inputs[request.param]
30. 
31. # ---- Tests that use the fixtures defined above ----
32. 
33. 
34. def test_args(x_input, y_input):
35.     x_target, x_unit = x_input
36.     y_target, y_unit = y_input
37. 
38.     @u.quantity_input(x=x_target, y=y_target)
39.     def myfunc_args(x, y):
40.         return x, y
41. 
42.     x, y = myfunc_args(1*x_unit, 1*y_unit)
43. 
44.     assert isinstance(x, u.Quantity)
45.     assert isinstance(y, u.Quantity)
46. 
47.     assert x.unit == x_unit
48.     assert y.unit == y_unit
49. 
50. 
51. def test_args_nonquantity(x_input):
52.     x_target, x_unit = x_input
53. 
54.     @u.quantity_input(x=x_target)
55.     def myfunc_args(x, y):
56.         return x, y
57. 
58.     x, y = myfunc_args(1*x_unit, 100)
59. 
60.     assert isinstance(x, u.Quantity)
61.     assert isinstance(y, int)
62. 
63.     assert x.unit == x_unit
64. 
65. 
66. def test_wrong_unit(x_input, y_input):
67.     x_target, x_unit = x_input
68.     y_target, y_unit = y_input
69. 
70.     @u.quantity_input(x=x_target, y=y_target)
71.     def myfunc_args(x, y):
72.         return x, y
73. 
74.     with pytest.raises(u.UnitsError) as e:
75.         x, y = myfunc_args(1*x_unit, 100*u.Joule)  # has to be an unspecified unit
76. 
77.     str_to = str(y_target)
78.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' must be in units convertible to '{0}'.".format(str_to)
79. 
80. 
81. def test_not_quantity(x_input, y_input):
82.     x_target, x_unit = x_input
83.     y_target, y_unit = y_input
84. 
85.     @u.quantity_input(x=x_target, y=y_target)
86.     def myfunc_args(x, y):
87.         return x, y
88. 
89.     with pytest.raises(TypeError) as e:
90.         x, y = myfunc_args(1*x_unit, 100)
91.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
92. 
93. 
94. def test_kwargs(x_input, y_input):
95.     x_target, x_unit = x_input
96.     y_target, y_unit = y_input
97. 
98.     @u.quantity_input(x=x_target, y=y_target)
99.     def myfunc_args(x, my_arg, y=1*y_unit):
100.         return x, my_arg, y
101. 
102.     x, my_arg, y = myfunc_args(1*x_unit, 100, y=100*y_unit)
103. 
104.     assert isinstance(x, u.Quantity)
105.     assert isinstance(my_arg, int)
106.     assert isinstance(y, u.Quantity)
107. 
108.     assert y.unit == y_unit
109. 
110. 
111. def test_unused_kwargs(x_input, y_input):
112.     x_target, x_unit = x_input
113.     y_target, y_unit = y_input
114. 
115.     @u.quantity_input(x=x_target, y=y_target)
116.     def myfunc_args(x, my_arg1, y=y_unit, my_arg2=1000):
117.         return x, my_arg1, y, my_arg2
118. 
119.     x, my_arg1, y, my_arg2 = myfunc_args(1*x_unit, 100,
120.                                          y=100*y_unit, my_arg2=10)
121. 
122.     assert isinstance(x, u.Quantity)
123.     assert isinstance(my_arg1, int)
124.     assert isinstance(y, u.Quantity)
125.     assert isinstance(my_arg2, int)
126. 
127.     assert y.unit == y_unit
128.     assert my_arg2 == 10
129. 
130. 
131. def test_kwarg_wrong_unit(x_input, y_input):
132.     x_target, x_unit = x_input
133.     y_target, y_unit = y_input
134. 
135.     @u.quantity_input(x=x_target, y=y_target)
136.     def myfunc_args(x, y=10*y_unit):
137.         return x, y
138. 
139.     with pytest.raises(u.UnitsError) as e:
140.         x, y = myfunc_args(1*x_unit, y=100*u.Joule)
141. 
142.     str_to = str(y_target)
143.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' must be in units convertible to '{0}'.".format(str_to)
144. 
145. 
146. def test_kwarg_not_quantity(x_input, y_input):
147.     x_target, x_unit = x_input
148.     y_target, y_unit = y_input
149. 
150.     @u.quantity_input(x=x_target, y=y_target)
151.     def myfunc_args(x, y=10*y_unit):
152.         return x, y
153. 
154.     with pytest.raises(TypeError) as e:
155.         x, y = myfunc_args(1*x_unit, y=100)
156.     assert str(e.value) == "Argument 'y' to function 'myfunc_args' has no 'unit' attribute. You may want to pass in an astropy Quantity instead."
157. 
158. 
159. def test_kwarg_default(x_input, y_input):
160.     x_target, x_unit = x_input
161.     y_target, y_unit = y_input
162. 
163.     @u.quantity_input(x=x_target, y=y_target)
164.     def myfunc_args(x, y=10*y_unit):
165.         return x, y
166. 
167.     x, y = myfunc_args(1*x_unit)
168. 
169.     assert isinstance(x, u.Quantity)
170.     assert isinstance(y, u.Quantity)
171. 
172.     assert x.unit == x_unit
173.     assert y.unit == y_unit
174. 
175. 
176. def test_kwargs_input(x_input, y_input):
177.     x_target, x_unit = x_input
178.     y_target, y_unit = y_input
179. 
180.     @u.quantity_input(x=x_target, y=y_target)
181.     def myfunc_args(x=1*x_unit, y=1*y_unit):
182.         return x, y
183. 
184.     kwargs = {'x': 10*x_unit, 'y': 10*y_unit}
185.     x, y = myfunc_args(**kwargs)
186. 
187.     assert isinstance(x, u.Quantity)
188.     assert isinstance(y, u.Quantity)
189. 
190.     assert x.unit == x_unit
191.     assert y.unit == y_unit
192. 
193. 
194. def test_kwargs_extra(x_input):
195.     x_target, x_unit = x_input
196. 
197.     @u.quantity_input(x=x_target)
198.     def myfunc_args(x, **kwargs):
199.         return x
200. 
201.     x = myfunc_args(1*x_unit)
202. 
203.     assert isinstance(x, u.Quantity)
204. 
205.     assert x.unit == x_unit
206. 
207. # ---- Tests that don't used the fixtures ----
208. 
209. 
210. @pytest.mark.parametrize("x_unit,y_unit", [
211.                          (u.arcsec, u.eV),
212.                          ('angle', 'energy')])
213. def test_arg_equivalencies(x_unit, y_unit):
214.     @u.quantity_input(x=x_unit, y=y_unit,
215.                       equivalencies=u.mass_energy())
216.     def myfunc_args(x, y):
217.         return x, y+(10*u.J)  # Add an energy to check equiv is working
218. 
219.     x, y = myfunc_args(1*u.arcsec, 100*u.gram)
220. 
221.     assert isinstance(x, u.Quantity)
222.     assert isinstance(y, u.Quantity)
223. 
224.     assert x.unit == u.arcsec
225.     assert y.unit == u.gram
226. 
227. 
228. @pytest.mark.parametrize("x_unit,energy_unit", [
229.                          (u.arcsec, u.eV),
230.                          ('angle', 'energy')])
231. def test_kwarg_equivalencies(x_unit, energy_unit):
232.     @u.quantity_input(x=x_unit, energy=energy_unit, equivalencies=u.mass_energy())
233.     def myfunc_args(x, energy=10*u.eV):
234.         return x, energy+(10*u.J)  # Add an energy to check equiv is working
235. 
236.     x, energy = myfunc_args(1*u.arcsec, 100*u.gram)
237. 
238.     assert isinstance(x, u.Quantity)
239.     assert isinstance(energy, u.Quantity)
240. 
241.     assert x.unit == u.arcsec
242.     assert energy.unit == u.gram
243. 
244. 
245. def test_no_equivalent():
246.     class test_unit:
247.         pass
248. 
249.     class test_quantity:
250.         unit = test_unit()
251. 
252.     @u.quantity_input(x=u.arcsec)
253.     def myfunc_args(x):
254.         return x
255. 
256.     with pytest.raises(TypeError) as e:
257.         x, y = myfunc_args(test_quantity())
258. 
259.         assert str(e.value) == "Argument 'x' to function 'myfunc_args' has a 'unit' attribute without an 'is_equivalent' method. You may want to pass in an astropy Quantity instead."
260. 
261. 
262. def test_kwarg_invalid_physical_type():
263.     @u.quantity_input(x='angle', y='africanswallow')
264.     def myfunc_args(x, y=10*u.deg):
265.         return x, y
266. 
267.     with pytest.raises(ValueError) as e:
268.         x, y = myfunc_args(1*u.arcsec, y=100*u.deg)
269.     assert str(e.value) == "Invalid unit or physical type 'africanswallow'."
270. 
271. 
272. def test_default_value_check():
273.     x_target = u.deg
274.     x_unit = u.arcsec
275. 
276.     with pytest.raises(TypeError):
277.         @u.quantity_input(x=x_target)
278.         def myfunc_args(x=1.):
279.             return x
280. 
281.         x = myfunc_args()
282. 
283.     x = myfunc_args(1*x_unit)
284.     assert isinstance(x, u.Quantity)
285.     assert x.unit == x_unit
286. 
287. 
288. def test_args_None():
289.     x_target = u.deg
290.     x_unit = u.arcsec
291.     y_target = u.km
292.     y_unit = u.kpc
293. 
294.     @u.quantity_input(x=[x_target, None], y=[None, y_target])
295.     def myfunc_args(x, y):
296.         return x, y
297. 
298.     x, y = myfunc_args(1*x_unit, None)
299.     assert isinstance(x, u.Quantity)
300.     assert x.unit == x_unit
301.     assert y is None
302. 
303.     x, y = myfunc_args(None, 1*y_unit)
304.     assert isinstance(y, u.Quantity)
305.     assert y.unit == y_unit
306.     assert x is None
307. 
308. 
309. def test_args_None_kwarg():
310.     x_target = u.deg
311.     x_unit = u.arcsec
312.     y_target = u.km
313. 
314.     @u.quantity_input(x=x_target, y=y_target)
315.     def myfunc_args(x, y=None):
316.         return x, y
317. 
318.     x, y = myfunc_args(1*x_unit)
319.     assert isinstance(x, u.Quantity)
320.     assert x.unit == x_unit
321.     assert y is None
322. 
323.     x, y = myfunc_args(1*x_unit, None)
324.     assert isinstance(x, u.Quantity)
325.     assert x.unit == x_unit
326.     assert y is None
327. 
328.     with pytest.raises(TypeError):
329.         x, y = myfunc_args(None, None)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:49:49,792 - thread-126207454611136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user reported a bug related to the `@quantity_input` decorator's handling of `-> None` return type annotations in `__init__` methods.\n2. The provided context includes the complete source for `astropy/units/tests/py3_test_quantity_annotations.py` and `astropy/units/tests/test_quantity_decorator.py`.\n3. `py3_test_quantity_annotations.py` contains `test_return_annotation`, which directly tests the decorator's behavior with return value annotations, a core aspect of the bug.\n4. `test_quantity_decorator.py` contains `test_args_None` and `test_args_None_kwarg`, which test the decorator's handling of `None` as an input value. This is analogous to the bug, where the return value is `None` and should be handled gracefully.\n5. While no single test case perfectly matches the bug report (i.e., a test on an `__init__` method with a `-> None` annotation), the combination of these three tests covers the essential features: return annotation handling and `None` value processing.\n6. All necessary imports, fixtures, and helper functions for these tests are present in the provided context.\n7. Therefore, I have sufficient information and do not require additional context." query='' extra_requirements='' purpose=''
2025-12-21 19:49:49,793 - thread-126207454611136.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
