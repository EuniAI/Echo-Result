2025-12-23 04:36:15,791 - thread-133303881418432.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: makemigrations crashes for ForeignKey with mixed-case app name.

Description: Description
	
When i run "python3 manage.py migrate" on Django 3.1b1 shows me that error (Please, note that the code works well in 3.0)
ValueError: The field DJ_RegLogin.Content.category was declared with a lazy reference to 'dj_reglogin.category', but app 'dj_reglogin' isn't installed.
model.py (Conflict Part)
class Category(models.Model):
	title = models.CharField(max_length=100, db_index=True)
	slug = models.SlugField(max_length=100, db_index=True)
	class Meta:
		verbose_name = 'Category'
		verbose_name_plural = 'Categories'
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_category', None, kwargs={'slug': self.slug})
class Content(models.Model):
	title = models.CharField(max_length=100, unique=True)
	slug = models.SlugField(max_length=100, unique=True)
	body = RichTextField(config_name='default')
	posted = models.DateTimeField(db_index=True, auto_now_add=True)
	sites = models.ManyToManyField(Site)
	ip = models.GenericIPAddressField(editable=False)
	category = models.ForeignKey(Category, on_delete=models.CASCADE)
	user = models.ForeignKey(User, on_delete=models.CASCADE, null=False, blank=False, editable=False)
	status = models.CharField(max_length=10, choices=STATUS_CHOICES, default='draft')
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_post', None, kwargs={'slug': self.slug})
settings.py (Related to issue part)
INSTALLED_APPS = [
	'DJ_RegLogin',
	'django.contrib.admin',
	'django.contrib.auth',
	'django.contrib.contenttypes',
	'django.contrib.sessions',
	'django.contrib.messages',
	'django.contrib.staticfiles',
	'social_django',
	'ckeditor',
	'django.contrib.sites',
	'django.contrib.flatpages',
	'django.contrib.sitemaps',
]
apps.py
from django.apps import AppConfig
class DJ_RegLoginConfig(AppConfig):
	name = 'DJ_RegLogin'
	verbose_name = "Contents"

Patch information:
diff --git a/django/db/models/fields/related.py b/django/db/models/fields/related.py
index c2aea9c730..35b25c23c5 100644
--- a/django/db/models/fields/related.py
+++ b/django/db/models/fields/related.py
@@ -582,7 +582,12 @@ class ForeignObject(RelatedField):
         if self.remote_field.parent_link:
             kwargs['parent_link'] = self.remote_field.parent_link
         if isinstance(self.remote_field.model, str):
-            kwargs['to'] = self.remote_field.model.lower()
+            to_model = self.remote_field.model
+            if "." in to_model:
+                app_label, model_name = to_model.split(".", 1)
+                kwargs['to'] = "%s.%s" % (app_label, model_name.lower())
+            else:
+                kwargs['to'] = to_model.lower()
         else:
             kwargs['to'] = self.remote_field.model._meta.label_lower
         # If swappable is True, then see if we're actually pointing to the target


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 04:36:15,899 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: makemigrations crashes for ForeignKey with mixed-case app name.

Description: Description
	
When i run "python3 manage.py migrate" on Django 3.1b1 shows me that error (Please, note that the code works well in 3.0)
ValueError: The field DJ_RegLogin.Content.category was declared with a lazy reference to 'dj_reglogin.category', but app 'dj_reglogin' isn't installed.
model.py (Conflict Part)
class Category(models.Model):
	title = models.CharField(max_length=100, db_index=True)
	slug = models.SlugField(max_length=100, db_index=True)
	class Meta:
		verbose_name = 'Category'
		verbose_name_plural = 'Categories'
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_category', None, kwargs={'slug': self.slug})
class Content(models.Model):
	title = models.CharField(max_length=100, unique=True)
	slug = models.SlugField(max_length=100, unique=True)
	body = RichTextField(config_name='default')
	posted = models.DateTimeField(db_index=True, auto_now_add=True)
	sites = models.ManyToManyField(Site)
	ip = models.GenericIPAddressField(editable=False)
	category = models.ForeignKey(Category, on_delete=models.CASCADE)
	user = models.ForeignKey(User, on_delete=models.CASCADE, null=False, blank=False, editable=False)
	status = models.CharField(max_length=10, choices=STATUS_CHOICES, default='draft')
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_post', None, kwargs={'slug': self.slug})
settings.py (Related to issue part)
INSTALLED_APPS = [
	'DJ_RegLogin',
	'django.contrib.admin',
	'django.contrib.auth',
	'django.contrib.contenttypes',
	'django.contrib.sessions',
	'django.contrib.messages',
	'django.contrib.staticfiles',
	'social_django',
	'ckeditor',
	'django.contrib.sites',
	'django.contrib.flatpages',
	'django.contrib.sitemaps',
]
apps.py
from django.apps import AppConfig
class DJ_RegLoginConfig(AppConfig):
	name = 'DJ_RegLogin'
	verbose_name = "Contents"

Patch information:
diff --git a/django/db/models/fields/related.py b/django/db/models/fields/related.py
index c2aea9c730..35b25c23c5 100644
--- a/django/db/models/fields/related.py
+++ b/django/db/models/fields/related.py
@@ -582,7 +582,12 @@ class ForeignObject(RelatedField):
         if self.remote_field.parent_link:
             kwargs['parent_link'] = self.remote_field.parent_link
         if isinstance(self.remote_field.model, str):
-            kwargs['to'] = self.remote_field.model.lower()
+            to_model = self.remote_field.model
+            if "." in to_model:
+                app_label, model_name = to_model.split(".", 1)
+                kwargs['to'] = "%s.%s" % (app_label, model_name.lower())
+            else:
+                kwargs['to'] = to_model.lower()
         else:
             kwargs['to'] = self.remote_field.model._meta.label_lower
         # If swappable is True, then see if we're actually pointing to the target


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 04:37:03,500 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user is reporting a bug that occurs during the `makemigrations` process, specifically with a `ForeignKey` pointing to a model in an app with a mixed-case name. The issue seems to stem from how the field's `deconstruct` method generates a lazy reference, incorrectly lower-casing the app's label and causing a failure in model state resolution. To find relevant tests, I need to examine tests that cover model change detection and migration generation, especially those involving foreign keys and cross-app relationships. The most relevant file for this is likely `tests/migrations/test_autodetector.py`, as the autodetector is the component responsible for this process." query='Please provide the full content of `tests/migrations/test_autodetector.py`.' extra_requirements='' purpose='I need to analyze the tests for the migration autodetector to find existing test cases that cover ForeignKey deconstruction and resolution, particularly with cross-app relationships and varied casing in app labels, to identify tests relevant to the reported bug.'
2025-12-23 04:37:03,501 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/migrations/test_autodetector.py`.
2025-12-23 04:37:03,501 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 04:37:03,502 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 04:37:03,503 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 04:37:03,503 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/migrations/test_autodetector.py`.
Purpose: I need to analyze the tests for the migration autodetector to find existing test cases that cover ForeignKey deconstruction and resolution, particularly with cross-app relationships and varied casing in app labels, to identify tests relevant to the reported bug.
2025-12-23 04:37:07,041 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `tests/migrations/test_autodetector.py`. This will allow me to analyze the existing test cases for the migration autodetector, focusing on those that cover ForeignKey deconstruction and resolution. By examining these tests, I can identify how cross-app relationships and different app label casings are handled, which is directly relevant to the bug I am investigating.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/test_autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2126, 'candidates_token_count': 105, 'total_token_count': 2443, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2126}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 105}], 'thoughts_token_count': 212, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1604982466924758, 'model_name': 'gemini-2.5-pro'} id='run--dad791e4-4d1d-4973-be94-b71a5717ae9d-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_autodetector.py'}, 'id': '4a810a6d-8518-4d16-9e28-48f498032af2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2126, 'output_tokens': 105, 'total_tokens': 2443, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 212}}
2025-12-23 04:37:11,307 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have begun by retrieving the initial 500 lines of `tests/migrations/test_autodetector.py`. My next step is to fetch the remainder of the file's content. This complete picture will enable a thorough analysis of the existing test cases, specifically to identify those relevant to ForeignKey deconstruction and resolution." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 5000.0, "start_line": 501.0, "relative_path": "tests/migrations/test_autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11651, 'candidates_token_count': 98, 'total_token_count': 12006, 'cached_content_token_count': 1829, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11651}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1829}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 98}], 'thoughts_token_count': 257}, 'finish_reason': 'STOP', 'avg_logprobs': -0.34291855169802293, 'model_name': 'gemini-2.5-pro'} id='run--7f720e84-a888-4290-956c-ab4693f51f48-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 5000.0, 'start_line': 501.0, 'relative_path': 'tests/migrations/test_autodetector.py'}, 'id': 'e7966bb4-fe55-4c58-924e-e02070805ac8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11651, 'output_tokens': 98, 'total_tokens': 12006, 'input_token_details': {'cache_read': 1829}, 'output_token_details': {'reasoning': 257}}
2025-12-23 04:37:21,389 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the `tests/migrations/test_autodetector.py` file. By fetching the file in two parts, I was able to assemble the complete source code. Now, with the full content at my disposal, I can proceed with a thorough analysis to identify the specific test cases that cover ForeignKey deconstruction, cross-app relationships, and variations in app label casing, as you requested.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 53920, 'candidates_token_count': 87, 'total_token_count': 54827, 'cached_content_token_count': 11626, 'prompt_tokens_details': [{'modality': 1, 'token_count': 53920}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11626}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 820}, 'finish_reason': 'STOP', 'avg_logprobs': -1.2248436061815284, 'model_name': 'gemini-2.5-pro'} id='run--6b567c17-7ed4-4a1b-8dc6-14e810535004-0' usage_metadata={'input_tokens': 53920, 'output_tokens': 87, 'total_tokens': 54827, 'input_token_details': {'cache_read': 11626}, 'output_token_details': {'reasoning': 820}}
2025-12-23 04:37:21,391 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/migrations/test_autodetector.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to analyze the tests for the migration autodetector to find existing test cases that cover ForeignKey deconstruction and resolution, particularly with cross-app relationships and varied casing in app labels, to identify tests relevant to the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/migrations/test_autodetector.py
Line number range: 1 - 500
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, migrations, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import SimpleTestCase, TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author_fk = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("author", models.IntegerField()),
358.         ("title", models.CharField(max_length=200)),
359.     ])
360.     book_with_no_author = ModelState("otherapp", "Book", [
361.         ("id", models.AutoField(primary_key=True)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
382.         ("title", models.CharField(max_length=200)),
383.     ])
384.     book_indexes = ModelState("otherapp", "Book", [
385.         ("id", models.AutoField(primary_key=True)),
386.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
387.         ("title", models.CharField(max_length=200)),
388.     ], {
389.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
390.     })
391.     book_unordered_indexes = ModelState("otherapp", "Book", [
392.         ("id", models.AutoField(primary_key=True)),
393.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
394.         ("title", models.CharField(max_length=200)),
395.     ], {
396.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
397.     })
398.     book_foo_together = ModelState("otherapp", "Book", [
399.         ("id", models.AutoField(primary_key=True)),
400.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
401.         ("title", models.CharField(max_length=200)),
402.     ], {
403.         "index_together": {("author", "title")},
404.         "unique_together": {("author", "title")},
405.     })
406.     book_foo_together_2 = ModelState("otherapp", "Book", [
407.         ("id", models.AutoField(primary_key=True)),
408.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
409.         ("title", models.CharField(max_length=200)),
410.     ], {
411.         "index_together": {("title", "author")},
412.         "unique_together": {("title", "author")},
413.     })
414.     book_foo_together_3 = ModelState("otherapp", "Book", [
415.         ("id", models.AutoField(primary_key=True)),
416.         ("newfield", models.IntegerField()),
417.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
418.         ("title", models.CharField(max_length=200)),
419.     ], {
420.         "index_together": {("title", "newfield")},
421.         "unique_together": {("title", "newfield")},
422.     })
423.     book_foo_together_4 = ModelState("otherapp", "Book", [
424.         ("id", models.AutoField(primary_key=True)),
425.         ("newfield2", models.IntegerField()),
426.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
427.         ("title", models.CharField(max_length=200)),
428.     ], {
429.         "index_together": {("title", "newfield2")},
430.         "unique_together": {("title", "newfield2")},
431.     })
432.     attribution = ModelState("otherapp", "Attribution", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
435.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
436.     ])
437.     edition = ModelState("thirdapp", "Edition", [
438.         ("id", models.AutoField(primary_key=True)),
439.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
440.     ])
441.     custom_user = ModelState("thirdapp", "CustomUser", [
442.         ("id", models.AutoField(primary_key=True)),
443.         ("username", models.CharField(max_length=255)),
444.     ], bases=(AbstractBaseUser,))
445.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
446.         ("id", models.AutoField(primary_key=True)),
447.         ("username", models.CharField(max_length=255)),
448.     ])
449.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
450.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
451.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
452.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
453.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
454.     ])
455.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
456.     rabbit = ModelState("eggs", "Rabbit", [
457.         ("id", models.AutoField(primary_key=True)),
458.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
459.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
460.     ], {
461.         "unique_together": {("parent", "knight")},
462.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
463.     })
464. 
465.     def repr_changes(self, changes, include_dependencies=False):
466.         output = ""
467.         for app_label, migrations_ in sorted(changes.items()):
468.             output += "  %s:\n" % app_label
469.             for migration in migrations_:
470.                 output += "    %s\n" % migration.name
471.                 for operation in migration.operations:
472.                     output += "      %s\n" % operation
473.                 if include_dependencies:
474.                     output += "      Dependencies:\n"
475.                     if migration.dependencies:
476.                         for dep in migration.dependencies:
477.                             output += "        %s\n" % (dep,)
478.                     else:
479.                         output += "        None\n"
480.         return output
481. 
482.     def assertNumberMigrations(self, changes, app_label, number):
483.         if len(changes.get(app_label, [])) != number:
484.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
485.                 len(changes.get(app_label, [])),
486.                 app_label,
487.                 number,
488.                 self.repr_changes(changes),
489.             ))
490. 
491.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
492.         if not changes.get(app_label):
493.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
494.         if len(changes[app_label]) < position + 1:
495.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
496.         migration = changes[app_label][position]
497.         if set(migration.dependencies) != set(dependencies):
498.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
499.                 app_label,
500.                 migration.name,


File: tests/migrations/test_autodetector.py
Line number range: 501 - 5000
Content:
501.                 dependencies,
502.                 self.repr_changes(changes, include_dependencies=True),
503.             ))
504. 
505.     def assertOperationTypes(self, changes, app_label, position, types):
506.         if not changes.get(app_label):
507.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
508.         if len(changes[app_label]) < position + 1:
509.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
510.         migration = changes[app_label][position]
511.         real_types = [operation.__class__.__name__ for operation in migration.operations]
512.         if types != real_types:
513.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
514.                 app_label,
515.                 migration.name,
516.                 types,
517.                 self.repr_changes(changes),
518.             ))
519. 
520.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
521.         if not changes.get(app_label):
522.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
523.         if len(changes[app_label]) < position + 1:
524.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
525.         migration = changes[app_label][position]
526.         if len(changes[app_label]) < position + 1:
527.             self.fail("No operation at index %s for %s.%s\n%s" % (
528.                 operation_position,
529.                 app_label,
530.                 migration.name,
531.                 self.repr_changes(changes),
532.             ))
533.         operation = migration.operations[operation_position]
534.         for attr, value in attrs.items():
535.             if getattr(operation, attr, None) != value:
536.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
537.                     app_label,
538.                     migration.name,
539.                     operation_position,
540.                     attr,
541.                     value,
542.                     getattr(operation, attr, None),
543.                     self.repr_changes(changes),
544.                 ))
545. 
546.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
547.         if not changes.get(app_label):
548.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
549.         if len(changes[app_label]) < position + 1:
550.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
551.         migration = changes[app_label][position]
552.         if len(changes[app_label]) < position + 1:
553.             self.fail("No operation at index %s for %s.%s\n%s" % (
554.                 operation_position,
555.                 app_label,
556.                 migration.name,
557.                 self.repr_changes(changes),
558.             ))
559.         operation = migration.operations[operation_position]
560.         if not hasattr(operation, 'field'):
561.             self.fail("No field attribute for %s.%s op #%s." % (
562.                 app_label,
563.                 migration.name,
564.                 operation_position,
565.             ))
566.         field = operation.field
567.         for attr, value in attrs.items():
568.             if getattr(field, attr, None) != value:
569.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
570.                     app_label,
571.                     migration.name,
572.                     operation_position,
573.                     attr,
574.                     value,
575.                     getattr(field, attr, None),
576.                     self.repr_changes(changes),
577.                 ))
578. 
579.     def make_project_state(self, model_states):
580.         "Shortcut to make ProjectStates from lists of predefined models"
581.         project_state = ProjectState()
582.         for model_state in model_states:
583.             project_state.add_model(model_state.clone())
584.         return project_state
585. 
586.     def get_changes(self, before_states, after_states, questioner=None):
587.         return MigrationAutodetector(
588.             self.make_project_state(before_states),
589.             self.make_project_state(after_states),
590.             questioner,
591.         )._detect_changes()
592. 
593.     def test_arrange_for_graph(self):
594.         """Tests auto-naming of migrations for graph matching."""
595.         # Make a fake graph
596.         graph = MigrationGraph()
597.         graph.add_node(("testapp", "0001_initial"), None)
598.         graph.add_node(("testapp", "0002_foobar"), None)
599.         graph.add_node(("otherapp", "0001_initial"), None)
600.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
601.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
602.         # Use project state to make a new migration change set
603.         before = self.make_project_state([])
604.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
605.         autodetector = MigrationAutodetector(before, after)
606.         changes = autodetector._detect_changes()
607.         # Run through arrange_for_graph
608.         changes = autodetector.arrange_for_graph(changes, graph)
609.         # Make sure there's a new name, deps match, etc.
610.         self.assertEqual(changes["testapp"][0].name, "0003_author")
611.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
612.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
613.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
614. 
615.     def test_arrange_for_graph_with_multiple_initial(self):
616.         # Make a fake graph.
617.         graph = MigrationGraph()
618.         # Use project state to make a new migration change set.
619.         before = self.make_project_state([])
620.         after = self.make_project_state([self.author_with_book, self.book, self.attribution])
621.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({'ask_initial': True}))
622.         changes = autodetector._detect_changes()
623.         changes = autodetector.arrange_for_graph(changes, graph)
624. 
625.         self.assertEqual(changes['otherapp'][0].name, '0001_initial')
626.         self.assertEqual(changes['otherapp'][0].dependencies, [])
627.         self.assertEqual(changes['otherapp'][1].name, '0002_initial')
628.         self.assertCountEqual(
629.             changes['otherapp'][1].dependencies,
630.             [('testapp', '0001_initial'), ('otherapp', '0001_initial')],
631.         )
632.         self.assertEqual(changes['testapp'][0].name, '0001_initial')
633.         self.assertEqual(changes['testapp'][0].dependencies, [('otherapp', '0001_initial')])
634. 
635.     def test_trim_apps(self):
636.         """
637.         Trim does not remove dependencies but does remove unwanted apps.
638.         """
639.         # Use project state to make a new migration change set
640.         before = self.make_project_state([])
641.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
642.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
643.         changes = autodetector._detect_changes()
644.         # Run through arrange_for_graph
645.         graph = MigrationGraph()
646.         changes = autodetector.arrange_for_graph(changes, graph)
647.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
648.         changes = autodetector._trim_to_apps(changes, {"testapp"})
649.         # Make sure there's the right set of migrations
650.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
651.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
652.         self.assertNotIn("thirdapp", changes)
653. 
654.     def test_custom_migration_name(self):
655.         """Tests custom naming of migrations for graph matching."""
656.         # Make a fake graph
657.         graph = MigrationGraph()
658.         graph.add_node(("testapp", "0001_initial"), None)
659.         graph.add_node(("testapp", "0002_foobar"), None)
660.         graph.add_node(("otherapp", "0001_initial"), None)
661.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
662. 
663.         # Use project state to make a new migration change set
664.         before = self.make_project_state([])
665.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
666.         autodetector = MigrationAutodetector(before, after)
667.         changes = autodetector._detect_changes()
668. 
669.         # Run through arrange_for_graph
670.         migration_name = 'custom_name'
671.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
672. 
673.         # Make sure there's a new name, deps match, etc.
674.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
675.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
676.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
677.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
678. 
679.     def test_new_model(self):
680.         """Tests autodetection of new models."""
681.         changes = self.get_changes([], [self.other_pony_food])
682.         # Right number/type of migrations?
683.         self.assertNumberMigrations(changes, 'otherapp', 1)
684.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
685.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
686.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
687.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
688. 
689.     def test_old_model(self):
690.         """Tests deletion of old models."""
691.         changes = self.get_changes([self.author_empty], [])
692.         # Right number/type of migrations?
693.         self.assertNumberMigrations(changes, 'testapp', 1)
694.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
695.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
696. 
697.     def test_add_field(self):
698.         """Tests autodetection of new fields."""
699.         changes = self.get_changes([self.author_empty], [self.author_name])
700.         # Right number/type of migrations?
701.         self.assertNumberMigrations(changes, 'testapp', 1)
702.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
703.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
704. 
705.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
706.                 side_effect=AssertionError("Should not have prompted for not null addition"))
707.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
708.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
709.         # Right number/type of migrations?
710.         self.assertNumberMigrations(changes, 'testapp', 1)
711.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
712.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
713.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
714.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
715. 
716.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
717.                 side_effect=AssertionError("Should not have prompted for not null addition"))
718.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
719.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
720.         # Right number/type of migrations?
721.         self.assertNumberMigrations(changes, 'testapp', 1)
722.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
723.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
724.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
725.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
726. 
727.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
728.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
729.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
730.         # Right number/type of migrations?
731.         self.assertNumberMigrations(changes, 'testapp', 1)
732.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
733.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
734.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
735.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
736.         self.assertEqual(mocked_ask_method.call_count, 3)
737. 
738.     def test_remove_field(self):
739.         """Tests autodetection of removed fields."""
740.         changes = self.get_changes([self.author_name], [self.author_empty])
741.         # Right number/type of migrations?
742.         self.assertNumberMigrations(changes, 'testapp', 1)
743.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
744.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
745. 
746.     def test_alter_field(self):
747.         """Tests autodetection of new fields."""
748.         changes = self.get_changes([self.author_name], [self.author_name_longer])
749.         # Right number/type of migrations?
750.         self.assertNumberMigrations(changes, 'testapp', 1)
751.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
752.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
753. 
754.     def test_supports_functools_partial(self):
755.         def _content_file_name(instance, filename, key, **kwargs):
756.             return '{}/{}'.format(instance, filename)
757. 
758.         def content_file_name(key, **kwargs):
759.             return functools.partial(_content_file_name, key, **kwargs)
760. 
761.         # An unchanged partial reference.
762.         before = [ModelState("testapp", "Author", [
763.             ("id", models.AutoField(primary_key=True)),
764.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
765.         ])]
766.         after = [ModelState("testapp", "Author", [
767.             ("id", models.AutoField(primary_key=True)),
768.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
769.         ])]
770.         changes = self.get_changes(before, after)
771.         self.assertNumberMigrations(changes, 'testapp', 0)
772. 
773.         # A changed partial reference.
774.         args_changed = [ModelState("testapp", "Author", [
775.             ("id", models.AutoField(primary_key=True)),
776.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
777.         ])]
778.         changes = self.get_changes(before, args_changed)
779.         self.assertNumberMigrations(changes, 'testapp', 1)
780.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
781.         # Can't use assertOperationFieldAttributes because we need the
782.         # deconstructed version, i.e., the exploded func/args/keywords rather
783.         # than the partial: we don't care if it's not the same instance of the
784.         # partial, only if it's the same source function, args, and keywords.
785.         value = changes['testapp'][0].operations[0].field.upload_to
786.         self.assertEqual(
787.             (_content_file_name, ('other-file',), {}),
788.             (value.func, value.args, value.keywords)
789.         )
790. 
791.         kwargs_changed = [ModelState("testapp", "Author", [
792.             ("id", models.AutoField(primary_key=True)),
793.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
794.         ])]
795.         changes = self.get_changes(before, kwargs_changed)
796.         self.assertNumberMigrations(changes, 'testapp', 1)
797.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
798.         value = changes['testapp'][0].operations[0].field.upload_to
799.         self.assertEqual(
800.             (_content_file_name, ('file',), {'spam': 'eggs'}),
801.             (value.func, value.args, value.keywords)
802.         )
803. 
804.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
805.                 side_effect=AssertionError("Should not have prompted for not null addition"))
806.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
807.         """
808.         #23609 - Tests autodetection of nullable to non-nullable alterations.
809.         """
810.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
811.         # Right number/type of migrations?
812.         self.assertNumberMigrations(changes, 'testapp', 1)
813.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
814.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
815.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
816. 
817.     @mock.patch(
818.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
819.         return_value=models.NOT_PROVIDED,
820.     )
821.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
822.         """
823.         #23609 - Tests autodetection of nullable to non-nullable alterations.
824.         """
825.         changes = self.get_changes([self.author_name_null], [self.author_name])
826.         self.assertEqual(mocked_ask_method.call_count, 1)
827.         # Right number/type of migrations?
828.         self.assertNumberMigrations(changes, 'testapp', 1)
829.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
830.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
831.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
832. 
833.     @mock.patch(
834.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
835.         return_value='Some Name',
836.     )
837.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
838.         """
839.         #23609 - Tests autodetection of nullable to non-nullable alterations.
840.         """
841.         changes = self.get_changes([self.author_name_null], [self.author_name])
842.         self.assertEqual(mocked_ask_method.call_count, 1)
843.         # Right number/type of migrations?
844.         self.assertNumberMigrations(changes, 'testapp', 1)
845.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
846.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
847.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
848. 
849.     def test_rename_field(self):
850.         """Tests autodetection of renamed fields."""
851.         changes = self.get_changes(
852.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
853.         )
854.         # Right number/type of migrations?
855.         self.assertNumberMigrations(changes, 'testapp', 1)
856.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
857.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
858. 
859.     def test_rename_field_foreign_key_to_field(self):
860.         before = [
861.             ModelState('app', 'Foo', [
862.                 ('id', models.AutoField(primary_key=True)),
863.                 ('field', models.IntegerField(unique=True)),
864.             ]),
865.             ModelState('app', 'Bar', [
866.                 ('id', models.AutoField(primary_key=True)),
867.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
868.             ]),
869.         ]
870.         after = [
871.             ModelState('app', 'Foo', [
872.                 ('id', models.AutoField(primary_key=True)),
873.                 ('renamed_field', models.IntegerField(unique=True)),
874.             ]),
875.             ModelState('app', 'Bar', [
876.                 ('id', models.AutoField(primary_key=True)),
877.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
878.             ]),
879.         ]
880.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
881.         # Right number/type of migrations?
882.         self.assertNumberMigrations(changes, 'app', 1)
883.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
884.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
885. 
886.     def test_rename_foreign_object_fields(self):
887.         fields = ('first', 'second')
888.         renamed_fields = ('first_renamed', 'second_renamed')
889.         before = [
890.             ModelState('app', 'Foo', [
891.                 ('id', models.AutoField(primary_key=True)),
892.                 ('first', models.IntegerField()),
893.                 ('second', models.IntegerField()),
894.             ], options={'unique_together': {fields}}),
895.             ModelState('app', 'Bar', [
896.                 ('id', models.AutoField(primary_key=True)),
897.                 ('first', models.IntegerField()),
898.                 ('second', models.IntegerField()),
899.                 ('foo', models.ForeignObject(
900.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
901.                 )),
902.             ]),
903.         ]
904.         # Case 1: to_fields renames.
905.         after = [
906.             ModelState('app', 'Foo', [
907.                 ('id', models.AutoField(primary_key=True)),
908.                 ('first_renamed', models.IntegerField()),
909.                 ('second_renamed', models.IntegerField()),
910.             ], options={'unique_together': {renamed_fields}}),
911.             ModelState('app', 'Bar', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first', models.IntegerField()),
914.                 ('second', models.IntegerField()),
915.                 ('foo', models.ForeignObject(
916.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
917.                 )),
918.             ]),
919.         ]
920.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
921.         self.assertNumberMigrations(changes, 'app', 1)
922.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
923.         self.assertOperationAttributes(
924.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
925.         )
926.         self.assertOperationAttributes(
927.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
928.         )
929.         # Case 2: from_fields renames.
930.         after = [
931.             ModelState('app', 'Foo', [
932.                 ('id', models.AutoField(primary_key=True)),
933.                 ('first', models.IntegerField()),
934.                 ('second', models.IntegerField()),
935.             ], options={'unique_together': {fields}}),
936.             ModelState('app', 'Bar', [
937.                 ('id', models.AutoField(primary_key=True)),
938.                 ('first_renamed', models.IntegerField()),
939.                 ('second_renamed', models.IntegerField()),
940.                 ('foo', models.ForeignObject(
941.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
942.                 )),
943.             ]),
944.         ]
945.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
946.         self.assertNumberMigrations(changes, 'app', 1)
947.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
948.         self.assertOperationAttributes(
949.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
950.         )
951.         self.assertOperationAttributes(
952.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
953.         )
954. 
955.     def test_rename_referenced_primary_key(self):
956.         before = [
957.             ModelState('app', 'Foo', [
958.                 ('id', models.CharField(primary_key=True, serialize=False)),
959.             ]),
960.             ModelState('app', 'Bar', [
961.                 ('id', models.AutoField(primary_key=True)),
962.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
963.             ]),
964.         ]
965.         after = [
966.             ModelState('app', 'Foo', [
967.                 ('renamed_id', models.CharField(primary_key=True, serialize=False))
968.             ]),
969.             ModelState('app', 'Bar', [
970.                 ('id', models.AutoField(primary_key=True)),
971.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
972.             ]),
973.         ]
974.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
975.         self.assertNumberMigrations(changes, 'app', 1)
976.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
977.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='id', new_name='renamed_id')
978. 
979.     def test_rename_field_preserved_db_column(self):
980.         """
981.         RenameField is used if a field is renamed and db_column equal to the
982.         old field's column is added.
983.         """
984.         before = [
985.             ModelState('app', 'Foo', [
986.                 ('id', models.AutoField(primary_key=True)),
987.                 ('field', models.IntegerField()),
988.             ]),
989.         ]
990.         after = [
991.             ModelState('app', 'Foo', [
992.                 ('id', models.AutoField(primary_key=True)),
993.                 ('renamed_field', models.IntegerField(db_column='field')),
994.             ]),
995.         ]
996.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
997.         self.assertNumberMigrations(changes, 'app', 1)
998.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
999.         self.assertOperationAttributes(
1000.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
1001.         )
1002.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
1003.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1004.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
1005.         ))
1006. 
1007.     def test_rename_related_field_preserved_db_column(self):
1008.         before = [
1009.             ModelState('app', 'Foo', [
1010.                 ('id', models.AutoField(primary_key=True)),
1011.             ]),
1012.             ModelState('app', 'Bar', [
1013.                 ('id', models.AutoField(primary_key=True)),
1014.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
1015.             ]),
1016.         ]
1017.         after = [
1018.             ModelState('app', 'Foo', [
1019.                 ('id', models.AutoField(primary_key=True)),
1020.             ]),
1021.             ModelState('app', 'Bar', [
1022.                 ('id', models.AutoField(primary_key=True)),
1023.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
1024.             ]),
1025.         ]
1026.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
1027.         self.assertNumberMigrations(changes, 'app', 1)
1028.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
1029.         self.assertOperationAttributes(
1030.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
1031.         )
1032.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
1033.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1034.             'renamed_foo',
1035.             'django.db.models.ForeignKey',
1036.             [],
1037.             {'to': 'app.foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
1038.         ))
1039. 
1040.     def test_rename_model(self):
1041.         """Tests autodetection of renamed models."""
1042.         changes = self.get_changes(
1043.             [self.author_with_book, self.book],
1044.             [self.author_renamed_with_book, self.book_with_author_renamed],
1045.             MigrationQuestioner({"ask_rename_model": True}),
1046.         )
1047.         # Right number/type of migrations?
1048.         self.assertNumberMigrations(changes, 'testapp', 1)
1049.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1050.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1051.         # Now that RenameModel handles related fields too, there should be
1052.         # no AlterField for the related field.
1053.         self.assertNumberMigrations(changes, 'otherapp', 0)
1054. 
1055.     def test_rename_model_case(self):
1056.         """
1057.         Model name is case-insensitive. Changing case doesn't lead to any
1058.         autodetected operations.
1059.         """
1060.         author_renamed = ModelState('testapp', 'author', [
1061.             ('id', models.AutoField(primary_key=True)),
1062.         ])
1063.         changes = self.get_changes(
1064.             [self.author_empty, self.book],
1065.             [author_renamed, self.book],
1066.             questioner=MigrationQuestioner({'ask_rename_model': True}),
1067.         )
1068.         self.assertNumberMigrations(changes, 'testapp', 0)
1069.         self.assertNumberMigrations(changes, 'otherapp', 0)
1070. 
1071.     def test_rename_m2m_through_model(self):
1072.         """
1073.         Tests autodetection of renamed models that are used in M2M relations as
1074.         through models.
1075.         """
1076.         changes = self.get_changes(
1077.             [self.author_with_m2m_through, self.publisher, self.contract],
1078.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1079.             MigrationQuestioner({'ask_rename_model': True})
1080.         )
1081.         # Right number/type of migrations?
1082.         self.assertNumberMigrations(changes, 'testapp', 1)
1083.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1084.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1085. 
1086.     def test_rename_model_with_renamed_rel_field(self):
1087.         """
1088.         Tests autodetection of renamed models while simultaneously renaming one
1089.         of the fields that relate to the renamed model.
1090.         """
1091.         changes = self.get_changes(
1092.             [self.author_with_book, self.book],
1093.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1094.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1095.         )
1096.         # Right number/type of migrations?
1097.         self.assertNumberMigrations(changes, 'testapp', 1)
1098.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1099.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1100.         # Right number/type of migrations for related field rename?
1101.         # Alter is already taken care of.
1102.         self.assertNumberMigrations(changes, 'otherapp', 1)
1103.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1104.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1105. 
1106.     def test_rename_model_with_fks_in_different_position(self):
1107.         """
1108.         #24537 - The order of fields in a model does not influence
1109.         the RenameModel detection.
1110.         """
1111.         before = [
1112.             ModelState("testapp", "EntityA", [
1113.                 ("id", models.AutoField(primary_key=True)),
1114.             ]),
1115.             ModelState("testapp", "EntityB", [
1116.                 ("id", models.AutoField(primary_key=True)),
1117.                 ("some_label", models.CharField(max_length=255)),
1118.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1119.             ]),
1120.         ]
1121.         after = [
1122.             ModelState("testapp", "EntityA", [
1123.                 ("id", models.AutoField(primary_key=True)),
1124.             ]),
1125.             ModelState("testapp", "RenamedEntityB", [
1126.                 ("id", models.AutoField(primary_key=True)),
1127.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1128.                 ("some_label", models.CharField(max_length=255)),
1129.             ]),
1130.         ]
1131.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1132.         self.assertNumberMigrations(changes, "testapp", 1)
1133.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1134.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1135. 
1136.     def test_rename_model_reverse_relation_dependencies(self):
1137.         """
1138.         The migration to rename a model pointed to by a foreign key in another
1139.         app must run after the other app's migration that adds the foreign key
1140.         with model's original name. Therefore, the renaming migration has a
1141.         dependency on that other migration.
1142.         """
1143.         before = [
1144.             ModelState('testapp', 'EntityA', [
1145.                 ('id', models.AutoField(primary_key=True)),
1146.             ]),
1147.             ModelState('otherapp', 'EntityB', [
1148.                 ('id', models.AutoField(primary_key=True)),
1149.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1150.             ]),
1151.         ]
1152.         after = [
1153.             ModelState('testapp', 'RenamedEntityA', [
1154.                 ('id', models.AutoField(primary_key=True)),
1155.             ]),
1156.             ModelState('otherapp', 'EntityB', [
1157.                 ('id', models.AutoField(primary_key=True)),
1158.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1159.             ]),
1160.         ]
1161.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1162.         self.assertNumberMigrations(changes, 'testapp', 1)
1163.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1164.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1165.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1166. 
1167.     def test_fk_dependency(self):
1168.         """Having a ForeignKey automatically adds a dependency."""
1169.         # Note that testapp (author) has no dependencies,
1170.         # otherapp (book) depends on testapp (author),
1171.         # thirdapp (edition) depends on otherapp (book)
1172.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1173.         # Right number/type of migrations?
1174.         self.assertNumberMigrations(changes, 'testapp', 1)
1175.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1176.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1177.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1178.         # Right number/type of migrations?
1179.         self.assertNumberMigrations(changes, 'otherapp', 1)
1180.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1181.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1182.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1183.         # Right number/type of migrations?
1184.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1185.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1186.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1187.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1188. 
1189.     def test_proxy_fk_dependency(self):
1190.         """FK dependencies still work on proxy models."""
1191.         # Note that testapp (author) has no dependencies,
1192.         # otherapp (book) depends on testapp (authorproxy)
1193.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1194.         # Right number/type of migrations?
1195.         self.assertNumberMigrations(changes, 'testapp', 1)
1196.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1197.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1198.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1199.         # Right number/type of migrations?
1200.         self.assertNumberMigrations(changes, 'otherapp', 1)
1201.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1202.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1203.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1204.         # Right number/type of migrations?
1205.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1206.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1207.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1208.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1209. 
1210.     def test_same_app_no_fk_dependency(self):
1211.         """
1212.         A migration with a FK between two models of the same app
1213.         does not have a dependency to itself.
1214.         """
1215.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1216.         # Right number/type of migrations?
1217.         self.assertNumberMigrations(changes, 'testapp', 1)
1218.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1219.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1220.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1221.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1222. 
1223.     def test_circular_fk_dependency(self):
1224.         """
1225.         Having a circular ForeignKey dependency automatically
1226.         resolves the situation into 2 migrations on one side and 1 on the other.
1227.         """
1228.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1229.         # Right number/type of migrations?
1230.         self.assertNumberMigrations(changes, 'testapp', 1)
1231.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1232.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1233.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1234.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1235.         # Right number/type of migrations?
1236.         self.assertNumberMigrations(changes, 'otherapp', 2)
1237.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1238.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1239.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1240.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1241.         # both split migrations should be `initial`
1242.         self.assertTrue(changes['otherapp'][0].initial)
1243.         self.assertTrue(changes['otherapp'][1].initial)
1244. 
1245.     def test_same_app_circular_fk_dependency(self):
1246.         """
1247.         A migration with a FK between two models of the same app does
1248.         not have a dependency to itself.
1249.         """
1250.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1251.         # Right number/type of migrations?
1252.         self.assertNumberMigrations(changes, 'testapp', 1)
1253.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1254.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1255.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1256.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1257.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1258. 
1259.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1260.         """
1261.         #22275 - A migration with circular FK dependency does not try
1262.         to create unique together constraint and indexes before creating all
1263.         required fields first.
1264.         """
1265.         changes = self.get_changes([], [self.knight, self.rabbit])
1266.         # Right number/type of migrations?
1267.         self.assertNumberMigrations(changes, 'eggs', 1)
1268.         self.assertOperationTypes(
1269.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1270.         )
1271.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1272.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1273.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1274. 
1275.     def test_alter_db_table_add(self):
1276.         """Tests detection for adding db_table in model's options."""
1277.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1278.         # Right number/type of migrations?
1279.         self.assertNumberMigrations(changes, 'testapp', 1)
1280.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1281.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1282. 
1283.     def test_alter_db_table_change(self):
1284.         """Tests detection for changing db_table in model's options'."""
1285.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1286.         # Right number/type of migrations?
1287.         self.assertNumberMigrations(changes, 'testapp', 1)
1288.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1289.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1290. 
1291.     def test_alter_db_table_remove(self):
1292.         """Tests detection for removing db_table in model's options."""
1293.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1294.         # Right number/type of migrations?
1295.         self.assertNumberMigrations(changes, 'testapp', 1)
1296.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1297.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1298. 
1299.     def test_alter_db_table_no_changes(self):
1300.         """
1301.         Alter_db_table doesn't generate a migration if no changes have been made.
1302.         """
1303.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1304.         # Right number of migrations?
1305.         self.assertEqual(len(changes), 0)
1306. 
1307.     def test_keep_db_table_with_model_change(self):
1308.         """
1309.         Tests when model changes but db_table stays as-is, autodetector must not
1310.         create more than one operation.
1311.         """
1312.         changes = self.get_changes(
1313.             [self.author_with_db_table_options],
1314.             [self.author_renamed_with_db_table_options],
1315.             MigrationQuestioner({"ask_rename_model": True}),
1316.         )
1317.         # Right number/type of migrations?
1318.         self.assertNumberMigrations(changes, 'testapp', 1)
1319.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1320.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1321. 
1322.     def test_alter_db_table_with_model_change(self):
1323.         """
1324.         Tests when model and db_table changes, autodetector must create two
1325.         operations.
1326.         """
1327.         changes = self.get_changes(
1328.             [self.author_with_db_table_options],
1329.             [self.author_renamed_with_new_db_table_options],
1330.             MigrationQuestioner({"ask_rename_model": True}),
1331.         )
1332.         # Right number/type of migrations?
1333.         self.assertNumberMigrations(changes, 'testapp', 1)
1334.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1335.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1336.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1337. 
1338.     def test_identical_regex_doesnt_alter(self):
1339.         from_state = ModelState(
1340.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1341.                 RegexValidator(
1342.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1343.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1344.                     'invalid'
1345.                 )
1346.             ]))]
1347.         )
1348.         to_state = ModelState(
1349.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1350.         )
1351.         changes = self.get_changes([from_state], [to_state])
1352.         # Right number/type of migrations?
1353.         self.assertNumberMigrations(changes, "testapp", 0)
1354. 
1355.     def test_different_regex_does_alter(self):
1356.         from_state = ModelState(
1357.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1358.                 RegexValidator(
1359.                     re.compile('^[a-z]+\\Z', 32),
1360.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1361.                     'invalid'
1362.                 )
1363.             ]))]
1364.         )
1365.         to_state = ModelState(
1366.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1367.         )
1368.         changes = self.get_changes([from_state], [to_state])
1369.         self.assertNumberMigrations(changes, "testapp", 1)
1370.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1371. 
1372.     def test_empty_foo_together(self):
1373.         """
1374.         #23452 - Empty unique/index_together shouldn't generate a migration.
1375.         """
1376.         # Explicitly testing for not specified, since this is the case after
1377.         # a CreateModel operation w/o any definition on the original model
1378.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1379.         # Explicitly testing for None, since this was the issue in #23452 after
1380.         # an AlterFooTogether operation with e.g. () as value
1381.         model_state_none = ModelState("a", "model", [
1382.             ("id", models.AutoField(primary_key=True))
1383.         ], {
1384.             "index_together": None,
1385.             "unique_together": None,
1386.         })
1387.         # Explicitly testing for the empty set, since we now always have sets.
1388.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1389.         model_state_empty = ModelState("a", "model", [
1390.             ("id", models.AutoField(primary_key=True))
1391.         ], {
1392.             "index_together": set(),
1393.             "unique_together": set(),
1394.         })
1395. 
1396.         def test(from_state, to_state, msg):
1397.             changes = self.get_changes([from_state], [to_state])
1398.             if changes:
1399.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1400.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1401. 
1402.         tests = (
1403.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1404.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1405.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1406.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1407.             (model_state_none, model_state_none, '"None" to "None"'),
1408.             (model_state_none, model_state_empty, '"None" to "empty"'),
1409.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1410.             (model_state_empty, model_state_none, '"empty" to "None"'),
1411.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1412.         )
1413. 
1414.         for t in tests:
1415.             test(*t)
1416. 
1417.     def test_create_model_with_indexes(self):
1418.         """Test creation of new model with indexes already defined."""
1419.         author = ModelState('otherapp', 'Author', [
1420.             ('id', models.AutoField(primary_key=True)),
1421.             ('name', models.CharField(max_length=200)),
1422.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1423.         changes = self.get_changes([], [author])
1424.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1425.         # Right number of migrations?
1426.         self.assertEqual(len(changes['otherapp']), 1)
1427.         # Right number of actions?
1428.         migration = changes['otherapp'][0]
1429.         self.assertEqual(len(migration.operations), 2)
1430.         # Right actions order?
1431.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1432.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1433.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1434. 
1435.     def test_add_indexes(self):
1436.         """Test change detection of new indexes."""
1437.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1438.         self.assertNumberMigrations(changes, 'otherapp', 1)
1439.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1440.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1441.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1442. 
1443.     def test_remove_indexes(self):
1444.         """Test change detection of removed indexes."""
1445.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1446.         # Right number/type of migrations?
1447.         self.assertNumberMigrations(changes, 'otherapp', 1)
1448.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1449.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1450. 
1451.     def test_order_fields_indexes(self):
1452.         """Test change detection of reordering of fields in indexes."""
1453.         changes = self.get_changes(
1454.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1455.         )
1456.         self.assertNumberMigrations(changes, 'otherapp', 1)
1457.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1458.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1459.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1460.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1461. 
1462.     def test_create_model_with_check_constraint(self):
1463.         """Test creation of new model with constraints already defined."""
1464.         author = ModelState('otherapp', 'Author', [
1465.             ('id', models.AutoField(primary_key=True)),
1466.             ('name', models.CharField(max_length=200)),
1467.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1468.         changes = self.get_changes([], [author])
1469.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1470.         # Right number of migrations?
1471.         self.assertEqual(len(changes['otherapp']), 1)
1472.         # Right number of actions?
1473.         migration = changes['otherapp'][0]
1474.         self.assertEqual(len(migration.operations), 2)
1475.         # Right actions order?
1476.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1477.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1478.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1479. 
1480.     def test_add_constraints(self):
1481.         """Test change detection of new constraints."""
1482.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1483.         self.assertNumberMigrations(changes, 'testapp', 1)
1484.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1485.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1486.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1487. 
1488.     def test_remove_constraints(self):
1489.         """Test change detection of removed constraints."""
1490.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1491.         # Right number/type of migrations?
1492.         self.assertNumberMigrations(changes, 'testapp', 1)
1493.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1494.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1495. 
1496.     def test_add_foo_together(self):
1497.         """Tests index/unique_together detection."""
1498.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1499.         # Right number/type of migrations?
1500.         self.assertNumberMigrations(changes, "otherapp", 1)
1501.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1502.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1503.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1504. 
1505.     def test_remove_foo_together(self):
1506.         """Tests index/unique_together detection."""
1507.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1508.         # Right number/type of migrations?
1509.         self.assertNumberMigrations(changes, "otherapp", 1)
1510.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1511.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1512.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1513. 
1514.     def test_foo_together_remove_fk(self):
1515.         """Tests unique_together and field removal detection & ordering"""
1516.         changes = self.get_changes(
1517.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1518.         )
1519.         # Right number/type of migrations?
1520.         self.assertNumberMigrations(changes, "otherapp", 1)
1521.         self.assertOperationTypes(changes, "otherapp", 0, [
1522.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1523.         ])
1524.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1525.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1526.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1527. 
1528.     def test_foo_together_no_changes(self):
1529.         """
1530.         index/unique_together doesn't generate a migration if no
1531.         changes have been made.
1532.         """
1533.         changes = self.get_changes(
1534.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1535.         )
1536.         # Right number of migrations?
1537.         self.assertEqual(len(changes), 0)
1538. 
1539.     def test_foo_together_ordering(self):
1540.         """
1541.         index/unique_together also triggers on ordering changes.
1542.         """
1543.         changes = self.get_changes(
1544.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1545.         )
1546.         # Right number/type of migrations?
1547.         self.assertNumberMigrations(changes, "otherapp", 1)
1548.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1549.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1550.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1551. 
1552.     def test_add_field_and_foo_together(self):
1553.         """
1554.         Added fields will be created before using them in index/unique_together.
1555.         """
1556.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1557.         # Right number/type of migrations?
1558.         self.assertNumberMigrations(changes, "otherapp", 1)
1559.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1560.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1561.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1562. 
1563.     def test_create_model_and_unique_together(self):
1564.         author = ModelState("otherapp", "Author", [
1565.             ("id", models.AutoField(primary_key=True)),
1566.             ("name", models.CharField(max_length=200)),
1567.         ])
1568.         book_with_author = ModelState("otherapp", "Book", [
1569.             ("id", models.AutoField(primary_key=True)),
1570.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1571.             ("title", models.CharField(max_length=200)),
1572.         ], {
1573.             "index_together": {("title", "author")},
1574.             "unique_together": {("title", "author")},
1575.         })
1576.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1577.         # Right number of migrations?
1578.         self.assertEqual(len(changes['otherapp']), 1)
1579.         # Right number of actions?
1580.         migration = changes['otherapp'][0]
1581.         self.assertEqual(len(migration.operations), 4)
1582.         # Right actions order?
1583.         self.assertOperationTypes(
1584.             changes, 'otherapp', 0,
1585.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1586.         )
1587. 
1588.     def test_remove_field_and_foo_together(self):
1589.         """
1590.         Removed fields will be removed after updating index/unique_together.
1591.         """
1592.         changes = self.get_changes(
1593.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1594.         )
1595.         # Right number/type of migrations?
1596.         self.assertNumberMigrations(changes, "otherapp", 1)
1597.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1598.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1599.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1600.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1601. 
1602.     def test_rename_field_and_foo_together(self):
1603.         """
1604.         Removed fields will be removed after updating index/unique_together.
1605.         """
1606.         changes = self.get_changes(
1607.             [self.author_empty, self.book_foo_together_3],
1608.             [self.author_empty, self.book_foo_together_4],
1609.             MigrationQuestioner({"ask_rename": True}),
1610.         )
1611.         # Right number/type of migrations?
1612.         self.assertNumberMigrations(changes, "otherapp", 1)
1613.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1614.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1615.             ("title", "newfield2")
1616.         })
1617.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1618. 
1619.     def test_proxy(self):
1620.         """The autodetector correctly deals with proxy models."""
1621.         # First, we test adding a proxy model
1622.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1623.         # Right number/type of migrations?
1624.         self.assertNumberMigrations(changes, "testapp", 1)
1625.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1626.         self.assertOperationAttributes(
1627.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1628.         )
1629.         # Now, we test turning a proxy model into a non-proxy model
1630.         # It should delete the proxy then make the real one
1631.         changes = self.get_changes(
1632.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1633.         )
1634.         # Right number/type of migrations?
1635.         self.assertNumberMigrations(changes, "testapp", 1)
1636.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1637.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1638.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1639. 
1640.     def test_proxy_custom_pk(self):
1641.         """
1642.         #23415 - The autodetector must correctly deal with custom FK on proxy
1643.         models.
1644.         """
1645.         # First, we test the default pk field name
1646.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1647.         # The field name the FK on the book model points to
1648.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1649.         # Now, we test the custom pk field name
1650.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1651.         # The field name the FK on the book model points to
1652.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1653. 
1654.     def test_proxy_to_mti_with_fk_to_proxy(self):
1655.         # First, test the pk table and field name.
1656.         changes = self.get_changes(
1657.             [],
1658.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1659.         )
1660.         self.assertEqual(
1661.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1662.             'testapp_author',
1663.         )
1664.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1665. 
1666.         # Change AuthorProxy to use MTI.
1667.         changes = self.get_changes(
1668.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1669.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1670.         )
1671.         # Right number/type of migrations for the AuthorProxy model?
1672.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1673.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1674.         # Right number/type of migrations for the Book model with a FK to
1675.         # AuthorProxy?
1676.         self.assertNumberMigrations(changes, 'otherapp', 1)
1677.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1678.         # otherapp should depend on thirdapp.
1679.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1680.         # Now, test the pk table and field name.
1681.         self.assertEqual(
1682.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1683.             'thirdapp_authorproxy',
1684.         )
1685.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1686. 
1687.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1688.         # First, test the pk table and field name.
1689.         changes = self.get_changes(
1690.             [],
1691.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1692.         )
1693.         self.assertEqual(
1694.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1695.             'testapp_author',
1696.         )
1697.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1698. 
1699.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1700.         # a proxy of AuthorProxy.
1701.         changes = self.get_changes(
1702.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1703.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1704.         )
1705.         # Right number/type of migrations for the AuthorProxy model?
1706.         self.assertNumberMigrations(changes, 'testapp', 1)
1707.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1708.         # Right number/type of migrations for the Book model with a FK to
1709.         # AAuthorProxyProxy?
1710.         self.assertNumberMigrations(changes, 'otherapp', 1)
1711.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1712.         # otherapp should depend on testapp.
1713.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1714.         # Now, test the pk table and field name.
1715.         self.assertEqual(
1716.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1717.             'testapp_authorproxy',
1718.         )
1719.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1720. 
1721.     def test_unmanaged_create(self):
1722.         """The autodetector correctly deals with managed models."""
1723.         # First, we test adding an unmanaged model
1724.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1725.         # Right number/type of migrations?
1726.         self.assertNumberMigrations(changes, 'testapp', 1)
1727.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1728.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1729. 
1730.     def test_unmanaged_delete(self):
1731.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1732.         self.assertNumberMigrations(changes, 'testapp', 1)
1733.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1734. 
1735.     def test_unmanaged_to_managed(self):
1736.         # Now, we test turning an unmanaged model into a managed model
1737.         changes = self.get_changes(
1738.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1739.         )
1740.         # Right number/type of migrations?
1741.         self.assertNumberMigrations(changes, 'testapp', 1)
1742.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1743.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1744. 
1745.     def test_managed_to_unmanaged(self):
1746.         # Now, we turn managed to unmanaged.
1747.         changes = self.get_changes(
1748.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1749.         )
1750.         # Right number/type of migrations?
1751.         self.assertNumberMigrations(changes, 'testapp', 1)
1752.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1753.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1754. 
1755.     def test_unmanaged_custom_pk(self):
1756.         """
1757.         #23415 - The autodetector must correctly deal with custom FK on
1758.         unmanaged models.
1759.         """
1760.         # First, we test the default pk field name
1761.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1762.         # The field name the FK on the book model points to
1763.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1764.         # Now, we test the custom pk field name
1765.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1766.         # The field name the FK on the book model points to
1767.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1768. 
1769.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1770.     def test_swappable(self):
1771.         with isolate_lru_cache(apps.get_swappable_settings_name):
1772.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1773.         # Right number/type of migrations?
1774.         self.assertNumberMigrations(changes, 'testapp', 1)
1775.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1776.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1777.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1778. 
1779.     def test_swappable_changed(self):
1780.         with isolate_lru_cache(apps.get_swappable_settings_name):
1781.             before = self.make_project_state([self.custom_user, self.author_with_user])
1782.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1783.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1784.             autodetector = MigrationAutodetector(before, after)
1785.             changes = autodetector._detect_changes()
1786.         # Right number/type of migrations?
1787.         self.assertNumberMigrations(changes, 'testapp', 1)
1788.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1789.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1790.         fk_field = changes['testapp'][0].operations[0].field
1791.         to_model = '%s.%s' % (
1792.             fk_field.remote_field.model._meta.app_label,
1793.             fk_field.remote_field.model._meta.object_name,
1794.         )
1795.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1796. 
1797.     def test_add_field_with_default(self):
1798.         """#22030 - Adding a field with a default should work."""
1799.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1800.         # Right number/type of migrations?
1801.         self.assertNumberMigrations(changes, 'testapp', 1)
1802.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1803.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1804. 
1805.     def test_custom_deconstructible(self):
1806.         """
1807.         Two instances which deconstruct to the same value aren't considered a
1808.         change.
1809.         """
1810.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1811.         # Right number of migrations?
1812.         self.assertEqual(len(changes), 0)
1813. 
1814.     def test_deconstruct_field_kwarg(self):
1815.         """Field instances are handled correctly by nested deconstruction."""
1816.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1817.         self.assertEqual(changes, {})
1818. 
1819.     def test_deconstructible_list(self):
1820.         """Nested deconstruction descends into lists."""
1821.         # When lists contain items that deconstruct to identical values, those lists
1822.         # should be considered equal for the purpose of detecting state changes
1823.         # (even if the original items are unequal).
1824.         changes = self.get_changes(
1825.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1826.         )
1827.         self.assertEqual(changes, {})
1828.         # Legitimate differences within the deconstructed lists should be reported
1829.         # as a change
1830.         changes = self.get_changes(
1831.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1832.         )
1833.         self.assertEqual(len(changes), 1)
1834. 
1835.     def test_deconstructible_tuple(self):
1836.         """Nested deconstruction descends into tuples."""
1837.         # When tuples contain items that deconstruct to identical values, those tuples
1838.         # should be considered equal for the purpose of detecting state changes
1839.         # (even if the original items are unequal).
1840.         changes = self.get_changes(
1841.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1842.         )
1843.         self.assertEqual(changes, {})
1844.         # Legitimate differences within the deconstructed tuples should be reported
1845.         # as a change
1846.         changes = self.get_changes(
1847.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1848.         )
1849.         self.assertEqual(len(changes), 1)
1850. 
1851.     def test_deconstructible_dict(self):
1852.         """Nested deconstruction descends into dict values."""
1853.         # When dicts contain items whose values deconstruct to identical values,
1854.         # those dicts should be considered equal for the purpose of detecting
1855.         # state changes (even if the original values are unequal).
1856.         changes = self.get_changes(
1857.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1858.         )
1859.         self.assertEqual(changes, {})
1860.         # Legitimate differences within the deconstructed dicts should be reported
1861.         # as a change
1862.         changes = self.get_changes(
1863.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1864.         )
1865.         self.assertEqual(len(changes), 1)
1866. 
1867.     def test_nested_deconstructible_objects(self):
1868.         """
1869.         Nested deconstruction is applied recursively to the args/kwargs of
1870.         deconstructed objects.
1871.         """
1872.         # If the items within a deconstructed object's args/kwargs have the same
1873.         # deconstructed values - whether or not the items themselves are different
1874.         # instances - then the object as a whole is regarded as unchanged.
1875.         changes = self.get_changes(
1876.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1877.         )
1878.         self.assertEqual(changes, {})
1879.         # Differences that exist solely within the args list of a deconstructed object
1880.         # should be reported as changes
1881.         changes = self.get_changes(
1882.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1883.         )
1884.         self.assertEqual(len(changes), 1)
1885.         # Additional args should also be reported as a change
1886.         changes = self.get_changes(
1887.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1888.         )
1889.         self.assertEqual(len(changes), 1)
1890.         # Differences that exist solely within the kwargs dict of a deconstructed object
1891.         # should be reported as changes
1892.         changes = self.get_changes(
1893.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1894.         )
1895.         self.assertEqual(len(changes), 1)
1896.         # Additional kwargs should also be reported as a change
1897.         changes = self.get_changes(
1898.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1899.         )
1900.         self.assertEqual(len(changes), 1)
1901. 
1902.     def test_deconstruct_type(self):
1903.         """
1904.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1905.         by deep_deconstruct during serialization.
1906.         """
1907.         author = ModelState(
1908.             "testapp",
1909.             "Author",
1910.             [
1911.                 ("id", models.AutoField(primary_key=True)),
1912.                 ("name", models.CharField(
1913.                     max_length=200,
1914.                     # IntegerField intentionally not instantiated.
1915.                     default=models.IntegerField,
1916.                 ))
1917.             ],
1918.         )
1919.         changes = self.get_changes([], [author])
1920.         # Right number/type of migrations?
1921.         self.assertNumberMigrations(changes, 'testapp', 1)
1922.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1923. 
1924.     def test_replace_string_with_foreignkey(self):
1925.         """
1926.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1927.         work.
1928.         """
1929.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1930.         # Right number/type of migrations?
1931.         self.assertNumberMigrations(changes, 'testapp', 1)
1932.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1933.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1934.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1935.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1936. 
1937.     def test_foreign_key_removed_before_target_model(self):
1938.         """
1939.         Removing an FK and the model it targets in the same change must remove
1940.         the FK field before the model to maintain consistency.
1941.         """
1942.         changes = self.get_changes(
1943.             [self.author_with_publisher, self.publisher], [self.author_name]
1944.         )  # removes both the model and FK
1945.         # Right number/type of migrations?
1946.         self.assertNumberMigrations(changes, 'testapp', 1)
1947.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1948.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1949.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1950. 
1951.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1952.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1953.     def test_add_many_to_many(self, mocked_ask_method):
1954.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1955.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1956.         # Right number/type of migrations?
1957.         self.assertNumberMigrations(changes, 'testapp', 1)
1958.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1959.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1960. 
1961.     def test_alter_many_to_many(self):
1962.         changes = self.get_changes(
1963.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1964.         )
1965.         # Right number/type of migrations?
1966.         self.assertNumberMigrations(changes, 'testapp', 1)
1967.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1968.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1969. 
1970.     def test_create_with_through_model(self):
1971.         """
1972.         Adding a m2m with a through model and the models that use it should be
1973.         ordered correctly.
1974.         """
1975.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1976.         # Right number/type of migrations?
1977.         self.assertNumberMigrations(changes, "testapp", 1)
1978.         self.assertOperationTypes(changes, "testapp", 0, [
1979.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1980.         ])
1981.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1982.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1983.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1984.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1985. 
1986.     def test_many_to_many_removed_before_through_model(self):
1987.         """
1988.         Removing a ManyToManyField and the "through" model in the same change
1989.         must remove the field before the model to maintain consistency.
1990.         """
1991.         changes = self.get_changes(
1992.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1993.             [self.book_with_no_author, self.author_name],
1994.         )
1995.         # Remove both the through model and ManyToMany
1996.         # Right number/type of migrations?
1997.         self.assertNumberMigrations(changes, "otherapp", 1)
1998.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1999.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
2000.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
2001. 
2002.     def test_many_to_many_removed_before_through_model_2(self):
2003.         """
2004.         Removing a model that contains a ManyToManyField and the "through" model
2005.         in the same change must remove the field before the model to maintain
2006.         consistency.
2007.         """
2008.         changes = self.get_changes(
2009.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
2010.             [self.author_name],
2011.         )
2012.         # Remove both the through model and ManyToMany
2013.         # Right number/type of migrations?
2014.         self.assertNumberMigrations(changes, "otherapp", 1)
2015.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
2016.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
2017.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
2018.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
2019. 
2020.     def test_m2m_w_through_multistep_remove(self):
2021.         """
2022.         A model with a m2m field that specifies a "through" model cannot be
2023.         removed in the same migration as that through model as the schema will
2024.         pass through an inconsistent state. The autodetector should produce two
2025.         migrations to avoid this issue.
2026.         """
2027.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
2028.         # Right number/type of migrations?
2029.         self.assertNumberMigrations(changes, "testapp", 1)
2030.         self.assertOperationTypes(changes, "testapp", 0, [
2031.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
2032.         ])
2033.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
2034.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
2035.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
2036.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
2037. 
2038.     def test_concrete_field_changed_to_many_to_many(self):
2039.         """
2040.         #23938 - Changing a concrete field into a ManyToManyField
2041.         first removes the concrete field and then adds the m2m field.
2042.         """
2043.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
2044.         # Right number/type of migrations?
2045.         self.assertNumberMigrations(changes, "testapp", 1)
2046.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
2047.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
2048.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2049.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
2050. 
2051.     def test_many_to_many_changed_to_concrete_field(self):
2052.         """
2053.         #23938 - Changing a ManyToManyField into a concrete field
2054.         first removes the m2m field and then adds the concrete field.
2055.         """
2056.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
2057.         # Right number/type of migrations?
2058.         self.assertNumberMigrations(changes, "testapp", 1)
2059.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
2060.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
2061.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2062.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
2063.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
2064. 
2065.     def test_non_circular_foreignkey_dependency_removal(self):
2066.         """
2067.         If two models with a ForeignKey from one to the other are removed at the
2068.         same time, the autodetector should remove them in the correct order.
2069.         """
2070.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2071.         # Right number/type of migrations?
2072.         self.assertNumberMigrations(changes, "testapp", 1)
2073.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2074.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2075.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2076.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2077. 
2078.     def test_alter_model_options(self):
2079.         """Changing a model's options should make a change."""
2080.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, "testapp", 1)
2083.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2084.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2085.             "permissions": [('can_hire', 'Can hire')],
2086.             "verbose_name": "Authi",
2087.         })
2088. 
2089.         # Changing them back to empty should also make a change
2090.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2091.         # Right number/type of migrations?
2092.         self.assertNumberMigrations(changes, "testapp", 1)
2093.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2094.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2095. 
2096.     def test_alter_model_options_proxy(self):
2097.         """Changing a proxy model's options should also make a change."""
2098.         changes = self.get_changes(
2099.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2100.         )
2101.         # Right number/type of migrations?
2102.         self.assertNumberMigrations(changes, "testapp", 1)
2103.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2104.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2105.             "verbose_name": "Super Author"
2106.         })
2107. 
2108.     def test_set_alter_order_with_respect_to(self):
2109.         """Setting order_with_respect_to adds a field."""
2110.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2111.         # Right number/type of migrations?
2112.         self.assertNumberMigrations(changes, 'testapp', 1)
2113.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2114.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2115. 
2116.     def test_add_alter_order_with_respect_to(self):
2117.         """
2118.         Setting order_with_respect_to when adding the FK too does
2119.         things in the right order.
2120.         """
2121.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2122.         # Right number/type of migrations?
2123.         self.assertNumberMigrations(changes, 'testapp', 1)
2124.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2125.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2126.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2127. 
2128.     def test_remove_alter_order_with_respect_to(self):
2129.         """
2130.         Removing order_with_respect_to when removing the FK too does
2131.         things in the right order.
2132.         """
2133.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2134.         # Right number/type of migrations?
2135.         self.assertNumberMigrations(changes, 'testapp', 1)
2136.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2137.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2138.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2139. 
2140.     def test_add_model_order_with_respect_to(self):
2141.         """
2142.         Setting order_with_respect_to when adding the whole model
2143.         does things in the right order.
2144.         """
2145.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2146.         # Right number/type of migrations?
2147.         self.assertNumberMigrations(changes, 'testapp', 1)
2148.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2149.         self.assertOperationAttributes(
2150.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2151.         )
2152.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2153. 
2154.     def test_alter_model_managers(self):
2155.         """
2156.         Changing the model managers adds a new operation.
2157.         """
2158.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2159.         # Right number/type of migrations?
2160.         self.assertNumberMigrations(changes, 'otherapp', 1)
2161.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2162.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2163.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2164.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2165.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2166.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2167. 
2168.     def test_swappable_first_inheritance(self):
2169.         """Swappable models get their CreateModel first."""
2170.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2171.         # Right number/type of migrations?
2172.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2173.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2174.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2175.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2176. 
2177.     def test_default_related_name_option(self):
2178.         model_state = ModelState('app', 'model', [
2179.             ('id', models.AutoField(primary_key=True)),
2180.         ], options={'default_related_name': 'related_name'})
2181.         changes = self.get_changes([], [model_state])
2182.         self.assertNumberMigrations(changes, 'app', 1)
2183.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2184.         self.assertOperationAttributes(
2185.             changes, 'app', 0, 0, name='model',
2186.             options={'default_related_name': 'related_name'},
2187.         )
2188.         altered_model_state = ModelState('app', 'Model', [
2189.             ('id', models.AutoField(primary_key=True)),
2190.         ])
2191.         changes = self.get_changes([model_state], [altered_model_state])
2192.         self.assertNumberMigrations(changes, 'app', 1)
2193.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2194.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2195. 
2196.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2197.     def test_swappable_first_setting(self):
2198.         """Swappable models get their CreateModel first."""
2199.         with isolate_lru_cache(apps.get_swappable_settings_name):
2200.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2201.         # Right number/type of migrations?
2202.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2203.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2204.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2205.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2206. 
2207.     def test_bases_first(self):
2208.         """Bases of other models come first."""
2209.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2210.         # Right number/type of migrations?
2211.         self.assertNumberMigrations(changes, 'testapp', 1)
2212.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2213.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2214.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2215. 
2216.     def test_multiple_bases(self):
2217.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2218.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2219.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2220.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2221.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2222.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2223.         changes = self.get_changes([], [A, B, C, D, E])
2224.         # Right number/type of migrations?
2225.         self.assertNumberMigrations(changes, "app", 1)
2226.         self.assertOperationTypes(changes, "app", 0, [
2227.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2228.         ])
2229.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2230.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2231.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2232.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2233.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2234. 
2235.     def test_proxy_bases_first(self):
2236.         """Bases of proxies come first."""
2237.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2238.         # Right number/type of migrations?
2239.         self.assertNumberMigrations(changes, 'testapp', 1)
2240.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2241.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2242.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2243.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2244. 
2245.     def test_pk_fk_included(self):
2246.         """
2247.         A relation used as the primary key is kept as part of CreateModel.
2248.         """
2249.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2250.         # Right number/type of migrations?
2251.         self.assertNumberMigrations(changes, 'testapp', 1)
2252.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2253.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2254.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2255. 
2256.     def test_first_dependency(self):
2257.         """
2258.         A dependency to an app with no migrations uses __first__.
2259.         """
2260.         # Load graph
2261.         loader = MigrationLoader(connection)
2262.         before = self.make_project_state([])
2263.         after = self.make_project_state([self.book_migrations_fk])
2264.         after.real_apps = ["migrations"]
2265.         autodetector = MigrationAutodetector(before, after)
2266.         changes = autodetector._detect_changes(graph=loader.graph)
2267.         # Right number/type of migrations?
2268.         self.assertNumberMigrations(changes, 'otherapp', 1)
2269.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2270.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2271.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2272. 
2273.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2274.     def test_last_dependency(self):
2275.         """
2276.         A dependency to an app with existing migrations uses the
2277.         last migration of that app.
2278.         """
2279.         # Load graph
2280.         loader = MigrationLoader(connection)
2281.         before = self.make_project_state([])
2282.         after = self.make_project_state([self.book_migrations_fk])
2283.         after.real_apps = ["migrations"]
2284.         autodetector = MigrationAutodetector(before, after)
2285.         changes = autodetector._detect_changes(graph=loader.graph)
2286.         # Right number/type of migrations?
2287.         self.assertNumberMigrations(changes, 'otherapp', 1)
2288.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2289.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2290.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2291. 
2292.     def test_alter_fk_before_model_deletion(self):
2293.         """
2294.         ForeignKeys are altered _before_ the model they used to
2295.         refer to are deleted.
2296.         """
2297.         changes = self.get_changes(
2298.             [self.author_name, self.publisher_with_author],
2299.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2300.         )
2301.         # Right number/type of migrations?
2302.         self.assertNumberMigrations(changes, 'testapp', 1)
2303.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2304.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2305.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2306.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2307. 
2308.     def test_fk_dependency_other_app(self):
2309.         """
2310.         #23100 - ForeignKeys correctly depend on other apps' models.
2311.         """
2312.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2313.         # Right number/type of migrations?
2314.         self.assertNumberMigrations(changes, 'testapp', 1)
2315.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2316.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2317.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2318. 
2319.     def test_alter_field_to_fk_dependency_other_app(self):
2320.         changes = self.get_changes(
2321.             [self.author_empty, self.book_with_no_author_fk],
2322.             [self.author_empty, self.book],
2323.         )
2324.         self.assertNumberMigrations(changes, 'otherapp', 1)
2325.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
2326.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', '__first__')])
2327. 
2328.     def test_circular_dependency_mixed_addcreate(self):
2329.         """
2330.         #23315 - The dependency resolver knows to put all CreateModel
2331.         before AddField and not become unsolvable.
2332.         """
2333.         address = ModelState("a", "Address", [
2334.             ("id", models.AutoField(primary_key=True)),
2335.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2336.         ])
2337.         person = ModelState("a", "Person", [
2338.             ("id", models.AutoField(primary_key=True)),
2339.         ])
2340.         apackage = ModelState("b", "APackage", [
2341.             ("id", models.AutoField(primary_key=True)),
2342.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2343.         ])
2344.         country = ModelState("b", "DeliveryCountry", [
2345.             ("id", models.AutoField(primary_key=True)),
2346.         ])
2347.         changes = self.get_changes([], [address, person, apackage, country])
2348.         # Right number/type of migrations?
2349.         self.assertNumberMigrations(changes, 'a', 2)
2350.         self.assertNumberMigrations(changes, 'b', 1)
2351.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2352.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2353.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2354. 
2355.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2356.     def test_circular_dependency_swappable(self):
2357.         """
2358.         #23322 - The dependency resolver knows to explicitly resolve
2359.         swappable models.
2360.         """
2361.         with isolate_lru_cache(apps.get_swappable_settings_name):
2362.             tenant = ModelState("a", "Tenant", [
2363.                 ("id", models.AutoField(primary_key=True)),
2364.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2365.                 bases=(AbstractBaseUser,)
2366.             )
2367.             address = ModelState("b", "Address", [
2368.                 ("id", models.AutoField(primary_key=True)),
2369.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2370.             ])
2371.             changes = self.get_changes([], [address, tenant])
2372. 
2373.         # Right number/type of migrations?
2374.         self.assertNumberMigrations(changes, 'a', 2)
2375.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2376.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2377.         self.assertMigrationDependencies(changes, 'a', 0, [])
2378.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2379.         # Right number/type of migrations?
2380.         self.assertNumberMigrations(changes, 'b', 1)
2381.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2382.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2383. 
2384.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2385.     def test_circular_dependency_swappable2(self):
2386.         """
2387.         #23322 - The dependency resolver knows to explicitly resolve
2388.         swappable models but with the swappable not being the first migrated
2389.         model.
2390.         """
2391.         with isolate_lru_cache(apps.get_swappable_settings_name):
2392.             address = ModelState("a", "Address", [
2393.                 ("id", models.AutoField(primary_key=True)),
2394.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2395.             ])
2396.             tenant = ModelState("b", "Tenant", [
2397.                 ("id", models.AutoField(primary_key=True)),
2398.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2399.                 bases=(AbstractBaseUser,)
2400.             )
2401.             changes = self.get_changes([], [address, tenant])
2402.         # Right number/type of migrations?
2403.         self.assertNumberMigrations(changes, 'a', 2)
2404.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2405.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2406.         self.assertMigrationDependencies(changes, 'a', 0, [])
2407.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2408.         # Right number/type of migrations?
2409.         self.assertNumberMigrations(changes, 'b', 1)
2410.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2411.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2412. 
2413.     @override_settings(AUTH_USER_MODEL="a.Person")
2414.     def test_circular_dependency_swappable_self(self):
2415.         """
2416.         #23322 - The dependency resolver knows to explicitly resolve
2417.         swappable models.
2418.         """
2419.         with isolate_lru_cache(apps.get_swappable_settings_name):
2420.             person = ModelState("a", "Person", [
2421.                 ("id", models.AutoField(primary_key=True)),
2422.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2423.             ])
2424.             changes = self.get_changes([], [person])
2425.         # Right number/type of migrations?
2426.         self.assertNumberMigrations(changes, 'a', 1)
2427.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2428.         self.assertMigrationDependencies(changes, 'a', 0, [])
2429. 
2430.     @override_settings(AUTH_USER_MODEL='a.User')
2431.     def test_swappable_circular_multi_mti(self):
2432.         with isolate_lru_cache(apps.get_swappable_settings_name):
2433.             parent = ModelState('a', 'Parent', [
2434.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2435.             ])
2436.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2437.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2438.             changes = self.get_changes([], [parent, child, user])
2439.         self.assertNumberMigrations(changes, 'a', 1)
2440.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2441. 
2442.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2443.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2444.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2445.         """
2446.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2447.         without default should not prompt for a default.
2448.         """
2449.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2450.         # Right number/type of migrations?
2451.         self.assertNumberMigrations(changes, 'testapp', 1)
2452.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2453.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2454. 
2455.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2456.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2457.         """
2458.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2459.         without default should prompt for a default.
2460.         """
2461.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2462.         self.assertEqual(mocked_ask_method.call_count, 2)
2463.         # Right number/type of migrations?
2464.         self.assertNumberMigrations(changes, 'testapp', 1)
2465.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2466.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2467. 
2468.     def test_mti_inheritance_model_removal(self):
2469.         Animal = ModelState('app', 'Animal', [
2470.             ("id", models.AutoField(primary_key=True)),
2471.         ])
2472.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2473.         changes = self.get_changes([Animal, Dog], [Animal])
2474.         self.assertNumberMigrations(changes, 'app', 1)
2475.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2476.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')
2477. 
2478.     def test_add_model_with_field_removed_from_base_model(self):
2479.         """
2480.         Removing a base field takes place before adding a new inherited model
2481.         that has a field with the same name.
2482.         """
2483.         before = [
2484.             ModelState('app', 'readable', [
2485.                 ('id', models.AutoField(primary_key=True)),
2486.                 ('title', models.CharField(max_length=200)),
2487.             ]),
2488.         ]
2489.         after = [
2490.             ModelState('app', 'readable', [
2491.                 ('id', models.AutoField(primary_key=True)),
2492.             ]),
2493.             ModelState('app', 'book', [
2494.                 ('title', models.CharField(max_length=200)),
2495.             ], bases=('app.readable',)),
2496.         ]
2497.         changes = self.get_changes(before, after)
2498.         self.assertNumberMigrations(changes, 'app', 1)
2499.         self.assertOperationTypes(changes, 'app', 0, ['RemoveField', 'CreateModel'])
2500.         self.assertOperationAttributes(changes, 'app', 0, 0, name='title', model_name='readable')
2501.         self.assertOperationAttributes(changes, 'app', 0, 1, name='book')
2502. 
2503. 
2504. class MigrationSuggestNameTests(SimpleTestCase):
2505.     def test_single_operation(self):
2506.         class Migration(migrations.Migration):
2507.             operations = [migrations.CreateModel('Person', fields=[])]
2508. 
2509.         migration = Migration('0001_initial', 'test_app')
2510.         self.assertEqual(migration.suggest_name(), 'person')
2511. 
2512.         class Migration(migrations.Migration):
2513.             operations = [migrations.DeleteModel('Person')]
2514. 
2515.         migration = Migration('0002_initial', 'test_app')
2516.         self.assertEqual(migration.suggest_name(), 'delete_person')
2517. 
2518.     def test_two_create_models(self):
2519.         class Migration(migrations.Migration):
2520.             operations = [
2521.                 migrations.CreateModel('Person', fields=[]),
2522.                 migrations.CreateModel('Animal', fields=[]),
2523.             ]
2524. 
2525.         migration = Migration('0001_initial', 'test_app')
2526.         self.assertEqual(migration.suggest_name(), 'animal_person')
2527. 
2528.     def test_two_create_models_with_initial_true(self):
2529.         class Migration(migrations.Migration):
2530.             initial = True
2531.             operations = [
2532.                 migrations.CreateModel('Person', fields=[]),
2533.                 migrations.CreateModel('Animal', fields=[]),
2534.             ]
2535. 
2536.         migration = Migration('0001_initial', 'test_app')
2537.         self.assertEqual(migration.suggest_name(), 'animal_person')
2538. 
2539.     def test_none_name(self):
2540.         class Migration(migrations.Migration):
2541.             operations = [migrations.RunSQL('SELECT 1 FROM person;')]
2542. 
2543.         migration = Migration('0001_initial', 'test_app')
2544.         suggest_name = migration.suggest_name()
2545.         self.assertIs(suggest_name.startswith('auto_'), True)
2546. 
2547.     def test_none_name_with_initial_true(self):
2548.         class Migration(migrations.Migration):
2549.             initial = True
2550.             operations = [migrations.RunSQL('SELECT 1 FROM person;')]
2551. 
2552.         migration = Migration('0001_initial', 'test_app')
2553.         self.assertEqual(migration.suggest_name(), 'initial')
2554. 
2555.     def test_auto(self):
2556.         migration = migrations.Migration('0001_initial', 'test_app')
2557.         suggest_name = migration.suggest_name()
2558.         self.assertIs(suggest_name.startswith('auto_'), True)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 04:37:30,198 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of the file `tests/migrations/test_autodetector.py`. The provided context contains the file content from line 1 to 2558, which represents the entire file. Therefore, a single context covering all lines is created to fulfill the request.', relative_path='tests/migrations/test_autodetector.py', start_line=1, end_line=2558)]
2025-12-23 04:37:30,203 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `tests/migrations/test_autodetector.py`.
2025-12-23 04:37:30,203 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 04:37:30,203 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 04:37:30,203 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 04:37:30,204 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 04:37:30,205 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: makemigrations crashes for ForeignKey with mixed-case app name.

Description: Description
	
When i run "python3 manage.py migrate" on Django 3.1b1 shows me that error (Please, note that the code works well in 3.0)
ValueError: The field DJ_RegLogin.Content.category was declared with a lazy reference to 'dj_reglogin.category', but app 'dj_reglogin' isn't installed.
model.py (Conflict Part)
class Category(models.Model):
	title = models.CharField(max_length=100, db_index=True)
	slug = models.SlugField(max_length=100, db_index=True)
	class Meta:
		verbose_name = 'Category'
		verbose_name_plural = 'Categories'
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_category', None, kwargs={'slug': self.slug})
class Content(models.Model):
	title = models.CharField(max_length=100, unique=True)
	slug = models.SlugField(max_length=100, unique=True)
	body = RichTextField(config_name='default')
	posted = models.DateTimeField(db_index=True, auto_now_add=True)
	sites = models.ManyToManyField(Site)
	ip = models.GenericIPAddressField(editable=False)
	category = models.ForeignKey(Category, on_delete=models.CASCADE)
	user = models.ForeignKey(User, on_delete=models.CASCADE, null=False, blank=False, editable=False)
	status = models.CharField(max_length=10, choices=STATUS_CHOICES, default='draft')
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_post', None, kwargs={'slug': self.slug})
settings.py (Related to issue part)
INSTALLED_APPS = [
	'DJ_RegLogin',
	'django.contrib.admin',
	'django.contrib.auth',
	'django.contrib.contenttypes',
	'django.contrib.sessions',
	'django.contrib.messages',
	'django.contrib.staticfiles',
	'social_django',
	'ckeditor',
	'django.contrib.sites',
	'django.contrib.flatpages',
	'django.contrib.sitemaps',
]
apps.py
from django.apps import AppConfig
class DJ_RegLoginConfig(AppConfig):
	name = 'DJ_RegLogin'
	verbose_name = "Contents"

Patch information:
diff --git a/django/db/models/fields/related.py b/django/db/models/fields/related.py
index c2aea9c730..35b25c23c5 100644
--- a/django/db/models/fields/related.py
+++ b/django/db/models/fields/related.py
@@ -582,7 +582,12 @@ class ForeignObject(RelatedField):
         if self.remote_field.parent_link:
             kwargs['parent_link'] = self.remote_field.parent_link
         if isinstance(self.remote_field.model, str):
-            kwargs['to'] = self.remote_field.model.lower()
+            to_model = self.remote_field.model
+            if "." in to_model:
+                app_label, model_name = to_model.split(".", 1)
+                kwargs['to'] = "%s.%s" % (app_label, model_name.lower())
+            else:
+                kwargs['to'] = to_model.lower()
         else:
             kwargs['to'] = self.remote_field.model._meta.label_lower
         # If swappable is True, then see if we're actually pointing to the target


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/migrations/test_autodetector.py`.
Extra Requirements: 
Purpose: I need to analyze the tests for the migration autodetector to find existing test cases that cover ForeignKey deconstruction and resolution, particularly with cross-app relationships and varied casing in app labels, to identify tests relevant to the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/migrations/test_autodetector.py
Line number range: 1 - 2558
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, migrations, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import SimpleTestCase, TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author_fk = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("author", models.IntegerField()),
358.         ("title", models.CharField(max_length=200)),
359.     ])
360.     book_with_no_author = ModelState("otherapp", "Book", [
361.         ("id", models.AutoField(primary_key=True)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
382.         ("title", models.CharField(max_length=200)),
383.     ])
384.     book_indexes = ModelState("otherapp", "Book", [
385.         ("id", models.AutoField(primary_key=True)),
386.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
387.         ("title", models.CharField(max_length=200)),
388.     ], {
389.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
390.     })
391.     book_unordered_indexes = ModelState("otherapp", "Book", [
392.         ("id", models.AutoField(primary_key=True)),
393.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
394.         ("title", models.CharField(max_length=200)),
395.     ], {
396.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
397.     })
398.     book_foo_together = ModelState("otherapp", "Book", [
399.         ("id", models.AutoField(primary_key=True)),
400.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
401.         ("title", models.CharField(max_length=200)),
402.     ], {
403.         "index_together": {("author", "title")},
404.         "unique_together": {("author", "title")},
405.     })
406.     book_foo_together_2 = ModelState("otherapp", "Book", [
407.         ("id", models.AutoField(primary_key=True)),
408.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
409.         ("title", models.CharField(max_length=200)),
410.     ], {
411.         "index_together": {("title", "author")},
412.         "unique_together": {("title", "author")},
413.     })
414.     book_foo_together_3 = ModelState("otherapp", "Book", [
415.         ("id", models.AutoField(primary_key=True)),
416.         ("newfield", models.IntegerField()),
417.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
418.         ("title", models.CharField(max_length=200)),
419.     ], {
420.         "index_together": {("title", "newfield")},
421.         "unique_together": {("title", "newfield")},
422.     })
423.     book_foo_together_4 = ModelState("otherapp", "Book", [
424.         ("id", models.AutoField(primary_key=True)),
425.         ("newfield2", models.IntegerField()),
426.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
427.         ("title", models.CharField(max_length=200)),
428.     ], {
429.         "index_together": {("title", "newfield2")},
430.         "unique_together": {("title", "newfield2")},
431.     })
432.     attribution = ModelState("otherapp", "Attribution", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
435.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
436.     ])
437.     edition = ModelState("thirdapp", "Edition", [
438.         ("id", models.AutoField(primary_key=True)),
439.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
440.     ])
441.     custom_user = ModelState("thirdapp", "CustomUser", [
442.         ("id", models.AutoField(primary_key=True)),
443.         ("username", models.CharField(max_length=255)),
444.     ], bases=(AbstractBaseUser,))
445.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
446.         ("id", models.AutoField(primary_key=True)),
447.         ("username", models.CharField(max_length=255)),
448.     ])
449.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
450.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
451.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
452.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
453.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
454.     ])
455.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
456.     rabbit = ModelState("eggs", "Rabbit", [
457.         ("id", models.AutoField(primary_key=True)),
458.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
459.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
460.     ], {
461.         "unique_together": {("parent", "knight")},
462.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
463.     })
464. 
465.     def repr_changes(self, changes, include_dependencies=False):
466.         output = ""
467.         for app_label, migrations_ in sorted(changes.items()):
468.             output += "  %s:\n" % app_label
469.             for migration in migrations_:
470.                 output += "    %s\n" % migration.name
471.                 for operation in migration.operations:
472.                     output += "      %s\n" % operation
473.                 if include_dependencies:
474.                     output += "      Dependencies:\n"
475.                     if migration.dependencies:
476.                         for dep in migration.dependencies:
477.                             output += "        %s\n" % (dep,)
478.                     else:
479.                         output += "        None\n"
480.         return output
481. 
482.     def assertNumberMigrations(self, changes, app_label, number):
483.         if len(changes.get(app_label, [])) != number:
484.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
485.                 len(changes.get(app_label, [])),
486.                 app_label,
487.                 number,
488.                 self.repr_changes(changes),
489.             ))
490. 
491.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
492.         if not changes.get(app_label):
493.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
494.         if len(changes[app_label]) < position + 1:
495.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
496.         migration = changes[app_label][position]
497.         if set(migration.dependencies) != set(dependencies):
498.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
499.                 app_label,
500.                 migration.name,
501.                 dependencies,
502.                 self.repr_changes(changes, include_dependencies=True),
503.             ))
504. 
505.     def assertOperationTypes(self, changes, app_label, position, types):
506.         if not changes.get(app_label):
507.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
508.         if len(changes[app_label]) < position + 1:
509.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
510.         migration = changes[app_label][position]
511.         real_types = [operation.__class__.__name__ for operation in migration.operations]
512.         if types != real_types:
513.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
514.                 app_label,
515.                 migration.name,
516.                 types,
517.                 self.repr_changes(changes),
518.             ))
519. 
520.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
521.         if not changes.get(app_label):
522.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
523.         if len(changes[app_label]) < position + 1:
524.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
525.         migration = changes[app_label][position]
526.         if len(changes[app_label]) < position + 1:
527.             self.fail("No operation at index %s for %s.%s\n%s" % (
528.                 operation_position,
529.                 app_label,
530.                 migration.name,
531.                 self.repr_changes(changes),
532.             ))
533.         operation = migration.operations[operation_position]
534.         for attr, value in attrs.items():
535.             if getattr(operation, attr, None) != value:
536.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
537.                     app_label,
538.                     migration.name,
539.                     operation_position,
540.                     attr,
541.                     value,
542.                     getattr(operation, attr, None),
543.                     self.repr_changes(changes),
544.                 ))
545. 
546.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
547.         if not changes.get(app_label):
548.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
549.         if len(changes[app_label]) < position + 1:
550.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
551.         migration = changes[app_label][position]
552.         if len(changes[app_label]) < position + 1:
553.             self.fail("No operation at index %s for %s.%s\n%s" % (
554.                 operation_position,
555.                 app_label,
556.                 migration.name,
557.                 self.repr_changes(changes),
558.             ))
559.         operation = migration.operations[operation_position]
560.         if not hasattr(operation, 'field'):
561.             self.fail("No field attribute for %s.%s op #%s." % (
562.                 app_label,
563.                 migration.name,
564.                 operation_position,
565.             ))
566.         field = operation.field
567.         for attr, value in attrs.items():
568.             if getattr(field, attr, None) != value:
569.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
570.                     app_label,
571.                     migration.name,
572.                     operation_position,
573.                     attr,
574.                     value,
575.                     getattr(field, attr, None),
576.                     self.repr_changes(changes),
577.                 ))
578. 
579.     def make_project_state(self, model_states):
580.         "Shortcut to make ProjectStates from lists of predefined models"
581.         project_state = ProjectState()
582.         for model_state in model_states:
583.             project_state.add_model(model_state.clone())
584.         return project_state
585. 
586.     def get_changes(self, before_states, after_states, questioner=None):
587.         return MigrationAutodetector(
588.             self.make_project_state(before_states),
589.             self.make_project_state(after_states),
590.             questioner,
591.         )._detect_changes()
592. 
593.     def test_arrange_for_graph(self):
594.         """Tests auto-naming of migrations for graph matching."""
595.         # Make a fake graph
596.         graph = MigrationGraph()
597.         graph.add_node(("testapp", "0001_initial"), None)
598.         graph.add_node(("testapp", "0002_foobar"), None)
599.         graph.add_node(("otherapp", "0001_initial"), None)
600.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
601.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
602.         # Use project state to make a new migration change set
603.         before = self.make_project_state([])
604.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
605.         autodetector = MigrationAutodetector(before, after)
606.         changes = autodetector._detect_changes()
607.         # Run through arrange_for_graph
608.         changes = autodetector.arrange_for_graph(changes, graph)
609.         # Make sure there's a new name, deps match, etc.
610.         self.assertEqual(changes["testapp"][0].name, "0003_author")
611.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
612.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
613.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
614. 
615.     def test_arrange_for_graph_with_multiple_initial(self):
616.         # Make a fake graph.
617.         graph = MigrationGraph()
618.         # Use project state to make a new migration change set.
619.         before = self.make_project_state([])
620.         after = self.make_project_state([self.author_with_book, self.book, self.attribution])
621.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({'ask_initial': True}))
622.         changes = autodetector._detect_changes()
623.         changes = autodetector.arrange_for_graph(changes, graph)
624. 
625.         self.assertEqual(changes['otherapp'][0].name, '0001_initial')
626.         self.assertEqual(changes['otherapp'][0].dependencies, [])
627.         self.assertEqual(changes['otherapp'][1].name, '0002_initial')
628.         self.assertCountEqual(
629.             changes['otherapp'][1].dependencies,
630.             [('testapp', '0001_initial'), ('otherapp', '0001_initial')],
631.         )
632.         self.assertEqual(changes['testapp'][0].name, '0001_initial')
633.         self.assertEqual(changes['testapp'][0].dependencies, [('otherapp', '0001_initial')])
634. 
635.     def test_trim_apps(self):
636.         """
637.         Trim does not remove dependencies but does remove unwanted apps.
638.         """
639.         # Use project state to make a new migration change set
640.         before = self.make_project_state([])
641.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
642.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
643.         changes = autodetector._detect_changes()
644.         # Run through arrange_for_graph
645.         graph = MigrationGraph()
646.         changes = autodetector.arrange_for_graph(changes, graph)
647.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
648.         changes = autodetector._trim_to_apps(changes, {"testapp"})
649.         # Make sure there's the right set of migrations
650.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
651.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
652.         self.assertNotIn("thirdapp", changes)
653. 
654.     def test_custom_migration_name(self):
655.         """Tests custom naming of migrations for graph matching."""
656.         # Make a fake graph
657.         graph = MigrationGraph()
658.         graph.add_node(("testapp", "0001_initial"), None)
659.         graph.add_node(("testapp", "0002_foobar"), None)
660.         graph.add_node(("otherapp", "0001_initial"), None)
661.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
662. 
663.         # Use project state to make a new migration change set
664.         before = self.make_project_state([])
665.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
666.         autodetector = MigrationAutodetector(before, after)
667.         changes = autodetector._detect_changes()
668. 
669.         # Run through arrange_for_graph
670.         migration_name = 'custom_name'
671.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
672. 
673.         # Make sure there's a new name, deps match, etc.
674.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
675.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
676.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
677.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
678. 
679.     def test_new_model(self):
680.         """Tests autodetection of new models."""
681.         changes = self.get_changes([], [self.other_pony_food])
682.         # Right number/type of migrations?
683.         self.assertNumberMigrations(changes, 'otherapp', 1)
684.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
685.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
686.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
687.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
688. 
689.     def test_old_model(self):
690.         """Tests deletion of old models."""
691.         changes = self.get_changes([self.author_empty], [])
692.         # Right number/type of migrations?
693.         self.assertNumberMigrations(changes, 'testapp', 1)
694.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
695.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
696. 
697.     def test_add_field(self):
698.         """Tests autodetection of new fields."""
699.         changes = self.get_changes([self.author_empty], [self.author_name])
700.         # Right number/type of migrations?
701.         self.assertNumberMigrations(changes, 'testapp', 1)
702.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
703.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
704. 
705.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
706.                 side_effect=AssertionError("Should not have prompted for not null addition"))
707.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
708.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
709.         # Right number/type of migrations?
710.         self.assertNumberMigrations(changes, 'testapp', 1)
711.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
712.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
713.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
714.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
715. 
716.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
717.                 side_effect=AssertionError("Should not have prompted for not null addition"))
718.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
719.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
720.         # Right number/type of migrations?
721.         self.assertNumberMigrations(changes, 'testapp', 1)
722.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
723.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
724.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
725.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
726. 
727.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
728.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
729.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
730.         # Right number/type of migrations?
731.         self.assertNumberMigrations(changes, 'testapp', 1)
732.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
733.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
734.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
735.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
736.         self.assertEqual(mocked_ask_method.call_count, 3)
737. 
738.     def test_remove_field(self):
739.         """Tests autodetection of removed fields."""
740.         changes = self.get_changes([self.author_name], [self.author_empty])
741.         # Right number/type of migrations?
742.         self.assertNumberMigrations(changes, 'testapp', 1)
743.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
744.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
745. 
746.     def test_alter_field(self):
747.         """Tests autodetection of new fields."""
748.         changes = self.get_changes([self.author_name], [self.author_name_longer])
749.         # Right number/type of migrations?
750.         self.assertNumberMigrations(changes, 'testapp', 1)
751.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
752.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
753. 
754.     def test_supports_functools_partial(self):
755.         def _content_file_name(instance, filename, key, **kwargs):
756.             return '{}/{}'.format(instance, filename)
757. 
758.         def content_file_name(key, **kwargs):
759.             return functools.partial(_content_file_name, key, **kwargs)
760. 
761.         # An unchanged partial reference.
762.         before = [ModelState("testapp", "Author", [
763.             ("id", models.AutoField(primary_key=True)),
764.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
765.         ])]
766.         after = [ModelState("testapp", "Author", [
767.             ("id", models.AutoField(primary_key=True)),
768.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
769.         ])]
770.         changes = self.get_changes(before, after)
771.         self.assertNumberMigrations(changes, 'testapp', 0)
772. 
773.         # A changed partial reference.
774.         args_changed = [ModelState("testapp", "Author", [
775.             ("id", models.AutoField(primary_key=True)),
776.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
777.         ])]
778.         changes = self.get_changes(before, args_changed)
779.         self.assertNumberMigrations(changes, 'testapp', 1)
780.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
781.         # Can't use assertOperationFieldAttributes because we need the
782.         # deconstructed version, i.e., the exploded func/args/keywords rather
783.         # than the partial: we don't care if it's not the same instance of the
784.         # partial, only if it's the same source function, args, and keywords.
785.         value = changes['testapp'][0].operations[0].field.upload_to
786.         self.assertEqual(
787.             (_content_file_name, ('other-file',), {}),
788.             (value.func, value.args, value.keywords)
789.         )
790. 
791.         kwargs_changed = [ModelState("testapp", "Author", [
792.             ("id", models.AutoField(primary_key=True)),
793.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
794.         ])]
795.         changes = self.get_changes(before, kwargs_changed)
796.         self.assertNumberMigrations(changes, 'testapp', 1)
797.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
798.         value = changes['testapp'][0].operations[0].field.upload_to
799.         self.assertEqual(
800.             (_content_file_name, ('file',), {'spam': 'eggs'}),
801.             (value.func, value.args, value.keywords)
802.         )
803. 
804.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
805.                 side_effect=AssertionError("Should not have prompted for not null addition"))
806.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
807.         """
808.         #23609 - Tests autodetection of nullable to non-nullable alterations.
809.         """
810.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
811.         # Right number/type of migrations?
812.         self.assertNumberMigrations(changes, 'testapp', 1)
813.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
814.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
815.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
816. 
817.     @mock.patch(
818.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
819.         return_value=models.NOT_PROVIDED,
820.     )
821.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
822.         """
823.         #23609 - Tests autodetection of nullable to non-nullable alterations.
824.         """
825.         changes = self.get_changes([self.author_name_null], [self.author_name])
826.         self.assertEqual(mocked_ask_method.call_count, 1)
827.         # Right number/type of migrations?
828.         self.assertNumberMigrations(changes, 'testapp', 1)
829.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
830.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
831.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
832. 
833.     @mock.patch(
834.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
835.         return_value='Some Name',
836.     )
837.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
838.         """
839.         #23609 - Tests autodetection of nullable to non-nullable alterations.
840.         """
841.         changes = self.get_changes([self.author_name_null], [self.author_name])
842.         self.assertEqual(mocked_ask_method.call_count, 1)
843.         # Right number/type of migrations?
844.         self.assertNumberMigrations(changes, 'testapp', 1)
845.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
846.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
847.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
848. 
849.     def test_rename_field(self):
850.         """Tests autodetection of renamed fields."""
851.         changes = self.get_changes(
852.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
853.         )
854.         # Right number/type of migrations?
855.         self.assertNumberMigrations(changes, 'testapp', 1)
856.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
857.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
858. 
859.     def test_rename_field_foreign_key_to_field(self):
860.         before = [
861.             ModelState('app', 'Foo', [
862.                 ('id', models.AutoField(primary_key=True)),
863.                 ('field', models.IntegerField(unique=True)),
864.             ]),
865.             ModelState('app', 'Bar', [
866.                 ('id', models.AutoField(primary_key=True)),
867.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
868.             ]),
869.         ]
870.         after = [
871.             ModelState('app', 'Foo', [
872.                 ('id', models.AutoField(primary_key=True)),
873.                 ('renamed_field', models.IntegerField(unique=True)),
874.             ]),
875.             ModelState('app', 'Bar', [
876.                 ('id', models.AutoField(primary_key=True)),
877.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
878.             ]),
879.         ]
880.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
881.         # Right number/type of migrations?
882.         self.assertNumberMigrations(changes, 'app', 1)
883.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
884.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
885. 
886.     def test_rename_foreign_object_fields(self):
887.         fields = ('first', 'second')
888.         renamed_fields = ('first_renamed', 'second_renamed')
889.         before = [
890.             ModelState('app', 'Foo', [
891.                 ('id', models.AutoField(primary_key=True)),
892.                 ('first', models.IntegerField()),
893.                 ('second', models.IntegerField()),
894.             ], options={'unique_together': {fields}}),
895.             ModelState('app', 'Bar', [
896.                 ('id', models.AutoField(primary_key=True)),
897.                 ('first', models.IntegerField()),
898.                 ('second', models.IntegerField()),
899.                 ('foo', models.ForeignObject(
900.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
901.                 )),
902.             ]),
903.         ]
904.         # Case 1: to_fields renames.
905.         after = [
906.             ModelState('app', 'Foo', [
907.                 ('id', models.AutoField(primary_key=True)),
908.                 ('first_renamed', models.IntegerField()),
909.                 ('second_renamed', models.IntegerField()),
910.             ], options={'unique_together': {renamed_fields}}),
911.             ModelState('app', 'Bar', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first', models.IntegerField()),
914.                 ('second', models.IntegerField()),
915.                 ('foo', models.ForeignObject(
916.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
917.                 )),
918.             ]),
919.         ]
920.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
921.         self.assertNumberMigrations(changes, 'app', 1)
922.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
923.         self.assertOperationAttributes(
924.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
925.         )
926.         self.assertOperationAttributes(
927.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
928.         )
929.         # Case 2: from_fields renames.
930.         after = [
931.             ModelState('app', 'Foo', [
932.                 ('id', models.AutoField(primary_key=True)),
933.                 ('first', models.IntegerField()),
934.                 ('second', models.IntegerField()),
935.             ], options={'unique_together': {fields}}),
936.             ModelState('app', 'Bar', [
937.                 ('id', models.AutoField(primary_key=True)),
938.                 ('first_renamed', models.IntegerField()),
939.                 ('second_renamed', models.IntegerField()),
940.                 ('foo', models.ForeignObject(
941.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
942.                 )),
943.             ]),
944.         ]
945.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
946.         self.assertNumberMigrations(changes, 'app', 1)
947.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
948.         self.assertOperationAttributes(
949.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
950.         )
951.         self.assertOperationAttributes(
952.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
953.         )
954. 
955.     def test_rename_referenced_primary_key(self):
956.         before = [
957.             ModelState('app', 'Foo', [
958.                 ('id', models.CharField(primary_key=True, serialize=False)),
959.             ]),
960.             ModelState('app', 'Bar', [
961.                 ('id', models.AutoField(primary_key=True)),
962.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
963.             ]),
964.         ]
965.         after = [
966.             ModelState('app', 'Foo', [
967.                 ('renamed_id', models.CharField(primary_key=True, serialize=False))
968.             ]),
969.             ModelState('app', 'Bar', [
970.                 ('id', models.AutoField(primary_key=True)),
971.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
972.             ]),
973.         ]
974.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
975.         self.assertNumberMigrations(changes, 'app', 1)
976.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
977.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='id', new_name='renamed_id')
978. 
979.     def test_rename_field_preserved_db_column(self):
980.         """
981.         RenameField is used if a field is renamed and db_column equal to the
982.         old field's column is added.
983.         """
984.         before = [
985.             ModelState('app', 'Foo', [
986.                 ('id', models.AutoField(primary_key=True)),
987.                 ('field', models.IntegerField()),
988.             ]),
989.         ]
990.         after = [
991.             ModelState('app', 'Foo', [
992.                 ('id', models.AutoField(primary_key=True)),
993.                 ('renamed_field', models.IntegerField(db_column='field')),
994.             ]),
995.         ]
996.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
997.         self.assertNumberMigrations(changes, 'app', 1)
998.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
999.         self.assertOperationAttributes(
1000.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
1001.         )
1002.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
1003.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1004.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
1005.         ))
1006. 
1007.     def test_rename_related_field_preserved_db_column(self):
1008.         before = [
1009.             ModelState('app', 'Foo', [
1010.                 ('id', models.AutoField(primary_key=True)),
1011.             ]),
1012.             ModelState('app', 'Bar', [
1013.                 ('id', models.AutoField(primary_key=True)),
1014.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
1015.             ]),
1016.         ]
1017.         after = [
1018.             ModelState('app', 'Foo', [
1019.                 ('id', models.AutoField(primary_key=True)),
1020.             ]),
1021.             ModelState('app', 'Bar', [
1022.                 ('id', models.AutoField(primary_key=True)),
1023.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
1024.             ]),
1025.         ]
1026.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
1027.         self.assertNumberMigrations(changes, 'app', 1)
1028.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
1029.         self.assertOperationAttributes(
1030.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
1031.         )
1032.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
1033.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1034.             'renamed_foo',
1035.             'django.db.models.ForeignKey',
1036.             [],
1037.             {'to': 'app.foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
1038.         ))
1039. 
1040.     def test_rename_model(self):
1041.         """Tests autodetection of renamed models."""
1042.         changes = self.get_changes(
1043.             [self.author_with_book, self.book],
1044.             [self.author_renamed_with_book, self.book_with_author_renamed],
1045.             MigrationQuestioner({"ask_rename_model": True}),
1046.         )
1047.         # Right number/type of migrations?
1048.         self.assertNumberMigrations(changes, 'testapp', 1)
1049.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1050.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1051.         # Now that RenameModel handles related fields too, there should be
1052.         # no AlterField for the related field.
1053.         self.assertNumberMigrations(changes, 'otherapp', 0)
1054. 
1055.     def test_rename_model_case(self):
1056.         """
1057.         Model name is case-insensitive. Changing case doesn't lead to any
1058.         autodetected operations.
1059.         """
1060.         author_renamed = ModelState('testapp', 'author', [
1061.             ('id', models.AutoField(primary_key=True)),
1062.         ])
1063.         changes = self.get_changes(
1064.             [self.author_empty, self.book],
1065.             [author_renamed, self.book],
1066.             questioner=MigrationQuestioner({'ask_rename_model': True}),
1067.         )
1068.         self.assertNumberMigrations(changes, 'testapp', 0)
1069.         self.assertNumberMigrations(changes, 'otherapp', 0)
1070. 
1071.     def test_rename_m2m_through_model(self):
1072.         """
1073.         Tests autodetection of renamed models that are used in M2M relations as
1074.         through models.
1075.         """
1076.         changes = self.get_changes(
1077.             [self.author_with_m2m_through, self.publisher, self.contract],
1078.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1079.             MigrationQuestioner({'ask_rename_model': True})
1080.         )
1081.         # Right number/type of migrations?
1082.         self.assertNumberMigrations(changes, 'testapp', 1)
1083.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1084.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1085. 
1086.     def test_rename_model_with_renamed_rel_field(self):
1087.         """
1088.         Tests autodetection of renamed models while simultaneously renaming one
1089.         of the fields that relate to the renamed model.
1090.         """
1091.         changes = self.get_changes(
1092.             [self.author_with_book, self.book],
1093.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1094.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1095.         )
1096.         # Right number/type of migrations?
1097.         self.assertNumberMigrations(changes, 'testapp', 1)
1098.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1099.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1100.         # Right number/type of migrations for related field rename?
1101.         # Alter is already taken care of.
1102.         self.assertNumberMigrations(changes, 'otherapp', 1)
1103.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1104.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1105. 
1106.     def test_rename_model_with_fks_in_different_position(self):
1107.         """
1108.         #24537 - The order of fields in a model does not influence
1109.         the RenameModel detection.
1110.         """
1111.         before = [
1112.             ModelState("testapp", "EntityA", [
1113.                 ("id", models.AutoField(primary_key=True)),
1114.             ]),
1115.             ModelState("testapp", "EntityB", [
1116.                 ("id", models.AutoField(primary_key=True)),
1117.                 ("some_label", models.CharField(max_length=255)),
1118.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1119.             ]),
1120.         ]
1121.         after = [
1122.             ModelState("testapp", "EntityA", [
1123.                 ("id", models.AutoField(primary_key=True)),
1124.             ]),
1125.             ModelState("testapp", "RenamedEntityB", [
1126.                 ("id", models.AutoField(primary_key=True)),
1127.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1128.                 ("some_label", models.CharField(max_length=255)),
1129.             ]),
1130.         ]
1131.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1132.         self.assertNumberMigrations(changes, "testapp", 1)
1133.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1134.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1135. 
1136.     def test_rename_model_reverse_relation_dependencies(self):
1137.         """
1138.         The migration to rename a model pointed to by a foreign key in another
1139.         app must run after the other app's migration that adds the foreign key
1140.         with model's original name. Therefore, the renaming migration has a
1141.         dependency on that other migration.
1142.         """
1143.         before = [
1144.             ModelState('testapp', 'EntityA', [
1145.                 ('id', models.AutoField(primary_key=True)),
1146.             ]),
1147.             ModelState('otherapp', 'EntityB', [
1148.                 ('id', models.AutoField(primary_key=True)),
1149.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1150.             ]),
1151.         ]
1152.         after = [
1153.             ModelState('testapp', 'RenamedEntityA', [
1154.                 ('id', models.AutoField(primary_key=True)),
1155.             ]),
1156.             ModelState('otherapp', 'EntityB', [
1157.                 ('id', models.AutoField(primary_key=True)),
1158.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1159.             ]),
1160.         ]
1161.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1162.         self.assertNumberMigrations(changes, 'testapp', 1)
1163.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1164.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1165.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1166. 
1167.     def test_fk_dependency(self):
1168.         """Having a ForeignKey automatically adds a dependency."""
1169.         # Note that testapp (author) has no dependencies,
1170.         # otherapp (book) depends on testapp (author),
1171.         # thirdapp (edition) depends on otherapp (book)
1172.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1173.         # Right number/type of migrations?
1174.         self.assertNumberMigrations(changes, 'testapp', 1)
1175.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1176.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1177.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1178.         # Right number/type of migrations?
1179.         self.assertNumberMigrations(changes, 'otherapp', 1)
1180.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1181.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1182.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1183.         # Right number/type of migrations?
1184.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1185.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1186.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1187.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1188. 
1189.     def test_proxy_fk_dependency(self):
1190.         """FK dependencies still work on proxy models."""
1191.         # Note that testapp (author) has no dependencies,
1192.         # otherapp (book) depends on testapp (authorproxy)
1193.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1194.         # Right number/type of migrations?
1195.         self.assertNumberMigrations(changes, 'testapp', 1)
1196.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1197.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1198.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1199.         # Right number/type of migrations?
1200.         self.assertNumberMigrations(changes, 'otherapp', 1)
1201.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1202.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1203.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1204.         # Right number/type of migrations?
1205.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1206.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1207.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1208.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1209. 
1210.     def test_same_app_no_fk_dependency(self):
1211.         """
1212.         A migration with a FK between two models of the same app
1213.         does not have a dependency to itself.
1214.         """
1215.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1216.         # Right number/type of migrations?
1217.         self.assertNumberMigrations(changes, 'testapp', 1)
1218.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1219.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1220.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1221.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1222. 
1223.     def test_circular_fk_dependency(self):
1224.         """
1225.         Having a circular ForeignKey dependency automatically
1226.         resolves the situation into 2 migrations on one side and 1 on the other.
1227.         """
1228.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1229.         # Right number/type of migrations?
1230.         self.assertNumberMigrations(changes, 'testapp', 1)
1231.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1232.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1233.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1234.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1235.         # Right number/type of migrations?
1236.         self.assertNumberMigrations(changes, 'otherapp', 2)
1237.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1238.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1239.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1240.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1241.         # both split migrations should be `initial`
1242.         self.assertTrue(changes['otherapp'][0].initial)
1243.         self.assertTrue(changes['otherapp'][1].initial)
1244. 
1245.     def test_same_app_circular_fk_dependency(self):
1246.         """
1247.         A migration with a FK between two models of the same app does
1248.         not have a dependency to itself.
1249.         """
1250.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1251.         # Right number/type of migrations?
1252.         self.assertNumberMigrations(changes, 'testapp', 1)
1253.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1254.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1255.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1256.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1257.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1258. 
1259.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1260.         """
1261.         #22275 - A migration with circular FK dependency does not try
1262.         to create unique together constraint and indexes before creating all
1263.         required fields first.
1264.         """
1265.         changes = self.get_changes([], [self.knight, self.rabbit])
1266.         # Right number/type of migrations?
1267.         self.assertNumberMigrations(changes, 'eggs', 1)
1268.         self.assertOperationTypes(
1269.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1270.         )
1271.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1272.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1273.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1274. 
1275.     def test_alter_db_table_add(self):
1276.         """Tests detection for adding db_table in model's options."""
1277.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1278.         # Right number/type of migrations?
1279.         self.assertNumberMigrations(changes, 'testapp', 1)
1280.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1281.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1282. 
1283.     def test_alter_db_table_change(self):
1284.         """Tests detection for changing db_table in model's options'."""
1285.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1286.         # Right number/type of migrations?
1287.         self.assertNumberMigrations(changes, 'testapp', 1)
1288.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1289.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1290. 
1291.     def test_alter_db_table_remove(self):
1292.         """Tests detection for removing db_table in model's options."""
1293.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1294.         # Right number/type of migrations?
1295.         self.assertNumberMigrations(changes, 'testapp', 1)
1296.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1297.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1298. 
1299.     def test_alter_db_table_no_changes(self):
1300.         """
1301.         Alter_db_table doesn't generate a migration if no changes have been made.
1302.         """
1303.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1304.         # Right number of migrations?
1305.         self.assertEqual(len(changes), 0)
1306. 
1307.     def test_keep_db_table_with_model_change(self):
1308.         """
1309.         Tests when model changes but db_table stays as-is, autodetector must not
1310.         create more than one operation.
1311.         """
1312.         changes = self.get_changes(
1313.             [self.author_with_db_table_options],
1314.             [self.author_renamed_with_db_table_options],
1315.             MigrationQuestioner({"ask_rename_model": True}),
1316.         )
1317.         # Right number/type of migrations?
1318.         self.assertNumberMigrations(changes, 'testapp', 1)
1319.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1320.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1321. 
1322.     def test_alter_db_table_with_model_change(self):
1323.         """
1324.         Tests when model and db_table changes, autodetector must create two
1325.         operations.
1326.         """
1327.         changes = self.get_changes(
1328.             [self.author_with_db_table_options],
1329.             [self.author_renamed_with_new_db_table_options],
1330.             MigrationQuestioner({"ask_rename_model": True}),
1331.         )
1332.         # Right number/type of migrations?
1333.         self.assertNumberMigrations(changes, 'testapp', 1)
1334.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1335.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1336.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1337. 
1338.     def test_identical_regex_doesnt_alter(self):
1339.         from_state = ModelState(
1340.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1341.                 RegexValidator(
1342.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1343.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1344.                     'invalid'
1345.                 )
1346.             ]))]
1347.         )
1348.         to_state = ModelState(
1349.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1350.         )
1351.         changes = self.get_changes([from_state], [to_state])
1352.         # Right number/type of migrations?
1353.         self.assertNumberMigrations(changes, "testapp", 0)
1354. 
1355.     def test_different_regex_does_alter(self):
1356.         from_state = ModelState(
1357.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1358.                 RegexValidator(
1359.                     re.compile('^[a-z]+\\Z', 32),
1360.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1361.                     'invalid'
1362.                 )
1363.             ]))]
1364.         )
1365.         to_state = ModelState(
1366.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1367.         )
1368.         changes = self.get_changes([from_state], [to_state])
1369.         self.assertNumberMigrations(changes, "testapp", 1)
1370.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1371. 
1372.     def test_empty_foo_together(self):
1373.         """
1374.         #23452 - Empty unique/index_together shouldn't generate a migration.
1375.         """
1376.         # Explicitly testing for not specified, since this is the case after
1377.         # a CreateModel operation w/o any definition on the original model
1378.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1379.         # Explicitly testing for None, since this was the issue in #23452 after
1380.         # an AlterFooTogether operation with e.g. () as value
1381.         model_state_none = ModelState("a", "model", [
1382.             ("id", models.AutoField(primary_key=True))
1383.         ], {
1384.             "index_together": None,
1385.             "unique_together": None,
1386.         })
1387.         # Explicitly testing for the empty set, since we now always have sets.
1388.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1389.         model_state_empty = ModelState("a", "model", [
1390.             ("id", models.AutoField(primary_key=True))
1391.         ], {
1392.             "index_together": set(),
1393.             "unique_together": set(),
1394.         })
1395. 
1396.         def test(from_state, to_state, msg):
1397.             changes = self.get_changes([from_state], [to_state])
1398.             if changes:
1399.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1400.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1401. 
1402.         tests = (
1403.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1404.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1405.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1406.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1407.             (model_state_none, model_state_none, '"None" to "None"'),
1408.             (model_state_none, model_state_empty, '"None" to "empty"'),
1409.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1410.             (model_state_empty, model_state_none, '"empty" to "None"'),
1411.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1412.         )
1413. 
1414.         for t in tests:
1415.             test(*t)
1416. 
1417.     def test_create_model_with_indexes(self):
1418.         """Test creation of new model with indexes already defined."""
1419.         author = ModelState('otherapp', 'Author', [
1420.             ('id', models.AutoField(primary_key=True)),
1421.             ('name', models.CharField(max_length=200)),
1422.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1423.         changes = self.get_changes([], [author])
1424.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1425.         # Right number of migrations?
1426.         self.assertEqual(len(changes['otherapp']), 1)
1427.         # Right number of actions?
1428.         migration = changes['otherapp'][0]
1429.         self.assertEqual(len(migration.operations), 2)
1430.         # Right actions order?
1431.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1432.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1433.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1434. 
1435.     def test_add_indexes(self):
1436.         """Test change detection of new indexes."""
1437.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1438.         self.assertNumberMigrations(changes, 'otherapp', 1)
1439.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1440.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1441.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1442. 
1443.     def test_remove_indexes(self):
1444.         """Test change detection of removed indexes."""
1445.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1446.         # Right number/type of migrations?
1447.         self.assertNumberMigrations(changes, 'otherapp', 1)
1448.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1449.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1450. 
1451.     def test_order_fields_indexes(self):
1452.         """Test change detection of reordering of fields in indexes."""
1453.         changes = self.get_changes(
1454.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1455.         )
1456.         self.assertNumberMigrations(changes, 'otherapp', 1)
1457.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1458.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1459.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1460.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1461. 
1462.     def test_create_model_with_check_constraint(self):
1463.         """Test creation of new model with constraints already defined."""
1464.         author = ModelState('otherapp', 'Author', [
1465.             ('id', models.AutoField(primary_key=True)),
1466.             ('name', models.CharField(max_length=200)),
1467.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1468.         changes = self.get_changes([], [author])
1469.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1470.         # Right number of migrations?
1471.         self.assertEqual(len(changes['otherapp']), 1)
1472.         # Right number of actions?
1473.         migration = changes['otherapp'][0]
1474.         self.assertEqual(len(migration.operations), 2)
1475.         # Right actions order?
1476.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1477.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1478.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1479. 
1480.     def test_add_constraints(self):
1481.         """Test change detection of new constraints."""
1482.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1483.         self.assertNumberMigrations(changes, 'testapp', 1)
1484.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1485.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1486.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1487. 
1488.     def test_remove_constraints(self):
1489.         """Test change detection of removed constraints."""
1490.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1491.         # Right number/type of migrations?
1492.         self.assertNumberMigrations(changes, 'testapp', 1)
1493.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1494.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1495. 
1496.     def test_add_foo_together(self):
1497.         """Tests index/unique_together detection."""
1498.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1499.         # Right number/type of migrations?
1500.         self.assertNumberMigrations(changes, "otherapp", 1)
1501.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1502.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1503.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1504. 
1505.     def test_remove_foo_together(self):
1506.         """Tests index/unique_together detection."""
1507.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1508.         # Right number/type of migrations?
1509.         self.assertNumberMigrations(changes, "otherapp", 1)
1510.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1511.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1512.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1513. 
1514.     def test_foo_together_remove_fk(self):
1515.         """Tests unique_together and field removal detection & ordering"""
1516.         changes = self.get_changes(
1517.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1518.         )
1519.         # Right number/type of migrations?
1520.         self.assertNumberMigrations(changes, "otherapp", 1)
1521.         self.assertOperationTypes(changes, "otherapp", 0, [
1522.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1523.         ])
1524.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1525.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1526.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1527. 
1528.     def test_foo_together_no_changes(self):
1529.         """
1530.         index/unique_together doesn't generate a migration if no
1531.         changes have been made.
1532.         """
1533.         changes = self.get_changes(
1534.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1535.         )
1536.         # Right number of migrations?
1537.         self.assertEqual(len(changes), 0)
1538. 
1539.     def test_foo_together_ordering(self):
1540.         """
1541.         index/unique_together also triggers on ordering changes.
1542.         """
1543.         changes = self.get_changes(
1544.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1545.         )
1546.         # Right number/type of migrations?
1547.         self.assertNumberMigrations(changes, "otherapp", 1)
1548.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1549.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1550.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1551. 
1552.     def test_add_field_and_foo_together(self):
1553.         """
1554.         Added fields will be created before using them in index/unique_together.
1555.         """
1556.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1557.         # Right number/type of migrations?
1558.         self.assertNumberMigrations(changes, "otherapp", 1)
1559.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1560.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1561.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1562. 
1563.     def test_create_model_and_unique_together(self):
1564.         author = ModelState("otherapp", "Author", [
1565.             ("id", models.AutoField(primary_key=True)),
1566.             ("name", models.CharField(max_length=200)),
1567.         ])
1568.         book_with_author = ModelState("otherapp", "Book", [
1569.             ("id", models.AutoField(primary_key=True)),
1570.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1571.             ("title", models.CharField(max_length=200)),
1572.         ], {
1573.             "index_together": {("title", "author")},
1574.             "unique_together": {("title", "author")},
1575.         })
1576.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1577.         # Right number of migrations?
1578.         self.assertEqual(len(changes['otherapp']), 1)
1579.         # Right number of actions?
1580.         migration = changes['otherapp'][0]
1581.         self.assertEqual(len(migration.operations), 4)
1582.         # Right actions order?
1583.         self.assertOperationTypes(
1584.             changes, 'otherapp', 0,
1585.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1586.         )
1587. 
1588.     def test_remove_field_and_foo_together(self):
1589.         """
1590.         Removed fields will be removed after updating index/unique_together.
1591.         """
1592.         changes = self.get_changes(
1593.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1594.         )
1595.         # Right number/type of migrations?
1596.         self.assertNumberMigrations(changes, "otherapp", 1)
1597.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1598.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1599.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1600.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1601. 
1602.     def test_rename_field_and_foo_together(self):
1603.         """
1604.         Removed fields will be removed after updating index/unique_together.
1605.         """
1606.         changes = self.get_changes(
1607.             [self.author_empty, self.book_foo_together_3],
1608.             [self.author_empty, self.book_foo_together_4],
1609.             MigrationQuestioner({"ask_rename": True}),
1610.         )
1611.         # Right number/type of migrations?
1612.         self.assertNumberMigrations(changes, "otherapp", 1)
1613.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1614.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1615.             ("title", "newfield2")
1616.         })
1617.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1618. 
1619.     def test_proxy(self):
1620.         """The autodetector correctly deals with proxy models."""
1621.         # First, we test adding a proxy model
1622.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1623.         # Right number/type of migrations?
1624.         self.assertNumberMigrations(changes, "testapp", 1)
1625.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1626.         self.assertOperationAttributes(
1627.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1628.         )
1629.         # Now, we test turning a proxy model into a non-proxy model
1630.         # It should delete the proxy then make the real one
1631.         changes = self.get_changes(
1632.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1633.         )
1634.         # Right number/type of migrations?
1635.         self.assertNumberMigrations(changes, "testapp", 1)
1636.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1637.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1638.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1639. 
1640.     def test_proxy_custom_pk(self):
1641.         """
1642.         #23415 - The autodetector must correctly deal with custom FK on proxy
1643.         models.
1644.         """
1645.         # First, we test the default pk field name
1646.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1647.         # The field name the FK on the book model points to
1648.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1649.         # Now, we test the custom pk field name
1650.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1651.         # The field name the FK on the book model points to
1652.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1653. 
1654.     def test_proxy_to_mti_with_fk_to_proxy(self):
1655.         # First, test the pk table and field name.
1656.         changes = self.get_changes(
1657.             [],
1658.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1659.         )
1660.         self.assertEqual(
1661.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1662.             'testapp_author',
1663.         )
1664.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1665. 
1666.         # Change AuthorProxy to use MTI.
1667.         changes = self.get_changes(
1668.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1669.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1670.         )
1671.         # Right number/type of migrations for the AuthorProxy model?
1672.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1673.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1674.         # Right number/type of migrations for the Book model with a FK to
1675.         # AuthorProxy?
1676.         self.assertNumberMigrations(changes, 'otherapp', 1)
1677.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1678.         # otherapp should depend on thirdapp.
1679.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1680.         # Now, test the pk table and field name.
1681.         self.assertEqual(
1682.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1683.             'thirdapp_authorproxy',
1684.         )
1685.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1686. 
1687.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1688.         # First, test the pk table and field name.
1689.         changes = self.get_changes(
1690.             [],
1691.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1692.         )
1693.         self.assertEqual(
1694.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1695.             'testapp_author',
1696.         )
1697.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1698. 
1699.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1700.         # a proxy of AuthorProxy.
1701.         changes = self.get_changes(
1702.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1703.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1704.         )
1705.         # Right number/type of migrations for the AuthorProxy model?
1706.         self.assertNumberMigrations(changes, 'testapp', 1)
1707.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1708.         # Right number/type of migrations for the Book model with a FK to
1709.         # AAuthorProxyProxy?
1710.         self.assertNumberMigrations(changes, 'otherapp', 1)
1711.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1712.         # otherapp should depend on testapp.
1713.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1714.         # Now, test the pk table and field name.
1715.         self.assertEqual(
1716.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1717.             'testapp_authorproxy',
1718.         )
1719.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1720. 
1721.     def test_unmanaged_create(self):
1722.         """The autodetector correctly deals with managed models."""
1723.         # First, we test adding an unmanaged model
1724.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1725.         # Right number/type of migrations?
1726.         self.assertNumberMigrations(changes, 'testapp', 1)
1727.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1728.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1729. 
1730.     def test_unmanaged_delete(self):
1731.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1732.         self.assertNumberMigrations(changes, 'testapp', 1)
1733.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1734. 
1735.     def test_unmanaged_to_managed(self):
1736.         # Now, we test turning an unmanaged model into a managed model
1737.         changes = self.get_changes(
1738.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1739.         )
1740.         # Right number/type of migrations?
1741.         self.assertNumberMigrations(changes, 'testapp', 1)
1742.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1743.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1744. 
1745.     def test_managed_to_unmanaged(self):
1746.         # Now, we turn managed to unmanaged.
1747.         changes = self.get_changes(
1748.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1749.         )
1750.         # Right number/type of migrations?
1751.         self.assertNumberMigrations(changes, 'testapp', 1)
1752.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1753.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1754. 
1755.     def test_unmanaged_custom_pk(self):
1756.         """
1757.         #23415 - The autodetector must correctly deal with custom FK on
1758.         unmanaged models.
1759.         """
1760.         # First, we test the default pk field name
1761.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1762.         # The field name the FK on the book model points to
1763.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1764.         # Now, we test the custom pk field name
1765.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1766.         # The field name the FK on the book model points to
1767.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1768. 
1769.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1770.     def test_swappable(self):
1771.         with isolate_lru_cache(apps.get_swappable_settings_name):
1772.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1773.         # Right number/type of migrations?
1774.         self.assertNumberMigrations(changes, 'testapp', 1)
1775.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1776.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1777.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1778. 
1779.     def test_swappable_changed(self):
1780.         with isolate_lru_cache(apps.get_swappable_settings_name):
1781.             before = self.make_project_state([self.custom_user, self.author_with_user])
1782.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1783.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1784.             autodetector = MigrationAutodetector(before, after)
1785.             changes = autodetector._detect_changes()
1786.         # Right number/type of migrations?
1787.         self.assertNumberMigrations(changes, 'testapp', 1)
1788.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1789.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1790.         fk_field = changes['testapp'][0].operations[0].field
1791.         to_model = '%s.%s' % (
1792.             fk_field.remote_field.model._meta.app_label,
1793.             fk_field.remote_field.model._meta.object_name,
1794.         )
1795.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1796. 
1797.     def test_add_field_with_default(self):
1798.         """#22030 - Adding a field with a default should work."""
1799.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1800.         # Right number/type of migrations?
1801.         self.assertNumberMigrations(changes, 'testapp', 1)
1802.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1803.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1804. 
1805.     def test_custom_deconstructible(self):
1806.         """
1807.         Two instances which deconstruct to the same value aren't considered a
1808.         change.
1809.         """
1810.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1811.         # Right number of migrations?
1812.         self.assertEqual(len(changes), 0)
1813. 
1814.     def test_deconstruct_field_kwarg(self):
1815.         """Field instances are handled correctly by nested deconstruction."""
1816.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1817.         self.assertEqual(changes, {})
1818. 
1819.     def test_deconstructible_list(self):
1820.         """Nested deconstruction descends into lists."""
1821.         # When lists contain items that deconstruct to identical values, those lists
1822.         # should be considered equal for the purpose of detecting state changes
1823.         # (even if the original items are unequal).
1824.         changes = self.get_changes(
1825.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1826.         )
1827.         self.assertEqual(changes, {})
1828.         # Legitimate differences within the deconstructed lists should be reported
1829.         # as a change
1830.         changes = self.get_changes(
1831.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1832.         )
1833.         self.assertEqual(len(changes), 1)
1834. 
1835.     def test_deconstructible_tuple(self):
1836.         """Nested deconstruction descends into tuples."""
1837.         # When tuples contain items that deconstruct to identical values, those tuples
1838.         # should be considered equal for the purpose of detecting state changes
1839.         # (even if the original items are unequal).
1840.         changes = self.get_changes(
1841.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1842.         )
1843.         self.assertEqual(changes, {})
1844.         # Legitimate differences within the deconstructed tuples should be reported
1845.         # as a change
1846.         changes = self.get_changes(
1847.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1848.         )
1849.         self.assertEqual(len(changes), 1)
1850. 
1851.     def test_deconstructible_dict(self):
1852.         """Nested deconstruction descends into dict values."""
1853.         # When dicts contain items whose values deconstruct to identical values,
1854.         # those dicts should be considered equal for the purpose of detecting
1855.         # state changes (even if the original values are unequal).
1856.         changes = self.get_changes(
1857.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1858.         )
1859.         self.assertEqual(changes, {})
1860.         # Legitimate differences within the deconstructed dicts should be reported
1861.         # as a change
1862.         changes = self.get_changes(
1863.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1864.         )
1865.         self.assertEqual(len(changes), 1)
1866. 
1867.     def test_nested_deconstructible_objects(self):
1868.         """
1869.         Nested deconstruction is applied recursively to the args/kwargs of
1870.         deconstructed objects.
1871.         """
1872.         # If the items within a deconstructed object's args/kwargs have the same
1873.         # deconstructed values - whether or not the items themselves are different
1874.         # instances - then the object as a whole is regarded as unchanged.
1875.         changes = self.get_changes(
1876.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1877.         )
1878.         self.assertEqual(changes, {})
1879.         # Differences that exist solely within the args list of a deconstructed object
1880.         # should be reported as changes
1881.         changes = self.get_changes(
1882.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1883.         )
1884.         self.assertEqual(len(changes), 1)
1885.         # Additional args should also be reported as a change
1886.         changes = self.get_changes(
1887.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1888.         )
1889.         self.assertEqual(len(changes), 1)
1890.         # Differences that exist solely within the kwargs dict of a deconstructed object
1891.         # should be reported as changes
1892.         changes = self.get_changes(
1893.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1894.         )
1895.         self.assertEqual(len(changes), 1)
1896.         # Additional kwargs should also be reported as a change
1897.         changes = self.get_changes(
1898.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1899.         )
1900.         self.assertEqual(len(changes), 1)
1901. 
1902.     def test_deconstruct_type(self):
1903.         """
1904.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1905.         by deep_deconstruct during serialization.
1906.         """
1907.         author = ModelState(
1908.             "testapp",
1909.             "Author",
1910.             [
1911.                 ("id", models.AutoField(primary_key=True)),
1912.                 ("name", models.CharField(
1913.                     max_length=200,
1914.                     # IntegerField intentionally not instantiated.
1915.                     default=models.IntegerField,
1916.                 ))
1917.             ],
1918.         )
1919.         changes = self.get_changes([], [author])
1920.         # Right number/type of migrations?
1921.         self.assertNumberMigrations(changes, 'testapp', 1)
1922.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1923. 
1924.     def test_replace_string_with_foreignkey(self):
1925.         """
1926.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1927.         work.
1928.         """
1929.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1930.         # Right number/type of migrations?
1931.         self.assertNumberMigrations(changes, 'testapp', 1)
1932.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1933.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1934.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1935.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1936. 
1937.     def test_foreign_key_removed_before_target_model(self):
1938.         """
1939.         Removing an FK and the model it targets in the same change must remove
1940.         the FK field before the model to maintain consistency.
1941.         """
1942.         changes = self.get_changes(
1943.             [self.author_with_publisher, self.publisher], [self.author_name]
1944.         )  # removes both the model and FK
1945.         # Right number/type of migrations?
1946.         self.assertNumberMigrations(changes, 'testapp', 1)
1947.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1948.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1949.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1950. 
1951.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1952.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1953.     def test_add_many_to_many(self, mocked_ask_method):
1954.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1955.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1956.         # Right number/type of migrations?
1957.         self.assertNumberMigrations(changes, 'testapp', 1)
1958.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1959.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1960. 
1961.     def test_alter_many_to_many(self):
1962.         changes = self.get_changes(
1963.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1964.         )
1965.         # Right number/type of migrations?
1966.         self.assertNumberMigrations(changes, 'testapp', 1)
1967.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1968.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1969. 
1970.     def test_create_with_through_model(self):
1971.         """
1972.         Adding a m2m with a through model and the models that use it should be
1973.         ordered correctly.
1974.         """
1975.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1976.         # Right number/type of migrations?
1977.         self.assertNumberMigrations(changes, "testapp", 1)
1978.         self.assertOperationTypes(changes, "testapp", 0, [
1979.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1980.         ])
1981.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1982.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1983.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1984.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1985. 
1986.     def test_many_to_many_removed_before_through_model(self):
1987.         """
1988.         Removing a ManyToManyField and the "through" model in the same change
1989.         must remove the field before the model to maintain consistency.
1990.         """
1991.         changes = self.get_changes(
1992.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1993.             [self.book_with_no_author, self.author_name],
1994.         )
1995.         # Remove both the through model and ManyToMany
1996.         # Right number/type of migrations?
1997.         self.assertNumberMigrations(changes, "otherapp", 1)
1998.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1999.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
2000.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
2001. 
2002.     def test_many_to_many_removed_before_through_model_2(self):
2003.         """
2004.         Removing a model that contains a ManyToManyField and the "through" model
2005.         in the same change must remove the field before the model to maintain
2006.         consistency.
2007.         """
2008.         changes = self.get_changes(
2009.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
2010.             [self.author_name],
2011.         )
2012.         # Remove both the through model and ManyToMany
2013.         # Right number/type of migrations?
2014.         self.assertNumberMigrations(changes, "otherapp", 1)
2015.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
2016.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
2017.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
2018.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
2019. 
2020.     def test_m2m_w_through_multistep_remove(self):
2021.         """
2022.         A model with a m2m field that specifies a "through" model cannot be
2023.         removed in the same migration as that through model as the schema will
2024.         pass through an inconsistent state. The autodetector should produce two
2025.         migrations to avoid this issue.
2026.         """
2027.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
2028.         # Right number/type of migrations?
2029.         self.assertNumberMigrations(changes, "testapp", 1)
2030.         self.assertOperationTypes(changes, "testapp", 0, [
2031.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
2032.         ])
2033.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
2034.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
2035.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
2036.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
2037. 
2038.     def test_concrete_field_changed_to_many_to_many(self):
2039.         """
2040.         #23938 - Changing a concrete field into a ManyToManyField
2041.         first removes the concrete field and then adds the m2m field.
2042.         """
2043.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
2044.         # Right number/type of migrations?
2045.         self.assertNumberMigrations(changes, "testapp", 1)
2046.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
2047.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
2048.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2049.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
2050. 
2051.     def test_many_to_many_changed_to_concrete_field(self):
2052.         """
2053.         #23938 - Changing a ManyToManyField into a concrete field
2054.         first removes the m2m field and then adds the concrete field.
2055.         """
2056.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
2057.         # Right number/type of migrations?
2058.         self.assertNumberMigrations(changes, "testapp", 1)
2059.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
2060.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
2061.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2062.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
2063.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
2064. 
2065.     def test_non_circular_foreignkey_dependency_removal(self):
2066.         """
2067.         If two models with a ForeignKey from one to the other are removed at the
2068.         same time, the autodetector should remove them in the correct order.
2069.         """
2070.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2071.         # Right number/type of migrations?
2072.         self.assertNumberMigrations(changes, "testapp", 1)
2073.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2074.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2075.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2076.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2077. 
2078.     def test_alter_model_options(self):
2079.         """Changing a model's options should make a change."""
2080.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, "testapp", 1)
2083.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2084.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2085.             "permissions": [('can_hire', 'Can hire')],
2086.             "verbose_name": "Authi",
2087.         })
2088. 
2089.         # Changing them back to empty should also make a change
2090.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2091.         # Right number/type of migrations?
2092.         self.assertNumberMigrations(changes, "testapp", 1)
2093.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2094.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2095. 
2096.     def test_alter_model_options_proxy(self):
2097.         """Changing a proxy model's options should also make a change."""
2098.         changes = self.get_changes(
2099.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2100.         )
2101.         # Right number/type of migrations?
2102.         self.assertNumberMigrations(changes, "testapp", 1)
2103.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2104.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2105.             "verbose_name": "Super Author"
2106.         })
2107. 
2108.     def test_set_alter_order_with_respect_to(self):
2109.         """Setting order_with_respect_to adds a field."""
2110.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2111.         # Right number/type of migrations?
2112.         self.assertNumberMigrations(changes, 'testapp', 1)
2113.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2114.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2115. 
2116.     def test_add_alter_order_with_respect_to(self):
2117.         """
2118.         Setting order_with_respect_to when adding the FK too does
2119.         things in the right order.
2120.         """
2121.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2122.         # Right number/type of migrations?
2123.         self.assertNumberMigrations(changes, 'testapp', 1)
2124.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2125.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2126.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2127. 
2128.     def test_remove_alter_order_with_respect_to(self):
2129.         """
2130.         Removing order_with_respect_to when removing the FK too does
2131.         things in the right order.
2132.         """
2133.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2134.         # Right number/type of migrations?
2135.         self.assertNumberMigrations(changes, 'testapp', 1)
2136.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2137.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2138.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2139. 
2140.     def test_add_model_order_with_respect_to(self):
2141.         """
2142.         Setting order_with_respect_to when adding the whole model
2143.         does things in the right order.
2144.         """
2145.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2146.         # Right number/type of migrations?
2147.         self.assertNumberMigrations(changes, 'testapp', 1)
2148.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2149.         self.assertOperationAttributes(
2150.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2151.         )
2152.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2153. 
2154.     def test_alter_model_managers(self):
2155.         """
2156.         Changing the model managers adds a new operation.
2157.         """
2158.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2159.         # Right number/type of migrations?
2160.         self.assertNumberMigrations(changes, 'otherapp', 1)
2161.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2162.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2163.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2164.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2165.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2166.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2167. 
2168.     def test_swappable_first_inheritance(self):
2169.         """Swappable models get their CreateModel first."""
2170.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2171.         # Right number/type of migrations?
2172.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2173.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2174.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2175.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2176. 
2177.     def test_default_related_name_option(self):
2178.         model_state = ModelState('app', 'model', [
2179.             ('id', models.AutoField(primary_key=True)),
2180.         ], options={'default_related_name': 'related_name'})
2181.         changes = self.get_changes([], [model_state])
2182.         self.assertNumberMigrations(changes, 'app', 1)
2183.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2184.         self.assertOperationAttributes(
2185.             changes, 'app', 0, 0, name='model',
2186.             options={'default_related_name': 'related_name'},
2187.         )
2188.         altered_model_state = ModelState('app', 'Model', [
2189.             ('id', models.AutoField(primary_key=True)),
2190.         ])
2191.         changes = self.get_changes([model_state], [altered_model_state])
2192.         self.assertNumberMigrations(changes, 'app', 1)
2193.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2194.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2195. 
2196.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2197.     def test_swappable_first_setting(self):
2198.         """Swappable models get their CreateModel first."""
2199.         with isolate_lru_cache(apps.get_swappable_settings_name):
2200.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2201.         # Right number/type of migrations?
2202.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2203.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2204.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2205.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2206. 
2207.     def test_bases_first(self):
2208.         """Bases of other models come first."""
2209.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2210.         # Right number/type of migrations?
2211.         self.assertNumberMigrations(changes, 'testapp', 1)
2212.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2213.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2214.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2215. 
2216.     def test_multiple_bases(self):
2217.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2218.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2219.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2220.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2221.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2222.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2223.         changes = self.get_changes([], [A, B, C, D, E])
2224.         # Right number/type of migrations?
2225.         self.assertNumberMigrations(changes, "app", 1)
2226.         self.assertOperationTypes(changes, "app", 0, [
2227.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2228.         ])
2229.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2230.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2231.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2232.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2233.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2234. 
2235.     def test_proxy_bases_first(self):
2236.         """Bases of proxies come first."""
2237.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2238.         # Right number/type of migrations?
2239.         self.assertNumberMigrations(changes, 'testapp', 1)
2240.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2241.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2242.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2243.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2244. 
2245.     def test_pk_fk_included(self):
2246.         """
2247.         A relation used as the primary key is kept as part of CreateModel.
2248.         """
2249.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2250.         # Right number/type of migrations?
2251.         self.assertNumberMigrations(changes, 'testapp', 1)
2252.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2253.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2254.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2255. 
2256.     def test_first_dependency(self):
2257.         """
2258.         A dependency to an app with no migrations uses __first__.
2259.         """
2260.         # Load graph
2261.         loader = MigrationLoader(connection)
2262.         before = self.make_project_state([])
2263.         after = self.make_project_state([self.book_migrations_fk])
2264.         after.real_apps = ["migrations"]
2265.         autodetector = MigrationAutodetector(before, after)
2266.         changes = autodetector._detect_changes(graph=loader.graph)
2267.         # Right number/type of migrations?
2268.         self.assertNumberMigrations(changes, 'otherapp', 1)
2269.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2270.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2271.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2272. 
2273.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2274.     def test_last_dependency(self):
2275.         """
2276.         A dependency to an app with existing migrations uses the
2277.         last migration of that app.
2278.         """
2279.         # Load graph
2280.         loader = MigrationLoader(connection)
2281.         before = self.make_project_state([])
2282.         after = self.make_project_state([self.book_migrations_fk])
2283.         after.real_apps = ["migrations"]
2284.         autodetector = MigrationAutodetector(before, after)
2285.         changes = autodetector._detect_changes(graph=loader.graph)
2286.         # Right number/type of migrations?
2287.         self.assertNumberMigrations(changes, 'otherapp', 1)
2288.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2289.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2290.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2291. 
2292.     def test_alter_fk_before_model_deletion(self):
2293.         """
2294.         ForeignKeys are altered _before_ the model they used to
2295.         refer to are deleted.
2296.         """
2297.         changes = self.get_changes(
2298.             [self.author_name, self.publisher_with_author],
2299.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2300.         )
2301.         # Right number/type of migrations?
2302.         self.assertNumberMigrations(changes, 'testapp', 1)
2303.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2304.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2305.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2306.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2307. 
2308.     def test_fk_dependency_other_app(self):
2309.         """
2310.         #23100 - ForeignKeys correctly depend on other apps' models.
2311.         """
2312.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2313.         # Right number/type of migrations?
2314.         self.assertNumberMigrations(changes, 'testapp', 1)
2315.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2316.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2317.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2318. 
2319.     def test_alter_field_to_fk_dependency_other_app(self):
2320.         changes = self.get_changes(
2321.             [self.author_empty, self.book_with_no_author_fk],
2322.             [self.author_empty, self.book],
2323.         )
2324.         self.assertNumberMigrations(changes, 'otherapp', 1)
2325.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
2326.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', '__first__')])
2327. 
2328.     def test_circular_dependency_mixed_addcreate(self):
2329.         """
2330.         #23315 - The dependency resolver knows to put all CreateModel
2331.         before AddField and not become unsolvable.
2332.         """
2333.         address = ModelState("a", "Address", [
2334.             ("id", models.AutoField(primary_key=True)),
2335.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2336.         ])
2337.         person = ModelState("a", "Person", [
2338.             ("id", models.AutoField(primary_key=True)),
2339.         ])
2340.         apackage = ModelState("b", "APackage", [
2341.             ("id", models.AutoField(primary_key=True)),
2342.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2343.         ])
2344.         country = ModelState("b", "DeliveryCountry", [
2345.             ("id", models.AutoField(primary_key=True)),
2346.         ])
2347.         changes = self.get_changes([], [address, person, apackage, country])
2348.         # Right number/type of migrations?
2349.         self.assertNumberMigrations(changes, 'a', 2)
2350.         self.assertNumberMigrations(changes, 'b', 1)
2351.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2352.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2353.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2354. 
2355.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2356.     def test_circular_dependency_swappable(self):
2357.         """
2358.         #23322 - The dependency resolver knows to explicitly resolve
2359.         swappable models.
2360.         """
2361.         with isolate_lru_cache(apps.get_swappable_settings_name):
2362.             tenant = ModelState("a", "Tenant", [
2363.                 ("id", models.AutoField(primary_key=True)),
2364.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2365.                 bases=(AbstractBaseUser,)
2366.             )
2367.             address = ModelState("b", "Address", [
2368.                 ("id", models.AutoField(primary_key=True)),
2369.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2370.             ])
2371.             changes = self.get_changes([], [address, tenant])
2372. 
2373.         # Right number/type of migrations?
2374.         self.assertNumberMigrations(changes, 'a', 2)
2375.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2376.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2377.         self.assertMigrationDependencies(changes, 'a', 0, [])
2378.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2379.         # Right number/type of migrations?
2380.         self.assertNumberMigrations(changes, 'b', 1)
2381.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2382.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2383. 
2384.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2385.     def test_circular_dependency_swappable2(self):
2386.         """
2387.         #23322 - The dependency resolver knows to explicitly resolve
2388.         swappable models but with the swappable not being the first migrated
2389.         model.
2390.         """
2391.         with isolate_lru_cache(apps.get_swappable_settings_name):
2392.             address = ModelState("a", "Address", [
2393.                 ("id", models.AutoField(primary_key=True)),
2394.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2395.             ])
2396.             tenant = ModelState("b", "Tenant", [
2397.                 ("id", models.AutoField(primary_key=True)),
2398.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2399.                 bases=(AbstractBaseUser,)
2400.             )
2401.             changes = self.get_changes([], [address, tenant])
2402.         # Right number/type of migrations?
2403.         self.assertNumberMigrations(changes, 'a', 2)
2404.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2405.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2406.         self.assertMigrationDependencies(changes, 'a', 0, [])
2407.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2408.         # Right number/type of migrations?
2409.         self.assertNumberMigrations(changes, 'b', 1)
2410.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2411.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2412. 
2413.     @override_settings(AUTH_USER_MODEL="a.Person")
2414.     def test_circular_dependency_swappable_self(self):
2415.         """
2416.         #23322 - The dependency resolver knows to explicitly resolve
2417.         swappable models.
2418.         """
2419.         with isolate_lru_cache(apps.get_swappable_settings_name):
2420.             person = ModelState("a", "Person", [
2421.                 ("id", models.AutoField(primary_key=True)),
2422.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2423.             ])
2424.             changes = self.get_changes([], [person])
2425.         # Right number/type of migrations?
2426.         self.assertNumberMigrations(changes, 'a', 1)
2427.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2428.         self.assertMigrationDependencies(changes, 'a', 0, [])
2429. 
2430.     @override_settings(AUTH_USER_MODEL='a.User')
2431.     def test_swappable_circular_multi_mti(self):
2432.         with isolate_lru_cache(apps.get_swappable_settings_name):
2433.             parent = ModelState('a', 'Parent', [
2434.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2435.             ])
2436.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2437.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2438.             changes = self.get_changes([], [parent, child, user])
2439.         self.assertNumberMigrations(changes, 'a', 1)
2440.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2441. 
2442.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2443.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2444.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2445.         """
2446.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2447.         without default should not prompt for a default.
2448.         """
2449.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2450.         # Right number/type of migrations?
2451.         self.assertNumberMigrations(changes, 'testapp', 1)
2452.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2453.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2454. 
2455.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2456.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2457.         """
2458.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2459.         without default should prompt for a default.
2460.         """
2461.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2462.         self.assertEqual(mocked_ask_method.call_count, 2)
2463.         # Right number/type of migrations?
2464.         self.assertNumberMigrations(changes, 'testapp', 1)
2465.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2466.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2467. 
2468.     def test_mti_inheritance_model_removal(self):
2469.         Animal = ModelState('app', 'Animal', [
2470.             ("id", models.AutoField(primary_key=True)),
2471.         ])
2472.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2473.         changes = self.get_changes([Animal, Dog], [Animal])
2474.         self.assertNumberMigrations(changes, 'app', 1)
2475.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2476.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')
2477. 
2478.     def test_add_model_with_field_removed_from_base_model(self):
2479.         """
2480.         Removing a base field takes place before adding a new inherited model
2481.         that has a field with the same name.
2482.         """
2483.         before = [
2484.             ModelState('app', 'readable', [
2485.                 ('id', models.AutoField(primary_key=True)),
2486.                 ('title', models.CharField(max_length=200)),
2487.             ]),
2488.         ]
2489.         after = [
2490.             ModelState('app', 'readable', [
2491.                 ('id', models.AutoField(primary_key=True)),
2492.             ]),
2493.             ModelState('app', 'book', [
2494.                 ('title', models.CharField(max_length=200)),
2495.             ], bases=('app.readable',)),
2496.         ]
2497.         changes = self.get_changes(before, after)
2498.         self.assertNumberMigrations(changes, 'app', 1)
2499.         self.assertOperationTypes(changes, 'app', 0, ['RemoveField', 'CreateModel'])
2500.         self.assertOperationAttributes(changes, 'app', 0, 0, name='title', model_name='readable')
2501.         self.assertOperationAttributes(changes, 'app', 0, 1, name='book')
2502. 
2503. 
2504. class MigrationSuggestNameTests(SimpleTestCase):
2505.     def test_single_operation(self):
2506.         class Migration(migrations.Migration):
2507.             operations = [migrations.CreateModel('Person', fields=[])]
2508. 
2509.         migration = Migration('0001_initial', 'test_app')
2510.         self.assertEqual(migration.suggest_name(), 'person')
2511. 
2512.         class Migration(migrations.Migration):
2513.             operations = [migrations.DeleteModel('Person')]
2514. 
2515.         migration = Migration('0002_initial', 'test_app')
2516.         self.assertEqual(migration.suggest_name(), 'delete_person')
2517. 
2518.     def test_two_create_models(self):
2519.         class Migration(migrations.Migration):
2520.             operations = [
2521.                 migrations.CreateModel('Person', fields=[]),
2522.                 migrations.CreateModel('Animal', fields=[]),
2523.             ]
2524. 
2525.         migration = Migration('0001_initial', 'test_app')
2526.         self.assertEqual(migration.suggest_name(), 'animal_person')
2527. 
2528.     def test_two_create_models_with_initial_true(self):
2529.         class Migration(migrations.Migration):
2530.             initial = True
2531.             operations = [
2532.                 migrations.CreateModel('Person', fields=[]),
2533.                 migrations.CreateModel('Animal', fields=[]),
2534.             ]
2535. 
2536.         migration = Migration('0001_initial', 'test_app')
2537.         self.assertEqual(migration.suggest_name(), 'animal_person')
2538. 
2539.     def test_none_name(self):
2540.         class Migration(migrations.Migration):
2541.             operations = [migrations.RunSQL('SELECT 1 FROM person;')]
2542. 
2543.         migration = Migration('0001_initial', 'test_app')
2544.         suggest_name = migration.suggest_name()
2545.         self.assertIs(suggest_name.startswith('auto_'), True)
2546. 
2547.     def test_none_name_with_initial_true(self):
2548.         class Migration(migrations.Migration):
2549.             initial = True
2550.             operations = [migrations.RunSQL('SELECT 1 FROM person;')]
2551. 
2552.         migration = Migration('0001_initial', 'test_app')
2553.         self.assertEqual(migration.suggest_name(), 'initial')
2554. 
2555.     def test_auto(self):
2556.         migration = migrations.Migration('0001_initial', 'test_app')
2557.         suggest_name = migration.suggest_name()
2558.         self.assertIs(suggest_name.startswith('auto_'), True)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 04:38:47,021 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The provided context from `tests/migrations/test_autodetector.py` is insufficient because it does not contain any tests using mixed-case application labels, which is the root cause of the reported bug. The bug occurs during the deconstruction of a `ForeignKey` field when its target model is in an app with a mixed-case name. Therefore, I need to inspect tests that specifically cover field deconstruction to find cases that handle this scenario.' query='Please provide the full content of `tests/field_deconstruction/tests.py`.' extra_requirements='If the file is too large, please at least include all tests related to `ForeignKey` deconstruction.' purpose='This file is expected to contain direct tests for the `deconstruct()` method of fields, which will help me find test cases relevant to the `ForeignKey` deconstruction issue with mixed-case app labels.'
2025-12-23 04:38:47,022 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/field_deconstruction/tests.py`.
2025-12-23 04:38:47,022 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 04:38:47,023 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 04:38:47,023 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 04:38:47,023 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/field_deconstruction/tests.py`.
Extra requirements: If the file is too large, please at least include all tests related to `ForeignKey` deconstruction.
Purpose: This file is expected to contain direct tests for the `deconstruct()` method of fields, which will help me find test cases relevant to the `ForeignKey` deconstruction issue with mixed-case app labels.
2025-12-23 04:38:49,781 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will first attempt to retrieve the entire content of `tests/field_deconstruction/tests.py`. If the file proves to be too large for a single read, I will then specifically search for and display all tests within that file that are related to the deconstruction of `ForeignKey`. This will ensure you receive the most relevant test cases for your issue.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/field_deconstruction/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2144, 'candidates_token_count': 97, 'total_token_count': 2338, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2144}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 97}], 'thoughts_token_count': 97, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09772371508411526, 'model_name': 'gemini-2.5-pro'} id='run--e36079a0-4ba5-4bd4-82ef-6bcc916debf8-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/field_deconstruction/tests.py'}, 'id': '40a2637e-2b5a-459c-9e58-afafd5f8469e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2144, 'output_tokens': 97, 'total_tokens': 2338, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 97}}
2025-12-23 04:38:52,145 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the initial 500 lines of `tests/field_deconstruction/tests.py`. I will now proceed to read the remainder of the file to ensure I have the complete content for your review.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1001.0, "start_line": 501.0, "relative_path": "tests/field_deconstruction/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11251, 'candidates_token_count': 76, 'total_token_count': 11373, 'cached_content_token_count': 1851, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11251}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1851}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 46}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15826074700606496, 'model_name': 'gemini-2.5-pro'} id='run--ff4fc315-ed33-4f35-b102-38709f08601c-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1001.0, 'start_line': 501.0, 'relative_path': 'tests/field_deconstruction/tests.py'}, 'id': '5f96d905-a227-4f1b-b7bb-bb28cd2d368f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11251, 'output_tokens': 76, 'total_tokens': 11373, 'input_token_details': {'cache_read': 1851}, 'output_token_details': {'reasoning': 46}}
2025-12-23 04:38:55,909 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of `tests/field_deconstruction/tests.py`. The file was read in two parts to ensure the full content was captured. I can now provide you with the complete source code of the file, which includes all the tests for field deconstruction, including those for `ForeignKey`.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11866, 'candidates_token_count': 65, 'total_token_count': 12191, 'cached_content_token_count': 11108, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11866}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11108}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 65}], 'thoughts_token_count': 260}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5408768873948318, 'model_name': 'gemini-2.5-pro'} id='run--0ec3b849-5b8e-4837-ae10-88c7ee0faca0-0' usage_metadata={'input_tokens': 11866, 'output_tokens': 65, 'total_tokens': 12191, 'input_token_details': {'cache_read': 11108}, 'output_token_details': {'reasoning': 260}}
2025-12-23 04:38:55,911 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/field_deconstruction/tests.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please at least include all tests related to `ForeignKey` deconstruction.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
This file is expected to contain direct tests for the `deconstruct()` method of fields, which will help me find test cases relevant to the `ForeignKey` deconstruction issue with mixed-case app labels.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/field_deconstruction/tests.py
Line number range: 1 - 500
Content:
1. from django.apps import apps
2. from django.db import models
3. from django.test import SimpleTestCase, override_settings
4. from django.test.utils import isolate_lru_cache
5. 
6. 
7. class FieldDeconstructionTests(SimpleTestCase):
8.     """
9.     Tests the deconstruct() method on all core fields.
10.     """
11. 
12.     def test_name(self):
13.         """
14.         Tests the outputting of the correct name if assigned one.
15.         """
16.         # First try using a "normal" field
17.         field = models.CharField(max_length=65)
18.         name, path, args, kwargs = field.deconstruct()
19.         self.assertIsNone(name)
20.         field.set_attributes_from_name("is_awesome_test")
21.         name, path, args, kwargs = field.deconstruct()
22.         self.assertEqual(name, "is_awesome_test")
23.         # Now try with a ForeignKey
24.         field = models.ForeignKey("some_fake.ModelName", models.CASCADE)
25.         name, path, args, kwargs = field.deconstruct()
26.         self.assertIsNone(name)
27.         field.set_attributes_from_name("author")
28.         name, path, args, kwargs = field.deconstruct()
29.         self.assertEqual(name, "author")
30. 
31.     def test_db_tablespace(self):
32.         field = models.Field()
33.         _, _, args, kwargs = field.deconstruct()
34.         self.assertEqual(args, [])
35.         self.assertEqual(kwargs, {})
36.         # With a DEFAULT_DB_TABLESPACE.
37.         with self.settings(DEFAULT_DB_TABLESPACE='foo'):
38.             _, _, args, kwargs = field.deconstruct()
39.         self.assertEqual(args, [])
40.         self.assertEqual(kwargs, {})
41.         # With a db_tablespace.
42.         field = models.Field(db_tablespace='foo')
43.         _, _, args, kwargs = field.deconstruct()
44.         self.assertEqual(args, [])
45.         self.assertEqual(kwargs, {'db_tablespace': 'foo'})
46.         # With a db_tablespace equal to DEFAULT_DB_TABLESPACE.
47.         with self.settings(DEFAULT_DB_TABLESPACE='foo'):
48.             _, _, args, kwargs = field.deconstruct()
49.         self.assertEqual(args, [])
50.         self.assertEqual(kwargs, {'db_tablespace': 'foo'})
51. 
52.     def test_auto_field(self):
53.         field = models.AutoField(primary_key=True)
54.         field.set_attributes_from_name("id")
55.         name, path, args, kwargs = field.deconstruct()
56.         self.assertEqual(path, "django.db.models.AutoField")
57.         self.assertEqual(args, [])
58.         self.assertEqual(kwargs, {"primary_key": True})
59. 
60.     def test_big_integer_field(self):
61.         field = models.BigIntegerField()
62.         name, path, args, kwargs = field.deconstruct()
63.         self.assertEqual(path, "django.db.models.BigIntegerField")
64.         self.assertEqual(args, [])
65.         self.assertEqual(kwargs, {})
66. 
67.     def test_boolean_field(self):
68.         field = models.BooleanField()
69.         name, path, args, kwargs = field.deconstruct()
70.         self.assertEqual(path, "django.db.models.BooleanField")
71.         self.assertEqual(args, [])
72.         self.assertEqual(kwargs, {})
73.         field = models.BooleanField(default=True)
74.         name, path, args, kwargs = field.deconstruct()
75.         self.assertEqual(path, "django.db.models.BooleanField")
76.         self.assertEqual(args, [])
77.         self.assertEqual(kwargs, {"default": True})
78. 
79.     def test_char_field(self):
80.         field = models.CharField(max_length=65)
81.         name, path, args, kwargs = field.deconstruct()
82.         self.assertEqual(path, "django.db.models.CharField")
83.         self.assertEqual(args, [])
84.         self.assertEqual(kwargs, {"max_length": 65})
85.         field = models.CharField(max_length=65, null=True, blank=True)
86.         name, path, args, kwargs = field.deconstruct()
87.         self.assertEqual(path, "django.db.models.CharField")
88.         self.assertEqual(args, [])
89.         self.assertEqual(kwargs, {"max_length": 65, "null": True, "blank": True})
90. 
91.     def test_char_field_choices(self):
92.         field = models.CharField(max_length=1, choices=(("A", "One"), ("B", "Two")))
93.         name, path, args, kwargs = field.deconstruct()
94.         self.assertEqual(path, "django.db.models.CharField")
95.         self.assertEqual(args, [])
96.         self.assertEqual(kwargs, {"choices": [("A", "One"), ("B", "Two")], "max_length": 1})
97. 
98.     def test_csi_field(self):
99.         field = models.CommaSeparatedIntegerField(max_length=100)
100.         name, path, args, kwargs = field.deconstruct()
101.         self.assertEqual(path, "django.db.models.CommaSeparatedIntegerField")
102.         self.assertEqual(args, [])
103.         self.assertEqual(kwargs, {"max_length": 100})
104. 
105.     def test_date_field(self):
106.         field = models.DateField()
107.         name, path, args, kwargs = field.deconstruct()
108.         self.assertEqual(path, "django.db.models.DateField")
109.         self.assertEqual(args, [])
110.         self.assertEqual(kwargs, {})
111.         field = models.DateField(auto_now=True)
112.         name, path, args, kwargs = field.deconstruct()
113.         self.assertEqual(path, "django.db.models.DateField")
114.         self.assertEqual(args, [])
115.         self.assertEqual(kwargs, {"auto_now": True})
116. 
117.     def test_datetime_field(self):
118.         field = models.DateTimeField()
119.         name, path, args, kwargs = field.deconstruct()
120.         self.assertEqual(path, "django.db.models.DateTimeField")
121.         self.assertEqual(args, [])
122.         self.assertEqual(kwargs, {})
123.         field = models.DateTimeField(auto_now_add=True)
124.         name, path, args, kwargs = field.deconstruct()
125.         self.assertEqual(path, "django.db.models.DateTimeField")
126.         self.assertEqual(args, [])
127.         self.assertEqual(kwargs, {"auto_now_add": True})
128.         # Bug #21785
129.         field = models.DateTimeField(auto_now=True, auto_now_add=True)
130.         name, path, args, kwargs = field.deconstruct()
131.         self.assertEqual(path, "django.db.models.DateTimeField")
132.         self.assertEqual(args, [])
133.         self.assertEqual(kwargs, {"auto_now_add": True, "auto_now": True})
134. 
135.     def test_decimal_field(self):
136.         field = models.DecimalField(max_digits=5, decimal_places=2)
137.         name, path, args, kwargs = field.deconstruct()
138.         self.assertEqual(path, "django.db.models.DecimalField")
139.         self.assertEqual(args, [])
140.         self.assertEqual(kwargs, {"max_digits": 5, "decimal_places": 2})
141. 
142.     def test_decimal_field_0_decimal_places(self):
143.         """
144.         A DecimalField with decimal_places=0 should work (#22272).
145.         """
146.         field = models.DecimalField(max_digits=5, decimal_places=0)
147.         name, path, args, kwargs = field.deconstruct()
148.         self.assertEqual(path, "django.db.models.DecimalField")
149.         self.assertEqual(args, [])
150.         self.assertEqual(kwargs, {"max_digits": 5, "decimal_places": 0})
151. 
152.     def test_email_field(self):
153.         field = models.EmailField()
154.         name, path, args, kwargs = field.deconstruct()
155.         self.assertEqual(path, "django.db.models.EmailField")
156.         self.assertEqual(args, [])
157.         self.assertEqual(kwargs, {"max_length": 254})
158.         field = models.EmailField(max_length=255)
159.         name, path, args, kwargs = field.deconstruct()
160.         self.assertEqual(path, "django.db.models.EmailField")
161.         self.assertEqual(args, [])
162.         self.assertEqual(kwargs, {"max_length": 255})
163. 
164.     def test_file_field(self):
165.         field = models.FileField(upload_to="foo/bar")
166.         name, path, args, kwargs = field.deconstruct()
167.         self.assertEqual(path, "django.db.models.FileField")
168.         self.assertEqual(args, [])
169.         self.assertEqual(kwargs, {"upload_to": "foo/bar"})
170.         # Test max_length
171.         field = models.FileField(upload_to="foo/bar", max_length=200)
172.         name, path, args, kwargs = field.deconstruct()
173.         self.assertEqual(path, "django.db.models.FileField")
174.         self.assertEqual(args, [])
175.         self.assertEqual(kwargs, {"upload_to": "foo/bar", "max_length": 200})
176. 
177.     def test_file_path_field(self):
178.         field = models.FilePathField(match=r".*\.txt$")
179.         name, path, args, kwargs = field.deconstruct()
180.         self.assertEqual(path, "django.db.models.FilePathField")
181.         self.assertEqual(args, [])
182.         self.assertEqual(kwargs, {"match": r".*\.txt$"})
183.         field = models.FilePathField(recursive=True, allow_folders=True, max_length=123)
184.         name, path, args, kwargs = field.deconstruct()
185.         self.assertEqual(path, "django.db.models.FilePathField")
186.         self.assertEqual(args, [])
187.         self.assertEqual(kwargs, {"recursive": True, "allow_folders": True, "max_length": 123})
188. 
189.     def test_float_field(self):
190.         field = models.FloatField()
191.         name, path, args, kwargs = field.deconstruct()
192.         self.assertEqual(path, "django.db.models.FloatField")
193.         self.assertEqual(args, [])
194.         self.assertEqual(kwargs, {})
195. 
196.     def test_foreign_key(self):
197.         # Test basic pointing
198.         from django.contrib.auth.models import Permission
199.         field = models.ForeignKey("auth.Permission", models.CASCADE)
200.         field.remote_field.model = Permission
201.         field.remote_field.field_name = "id"
202.         name, path, args, kwargs = field.deconstruct()
203.         self.assertEqual(path, "django.db.models.ForeignKey")
204.         self.assertEqual(args, [])
205.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
206.         self.assertFalse(hasattr(kwargs['to'], "setting_name"))
207.         # Test swap detection for swappable model
208.         field = models.ForeignKey("auth.User", models.CASCADE)
209.         name, path, args, kwargs = field.deconstruct()
210.         self.assertEqual(path, "django.db.models.ForeignKey")
211.         self.assertEqual(args, [])
212.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.CASCADE})
213.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
214.         # Test nonexistent (for now) model
215.         field = models.ForeignKey("something.Else", models.CASCADE)
216.         name, path, args, kwargs = field.deconstruct()
217.         self.assertEqual(path, "django.db.models.ForeignKey")
218.         self.assertEqual(args, [])
219.         self.assertEqual(kwargs, {"to": "something.else", "on_delete": models.CASCADE})
220.         # Test on_delete
221.         field = models.ForeignKey("auth.User", models.SET_NULL)
222.         name, path, args, kwargs = field.deconstruct()
223.         self.assertEqual(path, "django.db.models.ForeignKey")
224.         self.assertEqual(args, [])
225.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.SET_NULL})
226.         # Test to_field preservation
227.         field = models.ForeignKey("auth.Permission", models.CASCADE, to_field="foobar")
228.         name, path, args, kwargs = field.deconstruct()
229.         self.assertEqual(path, "django.db.models.ForeignKey")
230.         self.assertEqual(args, [])
231.         self.assertEqual(kwargs, {"to": "auth.permission", "to_field": "foobar", "on_delete": models.CASCADE})
232.         # Test related_name preservation
233.         field = models.ForeignKey("auth.Permission", models.CASCADE, related_name="foobar")
234.         name, path, args, kwargs = field.deconstruct()
235.         self.assertEqual(path, "django.db.models.ForeignKey")
236.         self.assertEqual(args, [])
237.         self.assertEqual(kwargs, {"to": "auth.permission", "related_name": "foobar", "on_delete": models.CASCADE})
238.         # Test related_query_name
239.         field = models.ForeignKey("auth.Permission", models.CASCADE, related_query_name="foobar")
240.         name, path, args, kwargs = field.deconstruct()
241.         self.assertEqual(path, "django.db.models.ForeignKey")
242.         self.assertEqual(args, [])
243.         self.assertEqual(
244.             kwargs,
245.             {"to": "auth.permission", "related_query_name": "foobar", "on_delete": models.CASCADE}
246.         )
247.         # Test limit_choices_to
248.         field = models.ForeignKey("auth.Permission", models.CASCADE, limit_choices_to={'foo': 'bar'})
249.         name, path, args, kwargs = field.deconstruct()
250.         self.assertEqual(path, "django.db.models.ForeignKey")
251.         self.assertEqual(args, [])
252.         self.assertEqual(
253.             kwargs,
254.             {"to": "auth.permission", "limit_choices_to": {'foo': 'bar'}, "on_delete": models.CASCADE}
255.         )
256.         # Test unique
257.         field = models.ForeignKey("auth.Permission", models.CASCADE, unique=True)
258.         name, path, args, kwargs = field.deconstruct()
259.         self.assertEqual(path, "django.db.models.ForeignKey")
260.         self.assertEqual(args, [])
261.         self.assertEqual(kwargs, {"to": "auth.permission", "unique": True, "on_delete": models.CASCADE})
262. 
263.     @override_settings(AUTH_USER_MODEL="auth.Permission")
264.     def test_foreign_key_swapped(self):
265.         with isolate_lru_cache(apps.get_swappable_settings_name):
266.             # It doesn't matter that we swapped out user for permission;
267.             # there's no validation. We just want to check the setting stuff works.
268.             field = models.ForeignKey("auth.Permission", models.CASCADE)
269.             name, path, args, kwargs = field.deconstruct()
270. 
271.         self.assertEqual(path, "django.db.models.ForeignKey")
272.         self.assertEqual(args, [])
273.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
274.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
275. 
276.     def test_one_to_one(self):
277.         # Test basic pointing
278.         from django.contrib.auth.models import Permission
279.         field = models.OneToOneField("auth.Permission", models.CASCADE)
280.         field.remote_field.model = Permission
281.         field.remote_field.field_name = "id"
282.         name, path, args, kwargs = field.deconstruct()
283.         self.assertEqual(path, "django.db.models.OneToOneField")
284.         self.assertEqual(args, [])
285.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
286.         self.assertFalse(hasattr(kwargs['to'], "setting_name"))
287.         # Test swap detection for swappable model
288.         field = models.OneToOneField("auth.User", models.CASCADE)
289.         name, path, args, kwargs = field.deconstruct()
290.         self.assertEqual(path, "django.db.models.OneToOneField")
291.         self.assertEqual(args, [])
292.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.CASCADE})
293.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
294.         # Test nonexistent (for now) model
295.         field = models.OneToOneField("something.Else", models.CASCADE)
296.         name, path, args, kwargs = field.deconstruct()
297.         self.assertEqual(path, "django.db.models.OneToOneField")
298.         self.assertEqual(args, [])
299.         self.assertEqual(kwargs, {"to": "something.else", "on_delete": models.CASCADE})
300.         # Test on_delete
301.         field = models.OneToOneField("auth.User", models.SET_NULL)
302.         name, path, args, kwargs = field.deconstruct()
303.         self.assertEqual(path, "django.db.models.OneToOneField")
304.         self.assertEqual(args, [])
305.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.SET_NULL})
306.         # Test to_field
307.         field = models.OneToOneField("auth.Permission", models.CASCADE, to_field="foobar")
308.         name, path, args, kwargs = field.deconstruct()
309.         self.assertEqual(path, "django.db.models.OneToOneField")
310.         self.assertEqual(args, [])
311.         self.assertEqual(kwargs, {"to": "auth.permission", "to_field": "foobar", "on_delete": models.CASCADE})
312.         # Test related_name
313.         field = models.OneToOneField("auth.Permission", models.CASCADE, related_name="foobar")
314.         name, path, args, kwargs = field.deconstruct()
315.         self.assertEqual(path, "django.db.models.OneToOneField")
316.         self.assertEqual(args, [])
317.         self.assertEqual(kwargs, {"to": "auth.permission", "related_name": "foobar", "on_delete": models.CASCADE})
318.         # Test related_query_name
319.         field = models.OneToOneField("auth.Permission", models.CASCADE, related_query_name="foobar")
320.         name, path, args, kwargs = field.deconstruct()
321.         self.assertEqual(path, "django.db.models.OneToOneField")
322.         self.assertEqual(args, [])
323.         self.assertEqual(
324.             kwargs,
325.             {"to": "auth.permission", "related_query_name": "foobar", "on_delete": models.CASCADE}
326.         )
327.         # Test limit_choices_to
328.         field = models.OneToOneField("auth.Permission", models.CASCADE, limit_choices_to={'foo': 'bar'})
329.         name, path, args, kwargs = field.deconstruct()
330.         self.assertEqual(path, "django.db.models.OneToOneField")
331.         self.assertEqual(args, [])
332.         self.assertEqual(
333.             kwargs,
334.             {"to": "auth.permission", "limit_choices_to": {'foo': 'bar'}, "on_delete": models.CASCADE}
335.         )
336.         # Test unique
337.         field = models.OneToOneField("auth.Permission", models.CASCADE, unique=True)
338.         name, path, args, kwargs = field.deconstruct()
339.         self.assertEqual(path, "django.db.models.OneToOneField")
340.         self.assertEqual(args, [])
341.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
342. 
343.     def test_image_field(self):
344.         field = models.ImageField(upload_to="foo/barness", width_field="width", height_field="height")
345.         name, path, args, kwargs = field.deconstruct()
346.         self.assertEqual(path, "django.db.models.ImageField")
347.         self.assertEqual(args, [])
348.         self.assertEqual(kwargs, {"upload_to": "foo/barness", "width_field": "width", "height_field": "height"})
349. 
350.     def test_integer_field(self):
351.         field = models.IntegerField()
352.         name, path, args, kwargs = field.deconstruct()
353.         self.assertEqual(path, "django.db.models.IntegerField")
354.         self.assertEqual(args, [])
355.         self.assertEqual(kwargs, {})
356. 
357.     def test_ip_address_field(self):
358.         field = models.IPAddressField()
359.         name, path, args, kwargs = field.deconstruct()
360.         self.assertEqual(path, "django.db.models.IPAddressField")
361.         self.assertEqual(args, [])
362.         self.assertEqual(kwargs, {})
363. 
364.     def test_generic_ip_address_field(self):
365.         field = models.GenericIPAddressField()
366.         name, path, args, kwargs = field.deconstruct()
367.         self.assertEqual(path, "django.db.models.GenericIPAddressField")
368.         self.assertEqual(args, [])
369.         self.assertEqual(kwargs, {})
370.         field = models.GenericIPAddressField(protocol="IPv6")
371.         name, path, args, kwargs = field.deconstruct()
372.         self.assertEqual(path, "django.db.models.GenericIPAddressField")
373.         self.assertEqual(args, [])
374.         self.assertEqual(kwargs, {"protocol": "IPv6"})
375. 
376.     def test_many_to_many_field(self):
377.         # Test normal
378.         field = models.ManyToManyField("auth.Permission")
379.         name, path, args, kwargs = field.deconstruct()
380.         self.assertEqual(path, "django.db.models.ManyToManyField")
381.         self.assertEqual(args, [])
382.         self.assertEqual(kwargs, {"to": "auth.Permission"})
383.         self.assertFalse(hasattr(kwargs['to'], "setting_name"))
384.         # Test swappable
385.         field = models.ManyToManyField("auth.User")
386.         name, path, args, kwargs = field.deconstruct()
387.         self.assertEqual(path, "django.db.models.ManyToManyField")
388.         self.assertEqual(args, [])
389.         self.assertEqual(kwargs, {"to": "auth.User"})
390.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
391.         # Test through
392.         field = models.ManyToManyField("auth.Permission", through="auth.Group")
393.         name, path, args, kwargs = field.deconstruct()
394.         self.assertEqual(path, "django.db.models.ManyToManyField")
395.         self.assertEqual(args, [])
396.         self.assertEqual(kwargs, {"to": "auth.Permission", "through": "auth.Group"})
397.         # Test custom db_table
398.         field = models.ManyToManyField("auth.Permission", db_table="custom_table")
399.         name, path, args, kwargs = field.deconstruct()
400.         self.assertEqual(path, "django.db.models.ManyToManyField")
401.         self.assertEqual(args, [])
402.         self.assertEqual(kwargs, {"to": "auth.Permission", "db_table": "custom_table"})
403.         # Test related_name
404.         field = models.ManyToManyField("auth.Permission", related_name="custom_table")
405.         name, path, args, kwargs = field.deconstruct()
406.         self.assertEqual(path, "django.db.models.ManyToManyField")
407.         self.assertEqual(args, [])
408.         self.assertEqual(kwargs, {"to": "auth.Permission", "related_name": "custom_table"})
409.         # Test related_query_name
410.         field = models.ManyToManyField("auth.Permission", related_query_name="foobar")
411.         name, path, args, kwargs = field.deconstruct()
412.         self.assertEqual(path, "django.db.models.ManyToManyField")
413.         self.assertEqual(args, [])
414.         self.assertEqual(kwargs, {"to": "auth.Permission", "related_query_name": "foobar"})
415.         # Test limit_choices_to
416.         field = models.ManyToManyField("auth.Permission", limit_choices_to={'foo': 'bar'})
417.         name, path, args, kwargs = field.deconstruct()
418.         self.assertEqual(path, "django.db.models.ManyToManyField")
419.         self.assertEqual(args, [])
420.         self.assertEqual(kwargs, {"to": "auth.Permission", "limit_choices_to": {'foo': 'bar'}})
421. 
422.     @override_settings(AUTH_USER_MODEL="auth.Permission")
423.     def test_many_to_many_field_swapped(self):
424.         with isolate_lru_cache(apps.get_swappable_settings_name):
425.             # It doesn't matter that we swapped out user for permission;
426.             # there's no validation. We just want to check the setting stuff works.
427.             field = models.ManyToManyField("auth.Permission")
428.             name, path, args, kwargs = field.deconstruct()
429. 
430.         self.assertEqual(path, "django.db.models.ManyToManyField")
431.         self.assertEqual(args, [])
432.         self.assertEqual(kwargs, {"to": "auth.Permission"})
433.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
434. 
435.     def test_null_boolean_field(self):
436.         field = models.NullBooleanField()
437.         name, path, args, kwargs = field.deconstruct()
438.         self.assertEqual(path, "django.db.models.NullBooleanField")
439.         self.assertEqual(args, [])
440.         self.assertEqual(kwargs, {})
441. 
442.     def test_positive_integer_field(self):
443.         field = models.PositiveIntegerField()
444.         name, path, args, kwargs = field.deconstruct()
445.         self.assertEqual(path, "django.db.models.PositiveIntegerField")
446.         self.assertEqual(args, [])
447.         self.assertEqual(kwargs, {})
448. 
449.     def test_positive_small_integer_field(self):
450.         field = models.PositiveSmallIntegerField()
451.         name, path, args, kwargs = field.deconstruct()
452.         self.assertEqual(path, "django.db.models.PositiveSmallIntegerField")
453.         self.assertEqual(args, [])
454.         self.assertEqual(kwargs, {})
455. 
456.     def test_positive_big_integer_field(self):
457.         field = models.PositiveBigIntegerField()
458.         name, path, args, kwargs = field.deconstruct()
459.         self.assertEqual(path, 'django.db.models.PositiveBigIntegerField')
460.         self.assertEqual(args, [])
461.         self.assertEqual(kwargs, {})
462. 
463.     def test_slug_field(self):
464.         field = models.SlugField()
465.         name, path, args, kwargs = field.deconstruct()
466.         self.assertEqual(path, "django.db.models.SlugField")
467.         self.assertEqual(args, [])
468.         self.assertEqual(kwargs, {})
469.         field = models.SlugField(db_index=False, max_length=231)
470.         name, path, args, kwargs = field.deconstruct()
471.         self.assertEqual(path, "django.db.models.SlugField")
472.         self.assertEqual(args, [])
473.         self.assertEqual(kwargs, {"db_index": False, "max_length": 231})
474. 
475.     def test_small_integer_field(self):
476.         field = models.SmallIntegerField()
477.         name, path, args, kwargs = field.deconstruct()
478.         self.assertEqual(path, "django.db.models.SmallIntegerField")
479.         self.assertEqual(args, [])
480.         self.assertEqual(kwargs, {})
481. 
482.     def test_text_field(self):
483.         field = models.TextField()
484.         name, path, args, kwargs = field.deconstruct()
485.         self.assertEqual(path, "django.db.models.TextField")
486.         self.assertEqual(args, [])
487.         self.assertEqual(kwargs, {})
488. 
489.     def test_time_field(self):
490.         field = models.TimeField()
491.         name, path, args, kwargs = field.deconstruct()
492.         self.assertEqual(path, "django.db.models.TimeField")
493.         self.assertEqual(args, [])
494.         self.assertEqual(kwargs, {})
495. 
496.         field = models.TimeField(auto_now=True)
497.         name, path, args, kwargs = field.deconstruct()
498.         self.assertEqual(args, [])
499.         self.assertEqual(kwargs, {'auto_now': True})
500.


File: tests/field_deconstruction/tests.py
Line number range: 501 - 1001
Content:
501.         field = models.TimeField(auto_now_add=True)
502.         name, path, args, kwargs = field.deconstruct()
503.         self.assertEqual(args, [])
504.         self.assertEqual(kwargs, {'auto_now_add': True})
505. 
506.     def test_url_field(self):
507.         field = models.URLField()
508.         name, path, args, kwargs = field.deconstruct()
509.         self.assertEqual(path, "django.db.models.URLField")
510.         self.assertEqual(args, [])
511.         self.assertEqual(kwargs, {})
512.         field = models.URLField(max_length=231)
513.         name, path, args, kwargs = field.deconstruct()
514.         self.assertEqual(path, "django.db.models.URLField")
515.         self.assertEqual(args, [])
516.         self.assertEqual(kwargs, {"max_length": 231})
517. 
518.     def test_binary_field(self):
519.         field = models.BinaryField()
520.         name, path, args, kwargs = field.deconstruct()
521.         self.assertEqual(path, "django.db.models.BinaryField")
522.         self.assertEqual(args, [])
523.         self.assertEqual(kwargs, {})
524.         field = models.BinaryField(editable=True)
525.         name, path, args, kwargs = field.deconstruct()
526.         self.assertEqual(args, [])
527.         self.assertEqual(kwargs, {'editable': True})

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 04:39:04,035 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user requested the full content of the file `tests/field_deconstruction/tests.py`. The provided context contains the entire file, and providing it in its entirety directly answers the user's request.", relative_path='tests/field_deconstruction/tests.py', start_line=1, end_line=527)]
2025-12-23 04:39:04,037 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `tests/field_deconstruction/tests.py`.
2025-12-23 04:39:04,037 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 04:39:04,037 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 04:39:04,038 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-23 04:39:04,038 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-23 04:39:04,039 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── FUNDING.yml
|   └── SECURITY.md
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       └── custom_widget.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json_deprecation.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── 27584_child.html
    |   |   ├── 27584_parent.html
    |   |   ├── 27956_child.html
    |   |   ├── 27956_parent.html
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── include_tpl.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   ├── password_change_form.html
    |   |   └── popup_response.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: makemigrations crashes for ForeignKey with mixed-case app name.

Description: Description
	
When i run "python3 manage.py migrate" on Django 3.1b1 shows me that error (Please, note that the code works well in 3.0)
ValueError: The field DJ_RegLogin.Content.category was declared with a lazy reference to 'dj_reglogin.category', but app 'dj_reglogin' isn't installed.
model.py (Conflict Part)
class Category(models.Model):
	title = models.CharField(max_length=100, db_index=True)
	slug = models.SlugField(max_length=100, db_index=True)
	class Meta:
		verbose_name = 'Category'
		verbose_name_plural = 'Categories'
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_category', None, kwargs={'slug': self.slug})
class Content(models.Model):
	title = models.CharField(max_length=100, unique=True)
	slug = models.SlugField(max_length=100, unique=True)
	body = RichTextField(config_name='default')
	posted = models.DateTimeField(db_index=True, auto_now_add=True)
	sites = models.ManyToManyField(Site)
	ip = models.GenericIPAddressField(editable=False)
	category = models.ForeignKey(Category, on_delete=models.CASCADE)
	user = models.ForeignKey(User, on_delete=models.CASCADE, null=False, blank=False, editable=False)
	status = models.CharField(max_length=10, choices=STATUS_CHOICES, default='draft')
	def __str__(self):
		return self.title
	def get_absolute_url(self):
		return reverse('view_blog_post', None, kwargs={'slug': self.slug})
settings.py (Related to issue part)
INSTALLED_APPS = [
	'DJ_RegLogin',
	'django.contrib.admin',
	'django.contrib.auth',
	'django.contrib.contenttypes',
	'django.contrib.sessions',
	'django.contrib.messages',
	'django.contrib.staticfiles',
	'social_django',
	'ckeditor',
	'django.contrib.sites',
	'django.contrib.flatpages',
	'django.contrib.sitemaps',
]
apps.py
from django.apps import AppConfig
class DJ_RegLoginConfig(AppConfig):
	name = 'DJ_RegLogin'
	verbose_name = "Contents"

Patch information:
diff --git a/django/db/models/fields/related.py b/django/db/models/fields/related.py
index c2aea9c730..35b25c23c5 100644
--- a/django/db/models/fields/related.py
+++ b/django/db/models/fields/related.py
@@ -582,7 +582,12 @@ class ForeignObject(RelatedField):
         if self.remote_field.parent_link:
             kwargs['parent_link'] = self.remote_field.parent_link
         if isinstance(self.remote_field.model, str):
-            kwargs['to'] = self.remote_field.model.lower()
+            to_model = self.remote_field.model
+            if "." in to_model:
+                app_label, model_name = to_model.split(".", 1)
+                kwargs['to'] = "%s.%s" % (app_label, model_name.lower())
+            else:
+                kwargs['to'] = to_model.lower()
         else:
             kwargs['to'] = self.remote_field.model._meta.label_lower
         # If swappable is True, then see if we're actually pointing to the target


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/migrations/test_autodetector.py`.
Extra Requirements: 
Purpose: I need to analyze the tests for the migration autodetector to find existing test cases that cover ForeignKey deconstruction and resolution, particularly with cross-app relationships and varied casing in app labels, to identify tests relevant to the reported bug.

Previous refined query 2:
Essential Query: Please provide the full content of `tests/field_deconstruction/tests.py`.
Extra Requirements: If the file is too large, please at least include all tests related to `ForeignKey` deconstruction.
Purpose: This file is expected to contain direct tests for the `deconstruct()` method of fields, which will help me find test cases relevant to the `ForeignKey` deconstruction issue with mixed-case app labels.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/field_deconstruction/tests.py
Line number range: 1 - 527
Content:
1. from django.apps import apps
2. from django.db import models
3. from django.test import SimpleTestCase, override_settings
4. from django.test.utils import isolate_lru_cache
5. 
6. 
7. class FieldDeconstructionTests(SimpleTestCase):
8.     """
9.     Tests the deconstruct() method on all core fields.
10.     """
11. 
12.     def test_name(self):
13.         """
14.         Tests the outputting of the correct name if assigned one.
15.         """
16.         # First try using a "normal" field
17.         field = models.CharField(max_length=65)
18.         name, path, args, kwargs = field.deconstruct()
19.         self.assertIsNone(name)
20.         field.set_attributes_from_name("is_awesome_test")
21.         name, path, args, kwargs = field.deconstruct()
22.         self.assertEqual(name, "is_awesome_test")
23.         # Now try with a ForeignKey
24.         field = models.ForeignKey("some_fake.ModelName", models.CASCADE)
25.         name, path, args, kwargs = field.deconstruct()
26.         self.assertIsNone(name)
27.         field.set_attributes_from_name("author")
28.         name, path, args, kwargs = field.deconstruct()
29.         self.assertEqual(name, "author")
30. 
31.     def test_db_tablespace(self):
32.         field = models.Field()
33.         _, _, args, kwargs = field.deconstruct()
34.         self.assertEqual(args, [])
35.         self.assertEqual(kwargs, {})
36.         # With a DEFAULT_DB_TABLESPACE.
37.         with self.settings(DEFAULT_DB_TABLESPACE='foo'):
38.             _, _, args, kwargs = field.deconstruct()
39.         self.assertEqual(args, [])
40.         self.assertEqual(kwargs, {})
41.         # With a db_tablespace.
42.         field = models.Field(db_tablespace='foo')
43.         _, _, args, kwargs = field.deconstruct()
44.         self.assertEqual(args, [])
45.         self.assertEqual(kwargs, {'db_tablespace': 'foo'})
46.         # With a db_tablespace equal to DEFAULT_DB_TABLESPACE.
47.         with self.settings(DEFAULT_DB_TABLESPACE='foo'):
48.             _, _, args, kwargs = field.deconstruct()
49.         self.assertEqual(args, [])
50.         self.assertEqual(kwargs, {'db_tablespace': 'foo'})
51. 
52.     def test_auto_field(self):
53.         field = models.AutoField(primary_key=True)
54.         field.set_attributes_from_name("id")
55.         name, path, args, kwargs = field.deconstruct()
56.         self.assertEqual(path, "django.db.models.AutoField")
57.         self.assertEqual(args, [])
58.         self.assertEqual(kwargs, {"primary_key": True})
59. 
60.     def test_big_integer_field(self):
61.         field = models.BigIntegerField()
62.         name, path, args, kwargs = field.deconstruct()
63.         self.assertEqual(path, "django.db.models.BigIntegerField")
64.         self.assertEqual(args, [])
65.         self.assertEqual(kwargs, {})
66. 
67.     def test_boolean_field(self):
68.         field = models.BooleanField()
69.         name, path, args, kwargs = field.deconstruct()
70.         self.assertEqual(path, "django.db.models.BooleanField")
71.         self.assertEqual(args, [])
72.         self.assertEqual(kwargs, {})
73.         field = models.BooleanField(default=True)
74.         name, path, args, kwargs = field.deconstruct()
75.         self.assertEqual(path, "django.db.models.BooleanField")
76.         self.assertEqual(args, [])
77.         self.assertEqual(kwargs, {"default": True})
78. 
79.     def test_char_field(self):
80.         field = models.CharField(max_length=65)
81.         name, path, args, kwargs = field.deconstruct()
82.         self.assertEqual(path, "django.db.models.CharField")
83.         self.assertEqual(args, [])
84.         self.assertEqual(kwargs, {"max_length": 65})
85.         field = models.CharField(max_length=65, null=True, blank=True)
86.         name, path, args, kwargs = field.deconstruct()
87.         self.assertEqual(path, "django.db.models.CharField")
88.         self.assertEqual(args, [])
89.         self.assertEqual(kwargs, {"max_length": 65, "null": True, "blank": True})
90. 
91.     def test_char_field_choices(self):
92.         field = models.CharField(max_length=1, choices=(("A", "One"), ("B", "Two")))
93.         name, path, args, kwargs = field.deconstruct()
94.         self.assertEqual(path, "django.db.models.CharField")
95.         self.assertEqual(args, [])
96.         self.assertEqual(kwargs, {"choices": [("A", "One"), ("B", "Two")], "max_length": 1})
97. 
98.     def test_csi_field(self):
99.         field = models.CommaSeparatedIntegerField(max_length=100)
100.         name, path, args, kwargs = field.deconstruct()
101.         self.assertEqual(path, "django.db.models.CommaSeparatedIntegerField")
102.         self.assertEqual(args, [])
103.         self.assertEqual(kwargs, {"max_length": 100})
104. 
105.     def test_date_field(self):
106.         field = models.DateField()
107.         name, path, args, kwargs = field.deconstruct()
108.         self.assertEqual(path, "django.db.models.DateField")
109.         self.assertEqual(args, [])
110.         self.assertEqual(kwargs, {})
111.         field = models.DateField(auto_now=True)
112.         name, path, args, kwargs = field.deconstruct()
113.         self.assertEqual(path, "django.db.models.DateField")
114.         self.assertEqual(args, [])
115.         self.assertEqual(kwargs, {"auto_now": True})
116. 
117.     def test_datetime_field(self):
118.         field = models.DateTimeField()
119.         name, path, args, kwargs = field.deconstruct()
120.         self.assertEqual(path, "django.db.models.DateTimeField")
121.         self.assertEqual(args, [])
122.         self.assertEqual(kwargs, {})
123.         field = models.DateTimeField(auto_now_add=True)
124.         name, path, args, kwargs = field.deconstruct()
125.         self.assertEqual(path, "django.db.models.DateTimeField")
126.         self.assertEqual(args, [])
127.         self.assertEqual(kwargs, {"auto_now_add": True})
128.         # Bug #21785
129.         field = models.DateTimeField(auto_now=True, auto_now_add=True)
130.         name, path, args, kwargs = field.deconstruct()
131.         self.assertEqual(path, "django.db.models.DateTimeField")
132.         self.assertEqual(args, [])
133.         self.assertEqual(kwargs, {"auto_now_add": True, "auto_now": True})
134. 
135.     def test_decimal_field(self):
136.         field = models.DecimalField(max_digits=5, decimal_places=2)
137.         name, path, args, kwargs = field.deconstruct()
138.         self.assertEqual(path, "django.db.models.DecimalField")
139.         self.assertEqual(args, [])
140.         self.assertEqual(kwargs, {"max_digits": 5, "decimal_places": 2})
141. 
142.     def test_decimal_field_0_decimal_places(self):
143.         """
144.         A DecimalField with decimal_places=0 should work (#22272).
145.         """
146.         field = models.DecimalField(max_digits=5, decimal_places=0)
147.         name, path, args, kwargs = field.deconstruct()
148.         self.assertEqual(path, "django.db.models.DecimalField")
149.         self.assertEqual(args, [])
150.         self.assertEqual(kwargs, {"max_digits": 5, "decimal_places": 0})
151. 
152.     def test_email_field(self):
153.         field = models.EmailField()
154.         name, path, args, kwargs = field.deconstruct()
155.         self.assertEqual(path, "django.db.models.EmailField")
156.         self.assertEqual(args, [])
157.         self.assertEqual(kwargs, {"max_length": 254})
158.         field = models.EmailField(max_length=255)
159.         name, path, args, kwargs = field.deconstruct()
160.         self.assertEqual(path, "django.db.models.EmailField")
161.         self.assertEqual(args, [])
162.         self.assertEqual(kwargs, {"max_length": 255})
163. 
164.     def test_file_field(self):
165.         field = models.FileField(upload_to="foo/bar")
166.         name, path, args, kwargs = field.deconstruct()
167.         self.assertEqual(path, "django.db.models.FileField")
168.         self.assertEqual(args, [])
169.         self.assertEqual(kwargs, {"upload_to": "foo/bar"})
170.         # Test max_length
171.         field = models.FileField(upload_to="foo/bar", max_length=200)
172.         name, path, args, kwargs = field.deconstruct()
173.         self.assertEqual(path, "django.db.models.FileField")
174.         self.assertEqual(args, [])
175.         self.assertEqual(kwargs, {"upload_to": "foo/bar", "max_length": 200})
176. 
177.     def test_file_path_field(self):
178.         field = models.FilePathField(match=r".*\.txt$")
179.         name, path, args, kwargs = field.deconstruct()
180.         self.assertEqual(path, "django.db.models.FilePathField")
181.         self.assertEqual(args, [])
182.         self.assertEqual(kwargs, {"match": r".*\.txt$"})
183.         field = models.FilePathField(recursive=True, allow_folders=True, max_length=123)
184.         name, path, args, kwargs = field.deconstruct()
185.         self.assertEqual(path, "django.db.models.FilePathField")
186.         self.assertEqual(args, [])
187.         self.assertEqual(kwargs, {"recursive": True, "allow_folders": True, "max_length": 123})
188. 
189.     def test_float_field(self):
190.         field = models.FloatField()
191.         name, path, args, kwargs = field.deconstruct()
192.         self.assertEqual(path, "django.db.models.FloatField")
193.         self.assertEqual(args, [])
194.         self.assertEqual(kwargs, {})
195. 
196.     def test_foreign_key(self):
197.         # Test basic pointing
198.         from django.contrib.auth.models import Permission
199.         field = models.ForeignKey("auth.Permission", models.CASCADE)
200.         field.remote_field.model = Permission
201.         field.remote_field.field_name = "id"
202.         name, path, args, kwargs = field.deconstruct()
203.         self.assertEqual(path, "django.db.models.ForeignKey")
204.         self.assertEqual(args, [])
205.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
206.         self.assertFalse(hasattr(kwargs['to'], "setting_name"))
207.         # Test swap detection for swappable model
208.         field = models.ForeignKey("auth.User", models.CASCADE)
209.         name, path, args, kwargs = field.deconstruct()
210.         self.assertEqual(path, "django.db.models.ForeignKey")
211.         self.assertEqual(args, [])
212.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.CASCADE})
213.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
214.         # Test nonexistent (for now) model
215.         field = models.ForeignKey("something.Else", models.CASCADE)
216.         name, path, args, kwargs = field.deconstruct()
217.         self.assertEqual(path, "django.db.models.ForeignKey")
218.         self.assertEqual(args, [])
219.         self.assertEqual(kwargs, {"to": "something.else", "on_delete": models.CASCADE})
220.         # Test on_delete
221.         field = models.ForeignKey("auth.User", models.SET_NULL)
222.         name, path, args, kwargs = field.deconstruct()
223.         self.assertEqual(path, "django.db.models.ForeignKey")
224.         self.assertEqual(args, [])
225.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.SET_NULL})
226.         # Test to_field preservation
227.         field = models.ForeignKey("auth.Permission", models.CASCADE, to_field="foobar")
228.         name, path, args, kwargs = field.deconstruct()
229.         self.assertEqual(path, "django.db.models.ForeignKey")
230.         self.assertEqual(args, [])
231.         self.assertEqual(kwargs, {"to": "auth.permission", "to_field": "foobar", "on_delete": models.CASCADE})
232.         # Test related_name preservation
233.         field = models.ForeignKey("auth.Permission", models.CASCADE, related_name="foobar")
234.         name, path, args, kwargs = field.deconstruct()
235.         self.assertEqual(path, "django.db.models.ForeignKey")
236.         self.assertEqual(args, [])
237.         self.assertEqual(kwargs, {"to": "auth.permission", "related_name": "foobar", "on_delete": models.CASCADE})
238.         # Test related_query_name
239.         field = models.ForeignKey("auth.Permission", models.CASCADE, related_query_name="foobar")
240.         name, path, args, kwargs = field.deconstruct()
241.         self.assertEqual(path, "django.db.models.ForeignKey")
242.         self.assertEqual(args, [])
243.         self.assertEqual(
244.             kwargs,
245.             {"to": "auth.permission", "related_query_name": "foobar", "on_delete": models.CASCADE}
246.         )
247.         # Test limit_choices_to
248.         field = models.ForeignKey("auth.Permission", models.CASCADE, limit_choices_to={'foo': 'bar'})
249.         name, path, args, kwargs = field.deconstruct()
250.         self.assertEqual(path, "django.db.models.ForeignKey")
251.         self.assertEqual(args, [])
252.         self.assertEqual(
253.             kwargs,
254.             {"to": "auth.permission", "limit_choices_to": {'foo': 'bar'}, "on_delete": models.CASCADE}
255.         )
256.         # Test unique
257.         field = models.ForeignKey("auth.Permission", models.CASCADE, unique=True)
258.         name, path, args, kwargs = field.deconstruct()
259.         self.assertEqual(path, "django.db.models.ForeignKey")
260.         self.assertEqual(args, [])
261.         self.assertEqual(kwargs, {"to": "auth.permission", "unique": True, "on_delete": models.CASCADE})
262. 
263.     @override_settings(AUTH_USER_MODEL="auth.Permission")
264.     def test_foreign_key_swapped(self):
265.         with isolate_lru_cache(apps.get_swappable_settings_name):
266.             # It doesn't matter that we swapped out user for permission;
267.             # there's no validation. We just want to check the setting stuff works.
268.             field = models.ForeignKey("auth.Permission", models.CASCADE)
269.             name, path, args, kwargs = field.deconstruct()
270. 
271.         self.assertEqual(path, "django.db.models.ForeignKey")
272.         self.assertEqual(args, [])
273.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
274.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
275. 
276.     def test_one_to_one(self):
277.         # Test basic pointing
278.         from django.contrib.auth.models import Permission
279.         field = models.OneToOneField("auth.Permission", models.CASCADE)
280.         field.remote_field.model = Permission
281.         field.remote_field.field_name = "id"
282.         name, path, args, kwargs = field.deconstruct()
283.         self.assertEqual(path, "django.db.models.OneToOneField")
284.         self.assertEqual(args, [])
285.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
286.         self.assertFalse(hasattr(kwargs['to'], "setting_name"))
287.         # Test swap detection for swappable model
288.         field = models.OneToOneField("auth.User", models.CASCADE)
289.         name, path, args, kwargs = field.deconstruct()
290.         self.assertEqual(path, "django.db.models.OneToOneField")
291.         self.assertEqual(args, [])
292.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.CASCADE})
293.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
294.         # Test nonexistent (for now) model
295.         field = models.OneToOneField("something.Else", models.CASCADE)
296.         name, path, args, kwargs = field.deconstruct()
297.         self.assertEqual(path, "django.db.models.OneToOneField")
298.         self.assertEqual(args, [])
299.         self.assertEqual(kwargs, {"to": "something.else", "on_delete": models.CASCADE})
300.         # Test on_delete
301.         field = models.OneToOneField("auth.User", models.SET_NULL)
302.         name, path, args, kwargs = field.deconstruct()
303.         self.assertEqual(path, "django.db.models.OneToOneField")
304.         self.assertEqual(args, [])
305.         self.assertEqual(kwargs, {"to": "auth.user", "on_delete": models.SET_NULL})
306.         # Test to_field
307.         field = models.OneToOneField("auth.Permission", models.CASCADE, to_field="foobar")
308.         name, path, args, kwargs = field.deconstruct()
309.         self.assertEqual(path, "django.db.models.OneToOneField")
310.         self.assertEqual(args, [])
311.         self.assertEqual(kwargs, {"to": "auth.permission", "to_field": "foobar", "on_delete": models.CASCADE})
312.         # Test related_name
313.         field = models.OneToOneField("auth.Permission", models.CASCADE, related_name="foobar")
314.         name, path, args, kwargs = field.deconstruct()
315.         self.assertEqual(path, "django.db.models.OneToOneField")
316.         self.assertEqual(args, [])
317.         self.assertEqual(kwargs, {"to": "auth.permission", "related_name": "foobar", "on_delete": models.CASCADE})
318.         # Test related_query_name
319.         field = models.OneToOneField("auth.Permission", models.CASCADE, related_query_name="foobar")
320.         name, path, args, kwargs = field.deconstruct()
321.         self.assertEqual(path, "django.db.models.OneToOneField")
322.         self.assertEqual(args, [])
323.         self.assertEqual(
324.             kwargs,
325.             {"to": "auth.permission", "related_query_name": "foobar", "on_delete": models.CASCADE}
326.         )
327.         # Test limit_choices_to
328.         field = models.OneToOneField("auth.Permission", models.CASCADE, limit_choices_to={'foo': 'bar'})
329.         name, path, args, kwargs = field.deconstruct()
330.         self.assertEqual(path, "django.db.models.OneToOneField")
331.         self.assertEqual(args, [])
332.         self.assertEqual(
333.             kwargs,
334.             {"to": "auth.permission", "limit_choices_to": {'foo': 'bar'}, "on_delete": models.CASCADE}
335.         )
336.         # Test unique
337.         field = models.OneToOneField("auth.Permission", models.CASCADE, unique=True)
338.         name, path, args, kwargs = field.deconstruct()
339.         self.assertEqual(path, "django.db.models.OneToOneField")
340.         self.assertEqual(args, [])
341.         self.assertEqual(kwargs, {"to": "auth.permission", "on_delete": models.CASCADE})
342. 
343.     def test_image_field(self):
344.         field = models.ImageField(upload_to="foo/barness", width_field="width", height_field="height")
345.         name, path, args, kwargs = field.deconstruct()
346.         self.assertEqual(path, "django.db.models.ImageField")
347.         self.assertEqual(args, [])
348.         self.assertEqual(kwargs, {"upload_to": "foo/barness", "width_field": "width", "height_field": "height"})
349. 
350.     def test_integer_field(self):
351.         field = models.IntegerField()
352.         name, path, args, kwargs = field.deconstruct()
353.         self.assertEqual(path, "django.db.models.IntegerField")
354.         self.assertEqual(args, [])
355.         self.assertEqual(kwargs, {})
356. 
357.     def test_ip_address_field(self):
358.         field = models.IPAddressField()
359.         name, path, args, kwargs = field.deconstruct()
360.         self.assertEqual(path, "django.db.models.IPAddressField")
361.         self.assertEqual(args, [])
362.         self.assertEqual(kwargs, {})
363. 
364.     def test_generic_ip_address_field(self):
365.         field = models.GenericIPAddressField()
366.         name, path, args, kwargs = field.deconstruct()
367.         self.assertEqual(path, "django.db.models.GenericIPAddressField")
368.         self.assertEqual(args, [])
369.         self.assertEqual(kwargs, {})
370.         field = models.GenericIPAddressField(protocol="IPv6")
371.         name, path, args, kwargs = field.deconstruct()
372.         self.assertEqual(path, "django.db.models.GenericIPAddressField")
373.         self.assertEqual(args, [])
374.         self.assertEqual(kwargs, {"protocol": "IPv6"})
375. 
376.     def test_many_to_many_field(self):
377.         # Test normal
378.         field = models.ManyToManyField("auth.Permission")
379.         name, path, args, kwargs = field.deconstruct()
380.         self.assertEqual(path, "django.db.models.ManyToManyField")
381.         self.assertEqual(args, [])
382.         self.assertEqual(kwargs, {"to": "auth.Permission"})
383.         self.assertFalse(hasattr(kwargs['to'], "setting_name"))
384.         # Test swappable
385.         field = models.ManyToManyField("auth.User")
386.         name, path, args, kwargs = field.deconstruct()
387.         self.assertEqual(path, "django.db.models.ManyToManyField")
388.         self.assertEqual(args, [])
389.         self.assertEqual(kwargs, {"to": "auth.User"})
390.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
391.         # Test through
392.         field = models.ManyToManyField("auth.Permission", through="auth.Group")
393.         name, path, args, kwargs = field.deconstruct()
394.         self.assertEqual(path, "django.db.models.ManyToManyField")
395.         self.assertEqual(args, [])
396.         self.assertEqual(kwargs, {"to": "auth.Permission", "through": "auth.Group"})
397.         # Test custom db_table
398.         field = models.ManyToManyField("auth.Permission", db_table="custom_table")
399.         name, path, args, kwargs = field.deconstruct()
400.         self.assertEqual(path, "django.db.models.ManyToManyField")
401.         self.assertEqual(args, [])
402.         self.assertEqual(kwargs, {"to": "auth.Permission", "db_table": "custom_table"})
403.         # Test related_name
404.         field = models.ManyToManyField("auth.Permission", related_name="custom_table")
405.         name, path, args, kwargs = field.deconstruct()
406.         self.assertEqual(path, "django.db.models.ManyToManyField")
407.         self.assertEqual(args, [])
408.         self.assertEqual(kwargs, {"to": "auth.Permission", "related_name": "custom_table"})
409.         # Test related_query_name
410.         field = models.ManyToManyField("auth.Permission", related_query_name="foobar")
411.         name, path, args, kwargs = field.deconstruct()
412.         self.assertEqual(path, "django.db.models.ManyToManyField")
413.         self.assertEqual(args, [])
414.         self.assertEqual(kwargs, {"to": "auth.Permission", "related_query_name": "foobar"})
415.         # Test limit_choices_to
416.         field = models.ManyToManyField("auth.Permission", limit_choices_to={'foo': 'bar'})
417.         name, path, args, kwargs = field.deconstruct()
418.         self.assertEqual(path, "django.db.models.ManyToManyField")
419.         self.assertEqual(args, [])
420.         self.assertEqual(kwargs, {"to": "auth.Permission", "limit_choices_to": {'foo': 'bar'}})
421. 
422.     @override_settings(AUTH_USER_MODEL="auth.Permission")
423.     def test_many_to_many_field_swapped(self):
424.         with isolate_lru_cache(apps.get_swappable_settings_name):
425.             # It doesn't matter that we swapped out user for permission;
426.             # there's no validation. We just want to check the setting stuff works.
427.             field = models.ManyToManyField("auth.Permission")
428.             name, path, args, kwargs = field.deconstruct()
429. 
430.         self.assertEqual(path, "django.db.models.ManyToManyField")
431.         self.assertEqual(args, [])
432.         self.assertEqual(kwargs, {"to": "auth.Permission"})
433.         self.assertEqual(kwargs['to'].setting_name, "AUTH_USER_MODEL")
434. 
435.     def test_null_boolean_field(self):
436.         field = models.NullBooleanField()
437.         name, path, args, kwargs = field.deconstruct()
438.         self.assertEqual(path, "django.db.models.NullBooleanField")
439.         self.assertEqual(args, [])
440.         self.assertEqual(kwargs, {})
441. 
442.     def test_positive_integer_field(self):
443.         field = models.PositiveIntegerField()
444.         name, path, args, kwargs = field.deconstruct()
445.         self.assertEqual(path, "django.db.models.PositiveIntegerField")
446.         self.assertEqual(args, [])
447.         self.assertEqual(kwargs, {})
448. 
449.     def test_positive_small_integer_field(self):
450.         field = models.PositiveSmallIntegerField()
451.         name, path, args, kwargs = field.deconstruct()
452.         self.assertEqual(path, "django.db.models.PositiveSmallIntegerField")
453.         self.assertEqual(args, [])
454.         self.assertEqual(kwargs, {})
455. 
456.     def test_positive_big_integer_field(self):
457.         field = models.PositiveBigIntegerField()
458.         name, path, args, kwargs = field.deconstruct()
459.         self.assertEqual(path, 'django.db.models.PositiveBigIntegerField')
460.         self.assertEqual(args, [])
461.         self.assertEqual(kwargs, {})
462. 
463.     def test_slug_field(self):
464.         field = models.SlugField()
465.         name, path, args, kwargs = field.deconstruct()
466.         self.assertEqual(path, "django.db.models.SlugField")
467.         self.assertEqual(args, [])
468.         self.assertEqual(kwargs, {})
469.         field = models.SlugField(db_index=False, max_length=231)
470.         name, path, args, kwargs = field.deconstruct()
471.         self.assertEqual(path, "django.db.models.SlugField")
472.         self.assertEqual(args, [])
473.         self.assertEqual(kwargs, {"db_index": False, "max_length": 231})
474. 
475.     def test_small_integer_field(self):
476.         field = models.SmallIntegerField()
477.         name, path, args, kwargs = field.deconstruct()
478.         self.assertEqual(path, "django.db.models.SmallIntegerField")
479.         self.assertEqual(args, [])
480.         self.assertEqual(kwargs, {})
481. 
482.     def test_text_field(self):
483.         field = models.TextField()
484.         name, path, args, kwargs = field.deconstruct()
485.         self.assertEqual(path, "django.db.models.TextField")
486.         self.assertEqual(args, [])
487.         self.assertEqual(kwargs, {})
488. 
489.     def test_time_field(self):
490.         field = models.TimeField()
491.         name, path, args, kwargs = field.deconstruct()
492.         self.assertEqual(path, "django.db.models.TimeField")
493.         self.assertEqual(args, [])
494.         self.assertEqual(kwargs, {})
495. 
496.         field = models.TimeField(auto_now=True)
497.         name, path, args, kwargs = field.deconstruct()
498.         self.assertEqual(args, [])
499.         self.assertEqual(kwargs, {'auto_now': True})
500. 
501.         field = models.TimeField(auto_now_add=True)
502.         name, path, args, kwargs = field.deconstruct()
503.         self.assertEqual(args, [])
504.         self.assertEqual(kwargs, {'auto_now_add': True})
505. 
506.     def test_url_field(self):
507.         field = models.URLField()
508.         name, path, args, kwargs = field.deconstruct()
509.         self.assertEqual(path, "django.db.models.URLField")
510.         self.assertEqual(args, [])
511.         self.assertEqual(kwargs, {})
512.         field = models.URLField(max_length=231)
513.         name, path, args, kwargs = field.deconstruct()
514.         self.assertEqual(path, "django.db.models.URLField")
515.         self.assertEqual(args, [])
516.         self.assertEqual(kwargs, {"max_length": 231})
517. 
518.     def test_binary_field(self):
519.         field = models.BinaryField()
520.         name, path, args, kwargs = field.deconstruct()
521.         self.assertEqual(path, "django.db.models.BinaryField")
522.         self.assertEqual(args, [])
523.         self.assertEqual(kwargs, {})
524.         field = models.BinaryField(editable=True)
525.         name, path, args, kwargs = field.deconstruct()
526.         self.assertEqual(args, [])
527.         self.assertEqual(kwargs, {'editable': True})


File: tests/migrations/test_autodetector.py
Line number range: 1 - 2558
Content:
1. import functools
2. import re
3. from unittest import mock
4. 
5. from django.apps import apps
6. from django.conf import settings
7. from django.contrib.auth.models import AbstractBaseUser
8. from django.core.validators import RegexValidator, validate_slug
9. from django.db import connection, migrations, models
10. from django.db.migrations.autodetector import MigrationAutodetector
11. from django.db.migrations.graph import MigrationGraph
12. from django.db.migrations.loader import MigrationLoader
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.state import ModelState, ProjectState
15. from django.test import SimpleTestCase, TestCase, override_settings
16. from django.test.utils import isolate_lru_cache
17. 
18. from .models import FoodManager, FoodQuerySet
19. 
20. 
21. class DeconstructibleObject:
22.     """
23.     A custom deconstructible object.
24.     """
25. 
26.     def __init__(self, *args, **kwargs):
27.         self.args = args
28.         self.kwargs = kwargs
29. 
30.     def deconstruct(self):
31.         return (
32.             self.__module__ + '.' + self.__class__.__name__,
33.             self.args,
34.             self.kwargs
35.         )
36. 
37. 
38. class AutodetectorTests(TestCase):
39.     """
40.     Tests the migration autodetector.
41.     """
42. 
43.     author_empty = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
44.     author_name = ModelState("testapp", "Author", [
45.         ("id", models.AutoField(primary_key=True)),
46.         ("name", models.CharField(max_length=200)),
47.     ])
48.     author_name_null = ModelState("testapp", "Author", [
49.         ("id", models.AutoField(primary_key=True)),
50.         ("name", models.CharField(max_length=200, null=True)),
51.     ])
52.     author_name_longer = ModelState("testapp", "Author", [
53.         ("id", models.AutoField(primary_key=True)),
54.         ("name", models.CharField(max_length=400)),
55.     ])
56.     author_name_renamed = ModelState("testapp", "Author", [
57.         ("id", models.AutoField(primary_key=True)),
58.         ("names", models.CharField(max_length=200)),
59.     ])
60.     author_name_default = ModelState("testapp", "Author", [
61.         ("id", models.AutoField(primary_key=True)),
62.         ("name", models.CharField(max_length=200, default='Ada Lovelace')),
63.     ])
64.     author_name_check_constraint = ModelState("testapp", "Author", [
65.         ("id", models.AutoField(primary_key=True)),
66.         ("name", models.CharField(max_length=200)),
67.     ],
68.         {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]},
69.     )
70.     author_dates_of_birth_auto_now = ModelState("testapp", "Author", [
71.         ("id", models.AutoField(primary_key=True)),
72.         ("date_of_birth", models.DateField(auto_now=True)),
73.         ("date_time_of_birth", models.DateTimeField(auto_now=True)),
74.         ("time_of_birth", models.TimeField(auto_now=True)),
75.     ])
76.     author_dates_of_birth_auto_now_add = ModelState("testapp", "Author", [
77.         ("id", models.AutoField(primary_key=True)),
78.         ("date_of_birth", models.DateField(auto_now_add=True)),
79.         ("date_time_of_birth", models.DateTimeField(auto_now_add=True)),
80.         ("time_of_birth", models.TimeField(auto_now_add=True)),
81.     ])
82.     author_name_deconstructible_1 = ModelState("testapp", "Author", [
83.         ("id", models.AutoField(primary_key=True)),
84.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
85.     ])
86.     author_name_deconstructible_2 = ModelState("testapp", "Author", [
87.         ("id", models.AutoField(primary_key=True)),
88.         ("name", models.CharField(max_length=200, default=DeconstructibleObject())),
89.     ])
90.     author_name_deconstructible_3 = ModelState("testapp", "Author", [
91.         ("id", models.AutoField(primary_key=True)),
92.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
93.     ])
94.     author_name_deconstructible_4 = ModelState("testapp", "Author", [
95.         ("id", models.AutoField(primary_key=True)),
96.         ("name", models.CharField(max_length=200, default=models.IntegerField())),
97.     ])
98.     author_name_deconstructible_list_1 = ModelState("testapp", "Author", [
99.         ("id", models.AutoField(primary_key=True)),
100.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
101.     ])
102.     author_name_deconstructible_list_2 = ModelState("testapp", "Author", [
103.         ("id", models.AutoField(primary_key=True)),
104.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 123])),
105.     ])
106.     author_name_deconstructible_list_3 = ModelState("testapp", "Author", [
107.         ("id", models.AutoField(primary_key=True)),
108.         ("name", models.CharField(max_length=200, default=[DeconstructibleObject(), 999])),
109.     ])
110.     author_name_deconstructible_tuple_1 = ModelState("testapp", "Author", [
111.         ("id", models.AutoField(primary_key=True)),
112.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
113.     ])
114.     author_name_deconstructible_tuple_2 = ModelState("testapp", "Author", [
115.         ("id", models.AutoField(primary_key=True)),
116.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 123))),
117.     ])
118.     author_name_deconstructible_tuple_3 = ModelState("testapp", "Author", [
119.         ("id", models.AutoField(primary_key=True)),
120.         ("name", models.CharField(max_length=200, default=(DeconstructibleObject(), 999))),
121.     ])
122.     author_name_deconstructible_dict_1 = ModelState("testapp", "Author", [
123.         ("id", models.AutoField(primary_key=True)),
124.         ("name", models.CharField(max_length=200, default={
125.             'item': DeconstructibleObject(), 'otheritem': 123
126.         })),
127.     ])
128.     author_name_deconstructible_dict_2 = ModelState("testapp", "Author", [
129.         ("id", models.AutoField(primary_key=True)),
130.         ("name", models.CharField(max_length=200, default={
131.             'item': DeconstructibleObject(), 'otheritem': 123
132.         })),
133.     ])
134.     author_name_deconstructible_dict_3 = ModelState("testapp", "Author", [
135.         ("id", models.AutoField(primary_key=True)),
136.         ("name", models.CharField(max_length=200, default={
137.             'item': DeconstructibleObject(), 'otheritem': 999
138.         })),
139.     ])
140.     author_name_nested_deconstructible_1 = ModelState("testapp", "Author", [
141.         ("id", models.AutoField(primary_key=True)),
142.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
143.             DeconstructibleObject(1),
144.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
145.             a=DeconstructibleObject('A'),
146.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
147.         ))),
148.     ])
149.     author_name_nested_deconstructible_2 = ModelState("testapp", "Author", [
150.         ("id", models.AutoField(primary_key=True)),
151.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
152.             DeconstructibleObject(1),
153.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
154.             a=DeconstructibleObject('A'),
155.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
156.         ))),
157.     ])
158.     author_name_nested_deconstructible_changed_arg = ModelState("testapp", "Author", [
159.         ("id", models.AutoField(primary_key=True)),
160.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
161.             DeconstructibleObject(1),
162.             (DeconstructibleObject('t1'), DeconstructibleObject('t2-changed'),),
163.             a=DeconstructibleObject('A'),
164.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
165.         ))),
166.     ])
167.     author_name_nested_deconstructible_extra_arg = ModelState("testapp", "Author", [
168.         ("id", models.AutoField(primary_key=True)),
169.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
170.             DeconstructibleObject(1),
171.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
172.             None,
173.             a=DeconstructibleObject('A'),
174.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
175.         ))),
176.     ])
177.     author_name_nested_deconstructible_changed_kwarg = ModelState("testapp", "Author", [
178.         ("id", models.AutoField(primary_key=True)),
179.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
180.             DeconstructibleObject(1),
181.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
182.             a=DeconstructibleObject('A'),
183.             b=DeconstructibleObject(B=DeconstructibleObject('c-changed')),
184.         ))),
185.     ])
186.     author_name_nested_deconstructible_extra_kwarg = ModelState("testapp", "Author", [
187.         ("id", models.AutoField(primary_key=True)),
188.         ("name", models.CharField(max_length=200, default=DeconstructibleObject(
189.             DeconstructibleObject(1),
190.             (DeconstructibleObject('t1'), DeconstructibleObject('t2'),),
191.             a=DeconstructibleObject('A'),
192.             b=DeconstructibleObject(B=DeconstructibleObject('c')),
193.             c=None,
194.         ))),
195.     ])
196.     author_custom_pk = ModelState("testapp", "Author", [("pk_field", models.IntegerField(primary_key=True))])
197.     author_with_biography_non_blank = ModelState("testapp", "Author", [
198.         ("id", models.AutoField(primary_key=True)),
199.         ("name", models.CharField()),
200.         ("biography", models.TextField()),
201.     ])
202.     author_with_biography_blank = ModelState("testapp", "Author", [
203.         ("id", models.AutoField(primary_key=True)),
204.         ("name", models.CharField(blank=True)),
205.         ("biography", models.TextField(blank=True)),
206.     ])
207.     author_with_book = ModelState("testapp", "Author", [
208.         ("id", models.AutoField(primary_key=True)),
209.         ("name", models.CharField(max_length=200)),
210.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
211.     ])
212.     author_with_book_order_wrt = ModelState("testapp", "Author", [
213.         ("id", models.AutoField(primary_key=True)),
214.         ("name", models.CharField(max_length=200)),
215.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
216.     ], options={"order_with_respect_to": "book"})
217.     author_renamed_with_book = ModelState("testapp", "Writer", [
218.         ("id", models.AutoField(primary_key=True)),
219.         ("name", models.CharField(max_length=200)),
220.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
221.     ])
222.     author_with_publisher_string = ModelState("testapp", "Author", [
223.         ("id", models.AutoField(primary_key=True)),
224.         ("name", models.CharField(max_length=200)),
225.         ("publisher_name", models.CharField(max_length=200)),
226.     ])
227.     author_with_publisher = ModelState("testapp", "Author", [
228.         ("id", models.AutoField(primary_key=True)),
229.         ("name", models.CharField(max_length=200)),
230.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
231.     ])
232.     author_with_user = ModelState("testapp", "Author", [
233.         ("id", models.AutoField(primary_key=True)),
234.         ("name", models.CharField(max_length=200)),
235.         ("user", models.ForeignKey("auth.User", models.CASCADE)),
236.     ])
237.     author_with_custom_user = ModelState("testapp", "Author", [
238.         ("id", models.AutoField(primary_key=True)),
239.         ("name", models.CharField(max_length=200)),
240.         ("user", models.ForeignKey("thirdapp.CustomUser", models.CASCADE)),
241.     ])
242.     author_proxy = ModelState("testapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
243.     author_proxy_options = ModelState("testapp", "AuthorProxy", [], {
244.         "proxy": True,
245.         "verbose_name": "Super Author",
246.     }, ("testapp.author",))
247.     author_proxy_notproxy = ModelState("testapp", "AuthorProxy", [], {}, ("testapp.author",))
248.     author_proxy_third = ModelState("thirdapp", "AuthorProxy", [], {"proxy": True}, ("testapp.author",))
249.     author_proxy_third_notproxy = ModelState("thirdapp", "AuthorProxy", [], {}, ("testapp.author",))
250.     author_proxy_proxy = ModelState("testapp", "AAuthorProxyProxy", [], {"proxy": True}, ("testapp.authorproxy",))
251.     author_unmanaged = ModelState("testapp", "AuthorUnmanaged", [], {"managed": False}, ("testapp.author",))
252.     author_unmanaged_managed = ModelState("testapp", "AuthorUnmanaged", [], {}, ("testapp.author",))
253.     author_unmanaged_default_pk = ModelState("testapp", "Author", [("id", models.AutoField(primary_key=True))])
254.     author_unmanaged_custom_pk = ModelState("testapp", "Author", [
255.         ("pk_field", models.IntegerField(primary_key=True)),
256.     ])
257.     author_with_m2m = ModelState("testapp", "Author", [
258.         ("id", models.AutoField(primary_key=True)),
259.         ("publishers", models.ManyToManyField("testapp.Publisher")),
260.     ])
261.     author_with_m2m_blank = ModelState("testapp", "Author", [
262.         ("id", models.AutoField(primary_key=True)),
263.         ("publishers", models.ManyToManyField("testapp.Publisher", blank=True)),
264.     ])
265.     author_with_m2m_through = ModelState("testapp", "Author", [
266.         ("id", models.AutoField(primary_key=True)),
267.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Contract")),
268.     ])
269.     author_with_renamed_m2m_through = ModelState("testapp", "Author", [
270.         ("id", models.AutoField(primary_key=True)),
271.         ("publishers", models.ManyToManyField("testapp.Publisher", through="testapp.Deal")),
272.     ])
273.     author_with_former_m2m = ModelState("testapp", "Author", [
274.         ("id", models.AutoField(primary_key=True)),
275.         ("publishers", models.CharField(max_length=100)),
276.     ])
277.     author_with_options = ModelState("testapp", "Author", [
278.         ("id", models.AutoField(primary_key=True)),
279.     ], {
280.         "permissions": [('can_hire', 'Can hire')],
281.         "verbose_name": "Authi",
282.     })
283.     author_with_db_table_options = ModelState("testapp", "Author", [
284.         ("id", models.AutoField(primary_key=True)),
285.     ], {"db_table": "author_one"})
286.     author_with_new_db_table_options = ModelState("testapp", "Author", [
287.         ("id", models.AutoField(primary_key=True)),
288.     ], {"db_table": "author_two"})
289.     author_renamed_with_db_table_options = ModelState("testapp", "NewAuthor", [
290.         ("id", models.AutoField(primary_key=True)),
291.     ], {"db_table": "author_one"})
292.     author_renamed_with_new_db_table_options = ModelState("testapp", "NewAuthor", [
293.         ("id", models.AutoField(primary_key=True)),
294.     ], {"db_table": "author_three"})
295.     contract = ModelState("testapp", "Contract", [
296.         ("id", models.AutoField(primary_key=True)),
297.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
298.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
299.     ])
300.     contract_renamed = ModelState("testapp", "Deal", [
301.         ("id", models.AutoField(primary_key=True)),
302.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
303.         ("publisher", models.ForeignKey("testapp.Publisher", models.CASCADE)),
304.     ])
305.     publisher = ModelState("testapp", "Publisher", [
306.         ("id", models.AutoField(primary_key=True)),
307.         ("name", models.CharField(max_length=100)),
308.     ])
309.     publisher_with_author = ModelState("testapp", "Publisher", [
310.         ("id", models.AutoField(primary_key=True)),
311.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
312.         ("name", models.CharField(max_length=100)),
313.     ])
314.     publisher_with_aardvark_author = ModelState("testapp", "Publisher", [
315.         ("id", models.AutoField(primary_key=True)),
316.         ("author", models.ForeignKey("testapp.Aardvark", models.CASCADE)),
317.         ("name", models.CharField(max_length=100)),
318.     ])
319.     publisher_with_book = ModelState("testapp", "Publisher", [
320.         ("id", models.AutoField(primary_key=True)),
321.         ("author", models.ForeignKey("otherapp.Book", models.CASCADE)),
322.         ("name", models.CharField(max_length=100)),
323.     ])
324.     other_pony = ModelState("otherapp", "Pony", [
325.         ("id", models.AutoField(primary_key=True)),
326.     ])
327.     other_pony_food = ModelState("otherapp", "Pony", [
328.         ("id", models.AutoField(primary_key=True)),
329.     ], managers=[
330.         ('food_qs', FoodQuerySet.as_manager()),
331.         ('food_mgr', FoodManager('a', 'b')),
332.         ('food_mgr_kwargs', FoodManager('x', 'y', 3, 4)),
333.     ])
334.     other_stable = ModelState("otherapp", "Stable", [("id", models.AutoField(primary_key=True))])
335.     third_thing = ModelState("thirdapp", "Thing", [("id", models.AutoField(primary_key=True))])
336.     book = ModelState("otherapp", "Book", [
337.         ("id", models.AutoField(primary_key=True)),
338.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
339.         ("title", models.CharField(max_length=200)),
340.     ])
341.     book_proxy_fk = ModelState("otherapp", "Book", [
342.         ("id", models.AutoField(primary_key=True)),
343.         ("author", models.ForeignKey("thirdapp.AuthorProxy", models.CASCADE)),
344.         ("title", models.CharField(max_length=200)),
345.     ])
346.     book_proxy_proxy_fk = ModelState("otherapp", "Book", [
347.         ("id", models.AutoField(primary_key=True)),
348.         ("author", models.ForeignKey("testapp.AAuthorProxyProxy", models.CASCADE)),
349.     ])
350.     book_migrations_fk = ModelState("otherapp", "Book", [
351.         ("id", models.AutoField(primary_key=True)),
352.         ("author", models.ForeignKey("migrations.UnmigratedModel", models.CASCADE)),
353.         ("title", models.CharField(max_length=200)),
354.     ])
355.     book_with_no_author_fk = ModelState("otherapp", "Book", [
356.         ("id", models.AutoField(primary_key=True)),
357.         ("author", models.IntegerField()),
358.         ("title", models.CharField(max_length=200)),
359.     ])
360.     book_with_no_author = ModelState("otherapp", "Book", [
361.         ("id", models.AutoField(primary_key=True)),
362.         ("title", models.CharField(max_length=200)),
363.     ])
364.     book_with_author_renamed = ModelState("otherapp", "Book", [
365.         ("id", models.AutoField(primary_key=True)),
366.         ("author", models.ForeignKey("testapp.Writer", models.CASCADE)),
367.         ("title", models.CharField(max_length=200)),
368.     ])
369.     book_with_field_and_author_renamed = ModelState("otherapp", "Book", [
370.         ("id", models.AutoField(primary_key=True)),
371.         ("writer", models.ForeignKey("testapp.Writer", models.CASCADE)),
372.         ("title", models.CharField(max_length=200)),
373.     ])
374.     book_with_multiple_authors = ModelState("otherapp", "Book", [
375.         ("id", models.AutoField(primary_key=True)),
376.         ("authors", models.ManyToManyField("testapp.Author")),
377.         ("title", models.CharField(max_length=200)),
378.     ])
379.     book_with_multiple_authors_through_attribution = ModelState("otherapp", "Book", [
380.         ("id", models.AutoField(primary_key=True)),
381.         ("authors", models.ManyToManyField("testapp.Author", through="otherapp.Attribution")),
382.         ("title", models.CharField(max_length=200)),
383.     ])
384.     book_indexes = ModelState("otherapp", "Book", [
385.         ("id", models.AutoField(primary_key=True)),
386.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
387.         ("title", models.CharField(max_length=200)),
388.     ], {
389.         "indexes": [models.Index(fields=["author", "title"], name="book_title_author_idx")],
390.     })
391.     book_unordered_indexes = ModelState("otherapp", "Book", [
392.         ("id", models.AutoField(primary_key=True)),
393.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
394.         ("title", models.CharField(max_length=200)),
395.     ], {
396.         "indexes": [models.Index(fields=["title", "author"], name="book_author_title_idx")],
397.     })
398.     book_foo_together = ModelState("otherapp", "Book", [
399.         ("id", models.AutoField(primary_key=True)),
400.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
401.         ("title", models.CharField(max_length=200)),
402.     ], {
403.         "index_together": {("author", "title")},
404.         "unique_together": {("author", "title")},
405.     })
406.     book_foo_together_2 = ModelState("otherapp", "Book", [
407.         ("id", models.AutoField(primary_key=True)),
408.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
409.         ("title", models.CharField(max_length=200)),
410.     ], {
411.         "index_together": {("title", "author")},
412.         "unique_together": {("title", "author")},
413.     })
414.     book_foo_together_3 = ModelState("otherapp", "Book", [
415.         ("id", models.AutoField(primary_key=True)),
416.         ("newfield", models.IntegerField()),
417.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
418.         ("title", models.CharField(max_length=200)),
419.     ], {
420.         "index_together": {("title", "newfield")},
421.         "unique_together": {("title", "newfield")},
422.     })
423.     book_foo_together_4 = ModelState("otherapp", "Book", [
424.         ("id", models.AutoField(primary_key=True)),
425.         ("newfield2", models.IntegerField()),
426.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
427.         ("title", models.CharField(max_length=200)),
428.     ], {
429.         "index_together": {("title", "newfield2")},
430.         "unique_together": {("title", "newfield2")},
431.     })
432.     attribution = ModelState("otherapp", "Attribution", [
433.         ("id", models.AutoField(primary_key=True)),
434.         ("author", models.ForeignKey("testapp.Author", models.CASCADE)),
435.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
436.     ])
437.     edition = ModelState("thirdapp", "Edition", [
438.         ("id", models.AutoField(primary_key=True)),
439.         ("book", models.ForeignKey("otherapp.Book", models.CASCADE)),
440.     ])
441.     custom_user = ModelState("thirdapp", "CustomUser", [
442.         ("id", models.AutoField(primary_key=True)),
443.         ("username", models.CharField(max_length=255)),
444.     ], bases=(AbstractBaseUser,))
445.     custom_user_no_inherit = ModelState("thirdapp", "CustomUser", [
446.         ("id", models.AutoField(primary_key=True)),
447.         ("username", models.CharField(max_length=255)),
448.     ])
449.     aardvark = ModelState("thirdapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
450.     aardvark_testapp = ModelState("testapp", "Aardvark", [("id", models.AutoField(primary_key=True))])
451.     aardvark_based_on_author = ModelState("testapp", "Aardvark", [], bases=("testapp.Author",))
452.     aardvark_pk_fk_author = ModelState("testapp", "Aardvark", [
453.         ("id", models.OneToOneField("testapp.Author", models.CASCADE, primary_key=True)),
454.     ])
455.     knight = ModelState("eggs", "Knight", [("id", models.AutoField(primary_key=True))])
456.     rabbit = ModelState("eggs", "Rabbit", [
457.         ("id", models.AutoField(primary_key=True)),
458.         ("knight", models.ForeignKey("eggs.Knight", models.CASCADE)),
459.         ("parent", models.ForeignKey("eggs.Rabbit", models.CASCADE)),
460.     ], {
461.         "unique_together": {("parent", "knight")},
462.         "indexes": [models.Index(fields=["parent", "knight"], name='rabbit_circular_fk_index')],
463.     })
464. 
465.     def repr_changes(self, changes, include_dependencies=False):
466.         output = ""
467.         for app_label, migrations_ in sorted(changes.items()):
468.             output += "  %s:\n" % app_label
469.             for migration in migrations_:
470.                 output += "    %s\n" % migration.name
471.                 for operation in migration.operations:
472.                     output += "      %s\n" % operation
473.                 if include_dependencies:
474.                     output += "      Dependencies:\n"
475.                     if migration.dependencies:
476.                         for dep in migration.dependencies:
477.                             output += "        %s\n" % (dep,)
478.                     else:
479.                         output += "        None\n"
480.         return output
481. 
482.     def assertNumberMigrations(self, changes, app_label, number):
483.         if len(changes.get(app_label, [])) != number:
484.             self.fail("Incorrect number of migrations (%s) for %s (expected %s)\n%s" % (
485.                 len(changes.get(app_label, [])),
486.                 app_label,
487.                 number,
488.                 self.repr_changes(changes),
489.             ))
490. 
491.     def assertMigrationDependencies(self, changes, app_label, position, dependencies):
492.         if not changes.get(app_label):
493.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
494.         if len(changes[app_label]) < position + 1:
495.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
496.         migration = changes[app_label][position]
497.         if set(migration.dependencies) != set(dependencies):
498.             self.fail("Migration dependencies mismatch for %s.%s (expected %s):\n%s" % (
499.                 app_label,
500.                 migration.name,
501.                 dependencies,
502.                 self.repr_changes(changes, include_dependencies=True),
503.             ))
504. 
505.     def assertOperationTypes(self, changes, app_label, position, types):
506.         if not changes.get(app_label):
507.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
508.         if len(changes[app_label]) < position + 1:
509.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
510.         migration = changes[app_label][position]
511.         real_types = [operation.__class__.__name__ for operation in migration.operations]
512.         if types != real_types:
513.             self.fail("Operation type mismatch for %s.%s (expected %s):\n%s" % (
514.                 app_label,
515.                 migration.name,
516.                 types,
517.                 self.repr_changes(changes),
518.             ))
519. 
520.     def assertOperationAttributes(self, changes, app_label, position, operation_position, **attrs):
521.         if not changes.get(app_label):
522.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
523.         if len(changes[app_label]) < position + 1:
524.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
525.         migration = changes[app_label][position]
526.         if len(changes[app_label]) < position + 1:
527.             self.fail("No operation at index %s for %s.%s\n%s" % (
528.                 operation_position,
529.                 app_label,
530.                 migration.name,
531.                 self.repr_changes(changes),
532.             ))
533.         operation = migration.operations[operation_position]
534.         for attr, value in attrs.items():
535.             if getattr(operation, attr, None) != value:
536.                 self.fail("Attribute mismatch for %s.%s op #%s, %s (expected %r, got %r):\n%s" % (
537.                     app_label,
538.                     migration.name,
539.                     operation_position,
540.                     attr,
541.                     value,
542.                     getattr(operation, attr, None),
543.                     self.repr_changes(changes),
544.                 ))
545. 
546.     def assertOperationFieldAttributes(self, changes, app_label, position, operation_position, **attrs):
547.         if not changes.get(app_label):
548.             self.fail("No migrations found for %s\n%s" % (app_label, self.repr_changes(changes)))
549.         if len(changes[app_label]) < position + 1:
550.             self.fail("No migration at index %s for %s\n%s" % (position, app_label, self.repr_changes(changes)))
551.         migration = changes[app_label][position]
552.         if len(changes[app_label]) < position + 1:
553.             self.fail("No operation at index %s for %s.%s\n%s" % (
554.                 operation_position,
555.                 app_label,
556.                 migration.name,
557.                 self.repr_changes(changes),
558.             ))
559.         operation = migration.operations[operation_position]
560.         if not hasattr(operation, 'field'):
561.             self.fail("No field attribute for %s.%s op #%s." % (
562.                 app_label,
563.                 migration.name,
564.                 operation_position,
565.             ))
566.         field = operation.field
567.         for attr, value in attrs.items():
568.             if getattr(field, attr, None) != value:
569.                 self.fail("Field attribute mismatch for %s.%s op #%s, field.%s (expected %r, got %r):\n%s" % (
570.                     app_label,
571.                     migration.name,
572.                     operation_position,
573.                     attr,
574.                     value,
575.                     getattr(field, attr, None),
576.                     self.repr_changes(changes),
577.                 ))
578. 
579.     def make_project_state(self, model_states):
580.         "Shortcut to make ProjectStates from lists of predefined models"
581.         project_state = ProjectState()
582.         for model_state in model_states:
583.             project_state.add_model(model_state.clone())
584.         return project_state
585. 
586.     def get_changes(self, before_states, after_states, questioner=None):
587.         return MigrationAutodetector(
588.             self.make_project_state(before_states),
589.             self.make_project_state(after_states),
590.             questioner,
591.         )._detect_changes()
592. 
593.     def test_arrange_for_graph(self):
594.         """Tests auto-naming of migrations for graph matching."""
595.         # Make a fake graph
596.         graph = MigrationGraph()
597.         graph.add_node(("testapp", "0001_initial"), None)
598.         graph.add_node(("testapp", "0002_foobar"), None)
599.         graph.add_node(("otherapp", "0001_initial"), None)
600.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
601.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("otherapp", "0001_initial"))
602.         # Use project state to make a new migration change set
603.         before = self.make_project_state([])
604.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
605.         autodetector = MigrationAutodetector(before, after)
606.         changes = autodetector._detect_changes()
607.         # Run through arrange_for_graph
608.         changes = autodetector.arrange_for_graph(changes, graph)
609.         # Make sure there's a new name, deps match, etc.
610.         self.assertEqual(changes["testapp"][0].name, "0003_author")
611.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
612.         self.assertEqual(changes["otherapp"][0].name, "0002_pony_stable")
613.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
614. 
615.     def test_arrange_for_graph_with_multiple_initial(self):
616.         # Make a fake graph.
617.         graph = MigrationGraph()
618.         # Use project state to make a new migration change set.
619.         before = self.make_project_state([])
620.         after = self.make_project_state([self.author_with_book, self.book, self.attribution])
621.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({'ask_initial': True}))
622.         changes = autodetector._detect_changes()
623.         changes = autodetector.arrange_for_graph(changes, graph)
624. 
625.         self.assertEqual(changes['otherapp'][0].name, '0001_initial')
626.         self.assertEqual(changes['otherapp'][0].dependencies, [])
627.         self.assertEqual(changes['otherapp'][1].name, '0002_initial')
628.         self.assertCountEqual(
629.             changes['otherapp'][1].dependencies,
630.             [('testapp', '0001_initial'), ('otherapp', '0001_initial')],
631.         )
632.         self.assertEqual(changes['testapp'][0].name, '0001_initial')
633.         self.assertEqual(changes['testapp'][0].dependencies, [('otherapp', '0001_initial')])
634. 
635.     def test_trim_apps(self):
636.         """
637.         Trim does not remove dependencies but does remove unwanted apps.
638.         """
639.         # Use project state to make a new migration change set
640.         before = self.make_project_state([])
641.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable, self.third_thing])
642.         autodetector = MigrationAutodetector(before, after, MigrationQuestioner({"ask_initial": True}))
643.         changes = autodetector._detect_changes()
644.         # Run through arrange_for_graph
645.         graph = MigrationGraph()
646.         changes = autodetector.arrange_for_graph(changes, graph)
647.         changes["testapp"][0].dependencies.append(("otherapp", "0001_initial"))
648.         changes = autodetector._trim_to_apps(changes, {"testapp"})
649.         # Make sure there's the right set of migrations
650.         self.assertEqual(changes["testapp"][0].name, "0001_initial")
651.         self.assertEqual(changes["otherapp"][0].name, "0001_initial")
652.         self.assertNotIn("thirdapp", changes)
653. 
654.     def test_custom_migration_name(self):
655.         """Tests custom naming of migrations for graph matching."""
656.         # Make a fake graph
657.         graph = MigrationGraph()
658.         graph.add_node(("testapp", "0001_initial"), None)
659.         graph.add_node(("testapp", "0002_foobar"), None)
660.         graph.add_node(("otherapp", "0001_initial"), None)
661.         graph.add_dependency("testapp.0002_foobar", ("testapp", "0002_foobar"), ("testapp", "0001_initial"))
662. 
663.         # Use project state to make a new migration change set
664.         before = self.make_project_state([])
665.         after = self.make_project_state([self.author_empty, self.other_pony, self.other_stable])
666.         autodetector = MigrationAutodetector(before, after)
667.         changes = autodetector._detect_changes()
668. 
669.         # Run through arrange_for_graph
670.         migration_name = 'custom_name'
671.         changes = autodetector.arrange_for_graph(changes, graph, migration_name)
672. 
673.         # Make sure there's a new name, deps match, etc.
674.         self.assertEqual(changes["testapp"][0].name, "0003_%s" % migration_name)
675.         self.assertEqual(changes["testapp"][0].dependencies, [("testapp", "0002_foobar")])
676.         self.assertEqual(changes["otherapp"][0].name, "0002_%s" % migration_name)
677.         self.assertEqual(changes["otherapp"][0].dependencies, [("otherapp", "0001_initial")])
678. 
679.     def test_new_model(self):
680.         """Tests autodetection of new models."""
681.         changes = self.get_changes([], [self.other_pony_food])
682.         # Right number/type of migrations?
683.         self.assertNumberMigrations(changes, 'otherapp', 1)
684.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
685.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="Pony")
686.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
687.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
688. 
689.     def test_old_model(self):
690.         """Tests deletion of old models."""
691.         changes = self.get_changes([self.author_empty], [])
692.         # Right number/type of migrations?
693.         self.assertNumberMigrations(changes, 'testapp', 1)
694.         self.assertOperationTypes(changes, 'testapp', 0, ["DeleteModel"])
695.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
696. 
697.     def test_add_field(self):
698.         """Tests autodetection of new fields."""
699.         changes = self.get_changes([self.author_empty], [self.author_name])
700.         # Right number/type of migrations?
701.         self.assertNumberMigrations(changes, 'testapp', 1)
702.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
703.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
704. 
705.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
706.                 side_effect=AssertionError("Should not have prompted for not null addition"))
707.     def test_add_date_fields_with_auto_now_not_asking_for_default(self, mocked_ask_method):
708.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now])
709.         # Right number/type of migrations?
710.         self.assertNumberMigrations(changes, 'testapp', 1)
711.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
712.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now=True)
713.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now=True)
714.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now=True)
715. 
716.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
717.                 side_effect=AssertionError("Should not have prompted for not null addition"))
718.     def test_add_date_fields_with_auto_now_add_not_asking_for_null_addition(self, mocked_ask_method):
719.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
720.         # Right number/type of migrations?
721.         self.assertNumberMigrations(changes, 'testapp', 1)
722.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
723.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
724.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
725.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
726. 
727.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_auto_now_add_addition')
728.     def test_add_date_fields_with_auto_now_add_asking_for_default(self, mocked_ask_method):
729.         changes = self.get_changes([self.author_empty], [self.author_dates_of_birth_auto_now_add])
730.         # Right number/type of migrations?
731.         self.assertNumberMigrations(changes, 'testapp', 1)
732.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField", "AddField"])
733.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, auto_now_add=True)
734.         self.assertOperationFieldAttributes(changes, "testapp", 0, 1, auto_now_add=True)
735.         self.assertOperationFieldAttributes(changes, "testapp", 0, 2, auto_now_add=True)
736.         self.assertEqual(mocked_ask_method.call_count, 3)
737. 
738.     def test_remove_field(self):
739.         """Tests autodetection of removed fields."""
740.         changes = self.get_changes([self.author_name], [self.author_empty])
741.         # Right number/type of migrations?
742.         self.assertNumberMigrations(changes, 'testapp', 1)
743.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField"])
744.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name")
745. 
746.     def test_alter_field(self):
747.         """Tests autodetection of new fields."""
748.         changes = self.get_changes([self.author_name], [self.author_name_longer])
749.         # Right number/type of migrations?
750.         self.assertNumberMigrations(changes, 'testapp', 1)
751.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
752.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
753. 
754.     def test_supports_functools_partial(self):
755.         def _content_file_name(instance, filename, key, **kwargs):
756.             return '{}/{}'.format(instance, filename)
757. 
758.         def content_file_name(key, **kwargs):
759.             return functools.partial(_content_file_name, key, **kwargs)
760. 
761.         # An unchanged partial reference.
762.         before = [ModelState("testapp", "Author", [
763.             ("id", models.AutoField(primary_key=True)),
764.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
765.         ])]
766.         after = [ModelState("testapp", "Author", [
767.             ("id", models.AutoField(primary_key=True)),
768.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file'))),
769.         ])]
770.         changes = self.get_changes(before, after)
771.         self.assertNumberMigrations(changes, 'testapp', 0)
772. 
773.         # A changed partial reference.
774.         args_changed = [ModelState("testapp", "Author", [
775.             ("id", models.AutoField(primary_key=True)),
776.             ("file", models.FileField(max_length=200, upload_to=content_file_name('other-file'))),
777.         ])]
778.         changes = self.get_changes(before, args_changed)
779.         self.assertNumberMigrations(changes, 'testapp', 1)
780.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
781.         # Can't use assertOperationFieldAttributes because we need the
782.         # deconstructed version, i.e., the exploded func/args/keywords rather
783.         # than the partial: we don't care if it's not the same instance of the
784.         # partial, only if it's the same source function, args, and keywords.
785.         value = changes['testapp'][0].operations[0].field.upload_to
786.         self.assertEqual(
787.             (_content_file_name, ('other-file',), {}),
788.             (value.func, value.args, value.keywords)
789.         )
790. 
791.         kwargs_changed = [ModelState("testapp", "Author", [
792.             ("id", models.AutoField(primary_key=True)),
793.             ("file", models.FileField(max_length=200, upload_to=content_file_name('file', spam='eggs'))),
794.         ])]
795.         changes = self.get_changes(before, kwargs_changed)
796.         self.assertNumberMigrations(changes, 'testapp', 1)
797.         self.assertOperationTypes(changes, 'testapp', 0, ['AlterField'])
798.         value = changes['testapp'][0].operations[0].field.upload_to
799.         self.assertEqual(
800.             (_content_file_name, ('file',), {'spam': 'eggs'}),
801.             (value.func, value.args, value.keywords)
802.         )
803. 
804.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
805.                 side_effect=AssertionError("Should not have prompted for not null addition"))
806.     def test_alter_field_to_not_null_with_default(self, mocked_ask_method):
807.         """
808.         #23609 - Tests autodetection of nullable to non-nullable alterations.
809.         """
810.         changes = self.get_changes([self.author_name_null], [self.author_name_default])
811.         # Right number/type of migrations?
812.         self.assertNumberMigrations(changes, 'testapp', 1)
813.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
814.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
815.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default='Ada Lovelace')
816. 
817.     @mock.patch(
818.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
819.         return_value=models.NOT_PROVIDED,
820.     )
821.     def test_alter_field_to_not_null_without_default(self, mocked_ask_method):
822.         """
823.         #23609 - Tests autodetection of nullable to non-nullable alterations.
824.         """
825.         changes = self.get_changes([self.author_name_null], [self.author_name])
826.         self.assertEqual(mocked_ask_method.call_count, 1)
827.         # Right number/type of migrations?
828.         self.assertNumberMigrations(changes, 'testapp', 1)
829.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
830.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=True)
831.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default=models.NOT_PROVIDED)
832. 
833.     @mock.patch(
834.         'django.db.migrations.questioner.MigrationQuestioner.ask_not_null_alteration',
835.         return_value='Some Name',
836.     )
837.     def test_alter_field_to_not_null_oneoff_default(self, mocked_ask_method):
838.         """
839.         #23609 - Tests autodetection of nullable to non-nullable alterations.
840.         """
841.         changes = self.get_changes([self.author_name_null], [self.author_name])
842.         self.assertEqual(mocked_ask_method.call_count, 1)
843.         # Right number/type of migrations?
844.         self.assertNumberMigrations(changes, 'testapp', 1)
845.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
846.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="name", preserve_default=False)
847.         self.assertOperationFieldAttributes(changes, "testapp", 0, 0, default="Some Name")
848. 
849.     def test_rename_field(self):
850.         """Tests autodetection of renamed fields."""
851.         changes = self.get_changes(
852.             [self.author_name], [self.author_name_renamed], MigrationQuestioner({"ask_rename": True})
853.         )
854.         # Right number/type of migrations?
855.         self.assertNumberMigrations(changes, 'testapp', 1)
856.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameField"])
857.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="name", new_name="names")
858. 
859.     def test_rename_field_foreign_key_to_field(self):
860.         before = [
861.             ModelState('app', 'Foo', [
862.                 ('id', models.AutoField(primary_key=True)),
863.                 ('field', models.IntegerField(unique=True)),
864.             ]),
865.             ModelState('app', 'Bar', [
866.                 ('id', models.AutoField(primary_key=True)),
867.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='field')),
868.             ]),
869.         ]
870.         after = [
871.             ModelState('app', 'Foo', [
872.                 ('id', models.AutoField(primary_key=True)),
873.                 ('renamed_field', models.IntegerField(unique=True)),
874.             ]),
875.             ModelState('app', 'Bar', [
876.                 ('id', models.AutoField(primary_key=True)),
877.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE, to_field='renamed_field')),
878.             ]),
879.         ]
880.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
881.         # Right number/type of migrations?
882.         self.assertNumberMigrations(changes, 'app', 1)
883.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
884.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='field', new_name='renamed_field')
885. 
886.     def test_rename_foreign_object_fields(self):
887.         fields = ('first', 'second')
888.         renamed_fields = ('first_renamed', 'second_renamed')
889.         before = [
890.             ModelState('app', 'Foo', [
891.                 ('id', models.AutoField(primary_key=True)),
892.                 ('first', models.IntegerField()),
893.                 ('second', models.IntegerField()),
894.             ], options={'unique_together': {fields}}),
895.             ModelState('app', 'Bar', [
896.                 ('id', models.AutoField(primary_key=True)),
897.                 ('first', models.IntegerField()),
898.                 ('second', models.IntegerField()),
899.                 ('foo', models.ForeignObject(
900.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=fields,
901.                 )),
902.             ]),
903.         ]
904.         # Case 1: to_fields renames.
905.         after = [
906.             ModelState('app', 'Foo', [
907.                 ('id', models.AutoField(primary_key=True)),
908.                 ('first_renamed', models.IntegerField()),
909.                 ('second_renamed', models.IntegerField()),
910.             ], options={'unique_together': {renamed_fields}}),
911.             ModelState('app', 'Bar', [
912.                 ('id', models.AutoField(primary_key=True)),
913.                 ('first', models.IntegerField()),
914.                 ('second', models.IntegerField()),
915.                 ('foo', models.ForeignObject(
916.                     'app.Foo', models.CASCADE, from_fields=fields, to_fields=renamed_fields,
917.                 )),
918.             ]),
919.         ]
920.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
921.         self.assertNumberMigrations(changes, 'app', 1)
922.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField', 'AlterUniqueTogether'])
923.         self.assertOperationAttributes(
924.             changes, 'app', 0, 0, model_name='foo', old_name='first', new_name='first_renamed',
925.         )
926.         self.assertOperationAttributes(
927.             changes, 'app', 0, 1, model_name='foo', old_name='second', new_name='second_renamed',
928.         )
929.         # Case 2: from_fields renames.
930.         after = [
931.             ModelState('app', 'Foo', [
932.                 ('id', models.AutoField(primary_key=True)),
933.                 ('first', models.IntegerField()),
934.                 ('second', models.IntegerField()),
935.             ], options={'unique_together': {fields}}),
936.             ModelState('app', 'Bar', [
937.                 ('id', models.AutoField(primary_key=True)),
938.                 ('first_renamed', models.IntegerField()),
939.                 ('second_renamed', models.IntegerField()),
940.                 ('foo', models.ForeignObject(
941.                     'app.Foo', models.CASCADE, from_fields=renamed_fields, to_fields=fields,
942.                 )),
943.             ]),
944.         ]
945.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
946.         self.assertNumberMigrations(changes, 'app', 1)
947.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'RenameField'])
948.         self.assertOperationAttributes(
949.             changes, 'app', 0, 0, model_name='bar', old_name='first', new_name='first_renamed',
950.         )
951.         self.assertOperationAttributes(
952.             changes, 'app', 0, 1, model_name='bar', old_name='second', new_name='second_renamed',
953.         )
954. 
955.     def test_rename_referenced_primary_key(self):
956.         before = [
957.             ModelState('app', 'Foo', [
958.                 ('id', models.CharField(primary_key=True, serialize=False)),
959.             ]),
960.             ModelState('app', 'Bar', [
961.                 ('id', models.AutoField(primary_key=True)),
962.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
963.             ]),
964.         ]
965.         after = [
966.             ModelState('app', 'Foo', [
967.                 ('renamed_id', models.CharField(primary_key=True, serialize=False))
968.             ]),
969.             ModelState('app', 'Bar', [
970.                 ('id', models.AutoField(primary_key=True)),
971.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
972.             ]),
973.         ]
974.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
975.         self.assertNumberMigrations(changes, 'app', 1)
976.         self.assertOperationTypes(changes, 'app', 0, ['RenameField'])
977.         self.assertOperationAttributes(changes, 'app', 0, 0, old_name='id', new_name='renamed_id')
978. 
979.     def test_rename_field_preserved_db_column(self):
980.         """
981.         RenameField is used if a field is renamed and db_column equal to the
982.         old field's column is added.
983.         """
984.         before = [
985.             ModelState('app', 'Foo', [
986.                 ('id', models.AutoField(primary_key=True)),
987.                 ('field', models.IntegerField()),
988.             ]),
989.         ]
990.         after = [
991.             ModelState('app', 'Foo', [
992.                 ('id', models.AutoField(primary_key=True)),
993.                 ('renamed_field', models.IntegerField(db_column='field')),
994.             ]),
995.         ]
996.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
997.         self.assertNumberMigrations(changes, 'app', 1)
998.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
999.         self.assertOperationAttributes(
1000.             changes, 'app', 0, 0, model_name='foo', old_name='field', new_name='renamed_field',
1001.         )
1002.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='foo', name='renamed_field')
1003.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1004.             'renamed_field', 'django.db.models.IntegerField', [], {'db_column': 'field'},
1005.         ))
1006. 
1007.     def test_rename_related_field_preserved_db_column(self):
1008.         before = [
1009.             ModelState('app', 'Foo', [
1010.                 ('id', models.AutoField(primary_key=True)),
1011.             ]),
1012.             ModelState('app', 'Bar', [
1013.                 ('id', models.AutoField(primary_key=True)),
1014.                 ('foo', models.ForeignKey('app.Foo', models.CASCADE)),
1015.             ]),
1016.         ]
1017.         after = [
1018.             ModelState('app', 'Foo', [
1019.                 ('id', models.AutoField(primary_key=True)),
1020.             ]),
1021.             ModelState('app', 'Bar', [
1022.                 ('id', models.AutoField(primary_key=True)),
1023.                 ('renamed_foo', models.ForeignKey('app.Foo', models.CASCADE, db_column='foo_id')),
1024.             ]),
1025.         ]
1026.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename': True}))
1027.         self.assertNumberMigrations(changes, 'app', 1)
1028.         self.assertOperationTypes(changes, 'app', 0, ['RenameField', 'AlterField'])
1029.         self.assertOperationAttributes(
1030.             changes, 'app', 0, 0, model_name='bar', old_name='foo', new_name='renamed_foo',
1031.         )
1032.         self.assertOperationAttributes(changes, 'app', 0, 1, model_name='bar', name='renamed_foo')
1033.         self.assertEqual(changes['app'][0].operations[-1].field.deconstruct(), (
1034.             'renamed_foo',
1035.             'django.db.models.ForeignKey',
1036.             [],
1037.             {'to': 'app.foo', 'on_delete': models.CASCADE, 'db_column': 'foo_id'},
1038.         ))
1039. 
1040.     def test_rename_model(self):
1041.         """Tests autodetection of renamed models."""
1042.         changes = self.get_changes(
1043.             [self.author_with_book, self.book],
1044.             [self.author_renamed_with_book, self.book_with_author_renamed],
1045.             MigrationQuestioner({"ask_rename_model": True}),
1046.         )
1047.         # Right number/type of migrations?
1048.         self.assertNumberMigrations(changes, 'testapp', 1)
1049.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1050.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1051.         # Now that RenameModel handles related fields too, there should be
1052.         # no AlterField for the related field.
1053.         self.assertNumberMigrations(changes, 'otherapp', 0)
1054. 
1055.     def test_rename_model_case(self):
1056.         """
1057.         Model name is case-insensitive. Changing case doesn't lead to any
1058.         autodetected operations.
1059.         """
1060.         author_renamed = ModelState('testapp', 'author', [
1061.             ('id', models.AutoField(primary_key=True)),
1062.         ])
1063.         changes = self.get_changes(
1064.             [self.author_empty, self.book],
1065.             [author_renamed, self.book],
1066.             questioner=MigrationQuestioner({'ask_rename_model': True}),
1067.         )
1068.         self.assertNumberMigrations(changes, 'testapp', 0)
1069.         self.assertNumberMigrations(changes, 'otherapp', 0)
1070. 
1071.     def test_rename_m2m_through_model(self):
1072.         """
1073.         Tests autodetection of renamed models that are used in M2M relations as
1074.         through models.
1075.         """
1076.         changes = self.get_changes(
1077.             [self.author_with_m2m_through, self.publisher, self.contract],
1078.             [self.author_with_renamed_m2m_through, self.publisher, self.contract_renamed],
1079.             MigrationQuestioner({'ask_rename_model': True})
1080.         )
1081.         # Right number/type of migrations?
1082.         self.assertNumberMigrations(changes, 'testapp', 1)
1083.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1084.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='Contract', new_name='Deal')
1085. 
1086.     def test_rename_model_with_renamed_rel_field(self):
1087.         """
1088.         Tests autodetection of renamed models while simultaneously renaming one
1089.         of the fields that relate to the renamed model.
1090.         """
1091.         changes = self.get_changes(
1092.             [self.author_with_book, self.book],
1093.             [self.author_renamed_with_book, self.book_with_field_and_author_renamed],
1094.             MigrationQuestioner({"ask_rename": True, "ask_rename_model": True}),
1095.         )
1096.         # Right number/type of migrations?
1097.         self.assertNumberMigrations(changes, 'testapp', 1)
1098.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1099.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name="Author", new_name="Writer")
1100.         # Right number/type of migrations for related field rename?
1101.         # Alter is already taken care of.
1102.         self.assertNumberMigrations(changes, 'otherapp', 1)
1103.         self.assertOperationTypes(changes, 'otherapp', 0, ["RenameField"])
1104.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, old_name="author", new_name="writer")
1105. 
1106.     def test_rename_model_with_fks_in_different_position(self):
1107.         """
1108.         #24537 - The order of fields in a model does not influence
1109.         the RenameModel detection.
1110.         """
1111.         before = [
1112.             ModelState("testapp", "EntityA", [
1113.                 ("id", models.AutoField(primary_key=True)),
1114.             ]),
1115.             ModelState("testapp", "EntityB", [
1116.                 ("id", models.AutoField(primary_key=True)),
1117.                 ("some_label", models.CharField(max_length=255)),
1118.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1119.             ]),
1120.         ]
1121.         after = [
1122.             ModelState("testapp", "EntityA", [
1123.                 ("id", models.AutoField(primary_key=True)),
1124.             ]),
1125.             ModelState("testapp", "RenamedEntityB", [
1126.                 ("id", models.AutoField(primary_key=True)),
1127.                 ("entity_a", models.ForeignKey("testapp.EntityA", models.CASCADE)),
1128.                 ("some_label", models.CharField(max_length=255)),
1129.             ]),
1130.         ]
1131.         changes = self.get_changes(before, after, MigrationQuestioner({"ask_rename_model": True}))
1132.         self.assertNumberMigrations(changes, "testapp", 1)
1133.         self.assertOperationTypes(changes, "testapp", 0, ["RenameModel"])
1134.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="EntityB", new_name="RenamedEntityB")
1135. 
1136.     def test_rename_model_reverse_relation_dependencies(self):
1137.         """
1138.         The migration to rename a model pointed to by a foreign key in another
1139.         app must run after the other app's migration that adds the foreign key
1140.         with model's original name. Therefore, the renaming migration has a
1141.         dependency on that other migration.
1142.         """
1143.         before = [
1144.             ModelState('testapp', 'EntityA', [
1145.                 ('id', models.AutoField(primary_key=True)),
1146.             ]),
1147.             ModelState('otherapp', 'EntityB', [
1148.                 ('id', models.AutoField(primary_key=True)),
1149.                 ('entity_a', models.ForeignKey('testapp.EntityA', models.CASCADE)),
1150.             ]),
1151.         ]
1152.         after = [
1153.             ModelState('testapp', 'RenamedEntityA', [
1154.                 ('id', models.AutoField(primary_key=True)),
1155.             ]),
1156.             ModelState('otherapp', 'EntityB', [
1157.                 ('id', models.AutoField(primary_key=True)),
1158.                 ('entity_a', models.ForeignKey('testapp.RenamedEntityA', models.CASCADE)),
1159.             ]),
1160.         ]
1161.         changes = self.get_changes(before, after, MigrationQuestioner({'ask_rename_model': True}))
1162.         self.assertNumberMigrations(changes, 'testapp', 1)
1163.         self.assertMigrationDependencies(changes, 'testapp', 0, [('otherapp', '__first__')])
1164.         self.assertOperationTypes(changes, 'testapp', 0, ['RenameModel'])
1165.         self.assertOperationAttributes(changes, 'testapp', 0, 0, old_name='EntityA', new_name='RenamedEntityA')
1166. 
1167.     def test_fk_dependency(self):
1168.         """Having a ForeignKey automatically adds a dependency."""
1169.         # Note that testapp (author) has no dependencies,
1170.         # otherapp (book) depends on testapp (author),
1171.         # thirdapp (edition) depends on otherapp (book)
1172.         changes = self.get_changes([], [self.author_name, self.book, self.edition])
1173.         # Right number/type of migrations?
1174.         self.assertNumberMigrations(changes, 'testapp', 1)
1175.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1176.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1177.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1178.         # Right number/type of migrations?
1179.         self.assertNumberMigrations(changes, 'otherapp', 1)
1180.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1181.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1182.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("testapp", "auto_1")])
1183.         # Right number/type of migrations?
1184.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1185.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1186.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="Edition")
1187.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("otherapp", "auto_1")])
1188. 
1189.     def test_proxy_fk_dependency(self):
1190.         """FK dependencies still work on proxy models."""
1191.         # Note that testapp (author) has no dependencies,
1192.         # otherapp (book) depends on testapp (authorproxy)
1193.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1194.         # Right number/type of migrations?
1195.         self.assertNumberMigrations(changes, 'testapp', 1)
1196.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1197.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1198.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1199.         # Right number/type of migrations?
1200.         self.assertNumberMigrations(changes, 'otherapp', 1)
1201.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1202.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
1203.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("thirdapp", "auto_1")])
1204.         # Right number/type of migrations?
1205.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1206.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel"])
1207.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="AuthorProxy")
1208.         self.assertMigrationDependencies(changes, 'thirdapp', 0, [("testapp", "auto_1")])
1209. 
1210.     def test_same_app_no_fk_dependency(self):
1211.         """
1212.         A migration with a FK between two models of the same app
1213.         does not have a dependency to itself.
1214.         """
1215.         changes = self.get_changes([], [self.author_with_publisher, self.publisher])
1216.         # Right number/type of migrations?
1217.         self.assertNumberMigrations(changes, 'testapp', 1)
1218.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1219.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1220.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1221.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1222. 
1223.     def test_circular_fk_dependency(self):
1224.         """
1225.         Having a circular ForeignKey dependency automatically
1226.         resolves the situation into 2 migrations on one side and 1 on the other.
1227.         """
1228.         changes = self.get_changes([], [self.author_with_book, self.book, self.publisher_with_book])
1229.         # Right number/type of migrations?
1230.         self.assertNumberMigrations(changes, 'testapp', 1)
1231.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
1232.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Publisher")
1233.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
1234.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "auto_1")])
1235.         # Right number/type of migrations?
1236.         self.assertNumberMigrations(changes, 'otherapp', 2)
1237.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
1238.         self.assertOperationTypes(changes, 'otherapp', 1, ["AddField"])
1239.         self.assertMigrationDependencies(changes, 'otherapp', 0, [])
1240.         self.assertMigrationDependencies(changes, 'otherapp', 1, [("otherapp", "auto_1"), ("testapp", "auto_1")])
1241.         # both split migrations should be `initial`
1242.         self.assertTrue(changes['otherapp'][0].initial)
1243.         self.assertTrue(changes['otherapp'][1].initial)
1244. 
1245.     def test_same_app_circular_fk_dependency(self):
1246.         """
1247.         A migration with a FK between two models of the same app does
1248.         not have a dependency to itself.
1249.         """
1250.         changes = self.get_changes([], [self.author_with_publisher, self.publisher_with_author])
1251.         # Right number/type of migrations?
1252.         self.assertNumberMigrations(changes, 'testapp', 1)
1253.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "AddField"])
1254.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="Author")
1255.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Publisher")
1256.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="publisher")
1257.         self.assertMigrationDependencies(changes, 'testapp', 0, [])
1258. 
1259.     def test_same_app_circular_fk_dependency_with_unique_together_and_indexes(self):
1260.         """
1261.         #22275 - A migration with circular FK dependency does not try
1262.         to create unique together constraint and indexes before creating all
1263.         required fields first.
1264.         """
1265.         changes = self.get_changes([], [self.knight, self.rabbit])
1266.         # Right number/type of migrations?
1267.         self.assertNumberMigrations(changes, 'eggs', 1)
1268.         self.assertOperationTypes(
1269.             changes, 'eggs', 0, ["CreateModel", "CreateModel", "AddIndex", "AlterUniqueTogether"]
1270.         )
1271.         self.assertNotIn("unique_together", changes['eggs'][0].operations[0].options)
1272.         self.assertNotIn("unique_together", changes['eggs'][0].operations[1].options)
1273.         self.assertMigrationDependencies(changes, 'eggs', 0, [])
1274. 
1275.     def test_alter_db_table_add(self):
1276.         """Tests detection for adding db_table in model's options."""
1277.         changes = self.get_changes([self.author_empty], [self.author_with_db_table_options])
1278.         # Right number/type of migrations?
1279.         self.assertNumberMigrations(changes, 'testapp', 1)
1280.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1281.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_one")
1282. 
1283.     def test_alter_db_table_change(self):
1284.         """Tests detection for changing db_table in model's options'."""
1285.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_new_db_table_options])
1286.         # Right number/type of migrations?
1287.         self.assertNumberMigrations(changes, 'testapp', 1)
1288.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1289.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table="author_two")
1290. 
1291.     def test_alter_db_table_remove(self):
1292.         """Tests detection for removing db_table in model's options."""
1293.         changes = self.get_changes([self.author_with_db_table_options], [self.author_empty])
1294.         # Right number/type of migrations?
1295.         self.assertNumberMigrations(changes, 'testapp', 1)
1296.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelTable"])
1297.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", table=None)
1298. 
1299.     def test_alter_db_table_no_changes(self):
1300.         """
1301.         Alter_db_table doesn't generate a migration if no changes have been made.
1302.         """
1303.         changes = self.get_changes([self.author_with_db_table_options], [self.author_with_db_table_options])
1304.         # Right number of migrations?
1305.         self.assertEqual(len(changes), 0)
1306. 
1307.     def test_keep_db_table_with_model_change(self):
1308.         """
1309.         Tests when model changes but db_table stays as-is, autodetector must not
1310.         create more than one operation.
1311.         """
1312.         changes = self.get_changes(
1313.             [self.author_with_db_table_options],
1314.             [self.author_renamed_with_db_table_options],
1315.             MigrationQuestioner({"ask_rename_model": True}),
1316.         )
1317.         # Right number/type of migrations?
1318.         self.assertNumberMigrations(changes, 'testapp', 1)
1319.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel"])
1320.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1321. 
1322.     def test_alter_db_table_with_model_change(self):
1323.         """
1324.         Tests when model and db_table changes, autodetector must create two
1325.         operations.
1326.         """
1327.         changes = self.get_changes(
1328.             [self.author_with_db_table_options],
1329.             [self.author_renamed_with_new_db_table_options],
1330.             MigrationQuestioner({"ask_rename_model": True}),
1331.         )
1332.         # Right number/type of migrations?
1333.         self.assertNumberMigrations(changes, 'testapp', 1)
1334.         self.assertOperationTypes(changes, 'testapp', 0, ["RenameModel", "AlterModelTable"])
1335.         self.assertOperationAttributes(changes, "testapp", 0, 0, old_name="Author", new_name="NewAuthor")
1336.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="newauthor", table="author_three")
1337. 
1338.     def test_identical_regex_doesnt_alter(self):
1339.         from_state = ModelState(
1340.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1341.                 RegexValidator(
1342.                     re.compile('^[-a-zA-Z0-9_]+\\Z'),
1343.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1344.                     'invalid'
1345.                 )
1346.             ]))]
1347.         )
1348.         to_state = ModelState(
1349.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1350.         )
1351.         changes = self.get_changes([from_state], [to_state])
1352.         # Right number/type of migrations?
1353.         self.assertNumberMigrations(changes, "testapp", 0)
1354. 
1355.     def test_different_regex_does_alter(self):
1356.         from_state = ModelState(
1357.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[
1358.                 RegexValidator(
1359.                     re.compile('^[a-z]+\\Z', 32),
1360.                     'Enter a valid “slug” consisting of letters, numbers, underscores or hyphens.',
1361.                     'invalid'
1362.                 )
1363.             ]))]
1364.         )
1365.         to_state = ModelState(
1366.             "testapp", "model", [("id", models.AutoField(primary_key=True, validators=[validate_slug]))]
1367.         )
1368.         changes = self.get_changes([from_state], [to_state])
1369.         self.assertNumberMigrations(changes, "testapp", 1)
1370.         self.assertOperationTypes(changes, "testapp", 0, ["AlterField"])
1371. 
1372.     def test_empty_foo_together(self):
1373.         """
1374.         #23452 - Empty unique/index_together shouldn't generate a migration.
1375.         """
1376.         # Explicitly testing for not specified, since this is the case after
1377.         # a CreateModel operation w/o any definition on the original model
1378.         model_state_not_specified = ModelState("a", "model", [("id", models.AutoField(primary_key=True))])
1379.         # Explicitly testing for None, since this was the issue in #23452 after
1380.         # an AlterFooTogether operation with e.g. () as value
1381.         model_state_none = ModelState("a", "model", [
1382.             ("id", models.AutoField(primary_key=True))
1383.         ], {
1384.             "index_together": None,
1385.             "unique_together": None,
1386.         })
1387.         # Explicitly testing for the empty set, since we now always have sets.
1388.         # During removal (('col1', 'col2'),) --> () this becomes set([])
1389.         model_state_empty = ModelState("a", "model", [
1390.             ("id", models.AutoField(primary_key=True))
1391.         ], {
1392.             "index_together": set(),
1393.             "unique_together": set(),
1394.         })
1395. 
1396.         def test(from_state, to_state, msg):
1397.             changes = self.get_changes([from_state], [to_state])
1398.             if changes:
1399.                 ops = ', '.join(o.__class__.__name__ for o in changes['a'][0].operations)
1400.                 self.fail('Created operation(s) %s from %s' % (ops, msg))
1401. 
1402.         tests = (
1403.             (model_state_not_specified, model_state_not_specified, '"not specified" to "not specified"'),
1404.             (model_state_not_specified, model_state_none, '"not specified" to "None"'),
1405.             (model_state_not_specified, model_state_empty, '"not specified" to "empty"'),
1406.             (model_state_none, model_state_not_specified, '"None" to "not specified"'),
1407.             (model_state_none, model_state_none, '"None" to "None"'),
1408.             (model_state_none, model_state_empty, '"None" to "empty"'),
1409.             (model_state_empty, model_state_not_specified, '"empty" to "not specified"'),
1410.             (model_state_empty, model_state_none, '"empty" to "None"'),
1411.             (model_state_empty, model_state_empty, '"empty" to "empty"'),
1412.         )
1413. 
1414.         for t in tests:
1415.             test(*t)
1416. 
1417.     def test_create_model_with_indexes(self):
1418.         """Test creation of new model with indexes already defined."""
1419.         author = ModelState('otherapp', 'Author', [
1420.             ('id', models.AutoField(primary_key=True)),
1421.             ('name', models.CharField(max_length=200)),
1422.         ], {'indexes': [models.Index(fields=['name'], name='create_model_with_indexes_idx')]})
1423.         changes = self.get_changes([], [author])
1424.         added_index = models.Index(fields=['name'], name='create_model_with_indexes_idx')
1425.         # Right number of migrations?
1426.         self.assertEqual(len(changes['otherapp']), 1)
1427.         # Right number of actions?
1428.         migration = changes['otherapp'][0]
1429.         self.assertEqual(len(migration.operations), 2)
1430.         # Right actions order?
1431.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddIndex'])
1432.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1433.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', index=added_index)
1434. 
1435.     def test_add_indexes(self):
1436.         """Test change detection of new indexes."""
1437.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_indexes])
1438.         self.assertNumberMigrations(changes, 'otherapp', 1)
1439.         self.assertOperationTypes(changes, 'otherapp', 0, ['AddIndex'])
1440.         added_index = models.Index(fields=['author', 'title'], name='book_title_author_idx')
1441.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', index=added_index)
1442. 
1443.     def test_remove_indexes(self):
1444.         """Test change detection of removed indexes."""
1445.         changes = self.get_changes([self.author_empty, self.book_indexes], [self.author_empty, self.book])
1446.         # Right number/type of migrations?
1447.         self.assertNumberMigrations(changes, 'otherapp', 1)
1448.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex'])
1449.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1450. 
1451.     def test_order_fields_indexes(self):
1452.         """Test change detection of reordering of fields in indexes."""
1453.         changes = self.get_changes(
1454.             [self.author_empty, self.book_indexes], [self.author_empty, self.book_unordered_indexes]
1455.         )
1456.         self.assertNumberMigrations(changes, 'otherapp', 1)
1457.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveIndex', 'AddIndex'])
1458.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, model_name='book', name='book_title_author_idx')
1459.         added_index = models.Index(fields=['title', 'author'], name='book_author_title_idx')
1460.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='book', index=added_index)
1461. 
1462.     def test_create_model_with_check_constraint(self):
1463.         """Test creation of new model with constraints already defined."""
1464.         author = ModelState('otherapp', 'Author', [
1465.             ('id', models.AutoField(primary_key=True)),
1466.             ('name', models.CharField(max_length=200)),
1467.         ], {'constraints': [models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')]})
1468.         changes = self.get_changes([], [author])
1469.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1470.         # Right number of migrations?
1471.         self.assertEqual(len(changes['otherapp']), 1)
1472.         # Right number of actions?
1473.         migration = changes['otherapp'][0]
1474.         self.assertEqual(len(migration.operations), 2)
1475.         # Right actions order?
1476.         self.assertOperationTypes(changes, 'otherapp', 0, ['CreateModel', 'AddConstraint'])
1477.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='Author')
1478.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, model_name='author', constraint=added_constraint)
1479. 
1480.     def test_add_constraints(self):
1481.         """Test change detection of new constraints."""
1482.         changes = self.get_changes([self.author_name], [self.author_name_check_constraint])
1483.         self.assertNumberMigrations(changes, 'testapp', 1)
1484.         self.assertOperationTypes(changes, 'testapp', 0, ['AddConstraint'])
1485.         added_constraint = models.CheckConstraint(check=models.Q(name__contains='Bob'), name='name_contains_bob')
1486.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', constraint=added_constraint)
1487. 
1488.     def test_remove_constraints(self):
1489.         """Test change detection of removed constraints."""
1490.         changes = self.get_changes([self.author_name_check_constraint], [self.author_name])
1491.         # Right number/type of migrations?
1492.         self.assertNumberMigrations(changes, 'testapp', 1)
1493.         self.assertOperationTypes(changes, 'testapp', 0, ['RemoveConstraint'])
1494.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name='author', name='name_contains_bob')
1495. 
1496.     def test_add_foo_together(self):
1497.         """Tests index/unique_together detection."""
1498.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together])
1499.         # Right number/type of migrations?
1500.         self.assertNumberMigrations(changes, "otherapp", 1)
1501.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1502.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1503.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1504. 
1505.     def test_remove_foo_together(self):
1506.         """Tests index/unique_together detection."""
1507.         changes = self.get_changes([self.author_empty, self.book_foo_together], [self.author_empty, self.book])
1508.         # Right number/type of migrations?
1509.         self.assertNumberMigrations(changes, "otherapp", 1)
1510.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1511.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1512.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1513. 
1514.     def test_foo_together_remove_fk(self):
1515.         """Tests unique_together and field removal detection & ordering"""
1516.         changes = self.get_changes(
1517.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_with_no_author]
1518.         )
1519.         # Right number/type of migrations?
1520.         self.assertNumberMigrations(changes, "otherapp", 1)
1521.         self.assertOperationTypes(changes, "otherapp", 0, [
1522.             "AlterUniqueTogether", "AlterIndexTogether", "RemoveField"
1523.         ])
1524.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together=set())
1525.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together=set())
1526.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="author")
1527. 
1528.     def test_foo_together_no_changes(self):
1529.         """
1530.         index/unique_together doesn't generate a migration if no
1531.         changes have been made.
1532.         """
1533.         changes = self.get_changes(
1534.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together]
1535.         )
1536.         # Right number of migrations?
1537.         self.assertEqual(len(changes), 0)
1538. 
1539.     def test_foo_together_ordering(self):
1540.         """
1541.         index/unique_together also triggers on ordering changes.
1542.         """
1543.         changes = self.get_changes(
1544.             [self.author_empty, self.book_foo_together], [self.author_empty, self.book_foo_together_2]
1545.         )
1546.         # Right number/type of migrations?
1547.         self.assertNumberMigrations(changes, "otherapp", 1)
1548.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether"])
1549.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("title", "author")})
1550.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("title", "author")})
1551. 
1552.     def test_add_field_and_foo_together(self):
1553.         """
1554.         Added fields will be created before using them in index/unique_together.
1555.         """
1556.         changes = self.get_changes([self.author_empty, self.book], [self.author_empty, self.book_foo_together_3])
1557.         # Right number/type of migrations?
1558.         self.assertNumberMigrations(changes, "otherapp", 1)
1559.         self.assertOperationTypes(changes, "otherapp", 0, ["AddField", "AlterUniqueTogether", "AlterIndexTogether"])
1560.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={("title", "newfield")})
1561.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield")})
1562. 
1563.     def test_create_model_and_unique_together(self):
1564.         author = ModelState("otherapp", "Author", [
1565.             ("id", models.AutoField(primary_key=True)),
1566.             ("name", models.CharField(max_length=200)),
1567.         ])
1568.         book_with_author = ModelState("otherapp", "Book", [
1569.             ("id", models.AutoField(primary_key=True)),
1570.             ("author", models.ForeignKey("otherapp.Author", models.CASCADE)),
1571.             ("title", models.CharField(max_length=200)),
1572.         ], {
1573.             "index_together": {("title", "author")},
1574.             "unique_together": {("title", "author")},
1575.         })
1576.         changes = self.get_changes([self.book_with_no_author], [author, book_with_author])
1577.         # Right number of migrations?
1578.         self.assertEqual(len(changes['otherapp']), 1)
1579.         # Right number of actions?
1580.         migration = changes['otherapp'][0]
1581.         self.assertEqual(len(migration.operations), 4)
1582.         # Right actions order?
1583.         self.assertOperationTypes(
1584.             changes, 'otherapp', 0,
1585.             ['CreateModel', 'AddField', 'AlterUniqueTogether', 'AlterIndexTogether']
1586.         )
1587. 
1588.     def test_remove_field_and_foo_together(self):
1589.         """
1590.         Removed fields will be removed after updating index/unique_together.
1591.         """
1592.         changes = self.get_changes(
1593.             [self.author_empty, self.book_foo_together_3], [self.author_empty, self.book_foo_together]
1594.         )
1595.         # Right number/type of migrations?
1596.         self.assertNumberMigrations(changes, "otherapp", 1)
1597.         self.assertOperationTypes(changes, "otherapp", 0, ["AlterUniqueTogether", "AlterIndexTogether", "RemoveField"])
1598.         self.assertOperationAttributes(changes, "otherapp", 0, 0, name="book", unique_together={("author", "title")})
1599.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", index_together={("author", "title")})
1600.         self.assertOperationAttributes(changes, "otherapp", 0, 2, model_name="book", name="newfield")
1601. 
1602.     def test_rename_field_and_foo_together(self):
1603.         """
1604.         Removed fields will be removed after updating index/unique_together.
1605.         """
1606.         changes = self.get_changes(
1607.             [self.author_empty, self.book_foo_together_3],
1608.             [self.author_empty, self.book_foo_together_4],
1609.             MigrationQuestioner({"ask_rename": True}),
1610.         )
1611.         # Right number/type of migrations?
1612.         self.assertNumberMigrations(changes, "otherapp", 1)
1613.         self.assertOperationTypes(changes, "otherapp", 0, ["RenameField", "AlterUniqueTogether", "AlterIndexTogether"])
1614.         self.assertOperationAttributes(changes, "otherapp", 0, 1, name="book", unique_together={
1615.             ("title", "newfield2")
1616.         })
1617.         self.assertOperationAttributes(changes, "otherapp", 0, 2, name="book", index_together={("title", "newfield2")})
1618. 
1619.     def test_proxy(self):
1620.         """The autodetector correctly deals with proxy models."""
1621.         # First, we test adding a proxy model
1622.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_proxy])
1623.         # Right number/type of migrations?
1624.         self.assertNumberMigrations(changes, "testapp", 1)
1625.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel"])
1626.         self.assertOperationAttributes(
1627.             changes, "testapp", 0, 0, name="AuthorProxy", options={"proxy": True, "indexes": [], "constraints": []}
1628.         )
1629.         # Now, we test turning a proxy model into a non-proxy model
1630.         # It should delete the proxy then make the real one
1631.         changes = self.get_changes(
1632.             [self.author_empty, self.author_proxy], [self.author_empty, self.author_proxy_notproxy]
1633.         )
1634.         # Right number/type of migrations?
1635.         self.assertNumberMigrations(changes, "testapp", 1)
1636.         self.assertOperationTypes(changes, "testapp", 0, ["DeleteModel", "CreateModel"])
1637.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="AuthorProxy")
1638.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="AuthorProxy", options={})
1639. 
1640.     def test_proxy_custom_pk(self):
1641.         """
1642.         #23415 - The autodetector must correctly deal with custom FK on proxy
1643.         models.
1644.         """
1645.         # First, we test the default pk field name
1646.         changes = self.get_changes([], [self.author_empty, self.author_proxy_third, self.book_proxy_fk])
1647.         # The field name the FK on the book model points to
1648.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1649.         # Now, we test the custom pk field name
1650.         changes = self.get_changes([], [self.author_custom_pk, self.author_proxy_third, self.book_proxy_fk])
1651.         # The field name the FK on the book model points to
1652.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1653. 
1654.     def test_proxy_to_mti_with_fk_to_proxy(self):
1655.         # First, test the pk table and field name.
1656.         changes = self.get_changes(
1657.             [],
1658.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1659.         )
1660.         self.assertEqual(
1661.             changes['otherapp'][0].operations[0].fields[2][1].remote_field.model._meta.db_table,
1662.             'testapp_author',
1663.         )
1664.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1665. 
1666.         # Change AuthorProxy to use MTI.
1667.         changes = self.get_changes(
1668.             [self.author_empty, self.author_proxy_third, self.book_proxy_fk],
1669.             [self.author_empty, self.author_proxy_third_notproxy, self.book_proxy_fk],
1670.         )
1671.         # Right number/type of migrations for the AuthorProxy model?
1672.         self.assertNumberMigrations(changes, 'thirdapp', 1)
1673.         self.assertOperationTypes(changes, 'thirdapp', 0, ['DeleteModel', 'CreateModel'])
1674.         # Right number/type of migrations for the Book model with a FK to
1675.         # AuthorProxy?
1676.         self.assertNumberMigrations(changes, 'otherapp', 1)
1677.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1678.         # otherapp should depend on thirdapp.
1679.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('thirdapp', 'auto_1')])
1680.         # Now, test the pk table and field name.
1681.         self.assertEqual(
1682.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1683.             'thirdapp_authorproxy',
1684.         )
1685.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1686. 
1687.     def test_proxy_to_mti_with_fk_to_proxy_proxy(self):
1688.         # First, test the pk table and field name.
1689.         changes = self.get_changes(
1690.             [],
1691.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1692.         )
1693.         self.assertEqual(
1694.             changes['otherapp'][0].operations[0].fields[1][1].remote_field.model._meta.db_table,
1695.             'testapp_author',
1696.         )
1697.         self.assertEqual(changes['otherapp'][0].operations[0].fields[1][1].remote_field.field_name, 'id')
1698. 
1699.         # Change AuthorProxy to use MTI. FK still points to AAuthorProxyProxy,
1700.         # a proxy of AuthorProxy.
1701.         changes = self.get_changes(
1702.             [self.author_empty, self.author_proxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1703.             [self.author_empty, self.author_proxy_notproxy, self.author_proxy_proxy, self.book_proxy_proxy_fk],
1704.         )
1705.         # Right number/type of migrations for the AuthorProxy model?
1706.         self.assertNumberMigrations(changes, 'testapp', 1)
1707.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel', 'CreateModel'])
1708.         # Right number/type of migrations for the Book model with a FK to
1709.         # AAuthorProxyProxy?
1710.         self.assertNumberMigrations(changes, 'otherapp', 1)
1711.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
1712.         # otherapp should depend on testapp.
1713.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', 'auto_1')])
1714.         # Now, test the pk table and field name.
1715.         self.assertEqual(
1716.             changes['otherapp'][0].operations[0].field.remote_field.model._meta.db_table,
1717.             'testapp_authorproxy',
1718.         )
1719.         self.assertEqual(changes['otherapp'][0].operations[0].field.remote_field.field_name, 'author_ptr')
1720. 
1721.     def test_unmanaged_create(self):
1722.         """The autodetector correctly deals with managed models."""
1723.         # First, we test adding an unmanaged model
1724.         changes = self.get_changes([self.author_empty], [self.author_empty, self.author_unmanaged])
1725.         # Right number/type of migrations?
1726.         self.assertNumberMigrations(changes, 'testapp', 1)
1727.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1728.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="AuthorUnmanaged", options={"managed": False})
1729. 
1730.     def test_unmanaged_delete(self):
1731.         changes = self.get_changes([self.author_empty, self.author_unmanaged], [self.author_empty])
1732.         self.assertNumberMigrations(changes, 'testapp', 1)
1733.         self.assertOperationTypes(changes, 'testapp', 0, ['DeleteModel'])
1734. 
1735.     def test_unmanaged_to_managed(self):
1736.         # Now, we test turning an unmanaged model into a managed model
1737.         changes = self.get_changes(
1738.             [self.author_empty, self.author_unmanaged], [self.author_empty, self.author_unmanaged_managed]
1739.         )
1740.         # Right number/type of migrations?
1741.         self.assertNumberMigrations(changes, 'testapp', 1)
1742.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterModelOptions"])
1743.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="authorunmanaged", options={})
1744. 
1745.     def test_managed_to_unmanaged(self):
1746.         # Now, we turn managed to unmanaged.
1747.         changes = self.get_changes(
1748.             [self.author_empty, self.author_unmanaged_managed], [self.author_empty, self.author_unmanaged]
1749.         )
1750.         # Right number/type of migrations?
1751.         self.assertNumberMigrations(changes, 'testapp', 1)
1752.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
1753.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorunmanaged", options={"managed": False})
1754. 
1755.     def test_unmanaged_custom_pk(self):
1756.         """
1757.         #23415 - The autodetector must correctly deal with custom FK on
1758.         unmanaged models.
1759.         """
1760.         # First, we test the default pk field name
1761.         changes = self.get_changes([], [self.author_unmanaged_default_pk, self.book])
1762.         # The field name the FK on the book model points to
1763.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'id')
1764.         # Now, we test the custom pk field name
1765.         changes = self.get_changes([], [self.author_unmanaged_custom_pk, self.book])
1766.         # The field name the FK on the book model points to
1767.         self.assertEqual(changes['otherapp'][0].operations[0].fields[2][1].remote_field.field_name, 'pk_field')
1768. 
1769.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
1770.     def test_swappable(self):
1771.         with isolate_lru_cache(apps.get_swappable_settings_name):
1772.             changes = self.get_changes([self.custom_user], [self.custom_user, self.author_with_custom_user])
1773.         # Right number/type of migrations?
1774.         self.assertNumberMigrations(changes, 'testapp', 1)
1775.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1776.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
1777.         self.assertMigrationDependencies(changes, 'testapp', 0, [("__setting__", "AUTH_USER_MODEL")])
1778. 
1779.     def test_swappable_changed(self):
1780.         with isolate_lru_cache(apps.get_swappable_settings_name):
1781.             before = self.make_project_state([self.custom_user, self.author_with_user])
1782.             with override_settings(AUTH_USER_MODEL="thirdapp.CustomUser"):
1783.                 after = self.make_project_state([self.custom_user, self.author_with_custom_user])
1784.             autodetector = MigrationAutodetector(before, after)
1785.             changes = autodetector._detect_changes()
1786.         # Right number/type of migrations?
1787.         self.assertNumberMigrations(changes, 'testapp', 1)
1788.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1789.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name='user')
1790.         fk_field = changes['testapp'][0].operations[0].field
1791.         to_model = '%s.%s' % (
1792.             fk_field.remote_field.model._meta.app_label,
1793.             fk_field.remote_field.model._meta.object_name,
1794.         )
1795.         self.assertEqual(to_model, 'thirdapp.CustomUser')
1796. 
1797.     def test_add_field_with_default(self):
1798.         """#22030 - Adding a field with a default should work."""
1799.         changes = self.get_changes([self.author_empty], [self.author_name_default])
1800.         # Right number/type of migrations?
1801.         self.assertNumberMigrations(changes, 'testapp', 1)
1802.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1803.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="name")
1804. 
1805.     def test_custom_deconstructible(self):
1806.         """
1807.         Two instances which deconstruct to the same value aren't considered a
1808.         change.
1809.         """
1810.         changes = self.get_changes([self.author_name_deconstructible_1], [self.author_name_deconstructible_2])
1811.         # Right number of migrations?
1812.         self.assertEqual(len(changes), 0)
1813. 
1814.     def test_deconstruct_field_kwarg(self):
1815.         """Field instances are handled correctly by nested deconstruction."""
1816.         changes = self.get_changes([self.author_name_deconstructible_3], [self.author_name_deconstructible_4])
1817.         self.assertEqual(changes, {})
1818. 
1819.     def test_deconstructible_list(self):
1820.         """Nested deconstruction descends into lists."""
1821.         # When lists contain items that deconstruct to identical values, those lists
1822.         # should be considered equal for the purpose of detecting state changes
1823.         # (even if the original items are unequal).
1824.         changes = self.get_changes(
1825.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_2]
1826.         )
1827.         self.assertEqual(changes, {})
1828.         # Legitimate differences within the deconstructed lists should be reported
1829.         # as a change
1830.         changes = self.get_changes(
1831.             [self.author_name_deconstructible_list_1], [self.author_name_deconstructible_list_3]
1832.         )
1833.         self.assertEqual(len(changes), 1)
1834. 
1835.     def test_deconstructible_tuple(self):
1836.         """Nested deconstruction descends into tuples."""
1837.         # When tuples contain items that deconstruct to identical values, those tuples
1838.         # should be considered equal for the purpose of detecting state changes
1839.         # (even if the original items are unequal).
1840.         changes = self.get_changes(
1841.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_2]
1842.         )
1843.         self.assertEqual(changes, {})
1844.         # Legitimate differences within the deconstructed tuples should be reported
1845.         # as a change
1846.         changes = self.get_changes(
1847.             [self.author_name_deconstructible_tuple_1], [self.author_name_deconstructible_tuple_3]
1848.         )
1849.         self.assertEqual(len(changes), 1)
1850. 
1851.     def test_deconstructible_dict(self):
1852.         """Nested deconstruction descends into dict values."""
1853.         # When dicts contain items whose values deconstruct to identical values,
1854.         # those dicts should be considered equal for the purpose of detecting
1855.         # state changes (even if the original values are unequal).
1856.         changes = self.get_changes(
1857.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_2]
1858.         )
1859.         self.assertEqual(changes, {})
1860.         # Legitimate differences within the deconstructed dicts should be reported
1861.         # as a change
1862.         changes = self.get_changes(
1863.             [self.author_name_deconstructible_dict_1], [self.author_name_deconstructible_dict_3]
1864.         )
1865.         self.assertEqual(len(changes), 1)
1866. 
1867.     def test_nested_deconstructible_objects(self):
1868.         """
1869.         Nested deconstruction is applied recursively to the args/kwargs of
1870.         deconstructed objects.
1871.         """
1872.         # If the items within a deconstructed object's args/kwargs have the same
1873.         # deconstructed values - whether or not the items themselves are different
1874.         # instances - then the object as a whole is regarded as unchanged.
1875.         changes = self.get_changes(
1876.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_2]
1877.         )
1878.         self.assertEqual(changes, {})
1879.         # Differences that exist solely within the args list of a deconstructed object
1880.         # should be reported as changes
1881.         changes = self.get_changes(
1882.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_arg]
1883.         )
1884.         self.assertEqual(len(changes), 1)
1885.         # Additional args should also be reported as a change
1886.         changes = self.get_changes(
1887.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_arg]
1888.         )
1889.         self.assertEqual(len(changes), 1)
1890.         # Differences that exist solely within the kwargs dict of a deconstructed object
1891.         # should be reported as changes
1892.         changes = self.get_changes(
1893.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_changed_kwarg]
1894.         )
1895.         self.assertEqual(len(changes), 1)
1896.         # Additional kwargs should also be reported as a change
1897.         changes = self.get_changes(
1898.             [self.author_name_nested_deconstructible_1], [self.author_name_nested_deconstructible_extra_kwarg]
1899.         )
1900.         self.assertEqual(len(changes), 1)
1901. 
1902.     def test_deconstruct_type(self):
1903.         """
1904.         #22951 -- Uninstantiated classes with deconstruct are correctly returned
1905.         by deep_deconstruct during serialization.
1906.         """
1907.         author = ModelState(
1908.             "testapp",
1909.             "Author",
1910.             [
1911.                 ("id", models.AutoField(primary_key=True)),
1912.                 ("name", models.CharField(
1913.                     max_length=200,
1914.                     # IntegerField intentionally not instantiated.
1915.                     default=models.IntegerField,
1916.                 ))
1917.             ],
1918.         )
1919.         changes = self.get_changes([], [author])
1920.         # Right number/type of migrations?
1921.         self.assertNumberMigrations(changes, 'testapp', 1)
1922.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
1923. 
1924.     def test_replace_string_with_foreignkey(self):
1925.         """
1926.         #22300 - Adding an FK in the same "spot" as a deleted CharField should
1927.         work.
1928.         """
1929.         changes = self.get_changes([self.author_with_publisher_string], [self.author_with_publisher, self.publisher])
1930.         # Right number/type of migrations?
1931.         self.assertNumberMigrations(changes, 'testapp', 1)
1932.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "RemoveField", "AddField"])
1933.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Publisher")
1934.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publisher_name")
1935.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publisher")
1936. 
1937.     def test_foreign_key_removed_before_target_model(self):
1938.         """
1939.         Removing an FK and the model it targets in the same change must remove
1940.         the FK field before the model to maintain consistency.
1941.         """
1942.         changes = self.get_changes(
1943.             [self.author_with_publisher, self.publisher], [self.author_name]
1944.         )  # removes both the model and FK
1945.         # Right number/type of migrations?
1946.         self.assertNumberMigrations(changes, 'testapp', 1)
1947.         self.assertOperationTypes(changes, 'testapp', 0, ["RemoveField", "DeleteModel"])
1948.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publisher")
1949.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Publisher")
1950. 
1951.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
1952.                 side_effect=AssertionError("Should not have prompted for not null addition"))
1953.     def test_add_many_to_many(self, mocked_ask_method):
1954.         """#22435 - Adding a ManyToManyField should not prompt for a default."""
1955.         changes = self.get_changes([self.author_empty, self.publisher], [self.author_with_m2m, self.publisher])
1956.         # Right number/type of migrations?
1957.         self.assertNumberMigrations(changes, 'testapp', 1)
1958.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
1959.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1960. 
1961.     def test_alter_many_to_many(self):
1962.         changes = self.get_changes(
1963.             [self.author_with_m2m, self.publisher], [self.author_with_m2m_blank, self.publisher]
1964.         )
1965.         # Right number/type of migrations?
1966.         self.assertNumberMigrations(changes, 'testapp', 1)
1967.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterField"])
1968.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers")
1969. 
1970.     def test_create_with_through_model(self):
1971.         """
1972.         Adding a m2m with a through model and the models that use it should be
1973.         ordered correctly.
1974.         """
1975.         changes = self.get_changes([], [self.author_with_m2m_through, self.publisher, self.contract])
1976.         # Right number/type of migrations?
1977.         self.assertNumberMigrations(changes, "testapp", 1)
1978.         self.assertOperationTypes(changes, "testapp", 0, [
1979.             'CreateModel', 'CreateModel', 'CreateModel', 'AddField',
1980.         ])
1981.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Author')
1982.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name='Publisher')
1983.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Contract')
1984.         self.assertOperationAttributes(changes, 'testapp', 0, 3, model_name='author', name='publishers')
1985. 
1986.     def test_many_to_many_removed_before_through_model(self):
1987.         """
1988.         Removing a ManyToManyField and the "through" model in the same change
1989.         must remove the field before the model to maintain consistency.
1990.         """
1991.         changes = self.get_changes(
1992.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
1993.             [self.book_with_no_author, self.author_name],
1994.         )
1995.         # Remove both the through model and ManyToMany
1996.         # Right number/type of migrations?
1997.         self.assertNumberMigrations(changes, "otherapp", 1)
1998.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel'])
1999.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
2000.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
2001. 
2002.     def test_many_to_many_removed_before_through_model_2(self):
2003.         """
2004.         Removing a model that contains a ManyToManyField and the "through" model
2005.         in the same change must remove the field before the model to maintain
2006.         consistency.
2007.         """
2008.         changes = self.get_changes(
2009.             [self.book_with_multiple_authors_through_attribution, self.author_name, self.attribution],
2010.             [self.author_name],
2011.         )
2012.         # Remove both the through model and ManyToMany
2013.         # Right number/type of migrations?
2014.         self.assertNumberMigrations(changes, "otherapp", 1)
2015.         self.assertOperationTypes(changes, 'otherapp', 0, ['RemoveField', 'DeleteModel', 'DeleteModel'])
2016.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name='authors', model_name='book')
2017.         self.assertOperationAttributes(changes, 'otherapp', 0, 1, name='Attribution')
2018.         self.assertOperationAttributes(changes, 'otherapp', 0, 2, name='Book')
2019. 
2020.     def test_m2m_w_through_multistep_remove(self):
2021.         """
2022.         A model with a m2m field that specifies a "through" model cannot be
2023.         removed in the same migration as that through model as the schema will
2024.         pass through an inconsistent state. The autodetector should produce two
2025.         migrations to avoid this issue.
2026.         """
2027.         changes = self.get_changes([self.author_with_m2m_through, self.publisher, self.contract], [self.publisher])
2028.         # Right number/type of migrations?
2029.         self.assertNumberMigrations(changes, "testapp", 1)
2030.         self.assertOperationTypes(changes, "testapp", 0, [
2031.             "RemoveField", "RemoveField", "DeleteModel", "DeleteModel"
2032.         ])
2033.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='contract')
2034.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="publisher", model_name='contract')
2035.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Author")
2036.         self.assertOperationAttributes(changes, "testapp", 0, 3, name="Contract")
2037. 
2038.     def test_concrete_field_changed_to_many_to_many(self):
2039.         """
2040.         #23938 - Changing a concrete field into a ManyToManyField
2041.         first removes the concrete field and then adds the m2m field.
2042.         """
2043.         changes = self.get_changes([self.author_with_former_m2m], [self.author_with_m2m, self.publisher])
2044.         # Right number/type of migrations?
2045.         self.assertNumberMigrations(changes, "testapp", 1)
2046.         self.assertOperationTypes(changes, "testapp", 0, ["CreateModel", "RemoveField", "AddField"])
2047.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name='Publisher')
2048.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2049.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="publishers", model_name='author')
2050. 
2051.     def test_many_to_many_changed_to_concrete_field(self):
2052.         """
2053.         #23938 - Changing a ManyToManyField into a concrete field
2054.         first removes the m2m field and then adds the concrete field.
2055.         """
2056.         changes = self.get_changes([self.author_with_m2m, self.publisher], [self.author_with_former_m2m])
2057.         # Right number/type of migrations?
2058.         self.assertNumberMigrations(changes, "testapp", 1)
2059.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "AddField", "DeleteModel"])
2060.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="publishers", model_name='author')
2061.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="publishers", model_name='author')
2062.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name='Publisher')
2063.         self.assertOperationFieldAttributes(changes, 'testapp', 0, 1, max_length=100)
2064. 
2065.     def test_non_circular_foreignkey_dependency_removal(self):
2066.         """
2067.         If two models with a ForeignKey from one to the other are removed at the
2068.         same time, the autodetector should remove them in the correct order.
2069.         """
2070.         changes = self.get_changes([self.author_with_publisher, self.publisher_with_author], [])
2071.         # Right number/type of migrations?
2072.         self.assertNumberMigrations(changes, "testapp", 1)
2073.         self.assertOperationTypes(changes, "testapp", 0, ["RemoveField", "DeleteModel", "DeleteModel"])
2074.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", model_name='publisher')
2075.         self.assertOperationAttributes(changes, "testapp", 0, 1, name="Author")
2076.         self.assertOperationAttributes(changes, "testapp", 0, 2, name="Publisher")
2077. 
2078.     def test_alter_model_options(self):
2079.         """Changing a model's options should make a change."""
2080.         changes = self.get_changes([self.author_empty], [self.author_with_options])
2081.         # Right number/type of migrations?
2082.         self.assertNumberMigrations(changes, "testapp", 1)
2083.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2084.         self.assertOperationAttributes(changes, "testapp", 0, 0, options={
2085.             "permissions": [('can_hire', 'Can hire')],
2086.             "verbose_name": "Authi",
2087.         })
2088. 
2089.         # Changing them back to empty should also make a change
2090.         changes = self.get_changes([self.author_with_options], [self.author_empty])
2091.         # Right number/type of migrations?
2092.         self.assertNumberMigrations(changes, "testapp", 1)
2093.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2094.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="author", options={})
2095. 
2096.     def test_alter_model_options_proxy(self):
2097.         """Changing a proxy model's options should also make a change."""
2098.         changes = self.get_changes(
2099.             [self.author_proxy, self.author_empty], [self.author_proxy_options, self.author_empty]
2100.         )
2101.         # Right number/type of migrations?
2102.         self.assertNumberMigrations(changes, "testapp", 1)
2103.         self.assertOperationTypes(changes, "testapp", 0, ["AlterModelOptions"])
2104.         self.assertOperationAttributes(changes, "testapp", 0, 0, name="authorproxy", options={
2105.             "verbose_name": "Super Author"
2106.         })
2107. 
2108.     def test_set_alter_order_with_respect_to(self):
2109.         """Setting order_with_respect_to adds a field."""
2110.         changes = self.get_changes([self.book, self.author_with_book], [self.book, self.author_with_book_order_wrt])
2111.         # Right number/type of migrations?
2112.         self.assertNumberMigrations(changes, 'testapp', 1)
2113.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo"])
2114.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to="book")
2115. 
2116.     def test_add_alter_order_with_respect_to(self):
2117.         """
2118.         Setting order_with_respect_to when adding the FK too does
2119.         things in the right order.
2120.         """
2121.         changes = self.get_changes([self.author_name], [self.book, self.author_with_book_order_wrt])
2122.         # Right number/type of migrations?
2123.         self.assertNumberMigrations(changes, 'testapp', 1)
2124.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AlterOrderWithRespectTo"])
2125.         self.assertOperationAttributes(changes, 'testapp', 0, 0, model_name="author", name="book")
2126.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author", order_with_respect_to="book")
2127. 
2128.     def test_remove_alter_order_with_respect_to(self):
2129.         """
2130.         Removing order_with_respect_to when removing the FK too does
2131.         things in the right order.
2132.         """
2133.         changes = self.get_changes([self.book, self.author_with_book_order_wrt], [self.author_name])
2134.         # Right number/type of migrations?
2135.         self.assertNumberMigrations(changes, 'testapp', 1)
2136.         self.assertOperationTypes(changes, 'testapp', 0, ["AlterOrderWithRespectTo", "RemoveField"])
2137.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="author", order_with_respect_to=None)
2138.         self.assertOperationAttributes(changes, 'testapp', 0, 1, model_name="author", name="book")
2139. 
2140.     def test_add_model_order_with_respect_to(self):
2141.         """
2142.         Setting order_with_respect_to when adding the whole model
2143.         does things in the right order.
2144.         """
2145.         changes = self.get_changes([], [self.book, self.author_with_book_order_wrt])
2146.         # Right number/type of migrations?
2147.         self.assertNumberMigrations(changes, 'testapp', 1)
2148.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel"])
2149.         self.assertOperationAttributes(
2150.             changes, 'testapp', 0, 0, name="Author", options={'order_with_respect_to': 'book'}
2151.         )
2152.         self.assertNotIn("_order", [name for name, field in changes['testapp'][0].operations[0].fields])
2153. 
2154.     def test_alter_model_managers(self):
2155.         """
2156.         Changing the model managers adds a new operation.
2157.         """
2158.         changes = self.get_changes([self.other_pony], [self.other_pony_food])
2159.         # Right number/type of migrations?
2160.         self.assertNumberMigrations(changes, 'otherapp', 1)
2161.         self.assertOperationTypes(changes, 'otherapp', 0, ["AlterModelManagers"])
2162.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="pony")
2163.         self.assertEqual([name for name, mgr in changes['otherapp'][0].operations[0].managers],
2164.                          ['food_qs', 'food_mgr', 'food_mgr_kwargs'])
2165.         self.assertEqual(changes['otherapp'][0].operations[0].managers[1][1].args, ('a', 'b', 1, 2))
2166.         self.assertEqual(changes['otherapp'][0].operations[0].managers[2][1].args, ('x', 'y', 3, 4))
2167. 
2168.     def test_swappable_first_inheritance(self):
2169.         """Swappable models get their CreateModel first."""
2170.         changes = self.get_changes([], [self.custom_user, self.aardvark])
2171.         # Right number/type of migrations?
2172.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2173.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2174.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2175.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2176. 
2177.     def test_default_related_name_option(self):
2178.         model_state = ModelState('app', 'model', [
2179.             ('id', models.AutoField(primary_key=True)),
2180.         ], options={'default_related_name': 'related_name'})
2181.         changes = self.get_changes([], [model_state])
2182.         self.assertNumberMigrations(changes, 'app', 1)
2183.         self.assertOperationTypes(changes, 'app', 0, ['CreateModel'])
2184.         self.assertOperationAttributes(
2185.             changes, 'app', 0, 0, name='model',
2186.             options={'default_related_name': 'related_name'},
2187.         )
2188.         altered_model_state = ModelState('app', 'Model', [
2189.             ('id', models.AutoField(primary_key=True)),
2190.         ])
2191.         changes = self.get_changes([model_state], [altered_model_state])
2192.         self.assertNumberMigrations(changes, 'app', 1)
2193.         self.assertOperationTypes(changes, 'app', 0, ['AlterModelOptions'])
2194.         self.assertOperationAttributes(changes, 'app', 0, 0, name='model', options={})
2195. 
2196.     @override_settings(AUTH_USER_MODEL="thirdapp.CustomUser")
2197.     def test_swappable_first_setting(self):
2198.         """Swappable models get their CreateModel first."""
2199.         with isolate_lru_cache(apps.get_swappable_settings_name):
2200.             changes = self.get_changes([], [self.custom_user_no_inherit, self.aardvark])
2201.         # Right number/type of migrations?
2202.         self.assertNumberMigrations(changes, 'thirdapp', 1)
2203.         self.assertOperationTypes(changes, 'thirdapp', 0, ["CreateModel", "CreateModel"])
2204.         self.assertOperationAttributes(changes, 'thirdapp', 0, 0, name="CustomUser")
2205.         self.assertOperationAttributes(changes, 'thirdapp', 0, 1, name="Aardvark")
2206. 
2207.     def test_bases_first(self):
2208.         """Bases of other models come first."""
2209.         changes = self.get_changes([], [self.aardvark_based_on_author, self.author_name])
2210.         # Right number/type of migrations?
2211.         self.assertNumberMigrations(changes, 'testapp', 1)
2212.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2213.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2214.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2215. 
2216.     def test_multiple_bases(self):
2217.         """#23956 - Inheriting models doesn't move *_ptr fields into AddField operations."""
2218.         A = ModelState("app", "A", [("a_id", models.AutoField(primary_key=True))])
2219.         B = ModelState("app", "B", [("b_id", models.AutoField(primary_key=True))])
2220.         C = ModelState("app", "C", [], bases=("app.A", "app.B"))
2221.         D = ModelState("app", "D", [], bases=("app.A", "app.B"))
2222.         E = ModelState("app", "E", [], bases=("app.A", "app.B"))
2223.         changes = self.get_changes([], [A, B, C, D, E])
2224.         # Right number/type of migrations?
2225.         self.assertNumberMigrations(changes, "app", 1)
2226.         self.assertOperationTypes(changes, "app", 0, [
2227.             "CreateModel", "CreateModel", "CreateModel", "CreateModel", "CreateModel"
2228.         ])
2229.         self.assertOperationAttributes(changes, "app", 0, 0, name="A")
2230.         self.assertOperationAttributes(changes, "app", 0, 1, name="B")
2231.         self.assertOperationAttributes(changes, "app", 0, 2, name="C")
2232.         self.assertOperationAttributes(changes, "app", 0, 3, name="D")
2233.         self.assertOperationAttributes(changes, "app", 0, 4, name="E")
2234. 
2235.     def test_proxy_bases_first(self):
2236.         """Bases of proxies come first."""
2237.         changes = self.get_changes([], [self.author_empty, self.author_proxy, self.author_proxy_proxy])
2238.         # Right number/type of migrations?
2239.         self.assertNumberMigrations(changes, 'testapp', 1)
2240.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel", "CreateModel"])
2241.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2242.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="AuthorProxy")
2243.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="AAuthorProxyProxy")
2244. 
2245.     def test_pk_fk_included(self):
2246.         """
2247.         A relation used as the primary key is kept as part of CreateModel.
2248.         """
2249.         changes = self.get_changes([], [self.aardvark_pk_fk_author, self.author_name])
2250.         # Right number/type of migrations?
2251.         self.assertNumberMigrations(changes, 'testapp', 1)
2252.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "CreateModel"])
2253.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Author")
2254.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="Aardvark")
2255. 
2256.     def test_first_dependency(self):
2257.         """
2258.         A dependency to an app with no migrations uses __first__.
2259.         """
2260.         # Load graph
2261.         loader = MigrationLoader(connection)
2262.         before = self.make_project_state([])
2263.         after = self.make_project_state([self.book_migrations_fk])
2264.         after.real_apps = ["migrations"]
2265.         autodetector = MigrationAutodetector(before, after)
2266.         changes = autodetector._detect_changes(graph=loader.graph)
2267.         # Right number/type of migrations?
2268.         self.assertNumberMigrations(changes, 'otherapp', 1)
2269.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2270.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2271.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "__first__")])
2272. 
2273.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
2274.     def test_last_dependency(self):
2275.         """
2276.         A dependency to an app with existing migrations uses the
2277.         last migration of that app.
2278.         """
2279.         # Load graph
2280.         loader = MigrationLoader(connection)
2281.         before = self.make_project_state([])
2282.         after = self.make_project_state([self.book_migrations_fk])
2283.         after.real_apps = ["migrations"]
2284.         autodetector = MigrationAutodetector(before, after)
2285.         changes = autodetector._detect_changes(graph=loader.graph)
2286.         # Right number/type of migrations?
2287.         self.assertNumberMigrations(changes, 'otherapp', 1)
2288.         self.assertOperationTypes(changes, 'otherapp', 0, ["CreateModel"])
2289.         self.assertOperationAttributes(changes, 'otherapp', 0, 0, name="Book")
2290.         self.assertMigrationDependencies(changes, 'otherapp', 0, [("migrations", "0002_second")])
2291. 
2292.     def test_alter_fk_before_model_deletion(self):
2293.         """
2294.         ForeignKeys are altered _before_ the model they used to
2295.         refer to are deleted.
2296.         """
2297.         changes = self.get_changes(
2298.             [self.author_name, self.publisher_with_author],
2299.             [self.aardvark_testapp, self.publisher_with_aardvark_author]
2300.         )
2301.         # Right number/type of migrations?
2302.         self.assertNumberMigrations(changes, 'testapp', 1)
2303.         self.assertOperationTypes(changes, 'testapp', 0, ["CreateModel", "AlterField", "DeleteModel"])
2304.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="Aardvark")
2305.         self.assertOperationAttributes(changes, 'testapp', 0, 1, name="author")
2306.         self.assertOperationAttributes(changes, 'testapp', 0, 2, name="Author")
2307. 
2308.     def test_fk_dependency_other_app(self):
2309.         """
2310.         #23100 - ForeignKeys correctly depend on other apps' models.
2311.         """
2312.         changes = self.get_changes([self.author_name, self.book], [self.author_with_book, self.book])
2313.         # Right number/type of migrations?
2314.         self.assertNumberMigrations(changes, 'testapp', 1)
2315.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField"])
2316.         self.assertOperationAttributes(changes, 'testapp', 0, 0, name="book")
2317.         self.assertMigrationDependencies(changes, 'testapp', 0, [("otherapp", "__first__")])
2318. 
2319.     def test_alter_field_to_fk_dependency_other_app(self):
2320.         changes = self.get_changes(
2321.             [self.author_empty, self.book_with_no_author_fk],
2322.             [self.author_empty, self.book],
2323.         )
2324.         self.assertNumberMigrations(changes, 'otherapp', 1)
2325.         self.assertOperationTypes(changes, 'otherapp', 0, ['AlterField'])
2326.         self.assertMigrationDependencies(changes, 'otherapp', 0, [('testapp', '__first__')])
2327. 
2328.     def test_circular_dependency_mixed_addcreate(self):
2329.         """
2330.         #23315 - The dependency resolver knows to put all CreateModel
2331.         before AddField and not become unsolvable.
2332.         """
2333.         address = ModelState("a", "Address", [
2334.             ("id", models.AutoField(primary_key=True)),
2335.             ("country", models.ForeignKey("b.DeliveryCountry", models.CASCADE)),
2336.         ])
2337.         person = ModelState("a", "Person", [
2338.             ("id", models.AutoField(primary_key=True)),
2339.         ])
2340.         apackage = ModelState("b", "APackage", [
2341.             ("id", models.AutoField(primary_key=True)),
2342.             ("person", models.ForeignKey("a.Person", models.CASCADE)),
2343.         ])
2344.         country = ModelState("b", "DeliveryCountry", [
2345.             ("id", models.AutoField(primary_key=True)),
2346.         ])
2347.         changes = self.get_changes([], [address, person, apackage, country])
2348.         # Right number/type of migrations?
2349.         self.assertNumberMigrations(changes, 'a', 2)
2350.         self.assertNumberMigrations(changes, 'b', 1)
2351.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel", "CreateModel"])
2352.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2353.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel", "CreateModel"])
2354. 
2355.     @override_settings(AUTH_USER_MODEL="a.Tenant")
2356.     def test_circular_dependency_swappable(self):
2357.         """
2358.         #23322 - The dependency resolver knows to explicitly resolve
2359.         swappable models.
2360.         """
2361.         with isolate_lru_cache(apps.get_swappable_settings_name):
2362.             tenant = ModelState("a", "Tenant", [
2363.                 ("id", models.AutoField(primary_key=True)),
2364.                 ("primary_address", models.ForeignKey("b.Address", models.CASCADE))],
2365.                 bases=(AbstractBaseUser,)
2366.             )
2367.             address = ModelState("b", "Address", [
2368.                 ("id", models.AutoField(primary_key=True)),
2369.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2370.             ])
2371.             changes = self.get_changes([], [address, tenant])
2372. 
2373.         # Right number/type of migrations?
2374.         self.assertNumberMigrations(changes, 'a', 2)
2375.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2376.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2377.         self.assertMigrationDependencies(changes, 'a', 0, [])
2378.         self.assertMigrationDependencies(changes, 'a', 1, [('a', 'auto_1'), ('b', 'auto_1')])
2379.         # Right number/type of migrations?
2380.         self.assertNumberMigrations(changes, 'b', 1)
2381.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2382.         self.assertMigrationDependencies(changes, 'b', 0, [('__setting__', 'AUTH_USER_MODEL')])
2383. 
2384.     @override_settings(AUTH_USER_MODEL="b.Tenant")
2385.     def test_circular_dependency_swappable2(self):
2386.         """
2387.         #23322 - The dependency resolver knows to explicitly resolve
2388.         swappable models but with the swappable not being the first migrated
2389.         model.
2390.         """
2391.         with isolate_lru_cache(apps.get_swappable_settings_name):
2392.             address = ModelState("a", "Address", [
2393.                 ("id", models.AutoField(primary_key=True)),
2394.                 ("tenant", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE)),
2395.             ])
2396.             tenant = ModelState("b", "Tenant", [
2397.                 ("id", models.AutoField(primary_key=True)),
2398.                 ("primary_address", models.ForeignKey("a.Address", models.CASCADE))],
2399.                 bases=(AbstractBaseUser,)
2400.             )
2401.             changes = self.get_changes([], [address, tenant])
2402.         # Right number/type of migrations?
2403.         self.assertNumberMigrations(changes, 'a', 2)
2404.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2405.         self.assertOperationTypes(changes, 'a', 1, ["AddField"])
2406.         self.assertMigrationDependencies(changes, 'a', 0, [])
2407.         self.assertMigrationDependencies(changes, 'a', 1, [('__setting__', 'AUTH_USER_MODEL'), ('a', 'auto_1')])
2408.         # Right number/type of migrations?
2409.         self.assertNumberMigrations(changes, 'b', 1)
2410.         self.assertOperationTypes(changes, 'b', 0, ["CreateModel"])
2411.         self.assertMigrationDependencies(changes, 'b', 0, [('a', 'auto_1')])
2412. 
2413.     @override_settings(AUTH_USER_MODEL="a.Person")
2414.     def test_circular_dependency_swappable_self(self):
2415.         """
2416.         #23322 - The dependency resolver knows to explicitly resolve
2417.         swappable models.
2418.         """
2419.         with isolate_lru_cache(apps.get_swappable_settings_name):
2420.             person = ModelState("a", "Person", [
2421.                 ("id", models.AutoField(primary_key=True)),
2422.                 ("parent1", models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE, related_name='children'))
2423.             ])
2424.             changes = self.get_changes([], [person])
2425.         # Right number/type of migrations?
2426.         self.assertNumberMigrations(changes, 'a', 1)
2427.         self.assertOperationTypes(changes, 'a', 0, ["CreateModel"])
2428.         self.assertMigrationDependencies(changes, 'a', 0, [])
2429. 
2430.     @override_settings(AUTH_USER_MODEL='a.User')
2431.     def test_swappable_circular_multi_mti(self):
2432.         with isolate_lru_cache(apps.get_swappable_settings_name):
2433.             parent = ModelState('a', 'Parent', [
2434.                 ('user', models.ForeignKey(settings.AUTH_USER_MODEL, models.CASCADE))
2435.             ])
2436.             child = ModelState('a', 'Child', [], bases=('a.Parent',))
2437.             user = ModelState('a', 'User', [], bases=(AbstractBaseUser, 'a.Child'))
2438.             changes = self.get_changes([], [parent, child, user])
2439.         self.assertNumberMigrations(changes, 'a', 1)
2440.         self.assertOperationTypes(changes, 'a', 0, ['CreateModel', 'CreateModel', 'CreateModel', 'AddField'])
2441. 
2442.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition',
2443.                 side_effect=AssertionError("Should not have prompted for not null addition"))
2444.     def test_add_blank_textfield_and_charfield(self, mocked_ask_method):
2445.         """
2446.         #23405 - Adding a NOT NULL and blank `CharField` or `TextField`
2447.         without default should not prompt for a default.
2448.         """
2449.         changes = self.get_changes([self.author_empty], [self.author_with_biography_blank])
2450.         # Right number/type of migrations?
2451.         self.assertNumberMigrations(changes, 'testapp', 1)
2452.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2453.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2454. 
2455.     @mock.patch('django.db.migrations.questioner.MigrationQuestioner.ask_not_null_addition')
2456.     def test_add_non_blank_textfield_and_charfield(self, mocked_ask_method):
2457.         """
2458.         #23405 - Adding a NOT NULL and non-blank `CharField` or `TextField`
2459.         without default should prompt for a default.
2460.         """
2461.         changes = self.get_changes([self.author_empty], [self.author_with_biography_non_blank])
2462.         self.assertEqual(mocked_ask_method.call_count, 2)
2463.         # Right number/type of migrations?
2464.         self.assertNumberMigrations(changes, 'testapp', 1)
2465.         self.assertOperationTypes(changes, 'testapp', 0, ["AddField", "AddField"])
2466.         self.assertOperationAttributes(changes, 'testapp', 0, 0)
2467. 
2468.     def test_mti_inheritance_model_removal(self):
2469.         Animal = ModelState('app', 'Animal', [
2470.             ("id", models.AutoField(primary_key=True)),
2471.         ])
2472.         Dog = ModelState('app', 'Dog', [], bases=('app.Animal',))
2473.         changes = self.get_changes([Animal, Dog], [Animal])
2474.         self.assertNumberMigrations(changes, 'app', 1)
2475.         self.assertOperationTypes(changes, 'app', 0, ['DeleteModel'])
2476.         self.assertOperationAttributes(changes, 'app', 0, 0, name='Dog')
2477. 
2478.     def test_add_model_with_field_removed_from_base_model(self):
2479.         """
2480.         Removing a base field takes place before adding a new inherited model
2481.         that has a field with the same name.
2482.         """
2483.         before = [
2484.             ModelState('app', 'readable', [
2485.                 ('id', models.AutoField(primary_key=True)),
2486.                 ('title', models.CharField(max_length=200)),
2487.             ]),
2488.         ]
2489.         after = [
2490.             ModelState('app', 'readable', [
2491.                 ('id', models.AutoField(primary_key=True)),
2492.             ]),
2493.             ModelState('app', 'book', [
2494.                 ('title', models.CharField(max_length=200)),
2495.             ], bases=('app.readable',)),
2496.         ]
2497.         changes = self.get_changes(before, after)
2498.         self.assertNumberMigrations(changes, 'app', 1)
2499.         self.assertOperationTypes(changes, 'app', 0, ['RemoveField', 'CreateModel'])
2500.         self.assertOperationAttributes(changes, 'app', 0, 0, name='title', model_name='readable')
2501.         self.assertOperationAttributes(changes, 'app', 0, 1, name='book')
2502. 
2503. 
2504. class MigrationSuggestNameTests(SimpleTestCase):
2505.     def test_single_operation(self):
2506.         class Migration(migrations.Migration):
2507.             operations = [migrations.CreateModel('Person', fields=[])]
2508. 
2509.         migration = Migration('0001_initial', 'test_app')
2510.         self.assertEqual(migration.suggest_name(), 'person')
2511. 
2512.         class Migration(migrations.Migration):
2513.             operations = [migrations.DeleteModel('Person')]
2514. 
2515.         migration = Migration('0002_initial', 'test_app')
2516.         self.assertEqual(migration.suggest_name(), 'delete_person')
2517. 
2518.     def test_two_create_models(self):
2519.         class Migration(migrations.Migration):
2520.             operations = [
2521.                 migrations.CreateModel('Person', fields=[]),
2522.                 migrations.CreateModel('Animal', fields=[]),
2523.             ]
2524. 
2525.         migration = Migration('0001_initial', 'test_app')
2526.         self.assertEqual(migration.suggest_name(), 'animal_person')
2527. 
2528.     def test_two_create_models_with_initial_true(self):
2529.         class Migration(migrations.Migration):
2530.             initial = True
2531.             operations = [
2532.                 migrations.CreateModel('Person', fields=[]),
2533.                 migrations.CreateModel('Animal', fields=[]),
2534.             ]
2535. 
2536.         migration = Migration('0001_initial', 'test_app')
2537.         self.assertEqual(migration.suggest_name(), 'animal_person')
2538. 
2539.     def test_none_name(self):
2540.         class Migration(migrations.Migration):
2541.             operations = [migrations.RunSQL('SELECT 1 FROM person;')]
2542. 
2543.         migration = Migration('0001_initial', 'test_app')
2544.         suggest_name = migration.suggest_name()
2545.         self.assertIs(suggest_name.startswith('auto_'), True)
2546. 
2547.     def test_none_name_with_initial_true(self):
2548.         class Migration(migrations.Migration):
2549.             initial = True
2550.             operations = [migrations.RunSQL('SELECT 1 FROM person;')]
2551. 
2552.         migration = Migration('0001_initial', 'test_app')
2553.         self.assertEqual(migration.suggest_name(), 'initial')
2554. 
2555.     def test_auto(self):
2556.         migration = migrations.Migration('0001_initial', 'test_app')
2557.         suggest_name = migration.suggest_name()
2558.         self.assertIs(suggest_name.startswith('auto_'), True)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 04:40:19,926 - thread-133303881418432.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have analyzed the user's request and the provided context. The user is experiencing an issue with `makemigrations` when using a `ForeignKey` in an app with a mixed-case name. The problem lies in how the `ForeignKey` is deconstructed, which is handled by `ForeignObject.deconstruct`. The provided context contains `tests/field_deconstruction/tests.py` and `tests/migrations/test_autodetector.py`. \n\n1.  `tests/field_deconstruction/tests.py` includes `test_foreign_key`, which directly tests the deconstruction of `ForeignKey` fields. This is highly relevant as the bug is in the deconstruction logic.\n2.  `tests/migrations/test_autodetector.py` includes tests for the migration autodetector, which is the component that fails for the user. Specifically, `test_same_app_no_fk_dependency` tests a scenario with a `ForeignKey` to a model in the same app, which is very similar to the user's situation. `test_fk_dependency` tests `ForeignKey`s across different apps, which is also relevant to ensure the fix is robust.\n\nTherefore, the provided context is sufficient to identify and extract relevant test cases. I do not need to request additional context." query='' extra_requirements='' purpose=''
2025-12-23 04:40:19,927 - thread-133303881418432.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
