2025-12-21 13:18:20,750 - thread-139084754323136.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: `PolyElement.as_expr()` not accepting symbols

Description: The method `PolyElement.as_expr()`

https://github.com/sympy/sympy/blob/193e3825645d93c73e31cdceb6d742cc6919624d/sympy/polys/rings.py#L618-L624

is supposed to let you set the symbols you want to use, but, as it stands, either you pass the wrong number of symbols, and get an error message, or you pass the right number of symbols, and it ignores them, using `self.ring.symbols` instead:

```python
>>> from sympy import ring, ZZ, symbols
>>> R, x, y, z = ring("x,y,z", ZZ)
>>> f = 3*x**2*y - x*y*z + 7*z**3 + 1
>>> U, V, W = symbols("u,v,w")
>>> f.as_expr(U, V, W)
3*x**2*y - x*y*z + 7*z**3 + 1
```

Patch information:
diff --git a/sympy/polys/rings.py b/sympy/polys/rings.py
index 12bd2fc920..cc8becab8e 100644
--- a/sympy/polys/rings.py
+++ b/sympy/polys/rings.py
@@ -616,8 +616,9 @@ def set_ring(self, new_ring):
             return new_ring.from_dict(self, self.ring.domain)
 
     def as_expr(self, *symbols):
-        if symbols and len(symbols) != self.ring.ngens:
-            raise ValueError("not enough symbols, expected %s got %s" % (self.ring.ngens, len(symbols)))
+        if symbols:
+            if len(symbols) != self.ring.ngens:
+                raise ValueError("expected %s symbols, got %s" % (self.ring.ngens, len(symbols)))
         else:
             symbols = self.ring.symbols
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 13:18:20,822 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .circleci
|   └── config.yml
├── .github
|   └── workflows
|       ├── checkconflict.yml
|       ├── ci-sage.yml
|       ├── comment-on-pr.yml
|       ├── docs-preview.yml
|       ├── release.yml
|       └── runtests.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.md
├── bin
|   ├── ask_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_check.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_optional_dependencies.py
|   ├── test_py2_import.py
|   ├── test_setup.py
|   ├── test_sphinx.sh
|   ├── test_submodule_imports.py
|   ├── test_symengine.py
|   └── test_tensorflow.py
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── aptinstall.sh
|   ├── cheatsheet
|   ├── ext
|   |   ├── convert-svg-to-pdf.py
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   └── numpydoc.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   ├── requirements.txt
|   └── src
|       ├── _pygments
|       |   └── styles.py
|       ├── _static
|       |   └── custom.css
|       ├── _templates
|       |   └── sidebar
|       |       └── versions.html
|       ├── citing.md
|       ├── conf.py
|       ├── contributing
|       |   ├── build-docs.rst
|       |   ├── debug.rst
|       |   ├── dependencies.md
|       |   ├── deprecations.md
|       |   ├── dev-setup.rst
|       |   ├── docstring.rst
|       |   ├── documentation-style-guide.rst
|       |   ├── index.rst
|       |   └── make-a-contribution.rst
|       ├── explanation
|       |   ├── active-deprecations.md
|       |   ├── glossary.md
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── solve_output.rst
|       |   └── special_topics
|       |       ├── classification.rst
|       |       ├── finite_diff_derivatives.rst
|       |       └── index.rst
|       ├── guides
|       |   ├── assumptions.rst
|       |   ├── booleans.rst
|       |   ├── custom-functions.md
|       |   ├── index.rst
|       |   └── solving
|       |       ├── find-roots-polynomial.md
|       |       ├── index.md
|       |       ├── reduce-inequalities-algebraically.md
|       |       ├── solve-diophantine-equation.md
|       |       ├── solve-equation-algebraically.md
|       |       ├── solve-matrix-equation.md
|       |       ├── solve-numerically.md
|       |       ├── solve-ode.md
|       |       ├── solve-system-of-equations-algebraically.md
|       |       └── solving-guidance.md
|       ├── index.rst
|       ├── install.md
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── index.rst
|       |   |   ├── predicates.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── group_numbers.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   ├── index.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── normalforms.rst
|       |   |   ├── sparse.rst
|       |   |   └── sparsetools.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── control
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── domainmatrix.rst
|       |   |   ├── domainsintro.rst
|       |   |   ├── domainsref.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── numberfields.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   ├── solvers.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── fu.rst
|       |   |   ├── hyperexpand.rst
|       |   |   ├── index.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── index.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── array_expressions.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── testing
|       |   |   ├── index.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   └── runtests.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── exceptions.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       ├── intro.rst
|       |       └── vector_integration.rst
|       ├── pics
|       ├── reference
|       |   ├── index.rst
|       |   └── public
|       |       ├── basics
|       |       ├── codegeneration
|       |       ├── logic
|       |       ├── matrices
|       |       ├── numbertheory
|       |       ├── physics
|       |       ├── topics
|       |       └── utilities
|       └── tutorials
|           ├── index.rst
|           └── intro-tutorial
|               ├── basic_operations.rst
|               ├── calculus.rst
|               ├── features.rst
|               ├── gotchas.rst
|               ├── index.rst
|               ├── intro.rst
|               ├── manipulation.rst
|               ├── matrices.rst
|               ├── next.rst
|               ├── preliminaries.rst
|               ├── printing.rst
|               ├── simplification.rst
|               └── solvers.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── README.md
|   ├── authors.py
|   ├── build_docs.py
|   ├── ci_release_script.sh
|   ├── compare_tar_against_git.py
|   ├── github_release.py
|   ├── helpers.py
|   ├── releasecheck.py
|   ├── sha256.py
|   └── update_docs.py
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── facts.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── predicates
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── relation
    |   |   ├── __init__.py
    |   |   ├── binrel.py
    |   |   └── equality.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_assumptions_2.py
    |   |   ├── test_context.py
    |   |   ├── test_matrices.py
    |   |   ├── test_query.py
    |   |   ├── test_refine.py
    |   |   ├── test_satask.py
    |   |   ├── test_sathandlers.py
    |   |   └── test_wrapper.py
    |   └── wrapper.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── accumulationbounds.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_accumulationbounds.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── abstract_nodes.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── numpy_nodes.py
    |   ├── pynodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   ├── scipy_nodes.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_abstract_nodes.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_numpy_nodes.py
    |       ├── test_pynodes.py
    |       ├── test_pyutils.py
    |       ├── test_rewriting.py
    |       └── test_scipy_nodes.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── group_numbers.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── schur_number.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_group_numbers.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_schur_number.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── _print_helpers.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── assumptions_generated.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── kind.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── parameters.py
    |   ├── power.py
    |   ├── random.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── sorting.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_kind.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_parameters.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_random.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_sorting.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_traversal.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   ├── trace.py
    |   └── traversal.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── gmpy.py
    |   ├── importtools.py
    |   ├── pythonmpq.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_pythonmpq.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── printing.py
    |   ├── session.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_interactive.py
    |   |   └── test_ipython.py
    |   └── traversal.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   ├── minisat22_wrapper.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── decompositions.py
    |   ├── dense.py
    |   ├── determinant.py
    |   ├── eigen.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── _shape.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── companion.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── sets.py
    |   |   ├── slice.py
    |   |   ├── special.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_companion.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_sets.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_special.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── graph.py
    |   ├── immutable.py
    |   ├── inverse.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── reductions.py
    |   ├── repmatrix.py
    |   ├── solvers.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   ├── subspaces.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_commonmatrix.py
    |   |   ├── test_decompositions.py
    |   |   ├── test_determinant.py
    |   |   ├── test_eigen.py
    |   |   ├── test_graph.py
    |   |   ├── test_immutable.py
    |   |   ├── test_interactions.py
    |   |   ├── test_matrices.py
    |   |   ├── test_normalforms.py
    |   |   ├── test_reductions.py
    |   |   ├── test_solvers.py
    |   |   ├── test_sparse.py
    |   |   ├── test_sparsetools.py
    |   |   └── test_subspaces.py
    |   └── utilities.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── digits.py
    |   ├── ecm.py
    |   ├── egyptian_fraction.py
    |   ├── elliptic_curve.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── qs.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_digits.py
    |       ├── test_ecm.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_elliptic_curve.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       ├── test_qs.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _build_autolev_antlr.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── README.txt
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_beam.py
    |   |   |   └── test_truss.py
    |   |   └── truss.py
    |   ├── control
    |   |   ├── __init__.py
    |   |   ├── control_plots.py
    |   |   ├── lti.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_control_plots.py
    |   |       └── test_lti.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── joint.py
    |   |   ├── jointsmethod.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── method.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_joint.py
    |   |       ├── test_jointsmethod.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_method.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_anticommutator.py
    |   |   |   ├── test_boson.py
    |   |   |   ├── test_cartesian.py
    |   |   |   ├── test_cg.py
    |   |   |   ├── test_circuitplot.py
    |   |   |   ├── test_circuitutils.py
    |   |   |   ├── test_commutator.py
    |   |   |   ├── test_constants.py
    |   |   |   ├── test_dagger.py
    |   |   |   ├── test_density.py
    |   |   |   ├── test_fermion.py
    |   |   |   ├── test_gate.py
    |   |   |   ├── test_grover.py
    |   |   |   ├── test_hilbert.py
    |   |   |   ├── test_identitysearch.py
    |   |   |   ├── test_innerproduct.py
    |   |   |   ├── test_matrixutils.py
    |   |   |   ├── test_operator.py
    |   |   |   ├── test_operatorordering.py
    |   |   |   ├── test_operatorset.py
    |   |   |   ├── test_pauli.py
    |   |   |   ├── test_piab.py
    |   |   |   ├── test_printing.py
    |   |   |   ├── test_qapply.py
    |   |   |   ├── test_qasm.py
    |   |   |   ├── test_qexpr.py
    |   |   |   ├── test_qft.py
    |   |   |   ├── test_qubit.py
    |   |   |   ├── test_represent.py
    |   |   |   ├── test_sho1d.py
    |   |   |   ├── test_shor.py
    |   |   |   ├── test_spin.py
    |   |   |   ├── test_state.py
    |   |   |   ├── test_tensorproduct.py
    |   |   |   └── test_trace.py
    |   |   └── trace.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── appellseqs.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domainmatrix.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── expressionrawdomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gaussiandomains.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── matrices
    |   |   ├── __init__.py
    |   |   ├── ddm.py
    |   |   ├── dense.py
    |   |   ├── domainmatrix.py
    |   |   ├── domainscalar.py
    |   |   ├── eigen.py
    |   |   ├── exceptions.py
    |   |   ├── linsolve.py
    |   |   ├── normalforms.py
    |   |   ├── sdm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_ddm.py
    |   |       ├── test_dense.py
    |   |       ├── test_domainmatrix.py
    |   |       ├── test_domainscalar.py
    |   |       ├── test_eigen.py
    |   |       ├── test_linsolve.py
    |   |       ├── test_normalforms.py
    |   |       └── test_sdm.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields
    |   |   ├── __init__.py
    |   |   ├── basis.py
    |   |   ├── exceptions.py
    |   |   ├── minpoly.py
    |   |   ├── modules.py
    |   |   ├── primes.py
    |   |   ├── subfield.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_basis.py
    |   |   |   ├── test_minpoly.py
    |   |   |   ├── test_modules.py
    |   |   |   ├── test_numbers.py
    |   |   |   ├── test_primes.py
    |   |   |   ├── test_subfield.py
    |   |   |   └── test_utilities.py
    |   |   └── utilities.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_appellseqs.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── aesaracode.py
    |   ├── c.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxx.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fortran.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── numpy.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── smtlib.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_aesaracode.py
    |   |   ├── test_c.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cupy.py
    |   |   ├── test_cxx.py
    |   |   ├── test_dot.py
    |   |   ├── test_fortran.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jax.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_smtlib.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── comparison.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine
    |   |   ├── __init__.py
    |   |   ├── diophantine.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_diophantine.py
    |   ├── inequalities.py
    |   ├── ode
    |   |   ├── __init__.py
    |   |   ├── hypergeometric.py
    |   |   ├── lie_group.py
    |   |   ├── nonhomogeneous.py
    |   |   ├── ode.py
    |   |   ├── riccati.py
    |   |   ├── single.py
    |   |   ├── subscheck.py
    |   |   ├── systems.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_lie_group.py
    |   |       ├── test_ode.py
    |   |       ├── test_riccati.py
    |   |       ├── test_single.py
    |   |       ├── test_subscheck.py
    |   |       └── test_systems.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── compound_rv.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── matrix_distributions.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── sampling
    |   |   ├── __init__.py
    |   |   ├── sample_numpy.py
    |   |   ├── sample_pymc.py
    |   |   ├── sample_scipy.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_sample_continuous_rv.py
    |   |       ├── test_sample_discrete_rv.py
    |   |       └── test_sample_finite_rv.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_multivariate_probability.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_compound_rv.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_matrix_distributions.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       ├── test_symbolic_multivariate.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── array_derivatives.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── expressions
    |   |   |   ├── __init__.py
    |   |   |   ├── array_expressions.py
    |   |   |   ├── arrayexpr_derivatives.py
    |   |   |   ├── conv_array_to_indexed.py
    |   |   |   ├── conv_array_to_matrix.py
    |   |   |   ├── conv_indexed_to_array.py
    |   |   |   ├── conv_matrix_to_array.py
    |   |   |   ├── from_array_to_indexed.py
    |   |   |   ├── from_array_to_matrix.py
    |   |   |   ├── from_indexed_to_array.py
    |   |   |   ├── from_matrix_to_array.py
    |   |   |   ├── tests
    |   |   |   └── utils.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_array_derivatives.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_printing.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── testing
    |   ├── __init__.py
    |   ├── matrices.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_module_imports.py
    |   |   └── test_pytest.py
    |   └── tmpfiles.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_matchpy_connector.py
    |   |   ├── test_misc.py
    |   |   ├── test_pickling.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── implicitregion.py
        ├── integrals.py
        ├── operators.py
        ├── orienters.py
        ├── parametricregion.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_implicitregion.py
        |   ├── test_integrals.py
        |   ├── test_operators.py
        |   ├── test_parametricregion.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: `PolyElement.as_expr()` not accepting symbols

Description: The method `PolyElement.as_expr()`

https://github.com/sympy/sympy/blob/193e3825645d93c73e31cdceb6d742cc6919624d/sympy/polys/rings.py#L618-L624

is supposed to let you set the symbols you want to use, but, as it stands, either you pass the wrong number of symbols, and get an error message, or you pass the right number of symbols, and it ignores them, using `self.ring.symbols` instead:

```python
>>> from sympy import ring, ZZ, symbols
>>> R, x, y, z = ring("x,y,z", ZZ)
>>> f = 3*x**2*y - x*y*z + 7*z**3 + 1
>>> U, V, W = symbols("u,v,w")
>>> f.as_expr(U, V, W)
3*x**2*y - x*y*z + 7*z**3 + 1
```

Patch information:
diff --git a/sympy/polys/rings.py b/sympy/polys/rings.py
index 12bd2fc920..cc8becab8e 100644
--- a/sympy/polys/rings.py
+++ b/sympy/polys/rings.py
@@ -616,8 +616,9 @@ def set_ring(self, new_ring):
             return new_ring.from_dict(self, self.ring.domain)
 
     def as_expr(self, *symbols):
-        if symbols and len(symbols) != self.ring.ngens:
-            raise ValueError("not enough symbols, expected %s got %s" % (self.ring.ngens, len(symbols)))
+        if symbols:
+            if len(symbols) != self.ring.ngens:
+                raise ValueError("expected %s symbols, got %s" % (self.ring.ngens, len(symbols)))
         else:
             symbols = self.ring.symbols
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 13:18:30,088 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to the `PolyElement.as_expr()` method. The bug report indicates the issue is in `sympy/polys/rings.py`. The most relevant tests are likely in the corresponding test file, `sympy/polys/tests/test_rings.py`. I need the content of this file to find the test cases that exercise the `as_expr` method.' query='Please provide the full content of the file `sympy/polys/tests/test_rings.py`.' extra_requirements='' purpose="I need to find relevant test cases for the `as_expr` method in `PolyElement` to address the user's request."
2025-12-21 13:18:30,089 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `sympy/polys/tests/test_rings.py`.
2025-12-21 13:18:30,089 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 13:18:30,090 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 13:18:30,090 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 13:18:30,090 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `sympy/polys/tests/test_rings.py`.
Purpose: I need to find relevant test cases for the `as_expr` method in `PolyElement` to address the user's request.
2025-12-21 13:18:32,807 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the entire content of the `sympy/polys/tests/test_rings.py` file. This will allow me to examine the test cases related to the `as_expr` method in `PolyElement` and find the most relevant examples to address the user's request." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/polys/tests/test_rings.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2093, 'candidates_token_count': 87, 'total_token_count': 2295, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2093}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 115, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09475911896804283, 'model_name': 'gemini-2.5-pro'} id='run--4a01eb05-cca0-46dd-9129-628fff00e077-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/polys/tests/test_rings.py'}, 'id': '444a191f-f9f7-420a-ae6e-ed8ca9616561', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2093, 'output_tokens': 87, 'total_tokens': 2295, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 115}}
2025-12-21 13:18:35,766 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the first 500 lines of the file `sympy/polys/tests/test_rings.py`. I will now read the remaining content of the file to provide the complete version as requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1000.0, "relative_path": "sympy/polys/tests/test_rings.py", "start_line": 501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11589, 'candidates_token_count': 77, 'total_token_count': 11806, 'cached_content_token_count': 1880, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11589}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1880}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 77}], 'thoughts_token_count': 140}, 'finish_reason': 'STOP', 'avg_logprobs': -0.19947189479679256, 'model_name': 'gemini-2.5-pro'} id='run--b5780455-7d8a-43dd-bbe0-a97e398649f3-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1000.0, 'relative_path': 'sympy/polys/tests/test_rings.py', 'start_line': 501.0}, 'id': 'efde5baf-00ae-4908-b0d3-4c867cb5da69', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11589, 'output_tokens': 77, 'total_tokens': 11806, 'input_token_details': {'cache_read': 1880}, 'output_token_details': {'reasoning': 140}}
2025-12-21 13:18:42,652 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have now retrieved the full content of `sympy/polys/tests/test_rings.py` by reading the file in two parts. This complete view of the test file will enable me to thoroughly analyze the existing tests for the `as_expr` method and identify the best examples for the user's needs." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1500.0, "relative_path": "sympy/polys/tests/test_rings.py", "start_line": 1001.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 24514, 'candidates_token_count': 98, 'total_token_count': 24969, 'cached_content_token_count': 11724, 'prompt_tokens_details': [{'modality': 1, 'token_count': 24514}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11724}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 98}], 'thoughts_token_count': 357}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5385814978151905, 'model_name': 'gemini-2.5-pro'} id='run--84363bcf-04bb-4112-8e02-06155af50424-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1500.0, 'relative_path': 'sympy/polys/tests/test_rings.py', 'start_line': 1001.0}, 'id': 'bb14fc0f-8f44-4cd3-b1e5-8d882f941f0b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 24514, 'output_tokens': 98, 'total_tokens': 24969, 'input_token_details': {'cache_read': 11724}, 'output_token_details': {'reasoning': 357}}
2025-12-21 13:18:48,195 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the `sympy/polys/tests/test_rings.py` file. I started by reading the first 500 lines, and then proceeded to read the remaining lines in subsequent chunks. This approach allowed me to gather the complete file content, which I can now use to find the relevant test cases for the `as_expr` method in `PolyElement`.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 332, 'end_index': 641, 'uri': 'https://github.com/tsndiffopera/sympy', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 32815, 'candidates_token_count': 84, 'total_token_count': 33318, 'cached_content_token_count': 23648, 'prompt_tokens_details': [{'modality': 1, 'token_count': 32815}], 'cache_tokens_details': [{'modality': 1, 'token_count': 23648}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 84}], 'thoughts_token_count': 419}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4069243385678246, 'model_name': 'gemini-2.5-pro'} id='run--b7e05695-9fe5-4a8a-8d3a-07b15333d67e-0' usage_metadata={'input_tokens': 32815, 'output_tokens': 84, 'total_tokens': 33318, 'input_token_details': {'cache_read': 23648}, 'output_token_details': {'reasoning': 419}}
2025-12-21 13:18:48,198 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `sympy/polys/tests/test_rings.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find relevant test cases for the `as_expr` method in `PolyElement` to address the user's request.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/polys/tests/test_rings.py
Line number range: 1 - 500
Content:
1. """Test sparse polynomials. """
2. 
3. from functools import reduce
4. from operator import add, mul
5. 
6. from sympy.polys.rings import ring, xring, sring, PolyRing, PolyElement
7. from sympy.polys.fields import field, FracField
8. from sympy.polys.domains import ZZ, QQ, RR, FF, EX
9. from sympy.polys.orderings import lex, grlex
10. from sympy.polys.polyerrors import GeneratorsError, \
11.     ExactQuotientFailed, MultivariatePolynomialError, CoercionFailed
12. 
13. from sympy.testing.pytest import raises
14. from sympy.core import Symbol, symbols
15. 
16. from sympy.core.numbers import (oo, pi)
17. from sympy.functions.elementary.exponential import exp
18. from sympy.functions.elementary.miscellaneous import sqrt
19. 
20. def test_PolyRing___init__():
21.     x, y, z, t = map(Symbol, "xyzt")
22. 
23.     assert len(PolyRing("x,y,z", ZZ, lex).gens) == 3
24.     assert len(PolyRing(x, ZZ, lex).gens) == 1
25.     assert len(PolyRing(("x", "y", "z"), ZZ, lex).gens) == 3
26.     assert len(PolyRing((x, y, z), ZZ, lex).gens) == 3
27.     assert len(PolyRing("", ZZ, lex).gens) == 0
28.     assert len(PolyRing([], ZZ, lex).gens) == 0
29. 
30.     raises(GeneratorsError, lambda: PolyRing(0, ZZ, lex))
31. 
32.     assert PolyRing("x", ZZ[t], lex).domain == ZZ[t]
33.     assert PolyRing("x", 'ZZ[t]', lex).domain == ZZ[t]
34.     assert PolyRing("x", PolyRing("t", ZZ, lex), lex).domain == ZZ[t]
35. 
36.     raises(GeneratorsError, lambda: PolyRing("x", PolyRing("x", ZZ, lex), lex))
37. 
38.     _lex = Symbol("lex")
39.     assert PolyRing("x", ZZ, lex).order == lex
40.     assert PolyRing("x", ZZ, _lex).order == lex
41.     assert PolyRing("x", ZZ, 'lex').order == lex
42. 
43.     R1 = PolyRing("x,y", ZZ, lex)
44.     R2 = PolyRing("x,y", ZZ, lex)
45.     R3 = PolyRing("x,y,z", ZZ, lex)
46. 
47.     assert R1.x == R1.gens[0]
48.     assert R1.y == R1.gens[1]
49.     assert R1.x == R2.x
50.     assert R1.y == R2.y
51.     assert R1.x != R3.x
52.     assert R1.y != R3.y
53. 
54. def test_PolyRing___hash__():
55.     R, x, y, z = ring("x,y,z", QQ)
56.     assert hash(R)
57. 
58. def test_PolyRing___eq__():
59.     assert ring("x,y,z", QQ)[0] == ring("x,y,z", QQ)[0]
60.     assert ring("x,y,z", QQ)[0] is ring("x,y,z", QQ)[0]
61. 
62.     assert ring("x,y,z", QQ)[0] != ring("x,y,z", ZZ)[0]
63.     assert ring("x,y,z", QQ)[0] is not ring("x,y,z", ZZ)[0]
64. 
65.     assert ring("x,y,z", ZZ)[0] != ring("x,y,z", QQ)[0]
66.     assert ring("x,y,z", ZZ)[0] is not ring("x,y,z", QQ)[0]
67. 
68.     assert ring("x,y,z", QQ)[0] != ring("x,y", QQ)[0]
69.     assert ring("x,y,z", QQ)[0] is not ring("x,y", QQ)[0]
70. 
71.     assert ring("x,y", QQ)[0] != ring("x,y,z", QQ)[0]
72.     assert ring("x,y", QQ)[0] is not ring("x,y,z", QQ)[0]
73. 
74. def test_PolyRing_ring_new():
75.     R, x, y, z = ring("x,y,z", QQ)
76. 
77.     assert R.ring_new(7) == R(7)
78.     assert R.ring_new(7*x*y*z) == 7*x*y*z
79. 
80.     f = x**2 + 2*x*y + 3*x + 4*z**2 + 5*z + 6
81. 
82.     assert R.ring_new([[[1]], [[2], [3]], [[4, 5, 6]]]) == f
83.     assert R.ring_new({(2, 0, 0): 1, (1, 1, 0): 2, (1, 0, 0): 3, (0, 0, 2): 4, (0, 0, 1): 5, (0, 0, 0): 6}) == f
84.     assert R.ring_new([((2, 0, 0), 1), ((1, 1, 0), 2), ((1, 0, 0), 3), ((0, 0, 2), 4), ((0, 0, 1), 5), ((0, 0, 0), 6)]) == f
85. 
86.     R, = ring("", QQ)
87.     assert R.ring_new([((), 7)]) == R(7)
88. 
89. def test_PolyRing_drop():
90.     R, x,y,z = ring("x,y,z", ZZ)
91. 
92.     assert R.drop(x) == PolyRing("y,z", ZZ, lex)
93.     assert R.drop(y) == PolyRing("x,z", ZZ, lex)
94.     assert R.drop(z) == PolyRing("x,y", ZZ, lex)
95. 
96.     assert R.drop(0) == PolyRing("y,z", ZZ, lex)
97.     assert R.drop(0).drop(0) == PolyRing("z", ZZ, lex)
98.     assert R.drop(0).drop(0).drop(0) == ZZ
99. 
100.     assert R.drop(1) == PolyRing("x,z", ZZ, lex)
101. 
102.     assert R.drop(2) == PolyRing("x,y", ZZ, lex)
103.     assert R.drop(2).drop(1) == PolyRing("x", ZZ, lex)
104.     assert R.drop(2).drop(1).drop(0) == ZZ
105. 
106.     raises(ValueError, lambda: R.drop(3))
107.     raises(ValueError, lambda: R.drop(x).drop(y))
108. 
109. def test_PolyRing___getitem__():
110.     R, x,y,z = ring("x,y,z", ZZ)
111. 
112.     assert R[0:] == PolyRing("x,y,z", ZZ, lex)
113.     assert R[1:] == PolyRing("y,z", ZZ, lex)
114.     assert R[2:] == PolyRing("z", ZZ, lex)
115.     assert R[3:] == ZZ
116. 
117. def test_PolyRing_is_():
118.     R = PolyRing("x", QQ, lex)
119. 
120.     assert R.is_univariate is True
121.     assert R.is_multivariate is False
122. 
123.     R = PolyRing("x,y,z", QQ, lex)
124. 
125.     assert R.is_univariate is False
126.     assert R.is_multivariate is True
127. 
128.     R = PolyRing("", QQ, lex)
129. 
130.     assert R.is_univariate is False
131.     assert R.is_multivariate is False
132. 
133. def test_PolyRing_add():
134.     R, x = ring("x", ZZ)
135.     F = [ x**2 + 2*i + 3 for i in range(4) ]
136. 
137.     assert R.add(F) == reduce(add, F) == 4*x**2 + 24
138. 
139.     R, = ring("", ZZ)
140. 
141.     assert R.add([2, 5, 7]) == 14
142. 
143. def test_PolyRing_mul():
144.     R, x = ring("x", ZZ)
145.     F = [ x**2 + 2*i + 3 for i in range(4) ]
146. 
147.     assert R.mul(F) == reduce(mul, F) == x**8 + 24*x**6 + 206*x**4 + 744*x**2 + 945
148. 
149.     R, = ring("", ZZ)
150. 
151.     assert R.mul([2, 3, 5]) == 30
152. 
153. def test_sring():
154.     x, y, z, t = symbols("x,y,z,t")
155. 
156.     R = PolyRing("x,y,z", ZZ, lex)
157.     assert sring(x + 2*y + 3*z) == (R, R.x + 2*R.y + 3*R.z)
158. 
159.     R = PolyRing("x,y,z", QQ, lex)
160.     assert sring(x + 2*y + z/3) == (R, R.x + 2*R.y + R.z/3)
161.     assert sring([x, 2*y, z/3]) == (R, [R.x, 2*R.y, R.z/3])
162. 
163.     Rt = PolyRing("t", ZZ, lex)
164.     R = PolyRing("x,y,z", Rt, lex)
165.     assert sring(x + 2*t*y + 3*t**2*z, x, y, z) == (R, R.x + 2*Rt.t*R.y + 3*Rt.t**2*R.z)
166. 
167.     Rt = PolyRing("t", QQ, lex)
168.     R = PolyRing("x,y,z", Rt, lex)
169.     assert sring(x + t*y/2 + t**2*z/3, x, y, z) == (R, R.x + Rt.t*R.y/2 + Rt.t**2*R.z/3)
170. 
171.     Rt = FracField("t", ZZ, lex)
172.     R = PolyRing("x,y,z", Rt, lex)
173.     assert sring(x + 2*y/t + t**2*z/3, x, y, z) == (R, R.x + 2*R.y/Rt.t + Rt.t**2*R.z/3)
174. 
175.     r = sqrt(2) - sqrt(3)
176.     R, a = sring(r, extension=True)
177.     assert R.domain == QQ.algebraic_field(sqrt(2) + sqrt(3))
178.     assert R.gens == ()
179.     assert a == R.domain.from_sympy(r)
180. 
181. def test_PolyElement___hash__():
182.     R, x, y, z = ring("x,y,z", QQ)
183.     assert hash(x*y*z)
184. 
185. def test_PolyElement___eq__():
186.     R, x, y = ring("x,y", ZZ, lex)
187. 
188.     assert ((x*y + 5*x*y) == 6) == False
189.     assert ((x*y + 5*x*y) == 6*x*y) == True
190.     assert (6 == (x*y + 5*x*y)) == False
191.     assert (6*x*y == (x*y + 5*x*y)) == True
192. 
193.     assert ((x*y - x*y) == 0) == True
194.     assert (0 == (x*y - x*y)) == True
195. 
196.     assert ((x*y - x*y) == 1) == False
197.     assert (1 == (x*y - x*y)) == False
198. 
199.     assert ((x*y - x*y) == 1) == False
200.     assert (1 == (x*y - x*y)) == False
201. 
202.     assert ((x*y + 5*x*y) != 6) == True
203.     assert ((x*y + 5*x*y) != 6*x*y) == False
204.     assert (6 != (x*y + 5*x*y)) == True
205.     assert (6*x*y != (x*y + 5*x*y)) == False
206. 
207.     assert ((x*y - x*y) != 0) == False
208.     assert (0 != (x*y - x*y)) == False
209. 
210.     assert ((x*y - x*y) != 1) == True
211.     assert (1 != (x*y - x*y)) == True
212. 
213.     assert R.one == QQ(1, 1) == R.one
214.     assert R.one == 1 == R.one
215. 
216.     Rt, t = ring("t", ZZ)
217.     R, x, y = ring("x,y", Rt)
218. 
219.     assert (t**3*x/x == t**3) == True
220.     assert (t**3*x/x == t**4) == False
221. 
222. def test_PolyElement__lt_le_gt_ge__():
223.     R, x, y = ring("x,y", ZZ)
224. 
225.     assert R(1) < x < x**2 < x**3
226.     assert R(1) <= x <= x**2 <= x**3
227. 
228.     assert x**3 > x**2 > x > R(1)
229.     assert x**3 >= x**2 >= x >= R(1)
230. 
231. def test_PolyElement__str__():
232.     x, y = symbols('x, y')
233. 
234.     for dom in [ZZ, QQ, ZZ[x], ZZ[x,y], ZZ[x][y]]:
235.         R, t = ring('t', dom)
236.         assert str(2*t**2 + 1) == '2*t**2 + 1'
237. 
238.     for dom in [EX, EX[x]]:
239.         R, t = ring('t', dom)
240.         assert str(2*t**2 + 1) == 'EX(2)*t**2 + EX(1)'
241. 
242. def test_PolyElement_copy():
243.     R, x, y, z = ring("x,y,z", ZZ)
244. 
245.     f = x*y + 3*z
246.     g = f.copy()
247. 
248.     assert f == g
249.     g[(1, 1, 1)] = 7
250.     assert f != g
251. 
252. def test_PolyElement_as_expr():
253.     R, x, y, z = ring("x,y,z", ZZ)
254.     f = 3*x**2*y - x*y*z + 7*z**3 + 1
255. 
256.     X, Y, Z = R.symbols
257.     g = 3*X**2*Y - X*Y*Z + 7*Z**3 + 1
258. 
259.     assert f != g
260.     assert f.as_expr() == g
261. 
262.     X, Y, Z = symbols("x,y,z")
263.     g = 3*X**2*Y - X*Y*Z + 7*Z**3 + 1
264. 
265.     assert f != g
266.     assert f.as_expr(X, Y, Z) == g
267. 
268.     raises(ValueError, lambda: f.as_expr(X))
269. 
270.     R, = ring("", ZZ)
271.     assert R(3).as_expr() == 3
272. 
273. def test_PolyElement_from_expr():
274.     x, y, z = symbols("x,y,z")
275.     R, X, Y, Z = ring((x, y, z), ZZ)
276. 
277.     f = R.from_expr(1)
278.     assert f == 1 and isinstance(f, R.dtype)
279. 
280.     f = R.from_expr(x)
281.     assert f == X and isinstance(f, R.dtype)
282. 
283.     f = R.from_expr(x*y*z)
284.     assert f == X*Y*Z and isinstance(f, R.dtype)
285. 
286.     f = R.from_expr(x*y*z + x*y + x)
287.     assert f == X*Y*Z + X*Y + X and isinstance(f, R.dtype)
288. 
289.     f = R.from_expr(x**3*y*z + x**2*y**7 + 1)
290.     assert f == X**3*Y*Z + X**2*Y**7 + 1 and isinstance(f, R.dtype)
291. 
292.     r, F = sring([exp(2)])
293.     f = r.from_expr(exp(2))
294.     assert f == F[0] and isinstance(f, r.dtype)
295. 
296.     raises(ValueError, lambda: R.from_expr(1/x))
297.     raises(ValueError, lambda: R.from_expr(2**x))
298.     raises(ValueError, lambda: R.from_expr(7*x + sqrt(2)))
299. 
300.     R, = ring("", ZZ)
301.     f = R.from_expr(1)
302.     assert f == 1 and isinstance(f, R.dtype)
303. 
304. def test_PolyElement_degree():
305.     R, x,y,z = ring("x,y,z", ZZ)
306. 
307.     assert R(0).degree() is -oo
308.     assert R(1).degree() == 0
309.     assert (x + 1).degree() == 1
310.     assert (2*y**3 + z).degree() == 0
311.     assert (x*y**3 + z).degree() == 1
312.     assert (x**5*y**3 + z).degree() == 5
313. 
314.     assert R(0).degree(x) is -oo
315.     assert R(1).degree(x) == 0
316.     assert (x + 1).degree(x) == 1
317.     assert (2*y**3 + z).degree(x) == 0
318.     assert (x*y**3 + z).degree(x) == 1
319.     assert (7*x**5*y**3 + z).degree(x) == 5
320. 
321.     assert R(0).degree(y) is -oo
322.     assert R(1).degree(y) == 0
323.     assert (x + 1).degree(y) == 0
324.     assert (2*y**3 + z).degree(y) == 3
325.     assert (x*y**3 + z).degree(y) == 3
326.     assert (7*x**5*y**3 + z).degree(y) == 3
327. 
328.     assert R(0).degree(z) is -oo
329.     assert R(1).degree(z) == 0
330.     assert (x + 1).degree(z) == 0
331.     assert (2*y**3 + z).degree(z) == 1
332.     assert (x*y**3 + z).degree(z) == 1
333.     assert (7*x**5*y**3 + z).degree(z) == 1
334. 
335.     R, = ring("", ZZ)
336.     assert R(0).degree() is -oo
337.     assert R(1).degree() == 0
338. 
339. def test_PolyElement_tail_degree():
340.     R, x,y,z = ring("x,y,z", ZZ)
341. 
342.     assert R(0).tail_degree() is -oo
343.     assert R(1).tail_degree() == 0
344.     assert (x + 1).tail_degree() == 0
345.     assert (2*y**3 + x**3*z).tail_degree() == 0
346.     assert (x*y**3 + x**3*z).tail_degree() == 1
347.     assert (x**5*y**3 + x**3*z).tail_degree() == 3
348. 
349.     assert R(0).tail_degree(x) is -oo
350.     assert R(1).tail_degree(x) == 0
351.     assert (x + 1).tail_degree(x) == 0
352.     assert (2*y**3 + x**3*z).tail_degree(x) == 0
353.     assert (x*y**3 + x**3*z).tail_degree(x) == 1
354.     assert (7*x**5*y**3 + x**3*z).tail_degree(x) == 3
355. 
356.     assert R(0).tail_degree(y) is -oo
357.     assert R(1).tail_degree(y) == 0
358.     assert (x + 1).tail_degree(y) == 0
359.     assert (2*y**3 + x**3*z).tail_degree(y) == 0
360.     assert (x*y**3 + x**3*z).tail_degree(y) == 0
361.     assert (7*x**5*y**3 + x**3*z).tail_degree(y) == 0
362. 
363.     assert R(0).tail_degree(z) is -oo
364.     assert R(1).tail_degree(z) == 0
365.     assert (x + 1).tail_degree(z) == 0
366.     assert (2*y**3 + x**3*z).tail_degree(z) == 0
367.     assert (x*y**3 + x**3*z).tail_degree(z) == 0
368.     assert (7*x**5*y**3 + x**3*z).tail_degree(z) == 0
369. 
370.     R, = ring("", ZZ)
371.     assert R(0).tail_degree() is -oo
372.     assert R(1).tail_degree() == 0
373. 
374. def test_PolyElement_degrees():
375.     R, x,y,z = ring("x,y,z", ZZ)
376. 
377.     assert R(0).degrees() == (-oo, -oo, -oo)
378.     assert R(1).degrees() == (0, 0, 0)
379.     assert (x**2*y + x**3*z**2).degrees() == (3, 1, 2)
380. 
381. def test_PolyElement_tail_degrees():
382.     R, x,y,z = ring("x,y,z", ZZ)
383. 
384.     assert R(0).tail_degrees() == (-oo, -oo, -oo)
385.     assert R(1).tail_degrees() == (0, 0, 0)
386.     assert (x**2*y + x**3*z**2).tail_degrees() == (2, 0, 0)
387. 
388. def test_PolyElement_coeff():
389.     R, x, y, z = ring("x,y,z", ZZ, lex)
390.     f = 3*x**2*y - x*y*z + 7*z**3 + 23
391. 
392.     assert f.coeff(1) == 23
393.     raises(ValueError, lambda: f.coeff(3))
394. 
395.     assert f.coeff(x) == 0
396.     assert f.coeff(y) == 0
397.     assert f.coeff(z) == 0
398. 
399.     assert f.coeff(x**2*y) == 3
400.     assert f.coeff(x*y*z) == -1
401.     assert f.coeff(z**3) == 7
402. 
403.     raises(ValueError, lambda: f.coeff(3*x**2*y))
404.     raises(ValueError, lambda: f.coeff(-x*y*z))
405.     raises(ValueError, lambda: f.coeff(7*z**3))
406. 
407.     R, = ring("", ZZ)
408.     assert R(3).coeff(1) == 3
409. 
410. def test_PolyElement_LC():
411.     R, x, y = ring("x,y", QQ, lex)
412.     assert R(0).LC == QQ(0)
413.     assert (QQ(1,2)*x).LC == QQ(1, 2)
414.     assert (QQ(1,4)*x*y + QQ(1,2)*x).LC == QQ(1, 4)
415. 
416. def test_PolyElement_LM():
417.     R, x, y = ring("x,y", QQ, lex)
418.     assert R(0).LM == (0, 0)
419.     assert (QQ(1,2)*x).LM == (1, 0)
420.     assert (QQ(1,4)*x*y + QQ(1,2)*x).LM == (1, 1)
421. 
422. def test_PolyElement_LT():
423.     R, x, y = ring("x,y", QQ, lex)
424.     assert R(0).LT == ((0, 0), QQ(0))
425.     assert (QQ(1,2)*x).LT == ((1, 0), QQ(1, 2))
426.     assert (QQ(1,4)*x*y + QQ(1,2)*x).LT == ((1, 1), QQ(1, 4))
427. 
428.     R, = ring("", ZZ)
429.     assert R(0).LT == ((), 0)
430.     assert R(1).LT == ((), 1)
431. 
432. def test_PolyElement_leading_monom():
433.     R, x, y = ring("x,y", QQ, lex)
434.     assert R(0).leading_monom() == 0
435.     assert (QQ(1,2)*x).leading_monom() == x
436.     assert (QQ(1,4)*x*y + QQ(1,2)*x).leading_monom() == x*y
437. 
438. def test_PolyElement_leading_term():
439.     R, x, y = ring("x,y", QQ, lex)
440.     assert R(0).leading_term() == 0
441.     assert (QQ(1,2)*x).leading_term() == QQ(1,2)*x
442.     assert (QQ(1,4)*x*y + QQ(1,2)*x).leading_term() == QQ(1,4)*x*y
443. 
444. def test_PolyElement_terms():
445.     R, x,y,z = ring("x,y,z", QQ)
446.     terms = (x**2/3 + y**3/4 + z**4/5).terms()
447.     assert terms == [((2,0,0), QQ(1,3)), ((0,3,0), QQ(1,4)), ((0,0,4), QQ(1,5))]
448. 
449.     R, x,y = ring("x,y", ZZ, lex)
450.     f = x*y**7 + 2*x**2*y**3
451. 
452.     assert f.terms() == f.terms(lex) == f.terms('lex') == [((2, 3), 2), ((1, 7), 1)]
453.     assert f.terms(grlex) == f.terms('grlex') == [((1, 7), 1), ((2, 3), 2)]
454. 
455.     R, x,y = ring("x,y", ZZ, grlex)
456.     f = x*y**7 + 2*x**2*y**3
457. 
458.     assert f.terms() == f.terms(grlex) == f.terms('grlex') == [((1, 7), 1), ((2, 3), 2)]
459.     assert f.terms(lex) == f.terms('lex') == [((2, 3), 2), ((1, 7), 1)]
460. 
461.     R, = ring("", ZZ)
462.     assert R(3).terms() == [((), 3)]
463. 
464. def test_PolyElement_monoms():
465.     R, x,y,z = ring("x,y,z", QQ)
466.     monoms = (x**2/3 + y**3/4 + z**4/5).monoms()
467.     assert monoms == [(2,0,0), (0,3,0), (0,0,4)]
468. 
469.     R, x,y = ring("x,y", ZZ, lex)
470.     f = x*y**7 + 2*x**2*y**3
471. 
472.     assert f.monoms() == f.monoms(lex) == f.monoms('lex') == [(2, 3), (1, 7)]
473.     assert f.monoms(grlex) == f.monoms('grlex') == [(1, 7), (2, 3)]
474. 
475.     R, x,y = ring("x,y", ZZ, grlex)
476.     f = x*y**7 + 2*x**2*y**3
477. 
478.     assert f.monoms() == f.monoms(grlex) == f.monoms('grlex') == [(1, 7), (2, 3)]
479.     assert f.monoms(lex) == f.monoms('lex') == [(2, 3), (1, 7)]
480. 
481. def test_PolyElement_coeffs():
482.     R, x,y,z = ring("x,y,z", QQ)
483.     coeffs = (x**2/3 + y**3/4 + z**4/5).coeffs()
484.     assert coeffs == [QQ(1,3), QQ(1,4), QQ(1,5)]
485. 
486.     R, x,y = ring("x,y", ZZ, lex)
487.     f = x*y**7 + 2*x**2*y**3
488. 
489.     assert f.coeffs() == f.coeffs(lex) == f.coeffs('lex') == [2, 1]
490.     assert f.coeffs(grlex) == f.coeffs('grlex') == [1, 2]
491. 
492.     R, x,y = ring("x,y", ZZ, grlex)
493.     f = x*y**7 + 2*x**2*y**3
494. 
495.     assert f.coeffs() == f.coeffs(grlex) == f.coeffs('grlex') == [1, 2]
496.     assert f.coeffs(lex) == f.coeffs('lex') == [2, 1]
497. 
498. def test_PolyElement___add__():
499.     Rt, t = ring("t", ZZ)
500.     Ruv, u,v = ring("u,v", ZZ)


File: sympy/polys/tests/test_rings.py
Line number range: 501 - 1000
Content:
501.     Rxyz, x,y,z = ring("x,y,z", Ruv)
502. 
503.     assert dict(x + 3*y) == {(1, 0, 0): 1, (0, 1, 0): 3}
504. 
505.     assert dict(u + x) == dict(x + u) == {(1, 0, 0): 1, (0, 0, 0): u}
506.     assert dict(u + x*y) == dict(x*y + u) == {(1, 1, 0): 1, (0, 0, 0): u}
507.     assert dict(u + x*y + z) == dict(x*y + z + u) == {(1, 1, 0): 1, (0, 0, 1): 1, (0, 0, 0): u}
508. 
509.     assert dict(u*x + x) == dict(x + u*x) == {(1, 0, 0): u + 1}
510.     assert dict(u*x + x*y) == dict(x*y + u*x) == {(1, 1, 0): 1, (1, 0, 0): u}
511.     assert dict(u*x + x*y + z) == dict(x*y + z + u*x) == {(1, 1, 0): 1, (0, 0, 1): 1, (1, 0, 0): u}
512. 
513.     raises(TypeError, lambda: t + x)
514.     raises(TypeError, lambda: x + t)
515.     raises(TypeError, lambda: t + u)
516.     raises(TypeError, lambda: u + t)
517. 
518.     Fuv, u,v = field("u,v", ZZ)
519.     Rxyz, x,y,z = ring("x,y,z", Fuv)
520. 
521.     assert dict(u + x) == dict(x + u) == {(1, 0, 0): 1, (0, 0, 0): u}
522. 
523.     Rxyz, x,y,z = ring("x,y,z", EX)
524. 
525.     assert dict(EX(pi) + x*y*z) == dict(x*y*z + EX(pi)) == {(1, 1, 1): EX(1), (0, 0, 0): EX(pi)}
526. 
527. def test_PolyElement___sub__():
528.     Rt, t = ring("t", ZZ)
529.     Ruv, u,v = ring("u,v", ZZ)
530.     Rxyz, x,y,z = ring("x,y,z", Ruv)
531. 
532.     assert dict(x - 3*y) == {(1, 0, 0): 1, (0, 1, 0): -3}
533. 
534.     assert dict(-u + x) == dict(x - u) == {(1, 0, 0): 1, (0, 0, 0): -u}
535.     assert dict(-u + x*y) == dict(x*y - u) == {(1, 1, 0): 1, (0, 0, 0): -u}
536.     assert dict(-u + x*y + z) == dict(x*y + z - u) == {(1, 1, 0): 1, (0, 0, 1): 1, (0, 0, 0): -u}
537. 
538.     assert dict(-u*x + x) == dict(x - u*x) == {(1, 0, 0): -u + 1}
539.     assert dict(-u*x + x*y) == dict(x*y - u*x) == {(1, 1, 0): 1, (1, 0, 0): -u}
540.     assert dict(-u*x + x*y + z) == dict(x*y + z - u*x) == {(1, 1, 0): 1, (0, 0, 1): 1, (1, 0, 0): -u}
541. 
542.     raises(TypeError, lambda: t - x)
543.     raises(TypeError, lambda: x - t)
544.     raises(TypeError, lambda: t - u)
545.     raises(TypeError, lambda: u - t)
546. 
547.     Fuv, u,v = field("u,v", ZZ)
548.     Rxyz, x,y,z = ring("x,y,z", Fuv)
549. 
550.     assert dict(-u + x) == dict(x - u) == {(1, 0, 0): 1, (0, 0, 0): -u}
551. 
552.     Rxyz, x,y,z = ring("x,y,z", EX)
553. 
554.     assert dict(-EX(pi) + x*y*z) == dict(x*y*z - EX(pi)) == {(1, 1, 1): EX(1), (0, 0, 0): -EX(pi)}
555. 
556. def test_PolyElement___mul__():
557.     Rt, t = ring("t", ZZ)
558.     Ruv, u,v = ring("u,v", ZZ)
559.     Rxyz, x,y,z = ring("x,y,z", Ruv)
560. 
561.     assert dict(u*x) == dict(x*u) == {(1, 0, 0): u}
562. 
563.     assert dict(2*u*x + z) == dict(x*2*u + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
564.     assert dict(u*2*x + z) == dict(2*x*u + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
565.     assert dict(2*u*x + z) == dict(x*2*u + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
566.     assert dict(u*x*2 + z) == dict(x*u*2 + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
567. 
568.     assert dict(2*u*x*y + z) == dict(x*y*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
569.     assert dict(u*2*x*y + z) == dict(2*x*y*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
570.     assert dict(2*u*x*y + z) == dict(x*y*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
571.     assert dict(u*x*y*2 + z) == dict(x*y*u*2 + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
572. 
573.     assert dict(2*u*y*x + z) == dict(y*x*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
574.     assert dict(u*2*y*x + z) == dict(2*y*x*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
575.     assert dict(2*u*y*x + z) == dict(y*x*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
576.     assert dict(u*y*x*2 + z) == dict(y*x*u*2 + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
577. 
578.     assert dict(3*u*(x + y) + z) == dict((x + y)*3*u + z) == {(1, 0, 0): 3*u, (0, 1, 0): 3*u, (0, 0, 1): 1}
579. 
580.     raises(TypeError, lambda: t*x + z)
581.     raises(TypeError, lambda: x*t + z)
582.     raises(TypeError, lambda: t*u + z)
583.     raises(TypeError, lambda: u*t + z)
584. 
585.     Fuv, u,v = field("u,v", ZZ)
586.     Rxyz, x,y,z = ring("x,y,z", Fuv)
587. 
588.     assert dict(u*x) == dict(x*u) == {(1, 0, 0): u}
589. 
590.     Rxyz, x,y,z = ring("x,y,z", EX)
591. 
592.     assert dict(EX(pi)*x*y*z) == dict(x*y*z*EX(pi)) == {(1, 1, 1): EX(pi)}
593. 
594. def test_PolyElement___truediv__():
595.     R, x,y,z = ring("x,y,z", ZZ)
596. 
597.     assert (2*x**2 - 4)/2 == x**2 - 2
598.     assert (2*x**2 - 3)/2 == x**2
599. 
600.     assert (x**2 - 1).quo(x) == x
601.     assert (x**2 - x).quo(x) == x - 1
602. 
603.     assert (x**2 - 1)/x == x - x**(-1)
604.     assert (x**2 - x)/x == x - 1
605.     assert (x**2 - 1)/(2*x) == x/2 - x**(-1)/2
606. 
607.     assert (x**2 - 1).quo(2*x) == 0
608.     assert (x**2 - x)/(x - 1) == (x**2 - x).quo(x - 1) == x
609. 
610. 
611.     R, x,y,z = ring("x,y,z", ZZ)
612.     assert len((x**2/3 + y**3/4 + z**4/5).terms()) == 0
613. 
614.     R, x,y,z = ring("x,y,z", QQ)
615.     assert len((x**2/3 + y**3/4 + z**4/5).terms()) == 3
616. 
617.     Rt, t = ring("t", ZZ)
618.     Ruv, u,v = ring("u,v", ZZ)
619.     Rxyz, x,y,z = ring("x,y,z", Ruv)
620. 
621.     assert dict((u**2*x + u)/u) == {(1, 0, 0): u, (0, 0, 0): 1}
622.     raises(TypeError, lambda: u/(u**2*x + u))
623. 
624.     raises(TypeError, lambda: t/x)
625.     raises(TypeError, lambda: x/t)
626.     raises(TypeError, lambda: t/u)
627.     raises(TypeError, lambda: u/t)
628. 
629.     R, x = ring("x", ZZ)
630.     f, g = x**2 + 2*x + 3, R(0)
631. 
632.     raises(ZeroDivisionError, lambda: f.div(g))
633.     raises(ZeroDivisionError, lambda: divmod(f, g))
634.     raises(ZeroDivisionError, lambda: f.rem(g))
635.     raises(ZeroDivisionError, lambda: f % g)
636.     raises(ZeroDivisionError, lambda: f.quo(g))
637.     raises(ZeroDivisionError, lambda: f / g)
638.     raises(ZeroDivisionError, lambda: f.exquo(g))
639. 
640.     R, x, y = ring("x,y", ZZ)
641.     f, g = x*y + 2*x + 3, R(0)
642. 
643.     raises(ZeroDivisionError, lambda: f.div(g))
644.     raises(ZeroDivisionError, lambda: divmod(f, g))
645.     raises(ZeroDivisionError, lambda: f.rem(g))
646.     raises(ZeroDivisionError, lambda: f % g)
647.     raises(ZeroDivisionError, lambda: f.quo(g))
648.     raises(ZeroDivisionError, lambda: f / g)
649.     raises(ZeroDivisionError, lambda: f.exquo(g))
650. 
651.     R, x = ring("x", ZZ)
652. 
653.     f, g = x**2 + 1, 2*x - 4
654.     q, r = R(0), x**2 + 1
655. 
656.     assert f.div(g) == divmod(f, g) == (q, r)
657.     assert f.rem(g) == f % g == r
658.     assert f.quo(g) == f / g == q
659.     raises(ExactQuotientFailed, lambda: f.exquo(g))
660. 
661.     f, g = 3*x**3 + x**2 + x + 5, 5*x**2 - 3*x + 1
662.     q, r = R(0), f
663. 
664.     assert f.div(g) == divmod(f, g) == (q, r)
665.     assert f.rem(g) == f % g == r
666.     assert f.quo(g) == f / g == q
667.     raises(ExactQuotientFailed, lambda: f.exquo(g))
668. 
669.     f, g = 5*x**4 + 4*x**3 + 3*x**2 + 2*x + 1, x**2 + 2*x + 3
670.     q, r = 5*x**2 - 6*x, 20*x + 1
671. 
672.     assert f.div(g) == divmod(f, g) == (q, r)
673.     assert f.rem(g) == f % g == r
674.     assert f.quo(g) == f / g == q
675.     raises(ExactQuotientFailed, lambda: f.exquo(g))
676. 
677.     f, g = 5*x**5 + 4*x**4 + 3*x**3 + 2*x**2 + x, x**4 + 2*x**3 + 9
678.     q, r = 5*x - 6, 15*x**3 + 2*x**2 - 44*x + 54
679. 
680.     assert f.div(g) == divmod(f, g) == (q, r)
681.     assert f.rem(g) == f % g == r
682.     assert f.quo(g) == f / g == q
683.     raises(ExactQuotientFailed, lambda: f.exquo(g))
684. 
685.     R, x = ring("x", QQ)
686. 
687.     f, g = x**2 + 1, 2*x - 4
688.     q, r = x/2 + 1, R(5)
689. 
690.     assert f.div(g) == divmod(f, g) == (q, r)
691.     assert f.rem(g) == f % g == r
692.     assert f.quo(g) == f / g == q
693.     raises(ExactQuotientFailed, lambda: f.exquo(g))
694. 
695.     f, g = 3*x**3 + x**2 + x + 5, 5*x**2 - 3*x + 1
696.     q, r = QQ(3, 5)*x + QQ(14, 25), QQ(52, 25)*x + QQ(111, 25)
697. 
698.     assert f.div(g) == divmod(f, g) == (q, r)
699.     assert f.rem(g) == f % g == r
700.     assert f.quo(g) == f / g == q
701.     raises(ExactQuotientFailed, lambda: f.exquo(g))
702. 
703.     R, x,y = ring("x,y", ZZ)
704. 
705.     f, g = x**2 - y**2, x - y
706.     q, r = x + y, R(0)
707. 
708.     assert f.div(g) == divmod(f, g) == (q, r)
709.     assert f.rem(g) == f % g == r
710.     assert f.quo(g) == f / g == q
711.     assert f.exquo(g) == q
712. 
713.     f, g = x**2 + y**2, x - y
714.     q, r = x + y, 2*y**2
715. 
716.     assert f.div(g) == divmod(f, g) == (q, r)
717.     assert f.rem(g) == f % g == r
718.     assert f.quo(g) == f / g == q
719.     raises(ExactQuotientFailed, lambda: f.exquo(g))
720. 
721.     f, g = x**2 + y**2, -x + y
722.     q, r = -x - y, 2*y**2
723. 
724.     assert f.div(g) == divmod(f, g) == (q, r)
725.     assert f.rem(g) == f % g == r
726.     assert f.quo(g) == f / g == q
727.     raises(ExactQuotientFailed, lambda: f.exquo(g))
728. 
729.     f, g = x**2 + y**2, 2*x - 2*y
730.     q, r = R(0), f
731. 
732.     assert f.div(g) == divmod(f, g) == (q, r)
733.     assert f.rem(g) == f % g == r
734.     assert f.quo(g) == f / g == q
735.     raises(ExactQuotientFailed, lambda: f.exquo(g))
736. 
737.     R, x,y = ring("x,y", QQ)
738. 
739.     f, g = x**2 - y**2, x - y
740.     q, r = x + y, R(0)
741. 
742.     assert f.div(g) == divmod(f, g) == (q, r)
743.     assert f.rem(g) == f % g == r
744.     assert f.quo(g) == f / g == q
745.     assert f.exquo(g) == q
746. 
747.     f, g = x**2 + y**2, x - y
748.     q, r = x + y, 2*y**2
749. 
750.     assert f.div(g) == divmod(f, g) == (q, r)
751.     assert f.rem(g) == f % g == r
752.     assert f.quo(g) == f / g == q
753.     raises(ExactQuotientFailed, lambda: f.exquo(g))
754. 
755.     f, g = x**2 + y**2, -x + y
756.     q, r = -x - y, 2*y**2
757. 
758.     assert f.div(g) == divmod(f, g) == (q, r)
759.     assert f.rem(g) == f % g == r
760.     assert f.quo(g) == f / g == q
761.     raises(ExactQuotientFailed, lambda: f.exquo(g))
762. 
763.     f, g = x**2 + y**2, 2*x - 2*y
764.     q, r = x/2 + y/2, 2*y**2
765. 
766.     assert f.div(g) == divmod(f, g) == (q, r)
767.     assert f.rem(g) == f % g == r
768.     assert f.quo(g) == f / g == q
769.     raises(ExactQuotientFailed, lambda: f.exquo(g))
770. 
771. def test_PolyElement___pow__():
772.     R, x = ring("x", ZZ, grlex)
773.     f = 2*x + 3
774. 
775.     assert f**0 == 1
776.     assert f**1 == f
777.     raises(ValueError, lambda: f**(-1))
778. 
779.     assert x**(-1) == x**(-1)
780. 
781.     assert f**2 == f._pow_generic(2) == f._pow_multinomial(2) == 4*x**2 + 12*x + 9
782.     assert f**3 == f._pow_generic(3) == f._pow_multinomial(3) == 8*x**3 + 36*x**2 + 54*x + 27
783.     assert f**4 == f._pow_generic(4) == f._pow_multinomial(4) == 16*x**4 + 96*x**3 + 216*x**2 + 216*x + 81
784.     assert f**5 == f._pow_generic(5) == f._pow_multinomial(5) == 32*x**5 + 240*x**4 + 720*x**3 + 1080*x**2 + 810*x + 243
785. 
786.     R, x,y,z = ring("x,y,z", ZZ, grlex)
787.     f = x**3*y - 2*x*y**2 - 3*z + 1
788.     g = x**6*y**2 - 4*x**4*y**3 - 6*x**3*y*z + 2*x**3*y + 4*x**2*y**4 + 12*x*y**2*z - 4*x*y**2 + 9*z**2 - 6*z + 1
789. 
790.     assert f**2 == f._pow_generic(2) == f._pow_multinomial(2) == g
791. 
792.     R, t = ring("t", ZZ)
793.     f = -11200*t**4 - 2604*t**2 + 49
794.     g = 15735193600000000*t**16 + 14633730048000000*t**14 + 4828147466240000*t**12 \
795.       + 598976863027200*t**10 + 3130812416256*t**8 - 2620523775744*t**6 \
796.       + 92413760096*t**4 - 1225431984*t**2 + 5764801
797. 
798.     assert f**4 == f._pow_generic(4) == f._pow_multinomial(4) == g
799. 
800. def test_PolyElement_div():
801.     R, x = ring("x", ZZ, grlex)
802. 
803.     f = x**3 - 12*x**2 - 42
804.     g = x - 3
805. 
806.     q = x**2 - 9*x - 27
807.     r = -123
808. 
809.     assert f.div([g]) == ([q], r)
810. 
811.     R, x = ring("x", ZZ, grlex)
812.     f = x**2 + 2*x + 2
813.     assert f.div([R(1)]) == ([f], 0)
814. 
815.     R, x = ring("x", QQ, grlex)
816.     f = x**2 + 2*x + 2
817.     assert f.div([R(2)]) == ([QQ(1,2)*x**2 + x + 1], 0)
818. 
819.     R, x,y = ring("x,y", ZZ, grlex)
820.     f = 4*x**2*y - 2*x*y + 4*x - 2*y + 8
821. 
822.     assert f.div([R(2)]) == ([2*x**2*y - x*y + 2*x - y + 4], 0)
823.     assert f.div([2*y]) == ([2*x**2 - x - 1], 4*x + 8)
824. 
825.     f = x - 1
826.     g = y - 1
827. 
828.     assert f.div([g]) == ([0], f)
829. 
830.     f = x*y**2 + 1
831.     G = [x*y + 1, y + 1]
832. 
833.     Q = [y, -1]
834.     r = 2
835. 
836.     assert f.div(G) == (Q, r)
837. 
838.     f = x**2*y + x*y**2 + y**2
839.     G = [x*y - 1, y**2 - 1]
840. 
841.     Q = [x + y, 1]
842.     r = x + y + 1
843. 
844.     assert f.div(G) == (Q, r)
845. 
846.     G = [y**2 - 1, x*y - 1]
847. 
848.     Q = [x + 1, x]
849.     r = 2*x + 1
850. 
851.     assert f.div(G) == (Q, r)
852. 
853.     R, = ring("", ZZ)
854.     assert R(3).div(R(2)) == (0, 3)
855. 
856.     R, = ring("", QQ)
857.     assert R(3).div(R(2)) == (QQ(3, 2), 0)
858. 
859. def test_PolyElement_rem():
860.     R, x = ring("x", ZZ, grlex)
861. 
862.     f = x**3 - 12*x**2 - 42
863.     g = x - 3
864.     r = -123
865. 
866.     assert f.rem([g]) == f.div([g])[1] == r
867. 
868.     R, x,y = ring("x,y", ZZ, grlex)
869. 
870.     f = 4*x**2*y - 2*x*y + 4*x - 2*y + 8
871. 
872.     assert f.rem([R(2)]) == f.div([R(2)])[1] == 0
873.     assert f.rem([2*y]) == f.div([2*y])[1] == 4*x + 8
874. 
875.     f = x - 1
876.     g = y - 1
877. 
878.     assert f.rem([g]) == f.div([g])[1] == f
879. 
880.     f = x*y**2 + 1
881.     G = [x*y + 1, y + 1]
882.     r = 2
883. 
884.     assert f.rem(G) == f.div(G)[1] == r
885. 
886.     f = x**2*y + x*y**2 + y**2
887.     G = [x*y - 1, y**2 - 1]
888.     r = x + y + 1
889. 
890.     assert f.rem(G) == f.div(G)[1] == r
891. 
892.     G = [y**2 - 1, x*y - 1]
893.     r = 2*x + 1
894. 
895.     assert f.rem(G) == f.div(G)[1] == r
896. 
897. def test_PolyElement_deflate():
898.     R, x = ring("x", ZZ)
899. 
900.     assert (2*x**2).deflate(x**4 + 4*x**2 + 1) == ((2,), [2*x, x**2 + 4*x + 1])
901. 
902.     R, x,y = ring("x,y", ZZ)
903. 
904.     assert R(0).deflate(R(0)) == ((1, 1), [0, 0])
905.     assert R(1).deflate(R(0)) == ((1, 1), [1, 0])
906.     assert R(1).deflate(R(2)) == ((1, 1), [1, 2])
907.     assert R(1).deflate(2*y) == ((1, 1), [1, 2*y])
908.     assert (2*y).deflate(2*y) == ((1, 1), [2*y, 2*y])
909.     assert R(2).deflate(2*y**2) == ((1, 2), [2, 2*y])
910.     assert (2*y**2).deflate(2*y**2) == ((1, 2), [2*y, 2*y])
911. 
912.     f = x**4*y**2 + x**2*y + 1
913.     g = x**2*y**3 + x**2*y + 1
914. 
915.     assert f.deflate(g) == ((2, 1), [x**2*y**2 + x*y + 1, x*y**3 + x*y + 1])
916. 
917. def test_PolyElement_clear_denoms():
918.     R, x,y = ring("x,y", QQ)
919. 
920.     assert R(1).clear_denoms() == (ZZ(1), 1)
921.     assert R(7).clear_denoms() == (ZZ(1), 7)
922. 
923.     assert R(QQ(7,3)).clear_denoms() == (3, 7)
924.     assert R(QQ(7,3)).clear_denoms() == (3, 7)
925. 
926.     assert (3*x**2 + x).clear_denoms() == (1, 3*x**2 + x)
927.     assert (x**2 + QQ(1,2)*x).clear_denoms() == (2, 2*x**2 + x)
928. 
929.     rQQ, x,t = ring("x,t", QQ, lex)
930.     rZZ, X,T = ring("x,t", ZZ, lex)
931. 
932.     F = [x - QQ(17824537287975195925064602467992950991718052713078834557692023531499318507213727406844943097,413954288007559433755329699713866804710749652268151059918115348815925474842910720000)*t**7
933.            - QQ(4882321164854282623427463828745855894130208215961904469205260756604820743234704900167747753,12936071500236232304854053116058337647210926633379720622441104650497671088840960000)*t**6
934.            - QQ(36398103304520066098365558157422127347455927422509913596393052633155821154626830576085097433,25872143000472464609708106232116675294421853266759441244882209300995342177681920000)*t**5
935.            - QQ(168108082231614049052707339295479262031324376786405372698857619250210703675982492356828810819,58212321751063045371843239022262519412449169850208742800984970927239519899784320000)*t**4
936.            - QQ(5694176899498574510667890423110567593477487855183144378347226247962949388653159751849449037,1617008937529529038106756639507292205901365829172465077805138081312208886105120000)*t**3
937.            - QQ(154482622347268833757819824809033388503591365487934245386958884099214649755244381307907779,60637835157357338929003373981523457721301218593967440417692678049207833228942000)*t**2
938.            - QQ(2452813096069528207645703151222478123259511586701148682951852876484544822947007791153163,2425513406294293557160134959260938308852048743758697616707707121968313329157680)*t
939.            - QQ(34305265428126440542854669008203683099323146152358231964773310260498715579162112959703,202126117191191129763344579938411525737670728646558134725642260164026110763140),
940.          t**8 + QQ(693749860237914515552,67859264524169150569)*t**7
941.               + QQ(27761407182086143225024,610733380717522355121)*t**6
942.               + QQ(7785127652157884044288,67859264524169150569)*t**5
943.               + QQ(36567075214771261409792,203577793572507451707)*t**4
944.               + QQ(36336335165196147384320,203577793572507451707)*t**3
945.               + QQ(7452455676042754048000,67859264524169150569)*t**2
946.               + QQ(2593331082514399232000,67859264524169150569)*t
947.               + QQ(390399197427343360000,67859264524169150569)]
948. 
949.     G = [3725588592068034903797967297424801242396746870413359539263038139343329273586196480000*X -
950.          160420835591776763325581422211936558925462474417709511019228211783493866564923546661604487873*T**7 -
951.          1406108495478033395547109582678806497509499966197028487131115097902188374051595011248311352864*T**6 -
952.          5241326875850889518164640374668786338033653548841427557880599579174438246266263602956254030352*T**5 -
953.          10758917262823299139373269714910672770004760114329943852726887632013485035262879510837043892416*T**4 -
954.          13119383576444715672578819534846747735372132018341964647712009275306635391456880068261130581248*T**3 -
955.          9491412317016197146080450036267011389660653495578680036574753839055748080962214787557853941760*T**2 -
956.          3767520915562795326943800040277726397326609797172964377014046018280260848046603967211258368000*T -
957.          632314652371226552085897259159210286886724229880266931574701654721512325555116066073245696000,
958.          610733380717522355121*T**8 +
959.          6243748742141230639968*T**7 +
960.          27761407182086143225024*T**6 +
961.          70066148869420956398592*T**5 +
962.          109701225644313784229376*T**4 +
963.          109009005495588442152960*T**3 +
964.          67072101084384786432000*T**2 +
965.          23339979742629593088000*T +
966.          3513592776846090240000]
967. 
968.     assert [ f.clear_denoms()[1].set_ring(rZZ) for f in F ] == G
969. 
970. def test_PolyElement_cofactors():
971.     R, x, y = ring("x,y", ZZ)
972. 
973.     f, g = R(0), R(0)
974.     assert f.cofactors(g) == (0, 0, 0)
975. 
976.     f, g = R(2), R(0)
977.     assert f.cofactors(g) == (2, 1, 0)
978. 
979.     f, g = R(-2), R(0)
980.     assert f.cofactors(g) == (2, -1, 0)
981. 
982.     f, g = R(0), R(-2)
983.     assert f.cofactors(g) == (2, 0, -1)
984. 
985.     f, g = R(0), 2*x + 4
986.     assert f.cofactors(g) == (2*x + 4, 0, 1)
987. 
988.     f, g = 2*x + 4, R(0)
989.     assert f.cofactors(g) == (2*x + 4, 1, 0)
990. 
991.     f, g = R(2), R(2)
992.     assert f.cofactors(g) == (2, 1, 1)
993. 
994.     f, g = R(-2), R(2)
995.     assert f.cofactors(g) == (2, -1, 1)
996. 
997.     f, g = R(2), R(-2)
998.     assert f.cofactors(g) == (2, 1, -1)
999. 
1000.     f, g = R(-2), R(-2)


File: sympy/polys/tests/test_rings.py
Line number range: 1001 - 1500
Content:
1001.     assert f.cofactors(g) == (2, -1, -1)
1002. 
1003.     f, g = x**2 + 2*x + 1, R(1)
1004.     assert f.cofactors(g) == (1, x**2 + 2*x + 1, 1)
1005. 
1006.     f, g = x**2 + 2*x + 1, R(2)
1007.     assert f.cofactors(g) == (1, x**2 + 2*x + 1, 2)
1008. 
1009.     f, g = 2*x**2 + 4*x + 2, R(2)
1010.     assert f.cofactors(g) == (2, x**2 + 2*x + 1, 1)
1011. 
1012.     f, g = R(2), 2*x**2 + 4*x + 2
1013.     assert f.cofactors(g) == (2, 1, x**2 + 2*x + 1)
1014. 
1015.     f, g = 2*x**2 + 4*x + 2, x + 1
1016.     assert f.cofactors(g) == (x + 1, 2*x + 2, 1)
1017. 
1018.     f, g = x + 1, 2*x**2 + 4*x + 2
1019.     assert f.cofactors(g) == (x + 1, 1, 2*x + 2)
1020. 
1021.     R, x, y, z, t = ring("x,y,z,t", ZZ)
1022. 
1023.     f, g = t**2 + 2*t + 1, 2*t + 2
1024.     assert f.cofactors(g) == (t + 1, t + 1, 2)
1025. 
1026.     f, g = z**2*t**2 + 2*z**2*t + z**2 + z*t + z, t**2 + 2*t + 1
1027.     h, cff, cfg = t + 1, z**2*t + z**2 + z, t + 1
1028. 
1029.     assert f.cofactors(g) == (h, cff, cfg)
1030.     assert g.cofactors(f) == (h, cfg, cff)
1031. 
1032.     R, x, y = ring("x,y", QQ)
1033. 
1034.     f = QQ(1,2)*x**2 + x + QQ(1,2)
1035.     g = QQ(1,2)*x + QQ(1,2)
1036. 
1037.     h = x + 1
1038. 
1039.     assert f.cofactors(g) == (h, g, QQ(1,2))
1040.     assert g.cofactors(f) == (h, QQ(1,2), g)
1041. 
1042.     R, x, y = ring("x,y", RR)
1043. 
1044.     f = 2.1*x*y**2 - 2.1*x*y + 2.1*x
1045.     g = 2.1*x**3
1046.     h = 1.0*x
1047. 
1048.     assert f.cofactors(g) == (h, f/h, g/h)
1049.     assert g.cofactors(f) == (h, g/h, f/h)
1050. 
1051. def test_PolyElement_gcd():
1052.     R, x, y = ring("x,y", QQ)
1053. 
1054.     f = QQ(1,2)*x**2 + x + QQ(1,2)
1055.     g = QQ(1,2)*x + QQ(1,2)
1056. 
1057.     assert f.gcd(g) == x + 1
1058. 
1059. def test_PolyElement_cancel():
1060.     R, x, y = ring("x,y", ZZ)
1061. 
1062.     f = 2*x**3 + 4*x**2 + 2*x
1063.     g = 3*x**2 + 3*x
1064.     F = 2*x + 2
1065.     G = 3
1066. 
1067.     assert f.cancel(g) == (F, G)
1068. 
1069.     assert (-f).cancel(g) == (-F, G)
1070.     assert f.cancel(-g) == (-F, G)
1071. 
1072.     R, x, y = ring("x,y", QQ)
1073. 
1074.     f = QQ(1,2)*x**3 + x**2 + QQ(1,2)*x
1075.     g = QQ(1,3)*x**2 + QQ(1,3)*x
1076.     F = 3*x + 3
1077.     G = 2
1078. 
1079.     assert f.cancel(g) == (F, G)
1080. 
1081.     assert (-f).cancel(g) == (-F, G)
1082.     assert f.cancel(-g) == (-F, G)
1083. 
1084.     Fx, x = field("x", ZZ)
1085.     Rt, t = ring("t", Fx)
1086. 
1087.     f = (-x**2 - 4)/4*t
1088.     g = t**2 + (x**2 + 2)/2
1089. 
1090.     assert f.cancel(g) == ((-x**2 - 4)*t, 4*t**2 + 2*x**2 + 4)
1091. 
1092. def test_PolyElement_max_norm():
1093.     R, x, y = ring("x,y", ZZ)
1094. 
1095.     assert R(0).max_norm() == 0
1096.     assert R(1).max_norm() == 1
1097. 
1098.     assert (x**3 + 4*x**2 + 2*x + 3).max_norm() == 4
1099. 
1100. def test_PolyElement_l1_norm():
1101.     R, x, y = ring("x,y", ZZ)
1102. 
1103.     assert R(0).l1_norm() == 0
1104.     assert R(1).l1_norm() == 1
1105. 
1106.     assert (x**3 + 4*x**2 + 2*x + 3).l1_norm() == 10
1107. 
1108. def test_PolyElement_diff():
1109.     R, X = xring("x:11", QQ)
1110. 
1111.     f = QQ(288,5)*X[0]**8*X[1]**6*X[4]**3*X[10]**2 + 8*X[0]**2*X[2]**3*X[4]**3 +2*X[0]**2 - 2*X[1]**2
1112. 
1113.     assert f.diff(X[0]) == QQ(2304,5)*X[0]**7*X[1]**6*X[4]**3*X[10]**2 + 16*X[0]*X[2]**3*X[4]**3 + 4*X[0]
1114.     assert f.diff(X[4]) == QQ(864,5)*X[0]**8*X[1]**6*X[4]**2*X[10]**2 + 24*X[0]**2*X[2]**3*X[4]**2
1115.     assert f.diff(X[10]) == QQ(576,5)*X[0]**8*X[1]**6*X[4]**3*X[10]
1116. 
1117. def test_PolyElement___call__():
1118.     R, x = ring("x", ZZ)
1119.     f = 3*x + 1
1120. 
1121.     assert f(0) == 1
1122.     assert f(1) == 4
1123. 
1124.     raises(ValueError, lambda: f())
1125.     raises(ValueError, lambda: f(0, 1))
1126. 
1127.     raises(CoercionFailed, lambda: f(QQ(1,7)))
1128. 
1129.     R, x,y = ring("x,y", ZZ)
1130.     f = 3*x + y**2 + 1
1131. 
1132.     assert f(0, 0) == 1
1133.     assert f(1, 7) == 53
1134. 
1135.     Ry = R.drop(x)
1136. 
1137.     assert f(0) == Ry.y**2 + 1
1138.     assert f(1) == Ry.y**2 + 4
1139. 
1140.     raises(ValueError, lambda: f())
1141.     raises(ValueError, lambda: f(0, 1, 2))
1142. 
1143.     raises(CoercionFailed, lambda: f(1, QQ(1,7)))
1144.     raises(CoercionFailed, lambda: f(QQ(1,7), 1))
1145.     raises(CoercionFailed, lambda: f(QQ(1,7), QQ(1,7)))
1146. 
1147. def test_PolyElement_evaluate():
1148.     R, x = ring("x", ZZ)
1149.     f = x**3 + 4*x**2 + 2*x + 3
1150. 
1151.     r = f.evaluate(x, 0)
1152.     assert r == 3 and not isinstance(r, PolyElement)
1153. 
1154.     raises(CoercionFailed, lambda: f.evaluate(x, QQ(1,7)))
1155. 
1156.     R, x, y, z = ring("x,y,z", ZZ)
1157.     f = (x*y)**3 + 4*(x*y)**2 + 2*x*y + 3
1158. 
1159.     r = f.evaluate(x, 0)
1160.     assert r == 3 and isinstance(r, R.drop(x).dtype)
1161.     r = f.evaluate([(x, 0), (y, 0)])
1162.     assert r == 3 and isinstance(r, R.drop(x, y).dtype)
1163.     r = f.evaluate(y, 0)
1164.     assert r == 3 and isinstance(r, R.drop(y).dtype)
1165.     r = f.evaluate([(y, 0), (x, 0)])
1166.     assert r == 3 and isinstance(r, R.drop(y, x).dtype)
1167. 
1168.     r = f.evaluate([(x, 0), (y, 0), (z, 0)])
1169.     assert r == 3 and not isinstance(r, PolyElement)
1170. 
1171.     raises(CoercionFailed, lambda: f.evaluate([(x, 1), (y, QQ(1,7))]))
1172.     raises(CoercionFailed, lambda: f.evaluate([(x, QQ(1,7)), (y, 1)]))
1173.     raises(CoercionFailed, lambda: f.evaluate([(x, QQ(1,7)), (y, QQ(1,7))]))
1174. 
1175. def test_PolyElement_subs():
1176.     R, x = ring("x", ZZ)
1177.     f = x**3 + 4*x**2 + 2*x + 3
1178. 
1179.     r = f.subs(x, 0)
1180.     assert r == 3 and isinstance(r, R.dtype)
1181. 
1182.     raises(CoercionFailed, lambda: f.subs(x, QQ(1,7)))
1183. 
1184.     R, x, y, z = ring("x,y,z", ZZ)
1185.     f = x**3 + 4*x**2 + 2*x + 3
1186. 
1187.     r = f.subs(x, 0)
1188.     assert r == 3 and isinstance(r, R.dtype)
1189.     r = f.subs([(x, 0), (y, 0)])
1190.     assert r == 3 and isinstance(r, R.dtype)
1191. 
1192.     raises(CoercionFailed, lambda: f.subs([(x, 1), (y, QQ(1,7))]))
1193.     raises(CoercionFailed, lambda: f.subs([(x, QQ(1,7)), (y, 1)]))
1194.     raises(CoercionFailed, lambda: f.subs([(x, QQ(1,7)), (y, QQ(1,7))]))
1195. 
1196. def test_PolyElement_compose():
1197.     R, x = ring("x", ZZ)
1198.     f = x**3 + 4*x**2 + 2*x + 3
1199. 
1200.     r = f.compose(x, 0)
1201.     assert r == 3 and isinstance(r, R.dtype)
1202. 
1203.     assert f.compose(x, x) == f
1204.     assert f.compose(x, x**2) == x**6 + 4*x**4 + 2*x**2 + 3
1205. 
1206.     raises(CoercionFailed, lambda: f.compose(x, QQ(1,7)))
1207. 
1208.     R, x, y, z = ring("x,y,z", ZZ)
1209.     f = x**3 + 4*x**2 + 2*x + 3
1210. 
1211.     r = f.compose(x, 0)
1212.     assert r == 3 and isinstance(r, R.dtype)
1213.     r = f.compose([(x, 0), (y, 0)])
1214.     assert r == 3 and isinstance(r, R.dtype)
1215. 
1216.     r = (x**3 + 4*x**2 + 2*x*y*z + 3).compose(x, y*z**2 - 1)
1217.     q = (y*z**2 - 1)**3 + 4*(y*z**2 - 1)**2 + 2*(y*z**2 - 1)*y*z + 3
1218.     assert r == q and isinstance(r, R.dtype)
1219. 
1220. def test_PolyElement_is_():
1221.     R, x,y,z = ring("x,y,z", QQ)
1222. 
1223.     assert (x - x).is_generator == False
1224.     assert (x - x).is_ground == True
1225.     assert (x - x).is_monomial == True
1226.     assert (x - x).is_term == True
1227. 
1228.     assert (x - x + 1).is_generator == False
1229.     assert (x - x + 1).is_ground == True
1230.     assert (x - x + 1).is_monomial == True
1231.     assert (x - x + 1).is_term == True
1232. 
1233.     assert x.is_generator == True
1234.     assert x.is_ground == False
1235.     assert x.is_monomial == True
1236.     assert x.is_term == True
1237. 
1238.     assert (x*y).is_generator == False
1239.     assert (x*y).is_ground == False
1240.     assert (x*y).is_monomial == True
1241.     assert (x*y).is_term == True
1242. 
1243.     assert (3*x).is_generator == False
1244.     assert (3*x).is_ground == False
1245.     assert (3*x).is_monomial == False
1246.     assert (3*x).is_term == True
1247. 
1248.     assert (3*x + 1).is_generator == False
1249.     assert (3*x + 1).is_ground == False
1250.     assert (3*x + 1).is_monomial == False
1251.     assert (3*x + 1).is_term == False
1252. 
1253.     assert R(0).is_zero is True
1254.     assert R(1).is_zero is False
1255. 
1256.     assert R(0).is_one is False
1257.     assert R(1).is_one is True
1258. 
1259.     assert (x - 1).is_monic is True
1260.     assert (2*x - 1).is_monic is False
1261. 
1262.     assert (3*x + 2).is_primitive is True
1263.     assert (4*x + 2).is_primitive is False
1264. 
1265.     assert (x + y + z + 1).is_linear is True
1266.     assert (x*y*z + 1).is_linear is False
1267. 
1268.     assert (x*y + z + 1).is_quadratic is True
1269.     assert (x*y*z + 1).is_quadratic is False
1270. 
1271.     assert (x - 1).is_squarefree is True
1272.     assert ((x - 1)**2).is_squarefree is False
1273. 
1274.     assert (x**2 + x + 1).is_irreducible is True
1275.     assert (x**2 + 2*x + 1).is_irreducible is False
1276. 
1277.     _, t = ring("t", FF(11))
1278. 
1279.     assert (7*t + 3).is_irreducible is True
1280.     assert (7*t**2 + 3*t + 1).is_irreducible is False
1281. 
1282.     _, u = ring("u", ZZ)
1283.     f = u**16 + u**14 - u**10 - u**8 - u**6 + u**2
1284. 
1285.     assert f.is_cyclotomic is False
1286.     assert (f + 1).is_cyclotomic is True
1287. 
1288.     raises(MultivariatePolynomialError, lambda: x.is_cyclotomic)
1289. 
1290.     R, = ring("", ZZ)
1291.     assert R(4).is_squarefree is True
1292.     assert R(6).is_irreducible is True
1293. 
1294. def test_PolyElement_drop():
1295.     R, x,y,z = ring("x,y,z", ZZ)
1296. 
1297.     assert R(1).drop(0).ring == PolyRing("y,z", ZZ, lex)
1298.     assert R(1).drop(0).drop(0).ring == PolyRing("z", ZZ, lex)
1299.     assert isinstance(R(1).drop(0).drop(0).drop(0), R.dtype) is False
1300. 
1301.     raises(ValueError, lambda: z.drop(0).drop(0).drop(0))
1302.     raises(ValueError, lambda: x.drop(0))
1303. 
1304. def test_PolyElement_pdiv():
1305.     _, x, y = ring("x,y", ZZ)
1306. 
1307.     f, g = x**2 - y**2, x - y
1308.     q, r = x + y, 0
1309. 
1310.     assert f.pdiv(g) == (q, r)
1311.     assert f.prem(g) == r
1312.     assert f.pquo(g) == q
1313.     assert f.pexquo(g) == q
1314. 
1315. def test_PolyElement_gcdex():
1316.     _, x = ring("x", QQ)
1317. 
1318.     f, g = 2*x, x**2 - 16
1319.     s, t, h = x/32, -QQ(1, 16), 1
1320. 
1321.     assert f.half_gcdex(g) == (s, h)
1322.     assert f.gcdex(g) == (s, t, h)
1323. 
1324. def test_PolyElement_subresultants():
1325.     _, x = ring("x", ZZ)
1326.     f, g, h = x**2 - 2*x + 1, x**2 - 1, 2*x - 2
1327. 
1328.     assert f.subresultants(g) == [f, g, h]
1329. 
1330. def test_PolyElement_resultant():
1331.     _, x = ring("x", ZZ)
1332.     f, g, h = x**2 - 2*x + 1, x**2 - 1, 0
1333. 
1334.     assert f.resultant(g) == h
1335. 
1336. def test_PolyElement_discriminant():
1337.     _, x = ring("x", ZZ)
1338.     f, g = x**3 + 3*x**2 + 9*x - 13, -11664
1339. 
1340.     assert f.discriminant() == g
1341. 
1342.     F, a, b, c = ring("a,b,c", ZZ)
1343.     _, x = ring("x", F)
1344. 
1345.     f, g = a*x**2 + b*x + c, b**2 - 4*a*c
1346. 
1347.     assert f.discriminant() == g
1348. 
1349. def test_PolyElement_decompose():
1350.     _, x = ring("x", ZZ)
1351. 
1352.     f = x**12 + 20*x**10 + 150*x**8 + 500*x**6 + 625*x**4 - 2*x**3 - 10*x + 9
1353.     g = x**4 - 2*x + 9
1354.     h = x**3 + 5*x
1355. 
1356.     assert g.compose(x, h) == f
1357.     assert f.decompose() == [g, h]
1358. 
1359. def test_PolyElement_shift():
1360.     _, x = ring("x", ZZ)
1361.     assert (x**2 - 2*x + 1).shift(2) == x**2 + 2*x + 1
1362. 
1363. def test_PolyElement_sturm():
1364.     F, t = field("t", ZZ)
1365.     _, x = ring("x", F)
1366. 
1367.     f = 1024/(15625*t**8)*x**5 - 4096/(625*t**8)*x**4 + 32/(15625*t**4)*x**3 - 128/(625*t**4)*x**2 + F(1)/62500*x - F(1)/625
1368. 
1369.     assert f.sturm() == [
1370.         x**3 - 100*x**2 + t**4/64*x - 25*t**4/16,
1371.         3*x**2 - 200*x + t**4/64,
1372.         (-t**4/96 + F(20000)/9)*x + 25*t**4/18,
1373.         (-9*t**12 - 11520000*t**8 - 3686400000000*t**4)/(576*t**8 - 245760000*t**4 + 26214400000000),
1374.     ]
1375. 
1376. def test_PolyElement_gff_list():
1377.     _, x = ring("x", ZZ)
1378. 
1379.     f = x**5 + 2*x**4 - x**3 - 2*x**2
1380.     assert f.gff_list() == [(x, 1), (x + 2, 4)]
1381. 
1382.     f = x*(x - 1)**3*(x - 2)**2*(x - 4)**2*(x - 5)
1383.     assert f.gff_list() == [(x**2 - 5*x + 4, 1), (x**2 - 5*x + 4, 2), (x, 3)]
1384. 
1385. def test_PolyElement_sqf_norm():
1386.     R, x = ring("x", QQ.algebraic_field(sqrt(3)))
1387.     X = R.to_ground().x
1388. 
1389.     assert (x**2 - 2).sqf_norm() == (1, x**2 - 2*sqrt(3)*x + 1, X**4 - 10*X**2 + 1)
1390. 
1391.     R, x = ring("x", QQ.algebraic_field(sqrt(2)))
1392.     X = R.to_ground().x
1393. 
1394.     assert (x**2 - 3).sqf_norm() == (1, x**2 - 2*sqrt(2)*x - 1, X**4 - 10*X**2 + 1)
1395. 
1396. def test_PolyElement_sqf_list():
1397.     _, x = ring("x", ZZ)
1398. 
1399.     f = x**5 - x**3 - x**2 + 1
1400.     g = x**3 + 2*x**2 + 2*x + 1
1401.     h = x - 1
1402.     p = x**4 + x**3 - x - 1
1403. 
1404.     assert f.sqf_part() == p
1405.     assert f.sqf_list() == (1, [(g, 1), (h, 2)])
1406. 
1407. def test_PolyElement_factor_list():
1408.     _, x = ring("x", ZZ)
1409. 
1410.     f = x**5 - x**3 - x**2 + 1
1411. 
1412.     u = x + 1
1413.     v = x - 1
1414.     w = x**2 + x + 1
1415. 
1416.     assert f.factor_list() == (1, [(u, 1), (v, 2), (w, 1)])
1417. 
1418. 
1419. def test_issue_21410():
1420.     R, x = ring('x', FF(2))
1421.     p = x**6 + x**5 + x**4 + x**3 + 1
1422.     assert p._pow_multinomial(4) == x**24 + x**20 + x**16 + x**12 + 1

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 13:19:04,073 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the full content of the file `sympy/polys/tests/test_rings.py`.\n   - This context contains the first 500 lines of the requested file.\n2. Extended relevance:\n   - This context is essential for fulfilling the user's request for the complete file content.", relative_path='sympy/polys/tests/test_rings.py', start_line=1, end_line=500), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the full content of the file `sympy/polys/tests/test_rings.py`.\n   - This context contains lines 501 to 1000 of the requested file.\n2. Extended relevance:\n   - This context is essential for fulfilling the user's request for the complete file content.", relative_path='sympy/polys/tests/test_rings.py', start_line=501, end_line=1000), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the full content of the file `sympy/polys/tests/test_rings.py`.\n   - This context contains the remaining lines (1001-1422) of the requested file.\n2. Extended relevance:\n   - This context is essential for fulfilling the user's request for the complete file content.", relative_path='sympy/polys/tests/test_rings.py', start_line=1001, end_line=1422)]
2025-12-21 13:19:04,076 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the full content of the file `sympy/polys/tests/test_rings.py`.
2025-12-21 13:19:04,076 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 13:19:04,076 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 13:19:04,077 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 0 existing contexts
2025-12-21 13:19:04,077 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-21 13:19:04,078 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .circleci
|   └── config.yml
├── .github
|   └── workflows
|       ├── checkconflict.yml
|       ├── ci-sage.yml
|       ├── comment-on-pr.yml
|       ├── docs-preview.yml
|       ├── release.yml
|       └── runtests.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.md
├── bin
|   ├── ask_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_check.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_optional_dependencies.py
|   ├── test_py2_import.py
|   ├── test_setup.py
|   ├── test_sphinx.sh
|   ├── test_submodule_imports.py
|   ├── test_symengine.py
|   └── test_tensorflow.py
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── aptinstall.sh
|   ├── cheatsheet
|   ├── ext
|   |   ├── convert-svg-to-pdf.py
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   └── numpydoc.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   ├── requirements.txt
|   └── src
|       ├── _pygments
|       |   └── styles.py
|       ├── _static
|       |   └── custom.css
|       ├── _templates
|       |   └── sidebar
|       |       └── versions.html
|       ├── citing.md
|       ├── conf.py
|       ├── contributing
|       |   ├── build-docs.rst
|       |   ├── debug.rst
|       |   ├── dependencies.md
|       |   ├── deprecations.md
|       |   ├── dev-setup.rst
|       |   ├── docstring.rst
|       |   ├── documentation-style-guide.rst
|       |   ├── index.rst
|       |   └── make-a-contribution.rst
|       ├── explanation
|       |   ├── active-deprecations.md
|       |   ├── glossary.md
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── solve_output.rst
|       |   └── special_topics
|       |       ├── classification.rst
|       |       ├── finite_diff_derivatives.rst
|       |       └── index.rst
|       ├── guides
|       |   ├── assumptions.rst
|       |   ├── booleans.rst
|       |   ├── custom-functions.md
|       |   ├── index.rst
|       |   └── solving
|       |       ├── find-roots-polynomial.md
|       |       ├── index.md
|       |       ├── reduce-inequalities-algebraically.md
|       |       ├── solve-diophantine-equation.md
|       |       ├── solve-equation-algebraically.md
|       |       ├── solve-matrix-equation.md
|       |       ├── solve-numerically.md
|       |       ├── solve-ode.md
|       |       ├── solve-system-of-equations-algebraically.md
|       |       └── solving-guidance.md
|       ├── index.rst
|       ├── install.md
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── abc.rst
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── index.rst
|       |   |   ├── predicates.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── group_numbers.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── internal.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   ├── index.rst
|       |   |   └── integrals.rst
|       |   ├── interactive.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── normalforms.rst
|       |   |   ├── sparse.rst
|       |   |   └── sparsetools.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── control
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── domainmatrix.rst
|       |   |   ├── domainsintro.rst
|       |   |   ├── domainsref.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── numberfields.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   ├── solvers.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── fu.rst
|       |   |   ├── hyperexpand.rst
|       |   |   ├── index.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── index.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── array_expressions.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   ├── tensor.rst
|       |   |   └── toperators.rst
|       |   ├── testing
|       |   |   ├── index.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   └── runtests.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── exceptions.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       ├── intro.rst
|       |       └── vector_integration.rst
|       ├── pics
|       ├── reference
|       |   ├── index.rst
|       |   └── public
|       |       ├── basics
|       |       ├── codegeneration
|       |       ├── logic
|       |       ├── matrices
|       |       ├── numbertheory
|       |       ├── physics
|       |       ├── topics
|       |       └── utilities
|       └── tutorials
|           ├── index.rst
|           └── intro-tutorial
|               ├── basic_operations.rst
|               ├── calculus.rst
|               ├── features.rst
|               ├── gotchas.rst
|               ├── index.rst
|               ├── intro.rst
|               ├── manipulation.rst
|               ├── matrices.rst
|               ├── next.rst
|               ├── preliminaries.rst
|               ├── printing.rst
|               ├── simplification.rst
|               └── solvers.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── README.md
|   ├── authors.py
|   ├── build_docs.py
|   ├── ci_release_script.sh
|   ├── compare_tar_against_git.py
|   ├── github_release.py
|   ├── helpers.py
|   ├── releasecheck.py
|   ├── sha256.py
|   └── update_docs.py
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── facts.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── predicates
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── relation
    |   |   ├── __init__.py
    |   |   ├── binrel.py
    |   |   └── equality.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_assumptions_2.py
    |   |   ├── test_context.py
    |   |   ├── test_matrices.py
    |   |   ├── test_query.py
    |   |   ├── test_refine.py
    |   |   ├── test_satask.py
    |   |   ├── test_sathandlers.py
    |   |   └── test_wrapper.py
    |   └── wrapper.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── accumulationbounds.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_accumulationbounds.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── abstract_nodes.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── numpy_nodes.py
    |   ├── pynodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   ├── scipy_nodes.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_abstract_nodes.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_numpy_nodes.py
    |       ├── test_pynodes.py
    |       ├── test_pyutils.py
    |       ├── test_rewriting.py
    |       └── test_scipy_nodes.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── group_numbers.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── schur_number.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_group_numbers.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_schur_number.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── _print_helpers.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── assumptions_generated.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── kind.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── parameters.py
    |   ├── power.py
    |   ├── random.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── sorting.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_kind.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_parameters.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_random.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_sorting.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_traversal.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   ├── trace.py
    |   └── traversal.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── gmpy.py
    |   ├── importtools.py
    |   ├── pythonmpq.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_pythonmpq.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── printing.py
    |   ├── session.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_interactive.py
    |   |   └── test_ipython.py
    |   └── traversal.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   ├── minisat22_wrapper.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── decompositions.py
    |   ├── dense.py
    |   ├── determinant.py
    |   ├── eigen.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── _shape.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── companion.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── permutation.py
    |   |   ├── sets.py
    |   |   ├── slice.py
    |   |   ├── special.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_companion.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_permutation.py
    |   |   |   ├── test_sets.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_special.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── graph.py
    |   ├── immutable.py
    |   ├── inverse.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── reductions.py
    |   ├── repmatrix.py
    |   ├── solvers.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   ├── subspaces.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_commonmatrix.py
    |   |   ├── test_decompositions.py
    |   |   ├── test_determinant.py
    |   |   ├── test_eigen.py
    |   |   ├── test_graph.py
    |   |   ├── test_immutable.py
    |   |   ├── test_interactions.py
    |   |   ├── test_matrices.py
    |   |   ├── test_normalforms.py
    |   |   ├── test_reductions.py
    |   |   ├── test_solvers.py
    |   |   ├── test_sparse.py
    |   |   ├── test_sparsetools.py
    |   |   └── test_subspaces.py
    |   └── utilities.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── digits.py
    |   ├── ecm.py
    |   ├── egyptian_fraction.py
    |   ├── elliptic_curve.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── qs.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_digits.py
    |       ├── test_ecm.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_elliptic_curve.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       ├── test_qs.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _build_autolev_antlr.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── README.txt
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ast_parser.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_beam.py
    |   |   |   └── test_truss.py
    |   |   └── truss.py
    |   ├── control
    |   |   ├── __init__.py
    |   |   ├── control_plots.py
    |   |   ├── lti.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_control_plots.py
    |   |       └── test_lti.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── joint.py
    |   |   ├── jointsmethod.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── method.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_joint.py
    |   |       ├── test_jointsmethod.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_method.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── polarization.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_polarization.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_anticommutator.py
    |   |   |   ├── test_boson.py
    |   |   |   ├── test_cartesian.py
    |   |   |   ├── test_cg.py
    |   |   |   ├── test_circuitplot.py
    |   |   |   ├── test_circuitutils.py
    |   |   |   ├── test_commutator.py
    |   |   |   ├── test_constants.py
    |   |   |   ├── test_dagger.py
    |   |   |   ├── test_density.py
    |   |   |   ├── test_fermion.py
    |   |   |   ├── test_gate.py
    |   |   |   ├── test_grover.py
    |   |   |   ├── test_hilbert.py
    |   |   |   ├── test_identitysearch.py
    |   |   |   ├── test_innerproduct.py
    |   |   |   ├── test_matrixutils.py
    |   |   |   ├── test_operator.py
    |   |   |   ├── test_operatorordering.py
    |   |   |   ├── test_operatorset.py
    |   |   |   ├── test_pauli.py
    |   |   |   ├── test_piab.py
    |   |   |   ├── test_printing.py
    |   |   |   ├── test_qapply.py
    |   |   |   ├── test_qasm.py
    |   |   |   ├── test_qexpr.py
    |   |   |   ├── test_qft.py
    |   |   |   ├── test_qubit.py
    |   |   |   ├── test_represent.py
    |   |   |   ├── test_sho1d.py
    |   |   |   ├── test_shor.py
    |   |   |   ├── test_spin.py
    |   |   |   ├── test_state.py
    |   |   |   ├── test_tensorproduct.py
    |   |   |   └── test_trace.py
    |   |   └── trace.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions
    |   |   |   ├── __init__.py
    |   |   |   ├── dimension_definitions.py
    |   |   |   └── unit_definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── cgs.py
    |   |   |   ├── length_weight_time.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unit_system_cgs_gauss.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── interval_membership.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       ├── test_interval_membership.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_experimental_lambdify.py
    |   |   ├── test_plot.py
    |   |   ├── test_plot_implicit.py
    |   |   └── test_textplot.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── appellseqs.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domainmatrix.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── expressionrawdomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gaussiandomains.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── matrices
    |   |   ├── __init__.py
    |   |   ├── ddm.py
    |   |   ├── dense.py
    |   |   ├── domainmatrix.py
    |   |   ├── domainscalar.py
    |   |   ├── eigen.py
    |   |   ├── exceptions.py
    |   |   ├── linsolve.py
    |   |   ├── normalforms.py
    |   |   ├── sdm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_ddm.py
    |   |       ├── test_dense.py
    |   |       ├── test_domainmatrix.py
    |   |       ├── test_domainscalar.py
    |   |       ├── test_eigen.py
    |   |       ├── test_linsolve.py
    |   |       ├── test_normalforms.py
    |   |       └── test_sdm.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields
    |   |   ├── __init__.py
    |   |   ├── basis.py
    |   |   ├── exceptions.py
    |   |   ├── minpoly.py
    |   |   ├── modules.py
    |   |   ├── primes.py
    |   |   ├── subfield.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_basis.py
    |   |   |   ├── test_minpoly.py
    |   |   |   ├── test_modules.py
    |   |   |   ├── test_numbers.py
    |   |   |   ├── test_primes.py
    |   |   |   ├── test_subfield.py
    |   |   |   └── test_utilities.py
    |   |   └── utilities.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_appellseqs.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── aesaracode.py
    |   ├── c.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxx.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fortran.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── numpy.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── smtlib.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_aesaracode.py
    |   |   ├── test_c.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cupy.py
    |   |   ├── test_cxx.py
    |   |   ├── test_dot.py
    |   |   ├── test_fortran.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jax.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_smtlib.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── comparison.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── issubset.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── powerset.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_powerset.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine
    |   |   ├── __init__.py
    |   |   ├── diophantine.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_diophantine.py
    |   ├── inequalities.py
    |   ├── ode
    |   |   ├── __init__.py
    |   |   ├── hypergeometric.py
    |   |   ├── lie_group.py
    |   |   ├── nonhomogeneous.py
    |   |   ├── ode.py
    |   |   ├── riccati.py
    |   |   ├── single.py
    |   |   ├── subscheck.py
    |   |   ├── systems.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_lie_group.py
    |   |       ├── test_ode.py
    |   |       ├── test_riccati.py
    |   |       ├── test_single.py
    |   |       ├── test_subscheck.py
    |   |       └── test_systems.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── compound_rv.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── matrix_distributions.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── sampling
    |   |   ├── __init__.py
    |   |   ├── sample_numpy.py
    |   |   ├── sample_pymc.py
    |   |   ├── sample_scipy.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_sample_continuous_rv.py
    |   |       ├── test_sample_discrete_rv.py
    |   |       └── test_sample_finite_rv.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_multivariate_probability.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_compound_rv.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_matrix_distributions.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       ├── test_symbolic_multivariate.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── array_derivatives.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── expressions
    |   |   |   ├── __init__.py
    |   |   |   ├── array_expressions.py
    |   |   |   ├── arrayexpr_derivatives.py
    |   |   |   ├── conv_array_to_indexed.py
    |   |   |   ├── conv_array_to_matrix.py
    |   |   |   ├── conv_indexed_to_array.py
    |   |   |   ├── conv_matrix_to_array.py
    |   |   |   ├── from_array_to_indexed.py
    |   |   |   ├── from_array_to_matrix.py
    |   |   |   ├── from_indexed_to_array.py
    |   |   |   ├── from_matrix_to_array.py
    |   |   |   ├── tests
    |   |   |   └── utils.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_array_derivatives.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       ├── test_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_printing.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── testing
    |   ├── __init__.py
    |   ├── matrices.py
    |   ├── pytest.py
    |   ├── quality_unicode.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_module_imports.py
    |   |   └── test_pytest.py
    |   └── tmpfiles.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_deprecated.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_matchpy_connector.py
    |   |   ├── test_misc.py
    |   |   ├── test_pickling.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── implicitregion.py
        ├── integrals.py
        ├── operators.py
        ├── orienters.py
        ├── parametricregion.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_implicitregion.py
        |   ├── test_integrals.py
        |   ├── test_operators.py
        |   ├── test_parametricregion.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: `PolyElement.as_expr()` not accepting symbols

Description: The method `PolyElement.as_expr()`

https://github.com/sympy/sympy/blob/193e3825645d93c73e31cdceb6d742cc6919624d/sympy/polys/rings.py#L618-L624

is supposed to let you set the symbols you want to use, but, as it stands, either you pass the wrong number of symbols, and get an error message, or you pass the right number of symbols, and it ignores them, using `self.ring.symbols` instead:

```python
>>> from sympy import ring, ZZ, symbols
>>> R, x, y, z = ring("x,y,z", ZZ)
>>> f = 3*x**2*y - x*y*z + 7*z**3 + 1
>>> U, V, W = symbols("u,v,w")
>>> f.as_expr(U, V, W)
3*x**2*y - x*y*z + 7*z**3 + 1
```

Patch information:
diff --git a/sympy/polys/rings.py b/sympy/polys/rings.py
index 12bd2fc920..cc8becab8e 100644
--- a/sympy/polys/rings.py
+++ b/sympy/polys/rings.py
@@ -616,8 +616,9 @@ def set_ring(self, new_ring):
             return new_ring.from_dict(self, self.ring.domain)
 
     def as_expr(self, *symbols):
-        if symbols and len(symbols) != self.ring.ngens:
-            raise ValueError("not enough symbols, expected %s got %s" % (self.ring.ngens, len(symbols)))
+        if symbols:
+            if len(symbols) != self.ring.ngens:
+                raise ValueError("expected %s symbols, got %s" % (self.ring.ngens, len(symbols)))
         else:
             symbols = self.ring.symbols
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `sympy/polys/tests/test_rings.py`.
Extra Requirements: 
Purpose: I need to find relevant test cases for the `as_expr` method in `PolyElement` to address the user's request.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/polys/tests/test_rings.py
Line number range: 1 - 500
Content:
1. """Test sparse polynomials. """
2. 
3. from functools import reduce
4. from operator import add, mul
5. 
6. from sympy.polys.rings import ring, xring, sring, PolyRing, PolyElement
7. from sympy.polys.fields import field, FracField
8. from sympy.polys.domains import ZZ, QQ, RR, FF, EX
9. from sympy.polys.orderings import lex, grlex
10. from sympy.polys.polyerrors import GeneratorsError, \
11.     ExactQuotientFailed, MultivariatePolynomialError, CoercionFailed
12. 
13. from sympy.testing.pytest import raises
14. from sympy.core import Symbol, symbols
15. 
16. from sympy.core.numbers import (oo, pi)
17. from sympy.functions.elementary.exponential import exp
18. from sympy.functions.elementary.miscellaneous import sqrt
19. 
20. def test_PolyRing___init__():
21.     x, y, z, t = map(Symbol, "xyzt")
22. 
23.     assert len(PolyRing("x,y,z", ZZ, lex).gens) == 3
24.     assert len(PolyRing(x, ZZ, lex).gens) == 1
25.     assert len(PolyRing(("x", "y", "z"), ZZ, lex).gens) == 3
26.     assert len(PolyRing((x, y, z), ZZ, lex).gens) == 3
27.     assert len(PolyRing("", ZZ, lex).gens) == 0
28.     assert len(PolyRing([], ZZ, lex).gens) == 0
29. 
30.     raises(GeneratorsError, lambda: PolyRing(0, ZZ, lex))
31. 
32.     assert PolyRing("x", ZZ[t], lex).domain == ZZ[t]
33.     assert PolyRing("x", 'ZZ[t]', lex).domain == ZZ[t]
34.     assert PolyRing("x", PolyRing("t", ZZ, lex), lex).domain == ZZ[t]
35. 
36.     raises(GeneratorsError, lambda: PolyRing("x", PolyRing("x", ZZ, lex), lex))
37. 
38.     _lex = Symbol("lex")
39.     assert PolyRing("x", ZZ, lex).order == lex
40.     assert PolyRing("x", ZZ, _lex).order == lex
41.     assert PolyRing("x", ZZ, 'lex').order == lex
42. 
43.     R1 = PolyRing("x,y", ZZ, lex)
44.     R2 = PolyRing("x,y", ZZ, lex)
45.     R3 = PolyRing("x,y,z", ZZ, lex)
46. 
47.     assert R1.x == R1.gens[0]
48.     assert R1.y == R1.gens[1]
49.     assert R1.x == R2.x
50.     assert R1.y == R2.y
51.     assert R1.x != R3.x
52.     assert R1.y != R3.y
53. 
54. def test_PolyRing___hash__():
55.     R, x, y, z = ring("x,y,z", QQ)
56.     assert hash(R)
57. 
58. def test_PolyRing___eq__():
59.     assert ring("x,y,z", QQ)[0] == ring("x,y,z", QQ)[0]
60.     assert ring("x,y,z", QQ)[0] is ring("x,y,z", QQ)[0]
61. 
62.     assert ring("x,y,z", QQ)[0] != ring("x,y,z", ZZ)[0]
63.     assert ring("x,y,z", QQ)[0] is not ring("x,y,z", ZZ)[0]
64. 
65.     assert ring("x,y,z", ZZ)[0] != ring("x,y,z", QQ)[0]
66.     assert ring("x,y,z", ZZ)[0] is not ring("x,y,z", QQ)[0]
67. 
68.     assert ring("x,y,z", QQ)[0] != ring("x,y", QQ)[0]
69.     assert ring("x,y,z", QQ)[0] is not ring("x,y", QQ)[0]
70. 
71.     assert ring("x,y", QQ)[0] != ring("x,y,z", QQ)[0]
72.     assert ring("x,y", QQ)[0] is not ring("x,y,z", QQ)[0]
73. 
74. def test_PolyRing_ring_new():
75.     R, x, y, z = ring("x,y,z", QQ)
76. 
77.     assert R.ring_new(7) == R(7)
78.     assert R.ring_new(7*x*y*z) == 7*x*y*z
79. 
80.     f = x**2 + 2*x*y + 3*x + 4*z**2 + 5*z + 6
81. 
82.     assert R.ring_new([[[1]], [[2], [3]], [[4, 5, 6]]]) == f
83.     assert R.ring_new({(2, 0, 0): 1, (1, 1, 0): 2, (1, 0, 0): 3, (0, 0, 2): 4, (0, 0, 1): 5, (0, 0, 0): 6}) == f
84.     assert R.ring_new([((2, 0, 0), 1), ((1, 1, 0), 2), ((1, 0, 0), 3), ((0, 0, 2), 4), ((0, 0, 1), 5), ((0, 0, 0), 6)]) == f
85. 
86.     R, = ring("", QQ)
87.     assert R.ring_new([((), 7)]) == R(7)
88. 
89. def test_PolyRing_drop():
90.     R, x,y,z = ring("x,y,z", ZZ)
91. 
92.     assert R.drop(x) == PolyRing("y,z", ZZ, lex)
93.     assert R.drop(y) == PolyRing("x,z", ZZ, lex)
94.     assert R.drop(z) == PolyRing("x,y", ZZ, lex)
95. 
96.     assert R.drop(0) == PolyRing("y,z", ZZ, lex)
97.     assert R.drop(0).drop(0) == PolyRing("z", ZZ, lex)
98.     assert R.drop(0).drop(0).drop(0) == ZZ
99. 
100.     assert R.drop(1) == PolyRing("x,z", ZZ, lex)
101. 
102.     assert R.drop(2) == PolyRing("x,y", ZZ, lex)
103.     assert R.drop(2).drop(1) == PolyRing("x", ZZ, lex)
104.     assert R.drop(2).drop(1).drop(0) == ZZ
105. 
106.     raises(ValueError, lambda: R.drop(3))
107.     raises(ValueError, lambda: R.drop(x).drop(y))
108. 
109. def test_PolyRing___getitem__():
110.     R, x,y,z = ring("x,y,z", ZZ)
111. 
112.     assert R[0:] == PolyRing("x,y,z", ZZ, lex)
113.     assert R[1:] == PolyRing("y,z", ZZ, lex)
114.     assert R[2:] == PolyRing("z", ZZ, lex)
115.     assert R[3:] == ZZ
116. 
117. def test_PolyRing_is_():
118.     R = PolyRing("x", QQ, lex)
119. 
120.     assert R.is_univariate is True
121.     assert R.is_multivariate is False
122. 
123.     R = PolyRing("x,y,z", QQ, lex)
124. 
125.     assert R.is_univariate is False
126.     assert R.is_multivariate is True
127. 
128.     R = PolyRing("", QQ, lex)
129. 
130.     assert R.is_univariate is False
131.     assert R.is_multivariate is False
132. 
133. def test_PolyRing_add():
134.     R, x = ring("x", ZZ)
135.     F = [ x**2 + 2*i + 3 for i in range(4) ]
136. 
137.     assert R.add(F) == reduce(add, F) == 4*x**2 + 24
138. 
139.     R, = ring("", ZZ)
140. 
141.     assert R.add([2, 5, 7]) == 14
142. 
143. def test_PolyRing_mul():
144.     R, x = ring("x", ZZ)
145.     F = [ x**2 + 2*i + 3 for i in range(4) ]
146. 
147.     assert R.mul(F) == reduce(mul, F) == x**8 + 24*x**6 + 206*x**4 + 744*x**2 + 945
148. 
149.     R, = ring("", ZZ)
150. 
151.     assert R.mul([2, 3, 5]) == 30
152. 
153. def test_sring():
154.     x, y, z, t = symbols("x,y,z,t")
155. 
156.     R = PolyRing("x,y,z", ZZ, lex)
157.     assert sring(x + 2*y + 3*z) == (R, R.x + 2*R.y + 3*R.z)
158. 
159.     R = PolyRing("x,y,z", QQ, lex)
160.     assert sring(x + 2*y + z/3) == (R, R.x + 2*R.y + R.z/3)
161.     assert sring([x, 2*y, z/3]) == (R, [R.x, 2*R.y, R.z/3])
162. 
163.     Rt = PolyRing("t", ZZ, lex)
164.     R = PolyRing("x,y,z", Rt, lex)
165.     assert sring(x + 2*t*y + 3*t**2*z, x, y, z) == (R, R.x + 2*Rt.t*R.y + 3*Rt.t**2*R.z)
166. 
167.     Rt = PolyRing("t", QQ, lex)
168.     R = PolyRing("x,y,z", Rt, lex)
169.     assert sring(x + t*y/2 + t**2*z/3, x, y, z) == (R, R.x + Rt.t*R.y/2 + Rt.t**2*R.z/3)
170. 
171.     Rt = FracField("t", ZZ, lex)
172.     R = PolyRing("x,y,z", Rt, lex)
173.     assert sring(x + 2*y/t + t**2*z/3, x, y, z) == (R, R.x + 2*R.y/Rt.t + Rt.t**2*R.z/3)
174. 
175.     r = sqrt(2) - sqrt(3)
176.     R, a = sring(r, extension=True)
177.     assert R.domain == QQ.algebraic_field(sqrt(2) + sqrt(3))
178.     assert R.gens == ()
179.     assert a == R.domain.from_sympy(r)
180. 
181. def test_PolyElement___hash__():
182.     R, x, y, z = ring("x,y,z", QQ)
183.     assert hash(x*y*z)
184. 
185. def test_PolyElement___eq__():
186.     R, x, y = ring("x,y", ZZ, lex)
187. 
188.     assert ((x*y + 5*x*y) == 6) == False
189.     assert ((x*y + 5*x*y) == 6*x*y) == True
190.     assert (6 == (x*y + 5*x*y)) == False
191.     assert (6*x*y == (x*y + 5*x*y)) == True
192. 
193.     assert ((x*y - x*y) == 0) == True
194.     assert (0 == (x*y - x*y)) == True
195. 
196.     assert ((x*y - x*y) == 1) == False
197.     assert (1 == (x*y - x*y)) == False
198. 
199.     assert ((x*y - x*y) == 1) == False
200.     assert (1 == (x*y - x*y)) == False
201. 
202.     assert ((x*y + 5*x*y) != 6) == True
203.     assert ((x*y + 5*x*y) != 6*x*y) == False
204.     assert (6 != (x*y + 5*x*y)) == True
205.     assert (6*x*y != (x*y + 5*x*y)) == False
206. 
207.     assert ((x*y - x*y) != 0) == False
208.     assert (0 != (x*y - x*y)) == False
209. 
210.     assert ((x*y - x*y) != 1) == True
211.     assert (1 != (x*y - x*y)) == True
212. 
213.     assert R.one == QQ(1, 1) == R.one
214.     assert R.one == 1 == R.one
215. 
216.     Rt, t = ring("t", ZZ)
217.     R, x, y = ring("x,y", Rt)
218. 
219.     assert (t**3*x/x == t**3) == True
220.     assert (t**3*x/x == t**4) == False
221. 
222. def test_PolyElement__lt_le_gt_ge__():
223.     R, x, y = ring("x,y", ZZ)
224. 
225.     assert R(1) < x < x**2 < x**3
226.     assert R(1) <= x <= x**2 <= x**3
227. 
228.     assert x**3 > x**2 > x > R(1)
229.     assert x**3 >= x**2 >= x >= R(1)
230. 
231. def test_PolyElement__str__():
232.     x, y = symbols('x, y')
233. 
234.     for dom in [ZZ, QQ, ZZ[x], ZZ[x,y], ZZ[x][y]]:
235.         R, t = ring('t', dom)
236.         assert str(2*t**2 + 1) == '2*t**2 + 1'
237. 
238.     for dom in [EX, EX[x]]:
239.         R, t = ring('t', dom)
240.         assert str(2*t**2 + 1) == 'EX(2)*t**2 + EX(1)'
241. 
242. def test_PolyElement_copy():
243.     R, x, y, z = ring("x,y,z", ZZ)
244. 
245.     f = x*y + 3*z
246.     g = f.copy()
247. 
248.     assert f == g
249.     g[(1, 1, 1)] = 7
250.     assert f != g
251. 
252. def test_PolyElement_as_expr():
253.     R, x, y, z = ring("x,y,z", ZZ)
254.     f = 3*x**2*y - x*y*z + 7*z**3 + 1
255. 
256.     X, Y, Z = R.symbols
257.     g = 3*X**2*Y - X*Y*Z + 7*Z**3 + 1
258. 
259.     assert f != g
260.     assert f.as_expr() == g
261. 
262.     X, Y, Z = symbols("x,y,z")
263.     g = 3*X**2*Y - X*Y*Z + 7*Z**3 + 1
264. 
265.     assert f != g
266.     assert f.as_expr(X, Y, Z) == g
267. 
268.     raises(ValueError, lambda: f.as_expr(X))
269. 
270.     R, = ring("", ZZ)
271.     assert R(3).as_expr() == 3
272. 
273. def test_PolyElement_from_expr():
274.     x, y, z = symbols("x,y,z")
275.     R, X, Y, Z = ring((x, y, z), ZZ)
276. 
277.     f = R.from_expr(1)
278.     assert f == 1 and isinstance(f, R.dtype)
279. 
280.     f = R.from_expr(x)
281.     assert f == X and isinstance(f, R.dtype)
282. 
283.     f = R.from_expr(x*y*z)
284.     assert f == X*Y*Z and isinstance(f, R.dtype)
285. 
286.     f = R.from_expr(x*y*z + x*y + x)
287.     assert f == X*Y*Z + X*Y + X and isinstance(f, R.dtype)
288. 
289.     f = R.from_expr(x**3*y*z + x**2*y**7 + 1)
290.     assert f == X**3*Y*Z + X**2*Y**7 + 1 and isinstance(f, R.dtype)
291. 
292.     r, F = sring([exp(2)])
293.     f = r.from_expr(exp(2))
294.     assert f == F[0] and isinstance(f, r.dtype)
295. 
296.     raises(ValueError, lambda: R.from_expr(1/x))
297.     raises(ValueError, lambda: R.from_expr(2**x))
298.     raises(ValueError, lambda: R.from_expr(7*x + sqrt(2)))
299. 
300.     R, = ring("", ZZ)
301.     f = R.from_expr(1)
302.     assert f == 1 and isinstance(f, R.dtype)
303. 
304. def test_PolyElement_degree():
305.     R, x,y,z = ring("x,y,z", ZZ)
306. 
307.     assert R(0).degree() is -oo
308.     assert R(1).degree() == 0
309.     assert (x + 1).degree() == 1
310.     assert (2*y**3 + z).degree() == 0
311.     assert (x*y**3 + z).degree() == 1
312.     assert (x**5*y**3 + z).degree() == 5
313. 
314.     assert R(0).degree(x) is -oo
315.     assert R(1).degree(x) == 0
316.     assert (x + 1).degree(x) == 1
317.     assert (2*y**3 + z).degree(x) == 0
318.     assert (x*y**3 + z).degree(x) == 1
319.     assert (7*x**5*y**3 + z).degree(x) == 5
320. 
321.     assert R(0).degree(y) is -oo
322.     assert R(1).degree(y) == 0
323.     assert (x + 1).degree(y) == 0
324.     assert (2*y**3 + z).degree(y) == 3
325.     assert (x*y**3 + z).degree(y) == 3
326.     assert (7*x**5*y**3 + z).degree(y) == 3
327. 
328.     assert R(0).degree(z) is -oo
329.     assert R(1).degree(z) == 0
330.     assert (x + 1).degree(z) == 0
331.     assert (2*y**3 + z).degree(z) == 1
332.     assert (x*y**3 + z).degree(z) == 1
333.     assert (7*x**5*y**3 + z).degree(z) == 1
334. 
335.     R, = ring("", ZZ)
336.     assert R(0).degree() is -oo
337.     assert R(1).degree() == 0
338. 
339. def test_PolyElement_tail_degree():
340.     R, x,y,z = ring("x,y,z", ZZ)
341. 
342.     assert R(0).tail_degree() is -oo
343.     assert R(1).tail_degree() == 0
344.     assert (x + 1).tail_degree() == 0
345.     assert (2*y**3 + x**3*z).tail_degree() == 0
346.     assert (x*y**3 + x**3*z).tail_degree() == 1
347.     assert (x**5*y**3 + x**3*z).tail_degree() == 3
348. 
349.     assert R(0).tail_degree(x) is -oo
350.     assert R(1).tail_degree(x) == 0
351.     assert (x + 1).tail_degree(x) == 0
352.     assert (2*y**3 + x**3*z).tail_degree(x) == 0
353.     assert (x*y**3 + x**3*z).tail_degree(x) == 1
354.     assert (7*x**5*y**3 + x**3*z).tail_degree(x) == 3
355. 
356.     assert R(0).tail_degree(y) is -oo
357.     assert R(1).tail_degree(y) == 0
358.     assert (x + 1).tail_degree(y) == 0
359.     assert (2*y**3 + x**3*z).tail_degree(y) == 0
360.     assert (x*y**3 + x**3*z).tail_degree(y) == 0
361.     assert (7*x**5*y**3 + x**3*z).tail_degree(y) == 0
362. 
363.     assert R(0).tail_degree(z) is -oo
364.     assert R(1).tail_degree(z) == 0
365.     assert (x + 1).tail_degree(z) == 0
366.     assert (2*y**3 + x**3*z).tail_degree(z) == 0
367.     assert (x*y**3 + x**3*z).tail_degree(z) == 0
368.     assert (7*x**5*y**3 + x**3*z).tail_degree(z) == 0
369. 
370.     R, = ring("", ZZ)
371.     assert R(0).tail_degree() is -oo
372.     assert R(1).tail_degree() == 0
373. 
374. def test_PolyElement_degrees():
375.     R, x,y,z = ring("x,y,z", ZZ)
376. 
377.     assert R(0).degrees() == (-oo, -oo, -oo)
378.     assert R(1).degrees() == (0, 0, 0)
379.     assert (x**2*y + x**3*z**2).degrees() == (3, 1, 2)
380. 
381. def test_PolyElement_tail_degrees():
382.     R, x,y,z = ring("x,y,z", ZZ)
383. 
384.     assert R(0).tail_degrees() == (-oo, -oo, -oo)
385.     assert R(1).tail_degrees() == (0, 0, 0)
386.     assert (x**2*y + x**3*z**2).tail_degrees() == (2, 0, 0)
387. 
388. def test_PolyElement_coeff():
389.     R, x, y, z = ring("x,y,z", ZZ, lex)
390.     f = 3*x**2*y - x*y*z + 7*z**3 + 23
391. 
392.     assert f.coeff(1) == 23
393.     raises(ValueError, lambda: f.coeff(3))
394. 
395.     assert f.coeff(x) == 0
396.     assert f.coeff(y) == 0
397.     assert f.coeff(z) == 0
398. 
399.     assert f.coeff(x**2*y) == 3
400.     assert f.coeff(x*y*z) == -1
401.     assert f.coeff(z**3) == 7
402. 
403.     raises(ValueError, lambda: f.coeff(3*x**2*y))
404.     raises(ValueError, lambda: f.coeff(-x*y*z))
405.     raises(ValueError, lambda: f.coeff(7*z**3))
406. 
407.     R, = ring("", ZZ)
408.     assert R(3).coeff(1) == 3
409. 
410. def test_PolyElement_LC():
411.     R, x, y = ring("x,y", QQ, lex)
412.     assert R(0).LC == QQ(0)
413.     assert (QQ(1,2)*x).LC == QQ(1, 2)
414.     assert (QQ(1,4)*x*y + QQ(1,2)*x).LC == QQ(1, 4)
415. 
416. def test_PolyElement_LM():
417.     R, x, y = ring("x,y", QQ, lex)
418.     assert R(0).LM == (0, 0)
419.     assert (QQ(1,2)*x).LM == (1, 0)
420.     assert (QQ(1,4)*x*y + QQ(1,2)*x).LM == (1, 1)
421. 
422. def test_PolyElement_LT():
423.     R, x, y = ring("x,y", QQ, lex)
424.     assert R(0).LT == ((0, 0), QQ(0))
425.     assert (QQ(1,2)*x).LT == ((1, 0), QQ(1, 2))
426.     assert (QQ(1,4)*x*y + QQ(1,2)*x).LT == ((1, 1), QQ(1, 4))
427. 
428.     R, = ring("", ZZ)
429.     assert R(0).LT == ((), 0)
430.     assert R(1).LT == ((), 1)
431. 
432. def test_PolyElement_leading_monom():
433.     R, x, y = ring("x,y", QQ, lex)
434.     assert R(0).leading_monom() == 0
435.     assert (QQ(1,2)*x).leading_monom() == x
436.     assert (QQ(1,4)*x*y + QQ(1,2)*x).leading_monom() == x*y
437. 
438. def test_PolyElement_leading_term():
439.     R, x, y = ring("x,y", QQ, lex)
440.     assert R(0).leading_term() == 0
441.     assert (QQ(1,2)*x).leading_term() == QQ(1,2)*x
442.     assert (QQ(1,4)*x*y + QQ(1,2)*x).leading_term() == QQ(1,4)*x*y
443. 
444. def test_PolyElement_terms():
445.     R, x,y,z = ring("x,y,z", QQ)
446.     terms = (x**2/3 + y**3/4 + z**4/5).terms()
447.     assert terms == [((2,0,0), QQ(1,3)), ((0,3,0), QQ(1,4)), ((0,0,4), QQ(1,5))]
448. 
449.     R, x,y = ring("x,y", ZZ, lex)
450.     f = x*y**7 + 2*x**2*y**3
451. 
452.     assert f.terms() == f.terms(lex) == f.terms('lex') == [((2, 3), 2), ((1, 7), 1)]
453.     assert f.terms(grlex) == f.terms('grlex') == [((1, 7), 1), ((2, 3), 2)]
454. 
455.     R, x,y = ring("x,y", ZZ, grlex)
456.     f = x*y**7 + 2*x**2*y**3
457. 
458.     assert f.terms() == f.terms(grlex) == f.terms('grlex') == [((1, 7), 1), ((2, 3), 2)]
459.     assert f.terms(lex) == f.terms('lex') == [((2, 3), 2), ((1, 7), 1)]
460. 
461.     R, = ring("", ZZ)
462.     assert R(3).terms() == [((), 3)]
463. 
464. def test_PolyElement_monoms():
465.     R, x,y,z = ring("x,y,z", QQ)
466.     monoms = (x**2/3 + y**3/4 + z**4/5).monoms()
467.     assert monoms == [(2,0,0), (0,3,0), (0,0,4)]
468. 
469.     R, x,y = ring("x,y", ZZ, lex)
470.     f = x*y**7 + 2*x**2*y**3
471. 
472.     assert f.monoms() == f.monoms(lex) == f.monoms('lex') == [(2, 3), (1, 7)]
473.     assert f.monoms(grlex) == f.monoms('grlex') == [(1, 7), (2, 3)]
474. 
475.     R, x,y = ring("x,y", ZZ, grlex)
476.     f = x*y**7 + 2*x**2*y**3
477. 
478.     assert f.monoms() == f.monoms(grlex) == f.monoms('grlex') == [(1, 7), (2, 3)]
479.     assert f.monoms(lex) == f.monoms('lex') == [(2, 3), (1, 7)]
480. 
481. def test_PolyElement_coeffs():
482.     R, x,y,z = ring("x,y,z", QQ)
483.     coeffs = (x**2/3 + y**3/4 + z**4/5).coeffs()
484.     assert coeffs == [QQ(1,3), QQ(1,4), QQ(1,5)]
485. 
486.     R, x,y = ring("x,y", ZZ, lex)
487.     f = x*y**7 + 2*x**2*y**3
488. 
489.     assert f.coeffs() == f.coeffs(lex) == f.coeffs('lex') == [2, 1]
490.     assert f.coeffs(grlex) == f.coeffs('grlex') == [1, 2]
491. 
492.     R, x,y = ring("x,y", ZZ, grlex)
493.     f = x*y**7 + 2*x**2*y**3
494. 
495.     assert f.coeffs() == f.coeffs(grlex) == f.coeffs('grlex') == [1, 2]
496.     assert f.coeffs(lex) == f.coeffs('lex') == [2, 1]
497. 
498. def test_PolyElement___add__():
499.     Rt, t = ring("t", ZZ)
500.     Ruv, u,v = ring("u,v", ZZ)


File: sympy/polys/tests/test_rings.py
Line number range: 501 - 1000
Content:
501.     Rxyz, x,y,z = ring("x,y,z", Ruv)
502. 
503.     assert dict(x + 3*y) == {(1, 0, 0): 1, (0, 1, 0): 3}
504. 
505.     assert dict(u + x) == dict(x + u) == {(1, 0, 0): 1, (0, 0, 0): u}
506.     assert dict(u + x*y) == dict(x*y + u) == {(1, 1, 0): 1, (0, 0, 0): u}
507.     assert dict(u + x*y + z) == dict(x*y + z + u) == {(1, 1, 0): 1, (0, 0, 1): 1, (0, 0, 0): u}
508. 
509.     assert dict(u*x + x) == dict(x + u*x) == {(1, 0, 0): u + 1}
510.     assert dict(u*x + x*y) == dict(x*y + u*x) == {(1, 1, 0): 1, (1, 0, 0): u}
511.     assert dict(u*x + x*y + z) == dict(x*y + z + u*x) == {(1, 1, 0): 1, (0, 0, 1): 1, (1, 0, 0): u}
512. 
513.     raises(TypeError, lambda: t + x)
514.     raises(TypeError, lambda: x + t)
515.     raises(TypeError, lambda: t + u)
516.     raises(TypeError, lambda: u + t)
517. 
518.     Fuv, u,v = field("u,v", ZZ)
519.     Rxyz, x,y,z = ring("x,y,z", Fuv)
520. 
521.     assert dict(u + x) == dict(x + u) == {(1, 0, 0): 1, (0, 0, 0): u}
522. 
523.     Rxyz, x,y,z = ring("x,y,z", EX)
524. 
525.     assert dict(EX(pi) + x*y*z) == dict(x*y*z + EX(pi)) == {(1, 1, 1): EX(1), (0, 0, 0): EX(pi)}
526. 
527. def test_PolyElement___sub__():
528.     Rt, t = ring("t", ZZ)
529.     Ruv, u,v = ring("u,v", ZZ)
530.     Rxyz, x,y,z = ring("x,y,z", Ruv)
531. 
532.     assert dict(x - 3*y) == {(1, 0, 0): 1, (0, 1, 0): -3}
533. 
534.     assert dict(-u + x) == dict(x - u) == {(1, 0, 0): 1, (0, 0, 0): -u}
535.     assert dict(-u + x*y) == dict(x*y - u) == {(1, 1, 0): 1, (0, 0, 0): -u}
536.     assert dict(-u + x*y + z) == dict(x*y + z - u) == {(1, 1, 0): 1, (0, 0, 1): 1, (0, 0, 0): -u}
537. 
538.     assert dict(-u*x + x) == dict(x - u*x) == {(1, 0, 0): -u + 1}
539.     assert dict(-u*x + x*y) == dict(x*y - u*x) == {(1, 1, 0): 1, (1, 0, 0): -u}
540.     assert dict(-u*x + x*y + z) == dict(x*y + z - u*x) == {(1, 1, 0): 1, (0, 0, 1): 1, (1, 0, 0): -u}
541. 
542.     raises(TypeError, lambda: t - x)
543.     raises(TypeError, lambda: x - t)
544.     raises(TypeError, lambda: t - u)
545.     raises(TypeError, lambda: u - t)
546. 
547.     Fuv, u,v = field("u,v", ZZ)
548.     Rxyz, x,y,z = ring("x,y,z", Fuv)
549. 
550.     assert dict(-u + x) == dict(x - u) == {(1, 0, 0): 1, (0, 0, 0): -u}
551. 
552.     Rxyz, x,y,z = ring("x,y,z", EX)
553. 
554.     assert dict(-EX(pi) + x*y*z) == dict(x*y*z - EX(pi)) == {(1, 1, 1): EX(1), (0, 0, 0): -EX(pi)}
555. 
556. def test_PolyElement___mul__():
557.     Rt, t = ring("t", ZZ)
558.     Ruv, u,v = ring("u,v", ZZ)
559.     Rxyz, x,y,z = ring("x,y,z", Ruv)
560. 
561.     assert dict(u*x) == dict(x*u) == {(1, 0, 0): u}
562. 
563.     assert dict(2*u*x + z) == dict(x*2*u + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
564.     assert dict(u*2*x + z) == dict(2*x*u + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
565.     assert dict(2*u*x + z) == dict(x*2*u + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
566.     assert dict(u*x*2 + z) == dict(x*u*2 + z) == {(1, 0, 0): 2*u, (0, 0, 1): 1}
567. 
568.     assert dict(2*u*x*y + z) == dict(x*y*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
569.     assert dict(u*2*x*y + z) == dict(2*x*y*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
570.     assert dict(2*u*x*y + z) == dict(x*y*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
571.     assert dict(u*x*y*2 + z) == dict(x*y*u*2 + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
572. 
573.     assert dict(2*u*y*x + z) == dict(y*x*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
574.     assert dict(u*2*y*x + z) == dict(2*y*x*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
575.     assert dict(2*u*y*x + z) == dict(y*x*2*u + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
576.     assert dict(u*y*x*2 + z) == dict(y*x*u*2 + z) == {(1, 1, 0): 2*u, (0, 0, 1): 1}
577. 
578.     assert dict(3*u*(x + y) + z) == dict((x + y)*3*u + z) == {(1, 0, 0): 3*u, (0, 1, 0): 3*u, (0, 0, 1): 1}
579. 
580.     raises(TypeError, lambda: t*x + z)
581.     raises(TypeError, lambda: x*t + z)
582.     raises(TypeError, lambda: t*u + z)
583.     raises(TypeError, lambda: u*t + z)
584. 
585.     Fuv, u,v = field("u,v", ZZ)
586.     Rxyz, x,y,z = ring("x,y,z", Fuv)
587. 
588.     assert dict(u*x) == dict(x*u) == {(1, 0, 0): u}
589. 
590.     Rxyz, x,y,z = ring("x,y,z", EX)
591. 
592.     assert dict(EX(pi)*x*y*z) == dict(x*y*z*EX(pi)) == {(1, 1, 1): EX(pi)}
593. 
594. def test_PolyElement___truediv__():
595.     R, x,y,z = ring("x,y,z", ZZ)
596. 
597.     assert (2*x**2 - 4)/2 == x**2 - 2
598.     assert (2*x**2 - 3)/2 == x**2
599. 
600.     assert (x**2 - 1).quo(x) == x
601.     assert (x**2 - x).quo(x) == x - 1
602. 
603.     assert (x**2 - 1)/x == x - x**(-1)
604.     assert (x**2 - x)/x == x - 1
605.     assert (x**2 - 1)/(2*x) == x/2 - x**(-1)/2
606. 
607.     assert (x**2 - 1).quo(2*x) == 0
608.     assert (x**2 - x)/(x - 1) == (x**2 - x).quo(x - 1) == x
609. 
610. 
611.     R, x,y,z = ring("x,y,z", ZZ)
612.     assert len((x**2/3 + y**3/4 + z**4/5).terms()) == 0
613. 
614.     R, x,y,z = ring("x,y,z", QQ)
615.     assert len((x**2/3 + y**3/4 + z**4/5).terms()) == 3
616. 
617.     Rt, t = ring("t", ZZ)
618.     Ruv, u,v = ring("u,v", ZZ)
619.     Rxyz, x,y,z = ring("x,y,z", Ruv)
620. 
621.     assert dict((u**2*x + u)/u) == {(1, 0, 0): u, (0, 0, 0): 1}
622.     raises(TypeError, lambda: u/(u**2*x + u))
623. 
624.     raises(TypeError, lambda: t/x)
625.     raises(TypeError, lambda: x/t)
626.     raises(TypeError, lambda: t/u)
627.     raises(TypeError, lambda: u/t)
628. 
629.     R, x = ring("x", ZZ)
630.     f, g = x**2 + 2*x + 3, R(0)
631. 
632.     raises(ZeroDivisionError, lambda: f.div(g))
633.     raises(ZeroDivisionError, lambda: divmod(f, g))
634.     raises(ZeroDivisionError, lambda: f.rem(g))
635.     raises(ZeroDivisionError, lambda: f % g)
636.     raises(ZeroDivisionError, lambda: f.quo(g))
637.     raises(ZeroDivisionError, lambda: f / g)
638.     raises(ZeroDivisionError, lambda: f.exquo(g))
639. 
640.     R, x, y = ring("x,y", ZZ)
641.     f, g = x*y + 2*x + 3, R(0)
642. 
643.     raises(ZeroDivisionError, lambda: f.div(g))
644.     raises(ZeroDivisionError, lambda: divmod(f, g))
645.     raises(ZeroDivisionError, lambda: f.rem(g))
646.     raises(ZeroDivisionError, lambda: f % g)
647.     raises(ZeroDivisionError, lambda: f.quo(g))
648.     raises(ZeroDivisionError, lambda: f / g)
649.     raises(ZeroDivisionError, lambda: f.exquo(g))
650. 
651.     R, x = ring("x", ZZ)
652. 
653.     f, g = x**2 + 1, 2*x - 4
654.     q, r = R(0), x**2 + 1
655. 
656.     assert f.div(g) == divmod(f, g) == (q, r)
657.     assert f.rem(g) == f % g == r
658.     assert f.quo(g) == f / g == q
659.     raises(ExactQuotientFailed, lambda: f.exquo(g))
660. 
661.     f, g = 3*x**3 + x**2 + x + 5, 5*x**2 - 3*x + 1
662.     q, r = R(0), f
663. 
664.     assert f.div(g) == divmod(f, g) == (q, r)
665.     assert f.rem(g) == f % g == r
666.     assert f.quo(g) == f / g == q
667.     raises(ExactQuotientFailed, lambda: f.exquo(g))
668. 
669.     f, g = 5*x**4 + 4*x**3 + 3*x**2 + 2*x + 1, x**2 + 2*x + 3
670.     q, r = 5*x**2 - 6*x, 20*x + 1
671. 
672.     assert f.div(g) == divmod(f, g) == (q, r)
673.     assert f.rem(g) == f % g == r
674.     assert f.quo(g) == f / g == q
675.     raises(ExactQuotientFailed, lambda: f.exquo(g))
676. 
677.     f, g = 5*x**5 + 4*x**4 + 3*x**3 + 2*x**2 + x, x**4 + 2*x**3 + 9
678.     q, r = 5*x - 6, 15*x**3 + 2*x**2 - 44*x + 54
679. 
680.     assert f.div(g) == divmod(f, g) == (q, r)
681.     assert f.rem(g) == f % g == r
682.     assert f.quo(g) == f / g == q
683.     raises(ExactQuotientFailed, lambda: f.exquo(g))
684. 
685.     R, x = ring("x", QQ)
686. 
687.     f, g = x**2 + 1, 2*x - 4
688.     q, r = x/2 + 1, R(5)
689. 
690.     assert f.div(g) == divmod(f, g) == (q, r)
691.     assert f.rem(g) == f % g == r
692.     assert f.quo(g) == f / g == q
693.     raises(ExactQuotientFailed, lambda: f.exquo(g))
694. 
695.     f, g = 3*x**3 + x**2 + x + 5, 5*x**2 - 3*x + 1
696.     q, r = QQ(3, 5)*x + QQ(14, 25), QQ(52, 25)*x + QQ(111, 25)
697. 
698.     assert f.div(g) == divmod(f, g) == (q, r)
699.     assert f.rem(g) == f % g == r
700.     assert f.quo(g) == f / g == q
701.     raises(ExactQuotientFailed, lambda: f.exquo(g))
702. 
703.     R, x,y = ring("x,y", ZZ)
704. 
705.     f, g = x**2 - y**2, x - y
706.     q, r = x + y, R(0)
707. 
708.     assert f.div(g) == divmod(f, g) == (q, r)
709.     assert f.rem(g) == f % g == r
710.     assert f.quo(g) == f / g == q
711.     assert f.exquo(g) == q
712. 
713.     f, g = x**2 + y**2, x - y
714.     q, r = x + y, 2*y**2
715. 
716.     assert f.div(g) == divmod(f, g) == (q, r)
717.     assert f.rem(g) == f % g == r
718.     assert f.quo(g) == f / g == q
719.     raises(ExactQuotientFailed, lambda: f.exquo(g))
720. 
721.     f, g = x**2 + y**2, -x + y
722.     q, r = -x - y, 2*y**2
723. 
724.     assert f.div(g) == divmod(f, g) == (q, r)
725.     assert f.rem(g) == f % g == r
726.     assert f.quo(g) == f / g == q
727.     raises(ExactQuotientFailed, lambda: f.exquo(g))
728. 
729.     f, g = x**2 + y**2, 2*x - 2*y
730.     q, r = R(0), f
731. 
732.     assert f.div(g) == divmod(f, g) == (q, r)
733.     assert f.rem(g) == f % g == r
734.     assert f.quo(g) == f / g == q
735.     raises(ExactQuotientFailed, lambda: f.exquo(g))
736. 
737.     R, x,y = ring("x,y", QQ)
738. 
739.     f, g = x**2 - y**2, x - y
740.     q, r = x + y, R(0)
741. 
742.     assert f.div(g) == divmod(f, g) == (q, r)
743.     assert f.rem(g) == f % g == r
744.     assert f.quo(g) == f / g == q
745.     assert f.exquo(g) == q
746. 
747.     f, g = x**2 + y**2, x - y
748.     q, r = x + y, 2*y**2
749. 
750.     assert f.div(g) == divmod(f, g) == (q, r)
751.     assert f.rem(g) == f % g == r
752.     assert f.quo(g) == f / g == q
753.     raises(ExactQuotientFailed, lambda: f.exquo(g))
754. 
755.     f, g = x**2 + y**2, -x + y
756.     q, r = -x - y, 2*y**2
757. 
758.     assert f.div(g) == divmod(f, g) == (q, r)
759.     assert f.rem(g) == f % g == r
760.     assert f.quo(g) == f / g == q
761.     raises(ExactQuotientFailed, lambda: f.exquo(g))
762. 
763.     f, g = x**2 + y**2, 2*x - 2*y
764.     q, r = x/2 + y/2, 2*y**2
765. 
766.     assert f.div(g) == divmod(f, g) == (q, r)
767.     assert f.rem(g) == f % g == r
768.     assert f.quo(g) == f / g == q
769.     raises(ExactQuotientFailed, lambda: f.exquo(g))
770. 
771. def test_PolyElement___pow__():
772.     R, x = ring("x", ZZ, grlex)
773.     f = 2*x + 3
774. 
775.     assert f**0 == 1
776.     assert f**1 == f
777.     raises(ValueError, lambda: f**(-1))
778. 
779.     assert x**(-1) == x**(-1)
780. 
781.     assert f**2 == f._pow_generic(2) == f._pow_multinomial(2) == 4*x**2 + 12*x + 9
782.     assert f**3 == f._pow_generic(3) == f._pow_multinomial(3) == 8*x**3 + 36*x**2 + 54*x + 27
783.     assert f**4 == f._pow_generic(4) == f._pow_multinomial(4) == 16*x**4 + 96*x**3 + 216*x**2 + 216*x + 81
784.     assert f**5 == f._pow_generic(5) == f._pow_multinomial(5) == 32*x**5 + 240*x**4 + 720*x**3 + 1080*x**2 + 810*x + 243
785. 
786.     R, x,y,z = ring("x,y,z", ZZ, grlex)
787.     f = x**3*y - 2*x*y**2 - 3*z + 1
788.     g = x**6*y**2 - 4*x**4*y**3 - 6*x**3*y*z + 2*x**3*y + 4*x**2*y**4 + 12*x*y**2*z - 4*x*y**2 + 9*z**2 - 6*z + 1
789. 
790.     assert f**2 == f._pow_generic(2) == f._pow_multinomial(2) == g
791. 
792.     R, t = ring("t", ZZ)
793.     f = -11200*t**4 - 2604*t**2 + 49
794.     g = 15735193600000000*t**16 + 14633730048000000*t**14 + 4828147466240000*t**12 \
795.       + 598976863027200*t**10 + 3130812416256*t**8 - 2620523775744*t**6 \
796.       + 92413760096*t**4 - 1225431984*t**2 + 5764801
797. 
798.     assert f**4 == f._pow_generic(4) == f._pow_multinomial(4) == g
799. 
800. def test_PolyElement_div():
801.     R, x = ring("x", ZZ, grlex)
802. 
803.     f = x**3 - 12*x**2 - 42
804.     g = x - 3
805. 
806.     q = x**2 - 9*x - 27
807.     r = -123
808. 
809.     assert f.div([g]) == ([q], r)
810. 
811.     R, x = ring("x", ZZ, grlex)
812.     f = x**2 + 2*x + 2
813.     assert f.div([R(1)]) == ([f], 0)
814. 
815.     R, x = ring("x", QQ, grlex)
816.     f = x**2 + 2*x + 2
817.     assert f.div([R(2)]) == ([QQ(1,2)*x**2 + x + 1], 0)
818. 
819.     R, x,y = ring("x,y", ZZ, grlex)
820.     f = 4*x**2*y - 2*x*y + 4*x - 2*y + 8
821. 
822.     assert f.div([R(2)]) == ([2*x**2*y - x*y + 2*x - y + 4], 0)
823.     assert f.div([2*y]) == ([2*x**2 - x - 1], 4*x + 8)
824. 
825.     f = x - 1
826.     g = y - 1
827. 
828.     assert f.div([g]) == ([0], f)
829. 
830.     f = x*y**2 + 1
831.     G = [x*y + 1, y + 1]
832. 
833.     Q = [y, -1]
834.     r = 2
835. 
836.     assert f.div(G) == (Q, r)
837. 
838.     f = x**2*y + x*y**2 + y**2
839.     G = [x*y - 1, y**2 - 1]
840. 
841.     Q = [x + y, 1]
842.     r = x + y + 1
843. 
844.     assert f.div(G) == (Q, r)
845. 
846.     G = [y**2 - 1, x*y - 1]
847. 
848.     Q = [x + 1, x]
849.     r = 2*x + 1
850. 
851.     assert f.div(G) == (Q, r)
852. 
853.     R, = ring("", ZZ)
854.     assert R(3).div(R(2)) == (0, 3)
855. 
856.     R, = ring("", QQ)
857.     assert R(3).div(R(2)) == (QQ(3, 2), 0)
858. 
859. def test_PolyElement_rem():
860.     R, x = ring("x", ZZ, grlex)
861. 
862.     f = x**3 - 12*x**2 - 42
863.     g = x - 3
864.     r = -123
865. 
866.     assert f.rem([g]) == f.div([g])[1] == r
867. 
868.     R, x,y = ring("x,y", ZZ, grlex)
869. 
870.     f = 4*x**2*y - 2*x*y + 4*x - 2*y + 8
871. 
872.     assert f.rem([R(2)]) == f.div([R(2)])[1] == 0
873.     assert f.rem([2*y]) == f.div([2*y])[1] == 4*x + 8
874. 
875.     f = x - 1
876.     g = y - 1
877. 
878.     assert f.rem([g]) == f.div([g])[1] == f
879. 
880.     f = x*y**2 + 1
881.     G = [x*y + 1, y + 1]
882.     r = 2
883. 
884.     assert f.rem(G) == f.div(G)[1] == r
885. 
886.     f = x**2*y + x*y**2 + y**2
887.     G = [x*y - 1, y**2 - 1]
888.     r = x + y + 1
889. 
890.     assert f.rem(G) == f.div(G)[1] == r
891. 
892.     G = [y**2 - 1, x*y - 1]
893.     r = 2*x + 1
894. 
895.     assert f.rem(G) == f.div(G)[1] == r
896. 
897. def test_PolyElement_deflate():
898.     R, x = ring("x", ZZ)
899. 
900.     assert (2*x**2).deflate(x**4 + 4*x**2 + 1) == ((2,), [2*x, x**2 + 4*x + 1])
901. 
902.     R, x,y = ring("x,y", ZZ)
903. 
904.     assert R(0).deflate(R(0)) == ((1, 1), [0, 0])
905.     assert R(1).deflate(R(0)) == ((1, 1), [1, 0])
906.     assert R(1).deflate(R(2)) == ((1, 1), [1, 2])
907.     assert R(1).deflate(2*y) == ((1, 1), [1, 2*y])
908.     assert (2*y).deflate(2*y) == ((1, 1), [2*y, 2*y])
909.     assert R(2).deflate(2*y**2) == ((1, 2), [2, 2*y])
910.     assert (2*y**2).deflate(2*y**2) == ((1, 2), [2*y, 2*y])
911. 
912.     f = x**4*y**2 + x**2*y + 1
913.     g = x**2*y**3 + x**2*y + 1
914. 
915.     assert f.deflate(g) == ((2, 1), [x**2*y**2 + x*y + 1, x*y**3 + x*y + 1])
916. 
917. def test_PolyElement_clear_denoms():
918.     R, x,y = ring("x,y", QQ)
919. 
920.     assert R(1).clear_denoms() == (ZZ(1), 1)
921.     assert R(7).clear_denoms() == (ZZ(1), 7)
922. 
923.     assert R(QQ(7,3)).clear_denoms() == (3, 7)
924.     assert R(QQ(7,3)).clear_denoms() == (3, 7)
925. 
926.     assert (3*x**2 + x).clear_denoms() == (1, 3*x**2 + x)
927.     assert (x**2 + QQ(1,2)*x).clear_denoms() == (2, 2*x**2 + x)
928. 
929.     rQQ, x,t = ring("x,t", QQ, lex)
930.     rZZ, X,T = ring("x,t", ZZ, lex)
931. 
932.     F = [x - QQ(17824537287975195925064602467992950991718052713078834557692023531499318507213727406844943097,413954288007559433755329699713866804710749652268151059918115348815925474842910720000)*t**7
933.            - QQ(4882321164854282623427463828745855894130208215961904469205260756604820743234704900167747753,12936071500236232304854053116058337647210926633379720622441104650497671088840960000)*t**6
934.            - QQ(36398103304520066098365558157422127347455927422509913596393052633155821154626830576085097433,25872143000472464609708106232116675294421853266759441244882209300995342177681920000)*t**5
935.            - QQ(168108082231614049052707339295479262031324376786405372698857619250210703675982492356828810819,58212321751063045371843239022262519412449169850208742800984970927239519899784320000)*t**4
936.            - QQ(5694176899498574510667890423110567593477487855183144378347226247962949388653159751849449037,1617008937529529038106756639507292205901365829172465077805138081312208886105120000)*t**3
937.            - QQ(154482622347268833757819824809033388503591365487934245386958884099214649755244381307907779,60637835157357338929003373981523457721301218593967440417692678049207833228942000)*t**2
938.            - QQ(2452813096069528207645703151222478123259511586701148682951852876484544822947007791153163,2425513406294293557160134959260938308852048743758697616707707121968313329157680)*t
939.            - QQ(34305265428126440542854669008203683099323146152358231964773310260498715579162112959703,202126117191191129763344579938411525737670728646558134725642260164026110763140),
940.          t**8 + QQ(693749860237914515552,67859264524169150569)*t**7
941.               + QQ(27761407182086143225024,610733380717522355121)*t**6
942.               + QQ(7785127652157884044288,67859264524169150569)*t**5
943.               + QQ(36567075214771261409792,203577793572507451707)*t**4
944.               + QQ(36336335165196147384320,203577793572507451707)*t**3
945.               + QQ(7452455676042754048000,67859264524169150569)*t**2
946.               + QQ(2593331082514399232000,67859264524169150569)*t
947.               + QQ(390399197427343360000,67859264524169150569)]
948. 
949.     G = [3725588592068034903797967297424801242396746870413359539263038139343329273586196480000*X -
950.          160420835591776763325581422211936558925462474417709511019228211783493866564923546661604487873*T**7 -
951.          1406108495478033395547109582678806497509499966197028487131115097902188374051595011248311352864*T**6 -
952.          5241326875850889518164640374668786338033653548841427557880599579174438246266263602956254030352*T**5 -
953.          10758917262823299139373269714910672770004760114329943852726887632013485035262879510837043892416*T**4 -
954.          13119383576444715672578819534846747735372132018341964647712009275306635391456880068261130581248*T**3 -
955.          9491412317016197146080450036267011389660653495578680036574753839055748080962214787557853941760*T**2 -
956.          3767520915562795326943800040277726397326609797172964377014046018280260848046603967211258368000*T -
957.          632314652371226552085897259159210286886724229880266931574701654721512325555116066073245696000,
958.          610733380717522355121*T**8 +
959.          6243748742141230639968*T**7 +
960.          27761407182086143225024*T**6 +
961.          70066148869420956398592*T**5 +
962.          109701225644313784229376*T**4 +
963.          109009005495588442152960*T**3 +
964.          67072101084384786432000*T**2 +
965.          23339979742629593088000*T +
966.          3513592776846090240000]
967. 
968.     assert [ f.clear_denoms()[1].set_ring(rZZ) for f in F ] == G
969. 
970. def test_PolyElement_cofactors():
971.     R, x, y = ring("x,y", ZZ)
972. 
973.     f, g = R(0), R(0)
974.     assert f.cofactors(g) == (0, 0, 0)
975. 
976.     f, g = R(2), R(0)
977.     assert f.cofactors(g) == (2, 1, 0)
978. 
979.     f, g = R(-2), R(0)
980.     assert f.cofactors(g) == (2, -1, 0)
981. 
982.     f, g = R(0), R(-2)
983.     assert f.cofactors(g) == (2, 0, -1)
984. 
985.     f, g = R(0), 2*x + 4
986.     assert f.cofactors(g) == (2*x + 4, 0, 1)
987. 
988.     f, g = 2*x + 4, R(0)
989.     assert f.cofactors(g) == (2*x + 4, 1, 0)
990. 
991.     f, g = R(2), R(2)
992.     assert f.cofactors(g) == (2, 1, 1)
993. 
994.     f, g = R(-2), R(2)
995.     assert f.cofactors(g) == (2, -1, 1)
996. 
997.     f, g = R(2), R(-2)
998.     assert f.cofactors(g) == (2, 1, -1)
999. 
1000.     f, g = R(-2), R(-2)


File: sympy/polys/tests/test_rings.py
Line number range: 1001 - 1422
Content:
1001.     assert f.cofactors(g) == (2, -1, -1)
1002. 
1003.     f, g = x**2 + 2*x + 1, R(1)
1004.     assert f.cofactors(g) == (1, x**2 + 2*x + 1, 1)
1005. 
1006.     f, g = x**2 + 2*x + 1, R(2)
1007.     assert f.cofactors(g) == (1, x**2 + 2*x + 1, 2)
1008. 
1009.     f, g = 2*x**2 + 4*x + 2, R(2)
1010.     assert f.cofactors(g) == (2, x**2 + 2*x + 1, 1)
1011. 
1012.     f, g = R(2), 2*x**2 + 4*x + 2
1013.     assert f.cofactors(g) == (2, 1, x**2 + 2*x + 1)
1014. 
1015.     f, g = 2*x**2 + 4*x + 2, x + 1
1016.     assert f.cofactors(g) == (x + 1, 2*x + 2, 1)
1017. 
1018.     f, g = x + 1, 2*x**2 + 4*x + 2
1019.     assert f.cofactors(g) == (x + 1, 1, 2*x + 2)
1020. 
1021.     R, x, y, z, t = ring("x,y,z,t", ZZ)
1022. 
1023.     f, g = t**2 + 2*t + 1, 2*t + 2
1024.     assert f.cofactors(g) == (t + 1, t + 1, 2)
1025. 
1026.     f, g = z**2*t**2 + 2*z**2*t + z**2 + z*t + z, t**2 + 2*t + 1
1027.     h, cff, cfg = t + 1, z**2*t + z**2 + z, t + 1
1028. 
1029.     assert f.cofactors(g) == (h, cff, cfg)
1030.     assert g.cofactors(f) == (h, cfg, cff)
1031. 
1032.     R, x, y = ring("x,y", QQ)
1033. 
1034.     f = QQ(1,2)*x**2 + x + QQ(1,2)
1035.     g = QQ(1,2)*x + QQ(1,2)
1036. 
1037.     h = x + 1
1038. 
1039.     assert f.cofactors(g) == (h, g, QQ(1,2))
1040.     assert g.cofactors(f) == (h, QQ(1,2), g)
1041. 
1042.     R, x, y = ring("x,y", RR)
1043. 
1044.     f = 2.1*x*y**2 - 2.1*x*y + 2.1*x
1045.     g = 2.1*x**3
1046.     h = 1.0*x
1047. 
1048.     assert f.cofactors(g) == (h, f/h, g/h)
1049.     assert g.cofactors(f) == (h, g/h, f/h)
1050. 
1051. def test_PolyElement_gcd():
1052.     R, x, y = ring("x,y", QQ)
1053. 
1054.     f = QQ(1,2)*x**2 + x + QQ(1,2)
1055.     g = QQ(1,2)*x + QQ(1,2)
1056. 
1057.     assert f.gcd(g) == x + 1
1058. 
1059. def test_PolyElement_cancel():
1060.     R, x, y = ring("x,y", ZZ)
1061. 
1062.     f = 2*x**3 + 4*x**2 + 2*x
1063.     g = 3*x**2 + 3*x
1064.     F = 2*x + 2
1065.     G = 3
1066. 
1067.     assert f.cancel(g) == (F, G)
1068. 
1069.     assert (-f).cancel(g) == (-F, G)
1070.     assert f.cancel(-g) == (-F, G)
1071. 
1072.     R, x, y = ring("x,y", QQ)
1073. 
1074.     f = QQ(1,2)*x**3 + x**2 + QQ(1,2)*x
1075.     g = QQ(1,3)*x**2 + QQ(1,3)*x
1076.     F = 3*x + 3
1077.     G = 2
1078. 
1079.     assert f.cancel(g) == (F, G)
1080. 
1081.     assert (-f).cancel(g) == (-F, G)
1082.     assert f.cancel(-g) == (-F, G)
1083. 
1084.     Fx, x = field("x", ZZ)
1085.     Rt, t = ring("t", Fx)
1086. 
1087.     f = (-x**2 - 4)/4*t
1088.     g = t**2 + (x**2 + 2)/2
1089. 
1090.     assert f.cancel(g) == ((-x**2 - 4)*t, 4*t**2 + 2*x**2 + 4)
1091. 
1092. def test_PolyElement_max_norm():
1093.     R, x, y = ring("x,y", ZZ)
1094. 
1095.     assert R(0).max_norm() == 0
1096.     assert R(1).max_norm() == 1
1097. 
1098.     assert (x**3 + 4*x**2 + 2*x + 3).max_norm() == 4
1099. 
1100. def test_PolyElement_l1_norm():
1101.     R, x, y = ring("x,y", ZZ)
1102. 
1103.     assert R(0).l1_norm() == 0
1104.     assert R(1).l1_norm() == 1
1105. 
1106.     assert (x**3 + 4*x**2 + 2*x + 3).l1_norm() == 10
1107. 
1108. def test_PolyElement_diff():
1109.     R, X = xring("x:11", QQ)
1110. 
1111.     f = QQ(288,5)*X[0]**8*X[1]**6*X[4]**3*X[10]**2 + 8*X[0]**2*X[2]**3*X[4]**3 +2*X[0]**2 - 2*X[1]**2
1112. 
1113.     assert f.diff(X[0]) == QQ(2304,5)*X[0]**7*X[1]**6*X[4]**3*X[10]**2 + 16*X[0]*X[2]**3*X[4]**3 + 4*X[0]
1114.     assert f.diff(X[4]) == QQ(864,5)*X[0]**8*X[1]**6*X[4]**2*X[10]**2 + 24*X[0]**2*X[2]**3*X[4]**2
1115.     assert f.diff(X[10]) == QQ(576,5)*X[0]**8*X[1]**6*X[4]**3*X[10]
1116. 
1117. def test_PolyElement___call__():
1118.     R, x = ring("x", ZZ)
1119.     f = 3*x + 1
1120. 
1121.     assert f(0) == 1
1122.     assert f(1) == 4
1123. 
1124.     raises(ValueError, lambda: f())
1125.     raises(ValueError, lambda: f(0, 1))
1126. 
1127.     raises(CoercionFailed, lambda: f(QQ(1,7)))
1128. 
1129.     R, x,y = ring("x,y", ZZ)
1130.     f = 3*x + y**2 + 1
1131. 
1132.     assert f(0, 0) == 1
1133.     assert f(1, 7) == 53
1134. 
1135.     Ry = R.drop(x)
1136. 
1137.     assert f(0) == Ry.y**2 + 1
1138.     assert f(1) == Ry.y**2 + 4
1139. 
1140.     raises(ValueError, lambda: f())
1141.     raises(ValueError, lambda: f(0, 1, 2))
1142. 
1143.     raises(CoercionFailed, lambda: f(1, QQ(1,7)))
1144.     raises(CoercionFailed, lambda: f(QQ(1,7), 1))
1145.     raises(CoercionFailed, lambda: f(QQ(1,7), QQ(1,7)))
1146. 
1147. def test_PolyElement_evaluate():
1148.     R, x = ring("x", ZZ)
1149.     f = x**3 + 4*x**2 + 2*x + 3
1150. 
1151.     r = f.evaluate(x, 0)
1152.     assert r == 3 and not isinstance(r, PolyElement)
1153. 
1154.     raises(CoercionFailed, lambda: f.evaluate(x, QQ(1,7)))
1155. 
1156.     R, x, y, z = ring("x,y,z", ZZ)
1157.     f = (x*y)**3 + 4*(x*y)**2 + 2*x*y + 3
1158. 
1159.     r = f.evaluate(x, 0)
1160.     assert r == 3 and isinstance(r, R.drop(x).dtype)
1161.     r = f.evaluate([(x, 0), (y, 0)])
1162.     assert r == 3 and isinstance(r, R.drop(x, y).dtype)
1163.     r = f.evaluate(y, 0)
1164.     assert r == 3 and isinstance(r, R.drop(y).dtype)
1165.     r = f.evaluate([(y, 0), (x, 0)])
1166.     assert r == 3 and isinstance(r, R.drop(y, x).dtype)
1167. 
1168.     r = f.evaluate([(x, 0), (y, 0), (z, 0)])
1169.     assert r == 3 and not isinstance(r, PolyElement)
1170. 
1171.     raises(CoercionFailed, lambda: f.evaluate([(x, 1), (y, QQ(1,7))]))
1172.     raises(CoercionFailed, lambda: f.evaluate([(x, QQ(1,7)), (y, 1)]))
1173.     raises(CoercionFailed, lambda: f.evaluate([(x, QQ(1,7)), (y, QQ(1,7))]))
1174. 
1175. def test_PolyElement_subs():
1176.     R, x = ring("x", ZZ)
1177.     f = x**3 + 4*x**2 + 2*x + 3
1178. 
1179.     r = f.subs(x, 0)
1180.     assert r == 3 and isinstance(r, R.dtype)
1181. 
1182.     raises(CoercionFailed, lambda: f.subs(x, QQ(1,7)))
1183. 
1184.     R, x, y, z = ring("x,y,z", ZZ)
1185.     f = x**3 + 4*x**2 + 2*x + 3
1186. 
1187.     r = f.subs(x, 0)
1188.     assert r == 3 and isinstance(r, R.dtype)
1189.     r = f.subs([(x, 0), (y, 0)])
1190.     assert r == 3 and isinstance(r, R.dtype)
1191. 
1192.     raises(CoercionFailed, lambda: f.subs([(x, 1), (y, QQ(1,7))]))
1193.     raises(CoercionFailed, lambda: f.subs([(x, QQ(1,7)), (y, 1)]))
1194.     raises(CoercionFailed, lambda: f.subs([(x, QQ(1,7)), (y, QQ(1,7))]))
1195. 
1196. def test_PolyElement_compose():
1197.     R, x = ring("x", ZZ)
1198.     f = x**3 + 4*x**2 + 2*x + 3
1199. 
1200.     r = f.compose(x, 0)
1201.     assert r == 3 and isinstance(r, R.dtype)
1202. 
1203.     assert f.compose(x, x) == f
1204.     assert f.compose(x, x**2) == x**6 + 4*x**4 + 2*x**2 + 3
1205. 
1206.     raises(CoercionFailed, lambda: f.compose(x, QQ(1,7)))
1207. 
1208.     R, x, y, z = ring("x,y,z", ZZ)
1209.     f = x**3 + 4*x**2 + 2*x + 3
1210. 
1211.     r = f.compose(x, 0)
1212.     assert r == 3 and isinstance(r, R.dtype)
1213.     r = f.compose([(x, 0), (y, 0)])
1214.     assert r == 3 and isinstance(r, R.dtype)
1215. 
1216.     r = (x**3 + 4*x**2 + 2*x*y*z + 3).compose(x, y*z**2 - 1)
1217.     q = (y*z**2 - 1)**3 + 4*(y*z**2 - 1)**2 + 2*(y*z**2 - 1)*y*z + 3
1218.     assert r == q and isinstance(r, R.dtype)
1219. 
1220. def test_PolyElement_is_():
1221.     R, x,y,z = ring("x,y,z", QQ)
1222. 
1223.     assert (x - x).is_generator == False
1224.     assert (x - x).is_ground == True
1225.     assert (x - x).is_monomial == True
1226.     assert (x - x).is_term == True
1227. 
1228.     assert (x - x + 1).is_generator == False
1229.     assert (x - x + 1).is_ground == True
1230.     assert (x - x + 1).is_monomial == True
1231.     assert (x - x + 1).is_term == True
1232. 
1233.     assert x.is_generator == True
1234.     assert x.is_ground == False
1235.     assert x.is_monomial == True
1236.     assert x.is_term == True
1237. 
1238.     assert (x*y).is_generator == False
1239.     assert (x*y).is_ground == False
1240.     assert (x*y).is_monomial == True
1241.     assert (x*y).is_term == True
1242. 
1243.     assert (3*x).is_generator == False
1244.     assert (3*x).is_ground == False
1245.     assert (3*x).is_monomial == False
1246.     assert (3*x).is_term == True
1247. 
1248.     assert (3*x + 1).is_generator == False
1249.     assert (3*x + 1).is_ground == False
1250.     assert (3*x + 1).is_monomial == False
1251.     assert (3*x + 1).is_term == False
1252. 
1253.     assert R(0).is_zero is True
1254.     assert R(1).is_zero is False
1255. 
1256.     assert R(0).is_one is False
1257.     assert R(1).is_one is True
1258. 
1259.     assert (x - 1).is_monic is True
1260.     assert (2*x - 1).is_monic is False
1261. 
1262.     assert (3*x + 2).is_primitive is True
1263.     assert (4*x + 2).is_primitive is False
1264. 
1265.     assert (x + y + z + 1).is_linear is True
1266.     assert (x*y*z + 1).is_linear is False
1267. 
1268.     assert (x*y + z + 1).is_quadratic is True
1269.     assert (x*y*z + 1).is_quadratic is False
1270. 
1271.     assert (x - 1).is_squarefree is True
1272.     assert ((x - 1)**2).is_squarefree is False
1273. 
1274.     assert (x**2 + x + 1).is_irreducible is True
1275.     assert (x**2 + 2*x + 1).is_irreducible is False
1276. 
1277.     _, t = ring("t", FF(11))
1278. 
1279.     assert (7*t + 3).is_irreducible is True
1280.     assert (7*t**2 + 3*t + 1).is_irreducible is False
1281. 
1282.     _, u = ring("u", ZZ)
1283.     f = u**16 + u**14 - u**10 - u**8 - u**6 + u**2
1284. 
1285.     assert f.is_cyclotomic is False
1286.     assert (f + 1).is_cyclotomic is True
1287. 
1288.     raises(MultivariatePolynomialError, lambda: x.is_cyclotomic)
1289. 
1290.     R, = ring("", ZZ)
1291.     assert R(4).is_squarefree is True
1292.     assert R(6).is_irreducible is True
1293. 
1294. def test_PolyElement_drop():
1295.     R, x,y,z = ring("x,y,z", ZZ)
1296. 
1297.     assert R(1).drop(0).ring == PolyRing("y,z", ZZ, lex)
1298.     assert R(1).drop(0).drop(0).ring == PolyRing("z", ZZ, lex)
1299.     assert isinstance(R(1).drop(0).drop(0).drop(0), R.dtype) is False
1300. 
1301.     raises(ValueError, lambda: z.drop(0).drop(0).drop(0))
1302.     raises(ValueError, lambda: x.drop(0))
1303. 
1304. def test_PolyElement_pdiv():
1305.     _, x, y = ring("x,y", ZZ)
1306. 
1307.     f, g = x**2 - y**2, x - y
1308.     q, r = x + y, 0
1309. 
1310.     assert f.pdiv(g) == (q, r)
1311.     assert f.prem(g) == r
1312.     assert f.pquo(g) == q
1313.     assert f.pexquo(g) == q
1314. 
1315. def test_PolyElement_gcdex():
1316.     _, x = ring("x", QQ)
1317. 
1318.     f, g = 2*x, x**2 - 16
1319.     s, t, h = x/32, -QQ(1, 16), 1
1320. 
1321.     assert f.half_gcdex(g) == (s, h)
1322.     assert f.gcdex(g) == (s, t, h)
1323. 
1324. def test_PolyElement_subresultants():
1325.     _, x = ring("x", ZZ)
1326.     f, g, h = x**2 - 2*x + 1, x**2 - 1, 2*x - 2
1327. 
1328.     assert f.subresultants(g) == [f, g, h]
1329. 
1330. def test_PolyElement_resultant():
1331.     _, x = ring("x", ZZ)
1332.     f, g, h = x**2 - 2*x + 1, x**2 - 1, 0
1333. 
1334.     assert f.resultant(g) == h
1335. 
1336. def test_PolyElement_discriminant():
1337.     _, x = ring("x", ZZ)
1338.     f, g = x**3 + 3*x**2 + 9*x - 13, -11664
1339. 
1340.     assert f.discriminant() == g
1341. 
1342.     F, a, b, c = ring("a,b,c", ZZ)
1343.     _, x = ring("x", F)
1344. 
1345.     f, g = a*x**2 + b*x + c, b**2 - 4*a*c
1346. 
1347.     assert f.discriminant() == g
1348. 
1349. def test_PolyElement_decompose():
1350.     _, x = ring("x", ZZ)
1351. 
1352.     f = x**12 + 20*x**10 + 150*x**8 + 500*x**6 + 625*x**4 - 2*x**3 - 10*x + 9
1353.     g = x**4 - 2*x + 9
1354.     h = x**3 + 5*x
1355. 
1356.     assert g.compose(x, h) == f
1357.     assert f.decompose() == [g, h]
1358. 
1359. def test_PolyElement_shift():
1360.     _, x = ring("x", ZZ)
1361.     assert (x**2 - 2*x + 1).shift(2) == x**2 + 2*x + 1
1362. 
1363. def test_PolyElement_sturm():
1364.     F, t = field("t", ZZ)
1365.     _, x = ring("x", F)
1366. 
1367.     f = 1024/(15625*t**8)*x**5 - 4096/(625*t**8)*x**4 + 32/(15625*t**4)*x**3 - 128/(625*t**4)*x**2 + F(1)/62500*x - F(1)/625
1368. 
1369.     assert f.sturm() == [
1370.         x**3 - 100*x**2 + t**4/64*x - 25*t**4/16,
1371.         3*x**2 - 200*x + t**4/64,
1372.         (-t**4/96 + F(20000)/9)*x + 25*t**4/18,
1373.         (-9*t**12 - 11520000*t**8 - 3686400000000*t**4)/(576*t**8 - 245760000*t**4 + 26214400000000),
1374.     ]
1375. 
1376. def test_PolyElement_gff_list():
1377.     _, x = ring("x", ZZ)
1378. 
1379.     f = x**5 + 2*x**4 - x**3 - 2*x**2
1380.     assert f.gff_list() == [(x, 1), (x + 2, 4)]
1381. 
1382.     f = x*(x - 1)**3*(x - 2)**2*(x - 4)**2*(x - 5)
1383.     assert f.gff_list() == [(x**2 - 5*x + 4, 1), (x**2 - 5*x + 4, 2), (x, 3)]
1384. 
1385. def test_PolyElement_sqf_norm():
1386.     R, x = ring("x", QQ.algebraic_field(sqrt(3)))
1387.     X = R.to_ground().x
1388. 
1389.     assert (x**2 - 2).sqf_norm() == (1, x**2 - 2*sqrt(3)*x + 1, X**4 - 10*X**2 + 1)
1390. 
1391.     R, x = ring("x", QQ.algebraic_field(sqrt(2)))
1392.     X = R.to_ground().x
1393. 
1394.     assert (x**2 - 3).sqf_norm() == (1, x**2 - 2*sqrt(2)*x - 1, X**4 - 10*X**2 + 1)
1395. 
1396. def test_PolyElement_sqf_list():
1397.     _, x = ring("x", ZZ)
1398. 
1399.     f = x**5 - x**3 - x**2 + 1
1400.     g = x**3 + 2*x**2 + 2*x + 1
1401.     h = x - 1
1402.     p = x**4 + x**3 - x - 1
1403. 
1404.     assert f.sqf_part() == p
1405.     assert f.sqf_list() == (1, [(g, 1), (h, 2)])
1406. 
1407. def test_PolyElement_factor_list():
1408.     _, x = ring("x", ZZ)
1409. 
1410.     f = x**5 - x**3 - x**2 + 1
1411. 
1412.     u = x + 1
1413.     v = x - 1
1414.     w = x**2 + x + 1
1415. 
1416.     assert f.factor_list() == (1, [(u, 1), (v, 2), (w, 1)])
1417. 
1418. 
1419. def test_issue_21410():
1420.     R, x = ring('x', FF(2))
1421.     p = x**6 + x**5 + x**4 + x**3 + 1
1422.     assert p._pow_multinomial(4) == x**24 + x**20 + x**16 + x**12 + 1

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 13:19:30,628 - thread-139084754323136.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The provided context contains the file `sympy/polys/tests/test_rings.py`, which includes `test_PolyElement_as_expr`, a direct test for the method in question. It also contains other relevant tests like `test_PolyElement_from_expr` and `test_sring` that cover the interaction between `PolyElement` and sympy expressions. All necessary imports and setup are available within this file, making the context sufficient to fulfill the user's request without needing additional information." query='' extra_requirements='' purpose=''
2025-12-21 13:19:30,629 - thread-139084754323136.prometheus_context_collector - INFO - Successfully retrieved 3 context snippets
