2025-12-23 10:22:55,673 - thread-139574449776320.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Use of literalinclude prepend results in incorrect indent formatting for code eamples

Description: ### Describe the bug

Cannot determine a mechanism to use literalinclude directive with `prepend` or `append` to match code example indentation, as leading whitespace is removed.

### How to Reproduce

Example of including xml snippet, that should be prefixed with ``     <plugin>``.

File ``index.rst``:

``` rst
# hello world

Code examples:

.. literalinclude:: pom.xml
   :language: xml
   :prepend:       </plugin>
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-at: </plugin>
```

File `pom.xml``:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.8.0</version>
        <configuration>
          <source>1.8</source>
          <target>1.8</target>
          <debug>true</debug>
          <encoding>UTF-8</encoding>
        </configuration>
      </plugin>
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
    </plugins>
  </build>
</project>
```

Produces the following valid xml, which is indented poorly:
```xml
<plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
   ```
   
 I cannot think of good warning free way to indent `:prepend:` to match the included code example.

### Expected behavior

Expect leading white space to be preserved in output:

```xml
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
```

### Your project

https://github.com/geoserver/geoserver/tree/main/doc/en/developer/source

### Screenshots

_No response_

### OS

Mac

### Python version

3.9.10

### Sphinx version

4.4.0

### Sphinx extensions

['sphinx.ext.todo', 'sphinx.ext.extlinks']

### Extra tools

_No response_

### Additional context

Using `dedent` creatively almost provides a workaround:

``` rst
.. literalinclude:: pom.xml
   :language: xml
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-before: </plugin>
   :prepend: _____</plugin>
   :dedent: 5
```

Produces a warning, which fails the build with ``-W`` build policy.
```
index.rst.rst:155: WARNING: non-whitespace stripped by dedent
```

Use of `dedent` could be a good solution, if `dedent` was applied only to the literalinclude and not to the `prepend` and `append` content.

Patch information:
diff --git a/sphinx/directives/code.py b/sphinx/directives/code.py
index dc44ed314..9f359c0eb 100644
--- a/sphinx/directives/code.py
+++ b/sphinx/directives/code.py
@@ -343,6 +343,7 @@ class LiteralIncludeReader:
     def prepend_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         prepend = self.options.get('prepend')
         if prepend:
+            # Preserve the leading whitespace in the prepend text
             lines.insert(0, prepend + '\n')
 
         return lines
@@ -350,13 +351,36 @@ class LiteralIncludeReader:
     def append_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         append = self.options.get('append')
         if append:
+            # Preserve the leading whitespace in the append text
             lines.append(append + '\n')
 
         return lines
 
     def dedent_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         if 'dedent' in self.options:
-            return dedent_lines(lines, self.options.get('dedent'), location=location)
+            # Check if we have prepend/append content
+            has_prepend = 'prepend' in self.options
+            has_append = 'append' in self.options
+            
+            # If we have prepend/append, only dedent the included file content
+            if has_prepend or has_append:
+                # Find the range of lines that are from the included file
+                start = 1 if has_prepend else 0
+                end = len(lines) - 1 if has_append else len(lines)
+                
+                # Split into prepend, included content, and append
+                pre_lines = lines[:start] if has_prepend else []
+                included_lines = lines[start:end]
+                post_lines = lines[end:] if has_append else []
+                
+                # Only dedent the included content
+                dedented_included = dedent_lines(included_lines, self.options.get('dedent'), location=location)
+                
+                # Recombine all parts
+                return pre_lines + dedented_included + post_lines
+            else:
+                # No prepend/append, dedent everything as before
+                return dedent_lines(lines, self.options.get('dedent'), location=location)
         else:
             return lines
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 10:22:55,737 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug-report.yml
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── create-release.yml
|       ├── docutils-latest.yml
|       ├── lint.yml
|       ├── lock.yml
|       ├── main.yml
|       ├── nodejs.yml
|       └── transifex.yml
├── .readthedocs.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   ├── themes
|   |   |   └── fullsize
|   |   └── tutorial
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── development
|   |   ├── builders.rst
|   |   ├── index.rst
|   |   ├── overview.rst
|   |   ├── theming.rst
|   |   └── tutorials
|   |       ├── autodoc_ext.rst
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── autodoc_intenum.py
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   ├── tutorial
|   |   ├── automatic-doc-generation.rst
|   |   ├── deploying.rst
|   |   ├── describing-code.rst
|   |   ├── end.rst
|   |   ├── first-steps.rst
|   |   ├── getting-started.rst
|   |   ├── index.rst
|   |   ├── more-sphinx-customization.rst
|   |   └── narrative-documentation.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── changes.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── deprecated.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── preserve_defaults.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_FR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_GB
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_HK
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr_FR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── is
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── yue
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_HK
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_TW
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW.Big5
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── minified-js
|   |   |   ├── base-stemmer.js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── base-stemmer.js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── _sphinx_javascript_frameworks_compat.js
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.13.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── __init__.py
|   ├── certs
|   ├── conftest.py
|   ├── ext_napoleon_pep526_data_google.py
|   ├── ext_napoleon_pep526_data_numpy.py
|   ├── js
|   |   ├── doctools.js
|   |   └── searchtools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── dedent.rst
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-csv-table
|   |   |   ├── conf.py
|   |   |   └── subdir
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── field-role.rst
|   |   |   ├── function_param_target.rst
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── ns_lookup.rst
|   |   ├── test-domain-c-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── field-role.rst
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-cpp-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── abbr.rst
|   |   |   ├── canonical.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py-python_use_unqualified_type_names
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-py-xref-warning
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── TYPE_CHECKING.py
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── autodoc_type_aliases.py
|   |   |       ├── bound_method.py
|   |   |       ├── cached_property.py
|   |   |       ├── callable.py
|   |   |       ├── canonical
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── empty_all.py
|   |   |       ├── enums.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── generic_class.py
|   |   |       ├── genericalias.py
|   |   |       ├── hide_value.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── instance_variable.py
|   |   |       ├── metadata.py
|   |   |       ├── methods.py
|   |   |       ├── module.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── overload2.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── pep604.py
|   |   |       ├── preserve_defaults.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── properties.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       ├── uninitialized_attributes.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-filename-map
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-extlinks-hardcoded-urls
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-extlinks-hardcoded-urls-multiple-replacements
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-intersphinx-role
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   ├── nomath.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-highlight_options
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_signaturereturn_icon
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── noqa.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-container
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-linkcheck-documents_exclude
|   |   |   ├── br0ken_link.rst
|   |   |   ├── broken_link.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-anchor
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-https
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-warn-redirects
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-local-logo
|   |   |   ├── conf.py
|   |   |   ├── images
|   |   |   └── index.rst
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nitpicky-warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-remote-logo
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── literals.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-transforms-post_transforms-missing-reference
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autoattribute.py
|   ├── test_ext_autodoc_autoclass.py
|   ├── test_ext_autodoc_autodata.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_automodule.py
|   ├── test_ext_autodoc_autoproperty.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_preserve_defaults.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_extlinks.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_extension.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   ├── typing_test_data.py
|   └── utils.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    └── doclinter.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Use of literalinclude prepend results in incorrect indent formatting for code eamples

Description: ### Describe the bug

Cannot determine a mechanism to use literalinclude directive with `prepend` or `append` to match code example indentation, as leading whitespace is removed.

### How to Reproduce

Example of including xml snippet, that should be prefixed with ``     <plugin>``.

File ``index.rst``:

``` rst
# hello world

Code examples:

.. literalinclude:: pom.xml
   :language: xml
   :prepend:       </plugin>
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-at: </plugin>
```

File `pom.xml``:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.8.0</version>
        <configuration>
          <source>1.8</source>
          <target>1.8</target>
          <debug>true</debug>
          <encoding>UTF-8</encoding>
        </configuration>
      </plugin>
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
    </plugins>
  </build>
</project>
```

Produces the following valid xml, which is indented poorly:
```xml
<plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
   ```
   
 I cannot think of good warning free way to indent `:prepend:` to match the included code example.

### Expected behavior

Expect leading white space to be preserved in output:

```xml
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
```

### Your project

https://github.com/geoserver/geoserver/tree/main/doc/en/developer/source

### Screenshots

_No response_

### OS

Mac

### Python version

3.9.10

### Sphinx version

4.4.0

### Sphinx extensions

['sphinx.ext.todo', 'sphinx.ext.extlinks']

### Extra tools

_No response_

### Additional context

Using `dedent` creatively almost provides a workaround:

``` rst
.. literalinclude:: pom.xml
   :language: xml
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-before: </plugin>
   :prepend: _____</plugin>
   :dedent: 5
```

Produces a warning, which fails the build with ``-W`` build policy.
```
index.rst.rst:155: WARNING: non-whitespace stripped by dedent
```

Use of `dedent` could be a good solution, if `dedent` was applied only to the literalinclude and not to the `prepend` and `append` content.

Patch information:
diff --git a/sphinx/directives/code.py b/sphinx/directives/code.py
index dc44ed314..9f359c0eb 100644
--- a/sphinx/directives/code.py
+++ b/sphinx/directives/code.py
@@ -343,6 +343,7 @@ class LiteralIncludeReader:
     def prepend_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         prepend = self.options.get('prepend')
         if prepend:
+            # Preserve the leading whitespace in the prepend text
             lines.insert(0, prepend + '\n')
 
         return lines
@@ -350,13 +351,36 @@ class LiteralIncludeReader:
     def append_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         append = self.options.get('append')
         if append:
+            # Preserve the leading whitespace in the append text
             lines.append(append + '\n')
 
         return lines
 
     def dedent_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         if 'dedent' in self.options:
-            return dedent_lines(lines, self.options.get('dedent'), location=location)
+            # Check if we have prepend/append content
+            has_prepend = 'prepend' in self.options
+            has_append = 'append' in self.options
+            
+            # If we have prepend/append, only dedent the included file content
+            if has_prepend or has_append:
+                # Find the range of lines that are from the included file
+                start = 1 if has_prepend else 0
+                end = len(lines) - 1 if has_append else len(lines)
+                
+                # Split into prepend, included content, and append
+                pre_lines = lines[:start] if has_prepend else []
+                included_lines = lines[start:end]
+                post_lines = lines[end:] if has_append else []
+                
+                # Only dedent the included content
+                dedented_included = dedent_lines(included_lines, self.options.get('dedent'), location=location)
+                
+                # Recombine all parts
+                return pre_lines + dedented_included + post_lines
+            else:
+                # No prepend/append, dedent everything as before
+                return dedent_lines(lines, self.options.get('dedent'), location=location)
         else:
             return lines
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 10:23:21,635 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find 3 relevant test cases for a bug in the `literalinclude` directive. The tests for this directive are located in `tests/test_directive_code.py`. To find the most relevant test cases, I need the content of this file. The current context is empty.' query='Please provide the full content of `tests/test_directive_code.py`.' extra_requirements='If the file is too large, please at least provide all test functions that test the `literalinclude` directive, especially those testing the `dedent`, `prepend`, and `append` options.' purpose="This file is needed to identify and extract 3 complete test cases that are relevant to the user's bug report concerning `literalinclude` indentation."
2025-12-23 10:23:21,636 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/test_directive_code.py`.
2025-12-23 10:23:21,636 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 10:23:21,637 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 10:23:21,637 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 10:23:21,637 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/test_directive_code.py`.
Extra requirements: If the file is too large, please at least provide all test functions that test the `literalinclude` directive, especially those testing the `dedent`, `prepend`, and `append` options.
Purpose: This file is needed to identify and extract 3 complete test cases that are relevant to the user's bug report concerning `literalinclude` indentation.
2025-12-23 10:23:26,938 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will first attempt to read the entire file `tests/test_directive_code.py`. If the file is too large, I will then specifically search for test functions within that file that are related to the `literalinclude` directive and its `dedent`, `prepend`, and `append` options to ensure I can provide the most relevant code.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/test_directive_code.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2131, 'candidates_token_count': 95, 'total_token_count': 2564, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2131}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 95}], 'thoughts_token_count': 338, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.21320132205360814, 'model_name': 'gemini-2.5-pro'} id='run--46af97ac-6cb3-4889-aac2-22f4c5d1a74b-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_directive_code.py'}, 'id': 'f07c7ed2-fd20-46c4-8e60-d384b2d48de5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2131, 'output_tokens': 95, 'total_tokens': 2564, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 338}}
2025-12-23 10:23:28,896 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the initial 500 lines of `tests/test_directive_code.py`. Since the file is larger than that, I will now fetch the remaining content to provide the complete file as requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1001.0, "relative_path": "tests/test_directive_code.py", "start_line": 501.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10828, 'candidates_token_count': 74, 'total_token_count': 10962, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10828}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 74}], 'thoughts_token_count': 60, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15541409157417915, 'model_name': 'gemini-2.5-pro'} id='run--dc2f89c3-de8c-407a-9fbc-f0ef0875cd5d-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1001.0, 'relative_path': 'tests/test_directive_code.py', 'start_line': 501.0}, 'id': '5b550a35-c590-4773-a3d8-a90ab484fa5b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10828, 'output_tokens': 74, 'total_tokens': 10962, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 60}}
2025-12-23 10:23:39,222 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of `tests/test_directive_code.py`. The file was read in two parts and combined. As requested, I have also identified the test functions that are most relevant to the `literalinclude` directive and its `dedent`, `prepend`, and `append` options. The full code is provided in the context, with the most relevant tests being `test_LiteralIncludeReader_dedent` and `test_LiteralIncludeReader_prepend`.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12552, 'candidates_token_count': 100, 'total_token_count': 13562, 'cached_content_token_count': 1822, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12552}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1822}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 100}], 'thoughts_token_count': 910}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0945484924316407, 'model_name': 'gemini-2.5-pro'} id='run--35458ec7-527a-42c6-9ac0-7c23a0e81d6a-0' usage_metadata={'input_tokens': 12552, 'output_tokens': 100, 'total_tokens': 13562, 'input_token_details': {'cache_read': 1822}, 'output_token_details': {'reasoning': 910}}
2025-12-23 10:23:39,224 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/test_directive_code.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the file is too large, please at least provide all test functions that test the `literalinclude` directive, especially those testing the `dedent`, `prepend`, and `append` options.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
This file is needed to identify and extract 3 complete test cases that are relevant to the user's bug report concerning `literalinclude` indentation.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/test_directive_code.py
Line number range: 1 - 500
Content:
1. """Test the code-block directive."""
2. 
3. import os
4. 
5. import pytest
6. from docutils import nodes
7. 
8. from sphinx.config import Config
9. from sphinx.directives.code import LiteralIncludeReader
10. from sphinx.testing.util import etree_parse
11. 
12. DUMMY_CONFIG = Config({}, {})
13. 
14. 
15. @pytest.fixture(scope='module')
16. def testroot(rootdir):
17.     testroot_path = rootdir / 'test-directive-code'
18.     return testroot_path
19. 
20. 
21. @pytest.fixture(scope='module')
22. def literal_inc_path(testroot):
23.     return testroot / 'literal.inc'
24. 
25. 
26. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
27. def test_LiteralIncludeReader(literal_inc_path):
28.     options = {'lineno-match': True}
29.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
30.     content, lines = reader.read()
31.     assert content == literal_inc_path.read_text()
32.     assert lines == 13
33.     assert reader.lineno_start == 1
34. 
35. 
36. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
37. def test_LiteralIncludeReader_lineno_start(literal_inc_path):
38.     options = {'lineno-start': 4}
39.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
40.     content, lines = reader.read()
41.     assert content == literal_inc_path.read_text()
42.     assert lines == 13
43.     assert reader.lineno_start == 4
44. 
45. 
46. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
47. def test_LiteralIncludeReader_pyobject1(literal_inc_path):
48.     options = {'lineno-match': True, 'pyobject': 'Foo'}
49.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
50.     content, lines = reader.read()
51.     assert content == ("class Foo:\n"
52.                        "    pass\n")
53.     assert reader.lineno_start == 5
54. 
55. 
56. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
57. def test_LiteralIncludeReader_pyobject2(literal_inc_path):
58.     options = {'pyobject': 'Bar'}
59.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
60.     content, lines = reader.read()
61.     assert content == ("class Bar:\n"
62.                        "    def baz():\n"
63.                        "        pass\n")
64.     assert reader.lineno_start == 1  # no lineno-match
65. 
66. 
67. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
68. def test_LiteralIncludeReader_pyobject3(literal_inc_path):
69.     options = {'pyobject': 'Bar.baz'}
70.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
71.     content, lines = reader.read()
72.     assert content == ("    def baz():\n"
73.                        "        pass\n")
74. 
75. 
76. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
77. def test_LiteralIncludeReader_pyobject_and_lines(literal_inc_path):
78.     options = {'pyobject': 'Bar', 'lines': '2-'}
79.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
80.     content, lines = reader.read()
81.     assert content == ("    def baz():\n"
82.                        "        pass\n")
83. 
84. 
85. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
86. def test_LiteralIncludeReader_lines1(literal_inc_path):
87.     options = {'lines': '1-3'}
88.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
89.     content, lines = reader.read()
90.     assert content == ("# Literally included file using Python highlighting\n"
91.                        "\n"
92.                        "foo = \"Including Unicode characters: üöä\"\n")
93. 
94. 
95. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
96. def test_LiteralIncludeReader_lines2(literal_inc_path):
97.     options = {'lines': '1,3,5'}
98.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
99.     content, lines = reader.read()
100.     assert content == ("# Literally included file using Python highlighting\n"
101.                        "foo = \"Including Unicode characters: üöä\"\n"
102.                        "class Foo:\n")
103. 
104. 
105. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
106. def test_LiteralIncludeReader_lines_and_lineno_match1(literal_inc_path):
107.     options = {'lines': '3-5', 'lineno-match': True}
108.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
109.     content, lines = reader.read()
110.     assert content == ("foo = \"Including Unicode characters: üöä\"\n"
111.                        "\n"
112.                        "class Foo:\n")
113.     assert reader.lineno_start == 3
114. 
115. 
116. @pytest.mark.sphinx()  # init locale for errors
117. def test_LiteralIncludeReader_lines_and_lineno_match2(literal_inc_path, app, status, warning):
118.     options = {'lines': '0,3,5', 'lineno-match': True}
119.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
120.     with pytest.raises(ValueError):
121.         content, lines = reader.read()
122. 
123. 
124. @pytest.mark.sphinx()  # init locale for errors
125. def test_LiteralIncludeReader_lines_and_lineno_match3(literal_inc_path, app, status, warning):
126.     options = {'lines': '100-', 'lineno-match': True}
127.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
128.     with pytest.raises(ValueError):
129.         content, lines = reader.read()
130. 
131. 
132. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
133. def test_LiteralIncludeReader_start_at(literal_inc_path):
134.     options = {'lineno-match': True, 'start-at': 'Foo', 'end-at': 'Bar'}
135.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
136.     content, lines = reader.read()
137.     assert content == ("class Foo:\n"
138.                        "    pass\n"
139.                        "\n"
140.                        "class Bar:\n")
141.     assert reader.lineno_start == 5
142. 
143. 
144. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
145. def test_LiteralIncludeReader_start_after(literal_inc_path):
146.     options = {'lineno-match': True, 'start-after': 'Foo', 'end-before': 'Bar'}
147.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
148.     content, lines = reader.read()
149.     assert content == ("    pass\n"
150.                        "\n")
151.     assert reader.lineno_start == 6
152. 
153. 
154. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
155. def test_LiteralIncludeReader_start_after_and_lines(literal_inc_path):
156.     options = {'lineno-match': True, 'lines': '6-',
157.                'start-after': 'Literally', 'end-before': 'comment'}
158.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
159.     content, lines = reader.read()
160.     assert content == ("\n"
161.                        "class Bar:\n"
162.                        "    def baz():\n"
163.                        "        pass\n"
164.                        "\n")
165.     assert reader.lineno_start == 7
166. 
167. 
168. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
169. def test_LiteralIncludeReader_start_at_and_lines(literal_inc_path):
170.     options = {'lines': '2, 3, 5', 'start-at': 'foo', 'end-before': '#'}
171.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
172.     content, lines = reader.read()
173.     assert content == ("\n"
174.                        "class Foo:\n"
175.                        "\n")
176.     assert reader.lineno_start == 1
177. 
178. 
179. def test_LiteralIncludeReader_missing_start_and_end(literal_inc_path):
180.     options = {'start-at': 'NOTHING'}
181.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
182.     with pytest.raises(ValueError):
183.         content, lines = reader.read()
184. 
185.     options = {'end-at': 'NOTHING'}
186.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
187.     with pytest.raises(ValueError):
188.         content, lines = reader.read()
189. 
190.     options = {'start-after': 'NOTHING'}
191.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
192.     with pytest.raises(ValueError):
193.         content, lines = reader.read()
194. 
195.     options = {'end-before': 'NOTHING'}
196.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
197.     with pytest.raises(ValueError):
198.         content, lines = reader.read()
199. 
200. 
201. def test_LiteralIncludeReader_end_before(literal_inc_path):
202.     options = {'end-before': 'nclud'}  # *nclud* matches first and third lines.
203.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
204.     content, lines = reader.read()
205.     assert content == ("# Literally included file using Python highlighting\n"
206.                        "\n")
207. 
208. 
209. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
210. def test_LiteralIncludeReader_prepend(literal_inc_path):
211.     options = {'lines': '1', 'prepend': 'Hello', 'append': 'Sphinx'}
212.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
213.     content, lines = reader.read()
214.     assert content == ("Hello\n"
215.                        "# Literally included file using Python highlighting\n"
216.                        "Sphinx\n")
217. 
218. 
219. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
220. def test_LiteralIncludeReader_dedent(literal_inc_path):
221.     # dedent: 2
222.     options = {'lines': '9-11', 'dedent': 2}
223.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
224.     content, lines = reader.read()
225.     assert content == ("  def baz():\n"
226.                        "      pass\n"
227.                        "\n")
228. 
229.     # dedent: 4
230.     options = {'lines': '9-11', 'dedent': 4}
231.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
232.     content, lines = reader.read()
233.     assert content == ("def baz():\n"
234.                        "    pass\n"
235.                        "\n")
236. 
237.     # dedent: 6
238.     options = {'lines': '9-11', 'dedent': 6}
239.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
240.     content, lines = reader.read()
241.     assert content == ("f baz():\n"
242.                        "  pass\n"
243.                        "\n")
244. 
245.     # dedent: None
246.     options = {'lines': '9-11', 'dedent': None}
247.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
248.     content, lines = reader.read()
249.     assert content == ("def baz():\n"
250.                        "    pass\n"
251.                        "\n")
252. 
253. 
254. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
255. def test_LiteralIncludeReader_tabwidth(testroot):
256.     # tab-width: 4
257.     options = {'tab-width': 4, 'pyobject': 'Qux'}
258.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
259.     content, lines = reader.read()
260.     assert content == ("class Qux:\n"
261.                        "    def quux(self):\n"
262.                        "        pass\n")
263. 
264.     # tab-width: 8
265.     options = {'tab-width': 8, 'pyobject': 'Qux'}
266.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
267.     content, lines = reader.read()
268.     assert content == ("class Qux:\n"
269.                        "        def quux(self):\n"
270.                        "                pass\n")
271. 
272. 
273. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
274. def test_LiteralIncludeReader_tabwidth_dedent(testroot):
275.     options = {'tab-width': 4, 'dedent': 4, 'pyobject': 'Qux.quux'}
276.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
277.     content, lines = reader.read()
278.     assert content == ("def quux(self):\n"
279.                        "    pass\n")
280. 
281. 
282. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
283. def test_LiteralIncludeReader_diff(testroot, literal_inc_path):
284.     options = {'diff': testroot / 'literal-diff.inc'}
285.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
286.     content, lines = reader.read()
287.     assert content == ("--- " + testroot + "/literal-diff.inc\n"
288.                        "+++ " + testroot + "/literal.inc\n"
289.                        "@@ -6,8 +6,8 @@\n"
290.                        "     pass\n"
291.                        " \n"
292.                        " class Bar:\n"
293.                        "-    def baz(self):\n"
294.                        "+    def baz():\n"
295.                        "         pass\n"
296.                        " \n"
297.                        "-# comment after Bar class\n"
298.                        "+# comment after Bar class definition\n"
299.                        " def bar(): pass\n")
300. 
301. 
302. @pytest.mark.sphinx('xml', testroot='directive-code')
303. def test_code_block(app, status, warning):
304.     app.builder.build('index')
305.     et = etree_parse(app.outdir / 'index.xml')
306.     secs = et.findall('./section/section')
307.     code_block = secs[0].findall('literal_block')
308.     assert len(code_block) > 0
309.     actual = code_block[0].text
310.     expect = (
311.         "    def ruby?\n" +
312.         "        false\n" +
313.         "    end"
314.     )
315.     assert actual == expect
316. 
317. 
318. @pytest.mark.sphinx('html', testroot='directive-code')
319. def test_force_option(app, status, warning):
320.     app.builder.build(['force'])
321.     assert 'force.rst' not in warning.getvalue()
322. 
323. 
324. @pytest.mark.sphinx('html', testroot='directive-code')
325. def test_code_block_caption_html(app, status, warning):
326.     app.builder.build(['caption'])
327.     html = (app.outdir / 'caption.html').read_text()
328.     caption = ('<div class="code-block-caption">'
329.                '<span class="caption-number">Listing 1 </span>'
330.                '<span class="caption-text">caption <em>test</em> rb'
331.                '</span><a class="headerlink" href="#id1" '
332.                'title="Permalink to this code">\xb6</a></div>')
333.     assert caption in html
334. 
335. 
336. @pytest.mark.sphinx('latex', testroot='directive-code')
337. def test_code_block_caption_latex(app, status, warning):
338.     app.builder.build_all()
339.     latex = (app.outdir / 'python.tex').read_text()
340.     caption = '\\sphinxSetupCaptionForVerbatim{caption \\sphinxstyleemphasis{test} rb}'
341.     label = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:id1}}}'
342.     link = '\\hyperref[\\detokenize{caption:name-test-rb}]' \
343.            '{Listing \\ref{\\detokenize{caption:name-test-rb}}}'
344.     assert caption in latex
345.     assert label in latex
346.     assert link in latex
347. 
348. 
349. @pytest.mark.sphinx('latex', testroot='directive-code')
350. def test_code_block_namedlink_latex(app, status, warning):
351.     app.builder.build_all()
352.     latex = (app.outdir / 'python.tex').read_text()
353.     label1 = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:name-test-rb}}}'
354.     link1 = '\\hyperref[\\detokenize{caption:name-test-rb}]'\
355.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{Ruby}}'
356.     label2 = ('\\def\\sphinxLiteralBlockLabel'
357.               '{\\label{\\detokenize{namedblocks:some-ruby-code}}}')
358.     link2 = '\\hyperref[\\detokenize{namedblocks:some-ruby-code}]'\
359.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{the ruby code}}}'
360.     assert label1 in latex
361.     assert link1 in latex
362.     assert label2 in latex
363.     assert link2 in latex
364. 
365. 
366. @pytest.mark.sphinx('latex', testroot='directive-code')
367. def test_code_block_emphasize_latex(app, status, warning):
368.     app.builder.build(['emphasize'])
369.     latex = (app.outdir / 'python.tex').read_text().replace('\r\n', '\n')
370.     includes = '\\fvset{hllines={, 5, 6, 13, 14, 15, 24, 25, 26,}}%\n'
371.     assert includes in latex
372.     includes = '\\end{sphinxVerbatim}\n\\sphinxresetverbatimhllines\n'
373.     assert includes in latex
374. 
375. 
376. @pytest.mark.sphinx('xml', testroot='directive-code')
377. def test_literal_include(app, status, warning):
378.     app.builder.build(['index'])
379.     et = etree_parse(app.outdir / 'index.xml')
380.     secs = et.findall('./section/section')
381.     literal_include = secs[1].findall('literal_block')
382.     literal_src = (app.srcdir / 'literal.inc').read_text()
383.     assert len(literal_include) > 0
384.     actual = literal_include[0].text
385.     assert actual == literal_src
386. 
387. 
388. @pytest.mark.sphinx('xml', testroot='directive-code')
389. def test_literal_include_block_start_with_comment_or_brank(app, status, warning):
390.     app.builder.build(['python'])
391.     et = etree_parse(app.outdir / 'python.xml')
392.     secs = et.findall('./section/section')
393.     literal_include = secs[0].findall('literal_block')
394.     assert len(literal_include) > 0
395.     actual = literal_include[0].text
396.     expect = (
397.         'def block_start_with_comment():\n'
398.         '    # Comment\n'
399.         '    return 1\n'
400.     )
401.     assert actual == expect
402. 
403.     actual = literal_include[1].text
404.     expect = (
405.         'def block_start_with_blank():\n'
406.         '\n'
407.         '    return 1\n'
408.     )
409.     assert actual == expect
410. 
411. 
412. @pytest.mark.sphinx('html', testroot='directive-code')
413. def test_literal_include_linenos(app, status, warning):
414.     app.builder.build(['linenos'])
415.     html = (app.outdir / 'linenos.html').read_text()
416. 
417.     # :linenos:
418.     assert ('<span class="linenos"> 1</span><span class="c1">'
419.             '# Literally included file using Python highlighting</span>' in html)
420. 
421.     # :lineno-start:
422.     assert ('<span class="linenos">200</span><span class="c1">'
423.             '# Literally included file using Python highlighting</span>' in html)
424. 
425.     # :lines: 5-9
426.     assert ('<span class="linenos">5</span><span class="k">class</span> '
427.             '<span class="nc">Foo</span><span class="p">:</span>' in html)
428. 
429. 
430. @pytest.mark.sphinx('latex', testroot='directive-code')
431. def test_literalinclude_file_whole_of_emptyline(app, status, warning):
432.     app.builder.build_all()
433.     latex = (app.outdir / 'python.tex').read_text().replace('\r\n', '\n')
434.     includes = (
435.         '\\begin{sphinxVerbatim}'
436.         '[commandchars=\\\\\\{\\},numbers=left,firstnumber=1,stepnumber=1]\n'
437.         '\n'
438.         '\n'
439.         '\n'
440.         '\\end{sphinxVerbatim}\n')
441.     assert includes in latex
442. 
443. 
444. @pytest.mark.sphinx('html', testroot='directive-code')
445. def test_literalinclude_caption_html(app, status, warning):
446.     app.builder.build('index')
447.     html = (app.outdir / 'caption.html').read_text()
448.     caption = ('<div class="code-block-caption">'
449.                '<span class="caption-number">Listing 2 </span>'
450.                '<span class="caption-text">caption <strong>test</strong> py'
451.                '</span><a class="headerlink" href="#id2" '
452.                'title="Permalink to this code">\xb6</a></div>')
453.     assert caption in html
454. 
455. 
456. @pytest.mark.sphinx('latex', testroot='directive-code')
457. def test_literalinclude_caption_latex(app, status, warning):
458.     app.builder.build('index')
459.     latex = (app.outdir / 'python.tex').read_text()
460.     caption = '\\sphinxSetupCaptionForVerbatim{caption \\sphinxstylestrong{test} py}'
461.     label = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:id2}}}'
462.     link = '\\hyperref[\\detokenize{caption:name-test-py}]' \
463.            '{Listing \\ref{\\detokenize{caption:name-test-py}}}'
464.     assert caption in latex
465.     assert label in latex
466.     assert link in latex
467. 
468. 
469. @pytest.mark.sphinx('latex', testroot='directive-code')
470. def test_literalinclude_namedlink_latex(app, status, warning):
471.     app.builder.build('index')
472.     latex = (app.outdir / 'python.tex').read_text()
473.     label1 = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:name-test-py}}}'
474.     link1 = '\\hyperref[\\detokenize{caption:name-test-py}]'\
475.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{Python}}'
476.     label2 = ('\\def\\sphinxLiteralBlockLabel'
477.               '{\\label{\\detokenize{namedblocks:some-python-code}}}')
478.     link2 = '\\hyperref[\\detokenize{namedblocks:some-python-code}]'\
479.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{the python code}}}'
480.     assert label1 in latex
481.     assert link1 in latex
482.     assert label2 in latex
483.     assert link2 in latex
484. 
485. 
486. @pytest.mark.sphinx('xml', testroot='directive-code')
487. def test_literalinclude_classes(app, status, warning):
488.     app.builder.build(['classes'])
489.     et = etree_parse(app.outdir / 'classes.xml')
490.     secs = et.findall('./section/section')
491. 
492.     code_block = secs[0].findall('literal_block')
493.     assert len(code_block) > 0
494.     assert 'foo bar' == code_block[0].get('classes')
495.     assert 'code_block' == code_block[0].get('names')
496. 
497.     literalinclude = secs[1].findall('literal_block')
498.     assert len(literalinclude) > 0
499.     assert 'bar baz' == literalinclude[0].get('classes')
500.     assert 'literal_include' == literalinclude[0].get('names')


File: tests/test_directive_code.py
Line number range: 501 - 1001
Content:
501. 
502. 
503. @pytest.mark.sphinx('xml', testroot='directive-code')
504. def test_literalinclude_pydecorators(app, status, warning):
505.     app.builder.build(['py-decorators'])
506.     et = etree_parse(app.outdir / 'py-decorators.xml')
507.     secs = et.findall('./section/section')
508. 
509.     literal_include = secs[0].findall('literal_block')
510.     assert len(literal_include) == 3
511. 
512.     actual = literal_include[0].text
513.     expect = (
514.         '@class_decorator\n'
515.         '@other_decorator()\n'
516.         'class TheClass(object):\n'
517.         '\n'
518.         '    @method_decorator\n'
519.         '    @other_decorator()\n'
520.         '    def the_method():\n'
521.         '        pass\n'
522.     )
523.     assert actual == expect
524. 
525.     actual = literal_include[1].text
526.     expect = (
527.         '    @method_decorator\n'
528.         '    @other_decorator()\n'
529.         '    def the_method():\n'
530.         '        pass\n'
531.     )
532.     assert actual == expect
533. 
534.     actual = literal_include[2].text
535.     expect = (
536.         '@function_decorator\n'
537.         '@other_decorator()\n'
538.         'def the_function():\n'
539.         '    pass\n'
540.     )
541.     assert actual == expect
542. 
543. 
544. @pytest.mark.sphinx('dummy', testroot='directive-code')
545. def test_code_block_highlighted(app, status, warning):
546.     app.builder.build(['highlight'])
547.     doctree = app.env.get_doctree('highlight')
548.     codeblocks = list(doctree.findall(nodes.literal_block))
549. 
550.     assert codeblocks[0]['language'] == 'default'
551.     assert codeblocks[1]['language'] == 'python2'
552.     assert codeblocks[2]['language'] == 'python3'
553.     assert codeblocks[3]['language'] == 'python2'
554. 
555. 
556. @pytest.mark.sphinx('html', testroot='directive-code')
557. def test_linenothreshold(app, status, warning):
558.     app.builder.build(['linenothreshold'])
559.     html = (app.outdir / 'linenothreshold.html').read_text()
560. 
561.     # code-block using linenothreshold
562.     assert ('<span class="linenos">1</span><span class="k">class</span> '
563.             '<span class="nc">Foo</span><span class="p">:</span>' in html)
564. 
565.     # code-block not using linenothreshold (no line numbers)
566.     assert '<span></span><span class="c1"># comment</span>' in html
567. 
568.     # literal include using linenothreshold
569.     assert ('<span class="linenos"> 1</span><span class="c1">'
570.             '# Literally included file using Python highlighting</span>' in html)
571. 
572.     # literal include not using linenothreshold (no line numbers)
573.     assert ('<span></span><span class="c1"># Very small literal include '
574.             '(linenothreshold check)</span>' in html)
575. 
576. 
577. @pytest.mark.sphinx('dummy', testroot='directive-code')
578. def test_code_block_dedent(app, status, warning):
579.     app.builder.build(['dedent'])
580.     doctree = app.env.get_doctree('dedent')
581.     codeblocks = list(doctree.traverse(nodes.literal_block))
582.     # Note: comparison string should not have newlines at the beginning or end
583.     text_0_indent = '''First line
584. Second line
585.     Third line
586. Fourth line'''
587.     text_2_indent = '''  First line
588.   Second line
589.       Third line
590.   Fourth line'''
591.     text_4_indent = '''    First line
592.     Second line
593.         Third line
594.     Fourth line'''
595. 
596.     assert codeblocks[0].astext() == text_0_indent
597.     assert codeblocks[1].astext() == text_0_indent
598.     assert codeblocks[2].astext() == text_4_indent
599.     assert codeblocks[3].astext() == text_2_indent
600.     assert codeblocks[4].astext() == text_4_indent
601.     assert codeblocks[5].astext() == text_0_indent

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 10:23:50,747 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's query is to provide the full content of `tests/test_directive_code.py`.\n   - The provided context contains the complete content of this file.\n2. Extended relevance:\n   - The extra requirements specify an interest in test functions for the `literalinclude` directive, particularly those using `dedent`, `prepend`, and `append` options.\n   - This file contains multiple tests for `literalinclude`, including `test_LiteralIncludeReader_prepend` (lines 209-217) and `test_LiteralIncludeReader_dedent` (lines 219-252), which directly match the user's specific interest.", relative_path='tests/test_directive_code.py', start_line=1, end_line=601)]
2025-12-23 10:23:50,749 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `tests/test_directive_code.py`.
2025-12-23 10:23:50,749 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 10:23:50,749 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 10:23:50,749 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 10:23:50,749 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 10:23:50,750 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug-report.yml
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── create-release.yml
|       ├── docutils-latest.yml
|       ├── lint.yml
|       ├── lock.yml
|       ├── main.yml
|       ├── nodejs.yml
|       └── transifex.yml
├── .readthedocs.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   ├── themes
|   |   |   └── fullsize
|   |   └── tutorial
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── development
|   |   ├── builders.rst
|   |   ├── index.rst
|   |   ├── overview.rst
|   |   ├── theming.rst
|   |   └── tutorials
|   |       ├── autodoc_ext.rst
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── autodoc_intenum.py
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   ├── tutorial
|   |   ├── automatic-doc-generation.rst
|   |   ├── deploying.rst
|   |   ├── describing-code.rst
|   |   ├── end.rst
|   |   ├── first-steps.rst
|   |   ├── getting-started.rst
|   |   ├── index.rst
|   |   ├── more-sphinx-customization.rst
|   |   └── narrative-documentation.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── changes.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── deprecated.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── preserve_defaults.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_FR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_GB
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_HK
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr_FR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── is
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── yue
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_HK
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_TW
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW.Big5
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── minified-js
|   |   |   ├── base-stemmer.js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── base-stemmer.js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── _sphinx_javascript_frameworks_compat.js
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.13.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── __init__.py
|   ├── certs
|   ├── conftest.py
|   ├── ext_napoleon_pep526_data_google.py
|   ├── ext_napoleon_pep526_data_numpy.py
|   ├── js
|   |   ├── doctools.js
|   |   └── searchtools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── dedent.rst
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-csv-table
|   |   |   ├── conf.py
|   |   |   └── subdir
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── field-role.rst
|   |   |   ├── function_param_target.rst
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── ns_lookup.rst
|   |   ├── test-domain-c-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── field-role.rst
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-cpp-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── abbr.rst
|   |   |   ├── canonical.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py-python_use_unqualified_type_names
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-py-xref-warning
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── TYPE_CHECKING.py
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── autodoc_type_aliases.py
|   |   |       ├── bound_method.py
|   |   |       ├── cached_property.py
|   |   |       ├── callable.py
|   |   |       ├── canonical
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── empty_all.py
|   |   |       ├── enums.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── generic_class.py
|   |   |       ├── genericalias.py
|   |   |       ├── hide_value.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── instance_variable.py
|   |   |       ├── metadata.py
|   |   |       ├── methods.py
|   |   |       ├── module.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── overload2.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── pep604.py
|   |   |       ├── preserve_defaults.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── properties.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       ├── uninitialized_attributes.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-filename-map
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-extlinks-hardcoded-urls
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-extlinks-hardcoded-urls-multiple-replacements
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-intersphinx-role
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   ├── nomath.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-highlight_options
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_signaturereturn_icon
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── noqa.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-container
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-linkcheck-documents_exclude
|   |   |   ├── br0ken_link.rst
|   |   |   ├── broken_link.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-anchor
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-https
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-warn-redirects
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-local-logo
|   |   |   ├── conf.py
|   |   |   ├── images
|   |   |   └── index.rst
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nitpicky-warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-remote-logo
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── literals.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-transforms-post_transforms-missing-reference
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autoattribute.py
|   ├── test_ext_autodoc_autoclass.py
|   ├── test_ext_autodoc_autodata.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_automodule.py
|   ├── test_ext_autodoc_autoproperty.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_preserve_defaults.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_extlinks.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_extension.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   ├── typing_test_data.py
|   └── utils.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    └── doclinter.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Use of literalinclude prepend results in incorrect indent formatting for code eamples

Description: ### Describe the bug

Cannot determine a mechanism to use literalinclude directive with `prepend` or `append` to match code example indentation, as leading whitespace is removed.

### How to Reproduce

Example of including xml snippet, that should be prefixed with ``     <plugin>``.

File ``index.rst``:

``` rst
# hello world

Code examples:

.. literalinclude:: pom.xml
   :language: xml
   :prepend:       </plugin>
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-at: </plugin>
```

File `pom.xml``:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.8.0</version>
        <configuration>
          <source>1.8</source>
          <target>1.8</target>
          <debug>true</debug>
          <encoding>UTF-8</encoding>
        </configuration>
      </plugin>
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
    </plugins>
  </build>
</project>
```

Produces the following valid xml, which is indented poorly:
```xml
<plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
   ```
   
 I cannot think of good warning free way to indent `:prepend:` to match the included code example.

### Expected behavior

Expect leading white space to be preserved in output:

```xml
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
```

### Your project

https://github.com/geoserver/geoserver/tree/main/doc/en/developer/source

### Screenshots

_No response_

### OS

Mac

### Python version

3.9.10

### Sphinx version

4.4.0

### Sphinx extensions

['sphinx.ext.todo', 'sphinx.ext.extlinks']

### Extra tools

_No response_

### Additional context

Using `dedent` creatively almost provides a workaround:

``` rst
.. literalinclude:: pom.xml
   :language: xml
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-before: </plugin>
   :prepend: _____</plugin>
   :dedent: 5
```

Produces a warning, which fails the build with ``-W`` build policy.
```
index.rst.rst:155: WARNING: non-whitespace stripped by dedent
```

Use of `dedent` could be a good solution, if `dedent` was applied only to the literalinclude and not to the `prepend` and `append` content.

Patch information:
diff --git a/sphinx/directives/code.py b/sphinx/directives/code.py
index dc44ed314..9f359c0eb 100644
--- a/sphinx/directives/code.py
+++ b/sphinx/directives/code.py
@@ -343,6 +343,7 @@ class LiteralIncludeReader:
     def prepend_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         prepend = self.options.get('prepend')
         if prepend:
+            # Preserve the leading whitespace in the prepend text
             lines.insert(0, prepend + '\n')
 
         return lines
@@ -350,13 +351,36 @@ class LiteralIncludeReader:
     def append_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         append = self.options.get('append')
         if append:
+            # Preserve the leading whitespace in the append text
             lines.append(append + '\n')
 
         return lines
 
     def dedent_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         if 'dedent' in self.options:
-            return dedent_lines(lines, self.options.get('dedent'), location=location)
+            # Check if we have prepend/append content
+            has_prepend = 'prepend' in self.options
+            has_append = 'append' in self.options
+            
+            # If we have prepend/append, only dedent the included file content
+            if has_prepend or has_append:
+                # Find the range of lines that are from the included file
+                start = 1 if has_prepend else 0
+                end = len(lines) - 1 if has_append else len(lines)
+                
+                # Split into prepend, included content, and append
+                pre_lines = lines[:start] if has_prepend else []
+                included_lines = lines[start:end]
+                post_lines = lines[end:] if has_append else []
+                
+                # Only dedent the included content
+                dedented_included = dedent_lines(included_lines, self.options.get('dedent'), location=location)
+                
+                # Recombine all parts
+                return pre_lines + dedented_included + post_lines
+            else:
+                # No prepend/append, dedent everything as before
+                return dedent_lines(lines, self.options.get('dedent'), location=location)
         else:
             return lines
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/test_directive_code.py`.
Extra Requirements: If the file is too large, please at least provide all test functions that test the `literalinclude` directive, especially those testing the `dedent`, `prepend`, and `append` options.
Purpose: This file is needed to identify and extract 3 complete test cases that are relevant to the user's bug report concerning `literalinclude` indentation.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/test_directive_code.py
Line number range: 1 - 601
Content:
1. """Test the code-block directive."""
2. 
3. import os
4. 
5. import pytest
6. from docutils import nodes
7. 
8. from sphinx.config import Config
9. from sphinx.directives.code import LiteralIncludeReader
10. from sphinx.testing.util import etree_parse
11. 
12. DUMMY_CONFIG = Config({}, {})
13. 
14. 
15. @pytest.fixture(scope='module')
16. def testroot(rootdir):
17.     testroot_path = rootdir / 'test-directive-code'
18.     return testroot_path
19. 
20. 
21. @pytest.fixture(scope='module')
22. def literal_inc_path(testroot):
23.     return testroot / 'literal.inc'
24. 
25. 
26. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
27. def test_LiteralIncludeReader(literal_inc_path):
28.     options = {'lineno-match': True}
29.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
30.     content, lines = reader.read()
31.     assert content == literal_inc_path.read_text()
32.     assert lines == 13
33.     assert reader.lineno_start == 1
34. 
35. 
36. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
37. def test_LiteralIncludeReader_lineno_start(literal_inc_path):
38.     options = {'lineno-start': 4}
39.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
40.     content, lines = reader.read()
41.     assert content == literal_inc_path.read_text()
42.     assert lines == 13
43.     assert reader.lineno_start == 4
44. 
45. 
46. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
47. def test_LiteralIncludeReader_pyobject1(literal_inc_path):
48.     options = {'lineno-match': True, 'pyobject': 'Foo'}
49.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
50.     content, lines = reader.read()
51.     assert content == ("class Foo:\n"
52.                        "    pass\n")
53.     assert reader.lineno_start == 5
54. 
55. 
56. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
57. def test_LiteralIncludeReader_pyobject2(literal_inc_path):
58.     options = {'pyobject': 'Bar'}
59.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
60.     content, lines = reader.read()
61.     assert content == ("class Bar:\n"
62.                        "    def baz():\n"
63.                        "        pass\n")
64.     assert reader.lineno_start == 1  # no lineno-match
65. 
66. 
67. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
68. def test_LiteralIncludeReader_pyobject3(literal_inc_path):
69.     options = {'pyobject': 'Bar.baz'}
70.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
71.     content, lines = reader.read()
72.     assert content == ("    def baz():\n"
73.                        "        pass\n")
74. 
75. 
76. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
77. def test_LiteralIncludeReader_pyobject_and_lines(literal_inc_path):
78.     options = {'pyobject': 'Bar', 'lines': '2-'}
79.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
80.     content, lines = reader.read()
81.     assert content == ("    def baz():\n"
82.                        "        pass\n")
83. 
84. 
85. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
86. def test_LiteralIncludeReader_lines1(literal_inc_path):
87.     options = {'lines': '1-3'}
88.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
89.     content, lines = reader.read()
90.     assert content == ("# Literally included file using Python highlighting\n"
91.                        "\n"
92.                        "foo = \"Including Unicode characters: üöä\"\n")
93. 
94. 
95. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
96. def test_LiteralIncludeReader_lines2(literal_inc_path):
97.     options = {'lines': '1,3,5'}
98.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
99.     content, lines = reader.read()
100.     assert content == ("# Literally included file using Python highlighting\n"
101.                        "foo = \"Including Unicode characters: üöä\"\n"
102.                        "class Foo:\n")
103. 
104. 
105. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
106. def test_LiteralIncludeReader_lines_and_lineno_match1(literal_inc_path):
107.     options = {'lines': '3-5', 'lineno-match': True}
108.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
109.     content, lines = reader.read()
110.     assert content == ("foo = \"Including Unicode characters: üöä\"\n"
111.                        "\n"
112.                        "class Foo:\n")
113.     assert reader.lineno_start == 3
114. 
115. 
116. @pytest.mark.sphinx()  # init locale for errors
117. def test_LiteralIncludeReader_lines_and_lineno_match2(literal_inc_path, app, status, warning):
118.     options = {'lines': '0,3,5', 'lineno-match': True}
119.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
120.     with pytest.raises(ValueError):
121.         content, lines = reader.read()
122. 
123. 
124. @pytest.mark.sphinx()  # init locale for errors
125. def test_LiteralIncludeReader_lines_and_lineno_match3(literal_inc_path, app, status, warning):
126.     options = {'lines': '100-', 'lineno-match': True}
127.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
128.     with pytest.raises(ValueError):
129.         content, lines = reader.read()
130. 
131. 
132. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
133. def test_LiteralIncludeReader_start_at(literal_inc_path):
134.     options = {'lineno-match': True, 'start-at': 'Foo', 'end-at': 'Bar'}
135.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
136.     content, lines = reader.read()
137.     assert content == ("class Foo:\n"
138.                        "    pass\n"
139.                        "\n"
140.                        "class Bar:\n")
141.     assert reader.lineno_start == 5
142. 
143. 
144. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
145. def test_LiteralIncludeReader_start_after(literal_inc_path):
146.     options = {'lineno-match': True, 'start-after': 'Foo', 'end-before': 'Bar'}
147.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
148.     content, lines = reader.read()
149.     assert content == ("    pass\n"
150.                        "\n")
151.     assert reader.lineno_start == 6
152. 
153. 
154. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
155. def test_LiteralIncludeReader_start_after_and_lines(literal_inc_path):
156.     options = {'lineno-match': True, 'lines': '6-',
157.                'start-after': 'Literally', 'end-before': 'comment'}
158.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
159.     content, lines = reader.read()
160.     assert content == ("\n"
161.                        "class Bar:\n"
162.                        "    def baz():\n"
163.                        "        pass\n"
164.                        "\n")
165.     assert reader.lineno_start == 7
166. 
167. 
168. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
169. def test_LiteralIncludeReader_start_at_and_lines(literal_inc_path):
170.     options = {'lines': '2, 3, 5', 'start-at': 'foo', 'end-before': '#'}
171.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
172.     content, lines = reader.read()
173.     assert content == ("\n"
174.                        "class Foo:\n"
175.                        "\n")
176.     assert reader.lineno_start == 1
177. 
178. 
179. def test_LiteralIncludeReader_missing_start_and_end(literal_inc_path):
180.     options = {'start-at': 'NOTHING'}
181.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
182.     with pytest.raises(ValueError):
183.         content, lines = reader.read()
184. 
185.     options = {'end-at': 'NOTHING'}
186.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
187.     with pytest.raises(ValueError):
188.         content, lines = reader.read()
189. 
190.     options = {'start-after': 'NOTHING'}
191.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
192.     with pytest.raises(ValueError):
193.         content, lines = reader.read()
194. 
195.     options = {'end-before': 'NOTHING'}
196.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
197.     with pytest.raises(ValueError):
198.         content, lines = reader.read()
199. 
200. 
201. def test_LiteralIncludeReader_end_before(literal_inc_path):
202.     options = {'end-before': 'nclud'}  # *nclud* matches first and third lines.
203.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
204.     content, lines = reader.read()
205.     assert content == ("# Literally included file using Python highlighting\n"
206.                        "\n")
207. 
208. 
209. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
210. def test_LiteralIncludeReader_prepend(literal_inc_path):
211.     options = {'lines': '1', 'prepend': 'Hello', 'append': 'Sphinx'}
212.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
213.     content, lines = reader.read()
214.     assert content == ("Hello\n"
215.                        "# Literally included file using Python highlighting\n"
216.                        "Sphinx\n")
217. 
218. 
219. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
220. def test_LiteralIncludeReader_dedent(literal_inc_path):
221.     # dedent: 2
222.     options = {'lines': '9-11', 'dedent': 2}
223.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
224.     content, lines = reader.read()
225.     assert content == ("  def baz():\n"
226.                        "      pass\n"
227.                        "\n")
228. 
229.     # dedent: 4
230.     options = {'lines': '9-11', 'dedent': 4}
231.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
232.     content, lines = reader.read()
233.     assert content == ("def baz():\n"
234.                        "    pass\n"
235.                        "\n")
236. 
237.     # dedent: 6
238.     options = {'lines': '9-11', 'dedent': 6}
239.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
240.     content, lines = reader.read()
241.     assert content == ("f baz():\n"
242.                        "  pass\n"
243.                        "\n")
244. 
245.     # dedent: None
246.     options = {'lines': '9-11', 'dedent': None}
247.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
248.     content, lines = reader.read()
249.     assert content == ("def baz():\n"
250.                        "    pass\n"
251.                        "\n")
252. 
253. 
254. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
255. def test_LiteralIncludeReader_tabwidth(testroot):
256.     # tab-width: 4
257.     options = {'tab-width': 4, 'pyobject': 'Qux'}
258.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
259.     content, lines = reader.read()
260.     assert content == ("class Qux:\n"
261.                        "    def quux(self):\n"
262.                        "        pass\n")
263. 
264.     # tab-width: 8
265.     options = {'tab-width': 8, 'pyobject': 'Qux'}
266.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
267.     content, lines = reader.read()
268.     assert content == ("class Qux:\n"
269.                        "        def quux(self):\n"
270.                        "                pass\n")
271. 
272. 
273. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
274. def test_LiteralIncludeReader_tabwidth_dedent(testroot):
275.     options = {'tab-width': 4, 'dedent': 4, 'pyobject': 'Qux.quux'}
276.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
277.     content, lines = reader.read()
278.     assert content == ("def quux(self):\n"
279.                        "    pass\n")
280. 
281. 
282. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
283. def test_LiteralIncludeReader_diff(testroot, literal_inc_path):
284.     options = {'diff': testroot / 'literal-diff.inc'}
285.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
286.     content, lines = reader.read()
287.     assert content == ("--- " + testroot + "/literal-diff.inc\n"
288.                        "+++ " + testroot + "/literal.inc\n"
289.                        "@@ -6,8 +6,8 @@\n"
290.                        "     pass\n"
291.                        " \n"
292.                        " class Bar:\n"
293.                        "-    def baz(self):\n"
294.                        "+    def baz():\n"
295.                        "         pass\n"
296.                        " \n"
297.                        "-# comment after Bar class\n"
298.                        "+# comment after Bar class definition\n"
299.                        " def bar(): pass\n")
300. 
301. 
302. @pytest.mark.sphinx('xml', testroot='directive-code')
303. def test_code_block(app, status, warning):
304.     app.builder.build('index')
305.     et = etree_parse(app.outdir / 'index.xml')
306.     secs = et.findall('./section/section')
307.     code_block = secs[0].findall('literal_block')
308.     assert len(code_block) > 0
309.     actual = code_block[0].text
310.     expect = (
311.         "    def ruby?\n" +
312.         "        false\n" +
313.         "    end"
314.     )
315.     assert actual == expect
316. 
317. 
318. @pytest.mark.sphinx('html', testroot='directive-code')
319. def test_force_option(app, status, warning):
320.     app.builder.build(['force'])
321.     assert 'force.rst' not in warning.getvalue()
322. 
323. 
324. @pytest.mark.sphinx('html', testroot='directive-code')
325. def test_code_block_caption_html(app, status, warning):
326.     app.builder.build(['caption'])
327.     html = (app.outdir / 'caption.html').read_text()
328.     caption = ('<div class="code-block-caption">'
329.                '<span class="caption-number">Listing 1 </span>'
330.                '<span class="caption-text">caption <em>test</em> rb'
331.                '</span><a class="headerlink" href="#id1" '
332.                'title="Permalink to this code">\xb6</a></div>')
333.     assert caption in html
334. 
335. 
336. @pytest.mark.sphinx('latex', testroot='directive-code')
337. def test_code_block_caption_latex(app, status, warning):
338.     app.builder.build_all()
339.     latex = (app.outdir / 'python.tex').read_text()
340.     caption = '\\sphinxSetupCaptionForVerbatim{caption \\sphinxstyleemphasis{test} rb}'
341.     label = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:id1}}}'
342.     link = '\\hyperref[\\detokenize{caption:name-test-rb}]' \
343.            '{Listing \\ref{\\detokenize{caption:name-test-rb}}}'
344.     assert caption in latex
345.     assert label in latex
346.     assert link in latex
347. 
348. 
349. @pytest.mark.sphinx('latex', testroot='directive-code')
350. def test_code_block_namedlink_latex(app, status, warning):
351.     app.builder.build_all()
352.     latex = (app.outdir / 'python.tex').read_text()
353.     label1 = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:name-test-rb}}}'
354.     link1 = '\\hyperref[\\detokenize{caption:name-test-rb}]'\
355.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{Ruby}}'
356.     label2 = ('\\def\\sphinxLiteralBlockLabel'
357.               '{\\label{\\detokenize{namedblocks:some-ruby-code}}}')
358.     link2 = '\\hyperref[\\detokenize{namedblocks:some-ruby-code}]'\
359.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{the ruby code}}}'
360.     assert label1 in latex
361.     assert link1 in latex
362.     assert label2 in latex
363.     assert link2 in latex
364. 
365. 
366. @pytest.mark.sphinx('latex', testroot='directive-code')
367. def test_code_block_emphasize_latex(app, status, warning):
368.     app.builder.build(['emphasize'])
369.     latex = (app.outdir / 'python.tex').read_text().replace('\r\n', '\n')
370.     includes = '\\fvset{hllines={, 5, 6, 13, 14, 15, 24, 25, 26,}}%\n'
371.     assert includes in latex
372.     includes = '\\end{sphinxVerbatim}\n\\sphinxresetverbatimhllines\n'
373.     assert includes in latex
374. 
375. 
376. @pytest.mark.sphinx('xml', testroot='directive-code')
377. def test_literal_include(app, status, warning):
378.     app.builder.build(['index'])
379.     et = etree_parse(app.outdir / 'index.xml')
380.     secs = et.findall('./section/section')
381.     literal_include = secs[1].findall('literal_block')
382.     literal_src = (app.srcdir / 'literal.inc').read_text()
383.     assert len(literal_include) > 0
384.     actual = literal_include[0].text
385.     assert actual == literal_src
386. 
387. 
388. @pytest.mark.sphinx('xml', testroot='directive-code')
389. def test_literal_include_block_start_with_comment_or_brank(app, status, warning):
390.     app.builder.build(['python'])
391.     et = etree_parse(app.outdir / 'python.xml')
392.     secs = et.findall('./section/section')
393.     literal_include = secs[0].findall('literal_block')
394.     assert len(literal_include) > 0
395.     actual = literal_include[0].text
396.     expect = (
397.         'def block_start_with_comment():\n'
398.         '    # Comment\n'
399.         '    return 1\n'
400.     )
401.     assert actual == expect
402. 
403.     actual = literal_include[1].text
404.     expect = (
405.         'def block_start_with_blank():\n'
406.         '\n'
407.         '    return 1\n'
408.     )
409.     assert actual == expect
410. 
411. 
412. @pytest.mark.sphinx('html', testroot='directive-code')
413. def test_literal_include_linenos(app, status, warning):
414.     app.builder.build(['linenos'])
415.     html = (app.outdir / 'linenos.html').read_text()
416. 
417.     # :linenos:
418.     assert ('<span class="linenos"> 1</span><span class="c1">'
419.             '# Literally included file using Python highlighting</span>' in html)
420. 
421.     # :lineno-start:
422.     assert ('<span class="linenos">200</span><span class="c1">'
423.             '# Literally included file using Python highlighting</span>' in html)
424. 
425.     # :lines: 5-9
426.     assert ('<span class="linenos">5</span><span class="k">class</span> '
427.             '<span class="nc">Foo</span><span class="p">:</span>' in html)
428. 
429. 
430. @pytest.mark.sphinx('latex', testroot='directive-code')
431. def test_literalinclude_file_whole_of_emptyline(app, status, warning):
432.     app.builder.build_all()
433.     latex = (app.outdir / 'python.tex').read_text().replace('\r\n', '\n')
434.     includes = (
435.         '\\begin{sphinxVerbatim}'
436.         '[commandchars=\\\\\\{\\},numbers=left,firstnumber=1,stepnumber=1]\n'
437.         '\n'
438.         '\n'
439.         '\n'
440.         '\\end{sphinxVerbatim}\n')
441.     assert includes in latex
442. 
443. 
444. @pytest.mark.sphinx('html', testroot='directive-code')
445. def test_literalinclude_caption_html(app, status, warning):
446.     app.builder.build('index')
447.     html = (app.outdir / 'caption.html').read_text()
448.     caption = ('<div class="code-block-caption">'
449.                '<span class="caption-number">Listing 2 </span>'
450.                '<span class="caption-text">caption <strong>test</strong> py'
451.                '</span><a class="headerlink" href="#id2" '
452.                'title="Permalink to this code">\xb6</a></div>')
453.     assert caption in html
454. 
455. 
456. @pytest.mark.sphinx('latex', testroot='directive-code')
457. def test_literalinclude_caption_latex(app, status, warning):
458.     app.builder.build('index')
459.     latex = (app.outdir / 'python.tex').read_text()
460.     caption = '\\sphinxSetupCaptionForVerbatim{caption \\sphinxstylestrong{test} py}'
461.     label = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:id2}}}'
462.     link = '\\hyperref[\\detokenize{caption:name-test-py}]' \
463.            '{Listing \\ref{\\detokenize{caption:name-test-py}}}'
464.     assert caption in latex
465.     assert label in latex
466.     assert link in latex
467. 
468. 
469. @pytest.mark.sphinx('latex', testroot='directive-code')
470. def test_literalinclude_namedlink_latex(app, status, warning):
471.     app.builder.build('index')
472.     latex = (app.outdir / 'python.tex').read_text()
473.     label1 = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:name-test-py}}}'
474.     link1 = '\\hyperref[\\detokenize{caption:name-test-py}]'\
475.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{Python}}'
476.     label2 = ('\\def\\sphinxLiteralBlockLabel'
477.               '{\\label{\\detokenize{namedblocks:some-python-code}}}')
478.     link2 = '\\hyperref[\\detokenize{namedblocks:some-python-code}]'\
479.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{the python code}}}'
480.     assert label1 in latex
481.     assert link1 in latex
482.     assert label2 in latex
483.     assert link2 in latex
484. 
485. 
486. @pytest.mark.sphinx('xml', testroot='directive-code')
487. def test_literalinclude_classes(app, status, warning):
488.     app.builder.build(['classes'])
489.     et = etree_parse(app.outdir / 'classes.xml')
490.     secs = et.findall('./section/section')
491. 
492.     code_block = secs[0].findall('literal_block')
493.     assert len(code_block) > 0
494.     assert 'foo bar' == code_block[0].get('classes')
495.     assert 'code_block' == code_block[0].get('names')
496. 
497.     literalinclude = secs[1].findall('literal_block')
498.     assert len(literalinclude) > 0
499.     assert 'bar baz' == literalinclude[0].get('classes')
500.     assert 'literal_include' == literalinclude[0].get('names')
501. 
502. 
503. @pytest.mark.sphinx('xml', testroot='directive-code')
504. def test_literalinclude_pydecorators(app, status, warning):
505.     app.builder.build(['py-decorators'])
506.     et = etree_parse(app.outdir / 'py-decorators.xml')
507.     secs = et.findall('./section/section')
508. 
509.     literal_include = secs[0].findall('literal_block')
510.     assert len(literal_include) == 3
511. 
512.     actual = literal_include[0].text
513.     expect = (
514.         '@class_decorator\n'
515.         '@other_decorator()\n'
516.         'class TheClass(object):\n'
517.         '\n'
518.         '    @method_decorator\n'
519.         '    @other_decorator()\n'
520.         '    def the_method():\n'
521.         '        pass\n'
522.     )
523.     assert actual == expect
524. 
525.     actual = literal_include[1].text
526.     expect = (
527.         '    @method_decorator\n'
528.         '    @other_decorator()\n'
529.         '    def the_method():\n'
530.         '        pass\n'
531.     )
532.     assert actual == expect
533. 
534.     actual = literal_include[2].text
535.     expect = (
536.         '@function_decorator\n'
537.         '@other_decorator()\n'
538.         'def the_function():\n'
539.         '    pass\n'
540.     )
541.     assert actual == expect
542. 
543. 
544. @pytest.mark.sphinx('dummy', testroot='directive-code')
545. def test_code_block_highlighted(app, status, warning):
546.     app.builder.build(['highlight'])
547.     doctree = app.env.get_doctree('highlight')
548.     codeblocks = list(doctree.findall(nodes.literal_block))
549. 
550.     assert codeblocks[0]['language'] == 'default'
551.     assert codeblocks[1]['language'] == 'python2'
552.     assert codeblocks[2]['language'] == 'python3'
553.     assert codeblocks[3]['language'] == 'python2'
554. 
555. 
556. @pytest.mark.sphinx('html', testroot='directive-code')
557. def test_linenothreshold(app, status, warning):
558.     app.builder.build(['linenothreshold'])
559.     html = (app.outdir / 'linenothreshold.html').read_text()
560. 
561.     # code-block using linenothreshold
562.     assert ('<span class="linenos">1</span><span class="k">class</span> '
563.             '<span class="nc">Foo</span><span class="p">:</span>' in html)
564. 
565.     # code-block not using linenothreshold (no line numbers)
566.     assert '<span></span><span class="c1"># comment</span>' in html
567. 
568.     # literal include using linenothreshold
569.     assert ('<span class="linenos"> 1</span><span class="c1">'
570.             '# Literally included file using Python highlighting</span>' in html)
571. 
572.     # literal include not using linenothreshold (no line numbers)
573.     assert ('<span></span><span class="c1"># Very small literal include '
574.             '(linenothreshold check)</span>' in html)
575. 
576. 
577. @pytest.mark.sphinx('dummy', testroot='directive-code')
578. def test_code_block_dedent(app, status, warning):
579.     app.builder.build(['dedent'])
580.     doctree = app.env.get_doctree('dedent')
581.     codeblocks = list(doctree.traverse(nodes.literal_block))
582.     # Note: comparison string should not have newlines at the beginning or end
583.     text_0_indent = '''First line
584. Second line
585.     Third line
586. Fourth line'''
587.     text_2_indent = '''  First line
588.   Second line
589.       Third line
590.   Fourth line'''
591.     text_4_indent = '''    First line
592.     Second line
593.         Third line
594.     Fourth line'''
595. 
596.     assert codeblocks[0].astext() == text_0_indent
597.     assert codeblocks[1].astext() == text_0_indent
598.     assert codeblocks[2].astext() == text_4_indent
599.     assert codeblocks[3].astext() == text_2_indent
600.     assert codeblocks[4].astext() == text_4_indent
601.     assert codeblocks[5].astext() == text_0_indent

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 10:24:16,718 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have identified three relevant test cases in `tests/test_directive_code.py` (`test_LiteralIncludeReader_prepend`, `test_LiteralIncludeReader_dedent`, and `test_LiteralIncludeReader_tabwidth_dedent`) that test the `literalinclude` directive's `prepend` and `dedent` options. However, these tests depend on external files (`literal.inc` and `target.py`) to provide the code that is included. The content of these files is necessary to understand the logic and assertions of the test cases and to make them self-contained as per the request. Without the content of these files, the tests are incomplete." query='Please provide the content of the files `tests/roots/test-directive-code/literal.inc` and `tests/roots/test-directive-code/target.py`.' extra_requirements='' purpose='The content of these files is required to understand the behavior and assertions of the most relevant test cases for the reported bug.'
2025-12-23 10:24:16,719 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the content of the files `tests/roots/test-directive-code/literal.inc` and `tests/roots/test-directive-code/target.py`.
2025-12-23 10:24:16,719 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 10:24:16,720 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 10:24:16,721 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 10:24:16,721 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the content of the files `tests/roots/test-directive-code/literal.inc` and `tests/roots/test-directive-code/target.py`.
Purpose: The content of these files is required to understand the behavior and assertions of the most relevant test cases for the reported bug.
2025-12-23 10:24:19,437 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will read the two files you requested to understand the test case behavior.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/roots/test-directive-code/target.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2102, 'candidates_token_count': 69, 'total_token_count': 2298, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2102}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 69}], 'thoughts_token_count': 127, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08378496031830276, 'model_name': 'gemini-2.5-pro'} id='run--cc8a3a23-7bc6-4eda-9f16-eb04ffc63058-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-directive-code/literal.inc'}, 'id': '2c4cf555-8295-432e-93a1-75521f9e93f1', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-directive-code/target.py'}, 'id': '92874252-c716-4fec-9bb5-2acd47987da0', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2102, 'output_tokens': 69, 'total_tokens': 2298, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 127}}
2025-12-23 10:24:30,861 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the content of `tests/roots/test-directive-code/target.py`. However, it appears that the file `tests/roots/test-directive-code/literal.inc` does not exist in the codebase. I have tried multiple ways to find it without success.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2491, 'candidates_token_count': 62, 'total_token_count': 3678, 'cached_content_token_count': 1502, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2491}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1502}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 62}], 'thoughts_token_count': 1125}, 'finish_reason': 'STOP', 'avg_logprobs': -1.3252650845435359, 'model_name': 'gemini-2.5-pro'} id='run--f7089840-d45d-4b55-96f7-8705d550d9a0-0' usage_metadata={'input_tokens': 2491, 'output_tokens': 62, 'total_tokens': 3678, 'input_token_details': {'cache_read': 1502}, 'output_token_details': {'reasoning': 1125}}
2025-12-23 10:24:30,868 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the content of the files `tests/roots/test-directive-code/literal.inc` and `tests/roots/test-directive-code/target.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
The content of these files is required to understand the behavior and assertions of the most relevant test cases for the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/roots/test-directive-code/target.py
Line number range: 1 - 26
Content:
1. # Literally included file using Python highlighting
2. 
3. foo = "Including Unicode characters: üöä"
4. 
5. class Foo:
6.     pass
7. 
8. class Bar:
9.     def baz():
10.         pass
11. 
12. # comment after Bar class definition
13. def bar(): pass
14. 
15. def block_start_with_comment():
16.     # Comment
17.     return 1
18. 
19. def block_start_with_blank():
20. 
21.     return 1
22. 
23. 
24. class Qux:
25. 	def quux(self):
26. 		pass

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 10:24:35,726 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user explicitly requested the content of the file `tests/roots/test-directive-code/target.py`.', relative_path='tests/roots/test-directive-code/target.py', start_line=1, end_line=26)]
2025-12-23 10:24:35,728 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the content of the files `tests/roots/test-directive-code/literal.inc` and `tests/roots/test-directive-code/target.py`.
2025-12-23 10:24:35,728 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 10:24:35,728 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 10:24:35,729 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-23 10:24:35,729 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-23 10:24:35,730 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug-report.yml
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── create-release.yml
|       ├── docutils-latest.yml
|       ├── lint.yml
|       ├── lock.yml
|       ├── main.yml
|       ├── nodejs.yml
|       └── transifex.yml
├── .readthedocs.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   ├── themes
|   |   |   └── fullsize
|   |   └── tutorial
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── development
|   |   ├── builders.rst
|   |   ├── index.rst
|   |   ├── overview.rst
|   |   ├── theming.rst
|   |   └── tutorials
|   |       ├── autodoc_ext.rst
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── autodoc_intenum.py
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   ├── tutorial
|   |   ├── automatic-doc-generation.rst
|   |   ├── deploying.rst
|   |   ├── describing-code.rst
|   |   ├── end.rst
|   |   ├── first-steps.rst
|   |   ├── getting-started.rst
|   |   ├── index.rst
|   |   ├── more-sphinx-customization.rst
|   |   └── narrative-documentation.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── changes.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── deprecated.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── preserve_defaults.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_FR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_GB
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── en_HK
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr_FR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── is
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── yue
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_HK
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_TW
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW.Big5
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── minified-js
|   |   |   ├── base-stemmer.js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── base-stemmer.js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── _sphinx_javascript_frameworks_compat.js
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.13.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── __init__.py
|   ├── certs
|   ├── conftest.py
|   ├── ext_napoleon_pep526_data_google.py
|   ├── ext_napoleon_pep526_data_numpy.py
|   ├── js
|   |   ├── doctools.js
|   |   └── searchtools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── dedent.rst
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-csv-table
|   |   |   ├── conf.py
|   |   |   └── subdir
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── field-role.rst
|   |   |   ├── function_param_target.rst
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── ns_lookup.rst
|   |   ├── test-domain-c-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── field-role.rst
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-cpp-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── abbr.rst
|   |   |   ├── canonical.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py-python_use_unqualified_type_names
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-py-xref-warning
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── TYPE_CHECKING.py
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── autodoc_type_aliases.py
|   |   |       ├── bound_method.py
|   |   |       ├── cached_property.py
|   |   |       ├── callable.py
|   |   |       ├── canonical
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── empty_all.py
|   |   |       ├── enums.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── generic_class.py
|   |   |       ├── genericalias.py
|   |   |       ├── hide_value.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── instance_variable.py
|   |   |       ├── metadata.py
|   |   |       ├── methods.py
|   |   |       ├── module.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── overload2.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── pep604.py
|   |   |       ├── preserve_defaults.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── properties.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       ├── uninitialized_attributes.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-filename-map
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-extlinks-hardcoded-urls
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-extlinks-hardcoded-urls-multiple-replacements
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-intersphinx-role
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   ├── nomath.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-highlight_options
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_signaturereturn_icon
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── noqa.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-container
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-linkcheck-documents_exclude
|   |   |   ├── br0ken_link.rst
|   |   |   ├── broken_link.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-anchor
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-https
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-warn-redirects
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-local-logo
|   |   |   ├── conf.py
|   |   |   ├── images
|   |   |   └── index.rst
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nitpicky-warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-remote-logo
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── literals.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-transforms-post_transforms-missing-reference
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autoattribute.py
|   ├── test_ext_autodoc_autoclass.py
|   ├── test_ext_autodoc_autodata.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_automodule.py
|   ├── test_ext_autodoc_autoproperty.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_preserve_defaults.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_extlinks.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_extension.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   ├── typing_test_data.py
|   └── utils.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    └── doclinter.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Use of literalinclude prepend results in incorrect indent formatting for code eamples

Description: ### Describe the bug

Cannot determine a mechanism to use literalinclude directive with `prepend` or `append` to match code example indentation, as leading whitespace is removed.

### How to Reproduce

Example of including xml snippet, that should be prefixed with ``     <plugin>``.

File ``index.rst``:

``` rst
# hello world

Code examples:

.. literalinclude:: pom.xml
   :language: xml
   :prepend:       </plugin>
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-at: </plugin>
```

File `pom.xml``:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.8.0</version>
        <configuration>
          <source>1.8</source>
          <target>1.8</target>
          <debug>true</debug>
          <encoding>UTF-8</encoding>
        </configuration>
      </plugin>
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
    </plugins>
  </build>
</project>
```

Produces the following valid xml, which is indented poorly:
```xml
<plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
   ```
   
 I cannot think of good warning free way to indent `:prepend:` to match the included code example.

### Expected behavior

Expect leading white space to be preserved in output:

```xml
      <plugin>
        <groupId>com.github.ekryd.sortpom</groupId>
        <artifactId>sortpom-maven-plugin</artifactId>
        <version>2.15.0</version>
        <configuration>
          <verifyFailOn>strict</verifyFailOn>
        </configuration>
      </plugin>
```

### Your project

https://github.com/geoserver/geoserver/tree/main/doc/en/developer/source

### Screenshots

_No response_

### OS

Mac

### Python version

3.9.10

### Sphinx version

4.4.0

### Sphinx extensions

['sphinx.ext.todo', 'sphinx.ext.extlinks']

### Extra tools

_No response_

### Additional context

Using `dedent` creatively almost provides a workaround:

``` rst
.. literalinclude:: pom.xml
   :language: xml
   :start-at: <groupId>com.github.ekryd.sortpom</groupId>
   :end-before: </plugin>
   :prepend: _____</plugin>
   :dedent: 5
```

Produces a warning, which fails the build with ``-W`` build policy.
```
index.rst.rst:155: WARNING: non-whitespace stripped by dedent
```

Use of `dedent` could be a good solution, if `dedent` was applied only to the literalinclude and not to the `prepend` and `append` content.

Patch information:
diff --git a/sphinx/directives/code.py b/sphinx/directives/code.py
index dc44ed314..9f359c0eb 100644
--- a/sphinx/directives/code.py
+++ b/sphinx/directives/code.py
@@ -343,6 +343,7 @@ class LiteralIncludeReader:
     def prepend_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         prepend = self.options.get('prepend')
         if prepend:
+            # Preserve the leading whitespace in the prepend text
             lines.insert(0, prepend + '\n')
 
         return lines
@@ -350,13 +351,36 @@ class LiteralIncludeReader:
     def append_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         append = self.options.get('append')
         if append:
+            # Preserve the leading whitespace in the append text
             lines.append(append + '\n')
 
         return lines
 
     def dedent_filter(self, lines: List[str], location: Tuple[str, int] = None) -> List[str]:
         if 'dedent' in self.options:
-            return dedent_lines(lines, self.options.get('dedent'), location=location)
+            # Check if we have prepend/append content
+            has_prepend = 'prepend' in self.options
+            has_append = 'append' in self.options
+            
+            # If we have prepend/append, only dedent the included file content
+            if has_prepend or has_append:
+                # Find the range of lines that are from the included file
+                start = 1 if has_prepend else 0
+                end = len(lines) - 1 if has_append else len(lines)
+                
+                # Split into prepend, included content, and append
+                pre_lines = lines[:start] if has_prepend else []
+                included_lines = lines[start:end]
+                post_lines = lines[end:] if has_append else []
+                
+                # Only dedent the included content
+                dedented_included = dedent_lines(included_lines, self.options.get('dedent'), location=location)
+                
+                # Recombine all parts
+                return pre_lines + dedented_included + post_lines
+            else:
+                # No prepend/append, dedent everything as before
+                return dedent_lines(lines, self.options.get('dedent'), location=location)
         else:
             return lines
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `tests/test_directive_code.py`.
Extra Requirements: If the file is too large, please at least provide all test functions that test the `literalinclude` directive, especially those testing the `dedent`, `prepend`, and `append` options.
Purpose: This file is needed to identify and extract 3 complete test cases that are relevant to the user's bug report concerning `literalinclude` indentation.

Previous refined query 2:
Essential Query: Please provide the content of the files `tests/roots/test-directive-code/literal.inc` and `tests/roots/test-directive-code/target.py`.
Extra Requirements: 
Purpose: The content of these files is required to understand the behavior and assertions of the most relevant test cases for the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/roots/test-directive-code/target.py
Line number range: 1 - 26
Content:
1. # Literally included file using Python highlighting
2. 
3. foo = "Including Unicode characters: üöä"
4. 
5. class Foo:
6.     pass
7. 
8. class Bar:
9.     def baz():
10.         pass
11. 
12. # comment after Bar class definition
13. def bar(): pass
14. 
15. def block_start_with_comment():
16.     # Comment
17.     return 1
18. 
19. def block_start_with_blank():
20. 
21.     return 1
22. 
23. 
24. class Qux:
25. 	def quux(self):
26. 		pass


File: tests/test_directive_code.py
Line number range: 1 - 601
Content:
1. """Test the code-block directive."""
2. 
3. import os
4. 
5. import pytest
6. from docutils import nodes
7. 
8. from sphinx.config import Config
9. from sphinx.directives.code import LiteralIncludeReader
10. from sphinx.testing.util import etree_parse
11. 
12. DUMMY_CONFIG = Config({}, {})
13. 
14. 
15. @pytest.fixture(scope='module')
16. def testroot(rootdir):
17.     testroot_path = rootdir / 'test-directive-code'
18.     return testroot_path
19. 
20. 
21. @pytest.fixture(scope='module')
22. def literal_inc_path(testroot):
23.     return testroot / 'literal.inc'
24. 
25. 
26. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
27. def test_LiteralIncludeReader(literal_inc_path):
28.     options = {'lineno-match': True}
29.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
30.     content, lines = reader.read()
31.     assert content == literal_inc_path.read_text()
32.     assert lines == 13
33.     assert reader.lineno_start == 1
34. 
35. 
36. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
37. def test_LiteralIncludeReader_lineno_start(literal_inc_path):
38.     options = {'lineno-start': 4}
39.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
40.     content, lines = reader.read()
41.     assert content == literal_inc_path.read_text()
42.     assert lines == 13
43.     assert reader.lineno_start == 4
44. 
45. 
46. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
47. def test_LiteralIncludeReader_pyobject1(literal_inc_path):
48.     options = {'lineno-match': True, 'pyobject': 'Foo'}
49.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
50.     content, lines = reader.read()
51.     assert content == ("class Foo:\n"
52.                        "    pass\n")
53.     assert reader.lineno_start == 5
54. 
55. 
56. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
57. def test_LiteralIncludeReader_pyobject2(literal_inc_path):
58.     options = {'pyobject': 'Bar'}
59.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
60.     content, lines = reader.read()
61.     assert content == ("class Bar:\n"
62.                        "    def baz():\n"
63.                        "        pass\n")
64.     assert reader.lineno_start == 1  # no lineno-match
65. 
66. 
67. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
68. def test_LiteralIncludeReader_pyobject3(literal_inc_path):
69.     options = {'pyobject': 'Bar.baz'}
70.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
71.     content, lines = reader.read()
72.     assert content == ("    def baz():\n"
73.                        "        pass\n")
74. 
75. 
76. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
77. def test_LiteralIncludeReader_pyobject_and_lines(literal_inc_path):
78.     options = {'pyobject': 'Bar', 'lines': '2-'}
79.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
80.     content, lines = reader.read()
81.     assert content == ("    def baz():\n"
82.                        "        pass\n")
83. 
84. 
85. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
86. def test_LiteralIncludeReader_lines1(literal_inc_path):
87.     options = {'lines': '1-3'}
88.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
89.     content, lines = reader.read()
90.     assert content == ("# Literally included file using Python highlighting\n"
91.                        "\n"
92.                        "foo = \"Including Unicode characters: üöä\"\n")
93. 
94. 
95. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
96. def test_LiteralIncludeReader_lines2(literal_inc_path):
97.     options = {'lines': '1,3,5'}
98.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
99.     content, lines = reader.read()
100.     assert content == ("# Literally included file using Python highlighting\n"
101.                        "foo = \"Including Unicode characters: üöä\"\n"
102.                        "class Foo:\n")
103. 
104. 
105. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
106. def test_LiteralIncludeReader_lines_and_lineno_match1(literal_inc_path):
107.     options = {'lines': '3-5', 'lineno-match': True}
108.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
109.     content, lines = reader.read()
110.     assert content == ("foo = \"Including Unicode characters: üöä\"\n"
111.                        "\n"
112.                        "class Foo:\n")
113.     assert reader.lineno_start == 3
114. 
115. 
116. @pytest.mark.sphinx()  # init locale for errors
117. def test_LiteralIncludeReader_lines_and_lineno_match2(literal_inc_path, app, status, warning):
118.     options = {'lines': '0,3,5', 'lineno-match': True}
119.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
120.     with pytest.raises(ValueError):
121.         content, lines = reader.read()
122. 
123. 
124. @pytest.mark.sphinx()  # init locale for errors
125. def test_LiteralIncludeReader_lines_and_lineno_match3(literal_inc_path, app, status, warning):
126.     options = {'lines': '100-', 'lineno-match': True}
127.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
128.     with pytest.raises(ValueError):
129.         content, lines = reader.read()
130. 
131. 
132. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
133. def test_LiteralIncludeReader_start_at(literal_inc_path):
134.     options = {'lineno-match': True, 'start-at': 'Foo', 'end-at': 'Bar'}
135.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
136.     content, lines = reader.read()
137.     assert content == ("class Foo:\n"
138.                        "    pass\n"
139.                        "\n"
140.                        "class Bar:\n")
141.     assert reader.lineno_start == 5
142. 
143. 
144. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
145. def test_LiteralIncludeReader_start_after(literal_inc_path):
146.     options = {'lineno-match': True, 'start-after': 'Foo', 'end-before': 'Bar'}
147.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
148.     content, lines = reader.read()
149.     assert content == ("    pass\n"
150.                        "\n")
151.     assert reader.lineno_start == 6
152. 
153. 
154. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
155. def test_LiteralIncludeReader_start_after_and_lines(literal_inc_path):
156.     options = {'lineno-match': True, 'lines': '6-',
157.                'start-after': 'Literally', 'end-before': 'comment'}
158.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
159.     content, lines = reader.read()
160.     assert content == ("\n"
161.                        "class Bar:\n"
162.                        "    def baz():\n"
163.                        "        pass\n"
164.                        "\n")
165.     assert reader.lineno_start == 7
166. 
167. 
168. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
169. def test_LiteralIncludeReader_start_at_and_lines(literal_inc_path):
170.     options = {'lines': '2, 3, 5', 'start-at': 'foo', 'end-before': '#'}
171.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
172.     content, lines = reader.read()
173.     assert content == ("\n"
174.                        "class Foo:\n"
175.                        "\n")
176.     assert reader.lineno_start == 1
177. 
178. 
179. def test_LiteralIncludeReader_missing_start_and_end(literal_inc_path):
180.     options = {'start-at': 'NOTHING'}
181.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
182.     with pytest.raises(ValueError):
183.         content, lines = reader.read()
184. 
185.     options = {'end-at': 'NOTHING'}
186.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
187.     with pytest.raises(ValueError):
188.         content, lines = reader.read()
189. 
190.     options = {'start-after': 'NOTHING'}
191.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
192.     with pytest.raises(ValueError):
193.         content, lines = reader.read()
194. 
195.     options = {'end-before': 'NOTHING'}
196.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
197.     with pytest.raises(ValueError):
198.         content, lines = reader.read()
199. 
200. 
201. def test_LiteralIncludeReader_end_before(literal_inc_path):
202.     options = {'end-before': 'nclud'}  # *nclud* matches first and third lines.
203.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
204.     content, lines = reader.read()
205.     assert content == ("# Literally included file using Python highlighting\n"
206.                        "\n")
207. 
208. 
209. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
210. def test_LiteralIncludeReader_prepend(literal_inc_path):
211.     options = {'lines': '1', 'prepend': 'Hello', 'append': 'Sphinx'}
212.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
213.     content, lines = reader.read()
214.     assert content == ("Hello\n"
215.                        "# Literally included file using Python highlighting\n"
216.                        "Sphinx\n")
217. 
218. 
219. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
220. def test_LiteralIncludeReader_dedent(literal_inc_path):
221.     # dedent: 2
222.     options = {'lines': '9-11', 'dedent': 2}
223.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
224.     content, lines = reader.read()
225.     assert content == ("  def baz():\n"
226.                        "      pass\n"
227.                        "\n")
228. 
229.     # dedent: 4
230.     options = {'lines': '9-11', 'dedent': 4}
231.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
232.     content, lines = reader.read()
233.     assert content == ("def baz():\n"
234.                        "    pass\n"
235.                        "\n")
236. 
237.     # dedent: 6
238.     options = {'lines': '9-11', 'dedent': 6}
239.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
240.     content, lines = reader.read()
241.     assert content == ("f baz():\n"
242.                        "  pass\n"
243.                        "\n")
244. 
245.     # dedent: None
246.     options = {'lines': '9-11', 'dedent': None}
247.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
248.     content, lines = reader.read()
249.     assert content == ("def baz():\n"
250.                        "    pass\n"
251.                        "\n")
252. 
253. 
254. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
255. def test_LiteralIncludeReader_tabwidth(testroot):
256.     # tab-width: 4
257.     options = {'tab-width': 4, 'pyobject': 'Qux'}
258.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
259.     content, lines = reader.read()
260.     assert content == ("class Qux:\n"
261.                        "    def quux(self):\n"
262.                        "        pass\n")
263. 
264.     # tab-width: 8
265.     options = {'tab-width': 8, 'pyobject': 'Qux'}
266.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
267.     content, lines = reader.read()
268.     assert content == ("class Qux:\n"
269.                        "        def quux(self):\n"
270.                        "                pass\n")
271. 
272. 
273. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
274. def test_LiteralIncludeReader_tabwidth_dedent(testroot):
275.     options = {'tab-width': 4, 'dedent': 4, 'pyobject': 'Qux.quux'}
276.     reader = LiteralIncludeReader(testroot / 'target.py', options, DUMMY_CONFIG)
277.     content, lines = reader.read()
278.     assert content == ("def quux(self):\n"
279.                        "    pass\n")
280. 
281. 
282. @pytest.mark.xfail(os.name != 'posix', reason="Not working on windows")
283. def test_LiteralIncludeReader_diff(testroot, literal_inc_path):
284.     options = {'diff': testroot / 'literal-diff.inc'}
285.     reader = LiteralIncludeReader(literal_inc_path, options, DUMMY_CONFIG)
286.     content, lines = reader.read()
287.     assert content == ("--- " + testroot + "/literal-diff.inc\n"
288.                        "+++ " + testroot + "/literal.inc\n"
289.                        "@@ -6,8 +6,8 @@\n"
290.                        "     pass\n"
291.                        " \n"
292.                        " class Bar:\n"
293.                        "-    def baz(self):\n"
294.                        "+    def baz():\n"
295.                        "         pass\n"
296.                        " \n"
297.                        "-# comment after Bar class\n"
298.                        "+# comment after Bar class definition\n"
299.                        " def bar(): pass\n")
300. 
301. 
302. @pytest.mark.sphinx('xml', testroot='directive-code')
303. def test_code_block(app, status, warning):
304.     app.builder.build('index')
305.     et = etree_parse(app.outdir / 'index.xml')
306.     secs = et.findall('./section/section')
307.     code_block = secs[0].findall('literal_block')
308.     assert len(code_block) > 0
309.     actual = code_block[0].text
310.     expect = (
311.         "    def ruby?\n" +
312.         "        false\n" +
313.         "    end"
314.     )
315.     assert actual == expect
316. 
317. 
318. @pytest.mark.sphinx('html', testroot='directive-code')
319. def test_force_option(app, status, warning):
320.     app.builder.build(['force'])
321.     assert 'force.rst' not in warning.getvalue()
322. 
323. 
324. @pytest.mark.sphinx('html', testroot='directive-code')
325. def test_code_block_caption_html(app, status, warning):
326.     app.builder.build(['caption'])
327.     html = (app.outdir / 'caption.html').read_text()
328.     caption = ('<div class="code-block-caption">'
329.                '<span class="caption-number">Listing 1 </span>'
330.                '<span class="caption-text">caption <em>test</em> rb'
331.                '</span><a class="headerlink" href="#id1" '
332.                'title="Permalink to this code">\xb6</a></div>')
333.     assert caption in html
334. 
335. 
336. @pytest.mark.sphinx('latex', testroot='directive-code')
337. def test_code_block_caption_latex(app, status, warning):
338.     app.builder.build_all()
339.     latex = (app.outdir / 'python.tex').read_text()
340.     caption = '\\sphinxSetupCaptionForVerbatim{caption \\sphinxstyleemphasis{test} rb}'
341.     label = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:id1}}}'
342.     link = '\\hyperref[\\detokenize{caption:name-test-rb}]' \
343.            '{Listing \\ref{\\detokenize{caption:name-test-rb}}}'
344.     assert caption in latex
345.     assert label in latex
346.     assert link in latex
347. 
348. 
349. @pytest.mark.sphinx('latex', testroot='directive-code')
350. def test_code_block_namedlink_latex(app, status, warning):
351.     app.builder.build_all()
352.     latex = (app.outdir / 'python.tex').read_text()
353.     label1 = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:name-test-rb}}}'
354.     link1 = '\\hyperref[\\detokenize{caption:name-test-rb}]'\
355.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{Ruby}}'
356.     label2 = ('\\def\\sphinxLiteralBlockLabel'
357.               '{\\label{\\detokenize{namedblocks:some-ruby-code}}}')
358.     link2 = '\\hyperref[\\detokenize{namedblocks:some-ruby-code}]'\
359.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{the ruby code}}}'
360.     assert label1 in latex
361.     assert link1 in latex
362.     assert label2 in latex
363.     assert link2 in latex
364. 
365. 
366. @pytest.mark.sphinx('latex', testroot='directive-code')
367. def test_code_block_emphasize_latex(app, status, warning):
368.     app.builder.build(['emphasize'])
369.     latex = (app.outdir / 'python.tex').read_text().replace('\r\n', '\n')
370.     includes = '\\fvset{hllines={, 5, 6, 13, 14, 15, 24, 25, 26,}}%\n'
371.     assert includes in latex
372.     includes = '\\end{sphinxVerbatim}\n\\sphinxresetverbatimhllines\n'
373.     assert includes in latex
374. 
375. 
376. @pytest.mark.sphinx('xml', testroot='directive-code')
377. def test_literal_include(app, status, warning):
378.     app.builder.build(['index'])
379.     et = etree_parse(app.outdir / 'index.xml')
380.     secs = et.findall('./section/section')
381.     literal_include = secs[1].findall('literal_block')
382.     literal_src = (app.srcdir / 'literal.inc').read_text()
383.     assert len(literal_include) > 0
384.     actual = literal_include[0].text
385.     assert actual == literal_src
386. 
387. 
388. @pytest.mark.sphinx('xml', testroot='directive-code')
389. def test_literal_include_block_start_with_comment_or_brank(app, status, warning):
390.     app.builder.build(['python'])
391.     et = etree_parse(app.outdir / 'python.xml')
392.     secs = et.findall('./section/section')
393.     literal_include = secs[0].findall('literal_block')
394.     assert len(literal_include) > 0
395.     actual = literal_include[0].text
396.     expect = (
397.         'def block_start_with_comment():\n'
398.         '    # Comment\n'
399.         '    return 1\n'
400.     )
401.     assert actual == expect
402. 
403.     actual = literal_include[1].text
404.     expect = (
405.         'def block_start_with_blank():\n'
406.         '\n'
407.         '    return 1\n'
408.     )
409.     assert actual == expect
410. 
411. 
412. @pytest.mark.sphinx('html', testroot='directive-code')
413. def test_literal_include_linenos(app, status, warning):
414.     app.builder.build(['linenos'])
415.     html = (app.outdir / 'linenos.html').read_text()
416. 
417.     # :linenos:
418.     assert ('<span class="linenos"> 1</span><span class="c1">'
419.             '# Literally included file using Python highlighting</span>' in html)
420. 
421.     # :lineno-start:
422.     assert ('<span class="linenos">200</span><span class="c1">'
423.             '# Literally included file using Python highlighting</span>' in html)
424. 
425.     # :lines: 5-9
426.     assert ('<span class="linenos">5</span><span class="k">class</span> '
427.             '<span class="nc">Foo</span><span class="p">:</span>' in html)
428. 
429. 
430. @pytest.mark.sphinx('latex', testroot='directive-code')
431. def test_literalinclude_file_whole_of_emptyline(app, status, warning):
432.     app.builder.build_all()
433.     latex = (app.outdir / 'python.tex').read_text().replace('\r\n', '\n')
434.     includes = (
435.         '\\begin{sphinxVerbatim}'
436.         '[commandchars=\\\\\\{\\},numbers=left,firstnumber=1,stepnumber=1]\n'
437.         '\n'
438.         '\n'
439.         '\n'
440.         '\\end{sphinxVerbatim}\n')
441.     assert includes in latex
442. 
443. 
444. @pytest.mark.sphinx('html', testroot='directive-code')
445. def test_literalinclude_caption_html(app, status, warning):
446.     app.builder.build('index')
447.     html = (app.outdir / 'caption.html').read_text()
448.     caption = ('<div class="code-block-caption">'
449.                '<span class="caption-number">Listing 2 </span>'
450.                '<span class="caption-text">caption <strong>test</strong> py'
451.                '</span><a class="headerlink" href="#id2" '
452.                'title="Permalink to this code">\xb6</a></div>')
453.     assert caption in html
454. 
455. 
456. @pytest.mark.sphinx('latex', testroot='directive-code')
457. def test_literalinclude_caption_latex(app, status, warning):
458.     app.builder.build('index')
459.     latex = (app.outdir / 'python.tex').read_text()
460.     caption = '\\sphinxSetupCaptionForVerbatim{caption \\sphinxstylestrong{test} py}'
461.     label = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:id2}}}'
462.     link = '\\hyperref[\\detokenize{caption:name-test-py}]' \
463.            '{Listing \\ref{\\detokenize{caption:name-test-py}}}'
464.     assert caption in latex
465.     assert label in latex
466.     assert link in latex
467. 
468. 
469. @pytest.mark.sphinx('latex', testroot='directive-code')
470. def test_literalinclude_namedlink_latex(app, status, warning):
471.     app.builder.build('index')
472.     latex = (app.outdir / 'python.tex').read_text()
473.     label1 = '\\def\\sphinxLiteralBlockLabel{\\label{\\detokenize{caption:name-test-py}}}'
474.     link1 = '\\hyperref[\\detokenize{caption:name-test-py}]'\
475.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{Python}}'
476.     label2 = ('\\def\\sphinxLiteralBlockLabel'
477.               '{\\label{\\detokenize{namedblocks:some-python-code}}}')
478.     link2 = '\\hyperref[\\detokenize{namedblocks:some-python-code}]'\
479.             '{\\sphinxcrossref{\\DUrole{std,std-ref}{the python code}}}'
480.     assert label1 in latex
481.     assert link1 in latex
482.     assert label2 in latex
483.     assert link2 in latex
484. 
485. 
486. @pytest.mark.sphinx('xml', testroot='directive-code')
487. def test_literalinclude_classes(app, status, warning):
488.     app.builder.build(['classes'])
489.     et = etree_parse(app.outdir / 'classes.xml')
490.     secs = et.findall('./section/section')
491. 
492.     code_block = secs[0].findall('literal_block')
493.     assert len(code_block) > 0
494.     assert 'foo bar' == code_block[0].get('classes')
495.     assert 'code_block' == code_block[0].get('names')
496. 
497.     literalinclude = secs[1].findall('literal_block')
498.     assert len(literalinclude) > 0
499.     assert 'bar baz' == literalinclude[0].get('classes')
500.     assert 'literal_include' == literalinclude[0].get('names')
501. 
502. 
503. @pytest.mark.sphinx('xml', testroot='directive-code')
504. def test_literalinclude_pydecorators(app, status, warning):
505.     app.builder.build(['py-decorators'])
506.     et = etree_parse(app.outdir / 'py-decorators.xml')
507.     secs = et.findall('./section/section')
508. 
509.     literal_include = secs[0].findall('literal_block')
510.     assert len(literal_include) == 3
511. 
512.     actual = literal_include[0].text
513.     expect = (
514.         '@class_decorator\n'
515.         '@other_decorator()\n'
516.         'class TheClass(object):\n'
517.         '\n'
518.         '    @method_decorator\n'
519.         '    @other_decorator()\n'
520.         '    def the_method():\n'
521.         '        pass\n'
522.     )
523.     assert actual == expect
524. 
525.     actual = literal_include[1].text
526.     expect = (
527.         '    @method_decorator\n'
528.         '    @other_decorator()\n'
529.         '    def the_method():\n'
530.         '        pass\n'
531.     )
532.     assert actual == expect
533. 
534.     actual = literal_include[2].text
535.     expect = (
536.         '@function_decorator\n'
537.         '@other_decorator()\n'
538.         'def the_function():\n'
539.         '    pass\n'
540.     )
541.     assert actual == expect
542. 
543. 
544. @pytest.mark.sphinx('dummy', testroot='directive-code')
545. def test_code_block_highlighted(app, status, warning):
546.     app.builder.build(['highlight'])
547.     doctree = app.env.get_doctree('highlight')
548.     codeblocks = list(doctree.findall(nodes.literal_block))
549. 
550.     assert codeblocks[0]['language'] == 'default'
551.     assert codeblocks[1]['language'] == 'python2'
552.     assert codeblocks[2]['language'] == 'python3'
553.     assert codeblocks[3]['language'] == 'python2'
554. 
555. 
556. @pytest.mark.sphinx('html', testroot='directive-code')
557. def test_linenothreshold(app, status, warning):
558.     app.builder.build(['linenothreshold'])
559.     html = (app.outdir / 'linenothreshold.html').read_text()
560. 
561.     # code-block using linenothreshold
562.     assert ('<span class="linenos">1</span><span class="k">class</span> '
563.             '<span class="nc">Foo</span><span class="p">:</span>' in html)
564. 
565.     # code-block not using linenothreshold (no line numbers)
566.     assert '<span></span><span class="c1"># comment</span>' in html
567. 
568.     # literal include using linenothreshold
569.     assert ('<span class="linenos"> 1</span><span class="c1">'
570.             '# Literally included file using Python highlighting</span>' in html)
571. 
572.     # literal include not using linenothreshold (no line numbers)
573.     assert ('<span></span><span class="c1"># Very small literal include '
574.             '(linenothreshold check)</span>' in html)
575. 
576. 
577. @pytest.mark.sphinx('dummy', testroot='directive-code')
578. def test_code_block_dedent(app, status, warning):
579.     app.builder.build(['dedent'])
580.     doctree = app.env.get_doctree('dedent')
581.     codeblocks = list(doctree.traverse(nodes.literal_block))
582.     # Note: comparison string should not have newlines at the beginning or end
583.     text_0_indent = '''First line
584. Second line
585.     Third line
586. Fourth line'''
587.     text_2_indent = '''  First line
588.   Second line
589.       Third line
590.   Fourth line'''
591.     text_4_indent = '''    First line
592.     Second line
593.         Third line
594.     Fourth line'''
595. 
596.     assert codeblocks[0].astext() == text_0_indent
597.     assert codeblocks[1].astext() == text_0_indent
598.     assert codeblocks[2].astext() == text_4_indent
599.     assert codeblocks[3].astext() == text_2_indent
600.     assert codeblocks[4].astext() == text_4_indent
601.     assert codeblocks[5].astext() == text_0_indent

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 10:25:22,587 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have identified `test_code_block_dedent` in `tests/test_directive_code.py` as a potentially relevant test case. To confirm its relevance and see if it uses `literalinclude` with the `dedent` option, I need to inspect the corresponding reStructuredText source file that it processes. This file is `tests/roots/test-directive-code/dedent.rst`. Access to this file will clarify whether this test is a good candidate for the user's request, as it appears to be an integration-level test for the `dedent` functionality." query='Please provide the full content of the file `tests/roots/test-directive-code/dedent.rst`.' extra_requirements='' purpose="I need this file to determine if the `test_code_block_dedent` test case is relevant to the user's bug report concerning `literalinclude` and `dedent`."
2025-12-23 10:25:22,588 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `tests/roots/test-directive-code/dedent.rst`.
2025-12-23 10:25:22,588 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 10:25:22,589 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 10:25:22,590 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 10:25:22,590 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `tests/roots/test-directive-code/dedent.rst`.
Purpose: I need this file to determine if the `test_code_block_dedent` test case is relevant to the user's bug report concerning `literalinclude` and `dedent`.
2025-12-23 10:25:25,127 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/roots/test-directive-code/dedent.rst"}'}, '__gemini_function_call_thought_signatures__': {'0871a6b1-29cd-418e-a433-6f5e39c01918': 'CrMEAY89a1//bbJzdZrK3iPzxTsHP96DwlaQeVrqDYIFUlcXGfm19T4GQ7HC5lgclpVpnNCZhMaGG13G1EArweKv+uQJuYCTw2J+bFebpa+PxdwDgfIcfuiF//fVPCWboKngQnG2es9ymuVjs6zPL+ozxoTcNwmt+ycY8xpccSWXiCXIHUK6XEHgJuREYVd/Oaha/MWpCjP6GW8/emigHBkT3/VlPUJMaalqCf9GXIOt16E64IqDGa7z4sAKcq60ZTro626DhU+lVGStTB2Alu9DCDdPVEeqojhhVcKm09EmJRlh+ofyuOOW0sWI50fZwQnPV3PhPoq7p626nLWtBZLu+tZnDa7KWkIQXJG39OxT7WgwiXfmA9eCkD+OWf7YARMnSD5g/oNDrKmkfnT5jgK5FGMKuN6gYx69IABJQi2HHBTtSAc9szrwbWDllYeqjvrdG/RtP8401CrZyV7y+gB2x5NOf3G5tisVDlXOas99jc9joK7J62sCY4kymyut/iw7IE4CV7DrHJCwaQkfmoQZG8yi7FXFWH2176HO3JCxkIyFJ5DCkuP3/xX+O2xI3bKkmN8Qs874uRzNAPmtjffbSQrdCUJoadcNr1OytjwcO5mJ3WDs0ewHbArTd+yVU9d1TeA/vIWxwsyMdWNDil1oW424A/psjC/RBNdxDNE1ttLNL/6vwvDLMN1rLG7tsZ6BwLSkK/5Vr4+4r75DJbVGn+GgVOF8Ttch0fYqlMvnTF/JazU='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2103, 'candidates_token_count': 28, 'total_token_count': 2262, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2103}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 28}], 'thoughts_token_count': 131, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1889782292502267, 'model_name': 'gemini-2.5-pro'} id='run--cfa1fecb-951d-4ded-a33d-0453a8c8251b-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/roots/test-directive-code/dedent.rst'}, 'id': '0871a6b1-29cd-418e-a433-6f5e39c01918', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2103, 'output_tokens': 28, 'total_tokens': 2262, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 131}}
2025-12-23 10:25:27,250 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have successfully retrieved the entire content of the file `tests/roots/test-directive-code/dedent.rst`. This was accomplished by using the `read_file_with_knowledge_graph_data` tool, which allows for reading a file's content when its relative path is known. The file's content has been displayed for your review." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2841, 'candidates_token_count': 75, 'total_token_count': 2976, 'cached_content_token_count': 1577, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2972}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1577}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 75}], 'thoughts_token_count': 60}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12998676300048828, 'model_name': 'gemini-2.5-pro'} id='run--21d9e42a-6260-4f17-8a2f-fb376470958b-0' usage_metadata={'input_tokens': 2841, 'output_tokens': 75, 'total_tokens': 2976, 'input_token_details': {'cache_read': 1577}, 'output_token_details': {'reasoning': 60}}
2025-12-23 10:25:27,252 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `tests/roots/test-directive-code/dedent.rst`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need this file to determine if the `test_code_block_dedent` test case is relevant to the user's bug report concerning `literalinclude` and `dedent`.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/roots/test-directive-code/dedent.rst
Line number range: 1 - 64
Content:
1. dedent option
2. -------------
3. 
4. .. code-block::
5. 
6.    First line
7.    Second line
8.        Third line
9.    Fourth line
10. 
11. ReST has no fixed indent and only a change in indention is significant not the amount [1]_.
12. Thus, the following code inside the code block is not indent even it looks so with respect to the previous block.
13. 
14. .. code-block::
15. 
16.        First line
17.        Second line
18.            Third line
19.        Fourth line
20. 
21. Having an option "fixates" the indent to be 3 spaces, thus the code inside the code block is indented by 4 spaces.
22. 
23. .. code-block::
24.    :class: dummy
25. 
26.        First line
27.        Second line
28.            Third line
29.        Fourth line
30. 
31. The code has 6 spaces indent, minus 4 spaces dedent should yield a 2 space indented code in the output.
32. 
33. .. code-block::
34.    :dedent: 4
35. 
36.          First line
37.          Second line
38.              Third line
39.          Fourth line
40. 
41. Dedenting by zero, should not strip any spaces and be a no-op.
42. 
43. .. note::
44.    This can be used as an alternative to ``:class: dummy`` above, to fixate the ReST indention of the block.
45. 
46. .. code-block::
47.    :dedent: 0
48. 
49.        First line
50.        Second line
51.            Third line
52.        Fourth line
53. 
54. Dedent without argument should autostrip common whitespace at the beginning.
55. 
56. .. code-block::
57.    :dedent:
58. 
59.        First line
60.        Second line
61.            Third line
62.        Fourth line
63. 
64. .. [1] https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html#indentation

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 10:25:34,470 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly asks for the full content of the file `tests/roots/test-directive-code/dedent.rst`.\n\n2. Extended relevance:\n   - The entire file content is required to satisfy the user's request. The purpose is to understand a test case related to `dedent`, and this file is the root document for that test.", relative_path='tests/roots/test-directive-code/dedent.rst', start_line=1, end_line=64)]
2025-12-23 10:25:34,471 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `tests/roots/test-directive-code/dedent.rst`.
2025-12-23 10:25:34,471 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 10:25:34,471 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 10:25:34,472 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 2 existing contexts
2025-12-23 10:25:34,472 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-23 10:25:34,473 - thread-139574449776320.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-23 10:25:34,473 - thread-139574449776320.prometheus_context_collector - INFO - Successfully retrieved 3 context snippets
