2025-12-21 20:25:58,114 - thread-138947745285824.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Unit equality comparison with None raises TypeError for UnrecognizedUnit

Description: ```
In [12]: x = u.Unit('asdf', parse_strict='silent')

In [13]: x == None  # Should be False
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-13-2486f2ccf928> in <module>()
----> 1 x == None  # Should be False

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __eq__(self, other)
   1699 
   1700     def __eq__(self, other):
-> 1701         other = Unit(other, parse_strict='silent')
   1702         return isinstance(other, UnrecognizedUnit) and self.name == other.name
   1703 

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __call__(self, s, represents, format, namespace, doc, parse_strict)
   1808 
   1809         elif s is None:
-> 1810             raise TypeError("None is not a valid Unit")
   1811 
   1812         else:

TypeError: None is not a valid Unit
```

Patch information:
diff --git a/astropy/units/core.py b/astropy/units/core.py
index e9bd986d33..ee0e21225a 100644
--- a/astropy/units/core.py
+++ b/astropy/units/core.py
@@ -1710,7 +1710,13 @@ class UnrecognizedUnit(IrreducibleUnit):
         _unrecognized_operator
 
     def __eq__(self, other):
-        other = Unit(other, parse_strict='silent')
+        try:
+            other = Unit(other, parse_strict='silent')
+        except (ValueError, UnitsError, TypeError):
+            return False
+        # Other is Unit-like, but if it is not a UnitBase, give up (so that other can try).
+        if not isinstance(other, UnitBase):
+            return NotImplemented
         return isinstance(other, UnrecognizedUnit) and self.name == other.name
 
     def __ne__(self, other):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 20:25:58,252 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   ├── yacc.py
|   |   |   └── ygen.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── bls
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── methods.py
|   |   |   ├── setup_package.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_bls.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── soco.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_annotations.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_helpers.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── diff.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── dataurl
|   |   |   |   ├── dataurl_mirror
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_diff.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   ├── performance.inc.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── performance.inc.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   ├── when_to_rebase.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       ├── performance.inc.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   ├── performance.inc.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── performance.inc.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── bls.rst
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── performance.inc.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── performance.inc.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   ├── performance.inc.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── generic_transforms.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── performance.inc.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Unit equality comparison with None raises TypeError for UnrecognizedUnit

Description: ```
In [12]: x = u.Unit('asdf', parse_strict='silent')

In [13]: x == None  # Should be False
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-13-2486f2ccf928> in <module>()
----> 1 x == None  # Should be False

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __eq__(self, other)
   1699 
   1700     def __eq__(self, other):
-> 1701         other = Unit(other, parse_strict='silent')
   1702         return isinstance(other, UnrecognizedUnit) and self.name == other.name
   1703 

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __call__(self, s, represents, format, namespace, doc, parse_strict)
   1808 
   1809         elif s is None:
-> 1810             raise TypeError("None is not a valid Unit")
   1811 
   1812         else:

TypeError: None is not a valid Unit
```

Patch information:
diff --git a/astropy/units/core.py b/astropy/units/core.py
index e9bd986d33..ee0e21225a 100644
--- a/astropy/units/core.py
+++ b/astropy/units/core.py
@@ -1710,7 +1710,13 @@ class UnrecognizedUnit(IrreducibleUnit):
         _unrecognized_operator
 
     def __eq__(self, other):
-        other = Unit(other, parse_strict='silent')
+        try:
+            other = Unit(other, parse_strict='silent')
+        except (ValueError, UnitsError, TypeError):
+            return False
+        # Other is Unit-like, but if it is not a UnitBase, give up (so that other can try).
+        if not isinstance(other, UnitBase):
+            return NotImplemented
         return isinstance(other, UnrecognizedUnit) and self.name == other.name
 
     def __ne__(self, other):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 20:26:04,792 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a bug in `astropy/units/core.py`. The bug is related to equality comparison of `UnrecognizedUnit` with `None`. The tests for this functionality are most likely located in `astropy/units/tests/test_units.py`. I need the content of this file to identify and extract the relevant test cases.' query='Please provide the full content of the file `astropy/units/tests/test_units.py`.' extra_requirements='' purpose='I need to find 3 relevant test cases for the reported bug, and this file is the most likely place to find them.'
2025-12-21 20:26:04,793 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `astropy/units/tests/test_units.py`.
2025-12-21 20:26:04,793 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 20:26:04,794 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 20:26:04,794 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 20:26:04,794 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `astropy/units/tests/test_units.py`.
Purpose: I need to find 3 relevant test cases for the reported bug, and this file is the most likely place to find them.
2025-12-21 20:26:07,191 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of `astropy/units/tests/test_units.py`. You can now examine the file to find the test cases you need to address the reported bug.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/units/tests/test_units.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2141, 'candidates_token_count': 66, 'total_token_count': 2381, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2141}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 66}], 'thoughts_token_count': 174, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15439825346975616, 'model_name': 'gemini-2.5-pro'} id='run--25a14a76-5804-4017-a0d3-19632d3a68a7-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/units/tests/test_units.py'}, 'id': '648b3eab-aac1-4252-a74a-456733538358', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2141, 'output_tokens': 66, 'total_tokens': 2381, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 174}}
2025-12-21 20:26:10,668 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the content of `astropy/units/tests/test_units.py` as requested. You can now analyze the file's content to identify the relevant test cases for the bug you are addressing. The complete file content is available for your review." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9467, 'candidates_token_count': 55, 'total_token_count': 9794, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9467}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 55}], 'thoughts_token_count': 272, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.48621136058460585, 'model_name': 'gemini-2.5-pro'} id='run--b3d96ea8-7695-403e-9b17-f6c44ede2703-0' usage_metadata={'input_tokens': 9467, 'output_tokens': 55, 'total_tokens': 9794, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 272}}
2025-12-21 20:26:10,670 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `astropy/units/tests/test_units.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find 3 relevant test cases for the reported bug, and this file is the most likely place to find them.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/units/tests/test_units.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. """
4. Regression tests for the units package
5. """
6. import pickle
7. from fractions import Fraction
8. 
9. import pytest
10. import numpy as np
11. from numpy.testing import assert_allclose
12. 
13. from ...tests.helper import raises, catch_warnings
14. 
15. from ... import units as u
16. from ... import constants as c
17. from .. import utils
18. 
19. 
20. def test_getting_started():
21.     """
22.     Corresponds to "Getting Started" section in the docs.
23.     """
24.     from .. import imperial
25.     with imperial.enable():
26.         speed_unit = u.cm / u.s
27.         x = speed_unit.to(imperial.mile / u.hour, 1)
28.         assert_allclose(x, 0.02236936292054402)
29.         speed_converter = speed_unit._get_converter("mile hour^-1")
30.         x = speed_converter([1., 1000., 5000.])
31.         assert_allclose(x, [2.23693629e-02, 2.23693629e+01, 1.11846815e+02])
32. 
33. 
34. def test_initialisation():
35.     assert u.Unit(u.m) is u.m
36. 
37.     ten_meter = u.Unit(10.*u.m)
38.     assert ten_meter == u.CompositeUnit(10., [u.m], [1])
39.     assert u.Unit(ten_meter) is ten_meter
40. 
41.     assert u.Unit(10.*ten_meter) == u.CompositeUnit(100., [u.m], [1])
42. 
43.     foo = u.Unit('foo', (10. * ten_meter)**2, namespace=locals())
44.     assert foo == u.CompositeUnit(10000., [u.m], [2])
45. 
46.     assert u.Unit('m') == u.m
47.     assert u.Unit('') == u.dimensionless_unscaled
48.     assert u.one == u.dimensionless_unscaled
49.     assert u.Unit('10 m') == ten_meter
50.     assert u.Unit(10.) == u.CompositeUnit(10., [], [])
51. 
52. 
53. def test_invalid_power():
54.     x = u.m ** Fraction(1, 3)
55.     assert isinstance(x.powers[0], Fraction)
56. 
57.     x = u.m ** Fraction(1, 2)
58.     assert isinstance(x.powers[0], float)
59. 
60.     # Test the automatic conversion to a fraction
61.     x = u.m ** (1. / 3.)
62.     assert isinstance(x.powers[0], Fraction)
63. 
64. 
65. def test_invalid_compare():
66.     assert not (u.m == u.s)
67. 
68. 
69. def test_convert():
70.     assert u.h._get_converter(u.s)(1) == 3600
71. 
72. 
73. def test_convert_fail():
74.     with pytest.raises(u.UnitsError):
75.         u.cm.to(u.s, 1)
76.     with pytest.raises(u.UnitsError):
77.         (u.cm / u.s).to(u.m, 1)
78. 
79. 
80. def test_composite():
81.     assert (u.cm / u.s * u.h)._get_converter(u.m)(1) == 36
82.     assert u.cm * u.cm == u.cm ** 2
83. 
84.     assert u.cm * u.cm * u.cm == u.cm ** 3
85. 
86.     assert u.Hz.to(1000 * u.Hz, 1) == 0.001
87. 
88. 
89. def test_str():
90.     assert str(u.cm) == "cm"
91. 
92. 
93. def test_repr():
94.     assert repr(u.cm) == 'Unit("cm")'
95. 
96. 
97. def test_represents():
98.     assert u.m.represents is u.m
99.     assert u.km.represents.scale == 1000.
100.     assert u.km.represents.bases == [u.m]
101.     assert u.Ry.scale == 1.0 and u.Ry.bases == [u.Ry]
102.     assert_allclose(u.Ry.represents.scale, 13.605692518464949)
103.     assert u.Ry.represents.bases == [u.eV]
104.     bla = u.def_unit('bla', namespace=locals())
105.     assert bla.represents is bla
106.     blabla = u.def_unit('blabla', 10 * u.hr, namespace=locals())
107.     assert blabla.represents.scale == 10.
108.     assert blabla.represents.bases == [u.hr]
109.     assert blabla.decompose().scale == 10 * 3600
110.     assert blabla.decompose().bases == [u.s]
111. 
112. 
113. def test_units_conversion():
114.     assert_allclose(u.kpc.to(u.Mpc), 0.001)
115.     assert_allclose(u.Mpc.to(u.kpc), 1000)
116.     assert_allclose(u.yr.to(u.Myr), 1.e-6)
117.     assert_allclose(u.AU.to(u.pc), 4.84813681e-6)
118.     assert_allclose(u.cycle.to(u.rad), 6.283185307179586)
119. 
120. 
121. def test_units_manipulation():
122.     # Just do some manipulation and check it's happy
123.     (u.kpc * u.yr) ** Fraction(1, 3) / u.Myr
124.     (u.AA * u.erg) ** 9
125. 
126. 
127. def test_decompose():
128.     assert u.Ry == u.Ry.decompose()
129. 
130. 
131. def test_dimensionless_to_si():
132.     """
133.     Issue #1150: Test for conversion of dimensionless quantities
134.                  to the SI system
135.     """
136. 
137.     testunit = ((1.0 * u.kpc) / (1.0 * u.Mpc))
138. 
139.     assert testunit.unit.physical_type == 'dimensionless'
140.     assert_allclose(testunit.si, 0.001)
141. 
142. 
143. def test_dimensionless_to_cgs():
144.     """
145.     Issue #1150: Test for conversion of dimensionless quantities
146.                  to the CGS system
147.     """
148. 
149.     testunit = ((1.0 * u.m) / (1.0 * u.km))
150. 
151.     assert testunit.unit.physical_type == 'dimensionless'
152.     assert_allclose(testunit.cgs, 0.001)
153. 
154. 
155. def test_unknown_unit():
156.     with catch_warnings(u.UnitsWarning) as warning_lines:
157.         u.Unit("FOO", parse_strict='warn')
158. 
159.     assert 'FOO' in str(warning_lines[0].message)
160. 
161. 
162. def test_multiple_solidus():
163.     assert u.Unit("m/s/kg").to_string() == u.m / u.s / u.kg
164. 
165.     with catch_warnings(u.UnitsWarning) as warning_lines:
166.         assert u.Unit("m/s/kg").to_string() == u.m / (u.s * u.kg)
167. 
168.     assert 'm/s/kg' in str(warning_lines[0].message)
169.     assert 'discouraged' in str(warning_lines[0].message)
170. 
171.     with pytest.raises(ValueError):
172.         u.Unit("m/s/kg", format="vounit")
173. 
174. 
175. def test_unknown_unit3():
176.     unit = u.Unit("FOO", parse_strict='silent')
177.     assert isinstance(unit, u.UnrecognizedUnit)
178.     assert unit.name == "FOO"
179. 
180.     unit2 = u.Unit("FOO", parse_strict='silent')
181.     assert unit == unit2
182.     assert unit.is_equivalent(unit2)
183. 
184.     unit3 = u.Unit("BAR", parse_strict='silent')
185.     assert unit != unit3
186.     assert not unit.is_equivalent(unit3)
187. 
188.     with pytest.raises(ValueError):
189.         unit._get_converter(unit3)
190. 
191.     x = unit.to_string('latex')
192.     y = unit2.to_string('cgs')
193. 
194.     with pytest.raises(ValueError):
195.         unit4 = u.Unit("BAR", parse_strict='strict')
196. 
197.     with pytest.raises(TypeError):
198.         unit5 = u.Unit(None)
199. 
200. 
201. @raises(TypeError)
202. def test_invalid_scale():
203.     x = ['a', 'b', 'c'] * u.m
204. 
205. 
206. def test_cds_power():
207.     unit = u.Unit("10+22/cm2", format="cds", parse_strict='silent')
208.     assert unit.scale == 1e22
209. 
210. 
211. def test_register():
212.     foo = u.def_unit("foo", u.m ** 3, namespace=locals())
213.     assert 'foo' in locals()
214.     with u.add_enabled_units(foo):
215.         assert 'foo' in u.get_current_unit_registry().registry
216.     assert 'foo' not in u.get_current_unit_registry().registry
217. 
218. 
219. def test_in_units():
220.     speed_unit = u.cm / u.s
221.     x = speed_unit.in_units(u.pc / u.hour, 1)
222. 
223. 
224. def test_null_unit():
225.     assert (u.m / u.m) == u.Unit(1)
226. 
227. 
228. def test_unrecognized_equivalency():
229.     assert u.m.is_equivalent('foo') is False
230.     assert u.m.is_equivalent('pc') is True
231. 
232. 
233. @raises(TypeError)
234. def test_unit_noarg():
235.     u.Unit()
236. 
237. 
238. def test_convertible_exception():
239.     try:
240.         u.AA.to(u.h * u.s ** 2)
241.     except u.UnitsError as e:
242.         assert "length" in str(e)
243. 
244. 
245. def test_convertible_exception2():
246.     try:
247.         u.m.to(u.s)
248.     except u.UnitsError as e:
249.         assert "length" in str(e)
250. 
251. 
252. @raises(TypeError)
253. def test_invalid_type():
254.     class A:
255.         pass
256. 
257.     u.Unit(A())
258. 
259. 
260. def test_steradian():
261.     """
262.     Issue #599
263.     """
264.     assert u.sr.is_equivalent(u.rad * u.rad)
265. 
266.     results = u.sr.compose(units=u.cgs.bases)
267.     assert results[0].bases[0] is u.rad
268. 
269.     results = u.sr.compose(units=u.cgs.__dict__)
270.     assert results[0].bases[0] is u.sr
271. 
272. 
273. def test_decompose_bases():
274.     """
275.     From issue #576
276.     """
277. 
278.     from .. import cgs
279.     from ...constants import e
280. 
281.     d = e.esu.unit.decompose(bases=cgs.bases)
282.     assert d._bases == [u.cm, u.g, u.s]
283.     assert d._powers == [Fraction(3, 2), 0.5, -1]
284.     assert d._scale == 1.0
285. 
286. 
287. def test_complex_compose():
288.     complex = u.cd * u.sr * u.Wb
289.     composed = complex.compose()
290. 
291.     assert set(composed[0]._bases) == set([u.lm, u.Wb])
292. 
293. 
294. def test_equiv_compose():
295.     composed = u.m.compose(equivalencies=u.spectral())
296.     assert any([u.Hz] == x.bases for x in composed)
297. 
298. 
299. def test_empty_compose():
300.     with pytest.raises(u.UnitsError):
301.         composed = u.m.compose(units=[])
302. 
303. 
304. def _unit_as_str(unit):
305.     # This function serves two purposes - it is used to sort the units to
306.     # test alphabetically, and it is also use to allow pytest to show the unit
307.     # in the [] when running the parametrized tests.
308.     return str(unit)
309. 
310. 
311. # We use a set to make sure we don't have any duplicates.
312. COMPOSE_ROUNDTRIP = set()
313. for val in u.__dict__.values():
314.     if (isinstance(val, u.UnitBase) and
315.             not isinstance(val, u.PrefixUnit)):
316.         COMPOSE_ROUNDTRIP.add(val)
317. 
318. 
319. @pytest.mark.parametrize('unit', sorted(COMPOSE_ROUNDTRIP, key=_unit_as_str), ids=_unit_as_str)
320. def test_compose_roundtrip(unit):
321.     composed_list = unit.decompose().compose()
322.     found = False
323.     for composed in composed_list:
324.         if len(composed.bases):
325.             if composed.bases[0] is unit:
326.                 found = True
327.                 break
328.         elif len(unit.bases) == 0:
329.             found = True
330.             break
331.     assert found
332. 
333. 
334. # We use a set to make sure we don't have any duplicates.
335. COMPOSE_CGS_TO_SI = set()
336. for val in u.cgs.__dict__.values():
337.     # Can't decompose Celsius
338.     if (isinstance(val, u.UnitBase) and
339.             not isinstance(val, u.PrefixUnit) and
340.             val != u.cgs.deg_C):
341.         COMPOSE_CGS_TO_SI.add(val)
342. 
343. 
344. @pytest.mark.parametrize('unit', sorted(COMPOSE_CGS_TO_SI, key=_unit_as_str),
345.                          ids=_unit_as_str)
346. def test_compose_cgs_to_si(unit):
347.     si = unit.to_system(u.si)
348.     assert [x.is_equivalent(unit) for x in si]
349.     assert si[0] == unit.si
350. 
351. 
352. # We use a set to make sure we don't have any duplicates.
353. COMPOSE_SI_TO_CGS = set()
354. for val in u.si.__dict__.values():
355.     # Can't decompose Celsius
356.     if (isinstance(val, u.UnitBase) and
357.             not isinstance(val, u.PrefixUnit) and
358.             val != u.si.deg_C):
359.         COMPOSE_SI_TO_CGS.add(val)
360. 
361. 
362. @pytest.mark.parametrize('unit', sorted(COMPOSE_SI_TO_CGS, key=_unit_as_str), ids=_unit_as_str)
363. def test_compose_si_to_cgs(unit):
364. 
365.     # Can't convert things with Ampere to CGS without more context
366.     try:
367.         cgs = unit.to_system(u.cgs)
368.     except u.UnitsError:
369.         if u.A in unit.decompose().bases:
370.             pass
371.         else:
372.             raise
373.     else:
374.         assert [x.is_equivalent(unit) for x in cgs]
375.         assert cgs[0] == unit.cgs
376. 
377. 
378. def test_to_cgs():
379.     assert u.Pa.to_system(u.cgs)[1]._bases[0] is u.Ba
380.     assert u.Pa.to_system(u.cgs)[1]._scale == 10.0
381. 
382. 
383. def test_decompose_to_cgs():
384.     from .. import cgs
385.     assert u.m.decompose(bases=cgs.bases)._bases[0] is cgs.cm
386. 
387. 
388. def test_compose_issue_579():
389.     unit = u.kg * u.s ** 2 / u.m
390. 
391.     result = unit.compose(units=[u.N, u.s, u.m])
392. 
393.     assert len(result) == 1
394.     assert result[0]._bases == [u.s, u.N, u.m]
395.     assert result[0]._powers == [4, 1, -2]
396. 
397. 
398. def test_compose_prefix_unit():
399.     x =  u.m.compose(units=(u.m,))
400.     assert x[0].bases[0] is u.m
401.     assert x[0].scale == 1.0
402.     x = u.m.compose(units=[u.km], include_prefix_units=True)
403.     assert x[0].bases[0] is u.km
404.     assert x[0].scale == 0.001
405.     x = u.m.compose(units=[u.km])
406.     assert x[0].bases[0] is u.km
407.     assert x[0].scale == 0.001
408. 
409.     x = (u.km/u.s).compose(units=(u.pc, u.Myr))
410.     assert x[0].bases == [u.pc, u.Myr]
411.     assert_allclose(x[0].scale, 1.0227121650537077)
412. 
413.     with raises(u.UnitsError):
414.         (u.km/u.s).compose(units=(u.pc, u.Myr), include_prefix_units=False)
415. 
416. 
417. def test_self_compose():
418.     unit = u.kg * u.s
419. 
420.     assert len(unit.compose(units=[u.g, u.s])) == 1
421. 
422. 
423. @raises(u.UnitsError)
424. def test_compose_failed():
425.     unit = u.kg
426. 
427.     result = unit.compose(units=[u.N])
428. 
429. 
430. def test_compose_fractional_powers():
431.     # Warning: with a complicated unit, this test becomes very slow;
432.     # e.g., x = (u.kg / u.s ** 3 * u.au ** 2.5 / u.yr ** 0.5 / u.sr ** 2)
433.     # takes 3 s
434.     x = u.m ** 0.5 / u.yr ** 1.5
435. 
436.     factored = x.compose()
437. 
438.     for unit in factored:
439.         assert x.decompose() == unit.decompose()
440. 
441.     factored = x.compose(units=u.cgs)
442. 
443.     for unit in factored:
444.         assert x.decompose() == unit.decompose()
445. 
446.     factored = x.compose(units=u.si)
447. 
448.     for unit in factored:
449.         assert x.decompose() == unit.decompose()
450. 
451. 
452. def test_compose_best_unit_first():
453.     results = u.l.compose()
454.     assert len(results[0].bases) == 1
455.     assert results[0].bases[0] is u.l
456. 
457.     results = (u.s ** -1).compose()
458.     assert results[0].bases[0] in (u.Hz, u.Bq)
459. 
460.     results = (u.Ry.decompose()).compose()
461.     assert results[0].bases[0] is u.Ry
462. 
463. 
464. def test_compose_no_duplicates():
465.     new = u.kg / u.s ** 3 * u.au ** 2.5 / u.yr ** 0.5 / u.sr ** 2
466.     composed = new.compose(units=u.cgs.bases)
467.     assert len(composed) == 1
468. 
469. 
470. def test_long_int():
471.     """
472.     Issue #672
473.     """
474.     sigma = 10 ** 21 * u.M_p / u.cm ** 2
475.     sigma.to(u.M_sun / u.pc ** 2)
476. 
477. 
478. def test_endian_independence():
479.     """
480.     Regression test for #744
481. 
482.     A logic issue in the units code meant that big endian arrays could not be
483.     converted because the dtype is '>f4', not 'float32', and the code was
484.     looking for the strings 'float' or 'int'.
485.     """
486.     for endian in ['<', '>']:
487.         for ntype in ['i', 'f']:
488.             for byte in ['4', '8']:
489.                 x = np.array([1, 2, 3], dtype=(endian + ntype + byte))
490.                 u.m.to(u.cm, x)
491. 
492. 
493. def test_radian_base():
494.     """
495.     Issue #863
496.     """
497.     assert (1 * u.degree).si.unit == u.rad
498. 
499. 
500. def test_no_as():

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 20:26:14,395 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly asks for the 'full content of the file `astropy/units/tests/test_units.py`'.\n\n2. Extended relevance:\n   - The provided context contains the entire content of the requested file. Therefore, the whole file is relevant to fulfill the user's request.", relative_path='astropy/units/tests/test_units.py', start_line=1, end_line=500)]
2025-12-21 20:26:14,397 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `astropy/units/tests/test_units.py`.
2025-12-21 20:26:14,397 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 20:26:14,397 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 20:26:14,397 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 20:26:14,397 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 20:26:14,398 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   ├── yacc.py
|   |   |   └── ygen.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── bls
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── methods.py
|   |   |   ├── setup_package.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_bls.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── soco.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_annotations.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_helpers.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── diff.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── dataurl
|   |   |   |   ├── dataurl_mirror
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_diff.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   ├── performance.inc.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── performance.inc.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   ├── when_to_rebase.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       ├── performance.inc.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   ├── performance.inc.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── performance.inc.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── bls.rst
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── performance.inc.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── performance.inc.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   ├── performance.inc.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── generic_transforms.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── performance.inc.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Unit equality comparison with None raises TypeError for UnrecognizedUnit

Description: ```
In [12]: x = u.Unit('asdf', parse_strict='silent')

In [13]: x == None  # Should be False
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-13-2486f2ccf928> in <module>()
----> 1 x == None  # Should be False

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __eq__(self, other)
   1699 
   1700     def __eq__(self, other):
-> 1701         other = Unit(other, parse_strict='silent')
   1702         return isinstance(other, UnrecognizedUnit) and self.name == other.name
   1703 

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __call__(self, s, represents, format, namespace, doc, parse_strict)
   1808 
   1809         elif s is None:
-> 1810             raise TypeError("None is not a valid Unit")
   1811 
   1812         else:

TypeError: None is not a valid Unit
```

Patch information:
diff --git a/astropy/units/core.py b/astropy/units/core.py
index e9bd986d33..ee0e21225a 100644
--- a/astropy/units/core.py
+++ b/astropy/units/core.py
@@ -1710,7 +1710,13 @@ class UnrecognizedUnit(IrreducibleUnit):
         _unrecognized_operator
 
     def __eq__(self, other):
-        other = Unit(other, parse_strict='silent')
+        try:
+            other = Unit(other, parse_strict='silent')
+        except (ValueError, UnitsError, TypeError):
+            return False
+        # Other is Unit-like, but if it is not a UnitBase, give up (so that other can try).
+        if not isinstance(other, UnitBase):
+            return NotImplemented
         return isinstance(other, UnrecognizedUnit) and self.name == other.name
 
     def __ne__(self, other):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/units/tests/test_units.py`.
Extra Requirements: 
Purpose: I need to find 3 relevant test cases for the reported bug, and this file is the most likely place to find them.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/units/tests/test_units.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. """
4. Regression tests for the units package
5. """
6. import pickle
7. from fractions import Fraction
8. 
9. import pytest
10. import numpy as np
11. from numpy.testing import assert_allclose
12. 
13. from ...tests.helper import raises, catch_warnings
14. 
15. from ... import units as u
16. from ... import constants as c
17. from .. import utils
18. 
19. 
20. def test_getting_started():
21.     """
22.     Corresponds to "Getting Started" section in the docs.
23.     """
24.     from .. import imperial
25.     with imperial.enable():
26.         speed_unit = u.cm / u.s
27.         x = speed_unit.to(imperial.mile / u.hour, 1)
28.         assert_allclose(x, 0.02236936292054402)
29.         speed_converter = speed_unit._get_converter("mile hour^-1")
30.         x = speed_converter([1., 1000., 5000.])
31.         assert_allclose(x, [2.23693629e-02, 2.23693629e+01, 1.11846815e+02])
32. 
33. 
34. def test_initialisation():
35.     assert u.Unit(u.m) is u.m
36. 
37.     ten_meter = u.Unit(10.*u.m)
38.     assert ten_meter == u.CompositeUnit(10., [u.m], [1])
39.     assert u.Unit(ten_meter) is ten_meter
40. 
41.     assert u.Unit(10.*ten_meter) == u.CompositeUnit(100., [u.m], [1])
42. 
43.     foo = u.Unit('foo', (10. * ten_meter)**2, namespace=locals())
44.     assert foo == u.CompositeUnit(10000., [u.m], [2])
45. 
46.     assert u.Unit('m') == u.m
47.     assert u.Unit('') == u.dimensionless_unscaled
48.     assert u.one == u.dimensionless_unscaled
49.     assert u.Unit('10 m') == ten_meter
50.     assert u.Unit(10.) == u.CompositeUnit(10., [], [])
51. 
52. 
53. def test_invalid_power():
54.     x = u.m ** Fraction(1, 3)
55.     assert isinstance(x.powers[0], Fraction)
56. 
57.     x = u.m ** Fraction(1, 2)
58.     assert isinstance(x.powers[0], float)
59. 
60.     # Test the automatic conversion to a fraction
61.     x = u.m ** (1. / 3.)
62.     assert isinstance(x.powers[0], Fraction)
63. 
64. 
65. def test_invalid_compare():
66.     assert not (u.m == u.s)
67. 
68. 
69. def test_convert():
70.     assert u.h._get_converter(u.s)(1) == 3600
71. 
72. 
73. def test_convert_fail():
74.     with pytest.raises(u.UnitsError):
75.         u.cm.to(u.s, 1)
76.     with pytest.raises(u.UnitsError):
77.         (u.cm / u.s).to(u.m, 1)
78. 
79. 
80. def test_composite():
81.     assert (u.cm / u.s * u.h)._get_converter(u.m)(1) == 36
82.     assert u.cm * u.cm == u.cm ** 2
83. 
84.     assert u.cm * u.cm * u.cm == u.cm ** 3
85. 
86.     assert u.Hz.to(1000 * u.Hz, 1) == 0.001
87. 
88. 
89. def test_str():
90.     assert str(u.cm) == "cm"
91. 
92. 
93. def test_repr():
94.     assert repr(u.cm) == 'Unit("cm")'
95. 
96. 
97. def test_represents():
98.     assert u.m.represents is u.m
99.     assert u.km.represents.scale == 1000.
100.     assert u.km.represents.bases == [u.m]
101.     assert u.Ry.scale == 1.0 and u.Ry.bases == [u.Ry]
102.     assert_allclose(u.Ry.represents.scale, 13.605692518464949)
103.     assert u.Ry.represents.bases == [u.eV]
104.     bla = u.def_unit('bla', namespace=locals())
105.     assert bla.represents is bla
106.     blabla = u.def_unit('blabla', 10 * u.hr, namespace=locals())
107.     assert blabla.represents.scale == 10.
108.     assert blabla.represents.bases == [u.hr]
109.     assert blabla.decompose().scale == 10 * 3600
110.     assert blabla.decompose().bases == [u.s]
111. 
112. 
113. def test_units_conversion():
114.     assert_allclose(u.kpc.to(u.Mpc), 0.001)
115.     assert_allclose(u.Mpc.to(u.kpc), 1000)
116.     assert_allclose(u.yr.to(u.Myr), 1.e-6)
117.     assert_allclose(u.AU.to(u.pc), 4.84813681e-6)
118.     assert_allclose(u.cycle.to(u.rad), 6.283185307179586)
119. 
120. 
121. def test_units_manipulation():
122.     # Just do some manipulation and check it's happy
123.     (u.kpc * u.yr) ** Fraction(1, 3) / u.Myr
124.     (u.AA * u.erg) ** 9
125. 
126. 
127. def test_decompose():
128.     assert u.Ry == u.Ry.decompose()
129. 
130. 
131. def test_dimensionless_to_si():
132.     """
133.     Issue #1150: Test for conversion of dimensionless quantities
134.                  to the SI system
135.     """
136. 
137.     testunit = ((1.0 * u.kpc) / (1.0 * u.Mpc))
138. 
139.     assert testunit.unit.physical_type == 'dimensionless'
140.     assert_allclose(testunit.si, 0.001)
141. 
142. 
143. def test_dimensionless_to_cgs():
144.     """
145.     Issue #1150: Test for conversion of dimensionless quantities
146.                  to the CGS system
147.     """
148. 
149.     testunit = ((1.0 * u.m) / (1.0 * u.km))
150. 
151.     assert testunit.unit.physical_type == 'dimensionless'
152.     assert_allclose(testunit.cgs, 0.001)
153. 
154. 
155. def test_unknown_unit():
156.     with catch_warnings(u.UnitsWarning) as warning_lines:
157.         u.Unit("FOO", parse_strict='warn')
158. 
159.     assert 'FOO' in str(warning_lines[0].message)
160. 
161. 
162. def test_multiple_solidus():
163.     assert u.Unit("m/s/kg").to_string() == u.m / u.s / u.kg
164. 
165.     with catch_warnings(u.UnitsWarning) as warning_lines:
166.         assert u.Unit("m/s/kg").to_string() == u.m / (u.s * u.kg)
167. 
168.     assert 'm/s/kg' in str(warning_lines[0].message)
169.     assert 'discouraged' in str(warning_lines[0].message)
170. 
171.     with pytest.raises(ValueError):
172.         u.Unit("m/s/kg", format="vounit")
173. 
174. 
175. def test_unknown_unit3():
176.     unit = u.Unit("FOO", parse_strict='silent')
177.     assert isinstance(unit, u.UnrecognizedUnit)
178.     assert unit.name == "FOO"
179. 
180.     unit2 = u.Unit("FOO", parse_strict='silent')
181.     assert unit == unit2
182.     assert unit.is_equivalent(unit2)
183. 
184.     unit3 = u.Unit("BAR", parse_strict='silent')
185.     assert unit != unit3
186.     assert not unit.is_equivalent(unit3)
187. 
188.     with pytest.raises(ValueError):
189.         unit._get_converter(unit3)
190. 
191.     x = unit.to_string('latex')
192.     y = unit2.to_string('cgs')
193. 
194.     with pytest.raises(ValueError):
195.         unit4 = u.Unit("BAR", parse_strict='strict')
196. 
197.     with pytest.raises(TypeError):
198.         unit5 = u.Unit(None)
199. 
200. 
201. @raises(TypeError)
202. def test_invalid_scale():
203.     x = ['a', 'b', 'c'] * u.m
204. 
205. 
206. def test_cds_power():
207.     unit = u.Unit("10+22/cm2", format="cds", parse_strict='silent')
208.     assert unit.scale == 1e22
209. 
210. 
211. def test_register():
212.     foo = u.def_unit("foo", u.m ** 3, namespace=locals())
213.     assert 'foo' in locals()
214.     with u.add_enabled_units(foo):
215.         assert 'foo' in u.get_current_unit_registry().registry
216.     assert 'foo' not in u.get_current_unit_registry().registry
217. 
218. 
219. def test_in_units():
220.     speed_unit = u.cm / u.s
221.     x = speed_unit.in_units(u.pc / u.hour, 1)
222. 
223. 
224. def test_null_unit():
225.     assert (u.m / u.m) == u.Unit(1)
226. 
227. 
228. def test_unrecognized_equivalency():
229.     assert u.m.is_equivalent('foo') is False
230.     assert u.m.is_equivalent('pc') is True
231. 
232. 
233. @raises(TypeError)
234. def test_unit_noarg():
235.     u.Unit()
236. 
237. 
238. def test_convertible_exception():
239.     try:
240.         u.AA.to(u.h * u.s ** 2)
241.     except u.UnitsError as e:
242.         assert "length" in str(e)
243. 
244. 
245. def test_convertible_exception2():
246.     try:
247.         u.m.to(u.s)
248.     except u.UnitsError as e:
249.         assert "length" in str(e)
250. 
251. 
252. @raises(TypeError)
253. def test_invalid_type():
254.     class A:
255.         pass
256. 
257.     u.Unit(A())
258. 
259. 
260. def test_steradian():
261.     """
262.     Issue #599
263.     """
264.     assert u.sr.is_equivalent(u.rad * u.rad)
265. 
266.     results = u.sr.compose(units=u.cgs.bases)
267.     assert results[0].bases[0] is u.rad
268. 
269.     results = u.sr.compose(units=u.cgs.__dict__)
270.     assert results[0].bases[0] is u.sr
271. 
272. 
273. def test_decompose_bases():
274.     """
275.     From issue #576
276.     """
277. 
278.     from .. import cgs
279.     from ...constants import e
280. 
281.     d = e.esu.unit.decompose(bases=cgs.bases)
282.     assert d._bases == [u.cm, u.g, u.s]
283.     assert d._powers == [Fraction(3, 2), 0.5, -1]
284.     assert d._scale == 1.0
285. 
286. 
287. def test_complex_compose():
288.     complex = u.cd * u.sr * u.Wb
289.     composed = complex.compose()
290. 
291.     assert set(composed[0]._bases) == set([u.lm, u.Wb])
292. 
293. 
294. def test_equiv_compose():
295.     composed = u.m.compose(equivalencies=u.spectral())
296.     assert any([u.Hz] == x.bases for x in composed)
297. 
298. 
299. def test_empty_compose():
300.     with pytest.raises(u.UnitsError):
301.         composed = u.m.compose(units=[])
302. 
303. 
304. def _unit_as_str(unit):
305.     # This function serves two purposes - it is used to sort the units to
306.     # test alphabetically, and it is also use to allow pytest to show the unit
307.     # in the [] when running the parametrized tests.
308.     return str(unit)
309. 
310. 
311. # We use a set to make sure we don't have any duplicates.
312. COMPOSE_ROUNDTRIP = set()
313. for val in u.__dict__.values():
314.     if (isinstance(val, u.UnitBase) and
315.             not isinstance(val, u.PrefixUnit)):
316.         COMPOSE_ROUNDTRIP.add(val)
317. 
318. 
319. @pytest.mark.parametrize('unit', sorted(COMPOSE_ROUNDTRIP, key=_unit_as_str), ids=_unit_as_str)
320. def test_compose_roundtrip(unit):
321.     composed_list = unit.decompose().compose()
322.     found = False
323.     for composed in composed_list:
324.         if len(composed.bases):
325.             if composed.bases[0] is unit:
326.                 found = True
327.                 break
328.         elif len(unit.bases) == 0:
329.             found = True
330.             break
331.     assert found
332. 
333. 
334. # We use a set to make sure we don't have any duplicates.
335. COMPOSE_CGS_TO_SI = set()
336. for val in u.cgs.__dict__.values():
337.     # Can't decompose Celsius
338.     if (isinstance(val, u.UnitBase) and
339.             not isinstance(val, u.PrefixUnit) and
340.             val != u.cgs.deg_C):
341.         COMPOSE_CGS_TO_SI.add(val)
342. 
343. 
344. @pytest.mark.parametrize('unit', sorted(COMPOSE_CGS_TO_SI, key=_unit_as_str),
345.                          ids=_unit_as_str)
346. def test_compose_cgs_to_si(unit):
347.     si = unit.to_system(u.si)
348.     assert [x.is_equivalent(unit) for x in si]
349.     assert si[0] == unit.si
350. 
351. 
352. # We use a set to make sure we don't have any duplicates.
353. COMPOSE_SI_TO_CGS = set()
354. for val in u.si.__dict__.values():
355.     # Can't decompose Celsius
356.     if (isinstance(val, u.UnitBase) and
357.             not isinstance(val, u.PrefixUnit) and
358.             val != u.si.deg_C):
359.         COMPOSE_SI_TO_CGS.add(val)
360. 
361. 
362. @pytest.mark.parametrize('unit', sorted(COMPOSE_SI_TO_CGS, key=_unit_as_str), ids=_unit_as_str)
363. def test_compose_si_to_cgs(unit):
364. 
365.     # Can't convert things with Ampere to CGS without more context
366.     try:
367.         cgs = unit.to_system(u.cgs)
368.     except u.UnitsError:
369.         if u.A in unit.decompose().bases:
370.             pass
371.         else:
372.             raise
373.     else:
374.         assert [x.is_equivalent(unit) for x in cgs]
375.         assert cgs[0] == unit.cgs
376. 
377. 
378. def test_to_cgs():
379.     assert u.Pa.to_system(u.cgs)[1]._bases[0] is u.Ba
380.     assert u.Pa.to_system(u.cgs)[1]._scale == 10.0
381. 
382. 
383. def test_decompose_to_cgs():
384.     from .. import cgs
385.     assert u.m.decompose(bases=cgs.bases)._bases[0] is cgs.cm
386. 
387. 
388. def test_compose_issue_579():
389.     unit = u.kg * u.s ** 2 / u.m
390. 
391.     result = unit.compose(units=[u.N, u.s, u.m])
392. 
393.     assert len(result) == 1
394.     assert result[0]._bases == [u.s, u.N, u.m]
395.     assert result[0]._powers == [4, 1, -2]
396. 
397. 
398. def test_compose_prefix_unit():
399.     x =  u.m.compose(units=(u.m,))
400.     assert x[0].bases[0] is u.m
401.     assert x[0].scale == 1.0
402.     x = u.m.compose(units=[u.km], include_prefix_units=True)
403.     assert x[0].bases[0] is u.km
404.     assert x[0].scale == 0.001
405.     x = u.m.compose(units=[u.km])
406.     assert x[0].bases[0] is u.km
407.     assert x[0].scale == 0.001
408. 
409.     x = (u.km/u.s).compose(units=(u.pc, u.Myr))
410.     assert x[0].bases == [u.pc, u.Myr]
411.     assert_allclose(x[0].scale, 1.0227121650537077)
412. 
413.     with raises(u.UnitsError):
414.         (u.km/u.s).compose(units=(u.pc, u.Myr), include_prefix_units=False)
415. 
416. 
417. def test_self_compose():
418.     unit = u.kg * u.s
419. 
420.     assert len(unit.compose(units=[u.g, u.s])) == 1
421. 
422. 
423. @raises(u.UnitsError)
424. def test_compose_failed():
425.     unit = u.kg
426. 
427.     result = unit.compose(units=[u.N])
428. 
429. 
430. def test_compose_fractional_powers():
431.     # Warning: with a complicated unit, this test becomes very slow;
432.     # e.g., x = (u.kg / u.s ** 3 * u.au ** 2.5 / u.yr ** 0.5 / u.sr ** 2)
433.     # takes 3 s
434.     x = u.m ** 0.5 / u.yr ** 1.5
435. 
436.     factored = x.compose()
437. 
438.     for unit in factored:
439.         assert x.decompose() == unit.decompose()
440. 
441.     factored = x.compose(units=u.cgs)
442. 
443.     for unit in factored:
444.         assert x.decompose() == unit.decompose()
445. 
446.     factored = x.compose(units=u.si)
447. 
448.     for unit in factored:
449.         assert x.decompose() == unit.decompose()
450. 
451. 
452. def test_compose_best_unit_first():
453.     results = u.l.compose()
454.     assert len(results[0].bases) == 1
455.     assert results[0].bases[0] is u.l
456. 
457.     results = (u.s ** -1).compose()
458.     assert results[0].bases[0] in (u.Hz, u.Bq)
459. 
460.     results = (u.Ry.decompose()).compose()
461.     assert results[0].bases[0] is u.Ry
462. 
463. 
464. def test_compose_no_duplicates():
465.     new = u.kg / u.s ** 3 * u.au ** 2.5 / u.yr ** 0.5 / u.sr ** 2
466.     composed = new.compose(units=u.cgs.bases)
467.     assert len(composed) == 1
468. 
469. 
470. def test_long_int():
471.     """
472.     Issue #672
473.     """
474.     sigma = 10 ** 21 * u.M_p / u.cm ** 2
475.     sigma.to(u.M_sun / u.pc ** 2)
476. 
477. 
478. def test_endian_independence():
479.     """
480.     Regression test for #744
481. 
482.     A logic issue in the units code meant that big endian arrays could not be
483.     converted because the dtype is '>f4', not 'float32', and the code was
484.     looking for the strings 'float' or 'int'.
485.     """
486.     for endian in ['<', '>']:
487.         for ntype in ['i', 'f']:
488.             for byte in ['4', '8']:
489.                 x = np.array([1, 2, 3], dtype=(endian + ntype + byte))
490.                 u.m.to(u.cm, x)
491. 
492. 
493. def test_radian_base():
494.     """
495.     Issue #863
496.     """
497.     assert (1 * u.degree).si.unit == u.rad
498. 
499. 
500. def test_no_as():

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 20:27:12,069 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find three relevant test cases for a bug in `UnrecognizedUnit` equality comparison. The provided context, which is the first 500 lines of `astropy/units/tests/test_units.py`, contains two functions that are relevant (`test_unknown_unit3` and `test_invalid_type`) because they test `TypeError` and `ValueError` exceptions raised by `u.Unit()`, which the patch handles. However, to find a third distinct and relevant test case and to ensure no better examples exist, I need to examine the rest of the file, particularly for tests involving equality comparisons of units with `None` or other non-unit objects.' query='Please provide the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file.' extra_requirements='If the rest of the file is too large, please prioritize sending any tests that involve equality comparisons (`==` or `!=`) with `None` or other non-unit objects.' purpose='I need to find three relevant test cases for the reported bug, and the current partial file content is insufficient to select the best three examples.'
2025-12-21 20:27:12,070 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file.
2025-12-21 20:27:12,070 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 20:27:12,070 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 20:27:12,071 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 20:27:12,071 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file.
Extra requirements: If the rest of the file is too large, please prioritize sending any tests that involve equality comparisons (`==` or `!=`) with `None` or other non-unit objects.
Purpose: I need to find three relevant test cases for the reported bug, and the current partial file content is insufficient to select the best three examples.
2025-12-21 20:27:19,513 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/units/tests/test_units.py", "start_line": 501.0, "end_line": 1000.0}'}, '__gemini_function_call_thought_signatures__': {'b05810c2-5ca9-4224-88e9-85e02e1e43f7': 'CvgTAY89a1//nE4yj4ybCQ2Hu3pk1HMer+b6AT9hrgOFrOKrbjS/EIDEjROgVJVsjz9Yn89m0pzyM+QKs9BEY+i+98Gk/7KsFcnT8q+78ufkiSRWhGsrSdtYm/yautI8AHV0J5vr0BzFxrB97yYhedtw9WBelI5LPKLK4IIc/zJCnKMYGHojqCTaX1ic5oIXlOw9zZU5GJM9ibntM+wFYNaJmOSQAXwWPGQx7EThIilsZweDIEMXDUDfg7qLdkuSZkQMEO7g/U4V/o2YMIn8lT/8bd+Usg3wMH+o1a2lwvRnXtKtzCBGA7t6UGa8wQCR9ISYoSCPFj9XySLoRhBz4UQcL1BQaWLED9Ec5oVyW//oJTt4RoiTAZZ57TCw01lFPfpZcrEbtJBt9HRHTv8oUQiSkI50+eF4uDgaLOOUAcE097qLI0i7OPt4agRtnSN6O0xxTeF3NikPhfScOpmC1XM0BsJ2GwOlrkLvMwr9al4TWQRDJVK3Cjs3ZE/dyylYRf4n1fWCUeE7/a29akZ8yXBzKS7NJQaH7ml6InGaKml4G4gs9U5DKKZZJJ+vr1lXmaBvy6G9HhwJksxW8+9RQH1opd4nVGsoKkCaLDrFtGuIJI0QtC8Rnm4w3VjEssn8JoU3+1M9plCysxEWBobTMaAIUOXXLsPC01Wksd7RF+n19MRWNmQWcs6pekdyEneW4Ub+881LUJuMq/JSTitkfiR1U2Z8Tg+IGzU6pSCK6L39/wQYk9G7VLomM49sj0jHkgBNF+Q8SUPdLhquLDq7CjSqZZ3movtxUuwGRxR+8dzGuauGEKXHQ17K/d8wXeWt2I5UkQM0L52OaeLcsOYvJcyYqSoX0j5dLhEdVPW/74ADs6riDXjPyPTUIWO8K3znRz4SR3urXVHkgjeof0arO22V8+PrF8JgV/AbPgDD6Tr4wKcs0M+afLg+1yS7lu85QO35ojjH5qBb9Su1Inz38NHkdJUYDNzflsQHOUwSSVd2fS63vPXKc3iGfYH1LZTBdCtqzdBD/VqIQYjr/KSFVln2qQObmkOaCiNzVEHSYrQvh550au0/oBtm7gWMcJDAXK4EvsSDosuhB+k1ZGXP1Eii49Vhu9oOdE2CEF25AQxZWuMUPlEvg3tV+0rnWaLndvPhVtyYCxKRKTBaLXwVAsvDY7pnNxwu0fyzf4Il29916KBq+ZaHIeV1NX+yyEGsMrzng6t8+jgylpznYJUJN5hjQ/sF2bQUndRqUAVUVZnI6mMGipC7dek84LhX7lKpXufaKKYOkurDdEtWIj7almfuQcKjKL2K9Fh41M/CbOit3W9NN/owoaElP2lL+jxQoVla8lf4B3PnfNZ3PVuAVYVka5/K1zrturZ0SEljnCKbgKC+UIoOo/MqY0feiWataeGmYKzRNCjKaFpABvz1cM3CTAy6qHnqzYExOzxQAc139jEo6SyGyuv7cVKnDDv9vgX9JOgkez5TsPEnTmlc1Q3nVN5azlH7OuQNBMR5FgH4n1bSPcluFHwLrzdSY/bhK1pbmRoZ/A7Jce2ooMSDBze7b/vUtSqWy5oLlnpyga3GjA+hEJuYF7e2ZFL3Squy+FoIAnae5ls06x6ShihT+DH6fyc9oUsYphysz71EG+svM53TTWoqTHARqDhJ5g27pxz5+FGujb6msEpgkT4I1wzHpyMpHdclqxDWEYweRymzsP/1jDkiDk5u5pVa/R0Le4uyKUtr9NpEaoQf74Kzl35rlbQGypaFkXSM3S4iZMsK12VQA2lPEQas8nAdPeJE/00IOL+JFUuPfr2M3DnLwfzg7duH4N65Y6/xPrjGRbWagxukOp/5V8iNHCmTJfL+0t3NlqoW68JVYW+P0eWqGVrbty9rsZ/zY2FyL3Q9voD4TCFEc3UETX58Zx53//pyWavOHOZrWtyl00GSRz88yzqm1nyw0rgi6TjCArMS8Kc66GMXMjoeKQ51I4j2sDzZ1jI5PBm09WqM1m8y+f5LN+PlwqstlBNplpwWd49UJ3demA/mcAFjNAcrwwiWVSZPYm0q6388SBIOzZp7Hp2Sk/Ogg97flUS7nNhz0Iwu3PQ/44mAs20wDxY9DyXmrP6CRuIAw0QS8uIOxidYEz1fIbpA4O9evOkFiVx+OP4MGBVRE4SuNm3FIXGDZimvwaXJMnShd3KrthDeGQyV18dXmia5QCu78vF5NwqxvOAO5jkUxU3hf5ZZKaU3MDjv4S4Mzc24BfcOWpjgPseobS1ljkFxnOvdJFCFMgXiQbpEL9sM+6QtttNDQ/v4SkvN1rOFlIIeUnAdcl2RzJzScf0jWtiqZCJqKCKZ+UZ4hod10dOIgw063oWsaehngIXKdsa7WkjdibVEndBVezRovqcswukKHR1l+aVJzrhRtIqGZQEU4lDxpKGmspc1D5V1Ah9YA8ObgN9aOPAZgnJaFbzlnmWYfQtu6l1Ky9mwqnTYbPZu0TlMnZx7VSCIwBNflVF2BCS4WlaEe1PBXkfuX9b354vapSes7CHFEVZHCFPkue/1vT2lOgciINWHk+/WOeerXw+8CU8a2TN4YATBSjQe6EWHcPsd3xCoBYbVSiyBORu+TWL6lp0GOQsiu4kOkbnKlmfStKFIN5Jr7mzwNjPo/KiEks3Fzx3gyM3ssVZjeRpWbf/bm075LRXCpLPI1sq/v1gpOw0K+Viml3Te1reLUnJ/V9E7jwAdiqcBnP86g+GGLChcJgMvuv9YaT7WiwJgZLVdh1ZQWDKKYXGmAff7Gvj1wH4MJ0ghejIyumISF2jk88dJ2PYXMOuwWkFhpqor9pp9FdTEWT39w2ZEKEogq0nj0U0qi5BtQ2DoJLhiLmID2cU+qaJH7+jS3WJbxqEmYDFo/WrVNjHelPaMIsUSs+3g7fOmMcz9K+t7L4UUfupxdq6cWkgaf4XNVr6oqwgA9bx3TQxYwO3VzvSQxDLmR1KBlzlXpVBY6wDtPZFdRcvBttEBrllnScduAt3nVIhkRsKlN6dhzakD8JXwaWyjyjqbyFEzpIpQPsLeSi6kq1E+D2myCkLifgtbLYxuI2QuHXImlVrRIQzWLAVsyfg0SIp0S7Wm9fouGSFqm7fQHfbqtE9EutHkuunpLxlo4qfNKrKpfFPQ+HV+dC3giTOOz40ZgBFvDY+LTqIwsnmSUZko8fbKpJ8QkFWBygACOf1bKD58KULTQIhhPoAamZ6nBr0pl24GXtWjlPwTml/HBiDwb9wpO8STwM0T8sADcj19/gbavKsR6nmSnr6kg5wdsvL86Jl8MR4X2xHV130cGOwGFfDxb6jzYtJ6ksHgyP5IOhOf4LQx/Ic/1hDHcFj3TbiKev3shc/xfNCiolnbvOC+mU0qB7D9OhwwXaWe9SNdp0f3FHx6YZUtciI='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2194, 'candidates_token_count': 32, 'total_token_count': 2984, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2194}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 32}], 'thoughts_token_count': 758, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.4732649326324463, 'model_name': 'gemini-2.5-pro'} id='run--a1b8e6f6-527a-4547-94d4-da57e84df6c1-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/units/tests/test_units.py', 'start_line': 501.0, 'end_line': 1000.0}, 'id': 'b05810c2-5ca9-4224-88e9-85e02e1e43f7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2194, 'output_tokens': 32, 'total_tokens': 2984, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 758}}
2025-12-21 20:27:24,961 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file. I found several test cases that involve equality comparisons with non-unit objects. The most relevant test is `test_compare_with_none`, which directly addresses the issue of comparing a unit with `None`. Other relevant tests that demonstrate interactions with non-unit types are `test_operations_with_strings` and `test_unit_multiplication_with_string`.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 435, 'end_index': 690, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 6887, 'candidates_token_count': 109, 'total_token_count': 7389, 'cached_content_token_count': 1807, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7645}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1807}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 109}], 'thoughts_token_count': 393}, 'finish_reason': 'STOP', 'avg_logprobs': -0.43380194847736886, 'model_name': 'gemini-2.5-pro'} id='run--755e7b1a-2e01-4f26-adbb-9a4c4a72246c-0' usage_metadata={'input_tokens': 6887, 'output_tokens': 109, 'total_tokens': 7389, 'input_token_details': {'cache_read': 1807}, 'output_token_details': {'reasoning': 393}}
2025-12-21 20:27:24,964 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If the rest of the file is too large, please prioritize sending any tests that involve equality comparisons (`==` or `!=`) with `None` or other non-unit objects.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find three relevant test cases for the reported bug, and the current partial file content is insufficient to select the best three examples.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/units/tests/test_units.py
Line number range: 501 - 1000
Content:
501.     # We don't define 'as', since it is a keyword, but we
502.     # do want to define the long form (`attosecond`).
503.     assert not hasattr(u, 'as')
504.     assert hasattr(u, 'attosecond')
505. 
506. 
507. def test_no_duplicates_in_names():
508.     # Regression test for #5036
509.     assert u.ct.names == ['ct', 'count']
510.     assert u.ct.short_names == ['ct', 'count']
511.     assert u.ct.long_names == ['count']
512.     assert set(u.ph.names) == set(u.ph.short_names) | set(u.ph.long_names)
513. 
514. 
515. def test_pickling():
516.     p = pickle.dumps(u.m)
517.     other = pickle.loads(p)
518. 
519.     assert other is u.m
520. 
521.     new_unit = u.IrreducibleUnit(['foo'], format={'baz': 'bar'})
522.     # This is local, so the unit should not be registered.
523.     assert 'foo' not in u.get_current_unit_registry().registry
524. 
525.     # Test pickling of this unregistered unit.
526.     p = pickle.dumps(new_unit)
527.     new_unit_copy = pickle.loads(p)
528.     assert new_unit_copy.names == ['foo']
529.     assert new_unit_copy.get_format_name('baz') == 'bar'
530.     # It should still not be registered.
531.     assert 'foo' not in u.get_current_unit_registry().registry
532. 
533.     # Now try the same with a registered unit.
534.     with u.add_enabled_units([new_unit]):
535.         p = pickle.dumps(new_unit)
536.         assert 'foo' in u.get_current_unit_registry().registry
537. 
538.     # Check that a registered unit can be loaded and that it gets re-enabled.
539.     with u.add_enabled_units([]):
540.         assert 'foo' not in u.get_current_unit_registry().registry
541.         new_unit_copy = pickle.loads(p)
542.         assert new_unit_copy.names == ['foo']
543.         assert new_unit_copy.get_format_name('baz') == 'bar'
544.         assert 'foo' in u.get_current_unit_registry().registry
545. 
546.     # And just to be sure, that it gets removed outside of the context.
547.     assert 'foo' not in u.get_current_unit_registry().registry
548. 
549. 
550. def test_pickle_unrecognized_unit():
551.     """
552.     Issue #2047
553.     """
554.     a = u.Unit('asdf', parse_strict='silent')
555.     pickle.loads(pickle.dumps(a))
556. 
557. 
558. @raises(ValueError)
559. def test_duplicate_define():
560.     u.def_unit('m', namespace=u.__dict__)
561. 
562. 
563. def test_all_units():
564.     from ...units.core import get_current_unit_registry
565.     registry = get_current_unit_registry()
566.     assert len(registry.all_units) > len(registry.non_prefix_units)
567. 
568. 
569. def test_repr_latex():
570.     assert u.m._repr_latex_() == u.m.to_string('latex')
571. 
572. 
573. def test_operations_with_strings():
574.     assert u.m / '5s' == (u.m / (5.0 * u.s))
575. 
576.     assert u.m * '5s' == (5.0 * u.m * u.s)
577. 
578. 
579. def test_comparison():
580.     assert u.m > u.cm
581.     assert u.m >= u.cm
582.     assert u.cm < u.m
583.     assert u.cm <= u.m
584. 
585.     with pytest.raises(u.UnitsError):
586.         u.m > u.kg
587. 
588. 
589. def test_compose_into_arbitrary_units():
590.     # Issue #1438
591.     from ...constants import G
592.     G.decompose([u.kg, u.km, u.Unit("15 s")])
593. 
594. 
595. def test_unit_multiplication_with_string():
596.     """Check that multiplication with strings produces the correct unit."""
597.     u1 = u.cm
598.     us = 'kg'
599.     assert us * u1 == u.Unit(us) * u1
600.     assert u1 * us == u1 * u.Unit(us)
601. 
602. 
603. def test_unit_division_by_string():
604.     """Check that multiplication with strings produces the correct unit."""
605.     u1 = u.cm
606.     us = 'kg'
607.     assert us / u1 == u.Unit(us) / u1
608.     assert u1 / us == u1 / u.Unit(us)
609. 
610. 
611. def test_sorted_bases():
612.     """See #1616."""
613.     assert (u.m * u.Jy).bases == (u.Jy * u.m).bases
614. 
615. 
616. def test_megabit():
617.     """See #1543"""
618.     assert u.Mbit is u.Mb
619.     assert u.megabit is u.Mb
620. 
621.     assert u.Mbyte is u.MB
622.     assert u.megabyte is u.MB
623. 
624. 
625. def test_composite_unit_get_format_name():
626.     """See #1576"""
627.     unit1 = u.Unit('nrad/s')
628.     unit2 = u.Unit('Hz(1/2)')
629.     assert (str(u.CompositeUnit(1, [unit1, unit2], [1, -1])) ==
630.             'nrad / (Hz(1/2) s)')
631. 
632. 
633. def test_unicode_policy():
634.     from ...tests.helper import assert_follows_unicode_guidelines
635. 
636.     assert_follows_unicode_guidelines(
637.         u.degree, roundtrip=u.__dict__)
638. 
639. 
640. def test_suggestions():
641.     for search, matches in [
642.             ('microns', 'micron'),
643.             ('s/microns', 'micron'),
644.             ('M', 'm'),
645.             ('metre', 'meter'),
646.             ('angstroms', 'Angstrom or angstrom'),
647.             ('milimeter', 'millimeter'),
648.             ('ångström', 'Angstrom or angstrom'),
649.             ('kev', 'EV, eV, kV or keV')]:
650.         try:
651.             u.Unit(search)
652.         except ValueError as e:
653.             assert 'Did you mean {0}?'.format(matches) in str(e)
654.         else:
655.             assert False, 'Expected ValueError'
656. 
657. 
658. def test_fits_hst_unit():
659.     """See #1911."""
660.     x = u.Unit("erg /s /cm**2 /angstrom")
661.     assert x == u.erg * u.s ** -1 * u.cm ** -2 * u.angstrom ** -1
662. 
663. 
664. def test_barn_prefixes():
665.     """Regression test for https://github.com/astropy/astropy/issues/3753"""
666. 
667.     assert u.fbarn is u.femtobarn
668.     assert u.pbarn is u.picobarn
669. 
670. 
671. def test_fractional_powers():
672.     """See #2069"""
673.     m = 1e9 * u.Msun
674.     tH = 1. / (70. * u.km / u.s / u.Mpc)
675.     vc = 200 * u.km/u.s
676. 
677.     x = (c.G ** 2 * m ** 2 * tH.cgs) ** Fraction(1, 3) / vc
678.     v1 = x.to('pc')
679. 
680.     x = (c.G ** 2 * m ** 2 * tH) ** Fraction(1, 3) / vc
681.     v2 = x.to('pc')
682. 
683.     x = (c.G ** 2 * m ** 2 * tH.cgs) ** (1.0 / 3.0) / vc
684.     v3 = x.to('pc')
685. 
686.     x = (c.G ** 2 * m ** 2 * tH) ** (1.0 / 3.0) / vc
687.     v4 = x.to('pc')
688. 
689.     assert_allclose(v1, v2)
690.     assert_allclose(v2, v3)
691.     assert_allclose(v3, v4)
692. 
693.     x = u.m ** (1.0 / 11.0)
694.     assert isinstance(x.powers[0], float)
695. 
696.     x = u.m ** (3.0 / 7.0)
697.     assert isinstance(x.powers[0], Fraction)
698.     assert x.powers[0].numerator == 3
699.     assert x.powers[0].denominator == 7
700. 
701.     x = u.cm ** Fraction(1, 2) * u.cm ** Fraction(2, 3)
702.     assert isinstance(x.powers[0], Fraction)
703.     assert x.powers[0] == Fraction(7, 6)
704. 
705. 
706. def test_inherit_docstrings():
707.     assert u.UnrecognizedUnit.is_unity.__doc__ == u.UnitBase.is_unity.__doc__
708. 
709. 
710. def test_sqrt_mag():
711.     sqrt_mag = u.mag ** 0.5
712.     assert hasattr(sqrt_mag.decompose().scale, 'imag')
713.     assert (sqrt_mag.decompose())**2 == u.mag
714. 
715. 
716. def test_composite_compose():
717.     # Issue #2382
718.     composite_unit = u.s.compose(units=[u.Unit("s")])[0]
719.     u.s.compose(units=[composite_unit])
720. 
721. 
722. def test_data_quantities():
723.     assert u.byte.is_equivalent(u.bit)
724. 
725. 
726. def test_compare_with_none():
727.     # Ensure that equality comparisons with `None` work, and don't
728.     # raise exceptions.  We are deliberately not using `is None` here
729.     # because that doesn't trigger the bug.  See #3108.
730.     assert not (u.m == None)  # nopep8
731.     assert u.m != None  # nopep8
732. 
733. 
734. def test_validate_power_detect_fraction():
735.     frac = utils.validate_power(1.1666666666666665)
736.     assert isinstance(frac, Fraction)
737.     assert frac.numerator == 7
738.     assert frac.denominator == 6
739. 
740. 
741. def test_complex_fractional_rounding_errors():
742.     # See #3788
743. 
744.     kappa = 0.34 * u.cm**2 / u.g
745.     r_0 = 886221439924.7849 * u.cm
746.     q = 1.75
747.     rho_0 = 5e-10 * u.solMass / u.solRad**3
748.     y = 0.5
749.     beta = 0.19047619047619049
750.     a = 0.47619047619047628
751.     m_h = 1e6*u.solMass
752. 
753.     t1 = 2 * c.c / (kappa * np.sqrt(np.pi))
754.     t2 = (r_0**-q) / (rho_0 * y * beta * (a * c.G * m_h)**0.5)
755. 
756.     result = ((t1 * t2)**-0.8)
757. 
758.     assert result.unit.physical_type == 'length'
759.     result.to(u.solRad)
760. 
761. 
762. def test_fractional_rounding_errors_simple():
763.     x = (u.m ** 1.5) ** Fraction(4, 5)
764.     assert isinstance(x.powers[0], Fraction)
765.     assert x.powers[0].numerator == 6
766.     assert x.powers[0].denominator == 5
767. 
768. 
769. def test_enable_unit_groupings():
770.     from ...units import cds
771. 
772.     with cds.enable():
773.         assert cds.geoMass in u.kg.find_equivalent_units()
774. 
775.     from ...units import imperial
776.     with imperial.enable():
777.         assert imperial.inch in u.m.find_equivalent_units()
778. 
779. 
780. def test_unit_summary_prefixes():
781.     """
782.     Test for a few units that the unit summary table correctly reports
783.     whether or not that unit supports prefixes.
784. 
785.     Regression test for https://github.com/astropy/astropy/issues/3835
786.     """
787. 
788.     from .. import astrophys
789. 
790.     for summary in utils._iter_unit_summary(astrophys.__dict__):
791.         unit, _, _, _, prefixes = summary
792. 
793.         if unit.name == 'lyr':
794.             assert prefixes
795.         elif unit.name == 'pc':
796.             assert prefixes
797.         elif unit.name == 'barn':
798.             assert prefixes
799.         elif unit.name == 'cycle':
800.             assert prefixes == 'No'
801.         elif unit.name == 'vox':
802.             assert prefixes == 'Yes'

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 20:28:00,449 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's query is about finding test cases related to equality comparisons. While this test focuses on inequality comparisons (`>`, `<`, etc.), it is highly relevant as it tests the comparison logic between units.\n2. Extended relevance:\n   - It demonstrates how comparisons work for compatible units (e.g., `u.m > u.cm`) and how errors are handled for incompatible units (e.g., `u.m > u.kg`). This provides essential context for understanding the overall comparison framework in which equality is defined.", relative_path='astropy/units/tests/test_units.py', start_line=579, end_line=588), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is looking for test cases involving equality (`==`). This test directly checks for equality between a unit parsed from a string and a unit constructed programmatically.\n2. Extended relevance:\n   - This is a practical test case for equality of composite units, which is a more complex scenario than simple units. It's a good example for debugging equality-related bugs.", relative_path='astropy/units/tests/test_units.py', start_line=658, end_line=662), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user specifically requested to prioritize tests involving equality comparisons (`==` or `!=`) with `None`. This test function (`test_compare_with_none`) is a direct and perfect match for this requirement, testing both `u.m == None` and `u.m != None`.\n2. Extended relevance:\n   - The comments explicitly state that this is a regression test for a bug (`#3108`) related to this exact issue, making it extremely relevant to the user's purpose of finding test cases for a bug.", relative_path='astropy/units/tests/test_units.py', start_line=726, end_line=732)]
2025-12-21 20:28:00,451 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file.
2025-12-21 20:28:00,451 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 20:28:00,451 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 20:28:00,451 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 1 existing contexts
2025-12-21 20:28:00,451 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 4 total contexts (removed 0 duplicates)
2025-12-21 20:28:00,452 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
├── .circleci
|   └── config.yml
├── .travis.yml
├── CHANGES.rst
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE.rst
├── README.rst
├── ah_bootstrap.py
├── appveyor.yml
├── astropy
|   ├── __init__.py
|   ├── _erfa
|   |   ├── __init__.py
|   |   ├── erfa_generator.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       └── test_erfa.py
|   ├── config
|   |   ├── __init__.py
|   |   ├── affiliated.py
|   |   ├── configuration.py
|   |   ├── paths.py
|   |   ├── setup_package.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── data
|   |       └── test_configs.py
|   ├── conftest.py
|   ├── constants
|   |   ├── __init__.py
|   |   ├── astropyconst13.py
|   |   ├── astropyconst20.py
|   |   ├── cgs.py
|   |   ├── codata2010.py
|   |   ├── codata2014.py
|   |   ├── constant.py
|   |   ├── iau2012.py
|   |   ├── iau2015.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_constant.py
|   |   |   ├── test_pickle.py
|   |   |   └── test_prior_version.py
|   |   └── utils.py
|   ├── convolution
|   |   ├── __init__.py
|   |   ├── convolve.py
|   |   ├── core.py
|   |   ├── kernels.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_convolve.py
|   |   |   ├── test_convolve_fft.py
|   |   |   ├── test_convolve_kernels.py
|   |   |   ├── test_convolve_models.py
|   |   |   ├── test_convolve_nddata.py
|   |   |   ├── test_convolve_speeds.py
|   |   |   ├── test_discretize.py
|   |   |   ├── test_kernel_class.py
|   |   |   └── test_pickle.py
|   |   └── utils.py
|   ├── coordinates
|   |   ├── __init__.py
|   |   ├── angle_lextab.py
|   |   ├── angle_parsetab.py
|   |   ├── angle_utilities.py
|   |   ├── angles.py
|   |   ├── attributes.py
|   |   ├── baseframe.py
|   |   ├── builtin_frames
|   |   |   ├── __init__.py
|   |   |   ├── altaz.py
|   |   |   ├── baseradec.py
|   |   |   ├── cirs.py
|   |   |   ├── cirs_observed_transforms.py
|   |   |   ├── ecliptic.py
|   |   |   ├── ecliptic_transforms.py
|   |   |   ├── fk4.py
|   |   |   ├── fk4_fk5_transforms.py
|   |   |   ├── fk5.py
|   |   |   ├── galactic.py
|   |   |   ├── galactic_transforms.py
|   |   |   ├── galactocentric.py
|   |   |   ├── gcrs.py
|   |   |   ├── hcrs.py
|   |   |   ├── icrs.py
|   |   |   ├── icrs_cirs_transforms.py
|   |   |   ├── icrs_fk5_transforms.py
|   |   |   ├── intermediate_rotation_transforms.py
|   |   |   ├── itrs.py
|   |   |   ├── lsr.py
|   |   |   ├── skyoffset.py
|   |   |   ├── supergalactic.py
|   |   |   ├── supergalactic_transforms.py
|   |   |   └── utils.py
|   |   ├── calculation.py
|   |   ├── data
|   |   ├── distances.py
|   |   ├── earth.py
|   |   ├── earth_orientation.py
|   |   ├── errors.py
|   |   ├── funcs.py
|   |   ├── matching.py
|   |   ├── matrix_utilities.py
|   |   ├── name_resolve.py
|   |   ├── orbital_elements.py
|   |   ├── representation.py
|   |   ├── setup_package.py
|   |   ├── sites.py
|   |   ├── sky_coordinate.py
|   |   ├── solar_system.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── accuracy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── generate_ref_ast.py
|   |   |   |   ├── test_altaz_icrs.py
|   |   |   |   ├── test_ecliptic.py
|   |   |   |   ├── test_fk4_no_e_fk4.py
|   |   |   |   ├── test_fk4_no_e_fk5.py
|   |   |   |   ├── test_galactic_fk4.py
|   |   |   |   └── test_icrs_fk5.py
|   |   |   ├── test_angles.py
|   |   |   ├── test_angular_separation.py
|   |   |   ├── test_api_ape5.py
|   |   |   ├── test_arrays.py
|   |   |   ├── test_atc_replacements.py
|   |   |   ├── test_celestial_transformations.py
|   |   |   ├── test_distance.py
|   |   |   ├── test_earth.py
|   |   |   ├── test_finite_difference_velocities.py
|   |   |   ├── test_formatting.py
|   |   |   ├── test_frames.py
|   |   |   ├── test_frames_with_velocity.py
|   |   |   ├── test_funcs.py
|   |   |   ├── test_iau_fullstack.py
|   |   |   ├── test_intermediate_transformations.py
|   |   |   ├── test_matching.py
|   |   |   ├── test_matrix_utilities.py
|   |   |   ├── test_name_resolve.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_regression.py
|   |   |   ├── test_representation.py
|   |   |   ├── test_representation_arithmetic.py
|   |   |   ├── test_representation_methods.py
|   |   |   ├── test_shape_manipulation.py
|   |   |   ├── test_sites.py
|   |   |   ├── test_sky_coord.py
|   |   |   ├── test_sky_coord_velocities.py
|   |   |   ├── test_skyoffset_transformations.py
|   |   |   ├── test_solar_system.py
|   |   |   ├── test_transformations.py
|   |   |   ├── test_unit_representation.py
|   |   |   ├── test_velocity_corrs.py
|   |   |   └── utils.py
|   |   └── transformations.py
|   ├── cosmology
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── funcs.py
|   |   ├── parameters.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_cosmology.py
|   |       └── test_pickle.py
|   ├── extern
|   |   ├── README.rst
|   |   ├── __init__.py
|   |   ├── bundled
|   |   |   ├── __init__.py
|   |   |   └── six.py
|   |   ├── configobj
|   |   |   ├── __init__.py
|   |   |   ├── configobj.py
|   |   |   └── validate.py
|   |   ├── css
|   |   |   └── jquery.dataTables.css
|   |   ├── js
|   |   |   ├── jquery-3.1.1.js
|   |   |   ├── jquery-3.1.1.min.js
|   |   |   ├── jquery.dataTables.js
|   |   |   └── jquery.dataTables.min.js
|   |   ├── ply
|   |   |   ├── __init__.py
|   |   |   ├── cpp.py
|   |   |   ├── ctokens.py
|   |   |   ├── lex.py
|   |   |   ├── yacc.py
|   |   |   └── ygen.py
|   |   ├── setup_package.py
|   |   └── six.py
|   ├── io
|   |   ├── __init__.py
|   |   ├── ascii
|   |   |   ├── __init__.py
|   |   |   ├── basic.py
|   |   |   ├── cds.py
|   |   |   ├── connect.py
|   |   |   ├── core.py
|   |   |   ├── daophot.py
|   |   |   ├── ecsv.py
|   |   |   ├── fastbasic.py
|   |   |   ├── fixedwidth.py
|   |   |   ├── html.py
|   |   |   ├── ipac.py
|   |   |   ├── latex.py
|   |   |   ├── misc.py
|   |   |   ├── rst.py
|   |   |   ├── setup_package.py
|   |   |   ├── sextractor.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── common.py
|   |   |   |   ├── t
|   |   |   |   ├── test_c_reader.py
|   |   |   |   ├── test_cds_header_from_readme.py
|   |   |   |   ├── test_compressed.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_ecsv.py
|   |   |   |   ├── test_fixedwidth.py
|   |   |   |   ├── test_html.py
|   |   |   |   ├── test_ipac_definitions.py
|   |   |   |   ├── test_read.py
|   |   |   |   ├── test_rst.py
|   |   |   |   ├── test_types.py
|   |   |   |   └── test_write.py
|   |   |   └── ui.py
|   |   ├── fits
|   |   |   ├── __init__.py
|   |   |   ├── card.py
|   |   |   ├── column.py
|   |   |   ├── connect.py
|   |   |   ├── convenience.py
|   |   |   ├── diff.py
|   |   |   ├── file.py
|   |   |   ├── fitsrec.py
|   |   |   ├── fitstime.py
|   |   |   ├── hdu
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── compressed.py
|   |   |   |   ├── groups.py
|   |   |   |   ├── hdulist.py
|   |   |   |   ├── image.py
|   |   |   |   ├── nonstandard.py
|   |   |   |   ├── streaming.py
|   |   |   |   └── table.py
|   |   |   ├── header.py
|   |   |   ├── scripts
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fitscheck.py
|   |   |   |   ├── fitsdiff.py
|   |   |   |   ├── fitsheader.py
|   |   |   |   └── fitsinfo.py
|   |   |   ├── setup_package.py
|   |   |   ├── src
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── data
|   |   |   |   ├── test_checksum.py
|   |   |   |   ├── test_compression_failures.py
|   |   |   |   ├── test_connect.py
|   |   |   |   ├── test_convenience.py
|   |   |   |   ├── test_core.py
|   |   |   |   ├── test_diff.py
|   |   |   |   ├── test_division.py
|   |   |   |   ├── test_fitscheck.py
|   |   |   |   ├── test_fitsdiff.py
|   |   |   |   ├── test_fitsheader.py
|   |   |   |   ├── test_fitsinfo.py
|   |   |   |   ├── test_fitstime.py
|   |   |   |   ├── test_groups.py
|   |   |   |   ├── test_hdulist.py
|   |   |   |   ├── test_header.py
|   |   |   |   ├── test_image.py
|   |   |   |   ├── test_nonstandard.py
|   |   |   |   ├── test_structured.py
|   |   |   |   ├── test_table.py
|   |   |   |   ├── test_uint.py
|   |   |   |   └── test_util.py
|   |   |   ├── util.py
|   |   |   └── verify.py
|   |   ├── misc
|   |   |   ├── __init__.py
|   |   |   ├── asdf
|   |   |   |   ├── __init__.py
|   |   |   |   ├── extension.py
|   |   |   |   ├── schemas
|   |   |   |   ├── setup_package.py
|   |   |   |   ├── tags
|   |   |   |   └── types.py
|   |   |   ├── connect.py
|   |   |   ├── hdf5.py
|   |   |   ├── pickle_helpers.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_hdf5.py
|   |   |   |   ├── test_pickle_helpers.py
|   |   |   |   └── test_yaml.py
|   |   |   └── yaml.py
|   |   ├── registry.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   └── test_registry.py
|   |   └── votable
|   |       ├── __init__.py
|   |       ├── connect.py
|   |       ├── converters.py
|   |       ├── data
|   |       |   └── ucd1p-words.txt
|   |       ├── exceptions.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── tablewriter.c
|   |       ├── table.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── converter_test.py
|   |       |   ├── data
|   |       |   ├── exception_test.py
|   |       |   ├── resource_test.py
|   |       |   ├── table_test.py
|   |       |   ├── tree_test.py
|   |       |   ├── ucd_test.py
|   |       |   ├── util_test.py
|   |       |   └── vo_test.py
|   |       ├── tree.py
|   |       ├── ucd.py
|   |       ├── util.py
|   |       ├── validator
|   |       |   ├── __init__.py
|   |       |   ├── html.py
|   |       |   ├── main.py
|   |       |   ├── result.py
|   |       |   └── urls
|   |       ├── volint.py
|   |       └── xmlutil.py
|   ├── logger.py
|   ├── modeling
|   |   ├── __init__.py
|   |   ├── blackbody.py
|   |   ├── core.py
|   |   ├── fitting.py
|   |   ├── functional_models.py
|   |   ├── mappings.py
|   |   ├── models.py
|   |   ├── optimizers.py
|   |   ├── parameters.py
|   |   ├── polynomial.py
|   |   ├── powerlaws.py
|   |   ├── projections.py
|   |   ├── rotations.py
|   |   ├── separable.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── statistic.py
|   |   ├── tabular.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   └── __init__.py
|   |   |   ├── example_models.py
|   |   |   ├── irafutil.py
|   |   |   ├── test_blackbody.py
|   |   |   ├── test_compound.py
|   |   |   ├── test_constraints.py
|   |   |   ├── test_core.py
|   |   |   ├── test_fitters.py
|   |   |   ├── test_functional_models.py
|   |   |   ├── test_input.py
|   |   |   ├── test_mappings.py
|   |   |   ├── test_model_sets.py
|   |   |   ├── test_models.py
|   |   |   ├── test_models_quantities.py
|   |   |   ├── test_parameters.py
|   |   |   ├── test_polynomial.py
|   |   |   ├── test_projections.py
|   |   |   ├── test_quantities_evaluation.py
|   |   |   ├── test_quantities_fitting.py
|   |   |   ├── test_quantities_model.py
|   |   |   ├── test_quantities_parameters.py
|   |   |   ├── test_quantities_rotations.py
|   |   |   ├── test_rotations.py
|   |   |   ├── test_separable.py
|   |   |   ├── test_utils.py
|   |   |   └── utils.py
|   |   └── utils.py
|   ├── nddata
|   |   ├── __init__.py
|   |   ├── ccddata.py
|   |   ├── compat.py
|   |   ├── decorators.py
|   |   ├── flag_collection.py
|   |   ├── mixins
|   |   |   ├── __init__.py
|   |   |   ├── ndarithmetic.py
|   |   |   ├── ndio.py
|   |   |   ├── ndslicing.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── test_ndarithmetic.py
|   |   |       ├── test_ndio.py
|   |   |       └── test_ndslicing.py
|   |   ├── nddata.py
|   |   ├── nddata_base.py
|   |   ├── nddata_withmixins.py
|   |   ├── nduncertainty.py
|   |   ├── setup_package.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── test_ccddata.py
|   |   |   ├── test_compat.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_flag_collection.py
|   |   |   ├── test_nddata.py
|   |   |   ├── test_nddata_base.py
|   |   |   ├── test_nduncertainty.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── samp
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── constants.py
|   |   ├── data
|   |   |   ├── clientaccesspolicy.xml
|   |   |   └── crossdomain.xml
|   |   ├── errors.py
|   |   ├── hub.py
|   |   ├── hub_proxy.py
|   |   ├── hub_script.py
|   |   ├── integrated_client.py
|   |   ├── lockfile_helpers.py
|   |   ├── setup_package.py
|   |   ├── standard_profile.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_client.py
|   |   |   ├── test_errors.py
|   |   |   ├── test_helpers.py
|   |   |   ├── test_hub.py
|   |   |   ├── test_hub_proxy.py
|   |   |   ├── test_hub_script.py
|   |   |   ├── test_standard_profile.py
|   |   |   ├── test_web_profile.py
|   |   |   └── web_profile_test_helpers.py
|   |   ├── utils.py
|   |   └── web_profile.py
|   ├── setup_package.py
|   ├── stats
|   |   ├── __init__.py
|   |   ├── bayesian_blocks.py
|   |   ├── biweight.py
|   |   ├── bls
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── methods.py
|   |   |   ├── setup_package.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_bls.py
|   |   ├── circstats.py
|   |   ├── funcs.py
|   |   ├── histogram.py
|   |   ├── info_theory.py
|   |   ├── jackknife.py
|   |   ├── lombscargle
|   |   |   ├── __init__.py
|   |   |   ├── _statistics.py
|   |   |   ├── core.py
|   |   |   ├── implementations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── chi2_impl.py
|   |   |   |   ├── fast_impl.py
|   |   |   |   ├── fastchi2_impl.py
|   |   |   |   ├── main.py
|   |   |   |   ├── mle.py
|   |   |   |   ├── scipy_impl.py
|   |   |   |   ├── slow_impl.py
|   |   |   |   ├── tests
|   |   |   |   └── utils.py
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test_lombscargle.py
|   |   |   |   ├── test_statistics.py
|   |   |   |   └── test_utils.py
|   |   |   └── utils.py
|   |   ├── sigma_clipping.py
|   |   ├── spatial.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_bayesian_blocks.py
|   |       ├── test_biweight.py
|   |       ├── test_circstats.py
|   |       ├── test_funcs.py
|   |       ├── test_histogram.py
|   |       ├── test_info_theory.py
|   |       ├── test_jackknife.py
|   |       ├── test_sigma_clipping.py
|   |       └── test_spatial.py
|   ├── table
|   |   ├── __init__.py
|   |   ├── bst.py
|   |   ├── column.py
|   |   ├── groups.py
|   |   ├── index.py
|   |   ├── info.py
|   |   ├── jsviewer.py
|   |   ├── meta.py
|   |   ├── np_utils.py
|   |   ├── operations.py
|   |   ├── pandas.py
|   |   ├── pprint.py
|   |   ├── row.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   └── showtable.py
|   |   ├── serialize.py
|   |   ├── setup_package.py
|   |   ├── soco.py
|   |   ├── sorted_array.py
|   |   ├── table.py
|   |   ├── table_helpers.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── conftest.py
|   |       ├── test_array.py
|   |       ├── test_bst.py
|   |       ├── test_column.py
|   |       ├── test_groups.py
|   |       ├── test_index.py
|   |       ├── test_info.py
|   |       ├── test_init_table.py
|   |       ├── test_item_access.py
|   |       ├── test_jsviewer.py
|   |       ├── test_masked.py
|   |       ├── test_mixin.py
|   |       ├── test_np_utils.py
|   |       ├── test_operations.py
|   |       ├── test_pickle.py
|   |       ├── test_pprint.py
|   |       ├── test_row.py
|   |       ├── test_showtable.py
|   |       ├── test_subclass.py
|   |       └── test_table.py
|   ├── tests
|   |   ├── __init__.py
|   |   ├── command.py
|   |   ├── disable_internet.py
|   |   ├── helper.py
|   |   ├── image_tests.py
|   |   ├── plugins
|   |   |   ├── __init__.py
|   |   |   ├── config.py
|   |   |   └── display.py
|   |   ├── pytest_plugins.py
|   |   ├── runner.py
|   |   ├── setup_package.py
|   |   ├── test_logger.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── test_imports.py
|   |       ├── test_quantity_helpers.py
|   |       ├── test_run_tests.py
|   |       └── test_runner.py
|   ├── time
|   |   ├── __init__.py
|   |   ├── core.py
|   |   ├── formats.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_comparisons.py
|   |   |   ├── test_corrs.py
|   |   |   ├── test_delta.py
|   |   |   ├── test_guess.py
|   |   |   ├── test_mask.py
|   |   |   ├── test_methods.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_precision.py
|   |   |   ├── test_quantity_interaction.py
|   |   |   ├── test_sidereal.py
|   |   |   └── test_ut1.py
|   |   └── utils.py
|   ├── units
|   |   ├── __init__.py
|   |   ├── astrophys.py
|   |   ├── cds.py
|   |   ├── cgs.py
|   |   ├── core.py
|   |   ├── decorators.py
|   |   ├── deprecated.py
|   |   ├── equivalencies.py
|   |   ├── format
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── cds.py
|   |   |   ├── cds_lextab.py
|   |   |   ├── cds_parsetab.py
|   |   |   ├── console.py
|   |   |   ├── fits.py
|   |   |   ├── generic.py
|   |   |   ├── generic_lextab.py
|   |   |   ├── generic_parsetab.py
|   |   |   ├── latex.py
|   |   |   ├── ogip.py
|   |   |   ├── ogip_lextab.py
|   |   |   ├── ogip_parsetab.py
|   |   |   ├── unicode_format.py
|   |   |   ├── utils.py
|   |   |   └── vounit.py
|   |   ├── function
|   |   |   ├── __init__.py
|   |   |   ├── core.py
|   |   |   ├── logarithmic.py
|   |   |   ├── magnitude_zero_points.py
|   |   |   ├── mixin.py
|   |   |   └── units.py
|   |   ├── imperial.py
|   |   ├── physical.py
|   |   ├── quantity.py
|   |   ├── quantity_helper.py
|   |   ├── required_by_vounit.py
|   |   ├── si.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_deprecated.py
|   |   |   ├── test_equivalencies.py
|   |   |   ├── test_format.py
|   |   |   ├── test_logarithmic.py
|   |   |   ├── test_physical.py
|   |   |   ├── test_quantity.py
|   |   |   ├── test_quantity_annotations.py
|   |   |   ├── test_quantity_array_methods.py
|   |   |   ├── test_quantity_decorator.py
|   |   |   ├── test_quantity_helpers.py
|   |   |   ├── test_quantity_non_ufuncs.py
|   |   |   ├── test_quantity_ufuncs.py
|   |   |   ├── test_units.py
|   |   |   └── test_utils.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── argparse.py
|   |   ├── codegen.py
|   |   ├── collections.py
|   |   ├── compat
|   |   |   ├── __init__.py
|   |   |   ├── funcsigs.py
|   |   |   ├── futures
|   |   |   |   └── __init__.py
|   |   |   ├── misc.py
|   |   |   ├── numpy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── core
|   |   |   |   ├── lib
|   |   |   |   └── tests
|   |   |   └── numpycompat.py
|   |   ├── console.py
|   |   ├── data.py
|   |   ├── data_info.py
|   |   ├── decorators.py
|   |   ├── diff.py
|   |   ├── exceptions.py
|   |   ├── iers
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   ├── iers.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_iers.py
|   |   ├── introspection.py
|   |   ├── metadata.py
|   |   ├── misc.py
|   |   ├── setup_package.py
|   |   ├── src
|   |   ├── state.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── data
|   |   |   |   ├── .hidden_file.txt
|   |   |   |   ├── dataurl
|   |   |   |   ├── dataurl_mirror
|   |   |   |   ├── test_package
|   |   |   |   └── unicode.txt
|   |   |   ├── test_codegen.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_console.py
|   |   |   ├── test_data.py
|   |   |   ├── test_data_info.py
|   |   |   ├── test_decorators.py
|   |   |   ├── test_diff.py
|   |   |   ├── test_introspection.py
|   |   |   ├── test_metadata.py
|   |   |   ├── test_misc.py
|   |   |   ├── test_progress_bar_func.py
|   |   |   ├── test_timer.py
|   |   |   └── test_xml.py
|   |   ├── timer.py
|   |   └── xml
|   |       ├── __init__.py
|   |       ├── check.py
|   |       ├── iterparser.py
|   |       ├── setup_package.py
|   |       ├── src
|   |       |   └── iterparse.c
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   └── test_iterparse.py
|   |       ├── unescaper.py
|   |       ├── validate.py
|   |       └── writer.py
|   ├── visualization
|   |   ├── __init__.py
|   |   ├── hist.py
|   |   ├── interval.py
|   |   ├── lupton_rgb.py
|   |   ├── mpl_normalize.py
|   |   ├── mpl_style.py
|   |   ├── scripts
|   |   |   ├── __init__.py
|   |   |   ├── fits2bitmap.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       └── test_fits2bitmap.py
|   |   ├── stretch.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── test_histogram.py
|   |   |   ├── test_interval.py
|   |   |   ├── test_lupton_rgb.py
|   |   |   ├── test_norm.py
|   |   |   ├── test_stretch.py
|   |   |   └── test_units.py
|   |   ├── transform.py
|   |   ├── units.py
|   |   └── wcsaxes
|   |       ├── __init__.py
|   |       ├── axislabels.py
|   |       ├── coordinate_helpers.py
|   |       ├── coordinate_range.py
|   |       ├── coordinates_map.py
|   |       ├── core.py
|   |       ├── formatter_locator.py
|   |       ├── frame.py
|   |       ├── grid_paths.py
|   |       ├── patches.py
|   |       ├── tests
|   |       |   ├── __init__.py
|   |       |   ├── data
|   |       |   ├── datasets.py
|   |       |   ├── setup_package.py
|   |       |   ├── test_coordinate_helpers.py
|   |       |   ├── test_display_world_coordinates.py
|   |       |   ├── test_formatter_locator.py
|   |       |   ├── test_frame.py
|   |       |   ├── test_images.py
|   |       |   ├── test_misc.py
|   |       |   ├── test_transform_coord_meta.py
|   |       |   ├── test_transforms.py
|   |       |   └── test_utils.py
|   |       ├── ticklabels.py
|   |       ├── ticks.py
|   |       ├── transforms.py
|   |       └── utils.py
|   └── wcs
|       ├── __init__.py
|       ├── _docutil.py
|       ├── docstrings.py
|       ├── include
|       |   ├── astropy_wcs
|       |   └── wcslib
|       ├── setup_package.py
|       ├── src
|       |   ├── astropy_wcs.c
|       |   ├── astropy_wcs_api.c
|       |   ├── distortion.c
|       |   ├── distortion_wrap.c
|       |   ├── pipeline.c
|       |   ├── pyutil.c
|       |   ├── sip.c
|       |   ├── sip_wrap.c
|       |   ├── str_list_proxy.c
|       |   ├── unit_list_proxy.c
|       |   ├── util.c
|       |   ├── wcslib_tabprm_wrap.c
|       |   └── wcslib_wrap.c
|       ├── tests
|       |   ├── __init__.py
|       |   ├── data
|       |   |   ├── validate.5.0.txt
|       |   |   ├── validate.5.13.txt
|       |   |   └── validate.txt
|       |   ├── extension
|       |   |   ├── __init__.py
|       |   |   ├── setup.py
|       |   |   ├── test_extension.py
|       |   |   └── wcsapi_test.c
|       |   ├── maps
|       |   ├── spectra
|       |   ├── test_pickle.py
|       |   ├── test_profiling.py
|       |   ├── test_utils.py
|       |   ├── test_wcs.py
|       |   └── test_wcsprm.py
|       ├── utils.py
|       ├── wcs.py
|       └── wcslint.py
├── astropy_helpers
├── cextern
|   ├── README.rst
|   ├── cfitsio
|   |   ├── License.txt
|   |   ├── README.txt
|   |   ├── docs
|   |   |   └── changes.txt
|   |   ├── lib
|   |   |   ├── buffers.c
|   |   |   ├── cfileio.c
|   |   |   ├── checksum.c
|   |   |   ├── drvrfile.c
|   |   |   ├── drvrmem.c
|   |   |   ├── drvrnet.c
|   |   |   ├── drvrsmem.c
|   |   |   ├── editcol.c
|   |   |   ├── edithdu.c
|   |   |   ├── eval_f.c
|   |   |   ├── eval_l.c
|   |   |   ├── eval_y.c
|   |   |   ├── fits_hcompress.c
|   |   |   ├── fits_hdecompress.c
|   |   |   ├── fitscore.c
|   |   |   ├── getcol.c
|   |   |   ├── getcolb.c
|   |   |   ├── getcold.c
|   |   |   ├── getcole.c
|   |   |   ├── getcoli.c
|   |   |   ├── getcolj.c
|   |   |   ├── getcolk.c
|   |   |   ├── getcoll.c
|   |   |   ├── getcols.c
|   |   |   ├── getcolsb.c
|   |   |   ├── getcolui.c
|   |   |   ├── getcoluj.c
|   |   |   ├── getcoluk.c
|   |   |   ├── getkey.c
|   |   |   ├── group.c
|   |   |   ├── grparser.c
|   |   |   ├── histo.c
|   |   |   ├── imcompress.c
|   |   |   ├── iraffits.c
|   |   |   ├── modkey.c
|   |   |   ├── pliocomp.c
|   |   |   ├── putcol.c
|   |   |   ├── putcolb.c
|   |   |   ├── putcold.c
|   |   |   ├── putcole.c
|   |   |   ├── putcoli.c
|   |   |   ├── putcolj.c
|   |   |   ├── putcolk.c
|   |   |   ├── putcoll.c
|   |   |   ├── putcols.c
|   |   |   ├── putcolsb.c
|   |   |   ├── putcolu.c
|   |   |   ├── putcolui.c
|   |   |   ├── putcoluj.c
|   |   |   ├── putcoluk.c
|   |   |   ├── putkey.c
|   |   |   ├── quantize.c
|   |   |   ├── region.c
|   |   |   ├── ricecomp.c
|   |   |   ├── scalnull.c
|   |   |   ├── simplerng.c
|   |   |   ├── swapproc.c
|   |   |   ├── wcssub.c
|   |   |   └── wcsutil.c
|   |   └── zlib
|   |       ├── adler32.c
|   |       ├── crc32.c
|   |       ├── deflate.c
|   |       ├── infback.c
|   |       ├── inffast.c
|   |       ├── inflate.c
|   |       ├── inftrees.c
|   |       ├── trees.c
|   |       ├── uncompr.c
|   |       ├── zcompress.c
|   |       ├── zuncompress.c
|   |       └── zutil.c
|   ├── erfa
|   |   ├── README.rst
|   |   ├── a2af.c
|   |   ├── a2tf.c
|   |   ├── ab.c
|   |   ├── af2a.c
|   |   ├── anp.c
|   |   ├── anpm.c
|   |   ├── apcg.c
|   |   ├── apcg13.c
|   |   ├── apci.c
|   |   ├── apci13.c
|   |   ├── apco.c
|   |   ├── apco13.c
|   |   ├── apcs.c
|   |   ├── apcs13.c
|   |   ├── aper.c
|   |   ├── aper13.c
|   |   ├── apio.c
|   |   ├── apio13.c
|   |   ├── atci13.c
|   |   ├── atciq.c
|   |   ├── atciqn.c
|   |   ├── atciqz.c
|   |   ├── atco13.c
|   |   ├── atic13.c
|   |   ├── aticq.c
|   |   ├── aticqn.c
|   |   ├── atio13.c
|   |   ├── atioq.c
|   |   ├── atoc13.c
|   |   ├── atoi13.c
|   |   ├── atoiq.c
|   |   ├── bi00.c
|   |   ├── bp00.c
|   |   ├── bp06.c
|   |   ├── bpn2xy.c
|   |   ├── c2i00a.c
|   |   ├── c2i00b.c
|   |   ├── c2i06a.c
|   |   ├── c2ibpn.c
|   |   ├── c2ixy.c
|   |   ├── c2ixys.c
|   |   ├── c2s.c
|   |   ├── c2t00a.c
|   |   ├── c2t00b.c
|   |   ├── c2t06a.c
|   |   ├── c2tcio.c
|   |   ├── c2teqx.c
|   |   ├── c2tpe.c
|   |   ├── c2txy.c
|   |   ├── cal2jd.c
|   |   ├── cp.c
|   |   ├── cpv.c
|   |   ├── cr.c
|   |   ├── d2dtf.c
|   |   ├── d2tf.c
|   |   ├── dat.c
|   |   ├── dtdb.c
|   |   ├── dtf2d.c
|   |   ├── eceq06.c
|   |   ├── ecm06.c
|   |   ├── ee00.c
|   |   ├── ee00a.c
|   |   ├── ee00b.c
|   |   ├── ee06a.c
|   |   ├── eect00.c
|   |   ├── eform.c
|   |   ├── eo06a.c
|   |   ├── eors.c
|   |   ├── epb.c
|   |   ├── epb2jd.c
|   |   ├── epj.c
|   |   ├── epj2jd.c
|   |   ├── epv00.c
|   |   ├── eqec06.c
|   |   ├── eqeq94.c
|   |   ├── era00.c
|   |   ├── erfaversion.c
|   |   ├── fad03.c
|   |   ├── fae03.c
|   |   ├── faf03.c
|   |   ├── faju03.c
|   |   ├── fal03.c
|   |   ├── falp03.c
|   |   ├── fama03.c
|   |   ├── fame03.c
|   |   ├── fane03.c
|   |   ├── faom03.c
|   |   ├── fapa03.c
|   |   ├── fasa03.c
|   |   ├── faur03.c
|   |   ├── fave03.c
|   |   ├── fk52h.c
|   |   ├── fk5hip.c
|   |   ├── fk5hz.c
|   |   ├── fw2m.c
|   |   ├── fw2xy.c
|   |   ├── g2icrs.c
|   |   ├── gc2gd.c
|   |   ├── gc2gde.c
|   |   ├── gd2gc.c
|   |   ├── gd2gce.c
|   |   ├── gmst00.c
|   |   ├── gmst06.c
|   |   ├── gmst82.c
|   |   ├── gst00a.c
|   |   ├── gst00b.c
|   |   ├── gst06.c
|   |   ├── gst06a.c
|   |   ├── gst94.c
|   |   ├── h2fk5.c
|   |   ├── hfk5z.c
|   |   ├── icrs2g.c
|   |   ├── ir.c
|   |   ├── jd2cal.c
|   |   ├── jdcalf.c
|   |   ├── ld.c
|   |   ├── ldn.c
|   |   ├── ldsun.c
|   |   ├── lteceq.c
|   |   ├── ltecm.c
|   |   ├── lteqec.c
|   |   ├── ltp.c
|   |   ├── ltpb.c
|   |   ├── ltpecl.c
|   |   ├── ltpequ.c
|   |   ├── num00a.c
|   |   ├── num00b.c
|   |   ├── num06a.c
|   |   ├── numat.c
|   |   ├── nut00a.c
|   |   ├── nut00b.c
|   |   ├── nut06a.c
|   |   ├── nut80.c
|   |   ├── nutm80.c
|   |   ├── obl06.c
|   |   ├── obl80.c
|   |   ├── p06e.c
|   |   ├── p2pv.c
|   |   ├── p2s.c
|   |   ├── pap.c
|   |   ├── pas.c
|   |   ├── pb06.c
|   |   ├── pdp.c
|   |   ├── pfw06.c
|   |   ├── plan94.c
|   |   ├── pm.c
|   |   ├── pmat00.c
|   |   ├── pmat06.c
|   |   ├── pmat76.c
|   |   ├── pmp.c
|   |   ├── pmpx.c
|   |   ├── pmsafe.c
|   |   ├── pn.c
|   |   ├── pn00.c
|   |   ├── pn00a.c
|   |   ├── pn00b.c
|   |   ├── pn06.c
|   |   ├── pn06a.c
|   |   ├── pnm00a.c
|   |   ├── pnm00b.c
|   |   ├── pnm06a.c
|   |   ├── pnm80.c
|   |   ├── pom00.c
|   |   ├── ppp.c
|   |   ├── ppsp.c
|   |   ├── pr00.c
|   |   ├── prec76.c
|   |   ├── pv2p.c
|   |   ├── pv2s.c
|   |   ├── pvdpv.c
|   |   ├── pvm.c
|   |   ├── pvmpv.c
|   |   ├── pvppv.c
|   |   ├── pvstar.c
|   |   ├── pvtob.c
|   |   ├── pvu.c
|   |   ├── pvup.c
|   |   ├── pvxpv.c
|   |   ├── pxp.c
|   |   ├── refco.c
|   |   ├── rm2v.c
|   |   ├── rv2m.c
|   |   ├── rx.c
|   |   ├── rxp.c
|   |   ├── rxpv.c
|   |   ├── rxr.c
|   |   ├── ry.c
|   |   ├── rz.c
|   |   ├── s00.c
|   |   ├── s00a.c
|   |   ├── s00b.c
|   |   ├── s06.c
|   |   ├── s06a.c
|   |   ├── s2c.c
|   |   ├── s2p.c
|   |   ├── s2pv.c
|   |   ├── s2xpv.c
|   |   ├── sepp.c
|   |   ├── seps.c
|   |   ├── sp00.c
|   |   ├── starpm.c
|   |   ├── starpv.c
|   |   ├── sxp.c
|   |   ├── sxpv.c
|   |   ├── taitt.c
|   |   ├── taiut1.c
|   |   ├── taiutc.c
|   |   ├── tcbtdb.c
|   |   ├── tcgtt.c
|   |   ├── tdbtcb.c
|   |   ├── tdbtt.c
|   |   ├── tf2a.c
|   |   ├── tf2d.c
|   |   ├── tr.c
|   |   ├── trxp.c
|   |   ├── trxpv.c
|   |   ├── tttai.c
|   |   ├── tttcg.c
|   |   ├── tttdb.c
|   |   ├── ttut1.c
|   |   ├── ut1tai.c
|   |   ├── ut1tt.c
|   |   ├── ut1utc.c
|   |   ├── utctai.c
|   |   ├── utcut1.c
|   |   ├── xy06.c
|   |   ├── xys00a.c
|   |   ├── xys00b.c
|   |   ├── xys06a.c
|   |   ├── zp.c
|   |   ├── zpv.c
|   |   └── zr.c
|   ├── expat
|   |   ├── CMakeLists.txt
|   |   ├── amiga
|   |   |   ├── README.txt
|   |   |   ├── expat.xml
|   |   |   ├── expat_68k.c
|   |   |   ├── expat_68k_handler_stubs.c
|   |   |   ├── expat_lib.c
|   |   |   ├── expat_vectors.c
|   |   |   ├── include
|   |   |   |   ├── inline4
|   |   |   |   ├── interfaces
|   |   |   |   ├── libraries
|   |   |   |   └── proto
|   |   |   ├── launch.c
|   |   |   └── stdlib.c
|   |   ├── bcb5
|   |   |   └── README.txt
|   |   ├── conftools
|   |   |   ├── get-version.sh
|   |   |   └── ltmain.sh
|   |   ├── doc
|   |   |   ├── reference.html
|   |   |   └── style.css
|   |   ├── examples
|   |   |   ├── elements.c
|   |   |   └── outline.c
|   |   ├── lib
|   |   |   ├── xmlparse.c
|   |   |   ├── xmlrole.c
|   |   |   ├── xmltok.c
|   |   |   ├── xmltok_impl.c
|   |   |   └── xmltok_ns.c
|   |   ├── m4
|   |   ├── tests
|   |   |   ├── README.txt
|   |   |   ├── benchmark
|   |   |   |   ├── README.txt
|   |   |   |   └── benchmark.c
|   |   |   ├── chardata.c
|   |   |   ├── minicheck.c
|   |   |   ├── runtests.c
|   |   |   ├── runtestspp.cpp
|   |   |   └── xmltest.sh
|   |   ├── vms
|   |   ├── win32
|   |   |   ├── MANIFEST.txt
|   |   |   └── README.txt
|   |   └── xmlwf
|   |       ├── codepage.c
|   |       ├── ct.c
|   |       ├── readfilemap.c
|   |       ├── unixfilemap.c
|   |       ├── win32filemap.c
|   |       ├── xmlfile.c
|   |       ├── xmlmime.c
|   |       ├── xmlwf.c
|   |       └── xmlwin32url.cxx
|   ├── trim_cfitsio.sh
|   ├── trim_wcslib.sh
|   └── wcslib
|       ├── C
|       |   ├── cel.c
|       |   ├── dis.c
|       |   ├── flexed
|       |   |   ├── fitshdr.c
|       |   |   ├── wcsbth.c
|       |   |   ├── wcspih.c
|       |   |   ├── wcsulex.c
|       |   |   └── wcsutrn.c
|       |   ├── getwcstab.c
|       |   ├── lin.c
|       |   ├── log.c
|       |   ├── prj.c
|       |   ├── spc.c
|       |   ├── sph.c
|       |   ├── spx.c
|       |   ├── tab.c
|       |   ├── wcs.c
|       |   ├── wcserr.c
|       |   ├── wcsfix.c
|       |   ├── wcshdr.c
|       |   ├── wcsprintf.c
|       |   ├── wcstrig.c
|       |   ├── wcsunits.c
|       |   └── wcsutil.c
|       └── config
├── conftest.py
├── docs
|   ├── _pkgtemplate.rst
|   ├── _static
|   ├── changelog.rst
|   ├── conf.py
|   ├── config
|   |   ├── config_0_4_transition.rst
|   |   └── index.rst
|   ├── constants
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── convolution
|   |   ├── images
|   |   ├── index.rst
|   |   ├── kernels.rst
|   |   ├── non_normalized_kernels.rst
|   |   ├── performance.inc.rst
|   |   └── using.rst
|   ├── coordinates
|   |   ├── angles.rst
|   |   ├── apply_space_motion.rst
|   |   ├── definitions.rst
|   |   ├── formatting.rst
|   |   ├── frames.rst
|   |   ├── galactocentric.rst
|   |   ├── index.rst
|   |   ├── inplace.rst
|   |   ├── matchsep.rst
|   |   ├── performance.inc.rst
|   |   ├── references.txt
|   |   ├── remote_methods.rst
|   |   ├── representations.rst
|   |   ├── skycoord.rst
|   |   ├── solarsystem.rst
|   |   ├── transforming.rst
|   |   └── velocities.rst
|   ├── cosmology
|   |   ├── index.rst
|   |   └── performance.inc.rst
|   ├── credits.rst
|   ├── development
|   |   ├── astropy-package-template.rst
|   |   ├── building.rst
|   |   ├── ccython.rst
|   |   ├── codeguide.rst
|   |   ├── codeguide_emacs.rst
|   |   ├── docguide.rst
|   |   ├── docrules.rst
|   |   ├── releasing.rst
|   |   ├── scripts.rst
|   |   ├── testguide.rst
|   |   ├── vision.rst
|   |   ├── when_to_rebase.rst
|   |   └── workflow
|   |       ├── additional_git_topics.rst
|   |       ├── command_history.rst
|   |       ├── command_history.sh
|   |       ├── command_history_with_output.sh
|   |       ├── development_workflow.rst
|   |       ├── get_devel_version.rst
|   |       ├── git_edit_workflow_examples.rst
|   |       ├── git_install.rst
|   |       ├── git_resources.rst
|   |       ├── maintainer_workflow.rst
|   |       ├── patches.rst
|   |       ├── terminal_cast.rst
|   |       ├── virtual_pythons.rst
|   |       └── virtualenv_detail.rst
|   ├── getting_started.rst
|   ├── importing_astropy.rst
|   ├── index.rst
|   ├── install.rst
|   ├── io
|   |   ├── ascii
|   |   |   ├── base_classes.rst
|   |   |   ├── extension_classes.rst
|   |   |   ├── fast_ascii_io.rst
|   |   |   ├── fixed_width_gallery.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   ├── read.rst
|   |   |   ├── references.txt
|   |   |   ├── toc.txt
|   |   |   └── write.rst
|   |   ├── fits
|   |   |   ├── api
|   |   |   |   ├── cards.rst
|   |   |   |   ├── diff.rst
|   |   |   |   ├── files.rst
|   |   |   |   ├── hdulists.rst
|   |   |   |   ├── hdus.rst
|   |   |   |   ├── headers.rst
|   |   |   |   ├── images.rst
|   |   |   |   ├── tables.rst
|   |   |   |   └── verification.rst
|   |   |   ├── appendix
|   |   |   |   ├── faq.rst
|   |   |   |   ├── header_transition.rst
|   |   |   |   └── history.rst
|   |   |   ├── index.rst
|   |   |   ├── performance.inc.rst
|   |   |   └── usage
|   |   |       ├── headers.rst
|   |   |       ├── image.rst
|   |   |       ├── misc.rst
|   |   |       ├── scripts.rst
|   |   |       ├── table.rst
|   |   |       ├── unfamiliar.rst
|   |   |       └── verification.rst
|   |   ├── misc.rst
|   |   ├── registry.rst
|   |   ├── unified.rst
|   |   └── votable
|   |       ├── api_exceptions.rst
|   |       ├── index.rst
|   |       ├── performance.inc.rst
|   |       └── references.txt
|   ├── known_issues.rst
|   ├── license.rst
|   ├── logging.rst
|   ├── modeling
|   |   ├── algorithms.rst
|   |   ├── bounding-boxes.rst
|   |   ├── compound-models.rst
|   |   ├── fitting.rst
|   |   ├── index.rst
|   |   ├── models.rst
|   |   ├── new.rst
|   |   ├── parameters.rst
|   |   ├── performance.inc.rst
|   |   └── units.rst
|   ├── nddata
|   |   ├── ccddata.rst
|   |   ├── decorator.rst
|   |   ├── index.rst
|   |   ├── mixins
|   |   |   ├── index.rst
|   |   |   ├── ndarithmetic.rst
|   |   |   ├── ndio.rst
|   |   |   └── ndslicing.rst
|   |   ├── nddata.rst
|   |   ├── performance.inc.rst
|   |   ├── subclassing.rst
|   |   └── utils.rst
|   ├── overview.rst
|   ├── samp
|   |   ├── advanced_embed_samp_hub.rst
|   |   ├── example_clients.rst
|   |   ├── example_hub.rst
|   |   ├── example_table_image.rst
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── stability.rst
|   ├── stats
|   |   ├── bls.rst
|   |   ├── circ.rst
|   |   ├── index.rst
|   |   ├── lombscargle.rst
|   |   ├── performance.inc.rst
|   |   ├── ripley.rst
|   |   └── robust.rst
|   ├── table
|   |   ├── access_table.rst
|   |   ├── construct_table.rst
|   |   ├── implementation_details.rst
|   |   ├── index.rst
|   |   ├── indexing.rst
|   |   ├── io.rst
|   |   ├── masking.rst
|   |   ├── mixin_columns.rst
|   |   ├── modify_table.rst
|   |   ├── operations.rst
|   |   ├── pandas.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── testhelpers.rst
|   ├── time
|   |   ├── index.rst
|   |   ├── performance.inc.rst
|   |   └── references.txt
|   ├── units
|   |   ├── combining_and_defining.rst
|   |   ├── conversion.rst
|   |   ├── decomposing_and_composing.rst
|   |   ├── equivalencies.rst
|   |   ├── format.rst
|   |   ├── index.rst
|   |   ├── logarithmic_units.rst
|   |   ├── performance.inc.rst
|   |   ├── quantity.rst
|   |   └── standard_units.rst
|   ├── utils
|   |   ├── iers.rst
|   |   ├── index.rst
|   |   └── numpy.rst
|   ├── visualization
|   |   ├── histogram.rst
|   |   ├── index.rst
|   |   ├── lupton_rgb.rst
|   |   ├── normalization.rst
|   |   ├── performance.inc.rst
|   |   └── wcsaxes
|   |       ├── controlling_axes.rst
|   |       ├── custom_frames.rst
|   |       ├── generic_transforms.rst
|   |       ├── images_contours.rst
|   |       ├── index.rst
|   |       ├── initializing_axes.rst
|   |       ├── overlaying_coordinate_systems.rst
|   |       ├── overlays.rst
|   |       ├── slicing_datacubes.rst
|   |       └── ticks_labels_grid.rst
|   ├── warnings.rst
|   ├── wcs
|   |   ├── examples
|   |   |   ├── from_file.py
|   |   |   └── programmatic.py
|   |   ├── history.rst
|   |   ├── index.rst
|   |   ├── note_sip.rst
|   |   ├── performance.inc.rst
|   |   ├── references.rst
|   |   ├── references.txt
|   |   └── relax.rst
|   └── whatsnew
|       ├── 0.1.rst
|       ├── 0.2.rst
|       ├── 0.3.rst
|       ├── 0.4.rst
|       ├── 1.0.rst
|       ├── 1.1.rst
|       ├── 1.2.rst
|       ├── 1.3.rst
|       ├── 2.0.rst
|       ├── 3.0.rst
|       ├── 3.1.rst
|       └── index.rst
├── examples
|   ├── README.txt
|   ├── coordinates
|   |   ├── README.txt
|   |   ├── plot_galactocentric-frame.py
|   |   ├── plot_obs-planning.py
|   |   ├── plot_sgr-coordinate-frame.py
|   |   └── rv-to-gsr.py
|   ├── io
|   |   ├── README.txt
|   |   ├── create-mef.py
|   |   ├── fits-tables.py
|   |   ├── modify-fits-header.py
|   |   ├── plot_fits-image.py
|   |   ├── skip_create-large-fits.py
|   |   └── split-jpeg-to-fits.py
|   └── template
|       └── example-template.py
├── licenses
|   ├── AURA_LICENSE.rst
|   ├── CONFIGOBJ_LICENSE.rst
|   ├── DATATABLES_LICENSE.rst
|   ├── ERFA.rst
|   ├── EXPAT_LICENSE.rst
|   ├── JQUERY_LICENSE.rst
|   ├── NUMPY_LICENSE.rst
|   ├── PLY_LICENSE.rst
|   ├── PYFITS.rst
|   ├── README.rst
|   └── WCSLIB_LICENSE.rst
├── readthedocs.yml
├── setup.py
└── static
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Unit equality comparison with None raises TypeError for UnrecognizedUnit

Description: ```
In [12]: x = u.Unit('asdf', parse_strict='silent')

In [13]: x == None  # Should be False
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-13-2486f2ccf928> in <module>()
----> 1 x == None  # Should be False

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __eq__(self, other)
   1699 
   1700     def __eq__(self, other):
-> 1701         other = Unit(other, parse_strict='silent')
   1702         return isinstance(other, UnrecognizedUnit) and self.name == other.name
   1703 

/Users/aldcroft/anaconda3/lib/python3.5/site-packages/astropy/units/core.py in __call__(self, s, represents, format, namespace, doc, parse_strict)
   1808 
   1809         elif s is None:
-> 1810             raise TypeError("None is not a valid Unit")
   1811 
   1812         else:

TypeError: None is not a valid Unit
```

Patch information:
diff --git a/astropy/units/core.py b/astropy/units/core.py
index e9bd986d33..ee0e21225a 100644
--- a/astropy/units/core.py
+++ b/astropy/units/core.py
@@ -1710,7 +1710,13 @@ class UnrecognizedUnit(IrreducibleUnit):
         _unrecognized_operator
 
     def __eq__(self, other):
-        other = Unit(other, parse_strict='silent')
+        try:
+            other = Unit(other, parse_strict='silent')
+        except (ValueError, UnitsError, TypeError):
+            return False
+        # Other is Unit-like, but if it is not a UnitBase, give up (so that other can try).
+        if not isinstance(other, UnitBase):
+            return NotImplemented
         return isinstance(other, UnrecognizedUnit) and self.name == other.name
 
     def __ne__(self, other):


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `astropy/units/tests/test_units.py`.
Extra Requirements: 
Purpose: I need to find 3 relevant test cases for the reported bug, and this file is the most likely place to find them.

Previous refined query 2:
Essential Query: Please provide the content of `astropy/units/tests/test_units.py` from line 501 to the end of the file.
Extra Requirements: If the rest of the file is too large, please prioritize sending any tests that involve equality comparisons (`==` or `!=`) with `None` or other non-unit objects.
Purpose: I need to find three relevant test cases for the reported bug, and the current partial file content is insufficient to select the best three examples.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/units/tests/test_units.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. """
4. Regression tests for the units package
5. """
6. import pickle
7. from fractions import Fraction
8. 
9. import pytest
10. import numpy as np
11. from numpy.testing import assert_allclose
12. 
13. from ...tests.helper import raises, catch_warnings
14. 
15. from ... import units as u
16. from ... import constants as c
17. from .. import utils
18. 
19. 
20. def test_getting_started():
21.     """
22.     Corresponds to "Getting Started" section in the docs.
23.     """
24.     from .. import imperial
25.     with imperial.enable():
26.         speed_unit = u.cm / u.s
27.         x = speed_unit.to(imperial.mile / u.hour, 1)
28.         assert_allclose(x, 0.02236936292054402)
29.         speed_converter = speed_unit._get_converter("mile hour^-1")
30.         x = speed_converter([1., 1000., 5000.])
31.         assert_allclose(x, [2.23693629e-02, 2.23693629e+01, 1.11846815e+02])
32. 
33. 
34. def test_initialisation():
35.     assert u.Unit(u.m) is u.m
36. 
37.     ten_meter = u.Unit(10.*u.m)
38.     assert ten_meter == u.CompositeUnit(10., [u.m], [1])
39.     assert u.Unit(ten_meter) is ten_meter
40. 
41.     assert u.Unit(10.*ten_meter) == u.CompositeUnit(100., [u.m], [1])
42. 
43.     foo = u.Unit('foo', (10. * ten_meter)**2, namespace=locals())
44.     assert foo == u.CompositeUnit(10000., [u.m], [2])
45. 
46.     assert u.Unit('m') == u.m
47.     assert u.Unit('') == u.dimensionless_unscaled
48.     assert u.one == u.dimensionless_unscaled
49.     assert u.Unit('10 m') == ten_meter
50.     assert u.Unit(10.) == u.CompositeUnit(10., [], [])
51. 
52. 
53. def test_invalid_power():
54.     x = u.m ** Fraction(1, 3)
55.     assert isinstance(x.powers[0], Fraction)
56. 
57.     x = u.m ** Fraction(1, 2)
58.     assert isinstance(x.powers[0], float)
59. 
60.     # Test the automatic conversion to a fraction
61.     x = u.m ** (1. / 3.)
62.     assert isinstance(x.powers[0], Fraction)
63. 
64. 
65. def test_invalid_compare():
66.     assert not (u.m == u.s)
67. 
68. 
69. def test_convert():
70.     assert u.h._get_converter(u.s)(1) == 3600
71. 
72. 
73. def test_convert_fail():
74.     with pytest.raises(u.UnitsError):
75.         u.cm.to(u.s, 1)
76.     with pytest.raises(u.UnitsError):
77.         (u.cm / u.s).to(u.m, 1)
78. 
79. 
80. def test_composite():
81.     assert (u.cm / u.s * u.h)._get_converter(u.m)(1) == 36
82.     assert u.cm * u.cm == u.cm ** 2
83. 
84.     assert u.cm * u.cm * u.cm == u.cm ** 3
85. 
86.     assert u.Hz.to(1000 * u.Hz, 1) == 0.001
87. 
88. 
89. def test_str():
90.     assert str(u.cm) == "cm"
91. 
92. 
93. def test_repr():
94.     assert repr(u.cm) == 'Unit("cm")'
95. 
96. 
97. def test_represents():
98.     assert u.m.represents is u.m
99.     assert u.km.represents.scale == 1000.
100.     assert u.km.represents.bases == [u.m]
101.     assert u.Ry.scale == 1.0 and u.Ry.bases == [u.Ry]
102.     assert_allclose(u.Ry.represents.scale, 13.605692518464949)
103.     assert u.Ry.represents.bases == [u.eV]
104.     bla = u.def_unit('bla', namespace=locals())
105.     assert bla.represents is bla
106.     blabla = u.def_unit('blabla', 10 * u.hr, namespace=locals())
107.     assert blabla.represents.scale == 10.
108.     assert blabla.represents.bases == [u.hr]
109.     assert blabla.decompose().scale == 10 * 3600
110.     assert blabla.decompose().bases == [u.s]
111. 
112. 
113. def test_units_conversion():
114.     assert_allclose(u.kpc.to(u.Mpc), 0.001)
115.     assert_allclose(u.Mpc.to(u.kpc), 1000)
116.     assert_allclose(u.yr.to(u.Myr), 1.e-6)
117.     assert_allclose(u.AU.to(u.pc), 4.84813681e-6)
118.     assert_allclose(u.cycle.to(u.rad), 6.283185307179586)
119. 
120. 
121. def test_units_manipulation():
122.     # Just do some manipulation and check it's happy
123.     (u.kpc * u.yr) ** Fraction(1, 3) / u.Myr
124.     (u.AA * u.erg) ** 9
125. 
126. 
127. def test_decompose():
128.     assert u.Ry == u.Ry.decompose()
129. 
130. 
131. def test_dimensionless_to_si():
132.     """
133.     Issue #1150: Test for conversion of dimensionless quantities
134.                  to the SI system
135.     """
136. 
137.     testunit = ((1.0 * u.kpc) / (1.0 * u.Mpc))
138. 
139.     assert testunit.unit.physical_type == 'dimensionless'
140.     assert_allclose(testunit.si, 0.001)
141. 
142. 
143. def test_dimensionless_to_cgs():
144.     """
145.     Issue #1150: Test for conversion of dimensionless quantities
146.                  to the CGS system
147.     """
148. 
149.     testunit = ((1.0 * u.m) / (1.0 * u.km))
150. 
151.     assert testunit.unit.physical_type == 'dimensionless'
152.     assert_allclose(testunit.cgs, 0.001)
153. 
154. 
155. def test_unknown_unit():
156.     with catch_warnings(u.UnitsWarning) as warning_lines:
157.         u.Unit("FOO", parse_strict='warn')
158. 
159.     assert 'FOO' in str(warning_lines[0].message)
160. 
161. 
162. def test_multiple_solidus():
163.     assert u.Unit("m/s/kg").to_string() == u.m / u.s / u.kg
164. 
165.     with catch_warnings(u.UnitsWarning) as warning_lines:
166.         assert u.Unit("m/s/kg").to_string() == u.m / (u.s * u.kg)
167. 
168.     assert 'm/s/kg' in str(warning_lines[0].message)
169.     assert 'discouraged' in str(warning_lines[0].message)
170. 
171.     with pytest.raises(ValueError):
172.         u.Unit("m/s/kg", format="vounit")
173. 
174. 
175. def test_unknown_unit3():
176.     unit = u.Unit("FOO", parse_strict='silent')
177.     assert isinstance(unit, u.UnrecognizedUnit)
178.     assert unit.name == "FOO"
179. 
180.     unit2 = u.Unit("FOO", parse_strict='silent')
181.     assert unit == unit2
182.     assert unit.is_equivalent(unit2)
183. 
184.     unit3 = u.Unit("BAR", parse_strict='silent')
185.     assert unit != unit3
186.     assert not unit.is_equivalent(unit3)
187. 
188.     with pytest.raises(ValueError):
189.         unit._get_converter(unit3)
190. 
191.     x = unit.to_string('latex')
192.     y = unit2.to_string('cgs')
193. 
194.     with pytest.raises(ValueError):
195.         unit4 = u.Unit("BAR", parse_strict='strict')
196. 
197.     with pytest.raises(TypeError):
198.         unit5 = u.Unit(None)
199. 
200. 
201. @raises(TypeError)
202. def test_invalid_scale():
203.     x = ['a', 'b', 'c'] * u.m
204. 
205. 
206. def test_cds_power():
207.     unit = u.Unit("10+22/cm2", format="cds", parse_strict='silent')
208.     assert unit.scale == 1e22
209. 
210. 
211. def test_register():
212.     foo = u.def_unit("foo", u.m ** 3, namespace=locals())
213.     assert 'foo' in locals()
214.     with u.add_enabled_units(foo):
215.         assert 'foo' in u.get_current_unit_registry().registry
216.     assert 'foo' not in u.get_current_unit_registry().registry
217. 
218. 
219. def test_in_units():
220.     speed_unit = u.cm / u.s
221.     x = speed_unit.in_units(u.pc / u.hour, 1)
222. 
223. 
224. def test_null_unit():
225.     assert (u.m / u.m) == u.Unit(1)
226. 
227. 
228. def test_unrecognized_equivalency():
229.     assert u.m.is_equivalent('foo') is False
230.     assert u.m.is_equivalent('pc') is True
231. 
232. 
233. @raises(TypeError)
234. def test_unit_noarg():
235.     u.Unit()
236. 
237. 
238. def test_convertible_exception():
239.     try:
240.         u.AA.to(u.h * u.s ** 2)
241.     except u.UnitsError as e:
242.         assert "length" in str(e)
243. 
244. 
245. def test_convertible_exception2():
246.     try:
247.         u.m.to(u.s)
248.     except u.UnitsError as e:
249.         assert "length" in str(e)
250. 
251. 
252. @raises(TypeError)
253. def test_invalid_type():
254.     class A:
255.         pass
256. 
257.     u.Unit(A())
258. 
259. 
260. def test_steradian():
261.     """
262.     Issue #599
263.     """
264.     assert u.sr.is_equivalent(u.rad * u.rad)
265. 
266.     results = u.sr.compose(units=u.cgs.bases)
267.     assert results[0].bases[0] is u.rad
268. 
269.     results = u.sr.compose(units=u.cgs.__dict__)
270.     assert results[0].bases[0] is u.sr
271. 
272. 
273. def test_decompose_bases():
274.     """
275.     From issue #576
276.     """
277. 
278.     from .. import cgs
279.     from ...constants import e
280. 
281.     d = e.esu.unit.decompose(bases=cgs.bases)
282.     assert d._bases == [u.cm, u.g, u.s]
283.     assert d._powers == [Fraction(3, 2), 0.5, -1]
284.     assert d._scale == 1.0
285. 
286. 
287. def test_complex_compose():
288.     complex = u.cd * u.sr * u.Wb
289.     composed = complex.compose()
290. 
291.     assert set(composed[0]._bases) == set([u.lm, u.Wb])
292. 
293. 
294. def test_equiv_compose():
295.     composed = u.m.compose(equivalencies=u.spectral())
296.     assert any([u.Hz] == x.bases for x in composed)
297. 
298. 
299. def test_empty_compose():
300.     with pytest.raises(u.UnitsError):
301.         composed = u.m.compose(units=[])
302. 
303. 
304. def _unit_as_str(unit):
305.     # This function serves two purposes - it is used to sort the units to
306.     # test alphabetically, and it is also use to allow pytest to show the unit
307.     # in the [] when running the parametrized tests.
308.     return str(unit)
309. 
310. 
311. # We use a set to make sure we don't have any duplicates.
312. COMPOSE_ROUNDTRIP = set()
313. for val in u.__dict__.values():
314.     if (isinstance(val, u.UnitBase) and
315.             not isinstance(val, u.PrefixUnit)):
316.         COMPOSE_ROUNDTRIP.add(val)
317. 
318. 
319. @pytest.mark.parametrize('unit', sorted(COMPOSE_ROUNDTRIP, key=_unit_as_str), ids=_unit_as_str)
320. def test_compose_roundtrip(unit):
321.     composed_list = unit.decompose().compose()
322.     found = False
323.     for composed in composed_list:
324.         if len(composed.bases):
325.             if composed.bases[0] is unit:
326.                 found = True
327.                 break
328.         elif len(unit.bases) == 0:
329.             found = True
330.             break
331.     assert found
332. 
333. 
334. # We use a set to make sure we don't have any duplicates.
335. COMPOSE_CGS_TO_SI = set()
336. for val in u.cgs.__dict__.values():
337.     # Can't decompose Celsius
338.     if (isinstance(val, u.UnitBase) and
339.             not isinstance(val, u.PrefixUnit) and
340.             val != u.cgs.deg_C):
341.         COMPOSE_CGS_TO_SI.add(val)
342. 
343. 
344. @pytest.mark.parametrize('unit', sorted(COMPOSE_CGS_TO_SI, key=_unit_as_str),
345.                          ids=_unit_as_str)
346. def test_compose_cgs_to_si(unit):
347.     si = unit.to_system(u.si)
348.     assert [x.is_equivalent(unit) for x in si]
349.     assert si[0] == unit.si
350. 
351. 
352. # We use a set to make sure we don't have any duplicates.
353. COMPOSE_SI_TO_CGS = set()
354. for val in u.si.__dict__.values():
355.     # Can't decompose Celsius
356.     if (isinstance(val, u.UnitBase) and
357.             not isinstance(val, u.PrefixUnit) and
358.             val != u.si.deg_C):
359.         COMPOSE_SI_TO_CGS.add(val)
360. 
361. 
362. @pytest.mark.parametrize('unit', sorted(COMPOSE_SI_TO_CGS, key=_unit_as_str), ids=_unit_as_str)
363. def test_compose_si_to_cgs(unit):
364. 
365.     # Can't convert things with Ampere to CGS without more context
366.     try:
367.         cgs = unit.to_system(u.cgs)
368.     except u.UnitsError:
369.         if u.A in unit.decompose().bases:
370.             pass
371.         else:
372.             raise
373.     else:
374.         assert [x.is_equivalent(unit) for x in cgs]
375.         assert cgs[0] == unit.cgs
376. 
377. 
378. def test_to_cgs():
379.     assert u.Pa.to_system(u.cgs)[1]._bases[0] is u.Ba
380.     assert u.Pa.to_system(u.cgs)[1]._scale == 10.0
381. 
382. 
383. def test_decompose_to_cgs():
384.     from .. import cgs
385.     assert u.m.decompose(bases=cgs.bases)._bases[0] is cgs.cm
386. 
387. 
388. def test_compose_issue_579():
389.     unit = u.kg * u.s ** 2 / u.m
390. 
391.     result = unit.compose(units=[u.N, u.s, u.m])
392. 
393.     assert len(result) == 1
394.     assert result[0]._bases == [u.s, u.N, u.m]
395.     assert result[0]._powers == [4, 1, -2]
396. 
397. 
398. def test_compose_prefix_unit():
399.     x =  u.m.compose(units=(u.m,))
400.     assert x[0].bases[0] is u.m
401.     assert x[0].scale == 1.0
402.     x = u.m.compose(units=[u.km], include_prefix_units=True)
403.     assert x[0].bases[0] is u.km
404.     assert x[0].scale == 0.001
405.     x = u.m.compose(units=[u.km])
406.     assert x[0].bases[0] is u.km
407.     assert x[0].scale == 0.001
408. 
409.     x = (u.km/u.s).compose(units=(u.pc, u.Myr))
410.     assert x[0].bases == [u.pc, u.Myr]
411.     assert_allclose(x[0].scale, 1.0227121650537077)
412. 
413.     with raises(u.UnitsError):
414.         (u.km/u.s).compose(units=(u.pc, u.Myr), include_prefix_units=False)
415. 
416. 
417. def test_self_compose():
418.     unit = u.kg * u.s
419. 
420.     assert len(unit.compose(units=[u.g, u.s])) == 1
421. 
422. 
423. @raises(u.UnitsError)
424. def test_compose_failed():
425.     unit = u.kg
426. 
427.     result = unit.compose(units=[u.N])
428. 
429. 
430. def test_compose_fractional_powers():
431.     # Warning: with a complicated unit, this test becomes very slow;
432.     # e.g., x = (u.kg / u.s ** 3 * u.au ** 2.5 / u.yr ** 0.5 / u.sr ** 2)
433.     # takes 3 s
434.     x = u.m ** 0.5 / u.yr ** 1.5
435. 
436.     factored = x.compose()
437. 
438.     for unit in factored:
439.         assert x.decompose() == unit.decompose()
440. 
441.     factored = x.compose(units=u.cgs)
442. 
443.     for unit in factored:
444.         assert x.decompose() == unit.decompose()
445. 
446.     factored = x.compose(units=u.si)
447. 
448.     for unit in factored:
449.         assert x.decompose() == unit.decompose()
450. 
451. 
452. def test_compose_best_unit_first():
453.     results = u.l.compose()
454.     assert len(results[0].bases) == 1
455.     assert results[0].bases[0] is u.l
456. 
457.     results = (u.s ** -1).compose()
458.     assert results[0].bases[0] in (u.Hz, u.Bq)
459. 
460.     results = (u.Ry.decompose()).compose()
461.     assert results[0].bases[0] is u.Ry
462. 
463. 
464. def test_compose_no_duplicates():
465.     new = u.kg / u.s ** 3 * u.au ** 2.5 / u.yr ** 0.5 / u.sr ** 2
466.     composed = new.compose(units=u.cgs.bases)
467.     assert len(composed) == 1
468. 
469. 
470. def test_long_int():
471.     """
472.     Issue #672
473.     """
474.     sigma = 10 ** 21 * u.M_p / u.cm ** 2
475.     sigma.to(u.M_sun / u.pc ** 2)
476. 
477. 
478. def test_endian_independence():
479.     """
480.     Regression test for #744
481. 
482.     A logic issue in the units code meant that big endian arrays could not be
483.     converted because the dtype is '>f4', not 'float32', and the code was
484.     looking for the strings 'float' or 'int'.
485.     """
486.     for endian in ['<', '>']:
487.         for ntype in ['i', 'f']:
488.             for byte in ['4', '8']:
489.                 x = np.array([1, 2, 3], dtype=(endian + ntype + byte))
490.                 u.m.to(u.cm, x)
491. 
492. 
493. def test_radian_base():
494.     """
495.     Issue #863
496.     """
497.     assert (1 * u.degree).si.unit == u.rad
498. 
499. 
500. def test_no_as():


File: astropy/units/tests/test_units.py
Line number range: 579 - 588
Content:
579. def test_comparison():
580.     assert u.m > u.cm
581.     assert u.m >= u.cm
582.     assert u.cm < u.m
583.     assert u.cm <= u.m
584. 
585.     with pytest.raises(u.UnitsError):
586.         u.m > u.kg
587. 
588. 


File: astropy/units/tests/test_units.py
Line number range: 658 - 662
Content:
658. def test_fits_hst_unit():
659.     """See #1911."""
660.     x = u.Unit("erg /s /cm**2 /angstrom")
661.     assert x == u.erg * u.s ** -1 * u.cm ** -2 * u.angstrom ** -1
662. 


File: astropy/units/tests/test_units.py
Line number range: 726 - 732
Content:
726. def test_compare_with_none():
727.     # Ensure that equality comparisons with `None` work, and don't
728.     # raise exceptions.  We are deliberately not using `is None` here
729.     # because that doesn't trigger the bug.  See #3108.
730.     assert not (u.m == None)  # nopep8
731.     assert u.m != None  # nopep8
732. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 20:28:29,029 - thread-138947745285824.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The provided context is sufficient. I have identified three relevant test cases that cover the different aspects of the user's request. `test_compare_with_none` shows how to test for equality with `None`. `test_unknown_unit3` shows how to work with `UnrecognizedUnit`, which is the class being patched. `test_unrecognized_equivalency` shows how other methods handle unrecognized units, which is a similar pattern to the bug fix. I have the full function definitions and the imports, so I can construct the final answer without more information." query='' extra_requirements='' purpose=''
2025-12-21 20:28:29,030 - thread-138947745285824.prometheus_context_collector - INFO - Successfully retrieved 4 context snippets
